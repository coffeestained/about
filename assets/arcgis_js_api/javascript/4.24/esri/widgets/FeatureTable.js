// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../intl ../core/HandleOwner ../core/reactiveUtils ../core/accessorSupport/decorators/aliasOf ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/cast ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ./Widget ./FeatureTable/FeatureTableViewModel ./FeatureTable/Grid/support/ButtonMenu ./FeatureTable/Grid/support/ButtonMenuItem ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory ../intl/locale ../intl/substitute ../intl/messages".split(" "),
function(w,d,c,A,r,f,K,L,B,t,C,D,E,F,p,M,G,q,H,I,J){const x={header:!0,menu:!0,menuItems:{clearSelection:!0,refreshData:!0,toggleColumns:!0,selectedRecordsShowAllToggle:!0,selectedRecordsShowSelectedToggle:!0,zoomToSelection:!0},selectionColumn:!0,columnMenus:!0};c=function(y){function v(a,b){a=y.call(this,a,b)||this;a.activeSortOrders=null;a.attachmentsEnabled=null;a.autoRefreshEnabled=null;a.columnReorderingEnabled=null;a.columns=null;a.editingEnabled=null;a.fieldConfigs=null;a.filterGeometry=null;
a.grid=null;a.hiddenFields=null;a.highlightOnRowSelectEnabled=null;a.label=void 0;a.layer=null;a.messages=null;a.menu=null;a.menuConfig=null;a.multiSortEnabled=null;a.pageSize=null;a.relatedRecordsEnabled=null;a.state=null;a.tableTemplate=null;a.view=null;a.viewModel=new E;a.visibleElements={...x};return a}w._inheritsLoose(v,y);var e=v.prototype;e.initialize=function(){var a=this,b,g,m;const h=function(){var k=w._asyncToGenerator(function*(){return a.messages=yield J.fetchMessageBundle("esri/widgets/FeatureTable/t9n/FeatureTable")});
return function(){return k.apply(this,arguments)}}();h();this.handles.add([H.onLocaleChange(h),r.on(()=>this.viewModel.columns,"change",()=>this._syncMenuConfig()),r.on(()=>this.viewModel.activeFilters,"change",()=>this._syncMenuConfig()),r.on(()=>this.grid.selectedItems,"change",k=>{this._syncMenuConfig();this._onSelectionChange(k)}),r.watch(()=>[this.viewModel.store.querying,this.viewModel.store.syncing],()=>this.scheduleRender()),r.watch(()=>this.menuConfig,()=>this._syncMenuConfig()),r.watch(()=>
this.messages,()=>{var k;this.menu.label=null==(k=this.messages)?void 0:k.options;this._syncMenuConfig()})]);this._set("menu",new F({label:null==(b=this.messages)?void 0:b.options,iconClass:"esri-icon-handle-horizontal",...this.menuConfig}));const {attachmentsEnabled:l,relatedRecordsEnabled:n}=this;null==(g=this.viewModel)?void 0:null==(m=g.store)?void 0:m.set({attachmentsEnabled:l,relatedRecordsEnabled:n})};e.destroy=function(){var a;this.clearSelection();this.handles.removeAll();null==(a=this.menu)?
void 0:a.destroy()};e.castVisibleElements=function(a){var b;a={...x,...a};null==(b=this.grid)?void 0:b.set("visibleElements",{...this.grid.visibleElements,selectionColumn:a.selectionColumn,columnMenus:a.columnMenus});return a};e.clearHighlights=function(){};e.clearSelection=function(){};e.clearSelectionFilter=function(){};e.deselectRows=function(){};e.filterBySelection=function(){};e.findColumn=function(){};e.hideColumn=function(a){var b;null==(b=this.grid)?void 0:b.hideColumn(a);this._syncMenuConfig()};
e.refresh=function(){};e.showAllColumns=function(){};e.showColumn=function(a){var b;null==(b=this.grid)?void 0:b.showColumn(a);this._syncMenuConfig()};e.sortColumn=function(){};e.selectRows=function(){};e.scrollToIndex=function(){};e.render=function(){var a;return q.tsx("div",{bind:this,class:this.classes("esri-feature-table","esri-widget")},this.visibleElements.header?this._renderHeader():null,q.tsx("div",{class:"esri-feature-table__content"},"disabled"!==this.state&&(null==(a=this.grid)?void 0:
a.render())))};e.zoomToSelection=function(){};e._renderHeader=function(){return q.tsx("div",{key:"header",class:"esri-feature-table__header"},this._renderLoader(),this._renderTitle(),this.visibleElements.menu?this._renderMenu():null)};e._renderTitle=function(){return q.tsx("div",{class:"esri-feature-table__title",key:"title"},this._getTitle())};e._getTitle=function(){const {grid:a,layer:b,messages:g,viewModel:{size:m}}=this;return a&&b?I.substitute(g.header,{title:b.title,count:m,selected:a.selectedItems.length||
0}):""};e._renderLoader=function(){const {state:a,store:b}=this.viewModel;return q.tsx("div",{class:"esri-feature-table__loader-container"},"loading"===a||b.syncing||b.querying?q.tsx("div",{class:"esri-feature-table__loader",key:"loader"}):null)};e._renderMenu=function(){return q.tsx("div",{class:"esri-feature-table__menu"},this.menu.render())};e._onSelectionChange=function(a){const {added:b,removed:g}=a;this.emit("selection-change",{added:[...b],removed:[...g]})};e._syncMenuConfig=function(){var a;
null==(a=this.menu)?void 0:a.set({...this.menuConfig,items:this._getMenuItems()})};e._getMenuItems=function(){var a;const b=null==(a=this.menuConfig)?void 0:a.items;a=this._getDefaultMenuItems();const g=[];(null==a?0:a.length)&&g.push(...a);(null==b?0:b.length)&&g.push(...b);return g};e._getDefaultMenuItems=function(){var a;const {messages:b,viewModel:g,visibleElements:m}=this,{menuItems:h}=m,l=[];(null==h?0:h.refreshData)&&l.push(new p({selectionEnabled:!1,label:null==b?void 0:b.refreshData,clickFunction:()=>
this.refresh()}));if(this._hasActiveSelection()){const n=this.grid.selectedItems.length,k=this._getSelectionFilter();(null==h?0:h.clearSelection)&&l.push(new p({selectionEnabled:!1,label:null==b?void 0:b.clearSelection,clickFunction:()=>this.clearSelection()}));null!=h&&h.zoomToSelection&&this.view&&l.push(new p({selectionEnabled:!1,label:null==b?void 0:b.zoomToSelection,clickFunction:()=>this.viewModel.zoomToSelection()}));if(null!=h&&h.selectedRecordsShowSelectedToggle&&(!k||n!==k.objectIds.length)){const u=
b.showSelected,z=new p({selectionEnabled:!1,label:u,clickFunction:()=>{this.filterBySelection();z.set("label",u)}});l.push(z)}}if(null!=h&&h.selectedRecordsShowAllToggle&&this._hasSelectionFilter()){const n=b.showAllRecords,k=new p({selectionEnabled:!1,label:n,clickFunction:()=>{this.clearSelectionFilter();k.set("label",n)}});l.push(k)}(null==h?0:h.toggleColumns)&&l.push(new p({iconClass:"esri-icon-right",label:null==b?void 0:b.toggleColumns,clickFunction:this._toggleMenuItemSelectedIcon,items:null==
g?void 0:null==(a=g.columns)?void 0:a.items.map(({header:n,hidden:k,path:u})=>new p({label:n||u,selected:!k,selectionEnabled:!0,iconClass:"esri-icon-check-mark",clickFunction:()=>this._toggleColumnFromMenuItem(u)}))}));return l.length?l:null};e._toggleMenuItemSelectedIcon=function({item:a}){null==a?void 0:a.set("iconClass",null!=a&&a.selected?"esri-icon-down":"esri-icon-right")};e._toggleColumnFromMenuItem=function(a){const {grid:b,viewModel:g}=this,m=g.findColumn(a);null!=m&&m.hidden?b.showColumn(a):
b.hideColumn(a)};e._hasActiveSelection=function(){var a,b;return!(null==(a=this.grid)||null==(b=a.selectedItems)||!b.length)};e._getSelectionFilter=function(){var a;return null==(a=this.viewModel.activeFilters)?void 0:a.find(b=>"selection"===b.type)};e._hasSelectionFilter=function(){return!!this._getSelectionFilter()};return v}(A.HandleOwnerMixin(D));d.__decorate([f.aliasOf("viewModel.activeSortOrders")],c.prototype,"activeSortOrders",void 0);d.__decorate([f.aliasOf("viewModel.attachmentsEnabled")],
c.prototype,"attachmentsEnabled",void 0);d.__decorate([f.aliasOf("viewModel.autoRefreshEnabled")],c.prototype,"autoRefreshEnabled",void 0);d.__decorate([f.aliasOf("viewModel.columnReorderingEnabled")],c.prototype,"columnReorderingEnabled",void 0);d.__decorate([f.aliasOf("viewModel.columns")],c.prototype,"columns",void 0);d.__decorate([f.aliasOf("viewModel.editingEnabled")],c.prototype,"editingEnabled",void 0);d.__decorate([f.aliasOf("viewModel.fieldConfigs")],c.prototype,"fieldConfigs",void 0);d.__decorate([f.aliasOf("viewModel.filterGeometry")],
c.prototype,"filterGeometry",void 0);d.__decorate([f.aliasOf("viewModel.grid")],c.prototype,"grid",void 0);d.__decorate([f.aliasOf("viewModel.hiddenFields")],c.prototype,"hiddenFields",void 0);d.__decorate([f.aliasOf("viewModel.highlightOnRowSelectEnabled")],c.prototype,"highlightOnRowSelectEnabled",void 0);d.__decorate([t.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],c.prototype,"label",void 0);d.__decorate([f.aliasOf("viewModel.layer")],c.prototype,"layer",void 0);d.__decorate([t.property(),
G.messageBundle("esri/widgets/FeatureTable/t9n/FeatureTable")],c.prototype,"messages",void 0);d.__decorate([t.property({readOnly:!0})],c.prototype,"menu",void 0);d.__decorate([t.property()],c.prototype,"menuConfig",void 0);d.__decorate([f.aliasOf("viewModel.multiSortEnabled")],c.prototype,"multiSortEnabled",void 0);d.__decorate([f.aliasOf("viewModel.pageSize")],c.prototype,"pageSize",void 0);d.__decorate([f.aliasOf("viewModel.relatedRecordsEnabled")],c.prototype,"relatedRecordsEnabled",void 0);d.__decorate([f.aliasOf("viewModel.state")],
c.prototype,"state",void 0);d.__decorate([f.aliasOf("viewModel.tableTemplate")],c.prototype,"tableTemplate",void 0);d.__decorate([f.aliasOf("viewModel.view")],c.prototype,"view",void 0);d.__decorate([t.property()],c.prototype,"viewModel",void 0);d.__decorate([t.property()],c.prototype,"visibleElements",void 0);d.__decorate([B.cast("visibleElements")],c.prototype,"castVisibleElements",null);d.__decorate([f.aliasOf("viewModel.clearHighlights")],c.prototype,"clearHighlights",null);d.__decorate([f.aliasOf("viewModel.clearSelection")],
c.prototype,"clearSelection",null);d.__decorate([f.aliasOf("viewModel.clearSelectionFilter")],c.prototype,"clearSelectionFilter",null);d.__decorate([f.aliasOf("viewModel.deselectRows")],c.prototype,"deselectRows",null);d.__decorate([f.aliasOf("viewModel.filterBySelection")],c.prototype,"filterBySelection",null);d.__decorate([f.aliasOf("viewModel.findColumn")],c.prototype,"findColumn",null);d.__decorate([f.aliasOf("viewModel.refresh")],c.prototype,"refresh",null);d.__decorate([f.aliasOf("viewModel.showAllColumns")],
c.prototype,"showAllColumns",null);d.__decorate([f.aliasOf("viewModel.sortColumn")],c.prototype,"sortColumn",null);d.__decorate([f.aliasOf("viewModel.selectRows")],c.prototype,"selectRows",null);d.__decorate([f.aliasOf("viewModel.scrollToIndex")],c.prototype,"scrollToIndex",null);d.__decorate([f.aliasOf("viewModel.zoomToSelection")],c.prototype,"zoomToSelection",null);return c=d.__decorate([C.subclass("esri.widgets.FeatureTable")],c)});