// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Collection ../../core/Evented ../../core/Handles ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../LayerList/support/layerListUtils ./ListItem".split(" "),function(m,h,f,r,t,g,k,x,y,z,u,v,n){const p=f.ofType(n);f=function(q){function l(a){a=q.call(this,a)||this;a._handles=
new t;a.listItemCreatedFunction=null;a.tableItems=new p;a.map=null;return a}m._inheritsLoose(l,q);var d=l.prototype;d.initialize=function(){this._handles.add([g.watch(()=>{var a;return[this.map,null==(a=this.map)?void 0:a.loaded]},()=>this._mapHandles(),g.initial),g.watch(()=>this.listItemCreatedFunction,()=>this._listItemCreatedFunctionChanged())],"map")};d.destroy=function(){this._handles.destroy();this.map=this._handles=null;this.tableItems.removeAll()};d.triggerAction=function(a,b){a&&!a.disabled&&
this.emit("trigger-action",{action:a,item:b})};d._mapHandles=function(){const {_handles:a,map:b}=this;a.remove("tables");this._compileList();b&&a.add(g.watch(()=>{var c,e;return null==(c=this.map)?void 0:null==(e=c.allTables)?void 0:e.toArray()},()=>this._compileList(),g.initial),"tables")};d._removeAllItems=function(){this.tableItems.removeAll()};d._getViewableTables=function(a){if(a)return a.filter(b=>"hide"!==v.findLayerListMode(b))};d._watchTablesListMode=function(a){const {_handles:b}=this;b.remove("layer-list-mode");
a&&a.forEach(c=>{b.add(g.watch(()=>c.listMode,()=>this._compileList()),"layer-list-mode")})};d._compileList=function(){var a;const b=null==(a=this.map)?void 0:a.tables;this._watchTablesListMode(b);(a=this._getViewableTables(b))&&a.length?(this._createNewItems(a),this._removeItems(a),this._sortItems(a)):this._removeAllItems()};d._createNewItems=function(a){const {tableItems:b,listItemCreatedFunction:c}=this;a.forEach(e=>{b.find(w=>w.layer===e)||b.add(new n({layer:e,listItemCreatedFunction:c}))})};
d._removeItems=function(a){const {tableItems:b}=this;b.forEach(c=>{c&&(a&&a.find(e=>c.layer===e)||b.remove(c))})};d._sortItems=function(a){const {tableItems:b}=this;b.sort((c,e)=>{c=a.indexOf(c.layer);e=a.indexOf(e.layer);return c>e?-1:c<e?1:0})};d._listItemCreatedFunctionChanged=function(){this._removeAllItems();this._compileList()};m._createClass(l,[{key:"state",get:function(){var a;const b=null==(a=this.map)?void 0:a.loadStatus;return"string"===typeof b?"loaded"===b?"ready":"loading"===b?"loading":
"disabled":"disabled"}}]);return l}(r.EventedAccessor);h.__decorate([k.property()],f.prototype,"listItemCreatedFunction",void 0);h.__decorate([k.property({type:p})],f.prototype,"tableItems",void 0);h.__decorate([k.property()],f.prototype,"map",void 0);h.__decorate([k.property({readOnly:!0})],f.prototype,"state",null);return f=h.__decorate([u.subclass("esri.widgets.TableList.TableListViewModel")],f)});