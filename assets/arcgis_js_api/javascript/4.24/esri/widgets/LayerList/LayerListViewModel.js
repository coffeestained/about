// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Collection ../../core/Evented ../../core/Handles ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./ListItem ./support/layerListUtils".split(" "),function(t,m,g,x,y,h,p,A,B,C,z,u,r){const v=g.ofType(u);g=function(w){function q(a){a=w.call(this,a)||this;a._handles=new y;a.listItemCreatedFunction=
null;a.operationalItems=new v;a.view=null;return a}t._inheritsLoose(q,w);var e=q.prototype;e.initialize=function(){this._handles.add([h.watch(()=>{var a;return[this.view,null==(a=this.view)?void 0:a.ready]},()=>this._viewHandles(),h.initial),h.watch(()=>this.listItemCreatedFunction,()=>this._listItemCreatedFunctionChanged())],"view")};e.destroy=function(){this._handles.destroy();this.view=this._handles=null;this.operationalItems.removeAll()};e.triggerAction=function(a,b){a&&!a.disabled&&this.emit("trigger-action",
{action:a,item:b})};e.moveListItem=function(a,b,c,d){var f,k;const n=null==a?void 0:a.layer;if(n){var l=null==(f=this.view)?void 0:null==(k=f.map)?void 0:k.layers;f=b?r.getItemLayers(b):l;l=c?r.getItemLayers(c):l;f&&l&&({operationalItems:k}=this,b=(null==b?void 0:b.children)||k,k=(null==c?void 0:c.children)||k,d=l.length-d,a.parent=c||null,b.includes(a)&&b.remove(a),f.includes(n)&&f.remove(n),k.includes(a)||k.add(a,d),l.includes(n)||l.add(n,d))}};e._createLayerViewHandles=function(a){const {_handles:b}=
this;b.remove("layer-views");this._compileList();a&&b.add(a.on("change",()=>this._compileList()),"layer-views")};e._createMapLayerHandles=function(a){const {_handles:b}=this;b.remove("map-layers");this._compileList();a&&b.add(a.on("change",()=>this._compileList()),"map-layers")};e._createListItem=function(a){const {view:b,listItemCreatedFunction:c}=this;return new u({layer:a,listItemCreatedFunction:c,view:b})};e._removeAllItems=function(){const {_handles:a,operationalItems:b}=this;b.forEach(c=>{a.remove(`${"children"}-${c.uid}`)});
b.removeAll()};e._getViewableLayers=function(a){if(a)return a.filter(b=>"hide"!==r.findLayerListMode(b))};e._watchLayersListMode=function(a){const {_handles:b}=this;b.remove("layer-list-mode");a&&a.forEach(c=>{"listMode"in c&&b.add(h.watch(()=>c.listMode,()=>this._compileList()),"layer-list-mode")})};e._compileList=function(){var a=this.get("view.map.layers");this._watchLayersListMode(a);(a=this._getViewableLayers(a))&&a.length?(this._createNewItems(a),this._removeItems(a),this._sortItems(a)):this._removeAllItems()};
e._createNewItems=function(a){const {operationalItems:b}=this;a.forEach(c=>{b.find(d=>d.layer===c)||b.add(this._createListItem(c))})};e._removeItems=function(a){const {_handles:b,operationalItems:c}=this,d=[];c.forEach(f=>{f&&a&&a.includes(f.layer)||(b.remove(`${"children"}-${f.uid}`),d.push(f))});c.removeMany(d)};e._sortItems=function(a){const {operationalItems:b}=this;b.sort((c,d)=>{c=a.indexOf(c.layer);d=a.indexOf(d.layer);return c>d?-1:c<d?1:0})};e._listItemCreatedFunctionChanged=function(){this._removeAllItems();
this._compileList()};e._viewHandles=function(){const {_handles:a,view:b}=this;a.remove(["map-layers","layer-views","view-layers"]);this._compileList();b&&b.ready&&a.add([h.watch(()=>{var c,d;return null==(c=this.view)?void 0:null==(d=c.map)?void 0:d.allLayers},c=>this._createMapLayerHandles(c),h.initial),h.watch(()=>{var c;return null==(c=this.view)?void 0:c.allLayerViews},c=>this._createLayerViewHandles(c),h.initial)],"view-layers")};t._createClass(q,[{key:"state",get:function(){const a=this.get("view");
return this.get("view.ready")?"ready":a?"loading":"disabled"}}]);return q}(x.EventedAccessor);m.__decorate([p.property()],g.prototype,"listItemCreatedFunction",void 0);m.__decorate([p.property({type:v})],g.prototype,"operationalItems",void 0);m.__decorate([p.property({readOnly:!0})],g.prototype,"state",null);m.__decorate([p.property()],g.prototype,"view",void 0);return g=m.__decorate([z.subclass("esri.widgets.LayerList.LayerListViewModel")],g)});