// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/has ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/aliasOf ../core/arrayUtils ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ./Widget ./Measurement/MeasurementViewModel ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),function(p,q,e,c,z,v,r,E,F,l,A,B,y,G,C,D){const u=t=>Object.freeze(Object.defineProperty({__proto__:null,
default:t},Symbol.toStringTag,{value:"Module"}));c=function(t){function w(a,b){a=t.call(this,a,b)||this;a._widgets=new Map;a.activeTool=null;a.activeWidget=null;a.areaUnit=null;a.iconClass="esri-icon-measure";a.label=void 0;a.linearUnit=null;a.messages=null;a.view=null;a.viewModel=new y;return a}q._inheritsLoose(w,t);var f=w.prototype;f.initialize=function(){var a=this;this.activeWidget&&this.viewModel.set("activeViewModel",this.activeWidget.viewModel);this.view&&this.activeTool&&this._getActiveWidget().then(b=>
{this._set("activeWidget",b)});this.own([v.watch(()=>[this.view,this.activeTool],q._asyncToGenerator(function*(){a._set("activeWidget",yield a._getActiveWidget())})),v.watch(()=>this.activeWidget,(b,g)=>{this.viewModel.set("activeViewModel",b?b.viewModel:null);g&&(g.visible=!1)}),v.watch(()=>[this.areaUnit,this.linearUnit,this.uiStrings],()=>this._updateSubWidgetProperties())])};f.destroy=function(){this._destroyWidgets()};f.render=function(){var {activeWidget:a}=this;a=a&&!a.destroyed?a.render():
null;return D.tsx("div",{class:"esri-measurement"},a)};f.clear=function(){this.activeTool=null;this._destroyWidgets()};f.startMeasurement=function(){const {activeViewModel:a}=this.viewModel;a&&z.ignoreAbortErrors(a.start())};f._createWidget=function(){var a=q._asyncToGenerator(function*(b){const {areaUnit:g,linearUnit:d,view:m}=this;switch(b){case "area":{const {type:n}=m;switch(n){case "2d":return new (yield new Promise((h,k)=>p(["./AreaMeasurement2D"],x=>h(u(x)),k))).default({view:m,unit:g,uiStrings:this._createUIStringsForWidget(b)});
case "3d":return new (yield new Promise((h,k)=>p(["./AreaMeasurement3D"],x=>h(u(x)),k))).default({view:m,unit:g,uiStrings:this._createUIStringsForWidget(b)});default:return null}}case "distance":return new (yield new Promise((n,h)=>p(["./DistanceMeasurement2D"],k=>n(u(k)),h))).default({view:m,unit:d,uiStrings:this._createUIStringsForWidget(b)});case "direct-line":return new (yield new Promise((n,h)=>p(["./DirectLineMeasurement3D"],k=>n(u(k)),h))).default({view:m,unit:d,uiStrings:this._createUIStringsForWidget(b)});
default:return null}});return function(b){return a.apply(this,arguments)}}();f._destroyWidgets=function(){this._widgets.forEach(a=>a.destroy());this._widgets.clear()};f._getActiveWidget=function(){var a=q._asyncToGenerator(function*(){const {activeTool:b,view:g}=this;if(!g||!b)return null;let d=null;if(this._widgets.has(b))d=this._widgets.get(b),d.visible=!0;else{d=yield this._createWidget(b);if(!d)return null;yield d.viewModel.start();this._widgets.set(b,d)}return d});return function(){return a.apply(this,
arguments)}}();f._createUIStringsForWidget=function(a){return this.uiStrings?this.uiStrings[a+"-"+this.view.type]:null};f._updateSubWidgetProperties=function(){this._widgets.forEach((a,b)=>{const {areaUnit:g,linearUnit:d}=this;a.unit=!a||"esri.widgets.AreaMeasurement2D"!==a.declaredClass&&"esri.widgets.AreaMeasurement3D"!==a.declaredClass?d:g;a.uiStrings=this._createUIStringsForWidget(b)})};return w}(B);e.__decorate([r.aliasOf("viewModel.activeTool")],c.prototype,"activeTool",void 0);e.__decorate([l.property({readOnly:!0})],
c.prototype,"activeWidget",void 0);e.__decorate([r.aliasOf("viewModel.areaUnit")],c.prototype,"areaUnit",void 0);e.__decorate([l.property()],c.prototype,"iconClass",void 0);e.__decorate([l.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],c.prototype,"label",void 0);e.__decorate([r.aliasOf("viewModel.linearUnit")],c.prototype,"linearUnit",void 0);e.__decorate([l.property(),C.messageBundle("esri/widgets/Measurement/t9n/Measurement")],c.prototype,"messages",void 0);e.__decorate([l.property()],
c.prototype,"uiStrings",void 0);e.__decorate([r.aliasOf("viewModel.view")],c.prototype,"view",void 0);e.__decorate([l.property({type:y})],c.prototype,"viewModel",void 0);return c=e.__decorate([A.subclass("esri.widgets.Measurement")],c)});