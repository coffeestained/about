// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/HandleOwner ../core/maybe ../core/reactiveUtils ../core/accessorSupport/decorators/aliasOf ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/cast ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ./Widget ./FeatureTemplates/FeatureTemplatesViewModel ./FeatureTemplates/ItemList ./FeatureTemplates/TemplateItem ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory".split(" "),
function(t,q,d,c,A,x,r,K,L,B,k,C,D,y,E,F,M,G,H,u){function I(m){const {label:n}=m;return"items"in m?n:`${n}\u2013${m.layer.id}`}const z={filter:!0};c=function(m){function n(a,b){a=m.call(this,a,b)||this;a._iconIntersectionObserver=new IntersectionObserver((g,l)=>{g.forEach(function(){var p=q._asyncToGenerator(function*(h){if(h.isIntersecting){const e=h.target;if(e["data-has-icon"])l.unobserve(e);else{var {layer:v,template:w}=e["data-item"];e["data-has-icon"]=!0;h=yield F.fetchThumbnail(v,w).catch(()=>
{e["data-has-icon"]=!1;return null});A.isNone(h)||e.appendChild(h)}}});return function(h){return p.apply(this,arguments)}}())});a.enableListScroll=!0;a.filterFunction=null;a.filterText="";a.groupBy=null;a.headingLevel=4;a.label=void 0;a.layers=null;a.messages=null;a.selectedItem=null;a.viewModel=new y;a.visibleElements={...z};a.renderItemIcon=a.renderItemIcon.bind(q._assertThisInitialized(a));a._afterItemCreateOrUpdate=a._afterItemCreateOrUpdate.bind(q._assertThisInitialized(a));a._afterItemRemoved=
a._afterItemRemoved.bind(q._assertThisInitialized(a));return a}q._inheritsLoose(n,m);var f=n.prototype;f.initialize=function(){const a=({label:b})=>!this.filterText||b.toLowerCase().includes(this.filterText.toLowerCase());this.own(x.watch(()=>this.viewModel,(b,g)=>{b&&!b.filterFunction&&(this.filterFunction=a);g&&g!==b&&g.filterFunction===a&&(g.filterFunction=null)},x.initial))};f.destroy=function(){this._iconIntersectionObserver&&(this._iconIntersectionObserver.disconnect(),this._iconIntersectionObserver=
null)};f.loadDependencies=function(){return Promise.all([new Promise((a,b)=>t(["../chunks/calcite-icon"],a,b)),new Promise((a,b)=>t(["../chunks/calcite-input"],a,b)),new Promise((a,b)=>t(["../chunks/calcite-list-item"],a,b)),new Promise((a,b)=>t(["../chunks/calcite-progress"],a,b))])};f.castVisibleElements=function(a){return{...z,...a}};f.select=function(a){return null};f.render=function(){const {enableListScroll:a,filterText:b,headingLevel:g,messages:l,viewModel:{items:p,selectedItem:h,state:v}}=
this,w=this.visibleElements.filter;if(0<p.length&&"items"in p[0]){const e=p.find(J=>J.label===y.nullGroupBy.label);e&&(e.label=l.other)}return u.tsx("div",{class:this.classes("esri-feature-templates","esri-widget"),"aria-label":l.widgetLabel},"loading"===v?this.renderLoader():"ready"===v?u.tsx(E.ItemList,{id:this.id,identify:I,filterText:b,items:p,headingLevel:g,messages:{filterPlaceholder:l.filterPlaceholder,noItems:l.noItems,noMatches:l.noMatches},filterEnabled:w,onItemSelect:e=>{this.viewModel.select(e)},
onFilterChange:e=>{this.filterText=e;this.viewModel.refresh()},renderIcon:this.renderItemIcon,selectedItem:h,enableListScroll:a}):null)};f.renderItemIcon=function({item:a}){return u.tsx("span",{key:"icon",afterCreate:this._afterItemCreateOrUpdate,afterUpdate:this._afterItemCreateOrUpdate,afterRemoved:this._afterItemRemoved,"data-item":a,"data-has-icon":!1})};f.renderLoader=function(){return u.tsx("div",{class:"esri-feature-templates__loader",key:"loader"})};f._afterItemCreateOrUpdate=function(a){var b;
null==(b=this._iconIntersectionObserver)?void 0:b.observe(a)};f._afterItemRemoved=function(a){var b;null==(b=this._iconIntersectionObserver)?void 0:b.unobserve(a)};return n}(c.HandleOwnerMixin(D));d.__decorate([k.property()],c.prototype,"enableListScroll",void 0);d.__decorate([r.aliasOf("viewModel.filterFunction")],c.prototype,"filterFunction",void 0);d.__decorate([k.property()],c.prototype,"filterText",void 0);d.__decorate([r.aliasOf("viewModel.groupBy")],c.prototype,"groupBy",void 0);d.__decorate([k.property()],
c.prototype,"headingLevel",void 0);d.__decorate([k.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],c.prototype,"label",void 0);d.__decorate([r.aliasOf("viewModel.layers")],c.prototype,"layers",void 0);d.__decorate([k.property(),G.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],c.prototype,"messages",void 0);d.__decorate([r.aliasOf("viewModel.selectedItem")],c.prototype,"selectedItem",void 0);d.__decorate([k.property(),H.vmEvent("select")],c.prototype,"viewModel",
void 0);d.__decorate([k.property()],c.prototype,"visibleElements",void 0);d.__decorate([B.cast("visibleElements")],c.prototype,"castVisibleElements",null);d.__decorate([r.aliasOf("viewModel.select")],c.prototype,"select",null);return c=d.__decorate([C.subclass("esri.widgets.FeatureTemplates")],c)});