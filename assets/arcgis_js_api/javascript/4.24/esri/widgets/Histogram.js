// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../intl ../core/maybe ../core/accessorSupport/decorators/aliasOf ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ./Widget ./Histogram/HistogramViewModel ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory ../intl/substitute".split(" "),function(x,g,d,A,r,L,M,N,m,B,C,D,E,F,l,G){var w;d=w=function(y){function t(a,
b){a=y.call(this,a,b)||this;a._bgFillId=`${a.id}-bg-fill`;a._containerNode=null;a._containerDimensions={width:0,height:0};a._defaultBarColor="#d8d8d8";a.average=null;a.barCreatedFunction=null;a.bins=null;a.dataLines=null;a.dataLineCreatedFunction=null;a.dataLineUpdatedFunction=null;a.label=void 0;a.labelFormatFunction=null;a.max=null;a.messages=null;a.min=null;a.state=null;a.viewModel=new D;return a}x._inheritsLoose(t,y);t.fromHistogramResult=function(a){const {bins:b,maxValue:c,minValue:e}=a;return new w({bins:b,
max:c,min:e})};var h=t.prototype;h.render=function(){const {label:a,layout:b,state:c}=this,e=this.classes("esri-histogram","esri-widget","horizontal"===b?"esri-histogram--horizontal":"esri-histogram--vertical","disabled"===c?"esri-disabled":null);return l.tsx("div",{"aria-label":a,class:e,bind:this,afterCreate:this._afterContainerNodeCreate},"ready"===c?this.renderContent():null)};h.renderContent=function(){if(this._containerNode){var a=this._bgFillId,b=`clip-path: url(#${a})`;return l.tsx("div",
{class:"esri-histogram__content"},l.tsx("svg",{class:"esri-histogram__svg",xmlns:"http://www.w3.org/2000/svg"},l.tsx("defs",null,this.renderFillDefinition(a)),l.tsx("g",{style:b},this.renderBarsGroup()),this.renderLinesGroup()))}};h.renderBarsGroup=function(){return l.tsx("g",{class:this.classes("esri-histogram__bars")},this.renderBars())};h.renderBars=function(){const {layout:a,viewModel:{binRange:b,range:c}}=this;if(b&&c){var e=b/c,{width:f,height:k}=this._containerDimensions;if(0!==k||0!==f)if(0===
k&&0!==f)this.scheduleRender();else{var [n,q]="vertical"===a?[k*e,f]:[k,f*e];return this._getBarDimensions(n,q).map(([u,v],p)=>this.renderBar(p,u,v))}}};h.renderBar=function(a,b,c){const {bins:e,layout:f,max:k,messages:n,viewModel:{range:q}}=this,{width:u,height:v}=this._containerDimensions;var p=e.slice()[a];const {count:H,maxValue:z,minValue:I}=p;p=k-z;const [J,K]="vertical"===f?[0,v/q*p]:[u-c-u/q*p,v-b];p=G.substitute(n.barLabel,{count:H,maxValue:z,minValue:I});return l.tsx("rect",{"aria-label":p,
afterCreate:this._afterBarCreate,bind:this,class:"esri-histogram__bar","data-index":a,fill:this._defaultBarColor,height:b,role:"img","shape-rendering":"crispEdges","stroke-width":"0",width:c,x:J,y:K})};h.renderLinesGroup=function(){return l.tsx("g",{class:this.classes("esri-histogram__data-lines")},this.renderAverageLine(),this.renderCustomLines())};h.renderAverageLine=function(){const {average:a}=this;if(!A.isNone(a)){var b=[l.tsx("tspan",{class:this.classes("esri-histogram__average-symbol")},"x\u0304 "),
l.tsx("tspan",{class:this.classes("esri-histogram__average-label")},this.labelFormatFunction?this.labelFormatFunction(a,"average"):a)];return l.tsx("g",{afterCreate:this._afterLinesSubgroupCreate,afterUpdate:this._afterLinesSubgroupUpdate,bind:this,class:this.classes("esri-histogram__data-lines-subgroup")},l.tsx("title",{key:"title"},a),this.renderLine(a,this.classes("esri-histogram__average-data-line")),this.renderLabel(a,b))}};h.renderCustomLines=function(){if(this.dataLines&&this.dataLines.length)return this.dataLines.map(({value:a,
label:b},c)=>this.renderLineSubgroup(c,a,String(b)))};h.renderLineSubgroup=function(a,b,c){return l.tsx("g",{afterCreate:this._afterLinesSubgroupCreate,afterUpdate:this._afterLinesSubgroupUpdate,bind:this,class:this.classes("esri-histogram__data-lines-subgroup"),"data-index":a},l.tsx("title",{key:"title"},b),this.renderLine(b),this.renderLabel(b,c))};h.renderLine=function(a,b){const [c,e,f,k]=this._getLinePosition(a);return l.tsx("line",{class:this.classes("esri-histogram__data-line",b),x1:c,x2:e,
y1:f,y2:k,"shape-rendering":"crispEdges"})};h.renderLabel=function(a,b,c){const [e,f]=this._getLabelPosition(a);return l.tsx("text",{class:this.classes("esri-histogram__label",c),"text-anchor":"end",transform:"horizontal"===this.layout?"rotate(270)":null,x:e,y:f-2},b)};h.renderFillDefinition=function(a){const {width:b,height:c}=this._containerDimensions;return l.tsx("clipPath",{id:a},l.tsx("rect",{x:"0",y:"0",width:b,height:c}))};h._afterContainerNodeCreate=function(a){this._containerNode=a;this.own(E.onResize(a,
b=>{const {width:c,height:e}=b.contentRect;this._containerDimensions={width:c,height:e}}))};h._afterBarCreate=function(a){if(this.barCreatedFunction){const b=a.dataset?parseInt(a.dataset.index,10):a.getAttribute("data-index")?parseInt(a.getAttribute("data-index"),10):null;this.barCreatedFunction(isNaN(b)?null:b,a)}};h._afterLinesSubgroupCreate=function(a){if(this.dataLineCreatedFunction){const b=a.dataset?parseInt(a.dataset.index,10):a.getAttribute("data-index")?parseInt(a.getAttribute("data-index"),
10):null;this.dataLineCreatedFunction(a.childNodes[0],a.childNodes[1]?a.childNodes[1]:null,isNaN(b)?null:b)}};h._afterLinesSubgroupUpdate=function(a){if(this.dataLineUpdatedFunction){const b=a.dataset?parseInt(a.dataset.index,10):a.getAttribute("data-index")?parseInt(a.getAttribute("data-index"),10):null;this.dataLineUpdatedFunction(a.childNodes[0],a.childNodes[1]?a.childNodes[1]:null,isNaN(b)?null:b)}};h._getBarDimensions=function(a,b){const {bins:c,layout:e}=this,f=c?c.map(n=>n.count):[],k=Math.max.apply(Math,
f);return f.map(n=>"vertical"===e?[a/f.length,0!==k?n/k*b:0]:[0!==k?n/k*a:0,b/f.length])};h._getLinePosition=function(a){const {layout:b,min:c,viewModel:{range:e}}=this;a=Math.round((a-c)/e*100)/100;const {width:f,height:k}=this._containerDimensions,[n,q]=[a*f||1,k-a*k||1];return"vertical"===b?[0,"100%",q,q]:[n,n,"100%",0]};h._getLabelPosition=function(a){const {layout:b,min:c,viewModel:{range:e}}=this;a=Math.round((a-c)/e*100)/100;const {width:f,height:k}=this._containerDimensions;return"vertical"===
b?[f,k-a*k]:[0,a*f]};x._createClass(t,[{key:"layout",set:function(a){"vertical"!==a&&(a="horizontal");this._set("layout",a)}}]);return t}(C);g.__decorate([m.property()],d.prototype,"_bgFillId",void 0);g.__decorate([m.property()],d.prototype,"_containerNode",void 0);g.__decorate([m.property()],d.prototype,"_containerDimensions",void 0);g.__decorate([m.property()],d.prototype,"_defaultBarColor",void 0);g.__decorate([r.aliasOf("viewModel.average")],d.prototype,"average",void 0);g.__decorate([m.property()],
d.prototype,"barCreatedFunction",void 0);g.__decorate([r.aliasOf("viewModel.bins")],d.prototype,"bins",void 0);g.__decorate([m.property()],d.prototype,"dataLines",void 0);g.__decorate([m.property()],d.prototype,"dataLineCreatedFunction",void 0);g.__decorate([m.property()],d.prototype,"dataLineUpdatedFunction",void 0);g.__decorate([m.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],d.prototype,"label",void 0);g.__decorate([r.aliasOf("viewModel.labelFormatFunction")],d.prototype,
"labelFormatFunction",void 0);g.__decorate([m.property({value:"horizontal"})],d.prototype,"layout",null);g.__decorate([r.aliasOf("viewModel.max")],d.prototype,"max",void 0);g.__decorate([m.property(),F.messageBundle("esri/widgets/Histogram/t9n/Histogram")],d.prototype,"messages",void 0);g.__decorate([r.aliasOf("viewModel.min")],d.prototype,"min",void 0);g.__decorate([r.aliasOf("viewModel.state")],d.prototype,"state",void 0);g.__decorate([m.property()],d.prototype,"viewModel",void 0);return d=w=g.__decorate([B.subclass("esri.widgets.Histogram")],
d)});