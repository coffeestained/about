// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
require({cache:{"esri/core/accessorSupport/originUtils":function(){define(["exports","../multiOriginJSONSupportUtils"],function(a,f){a.updateOrigins=function(b){b&&b.writtenProperties&&b.writtenProperties.forEach(({target:m,propName:y,newOrigin:q})=>{f.isMultiOriginJSONMixin(m)&&q&&m.originOf(y)!==q&&m.updateOrigin(y,q)})};Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/multiOriginJSONSupportUtils":function(){define(["exports"],function(a){a.isMultiOriginJSONMixin=
function(f){return f&&"getAtOrigin"in f&&"originOf"in f};Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/support/MapFloorInfo":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../layers/support/FacilityLayerInfo ../layers/support/LevelLayerInfo ../layers/support/SiteLayerInfo".split(" "),
function(a,f,b,m,y,q,A,d,p,l,h){b=function(k){function w(G){G=k.call(this,G)||this;G.levelLayer=null;G.facilityLayer=null;G.siteLayer=null;return G}a._inheritsLoose(w,k);return w}(b.JSONSupport);f.__decorate([m.property({type:l,json:{write:!0}})],b.prototype,"levelLayer",void 0);f.__decorate([m.property({type:p,json:{write:!0}})],b.prototype,"facilityLayer",void 0);f.__decorate([m.property({type:h,json:{write:!0}})],b.prototype,"siteLayer",void 0);return b=f.__decorate([d.subclass("esri.support.MapFloorInfo")],
b)})},"esri/layers/support/FacilityLayerInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(a,f,b,m,y,q,A,d){b=function(p){function l(h){h=p.call(this,h)||this;h.facilityIdField=null;h.layerId=null;h.nameField=null;h.siteIdField=null;h.sublayerId=null;return h}
a._inheritsLoose(l,p);return l}(b.JSONSupport);f.__decorate([m.property({type:String,json:{write:!0}})],b.prototype,"facilityIdField",void 0);f.__decorate([m.property({type:String,json:{write:!0}})],b.prototype,"layerId",void 0);f.__decorate([m.property({type:String,json:{write:!0}})],b.prototype,"nameField",void 0);f.__decorate([m.property({type:String,json:{write:!0}})],b.prototype,"siteIdField",void 0);f.__decorate([m.property({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},
origins:{"web-scene":{read:!1,write:!1}}}})],b.prototype,"sublayerId",void 0);return b=f.__decorate([d.subclass("esri.layers.support.FacilityLayerInfo")],b)})},"esri/layers/support/LevelLayerInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(a,f,b,m,y,
q,A,d){b=function(p){function l(h){h=p.call(this,h)||this;h.facilityIdField=null;h.layerId=null;h.levelIdField=null;h.levelNumberField=null;h.longNameField=null;h.shortNameField=null;h.sublayerId=null;h.verticalOrderField=null;return h}a._inheritsLoose(l,p);return l}(b.JSONSupport);f.__decorate([m.property({type:String,json:{write:!0}})],b.prototype,"facilityIdField",void 0);f.__decorate([m.property({type:String,json:{write:!0}})],b.prototype,"layerId",void 0);f.__decorate([m.property({type:String,
json:{write:!0}})],b.prototype,"levelIdField",void 0);f.__decorate([m.property({type:String,json:{write:!0}})],b.prototype,"levelNumberField",void 0);f.__decorate([m.property({type:String,json:{write:!0}})],b.prototype,"longNameField",void 0);f.__decorate([m.property({type:String,json:{write:!0}})],b.prototype,"shortNameField",void 0);f.__decorate([m.property({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],b.prototype,"sublayerId",
void 0);f.__decorate([m.property({type:String,json:{write:!0}})],b.prototype,"verticalOrderField",void 0);return b=f.__decorate([d.subclass("esri.layers.support.LevelLayerInfo")],b)})},"esri/layers/support/SiteLayerInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,f,b,m,y,q,A,d){b=function(p){function l(h){h=p.call(this,h)||this;h.layerId=null;h.nameField=null;h.siteIdField=null;h.sublayerId=null;return h}a._inheritsLoose(l,p);return l}(b.JSONSupport);f.__decorate([m.property({type:String,json:{write:!0}})],b.prototype,"layerId",void 0);f.__decorate([m.property({type:String,json:{write:!0}})],b.prototype,"nameField",void 0);f.__decorate([m.property({type:String,json:{write:!0}})],b.prototype,"siteIdField",void 0);f.__decorate([m.property({type:Number,
json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],b.prototype,"sublayerId",void 0);return b=f.__decorate([d.subclass("esri.layers.support.SiteLayerInfo")],b)})},"esri/support/webSceneUtils":function(){define(["exports","../core/Error"],function(a,f){a.createCopyError=function(){return new f("webscene:failed-to-copy-embedded-resources","Copying of embedded resources is currently not supported")};a.createSchemaValidationError=function(b){return new f("webscene:schema-validation",
"Failed to save webscene due to schema validation errors. See 'details.errors' for more detailed information",{errors:b})};a.isCopyError=function(b){return b&&"webscene:failed-to-copy-embedded-resources"===b.name};a.isSchemaValidationError=function(b){return b&&"webscene:schema-validation"===b.name};Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/support/spatialReferenceSupport":function(){define(["exports","../../geometry/support/SupportedGCSWkids",
"../ViewingMode"],function(a,f,b){a.isSpatialReferenceSupported=function(m,y){return null==m?!1:null==y?!0:y===b.ViewingMode.Local?m.isGeographic?m.isWGS84||m.wkid===f.SupportedGCSWkids.CGCS2000:!0:m.isWebMercator||m.isWGS84||m.wkid===f.SupportedGCSWkids.CGCS2000||m.wkid===f.SupportedGCSWkids.GCSMARS2000||m.wkid===f.SupportedGCSWkids.GCSMARS2000_SPHERE||m.wkid===f.SupportedGCSWkids.GCSMOON2000};Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/webdoc/support/saveUtils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/asyncUtils ../../core/Error ../../core/promiseUtils ../../core/uuid ../../portal/support/resourceUtils".split(" "),
function(a,f,b,m,y,q,A){function d(){d=f._asyncToGenerator(function*(w,G,r){if(G&&G.resources){var z=G.portalItem===w.portalItem?new Set(w.paths):new Set;w.paths.length=0;w.portalItem=G.portalItem;var K=new Set(G.resources.toKeep.map(L=>L.resource.path)),F=new Set,N=[];K.forEach(L=>{z.delete(L);w.paths.push(L)});for(const L of G.resources.toUpdate)if(z.delete(L.resource.path),K.has(L.resource.path)||F.has(L.resource.path)){const {resource:ba,content:da,finish:ja,error:V}=L,ma=A.getSiblingOfSameTypeI(ba,
q.generateUUID());w.paths.push(ma.path);N.push(p({resource:ma,content:da,finish:ja,error:V},r))}else w.paths.push(L.resource.path),N.push(h(L,r)),F.add(L.resource.path);for(const L of G.resources.toAdd)N.push(p(L,r)),w.paths.push(L.resource.path);z.forEach(L=>{L=G.portalItem.resourceFromPath(L);N.push(L.portalItem.removeResource(L).catch(()=>{}))});if(0!==N.length&&(K=yield y.eachAlways(N),y.throwIfAborted(r),r=K.filter(L=>"error"in L).map(L=>L.error),0<r.length))throw new m("save:resources","Failed to save one or more resources",
{errors:r});}});return d.apply(this,arguments)}function p(w,G){return l.apply(this,arguments)}function l(){l=f._asyncToGenerator(function*(w,G){G=yield b.result(w.resource.portalItem.addResource(w.resource,w.content,G));if(!0===G.ok)w.finish&&w.finish(w.resource);else throw w.error&&w.error(G.error),G.error;});return l.apply(this,arguments)}function h(w,G){return k.apply(this,arguments)}function k(){k=f._asyncToGenerator(function*(w,G){G=yield b.result(w.resource.update(w.content,G));if(!0===G.ok)w.finish(w.resource);
else throw w.error(G.error),G.error;});return k.apply(this,arguments)}a.saveResources=function(w,G,r){return d.apply(this,arguments)};Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/portal/support/resourceUtils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../request ../../core/Error ../../core/maybe ../../core/urlUtils".split(" "),function(a,f,b,m,y,q){function A(){A=f._asyncToGenerator(function*(r,z={},K){yield r.load(K);
var F=q.join(r.itemUrl,"resources");const {start:N=1,num:L=10,sortOrder:ba="asc",sortField:da="created"}=z;z={query:{start:N,num:L,sortOrder:ba,sortField:da,token:r.apiKey},signal:y.get(K,"signal")};F=yield r.portal._request(F,z);return{total:F.total,nextStart:F.nextStart,resources:F.resources.map(({created:ja,size:V,resource:ma})=>({created:new Date(ja),size:V,resource:r.resourceFromPath(ma)}))}});return A.apply(this,arguments)}function d(){d=f._asyncToGenerator(function*(r,z,K,F){if(!r.hasPath())throw new m(`portal-item-resource-${z}:invalid-path`,
"Resource does not have a valid path");const N=r.portalItem;yield N.load(F);z=q.join(N.userItemUrl,"add"===z?"addResources":"updateResources");const [L,ba]=h(r.path);K=yield w(K);const da=new FormData;L&&"."!==L&&da.append("resourcesPrefix",L);da.append("fileName",ba);da.append("file",K,ba);da.append("f","json");y.isSome(F)&&F.access&&da.append("access",F.access);yield N.portal._request(z,{method:"post",body:da,signal:y.get(F,"signal")});return r});return d.apply(this,arguments)}function p(){p=f._asyncToGenerator(function*(r,
z,K){if(!z.hasPath())throw new m("portal-item-resources-remove:invalid-path","Resource does not have a valid path");yield r.load(K);const F=q.join(r.userItemUrl,"removeResources");yield r.portal._request(F,{method:"post",query:{resource:z.path},signal:y.get(K,"signal")});z.portalItem=null});return p.apply(this,arguments)}function l(){l=f._asyncToGenerator(function*(r,z){yield r.load(z);const K=q.join(r.userItemUrl,"removeResources");return r.portal._request(K,{method:"post",query:{deleteAll:!0},signal:y.get(z,
"signal")})});return l.apply(this,arguments)}function h(r){const z=r.lastIndexOf("/");return-1===z?[".",r]:[r.slice(0,z),r.slice(z+1)]}function k(r){{const L=q.getPathExtension(r);r=y.isNone(L)?[r,""]:[r.slice(0,r.length-L.length-1),`.${L}`]}const [z,K]=r,[F,N]=h(z);return[F,N,K]}function w(r){return G.apply(this,arguments)}function G(){G=f._asyncToGenerator(function*(r){return r instanceof Blob?r:(yield b(r.url,{responseType:"blob"})).data});return G.apply(this,arguments)}a.addOrUpdateResource=function(r,
z,K,F){return d.apply(this,arguments)};a.contentToBlob=w;a.fetchResources=function(r){return A.apply(this,arguments)};a.getSiblingOfSameType=function(r,z){if(!r.hasPath())return null;const [K,,F]=k(r.path);return r.portalItem.resourceFromPath(q.join(K,z+F))};a.getSiblingOfSameTypeI=function(r,z){if(!r.hasPath())return null;const [K,,F]=k(r.path);return r.portalItem.resourceFromPath(q.join(K,z+F))};a.removeAllResources=function(r,z){return l.apply(this,arguments)};a.removeResource=function(r,z,K){return p.apply(this,
arguments)};a.splitPrefixFileNameAndExtension=k;Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/webdoc/support/thumbnailUtils":function(){define(["exports"],function(a){const f={width:600,height:400};a.getOptimalThumbnailSize=function(b,m){m=m||f;let {width:y,height:q}=m;m=y/q;1.5>m?q=y/1.5:1.5<m&&(y=1.5*q);y>b.width&&(q*=b.width/y,y=b.width);q>b.height&&(y*=b.height/q,q=b.height);return{width:Math.round(y),height:Math.round(q)}};Object.defineProperties(a,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/webscene/ApplicationProperties":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../webdoc/applicationProperties/Viewing".split(" "),function(a,f,b,m,y,q,A,d,p){var l;b=l=function(h){function k(w){w=h.call(this,w)||this;w.viewing=
null;return w}a._inheritsLoose(k,h);k.prototype.clone=function(){return new l({viewing:this.viewing?this.viewing.clone():null})};return k}(b.JSONSupport);f.__decorate([m.property({type:p,json:{write:!0}})],b.prototype,"viewing",void 0);return b=l=f.__decorate([d.subclass("esri.webscene.ApplicationProperties")],b)})},"esri/webdoc/applicationProperties/Viewing":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./Search".split(" "),
function(a,f,b,m,y,q,A,d){var p;b=p=function(l){function h(k){k=l.call(this,k)||this;k.search=null;return k}a._inheritsLoose(h,l);h.prototype.clone=function(){return new p(m.clone({search:this.search}))};return h}(b.JSONSupport);f.__decorate([y.property({type:d,json:{write:!0}})],b.prototype,"search",void 0);return b=p=f.__decorate([A.subclass("esri.webdoc.applicationProperties.Viewing")],b)})},"esri/webdoc/applicationProperties/Search":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Collection ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../core/accessorSupport/extensions/serializableProperty/writePolicyUtils ./SearchLayer ./SearchTable".split(" "),
function(a,f,b,m,y,q,A,d,p,l,h,k,w){var G;const r=b.ofType(k),z=b.ofType(w);b=G=function(K){function F(L){L=K.call(this,L)||this;L.addressSearchEnabled=!0;L.enabled=!0;L.hintText=null;L.layers=new r;L.tables=new z;return L}a._inheritsLoose(F,K);var N=F.prototype;N.readAddressSearchEnabled=function(L){return!L};N.writeAddressSearchEnabled=function(L,ba,da){ba[da]=!L};N.clone=function(){return new G(y.clone({addressSearchEnabled:this.addressSearchEnabled,enabled:this.enabled,hintText:this.hintText,
layers:this.layers,tables:this.tables}))};return F}(m.JSONSupport);f.__decorate([q.property({type:Boolean,nonNullable:!0,json:{read:{source:"disablePlaceFinder"},write:{target:"disablePlaceFinder",isRequired:!0},origins:{"web-scene":{read:!1,write:!1}}}})],b.prototype,"addressSearchEnabled",void 0);f.__decorate([d.reader("addressSearchEnabled")],b.prototype,"readAddressSearchEnabled",null);f.__decorate([l.writer("addressSearchEnabled")],b.prototype,"writeAddressSearchEnabled",null);f.__decorate([q.property({type:Boolean,
nonNullable:!0,json:{write:!0,origins:{"web-map":{write:{isRequired:!0}},"web-scene":{default:!0,write:!0}}}})],b.prototype,"enabled",void 0);f.__decorate([q.property({type:String,json:{write:!0}})],b.prototype,"hintText",void 0);f.__decorate([q.property({type:r,json:{write:{overridePolicy:h.writeNonEmptyCollectionPolicy},origins:{"web-scene":{write:{isRequired:!0}}}}})],b.prototype,"layers",void 0);f.__decorate([q.property({type:z,json:{read:!0,write:{overridePolicy:h.writeNonEmptyCollectionPolicy}}})],
b.prototype,"tables",void 0);return b=G=f.__decorate([p.subclass("esri.webdoc.applicationProperties.Search")],b)})},"esri/core/accessorSupport/extensions/serializableProperty/writePolicyUtils":function(){define(["exports"],function(a){a.writeNonEmptyCollectionPolicy=function(f){return{enabled:!(null==f||!f.length)}};Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/webdoc/applicationProperties/SearchLayer":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./SearchLayerField".split(" "),
function(a,f,b,m,y,q,A,d){var p;b=p=function(l){function h(k){k=l.call(this,k)||this;k.field=null;k.id=null;k.subLayer=null;return k}a._inheritsLoose(h,l);h.prototype.clone=function(){return new p(m.clone({field:this.field,id:this.id,subLayer:this.subLayer}))};return h}(b.JSONSupport);f.__decorate([y.property({type:d,json:{write:{isRequired:!0}}})],b.prototype,"field",void 0);f.__decorate([y.property({type:String,json:{write:{isRequired:!0}}})],b.prototype,"id",void 0);f.__decorate([y.property({type:q.Integer,
json:{write:!0}})],b.prototype,"subLayer",void 0);return b=p=f.__decorate([A.subclass("esri.webdoc.applicationProperties.SearchLayer")],b)})},"esri/webdoc/applicationProperties/SearchLayerField":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ../../layers/support/fieldType".split(" "),
function(a,f,b,m,y,q,A,d,p,l){var h;b=h=function(k){function w(G){G=k.call(this,G)||this;G.exactMatch=!1;G.name=null;G.type=null;return G}a._inheritsLoose(w,k);w.prototype.clone=function(){return new h({exactMatch:this.exactMatch,type:this.type,name:this.name})};return w}(b.JSONSupport);f.__decorate([m.property({type:Boolean,json:{write:!0}})],b.prototype,"exactMatch",void 0);f.__decorate([m.property({type:String,json:{write:!0}})],b.prototype,"name",void 0);f.__decorate([d.enumeration(l.kebabDict)],
b.prototype,"type",void 0);return b=h=f.__decorate([p.subclass("esri.webdoc.applicationProperties.SearchLayerField")],b)})},"esri/webdoc/applicationProperties/SearchTable":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./SearchTableField".split(" "),function(a,f,b,m,y,q,A,d){var p;b=p=function(l){function h(k){k=
l.call(this,k)||this;k.field=null;k.id=null;return k}a._inheritsLoose(h,l);h.prototype.clone=function(){return new p(m.clone({field:this.field,id:this.id}))};return h}(b.JSONSupport);f.__decorate([y.property({type:d,json:{write:{isRequired:!0}}})],b.prototype,"field",void 0);f.__decorate([y.property({type:String,json:{write:{isRequired:!0}}})],b.prototype,"id",void 0);return b=p=f.__decorate([A.subclass("esri.webdoc.applicationProperties.SearchTable")],b)})},"esri/webdoc/applicationProperties/SearchTableField":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ../../layers/support/fieldType".split(" "),
function(a,f,b,m,y,q,A,d,p,l){var h;b=h=function(k){function w(G){G=k.call(this,G)||this;G.exactMatch=!1;G.name=null;G.type=null;return G}a._inheritsLoose(w,k);w.prototype.clone=function(){return new h({exactMatch:this.exactMatch,type:this.type,name:this.name})};return w}(b.JSONSupport);f.__decorate([m.property({type:Boolean,json:{write:!0}})],b.prototype,"exactMatch",void 0);f.__decorate([m.property({type:String,json:{write:!0}})],b.prototype,"name",void 0);f.__decorate([d.enumeration(l.kebabDict)],
b.prototype,"type",void 0);return b=h=f.__decorate([p.subclass("esri.webdoc.applicationProperties.SearchTableField")],b)})},"esri/webscene/Environment":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/lang ../core/Logger ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../views/3d/environment/SunnyWeather ../views/3d/environment/weather ./lightingTypes ./SunLighting ./VirtualLighting ./background/utils".split(" "),
function(a,f,b,m,y,q,A,d,p,l,h,k,w,G){var r;const z=y.getLogger("esri.webscene.Environment");y=(K,F,N)=>({enabled:!N||!N.isPresentation});b=r=function(K){function F(L){L=K.call(this,L)||this;L.lighting=new k;L.background=null;L.atmosphereEnabled=!0;L.starsEnabled=!0;return L}a._inheritsLoose(F,K);var N=F.prototype;N.clone=function(){return new r(this.cloneConstructProperties())};N.cloneConstructProperties=function(){return{lighting:this.lighting&&"virtual"===this.lighting.type?w.prototype.clone.call(this.lighting):
k.prototype.clone.call(this.lighting),background:m.clone(this.background),atmosphereEnabled:this.atmosphereEnabled,starsEnabled:this.starsEnabled,weather:this.weather.clone()}};a._createClass(F,[{key:"weather",set:function(L){l.validateWeatherType(null==L?void 0:L.type,z)&&this._set("weather",L)}}]);return F}(b.JSONSupport);f.__decorate([q.property({types:h.lightingTypes,nonNullable:!0,json:{write:!0}})],b.prototype,"lighting",void 0);f.__decorate([q.property(G.backgroundProperty)],b.prototype,"background",
void 0);f.__decorate([q.property({type:Boolean,nonNullable:!0,json:{write:{overridePolicy:y}}})],b.prototype,"atmosphereEnabled",void 0);f.__decorate([q.property({type:Boolean,nonNullable:!0,json:{write:{overridePolicy:y}}})],b.prototype,"starsEnabled",void 0);f.__decorate([q.property({types:l.weatherTypes,nonNullable:!0,json:{write:!0},value:new p})],b.prototype,"weather",null);return b=r=f.__decorate([d.subclass("esri.webscene.Environment")],b)})},"esri/views/3d/environment/SunnyWeather":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,f,b,m,y,q,A,d,p){var l;b=l=function(h){function k(w){w=h.call(this,w)||this;w.type="sunny";w.cloudCover=.5;return w}a._inheritsLoose(k,h);k.prototype.clone=function(){return new l({cloudCover:this.cloudCover})};return k}(b.JSONSupport);f.__decorate([d.enumeration({sunny:"sunny"})],b.prototype,"type",void 0);f.__decorate([m.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],b.prototype,"cloudCover",void 0);return b=l=f.__decorate([p.subclass("esri.views.3d.environment.SunnyWeather")],
b)})},"esri/views/3d/environment/weather":function(){define("exports ./CloudyWeather ./FoggyWeather ./RainyWeather ./SnowyWeather ./SunnyWeather".split(" "),function(a,f,b,m,y,q){f={key:"type",base:q,typeMap:{sunny:q,cloudy:f,rainy:m,snowy:y,foggy:b}};const A=Object.keys(f.typeMap);a.validateWeatherType=function(d,p){return A.includes(d)?!0:(p.error(`"${d}" is not a valid weather type`),!1)};a.weatherEquals=function(d,p){if(d.type!==p.type)return!1;switch(d.type){case "sunny":return d.cloudCover===
p.cloudCover;case "rainy":return d.cloudCover===p.cloudCover&&d.precipitation===p.precipitation;case "snowy":return d.cloudCover===p.cloudCover&&d.precipitation===p.precipitation&&d.snowCover===p.snowCover;case "cloudy":return d.cloudCover===p.cloudCover;case "foggy":return d.fogStrength===p.fogStrength}};a.weatherHeightLimit=1E4;a.weatherTypes=f;a.weatherTypesArray=A;Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/environment/CloudyWeather":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,f,b,m,y,q,A,d,p){var l;b=l=function(h){function k(w){w=h.call(this,w)||this;w.type="cloudy";w.cloudCover=.5;return w}a._inheritsLoose(k,h);k.prototype.clone=function(){return new l({cloudCover:this.cloudCover})};return k}(b.JSONSupport);f.__decorate([d.enumeration({cloudy:"cloudy"})],b.prototype,"type",void 0);f.__decorate([m.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],b.prototype,"cloudCover",void 0);return b=l=f.__decorate([p.subclass("esri.views.3d.environment.CloudyWeather")],
b)})},"esri/views/3d/environment/FoggyWeather":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),function(a,f,b,m,y,q,A,d,p){var l;b=l=function(h){function k(w){w=h.call(this,w)||this;w.type=
"foggy";w.fogStrength=.5;return w}a._inheritsLoose(k,h);k.prototype.clone=function(){return new l({fogStrength:this.fogStrength})};return k}(b.JSONSupport);f.__decorate([d.enumeration({foggy:"foggy"})],b.prototype,"type",void 0);f.__decorate([m.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],b.prototype,"fogStrength",void 0);return b=l=f.__decorate([p.subclass("esri.views.3d.environment.FoggyWeather")],b)})},"esri/views/3d/environment/RainyWeather":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,f,b,m,y,q,A,d,p){var l;b=l=function(h){function k(w){w=h.call(this,w)||this;w.type="rainy";w.cloudCover=.5;w.precipitation=.5;return w}a._inheritsLoose(k,h);k.prototype.clone=function(){return new l({cloudCover:this.cloudCover,precipitation:this.precipitation})};return k}(b.JSONSupport);f.__decorate([d.enumeration({rainy:"rainy"})],b.prototype,"type",void 0);f.__decorate([m.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],b.prototype,"cloudCover",void 0);f.__decorate([m.property({type:Number,
nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],b.prototype,"precipitation",void 0);return b=l=f.__decorate([p.subclass("esri.views.3d.environment.RainyWeather")],b)})},"esri/views/3d/environment/SnowyWeather":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,f,b,m,y,q,A,d,p){var l;b=l=function(h){function k(w){w=h.call(this,w)||this;w.type="snowy";w.cloudCover=.5;w.precipitation=.5;w.snowCover="disabled";return w}a._inheritsLoose(k,h);k.prototype.clone=function(){return new l({cloudCover:this.cloudCover,precipitation:this.precipitation,snowCover:this.snowCover})};return k}(b.JSONSupport);f.__decorate([d.enumeration({snowy:"snowy"})],b.prototype,"type",void 0);f.__decorate([m.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],
b.prototype,"cloudCover",void 0);f.__decorate([m.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],b.prototype,"precipitation",void 0);f.__decorate([m.property({type:["enabled","disabled"],nonNullable:!0,json:{write:!0}})],b.prototype,"snowCover",void 0);return b=l=f.__decorate([p.subclass("esri.views.3d.environment.SnowyWeather")],b)})},"esri/webscene/lightingTypes":function(){define(["exports","./SunLighting","./VirtualLighting"],function(a,f,b){a.lightingTypes={key:"type",
defaultKeyValue:"sun",base:null,typeMap:{sun:f,virtual:b}};Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/webscene/SunLighting":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer".split(" "),
function(a,f,b,m,y,q,A,d,p,l){var h;b=h=function(k){function w(r){r=k.call(this,r)||this;r.type="sun";r.date=null;r.directShadowsEnabled=!1;r.displayUTCOffset=null;return r}a._inheritsLoose(w,k);var G=w.prototype;G.readDate=function(r,z){return null!=z.datetime&&new Date(z.datetime)||null};G.writeDate=function(r,z,K){z[K]=r.getTime()};G.readDirectShadowsEnabled=function(r,z){return!!z.directShadows};G.writedirectShadowsEnabled=function(r,z,K){r&&(z[K]=r)};G.writeDisplayUTCOffset=function(r,z){null!=
r&&(z.displayUTCOffset=r)};G.clone=function(){return new h(this.cloneConstructProperties())};G.cloneConstructProperties=function(){const r={directShadowsEnabled:this.directShadowsEnabled,displayUTCOffset:null!=this.displayUTCOffset?this.displayUTCOffset:null};null!=this.date&&(r.date=new Date(this.date.getTime()));return r};return w}(b.JSONSupport);f.__decorate([m.property({readOnly:!0,type:["sun"],json:{write:!0}})],b.prototype,"type",void 0);f.__decorate([m.property({type:Date,json:{type:Number,
write:{target:"datetime"}}})],b.prototype,"date",void 0);f.__decorate([d.reader("date",["datetime"])],b.prototype,"readDate",null);f.__decorate([l.writer("date")],b.prototype,"writeDate",null);f.__decorate([m.property({type:Boolean,json:{default:!1,write:{target:"directShadows"}}})],b.prototype,"directShadowsEnabled",void 0);f.__decorate([d.reader("directShadowsEnabled",["directShadows"])],b.prototype,"readDirectShadowsEnabled",null);f.__decorate([l.writer("directShadowsEnabled")],b.prototype,"writedirectShadowsEnabled",
null);f.__decorate([m.property({type:Number,json:{write:!0}})],b.prototype,"displayUTCOffset",void 0);f.__decorate([l.writer("displayUTCOffset")],b.prototype,"writeDisplayUTCOffset",null);return b=h=f.__decorate([p.subclass("esri.webscene.SunLighting")],b)})},"esri/webscene/VirtualLighting":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass".split(" "),
function(a,f,b,m,y,q,A,d){var p;b=p=function(l){function h(w){w=l.call(this,w)||this;w.type="virtual";w.directShadowsEnabled=!1;return w}a._inheritsLoose(h,l);var k=h.prototype;k.clone=function(){return new p(this.cloneConstructProperties())};k.cloneConstructProperties=function(){return{directShadowsEnabled:this.directShadowsEnabled}};return h}(b.JSONSupport);f.__decorate([m.property({readOnly:!0,type:["virtual"],json:{write:!0}})],b.prototype,"type",void 0);f.__decorate([m.property({type:Boolean,
json:{default:!1,name:"directShadows",write:!0}})],b.prototype,"directShadowsEnabled",void 0);return b=p=f.__decorate([d.subclass("esri.webscene.VirtualLighting")],b)})},"esri/webscene/background/utils":function(){define(["exports","./Background","./ColorBackground"],function(a,f,b){f={base:f,key:"type",typeMap:{color:b}};f={types:f,json:{read:function(m){return(y,q,A)=>{if(!y)return y;for(const d in m.typeMap)if(y.type===d)return q=new m.typeMap[d],q.read(y,A),q}}(f),write:{overridePolicy:(m,y,q)=>
({enabled:!q||!q.isPresentation})}}};a.backgroundProperty=f;Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/webscene/background/Background":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(a,f,b,m,y,q,A,d){b=
function(p){function l(h){return p.call(this,h)||this}a._inheritsLoose(l,p);l.prototype.clone=function(){};return l}(b.JSONSupport);f.__decorate([m.property({readOnly:!0,json:{read:!1}})],b.prototype,"type",void 0);return b=f.__decorate([d.subclass("esri.webscene.background.Background")],b)})},"esri/webscene/background/ColorBackground":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Color ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ../../symbols/support/materialUtils ./Background".split(" "),
function(a,f,b,m,y,q,A,d,p,l,h){var k;y={...l.colorAndTransparencyProperty,nonNullable:!0};h=k=function(w){function G(z){z=w.call(this,z)||this;z.type="color";z.color=new b([0,0,0,1]);return z}a._inheritsLoose(G,w);var r=G.prototype;r.clone=function(){return new k(this.cloneProperties())};r.cloneProperties=function(){return{color:this.color.clone()}};return G}(h);f.__decorate([d.enumeration({color:"color"},{readOnly:!0})],h.prototype,"type",void 0);f.__decorate([m.property(y)],h.prototype,"color",
void 0);return h=k=f.__decorate([p.subclass("esri.webscene.background.ColorBackground")],h)})},"esri/webscene/InitialViewProperties":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../Viewpoint ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../geometry/SpatialReference ./Environment".split(" "),function(a,f,b,m,y,q,A,d,p,l,h){var k;m=k=function(w){function G(r){r=
w.call(this,r)||this;r.environment=new h;r.spatialReference=null;r.viewpoint=null;return r}a._inheritsLoose(G,w);G.prototype.clone=function(){return new k({environment:this.environment.clone(),spatialReference:this.spatialReference?this.spatialReference.clone():null,viewingMode:this.viewingMode,viewpoint:this.viewpoint?this.viewpoint.clone():null})};a._createClass(G,[{key:"viewingMode",set:function(r){this._set("viewingMode",r)}}]);return G}(m.JSONSupport);f.__decorate([y.property({type:h,json:{write:{isRequired:!0}}})],
m.prototype,"environment",void 0);f.__decorate([y.property({type:l})],m.prototype,"spatialReference",void 0);f.__decorate([y.property({type:["local","global"]})],m.prototype,"viewingMode",null);f.__decorate([y.property({type:b,json:{write:{isRequired:!0}}})],m.prototype,"viewpoint",void 0);return m=k=f.__decorate([p.subclass("esri.webscene.InitialViewProperties")],m)})},"esri/webscene/Presentation":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Collection ../core/collectionUtils ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/cast ../core/accessorSupport/decorators/subclass ./Slide".split(" "),
function(a,f,b,m,y,q,A,d,p,l,h){const k=b.ofType(h);b=function(w){function G(z){z=w.call(this,z)||this;z.slides=new k;return z}a._inheritsLoose(G,w);var r=G.prototype;r.destroy=function(){this.slides.forEach(z=>z.destroy());this.slides.removeAll()};r.clone=function(){return new this.constructor({slides:this.slides.clone()})};a._createClass(G,[{key:"slides",set:function(z){z&&(z=z.filter(K=>!!K.viewpoint));this._set("slides",m.referenceSetter(z,this._get("slides"),k))}}]);return G}(y.JSONSupport);
f.__decorate([q.property({type:k,nonNullable:!0,json:{write:!0}}),p.cast(m.castForReferenceSetter)],b.prototype,"slides",null);return b=f.__decorate([l.subclass("esri.webscene.Presentation")],b)})},"esri/webscene/Slide":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../Basemap ../Viewpoint ../core/asyncUtils ../core/Collection ../core/collectionUtils ../core/JSONSupport ../core/Logger ../core/maybe ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/cast ../core/accessorSupport/decorators/subclass ../core/accessorSupport/ensureType ../chunks/vec3 ../chunks/vec3f64 ../layers/Layer ../layers/mixins/OperationalLayer ../support/basemapUtils ../views/3d/support/mathUtils ../views/3d/support/viewpointUtils ../views/support/Scheduler ../webdoc/support/SlideThumbnail ./SunLighting ./VirtualLighting ./support/Description ./support/SlideEnvironment ./support/SlideGround ./support/SlideVisibleLayer ./support/Title".split(" "),
function(a,f,b,m,y,q,A,d,p,l,h,k,w,G,r,z,K,F,N,L,ba,da,ja,V,ma,ka,sa,g,t,H,U,T,aa,c){function n(ha){if("building-scene"===ha.type||"map-image"===ha.type)return ha.allSublayers.toArray()}function J(ha){if(ha=n(ha))return ha.filter(u=>u.visible).map(u=>u.id)}function Y(ha,u){ha=u-ha;43200<ha&&(ha-=86400);-43200>ha&&(ha+=86400);return ha}let ea=0;const pa=q.ofType(aa.SlideVisibleLayer),na=p.getLogger("esri.webscene.Slide");d=function(ha){function u(x){x=ha.call(this,x)||this;x.id=Date.now().toString(16)+
"-slide-"+ea++;x.title=new c;x.description=new H;x.thumbnail=new sa.SlideThumbnail;x.viewpoint=null;x.basemap=null;x.ground=null;x.environment=new U.SlideEnvironment;x.visibleLayers=new pa;return x}a._inheritsLoose(u,ha);var v=u.prototype;v.destroy=function(){this.visibleLayers.removeAll();this.basemap=null;this.thumbnail&&this.thumbnail.destroy();this.thumbnail=this.title=this.description=null};v.castTitle=function(x){return"string"===typeof x?new c({text:x}):F.ensureType(c,x)};v.castDescription=
function(x){return"string"===typeof x?new H({text:x}):F.ensureType(H,x)};v.castThumbnail=function(x){return"string"===typeof x?new sa.SlideThumbnail({url:x}):F.ensureType(sa.SlideThumbnail,x)};v.castBasemap=function(x){return ja.ensureType(x)};v.castVisibleLayers=function(x){return x&&"function"===typeof x.map?x.map(C=>{if("string"===typeof C)return{id:C};if(C instanceof ba){const R=J(C);return{id:C.id,sublayerIds:R}}if(C.id)return{id:C.id,sublayerIds:C.sublayerIds};na.warn('Invalid visible layer, expected { id }, Layer or "id"');
return C}):null};v.clone=function(){return new this.constructor({id:this.id,title:this.title.clone(),thumbnail:this.thumbnail.clone(),description:this.description&&this.description.clone()||null,viewpoint:this.viewpoint&&this.viewpoint.clone()||null,basemap:this.basemap&&this.basemap.clone()||null,ground:this.ground&&this.ground.clone()||null,visibleLayers:this.visibleLayers.clone(),environment:this.environment&&this.environment.clone()||null})};v._updateVisibleLayersFrom=function(x){const C=[];return h.eachAlways(this._getLayers(x.map).map(R=>
x.whenLayerView(R).then(S=>{if(S.visible){const E=J(R);C.push(new aa.SlideVisibleLayer({id:S.layer.id,sublayerIds:E}))}})).toArray()).then(()=>{this.visibleLayers.removeAll();this.visibleLayers.addMany(C)})};v.updateFrom=function(x,C){C={screenshot:{format:"png",quality:80,width:120,height:75,disableDecorations:!0,...C&&C.screenshot}};return x.when(()=>{this.viewpoint=x.viewpoint.clone();this.environment.lighting="virtual"===x.environment.lighting.type?t.prototype.clone.apply(x.environment.lighting):
g.prototype.clone.apply(x.environment.lighting);this.environment.weather=x.environment.weather.clone();this.basemap=x.map.basemap&&x.map.basemap.clone()||null;this.ground=x.map.ground?T.fromGround(x.map.ground):null;return this._updateVisibleLayersFrom(x)}).then(()=>x.takeScreenshot(C.screenshot)).then(R=>{this.thumbnail=new sa.SlideThumbnail({url:R.dataUrl});return this})};v.applyTo=function(){var x=a._asyncToGenerator(function*(C,R){var S=this;l.isSome(this._applyToController)&&this._applyToController.abort();
let E=new AbortController;this._applyToController=E;const O=h.onAbortOrThrow(R,()=>E.abort()),W=C.resourceController.scheduler.registerTask(ka.TaskPriority.SLIDE);let ca=!1;R={animate:!0,...R,signal:this._applyToController.signal};var la=function(){var X=a._asyncToGenerator(function*(){yield Promise.all([W.schedule(()=>ca=S._setViewpointOfInterest(C,R)),W.schedule(()=>S._applyBasemap(C,R),R.signal)]);yield Promise.all([W.schedule(()=>S._applyLayerVisibility(C),R.signal),W.schedule(()=>S._applyGround(C),
R.signal),W.schedule(()=>S._applyViewpoint(C,R),R.signal)]);yield W.schedule(()=>C.environment.weather=S.environment.weather.clone())});return function(){return X.apply(this,arguments)}}();la=yield y.result(C.addUpdatingPromise(la()));ca&&(C.contentCamera=null);W.remove();this._applyToController===E&&(this._applyToController=null);E=null;null==O?void 0:O.remove();if(!1===la.ok)throw la.error;return this});return function(C,R){return x.apply(this,arguments)}}();v._applyBasemap=function(){var x=a._asyncToGenerator(function*(C,
R){if(this.basemap){try{yield this.basemap.load(R)}catch(S){if(h.isAbortError(S))throw S;}C.map.basemap=ja.clonePreservingTiledLayers(this.basemap,C.map.basemap)}});return function(C,R){return x.apply(this,arguments)}}();v._applyGround=function(x){this.ground&&(x.map.ground=this.ground.cloneAndApplyTo(x.map.ground))};v._getLayers=function(x){const C=new q;this._collectLayers(x,C);this._collectLayers(x.ground,C);return C};v._collectLayers=function(x,C){x.layers.forEach(R=>{da.isOperationalLayer(R)&&
(C.add(R),"layers"in R&&this._collectLayers(R,C))})};v._applyLayerVisibility=function(x){this.visibleLayers&&this._getLayers(x.map).forEach(C=>{var R=this.visibleLayers.find(E=>E.id===C.id);C.visible=null!=R;const S=R&&R.sublayerIds;R=n(C);S&&R&&R.forEach(E=>E.visible=S.includes(E.id))})};v._setViewpointOfInterest=function(x,C){if(x.state.fixedContentCamera||!this.viewpoint||C.ignoreViewpoint||!C.useDestinationCamera)return!1;C=ma.toCamera(x,this.viewpoint);x.contentCamera=C;return l.isSome(C)};v._applyViewpoint=
function(){var x=a._asyncToGenerator(function*(C,R){if(this.viewpoint&&!R.ignoreViewpoint){l.isSome(this.viewpoint.camera)&&(this.viewpoint.camera.fov=C.camera.fov);if(R.animate&&this.get("environment.lighting.date")){yield this._animateToLighting(C,R);return}R.animate&&(C.environment.applyLighting(this.environment.lighting.clone()),yield C.goTo(this.viewpoint,R));C.viewpoint=this.viewpoint}C.environment.applyLighting(this.environment.lighting.clone())});return function(C,R){return x.apply(this,arguments)}}();
v._animateToLighting=function(){var x=a._asyncToGenerator(function*(C,R){let S=null;"sun"===C.environment.lighting.type&&"sun"===this.environment.lighting.type&&("global"===C.viewingMode&&(S=this._animateLightingWithCamera(C,C.environment.lighting,this.environment.lighting)),C.environment.lighting.cameraTrackingEnabled=!1);C.environment.lighting.directShadowsEnabled=this.environment.lighting.directShadowsEnabled;"virtual"===this.environment.lighting.type||"virtual"===C.environment.lighting.type?(C.environment.applyLighting(this.environment.lighting.clone()),
"sun"===C.environment.lighting.type&&(C.environment.lighting.cameraTrackingEnabled=!1)):null!=this.environment.lighting.displayUTCOffset&&(C.environment.lighting.displayUTCOffset=this.environment.lighting.displayUTCOffset);return C.goTo(this.viewpoint,R).then(()=>C.environment.applyLighting(this.environment.lighting.clone())).finally(()=>{l.removeMaybe(S);"sun"===C.environment.lighting.type&&(C.environment.lighting.cameraTrackingEnabled=!0)})});return function(C,R){return x.apply(this,arguments)}}();
v._getTime=function(x){const C=x.getTime();x=3600*x.getUTCHours()+60*x.getUTCMinutes()+x.getUTCSeconds();return[C,x]};v._setTime=function(x,C,R){x.setTime(C);x.setUTCHours(R/3600);x.setUTCMinutes(R%3600/60);x.setUTCSeconds(R%3600%60);return x};v._animateLightingWithCamera=function(x,C,R){const [S,E]=this._getTime(new Date(C.date.toString())),[O,W]=this._getTime(R.date),ca=Y(E,W),la=x.renderCoordsHelper,X=L.create();la.toRenderCoords(x.camera.position,X);const B=L.create(),e=L.create();l.isSome(this.viewpoint.camera)&&
la.toRenderCoords(this.viewpoint.camera.position,B);const D=new Date;return k.watch(()=>x.camera,P=>{la.toRenderCoords(P.position,e);var Q=N.squaredDistance(X,e);const oa=N.squaredDistance(B,e);P=0;0!==Q+oa&&(P=Q/(Q+oa));Q=S+(O-S)*P;P=V.moduloPositive(E+ca*P,86400);C.date=this._setTime(D,Q,P)})};u.createFrom=function(x,C){return(new this).updateFrom(x,C)};a._createClass(u,[{key:"visibleLayers",set:function(x){this._set("visibleLayers",A.referenceSetter(x,this._get("visibleLayers"),pa))}}]);return u}(d.JSONSupport);
f.__decorate([w.property({type:String,json:{write:{isRequired:!0}}})],d.prototype,"id",void 0);f.__decorate([w.property({type:c,json:{default:()=>new c({text:""}),write:{isRequired:!0}}})],d.prototype,"title",void 0);f.__decorate([z.cast("title")],d.prototype,"castTitle",null);f.__decorate([w.property({type:H,json:{write:{overridePolicy(ha){return{enabled:!(!ha||!ha.text)}}}}})],d.prototype,"description",void 0);f.__decorate([z.cast("description")],d.prototype,"castDescription",null);f.__decorate([w.property({type:sa.SlideThumbnail,
json:{default:()=>new sa.SlideThumbnail({url:""}),write:{isRequired:!0}}})],d.prototype,"thumbnail",void 0);f.__decorate([z.cast("thumbnail")],d.prototype,"castThumbnail",null);f.__decorate([w.property({type:m,nonNullable:!0,json:{write:{isRequired:!0}}})],d.prototype,"viewpoint",void 0);f.__decorate([w.property({type:b,json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],d.prototype,"basemap",void 0);f.__decorate([z.cast("basemap")],d.prototype,"castBasemap",null);f.__decorate([w.property({type:T,
json:{write:!0}})],d.prototype,"ground",void 0);f.__decorate([w.property({type:pa,json:{write:{isRequired:!0}}})],d.prototype,"visibleLayers",null);f.__decorate([z.cast("visibleLayers")],d.prototype,"castVisibleLayers",null);f.__decorate([w.property({type:U.SlideEnvironment,json:{write:!0}})],d.prototype,"environment",void 0);return d=f.__decorate([K.subclass("esri.webscene.Slide")],d)})},"esri/views/3d/support/mathUtils":function(){define(["exports","../../../core/mathUtils","../../../chunks/vec3",
"../../../chunks/vec3f64"],function(a,f,b,m){const y=m.create(),q=m.create(),A=m.create(),d=m.create(),p=m.create();a.angle=function(l,h,k){l=b.normalize(d,l);h=b.normalize(p,h);const w=f.acosClamped(b.dot(l,h));return k&&(l=b.cross(A,l,h),0>b.dot(l,k))?-w:w};a.bilerp=function(l,h,k,w,G,r){l+=(h-l)*G;return l+(k+(w-k)*G-l)*r};a.cosCapped=function(l,h){return l>h?Math.cos(h):Math.cos(l)};a.fovx2fovy=function(l,h,k){return 2*Math.atan(k*Math.tan(.5*l)/h)};a.fovy2fovx=function(l,h,k){return 2*Math.atan(h*
Math.tan(.5*l)/k)};a.makeOrthonormal=function(l,h,k){k=k||l;const w=b.dot(l,h);b.set(k,l[0]-w*h[0],l[1]-w*h[1],l[2]-w*h[2]);b.normalize(k,k)};a.makePiecewiseLinearFunction=function(l){const h=l.length;return k=>{if(k<=l[0][0])return l[0][1];if(k>=l[h-1][0])return l[h-1][1];let w=1;for(;k>l[w][0];)w++;const G=l[w][0];k=(G-k)/(G-l[w-1][0]);return k*l[w-1][1]+(1-k)*l[w][1]}};a.maxScale=function(l){return Math.sqrt(Math.max(l[0]*l[0]+l[4]*l[4]+l[8]*l[8],l[1]*l[1]+l[5]*l[5]+l[9]*l[9],l[2]*l[2]+l[6]*l[6]+
l[10]*l[10]))};a.moduloPositive=function(l,h){return(l%h+h)%h};a.planeFromPoints=function(l,h,k,w){b.subtract(y,h,l);b.subtract(q,k,l);b.cross(w,y,q);b.normalize(w,w);w[3]=-b.dot(l,w)};a.scaleFromMatrix=function(l,h){b.set(l,Math.sqrt(h[0]*h[0]+h[4]*h[4]+h[8]*h[8]),Math.sqrt(h[1]*h[1]+h[5]*h[5]+h[9]*h[9]),Math.sqrt(h[2]*h[2]+h[6]*h[6]+h[10]*h[10]));return l};a.slerp=function(l,h,k,w=m.create()){const G=b.length(l);var r=b.length(h),z=b.dot(l,h)/(G*r);if(.9999999999999999>z){z=Math.acos(z);const K=
((1-k)*G+k*r)/Math.sin(z);r=K/r*Math.sin(k*z);b.scale(d,l,K/G*Math.sin((1-k)*z));b.scale(p,h,r);return b.add(w,d,p)}return b.lerp(w,l,h,k)};a.slerpTangent=function(l,h,k,w=m.create(),G=m.create()){const r=b.length(l),z=b.length(h);var K=b.dot(l,h)/(r*z);if(.9999999999999999>K){K=Math.acos(K);const F=Math.sin(K),N=Math.sin(k*K),L=Math.sin((1-k)*K),ba=(1-k)*r+k*z;{const da=ba/F,ja=da/z*N;b.scale(d,l,da/r*L);b.scale(p,h,ja);b.add(w,d,p)}b.scale(d,l,1/r*(-Math.cos((1-k)*K)*K*ba+L*(-r+z)));b.scale(p,h,
1/z*(Math.cos(k*K)*K*ba+N*(-r+z)));b.add(G,d,p);b.scale(G,G,1/F);return G}b.lerp(w,l,h,k);b.subtract(G,h,l);b.normalize(G,G);return G};a.tangentFrame=function(l,h,k){Math.abs(l[0])>Math.abs(l[1])?b.set(h,0,1,0):b.set(h,1,0,0);b.cross(k,l,h);b.normalize(h,h);b.cross(h,k,l);b.normalize(k,k)};Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/support/viewpointUtils":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../Camera ../../../geometry ../../../Graphic ../../../Viewpoint ../../../core/asyncUtils ../../../core/has ../../../core/Cyclical ../../../core/Error ../../../core/maybe ../../../core/promiseUtils ../../../chunks/mat3 ../../../chunks/mat3f64 ../../../chunks/mat4f64 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../geometry/projection ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/frustum ../../../geometry/support/webMercatorUtils ../camera/intersectionUtils ./cameraUtils ./ElevationProvider ../../../geometry/Point ../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/Geometry".split(" "),
function(a,f,b,m,y,q,A,d,p,l,h,k,w,G,r,z,K,F,N,L,ba,da,ja,V,ma,ka,sa,g,t){function H(I){return 360-p.cyclicalDegrees.normalize(I)}function U(I){return p.cyclicalDegrees.normalize(360-I)}function T(I){h.isSome(I)&&I.resolver&&I.resolver.reject();return null}function aa(I,M,Z,fa=null){if(!M)return T(fa);var ia=I.spatialReference||sa.WGS84;if(h.isSome(M.camera)){I=da.project(M.camera.position,ia);if(h.isNone(I))return T(fa);M=M.camera.clone();M.position=I;I=M;h.isSome(fa)&&fa.resolver&&fa.resolver.resolve(I);
return I}if(h.isNone(M.targetGeometry))return T(fa);var ra=M.get("targetGeometry.spatialReference");if(ra&&!da.canProject(ra,ia))return T(fa);ia=V.internalToExternal(I,I.state.camera);ra=V.OrientationMode.ADJUST;null!=M.rotation&&(ia.heading=H(M.rotation),ra=V.OrientationMode.LOCKED);null!=Z&&(ia.tilt=Z);if("point"===M.targetGeometry.type){const ta=M.targetGeometry;Z=M.targetGeometry.clone();M=null!=M.scale?V.scaleToDistance(I,M.scale,ta.latitude):I.state.camera.distance;return V.fromCenterDistance(I,
Z,M,ia,ra,fa)}return V.fromExtent(I,M.targetGeometry.extent,ia.heading,ia.tilt,ra,fa)}function c(){c=f._asyncToGenerator(function*(I,M,Z){if(M&&I.spatialReference){var fa={target:null};if("declaredClass"in M||Array.isArray(M))fa.target=M;else{for(var ia in M)fa[ia]=M[ia];M.center&&!fa.target&&(fa.target=M.center)}M=fa}else M=null;if(!M)throw new l("viewpointutils-create:no-target","Missing target for creating viewpoint");fa=new b({fov:I.camera.fov});ia=new q({camera:fa});if(M.target instanceof q)return I=
yield v(I,M.target,M,Z,ia),B(I);if(M.target instanceof b)return B(C(I,M.target,ia));var ra=null!=M.scale||null!=M.zoom;if(M.target instanceof g){var ta=M.target.xmin===M.target.xmax||M.target.ymin===M.target.ymax;return ra||ta?B(yield R(I,M,M.target.center,fa,Z,ia)):B(yield W(I,M,M.target,fa,Z,ia))}ta={boundingBox:N.empty(),hasZ:!1,screenSpaceObjects:[]};var wa=ra?V.scaleToResolution(I,n(I,M)):void 0;yield ha(I,M.target,wa,ta);if(isFinite(ta.boundingBox[0])){N.center(ta.boundingBox,e);xa.x=e[0];xa.y=
e[1];xa.z=e[2];xa.spatialReference=I.spatialReference;isFinite(xa.z)&&ta.hasZ?wa=N.isPoint(ta.boundingBox):(xa.z=void 0,wa=L.isPoint(N.toRect(ta.boundingBox,oa)));if(ra||wa)return B(yield R(I,M,xa,fa,Z,ia));ra=ta.screenSpaceObjects;if(ra.length){wa=Number.NEGATIVE_INFINITY;for(let Aa=0;Aa<ra.length;Aa++){const ya=ra[Aa].screenSpaceBoundingRect;wa=Math.max(wa,Math.abs(ya[0]),Math.abs(ya[1]),Math.abs(ya[2]),Math.abs(ya[3]))}ra=.66-wa/Math.min(I.width,I.height)*2}else ra=.66;return B(yield la(I,M,xa,
ta.boundingBox,ra,fa,Z,ia))}return M.position?(Z=ja.cameraOnContentAlongViewDirection(I),z.copy(qa,Z.viewForward),V.directionToHeadingTilt(I,Z.eye,qa,Z.up,za),fa.position=new ka(M.position),fa.heading=null!=M.heading?M.heading:za.heading,fa.tilt=null!=M.tilt?M.tilt:za.tilt,I=Y(I,null,fa,ia),B(I)):B(yield E(I,M,fa,Z,ia))});return c.apply(this,arguments)}function n(I,M){return null==M.scale&&null!=M.zoom?V.zoomToScale(I,M.zoom):M.scale}function J(I,M){let Z=!1;null!=M.heading?(I.heading=M.heading,Z=
!0):null!=M.rotation&&(I.heading=H(M.rotation),Z=!0);null!=M.tilt&&(I.tilt=M.tilt,Z=!0);null!=M.fov&&(I.fov=M.fov);return Z}function Y(I,M,Z,fa){const ia=I.spatialReference||sa.WGS84;M=h.isSome(M)?M:V.externalToInternal(I,Z);if(h.isNone(M))return fa;fa.targetGeometry=F.projectVectorToPoint(M.center,I.renderSpatialReference,ia);fa.scale=V.computeScale(I,M);fa.rotation=U(Z.heading);fa.camera=Z;return fa}function ea(I,M,Z){if(M){if(!da.canProject(M.spatialReference,I.spatialReference))throw new l("viewpointutils:incompatible-spatialreference",
`Spatial reference (${M.spatialReference?M.spatialReference.wkid:"unknown"}) is incompatible with the view (${I.spatialReference.wkid})`,{geometry:M});var fa=[];if(!M.hasZ&&I.basemapTerrain){switch(M.type){case "point":var ia=M;break;case "multipoint":case "polyline":ia=M.extent.center;break;case "mesh":ia=M.origin;break;case "extent":ia=M.center;break;case "polygon":ia=M.centroid}ia&&da.canProject(ia,I.basemapTerrain.spatialReference)?e[2]=h.unwrapOr(ma.getElevationAtPoint(I.elevationProvider,ia),
0):e[2]=0}(0,Ea[M.type])(M,ta=>{fa.push(ta[0],ta[1],ta[2])},e);var ra=fa.length/3;if(0!==ra&&(ia=Array(fa.length),F.projectBuffer(fa,M.spatialReference,0,ia,I.spatialReference,0,ra)))for(M.hasZ&&(Z.hasZ=!0),I=0;I<ia.length;I+=3)M.hasZ?(e[0]=ia[I+0],e[1]=ia[I+1],e[2]=ia[I+2]):(e[0]=ia[I+0],e[1]=ia[I+1]),N.expandWithVec3(Z.boundingBox,e)}}function pa(I,M,Z,fa){return na.apply(this,arguments)}function na(){na=f._asyncToGenerator(function*(I,M,Z,fa){const ia=yield A.result(I.whenViewForGraphic(M));if(!1!==
ia.ok&&!h.isNone(ia.value)&&"whenGraphicBounds"in ia.value)if(Z=yield A.result(ia.value.whenGraphicBounds(M,{minDemResolution:Z})),!1===Z.ok)ea(I,M.geometry,fa);else{var {screenSpaceObjects:ra,boundingBox:ta}=Z.value;N.expandWithAABB(fa.boundingBox,ta);ra&&ra.forEach(wa=>{fa.screenSpaceObjects.push(wa)});isFinite(ta[2])&&(fa.hasZ=!0)}else ea(I,M.geometry,fa)});return na.apply(this,arguments)}function ha(I,M,Z,fa){return u.apply(this,arguments)}function u(){u=f._asyncToGenerator(function*(I,M,Z,fa){if(Array.isArray(M)&&
2===M.length){const ia=M[0],ra=M[1];if("number"===typeof ia&&"number"===typeof ra){xa.x=ia;xa.y=ra;xa.z=void 0;xa.spatialReference=I.spatialReference.isGeographic?I.spatialReference:sa.WGS84;ea(I,xa,fa);return}}M&&"function"===typeof M.map?yield k.eachAlways(M.map(ia=>ha(I,ia,Z,fa))):M instanceof t?ea(I,M,fa):M instanceof y&&(yield pa(I,M,Z,fa))});return u.apply(this,arguments)}function v(I,M,Z,fa,ia){return x.apply(this,arguments)}function x(){x=f._asyncToGenerator(function*(I,M,Z,fa,ia){if(h.isSome(M.camera))return C(I,
M.camera,ia);ia.scale=M.scale;ia.rotation=M.rotation;ia.targetGeometry=h.isSome(M.targetGeometry)?M.targetGeometry.clone():null;ia.camera=null;null!=Z.heading?ia.rotation=U(Z.heading):null!=Z.rotation&&(ia.rotation=Z.rotation);M=n(I,Z);null!=M&&(ia.scale=M);fa=new V.AsyncContext(fa);aa(I,ia,Z.tilt,fa);ia.camera=yield fa.resolver.promise;return ia});return x.apply(this,arguments)}function C(I,M,Z){const fa=da.project(M.position,I.spatialReference);if(h.isNone(fa))return null;M=M.clone();M.fov=I.camera.fov;
M.position=fa;return Y(I,null,M,Z)}function R(I,M,Z,fa,ia,ra){return S.apply(this,arguments)}function S(){S=f._asyncToGenerator(function*(I,M,Z,fa,ia,ra){if(h.isNone(Z))throw new l("createfromcenter","invalid point");ra.targetGeometry=Z.clone();const ta=ja.cameraOnContentAlongViewDirection(I);if(M.position)return Z=ra.targetGeometry,ia=I.renderSpatialReference,F.projectPointToVector(M.position,ua,ia),F.projectPointToVector(Z,va,ia),ra.targetGeometry=new ka(Z),fa.position=new ka(M.position),z.subtract(qa,
va,ua),V.directionToHeadingTilt(I,ua,qa,ta.up,fa),ra.scale=V.distanceToScale(I,z.distance(ua,va),ra.targetGeometry.latitude),ra.rotation=U(fa.heading),ra.camera=fa,ra;if(M.zoomFactor){var wa=ta.distance/M.zoomFactor;const Aa=z.scale(e,ta.viewForward,-wa);ta.eye=z.add(e,ta.center,Aa);ra.scale=V.distanceToScale(I,wa,Z.latitude)}V.internalToExternal(I,ta,fa);wa=J(fa,M)?V.OrientationMode.LOCKED:V.OrientationMode.ADJUST;M.zoomFactor||(ra.scale=n(I,M),null==ra.scale&&(F.projectPointToVector(Z,e,I.renderSpatialReference),
ba.intersectsPoint(ta.frustum,e)?ra.scale=V.distanceToScale(I,z.distance(ta.eye,e),Z.latitude):ra.scale=V.computeScale(I,ta)),M=new V.AsyncContext(ia),V.fromCenterScale(I,ra.targetGeometry,ra.scale,fa,wa,M),ra.camera=yield M.resolver.promise);return ra});return S.apply(this,arguments)}function E(I,M,Z,fa,ia){return O.apply(this,arguments)}function O(){O=f._asyncToGenerator(function*(I,M,Z,fa,ia){var ra=ja.cameraOnContentAlongViewDirection(I);ra=F.projectVectorToPoint(ra.center,I.renderSpatialReference,
I.spatialReference);return R(I,M,ra,Z,fa,ia)});return O.apply(this,arguments)}function W(I,M,Z,fa,ia,ra){return ca.apply(this,arguments)}function ca(){ca=f._asyncToGenerator(function*(I,M,Z,fa,ia,ra){ra.targetGeometry=Z.clone();const ta=ja.cameraOnContentAlongViewDirection(I);V.internalToExternal(I,ta,fa);M=J(fa,M)?V.OrientationMode.LOCKED:V.OrientationMode.ADJUST;ia=new V.AsyncContext(ia);V.fromExtent(I,Z,fa.heading,fa.tilt,M,ia);ra.camera=yield ia.resolver.promise;return ra});return ca.apply(this,
arguments)}function la(I,M,Z,fa,ia,ra,ta,wa){return X.apply(this,arguments)}function X(){X=f._asyncToGenerator(function*(I,M,Z,fa,ia,ra,ta,wa){wa.targetGeometry=Z.clone();const Aa=ja.cameraOnContentAlongViewDirection(I);var ya=0;Z.hasZ?ya=Z.z:I.basemapTerrain&&(ya=h.unwrap(ma.getElevationAtPoint(I.elevationProvider,Z)));z.set(e,Z.x,Z.y,ya);F.computeTranslationToOriginAndRotation(I.spatialReference,e,D,I.renderSpatialReference);w.fromMat4(P,D);w.transpose(P,P);N.empty(Q);Z=[[0,1,2],[3,1,2],[0,4,2],
[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]];for(var Ba=0;Ba<Z.length;Ba++){const Ca=Z[Ba];let Da=fa[Ca[2]];isFinite(Da)||(Da=ya);z.set(e,fa[Ca[0]],fa[Ca[1]],Da);F.projectVectorToVector(e,I.spatialReference,e,I.renderSpatialReference);N.expandWithVec3(Q,z.transformMat3(e,e,P))}fa=N.width(Q);ya=N.height(Q);Z=N.depth(Q);Ba=1/Math.tan(Aa.fovY/2);ia=Math.max(.5*Math.sqrt(fa*fa+Z*Z)*Math.max(Ba,1/Math.tan(Aa.fovX/2))+.5*ya,.5*ya*Ba+.5*Math.max(fa,Z))/ia;V.internalToExternal(I,Aa,ra);M=J(ra,M)?V.OrientationMode.LOCKED:
V.OrientationMode.ADJUST;wa.scale=V.distanceToScale(I,ia,wa.targetGeometry.latitude);ta=new V.AsyncContext(ta);V.fromCenterScale(I,wa.targetGeometry,wa.scale,ra,M,ta);wa.camera=yield ta.resolver.promise;return wa});return X.apply(this,arguments)}function B(I){I&&h.isSome(I.camera)&&(I.rotation=U(I.camera.heading));return I}const e=K.create(),D=r.create(),P=G.create(),Q=N.create(),oa=L.create(),qa=K.create(),ua=K.create(),va=K.create(),za={heading:0,tilt:0},xa=new ka,Ea={point(I,M,Z){Z[0]=I.x;Z[1]=
I.y;I.hasZ&&(Z[2]=I.z);M(Z)},polygon(I,M,Z){const fa=I.hasZ;for(let ia=0;ia<I.rings.length;ia++){const ra=I.rings[ia];for(let ta=0;ta<ra.length;ta++)Z[0]=ra[ta][0],Z[1]=ra[ta][1],fa&&(Z[2]=ra[ta][2]),M(Z)}},polyline(I,M,Z){const fa=I.hasZ;for(let ia=0;ia<I.paths.length;ia++){const ra=I.paths[ia];for(let ta=0;ta<ra.length;ta++)Z[0]=ra[ta][0],Z[1]=ra[ta][1],fa&&(Z[2]=ra[ta][2]),M(Z)}},multipoint(I,M,Z){const fa=I.points;I=I.hasZ;for(let ia=0;ia<fa.length;ia++)Z[0]=fa[ia][0],Z[1]=fa[ia][1],I&&(Z[2]=
fa[ia][2]),M(Z)},extent(I,M,Z){I.hasZ?(M(z.set(Z,I.xmin,I.ymin,I.zmin)),M(z.set(Z,I.xmax,I.ymin,I.zmin)),M(z.set(Z,I.xmin,I.ymax,I.zmin)),M(z.set(Z,I.xmax,I.ymax,I.zmin)),M(z.set(Z,I.xmin,I.ymin,I.zmax)),M(z.set(Z,I.xmax,I.ymin,I.zmax)),M(z.set(Z,I.xmin,I.ymax,I.zmax)),M(z.set(Z,I.xmax,I.ymax,I.zmax))):(M(z.set(Z,I.xmin,I.ymin,Z[2])),M(z.set(Z,I.xmax,I.ymin,Z[2])),M(z.set(Z,I.xmin,I.ymax,Z[2])),M(z.set(Z,I.xmax,I.ymax,Z[2])))},mesh(I,M,Z){if(I=I.vertexAttributes&&I.vertexAttributes.position)for(let fa=
0;fa<I.length;fa+=3)M(z.set(Z,I[fa+0],I[fa+1],I[fa+2]))}};a.create=function(I,M,Z){return c.apply(this,arguments)};a.fromCamera=function(I,M,Z=null){h.isNone(Z)&&(Z=new q);return Y(I,null,M.clone(),Z)};a.headingToRotation=U;a.rotationToHeading=H;a.toCamera=aa;Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/chunks/mat3":function(){define(["exports","./common"],function(a,f){function b(c,n){c[0]=n[0];c[1]=n[1];c[2]=n[2];c[3]=n[4];c[4]=n[5];c[5]=n[6];
c[6]=n[8];c[7]=n[9];c[8]=n[10];return c}function m(c,n){c[0]=n[0];c[1]=n[1];c[2]=n[2];c[3]=n[3];c[4]=n[4];c[5]=n[5];c[6]=n[6];c[7]=n[7];c[8]=n[8];return c}function y(c,n,J,Y,ea,pa,na,ha,u,v){c[0]=n;c[1]=J;c[2]=Y;c[3]=ea;c[4]=pa;c[5]=na;c[6]=ha;c[7]=u;c[8]=v;return c}function q(c){c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=1;c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c}function A(c,n){if(c===n){const J=n[1],Y=n[2],ea=n[5];c[1]=n[3];c[2]=n[6];c[3]=J;c[5]=n[7];c[6]=Y;c[7]=ea}else c[0]=n[0],c[1]=n[3],c[2]=n[6],c[3]=n[1],
c[4]=n[4],c[5]=n[7],c[6]=n[2],c[7]=n[5],c[8]=n[8];return c}function d(c,n){const J=n[0],Y=n[1],ea=n[2],pa=n[3],na=n[4],ha=n[5],u=n[6],v=n[7];n=n[8];const x=n*na-ha*v,C=-n*pa+ha*u,R=v*pa-na*u;let S=J*x+Y*C+ea*R;if(!S)return null;S=1/S;c[0]=x*S;c[1]=(-n*Y+ea*v)*S;c[2]=(ha*Y-ea*na)*S;c[3]=C*S;c[4]=(n*J-ea*u)*S;c[5]=(-ha*J+ea*pa)*S;c[6]=R*S;c[7]=(-v*J+Y*u)*S;c[8]=(na*J-Y*pa)*S;return c}function p(c,n){const J=n[0],Y=n[1],ea=n[2],pa=n[3],na=n[4],ha=n[5],u=n[6],v=n[7];n=n[8];c[0]=na*n-ha*v;c[1]=ea*v-Y*
n;c[2]=Y*ha-ea*na;c[3]=ha*u-pa*n;c[4]=J*n-ea*u;c[5]=ea*pa-J*ha;c[6]=pa*v-na*u;c[7]=Y*u-J*v;c[8]=J*na-Y*pa;return c}function l(c){const n=c[3],J=c[4],Y=c[5],ea=c[6],pa=c[7],na=c[8];return c[0]*(na*J-Y*pa)+c[1]*(-na*n+Y*ea)+c[2]*(pa*n-J*ea)}function h(c,n,J){const Y=n[0],ea=n[1],pa=n[2],na=n[3],ha=n[4],u=n[5],v=n[6],x=n[7];n=n[8];const C=J[0],R=J[1],S=J[2],E=J[3],O=J[4],W=J[5],ca=J[6],la=J[7];J=J[8];c[0]=C*Y+R*na+S*v;c[1]=C*ea+R*ha+S*x;c[2]=C*pa+R*u+S*n;c[3]=E*Y+O*na+W*v;c[4]=E*ea+O*ha+W*x;c[5]=E*pa+
O*u+W*n;c[6]=ca*Y+la*na+J*v;c[7]=ca*ea+la*ha+J*x;c[8]=ca*pa+la*u+J*n;return c}function k(c,n,J){const Y=n[0],ea=n[1],pa=n[2],na=n[3],ha=n[4],u=n[5],v=n[6],x=n[7];n=n[8];const C=J[0];J=J[1];c[0]=Y;c[1]=ea;c[2]=pa;c[3]=na;c[4]=ha;c[5]=u;c[6]=C*Y+J*na+v;c[7]=C*ea+J*ha+x;c[8]=C*pa+J*u+n;return c}function w(c,n,J){const Y=n[0],ea=n[1],pa=n[2],na=n[3],ha=n[4],u=n[5],v=n[6],x=n[7];n=n[8];const C=Math.sin(J);J=Math.cos(J);c[0]=J*Y+C*na;c[1]=J*ea+C*ha;c[2]=J*pa+C*u;c[3]=J*na-C*Y;c[4]=J*ha-C*ea;c[5]=J*u-C*
pa;c[6]=v;c[7]=x;c[8]=n;return c}function G(c,n,J){const Y=J[0],ea=J[1];J=J[2];c[0]=Y*n[0];c[1]=Y*n[1];c[2]=Y*n[2];c[3]=ea*n[3];c[4]=ea*n[4];c[5]=ea*n[5];c[6]=J*n[6];c[7]=J*n[7];c[8]=J*n[8];return c}function r(c,n,J){const Y=J[0];J=J[1];c[0]=Y*n[0];c[1]=Y*n[1];c[2]=Y*n[2];c[3]=J*n[3];c[4]=J*n[4];c[5]=J*n[5];return c}function z(c,n){c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=1;c[5]=0;c[6]=n[0];c[7]=n[1];c[8]=1;return c}function K(c,n){const J=Math.sin(n);n=Math.cos(n);c[0]=n;c[1]=J;c[2]=0;c[3]=-J;c[4]=n;c[5]=
0;c[6]=0;c[7]=0;c[8]=1;return c}function F(c,n){c[0]=n[0];c[1]=0;c[2]=0;c[3]=0;c[4]=n[1];c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c}function N(c,n){c[0]=n[0];c[1]=n[1];c[2]=0;c[3]=n[2];c[4]=n[3];c[5]=0;c[6]=n[4];c[7]=n[5];c[8]=1;return c}function L(c,n){var J=n[0],Y=n[1],ea=n[2];n=n[3];var pa=J+J,na=Y+Y;const ha=ea+ea;J*=pa;const u=Y*pa;Y*=na;const v=ea*pa,x=ea*na;ea*=ha;pa*=n;na*=n;n*=ha;c[0]=1-Y-ea;c[3]=u-n;c[6]=v+na;c[1]=u+n;c[4]=1-J-ea;c[7]=x-pa;c[2]=v-na;c[5]=x+pa;c[8]=1-J-Y;return c}function ba(c,
n){const J=n[0],Y=n[1],ea=n[2],pa=n[4],na=n[5],ha=n[6],u=n[8],v=n[9];n=n[10];const x=n*na-ha*v,C=-n*pa+ha*u,R=v*pa-na*u;var S=J*x+Y*C+ea*R;if(!S)return null;S=1/S;c[0]=x*S;c[1]=(-n*Y+ea*v)*S;c[2]=(ha*Y-ea*na)*S;c[3]=C*S;c[4]=(n*J-ea*u)*S;c[5]=(-ha*J+ea*pa)*S;c[6]=R*S;c[7]=(-v*J+Y*u)*S;c[8]=(na*J-Y*pa)*S;return c}function da(c,n){const J=n[0],Y=n[1],ea=n[2],pa=n[3],na=n[4],ha=n[5],u=n[6],v=n[7];var x=n[8],C=n[9],R=n[10],S=n[11];const E=n[12],O=n[13],W=n[14];n=n[15];const ca=J*ha-Y*na,la=J*u-ea*na,
X=J*v-pa*na,B=Y*u-ea*ha,e=Y*v-pa*ha,D=ea*v-pa*u,P=x*O-C*E,Q=x*W-R*E;x=x*n-S*E;const oa=C*W-R*O;C=C*n-S*O;R=R*n-S*W;S=ca*R-la*C+X*oa+B*x-e*Q+D*P;if(!S)return null;S=1/S;c[0]=(ha*R-u*C+v*oa)*S;c[1]=(u*x-na*R-v*Q)*S;c[2]=(na*C-ha*x+v*P)*S;c[3]=(ea*C-Y*R-pa*oa)*S;c[4]=(J*R-ea*x+pa*Q)*S;c[5]=(Y*x-J*C-pa*P)*S;c[6]=(O*D-W*e+n*B)*S;c[7]=(W*X-E*D-n*la)*S;c[8]=(E*e-O*X+n*ca)*S;return c}function ja(c,n,J){c[0]=2/n;c[1]=0;c[2]=0;c[3]=0;c[4]=-2/J;c[5]=0;c[6]=-1;c[7]=1;c[8]=1;return c}function V(c){return"mat3("+
c[0]+", "+c[1]+", "+c[2]+", "+c[3]+", "+c[4]+", "+c[5]+", "+c[6]+", "+c[7]+", "+c[8]+")"}function ma(c){return Math.sqrt(c[0]**2+c[1]**2+c[2]**2+c[3]**2+c[4]**2+c[5]**2+c[6]**2+c[7]**2+c[8]**2)}function ka(c,n,J){c[0]=n[0]+J[0];c[1]=n[1]+J[1];c[2]=n[2]+J[2];c[3]=n[3]+J[3];c[4]=n[4]+J[4];c[5]=n[5]+J[5];c[6]=n[6]+J[6];c[7]=n[7]+J[7];c[8]=n[8]+J[8];return c}function sa(c,n,J){c[0]=n[0]-J[0];c[1]=n[1]-J[1];c[2]=n[2]-J[2];c[3]=n[3]-J[3];c[4]=n[4]-J[4];c[5]=n[5]-J[5];c[6]=n[6]-J[6];c[7]=n[7]-J[7];c[8]=
n[8]-J[8];return c}function g(c,n,J){c[0]=n[0]*J;c[1]=n[1]*J;c[2]=n[2]*J;c[3]=n[3]*J;c[4]=n[4]*J;c[5]=n[5]*J;c[6]=n[6]*J;c[7]=n[7]*J;c[8]=n[8]*J;return c}function t(c,n,J,Y){c[0]=n[0]+J[0]*Y;c[1]=n[1]+J[1]*Y;c[2]=n[2]+J[2]*Y;c[3]=n[3]+J[3]*Y;c[4]=n[4]+J[4]*Y;c[5]=n[5]+J[5]*Y;c[6]=n[6]+J[6]*Y;c[7]=n[7]+J[7]*Y;c[8]=n[8]+J[8]*Y;return c}function H(c,n){return c[0]===n[0]&&c[1]===n[1]&&c[2]===n[2]&&c[3]===n[3]&&c[4]===n[4]&&c[5]===n[5]&&c[6]===n[6]&&c[7]===n[7]&&c[8]===n[8]}function U(c,n){const J=c[0],
Y=c[1],ea=c[2],pa=c[3],na=c[4],ha=c[5],u=c[6],v=c[7];c=c[8];const x=n[0],C=n[1],R=n[2],S=n[3],E=n[4],O=n[5],W=n[6],ca=n[7];n=n[8];return Math.abs(J-x)<=f.EPSILON*Math.max(1,Math.abs(J),Math.abs(x))&&Math.abs(Y-C)<=f.EPSILON*Math.max(1,Math.abs(Y),Math.abs(C))&&Math.abs(ea-R)<=f.EPSILON*Math.max(1,Math.abs(ea),Math.abs(R))&&Math.abs(pa-S)<=f.EPSILON*Math.max(1,Math.abs(pa),Math.abs(S))&&Math.abs(na-E)<=f.EPSILON*Math.max(1,Math.abs(na),Math.abs(E))&&Math.abs(ha-O)<=f.EPSILON*Math.max(1,Math.abs(ha),
Math.abs(O))&&Math.abs(u-W)<=f.EPSILON*Math.max(1,Math.abs(u),Math.abs(W))&&Math.abs(v-ca)<=f.EPSILON*Math.max(1,Math.abs(v),Math.abs(ca))&&Math.abs(c-n)<=f.EPSILON*Math.max(1,Math.abs(c),Math.abs(n))}function T(c){const n=f.EPSILON,J=c[0],Y=c[1],ea=c[2],pa=c[3],na=c[4],ha=c[5],u=c[6],v=c[7];c=c[8];return Math.abs(1-(J*J+pa*pa+u*u))<=n&&Math.abs(1-(Y*Y+na*na+v*v))<=n&&Math.abs(1-(ea*ea+ha*ha+c*c))<=n}const aa=Object.freeze(Object.defineProperty({__proto__:null,fromMat4:b,copy:m,set:y,identity:q,transpose:A,
invert:d,adjoint:p,determinant:l,multiply:h,translate:k,rotate:w,scale:G,scaleByVec2:r,fromTranslation:z,fromRotation:K,fromScaling:F,fromMat2d:N,fromQuat:L,normalFromMat4Legacy:ba,normalFromMat4:da,projection:ja,str:V,frob:ma,add:ka,subtract:sa,multiplyScalar:g,multiplyScalarAndAdd:t,exactEquals:H,equals:U,isOrthoNormal:T,mul:h,sub:sa},Symbol.toStringTag,{value:"Module"}));a.add=ka;a.adjoint=p;a.copy=m;a.determinant=l;a.equals=U;a.exactEquals=H;a.frob=ma;a.fromMat2d=N;a.fromMat4=b;a.fromQuat=L;a.fromRotation=
K;a.fromScaling=F;a.fromTranslation=z;a.identity=q;a.invert=d;a.isOrthoNormal=T;a.mat3=aa;a.mul=h;a.multiply=h;a.multiplyScalar=g;a.multiplyScalarAndAdd=t;a.normalFromMat4=da;a.normalFromMat4Legacy=ba;a.projection=ja;a.rotate=w;a.scale=G;a.scaleByVec2=r;a.set=y;a.str=V;a.sub=sa;a.subtract=sa;a.translate=k;a.transpose=A})},"esri/chunks/mat3f64":function(){define(["exports"],function(a){function f(){return[1,0,0,0,1,0,0,0,1]}function b(A){return[A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],A[8]]}function m(A,
d,p,l,h,k,w,G,r){return[A,d,p,l,h,k,w,G,r]}function y(A,d){return new Float64Array(A,d,9)}const q=Object.freeze(Object.defineProperty({__proto__:null,create:f,clone:b,fromValues:m,createView:y},Symbol.toStringTag,{value:"Module"}));a.clone=b;a.create=f;a.createView=y;a.fromValues=m;a.mat3f64=q})},"esri/chunks/mat4f64":function(){define(["exports"],function(a){function f(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function b(d){return[d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8],d[9],d[10],d[11],d[12],
d[13],d[14],d[15]]}function m(d,p,l,h,k,w,G,r,z,K,F,N,L,ba,da,ja){return[d,p,l,h,k,w,G,r,z,K,F,N,L,ba,da,ja]}function y(d,p){return new Float64Array(d,p,16)}const q=f(),A=Object.freeze(Object.defineProperty({__proto__:null,create:f,clone:b,fromValues:m,createView:y,IDENTITY:q},Symbol.toStringTag,{value:"Module"}));a.IDENTITY=q;a.clone=b;a.create=f;a.createView=y;a.fromValues=m;a.mat4f64=A})},"esri/geometry/support/frustum":function(){define("exports ../../core/ObjectStack ../../chunks/mat4 ../../chunks/vec3 ../../chunks/vec3f64 ../../chunks/vec4 ../../chunks/vec4f64 ./clipRay ./plane ./vectorStacks".split(" "),
function(a,f,b,m,y,q,A,d,p,l){function h(){return[y.create(),y.create(),y.create(),y.create(),y.create(),y.create(),y.create(),y.create()]}function k(F,N){p.fromPoints(N[a.PointIndex.FAR_BOTTOM_LEFT],N[a.PointIndex.NEAR_BOTTOM_LEFT],N[a.PointIndex.NEAR_TOP_LEFT],F[a.PlaneIndex.LEFT]);p.fromPoints(N[a.PointIndex.NEAR_BOTTOM_RIGHT],N[a.PointIndex.FAR_BOTTOM_RIGHT],N[a.PointIndex.FAR_TOP_RIGHT],F[a.PlaneIndex.RIGHT]);p.fromPoints(N[a.PointIndex.FAR_BOTTOM_LEFT],N[a.PointIndex.FAR_BOTTOM_RIGHT],N[a.PointIndex.NEAR_BOTTOM_RIGHT],
F[a.PlaneIndex.BOTTOM]);p.fromPoints(N[a.PointIndex.NEAR_TOP_LEFT],N[a.PointIndex.NEAR_TOP_RIGHT],N[a.PointIndex.FAR_TOP_RIGHT],F[a.PlaneIndex.TOP]);p.fromPoints(N[a.PointIndex.NEAR_BOTTOM_LEFT],N[a.PointIndex.NEAR_BOTTOM_RIGHT],N[a.PointIndex.NEAR_TOP_RIGHT],F[a.PlaneIndex.NEAR]);p.fromPoints(N[a.PointIndex.FAR_BOTTOM_RIGHT],N[a.PointIndex.FAR_BOTTOM_LEFT],N[a.PointIndex.FAR_TOP_LEFT],F[a.PlaneIndex.FAR])}function w(F,N){for(let L=0;L<a.NumPlanes.NUM;L++)if(!p.clip(F[L],N))return!1;return!0}a.PlaneIndex=
void 0;(function(F){F[F.LEFT=0]="LEFT";F[F.RIGHT=1]="RIGHT";F[F.BOTTOM=2]="BOTTOM";F[F.TOP=3]="TOP";F[F.NEAR=4]="NEAR";F[F.FAR=5]="FAR"})(a.PlaneIndex||(a.PlaneIndex={}));a.PointIndex=void 0;(function(F){F[F.NEAR_BOTTOM_LEFT=0]="NEAR_BOTTOM_LEFT";F[F.NEAR_BOTTOM_RIGHT=1]="NEAR_BOTTOM_RIGHT";F[F.NEAR_TOP_RIGHT=2]="NEAR_TOP_RIGHT";F[F.NEAR_TOP_LEFT=3]="NEAR_TOP_LEFT";F[F.FAR_BOTTOM_LEFT=4]="FAR_BOTTOM_LEFT";F[F.FAR_BOTTOM_RIGHT=5]="FAR_BOTTOM_RIGHT";F[F.FAR_TOP_RIGHT=6]="FAR_TOP_RIGHT";F[F.FAR_TOP_LEFT=
7]="FAR_TOP_LEFT"})(a.PointIndex||(a.PointIndex={}));const G={bottom:[a.PointIndex.FAR_BOTTOM_RIGHT,a.PointIndex.NEAR_BOTTOM_RIGHT,a.PointIndex.NEAR_BOTTOM_LEFT,a.PointIndex.FAR_BOTTOM_LEFT],near:[a.PointIndex.NEAR_BOTTOM_LEFT,a.PointIndex.NEAR_BOTTOM_RIGHT,a.PointIndex.NEAR_TOP_RIGHT,a.PointIndex.NEAR_TOP_LEFT],far:[a.PointIndex.FAR_BOTTOM_RIGHT,a.PointIndex.FAR_BOTTOM_LEFT,a.PointIndex.FAR_TOP_LEFT,a.PointIndex.FAR_TOP_RIGHT],right:[a.PointIndex.NEAR_BOTTOM_RIGHT,a.PointIndex.FAR_BOTTOM_RIGHT,a.PointIndex.FAR_TOP_RIGHT,
a.PointIndex.NEAR_TOP_RIGHT],left:[a.PointIndex.FAR_BOTTOM_LEFT,a.PointIndex.NEAR_BOTTOM_LEFT,a.PointIndex.NEAR_TOP_LEFT,a.PointIndex.FAR_TOP_LEFT],top:[a.PointIndex.FAR_TOP_LEFT,a.PointIndex.NEAR_TOP_LEFT,a.PointIndex.NEAR_TOP_RIGHT,a.PointIndex.FAR_TOP_RIGHT]};a.NumPlanes=void 0;(function(F){F[F.NUM=6]="NUM"})(a.NumPlanes||(a.NumPlanes={}));a.NumPoints=void 0;(function(F){F[F.NUM=8]="NUM"})(a.NumPoints||(a.NumPoints={}));const r=[A.fromValues(-1,-1,-1,1),A.fromValues(1,-1,-1,1),A.fromValues(1,1,
-1,1),A.fromValues(-1,1,-1,1),A.fromValues(-1,-1,1,1),A.fromValues(1,-1,1,1),A.fromValues(1,1,1,1),A.fromValues(-1,1,1,1)],z=new f.ObjectStack(d.create),K=h();a.computePlanes=k;a.copy=function(F,N){for(let L=0;L<a.NumPlanes.NUM;L++)p.copy(F[L],N[L])};a.create=function(F){return F?[p.create(F[0]),p.create(F[1]),p.create(F[2]),p.create(F[3]),p.create(F[4]),p.create(F[5])]:[p.create(),p.create(),p.create(),p.create(),p.create(),p.create()]};a.createPoints=h;a.fromMatrix=function(F,N,L,ba=K){F=b.multiply(l.sm4d.get(),
N,F);b.invert(F,F);for(N=0;N<a.NumPoints.NUM;++N){const da=q.transformMat4(l.sv4d.get(),r[N],F);m.set(ba[N],da[0]/da[3],da[1]/da[3],da[2]/da[3])}k(L,ba)};a.intersectClipRay=function(F,N){for(let L=0;L<a.NumPlanes.NUM;L++)if(!p.clipInfinite(F[L],N))return!1;return!0};a.intersectsAABB=function(F,N){for(let L=0;L<a.NumPlanes.NUM;L++)if(p.isAABBFullyInside(F[L],N))return!1;return!0};a.intersectsLineSegment=function(F,N,L){return w(F,d.fromLineSegmentAndDirection(N,L,z.get()))};a.intersectsPoint=function(F,
N){for(let L=0;L<a.NumPlanes.NUM;L++)if(0<p.signedDistance(F[L],N))return!1;return!0};a.intersectsRay=function(F,N){return w(F,d.fromRay(N,z.get()))};a.intersectsSphere=function(F,N){for(let L=0;L<a.NumPlanes.NUM;L++){const ba=F[L];if(ba[0]*N[0]+ba[1]*N[1]+ba[2]*N[2]+ba[3]>=N[3])return!1}return!0};a.planePointIndices=G;Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/ObjectStack":function(){define(["exports","./nextTick"],function(a,f){let b=function(){function m(q){this.allocator=
q;this._items=[];this._itemsPtr=0;this._grow()}var y=m.prototype;y.get=function(){0===this._itemsPtr&&f.nextTick(()=>this._reset());this._itemsPtr===this._items.length&&this._grow();return this._items[this._itemsPtr++]};y._reset=function(){this._items.length=Math.min(Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3072),this._items.length);this._itemsPtr=0};y._grow=function(){for(let q=0;q<Math.max(8,Math.min(this._items.length,1024));q++)this._items.push(this.allocator())};return m}();a.ObjectStack=
b;Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/support/clipRay":function(){define(["exports","../../core/ObjectStack","../../chunks/vec3","./ray","./vectorStacks"],function(a,f,b,m,y){function q(h){return h?{ray:m.create(h.ray),c0:h.c0,c1:h.c1}:{ray:m.create(),c0:0,c1:Number.MAX_VALUE}}function A(h,k,w,G=q()){m.copy(h,G.ray);G.c0=k;G.c1=w;return G}function d(h,k,w=q()){const G=b.length(h.vector);m.fromValues(h.origin,k,w.ray);w.c0=0;w.c1=
G;return w}function p(h,k,w){return b.add(w,h.ray.origin,b.scale(w,h.ray.direction,k))}const l=new f.ObjectStack(()=>({c0:0,c1:0,ray:null}));a.copy=function(h,k=q()){return A(h.ray,h.c0,h.c1,k)};a.create=q;a.fromLineSegment=function(h,k=q()){const w=b.normalize(y.sv3d.get(),h.vector);return d(h,w,k)};a.fromLineSegmentAndDirection=d;a.fromRay=function(h,k=q()){m.copy(h,k.ray);k.c0=0;k.c1=Number.MAX_VALUE;return k};a.fromValues=A;a.getAt=p;a.getEnd=function(h,k){return p(h,h.c1,k)};a.getStart=function(h,
k){return p(h,h.c0,k)};a.wrap=function(h,k,w){const G=l.get();G.ray=h;G.c0=k;G.c1=w;return G};Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/support/ray":function(){define("exports ../../core/arrayUtils ../../core/ObjectStack ../../chunks/vec3 ../../chunks/vec3f64 ./vectorStacks".split(" "),function(a,f,b,m,y,q){function A(h){return h?{origin:y.clone(h.origin),direction:y.clone(h.direction)}:{origin:y.create(),direction:y.create()}}function d(h,
k,w=A()){m.copy(w.origin,h);m.copy(w.direction,k);return w}function p(h,k){h=m.cross(q.sv3d.get(),m.normalize(q.sv3d.get(),h.direction),m.subtract(q.sv3d.get(),k,h.origin));return m.dot(h,h)}const l=new b.ObjectStack(function(){return{origin:null,direction:null}});a.closestPoint=function(h,k,w){k=m.dot(h.direction,m.subtract(w,k,h.origin));m.add(w,h.origin,m.scale(w,h.direction,k));return w};a.copy=function(h,k=A()){return d(h.origin,h.direction,k)};a.create=A;a.distance=function(h,k){return Math.sqrt(p(h,
k))};a.distance2=p;a.equals=function(h,k){return f.equals(h.origin,k.origin)&&f.equals(h.direction,k.direction)};a.fromPoints=function(h,k,w=A()){m.copy(w.origin,h);m.subtract(w.direction,k,h);return w};a.fromValues=d;a.wrap=function(h,k){const w=l.get();w.origin=h;w.direction=k;return w};Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/support/vectorStacks":function(){define(["exports","../../core/VectorStack"],function(a,f){const b=f.VectorStack.createVec2f64(),
m=f.VectorStack.createVec3f64(),y=f.VectorStack.createVec4f64(),q=f.VectorStack.createMat3f64(),A=f.VectorStack.createMat4f64();f=f.VectorStack.createQuatf64();a.sm3d=q;a.sm4d=A;a.sq4d=f;a.sv2d=b;a.sv3d=m;a.sv4d=y;Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/VectorStack":function(){define("exports ../chunks/_rollupPluginBabelHelpers ./byteSizeEstimations ./nextTick ../chunks/mat3f64 ../chunks/mat4f64 ../chunks/quatf64 ../chunks/vec2f64 ../chunks/vec3f64 ../chunks/vec4f64".split(" "),
function(a,f,b,m,y,q,A,d,p,l){let h=function(){function w(r,z,K){this.itemByteSize=r;this.itemCreate=z;this._buffers=[];this._items=[];this._itemsPtr=0;this._itemsPerBuffer=Math.ceil(K/this.itemByteSize)}var G=w.prototype;G.get=function(){0===this._itemsPtr&&m.nextTick(()=>this._reset());const r=Math.floor(this._itemsPtr/this._itemsPerBuffer);for(;this._buffers.length<=r;){const z=new ArrayBuffer(this._itemsPerBuffer*this.itemByteSize);for(let K=0;K<this._itemsPerBuffer;++K)this._items.push(this.itemCreate(z,
K*this.itemByteSize));this._buffers.push(z)}return this._items[this._itemsPtr++]};G._reset=function(){const r=2*(Math.floor(this._itemsPtr/this._itemsPerBuffer)+1);for(;this._buffers.length>r;)this._buffers.pop(),this._items.length=this._buffers.length*this._itemsPerBuffer;this._itemsPtr=0};w.createVec2f64=function(r=k){return new w(16,d.createView,r)};w.createVec3f64=function(r=k){return new w(24,p.createView,r)};w.createVec4f64=function(r=k){return new w(32,l.createView,r)};w.createMat3f64=function(r=
k){return new w(72,y.createView,r)};w.createMat4f64=function(r=k){return new w(128,q.createView,r)};w.createQuatf64=function(r=k){return new w(32,A.createView,r)};f._createClass(w,[{key:"test",get:function(){return{size:this._buffers.length*this._itemsPerBuffer*this.itemByteSize}}}]);return w}();const k=4*b.ByteSizeUnit.KILOBYTES;a.VectorStack=h;Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/byteSizeEstimations":function(){define(["exports"],
function(a){function f(b){return 32+b.length}a.ByteSizeUnit=void 0;(function(b){b[b.KILOBYTES=1024]="KILOBYTES";b[b.MEGABYTES=1048576]="MEGABYTES";b[b.GIGABYTES=1073741824]="GIGABYTES"})(a.ByteSizeUnit||(a.ByteSizeUnit={}));a.estimateAttributesObjectSize=function(b){if(!b)return 0;let m=32;for(const y in b)if(b.hasOwnProperty(y)){const q=b[y];switch(typeof q){case "string":m+=f(q);break;case "number":m+=16;break;case "boolean":m+=4}}return m};a.estimateFixedArraySize=function(b,m){return 32+b.length*
m};a.estimateNumberByteSize=function(){return 16};a.estimateStringByteSize=f;Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/chunks/quatf64":function(){define(["exports"],function(a){function f(){return[0,0,0,1]}function b(d){return[d[0],d[1],d[2],d[3]]}function m(d,p,l,h){return[d,p,l,h]}function y(d,p){return new Float64Array(d,p,4)}const q=f(),A=Object.freeze(Object.defineProperty({__proto__:null,create:f,clone:b,fromValues:m,createView:y,IDENTITY:q},
Symbol.toStringTag,{value:"Module"}));a.IDENTITY=q;a.clone=b;a.create=f;a.createView=y;a.fromValues=m;a.quatf64=A})},"esri/chunks/vec2f64":function(){define(["exports"],function(a){function f(){return[0,0]}function b(z){return[z[0],z[1]]}function m(z,K){return[z,K]}function y(z){const K=[0,0],F=Math.min(2,z.length);for(let N=0;N<F;++N)K[N]=z[N];return K}function q(z,K){return new Float64Array(z,K,2)}function A(){return[0,0]}function d(){return[1,1]}function p(){return[1,0]}function l(){return[0,1]}
const h=[0,0],k=[1,1],w=[1,0],G=[0,1],r=Object.freeze(Object.defineProperty({__proto__:null,create:f,clone:b,fromValues:m,fromArray:y,createView:q,zeros:A,ones:d,unitX:p,unitY:l,ZEROS:h,ONES:k,UNIT_X:w,UNIT_Y:G},Symbol.toStringTag,{value:"Module"}));a.ONES=k;a.UNIT_X=w;a.UNIT_Y=G;a.ZEROS=h;a.clone=b;a.create=f;a.createView=q;a.fromArray=y;a.fromValues=m;a.ones=d;a.unitX=p;a.unitY=l;a.vec2f64=r;a.zeros=A})},"esri/geometry/support/plane":function(){define("exports ../../core/mathUtils ../../core/maybe ../../chunks/vec3 ../../chunks/vec3f64 ../../chunks/sphere ./vector ./vectorStacks ../../views/3d/support/mathUtils".split(" "),
function(a,f,b,m,y,q,A,d,p){function l(g=V){return[g[0],g[1],g[2],g[3]]}function h(g,t){return k(t[0],t[1],t[2],t[3],g)}function k(g,t,H,U,T=l()){T[0]=g;T[1]=t;T[2]=H;T[3]=U;return T}function w(g,t,H){var U=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];U=1E-5<Math.abs(U-1)&&1E-12<U?1/Math.sqrt(U):1;H[0]=t[0]*U;H[1]=t[1]*U;H[2]=t[2]*U;H[3]=-(H[0]*g[0]+H[1]*g[1]+H[2]*g[2]);return H}function G(g,t,H,U=l()){var T=H[0]-t[0],aa=H[1]-t[1],c=H[2]-t[2];H=g[0]-t[0];const n=g[1]-t[1],J=g[2]-t[2];t=aa*J-c*n;c=c*H-T*J;T=T*n-
aa*H;aa=t*t+c*c+T*T;aa=1E-5<Math.abs(aa-1)&&1E-12<aa?1/Math.sqrt(aa):1;U[0]=t*aa;U[1]=c*aa;U[2]=T*aa;U[3]=-(U[0]*g[0]+U[1]*g[1]+U[2]*g[2]);return U}function r(g,t,H,U,T){if(3>g.count)return!1;g.getVec(H,N);let aa=U,c=!1;for(;aa<g.count-1&&!c;)g.getVec(aa,L),aa++,c=!m.exactEquals(N,L);if(!c)return!1;aa=Math.max(aa,T);for(c=!1;aa<g.count&&!c;)g.getVec(aa,ba),aa++,m.subtract(da,N,L),m.normalize(da,da),m.subtract(ja,L,ba),m.normalize(ja,ja),c=!m.exactEquals(N,ba)&&!m.exactEquals(L,ba)&&.99619469809>Math.abs(m.dot(da,
ja));if(!c)return 0===H&&1===U&&2===T?!1:r(g,t,0,1,2);G(N,L,ba,t);return!0}function z(g,t,H){g=m.scale(d.sv3d.get(),g,m.dot(g,t));m.subtract(H,t,g);return H}function K(g,t){return m.dot(g,t)+g[3]}function F(g,t,H,U,T){const aa=m.dot(g,H);if(0===aa)return!1;g=-(m.dot(g,t)+g[3])/aa;U&ma.CLAMP&&(g=f.clamp(g,0,1));if(!(U&ma.INFINITE_MIN)&&0>g||!(U&ma.INFINITE_MAX)&&1<g)return!1;m.add(T,t,m.scale(T,H,g));return!0}const N=y.create(),L=y.create(),ba=y.create(),da=y.create(),ja=y.create(),V=[0,0,1,0];var ma;
(function(g){g[g.NONE=0]="NONE";g[g.CLAMP=1]="CLAMP";g[g.INFINITE_MIN=4]="INFINITE_MIN";g[g.INFINITE_MAX=8]="INFINITE_MAX"})(ma||(ma={}));const ka=ma.INFINITE_MIN|ma.INFINITE_MAX,sa=ma.INFINITE_MAX;a.UP=V;a.clip=function(g,t){const H=m.dot(g,t.ray.direction);g=-K(g,t.ray.origin);if(0>g&&0<=H)return!1;if(-1E-6<H&&1E-6>H)return 0<g;if((0>g||0>H)&&!(0>g&&0>H))return!0;g/=H;0<H?g<t.c1&&(t.c1=g):g>t.c0&&(t.c0=g);return t.c0<=t.c1};a.clipInfinite=function(g,t){const H=m.dot(g,t.ray.direction);g=-K(g,t.ray.origin);
if(-1E-6<H&&1E-6>H)return 0<g;g/=H;0<H?g<t.c1&&(t.c1=g):g>t.c0&&(t.c0=g);return t.c0<=t.c1};a.copy=h;a.create=l;a.distance=function(g,t){return Math.abs(K(g,t))};a.fromManyPoints=function(g,t){return r(g,t,0,1,2)};a.fromManyPointsSampleAt=r;a.fromNormalAndOffset=function(g,t,H){m.copy(H,g);H[3]=t;return H};a.fromPoints=G;a.fromPositionAndNormal=w;a.fromValues=k;a.fromVectorsAndPoint=function(g,t,H,U){m.cross(ba,t,g);return w(H,ba,U)};a.intersectLine=function(g,t,H,U){H=m.subtract(d.sv3d.get(),H,t);
return F(g,t,H,ka,U)};a.intersectLineSegment=function(g,t,H){return F(g,t.origin,t.vector,ma.NONE,H)};a.intersectLineSegmentClamp=function(g,t,H){return F(g,t.origin,t.vector,ma.CLAMP,H)};a.intersectRay=function(g,t,H){return b.isSome(t)?F(g,t.origin,t.direction,sa,H):!1};a.isAABBFullyInside=function(g,t){const H=t[0],U=t[1],T=t[2],aa=t[3],c=t[4];t=t[5];return 0<=g[0]*(0<g[0]?H:aa)+g[1]*(0<g[1]?U:c)+g[2]*(0<g[2]?T:t)+g[3]};a.isPointInside=function(g,t){return 0<=K(g,t)};a.isPointOutside=function(g,
t){return 0>K(g,t)};a.isSphereFullyInside=function(g,t){return 0<=K(g,q.getCenter(t))-t[3]};a.isSphereFullyOutside=function(g,t){return 0>K(g,q.getCenter(t))+t[3]};a.negate=function(g,t){t[0]=-g[0];t[1]=-g[1];t[2]=-g[2];t[3]=-g[3];return t};a.normal=function(g){return g};a.projectPoint=function(g,t,H){const U=m.scale(d.sv3d.get(),g,-g[3]);t=m.subtract(d.sv3d.get(),t,U);g=z(g,t,d.sv3d.get());m.add(H,g,U);return H};a.projectPointLocal=function(g,t,H,U){var T=d.sv3d.get(),aa=d.sv3d.get();p.tangentFrame(g,
T,aa);t=m.subtract(d.sv3d.get(),H,t);T=A.projectPointSignedLength(T,t);aa=A.projectPointSignedLength(aa,t);g=A.projectPointSignedLength(g,t);return m.set(U,T,aa,g)};a.projectVector=z;a.setOffsetFromPoint=function(g,t,H){t!==g&&h(g,t);g[3]=-m.dot(g,H);return g};a.signedDistance=K;a.wrap=function(g=V[0],t=V[1],H=V[2],U=V[3]){return k(g,t,H,U,d.sv4d.get())};Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/chunks/sphere":function(){define("exports ../core/has ../core/Logger ../core/mathUtils ../core/maybe ./mat4 ./vec3 ./vec3f64 ./vec4 ./vec4f64 ../geometry/support/Axis ../geometry/support/ray ../geometry/support/vector ../geometry/support/vectorStacks".split(" "),
function(a,f,b,m,y,q,A,d,p,l,h,k,w,G){function r(){return l.create()}function z(u,v=r()){return p.copy(v,u)}function K(u,v){return l.fromValues(u[0],u[1],u[2],v)}function F(u){return u}function N(u){u[0]=u[1]=u[2]=u[3]=0}function L(u,v){u[0]=u[1]=u[2]=0;u[3]=v;return u}function ba(u){return u[3]}function da(u){return u}function ja(u,v,x,C){return l.fromValues(u,v,x,C)}function V(u,v,x){u!==x&&A.copy(x,u);x[3]=u[3]+v;return x}function ma(u,v,x){ea.error("sphere.setExtent is not yet supported");return u===
x?x:z(u,x)}function ka(u,v,x){if(y.isNone(v))return!1;const {origin:C,direction:R}=v;var S=pa;S[0]=C[0]-u[0];S[1]=C[1]-u[1];S[2]=C[2]-u[2];v=R[0]*R[0]+R[1]*R[1]+R[2]*R[2];const E=2*(R[0]*S[0]+R[1]*S[1]+R[2]*S[2]);u=E*E-4*v*(S[0]*S[0]+S[1]*S[1]+S[2]*S[2]-u[3]*u[3]);if(0>u)return!1;S=Math.sqrt(u);u=(-E-S)/(2*v);v=(-E+S)/(2*v);if(0>u||v<u&&0<v)u=v;if(0>u)return!1;x&&(x[0]=C[0]+R[0]*u,x[1]=C[1]+R[1]*u,x[2]=C[2]+R[2]*u);return!0}function sa(u,v){return ka(u,v,null)}function g(u,v,x){if(ka(u,v,x))return x;
u=t(u,v,G.sv3d.get());A.add(x,v.origin,A.scale(G.sv3d.get(),v.direction,A.distance(v.origin,u)/A.length(v.direction)));return x}function t(u,v,x){const C=G.sv3d.get(),R=G.sm4d.get();A.cross(C,v.origin,v.direction);const S=u[3];A.cross(x,C,v.origin);A.scale(x,x,1/A.length(x)*S);u=aa(u,v.origin);v=w.angle(v.origin,x);q.fromRotation(R,v+u,C);A.transformMat4(x,x,R);return x}function H(u,v,x){if(ka(u,v,x))return x;k.closestPoint(v,u,x);return U(u,x,x)}function U(u,v,x){v=A.subtract(G.sv3d.get(),v,u);v=
A.scale(G.sv3d.get(),v,u[3]/A.length(v));return A.add(x,v,u)}function T(u,v){v=A.subtract(G.sv3d.get(),v,u);v=A.squaredLength(v);return Math.sqrt(Math.abs(v-u[3]*u[3]))}function aa(u,v){v=A.subtract(G.sv3d.get(),v,u);v=A.length(v);u=u[3];return m.acosClamped(u/(u+Math.abs(u-v)))}function c(u,v,x,C){u=A.subtract(na,v,u);switch(x){case h.Axis.X:return x=m.cartesianToSpherical(u,na)[2],A.set(C,-Math.sin(x),Math.cos(x),0);case h.Axis.Y:return u=m.cartesianToSpherical(u,na),x=u[1],u=u[2],v=Math.sin(x),
A.set(C,-v*Math.cos(u),-v*Math.sin(u),Math.cos(x));case h.Axis.Z:return A.normalize(C,u)}}function n(u,v){v=A.subtract(ha,v,u);return A.length(v)-u[3]}function J(u,v,x,C){const R=n(u,v);u=c(u,v,h.Axis.Z,ha);x=A.scale(ha,u,x-R);return A.add(C,v,x)}function Y(u,v){v=A.squaredDistance(u,v);u=u[3];return v<=u*u}const ea=b.getLogger("esri.geometry.support.sphere"),pa=d.create(),na=d.create(),ha=d.create();f=r();b=Object.freeze(Object.defineProperty({__proto__:null,create:r,copy:z,fromCenterAndRadius:K,
wrap:F,clear:N,fromRadius:L,getRadius:ba,getCenter:da,fromValues:ja,elevate:V,setExtent:ma,intersectRay:ka,intersectsRay:sa,intersectRayClosestSilhouette:g,closestPointOnSilhouette:t,closestPoint:H,projectPoint:U,distanceToSilhouette:T,angleToSilhouette:aa,axisAt:c,altitudeAt:n,setAltitudeAt:J,containsPoint:Y,tmpSphere:f},Symbol.toStringTag,{value:"Module"}));a.altitudeAt=n;a.angleToSilhouette=aa;a.axisAt=c;a.clear=N;a.closestPoint=H;a.closestPointOnSilhouette=t;a.containsPoint=Y;a.copy=z;a.create=
r;a.distanceToSilhouette=T;a.elevate=V;a.fromCenterAndRadius=K;a.fromRadius=L;a.fromValues=ja;a.getCenter=da;a.getRadius=ba;a.intersectRay=ka;a.intersectRayClosestSilhouette=g;a.intersectsRay=sa;a.projectPoint=U;a.setAltitudeAt=J;a.setExtent=ma;a.sphere=b;a.tmpSphere=f;a.wrap=F})},"esri/geometry/support/Axis":function(){define(["exports"],function(a){a.Axis=void 0;var f=a.Axis||(a.Axis={});f[f.X=0]="X";f[f.Y=1]="Y";f[f.Z=2]="Z";Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/geometry/support/vector":function(){define(["exports","../../core/mathUtils","../../chunks/vec3","../../chunks/vec3f64"],function(a,f,b,m){const y=m.create(),q=m.create();a.angle=function(A,d){A=b.dot(A,d)/(b.length(A)*b.length(d));return-f.acosClamped(A)};a.angleAroundAxis=function(A,d,p){b.normalize(y,A);b.normalize(q,d);A=b.dot(y,q);A=f.acosClamped(A);d=b.cross(y,y,q);return 0>b.dot(d,p)?2*Math.PI-A:A};a.projectPoint=function(A,d,p){d=b.dot(A,d)/b.dot(A,A);return b.scale(p,A,d)};a.projectPointSignedLength=
function(A,d){return b.dot(A,d)/b.length(A)};Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/camera/intersectionUtils":function(){define("exports ../../../core/maybe ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../geometry/projectionEllipsoid ../../../geometry/support/aaBoundingRect ../webgl-engine/lib/Intersector".split(" "),function(a,f,b,m,y,q,A){function d(r,z){return r.elevationProvider?f.unwrapOr(r.elevationProvider.getElevation(z[0],
z[1],z[2],r.renderCoordsHelper.spatialReference,"ground"),0):0}function p(r,z,K){if(!r.state.isGlobal)return!1;const F=d(r,z);({far:r}=r.stateManager.constraintsManager.nearFarHeuristic.compute(z,K,r.renderDataExtent,F,G));r*=r;return b.squaredDistance(z,K)>r}const l={},h=m.create(),k=m.create(),w=m.create(),G={near:0,far:0};a.cameraOnContentAlongViewDirection=function(r,z,K,F){const N=r.state.camera.clone();z&&(N.eye=z,N.center=K,N.up=F);z=N.ray;K=l[r.viewingMode];K||(K=A.newIntersector(r.state.viewingMode),
K.options.backfacesTerrain=!r.state.isGlobal,K.options.invisibleTerrain=!0,l[r.viewingMode]=K);({isGlobal:F}=r.state);r.sceneIntersectionHelper.intersectRay(z,K,k)&&!p(r,z.origin,k)?z=!0:!r.renderCoordsHelper.intersectManifold(z,0,k)||p(r,z.origin,k)?F?(K=y.getReferenceEllipsoid(r.spatialReference).radius,K=b.dot(z.origin,z.origin)-K*K,b.scale(k,z.direction,(0<K?Math.sqrt(K)/3:1)/b.length(z.direction)),b.add(k,k,z.origin),z=!0):z=!1:z=!0;z||b.copy(k,N.center);K=r.state.constraints;F=K.minimumPoiDistance;
b.squaredDistance(N.eye,k)<F&&(z=K.collision.enabled,b.copy(w,N.viewForward),b.scale(w,w,F),z?N.eye=b.subtract(h,k,w):b.add(k,N.eye,w),r=r.renderCoordsHelper,F=r.getAltitude(N.eye),K=K.collision.elevationMargin,z&&F<K&&(b.subtract(w,k,N.eye),N.eye=r.setAltitude(h,K,N.eye),b.add(k,N.eye,w)));N.center=k;return N};a.eyeWithinExtent=function(r,z,K,F){return f.isSome(r.renderCoordsHelper.fromRenderCoords(z.eye,h,F))&&q.containsPoint(K,h)};a.surfaceElevationBelowRenderLocation=d;Object.defineProperties(a,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/webgl-engine/lib/Intersector":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/mat4 ../../../../chunks/mat4f64 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../chunks/vec4 ../../../../chunks/vec4f64 ../../../../geometry/support/ray ../../../ViewingMode ./IntersectorInterfaces ./intersectorUtils ./verticalOffsetUtils ../materials/renderers/utils".split(" "),
function(a,f,b,m,y,q,A,d,p,l,h,k,w,G,r){let z=function(){function da(V){this.options=new k.IntersectorOptions;this._results=new K;this.transform=new G.IntersectorTransform;this.tolerance=1E-5;this.verticalOffset=null;this._ray=l.create();this._rayEnd=A.create();this._rayBeginTransformed=A.create();this._rayEndTransformed=A.create();this.viewingMode=null==V?h.ViewingMode.Global:V}var ja=da.prototype;ja.reset=function(V,ma,ka){this.resetWithRay(l.fromPoints(V,ma,this._ray),ka)};ja.resetWithRay=function(V,
ma){this.camera=ma;V!==this._ray&&l.copy(V,this._ray);0!==this.options.verticalOffset?this.viewingMode===h.ViewingMode.Local?this._ray.origin[2]-=this.options.verticalOffset:this.verticalOffset=this.options.verticalOffset:this.verticalOffset=null;q.add(this._rayEnd,this._ray.origin,this._ray.direction);this._results.init(this._ray)};ja.intersect=function(V=null,ma,ka,sa,g){this.point=ma;this.filterPredicate=sa;this.tolerance=null==ka?1E-5:ka;ma=G.getVerticalOffsetObject3D(this.verticalOffset);if(b.isSome(V)&&
0<V.length){const t=g?H=>{g(H)&&this.intersectObject(H)}:H=>{this.intersectObject(H)};for(const H of V)V=H.getSpatialQueryAccelerator&&H.getSpatialQueryAccelerator(),b.isSome(V)?(b.isSome(ma)?V.forEachAlongRayWithVerticalOffset(this._ray.origin,this._ray.direction,t,ma):V.forEachAlongRay(this._ray.origin,this._ray.direction,t),this.options.selectionMode&&this.options.hud&&V.forEachDegenerateObject(t)):H.objects.forAll(U=>t(U))}this.sortResults()};ja.intersectObject=function(V){const ma=V.geometryRecords;
if(ma){var ka=V.transformation,sa=G.getVerticalOffsetObject3D(this.verticalOffset);for(const g of ma){const {geometry:t,material:H,instanceParameters:U}=g;if(r.isInstanceHidden(U))continue;const T=t.id;this.transform.setAndInvalidateLazyTransforms(ka,g.getShaderTransformation());q.transformMat4(this._rayBeginTransformed,this.rayBegin,this.transform.inverse);q.transformMat4(this._rayEndTransformed,this.rayEnd,this.transform.inverse);const aa=this.transform.transform;b.isSome(sa)&&(sa.objectTransform=
this.transform);H.intersect(t,U,this.transform.transform,this,this._rayBeginTransformed,this._rayEndTransformed,(c,n,J,Y,ea,pa)=>{if(0<=c&&(!b.isSome(this.filterPredicate)||this.filterPredicate(this._ray.origin,this._rayEnd,c))){var na=Y?this._results.hud:this._results,ha=Y?u=>{const v={object:V,geometryId:T,triangleNr:J,center:b.isSome(pa)?[pa[0],pa[1],pa[2]]:null};u.set(k.IntersectorType.HUD,v,c,n,y.IDENTITY,ea)}:u=>u.set(k.IntersectorType.OBJECT,{object:V,geometryId:T,triangleNr:J},c,n,aa,ea);
(null==na.min.drapedLayerOrder||ea>=na.min.drapedLayerOrder)&&(null==na.min.dist||c<na.min.dist)&&ha(na.min);this.options.store!==k.StoreResults.MIN&&(null==na.max.drapedLayerOrder||ea<na.max.drapedLayerOrder)&&(null==na.max.dist||c>na.max.dist)&&ha(na.max);this.options.store===k.StoreResults.ALL&&(Y?(Y=new N(this._ray),ha(Y),this._results.hud.all.push(Y)):(Y=new F(this._ray),ha(Y),this._results.all.push(Y)))}},g.shaderTransformation)}}};ja.sortResults=function(V=this._results.all){V.sort((ma,ka)=>
ma.dist!==ka.dist?b.unwrapOr(ma.dist,0)-b.unwrapOr(ka.dist,0):ma.drapedLayerOrder!==ka.drapedLayerOrder?b.unwrapOr(ma.drapedLayerOrder,Number.MAX_VALUE)-b.unwrapOr(ka.drapedLayerOrder,Number.MAX_VALUE):b.unwrapOr(ka.drapedLayerGraphicOrder,Number.MIN_VALUE)-b.unwrapOr(ma.drapedLayerGraphicOrder,Number.MIN_VALUE))};f._createClass(da,[{key:"results",get:function(){return this._results}},{key:"ray",get:function(){return this._ray}},{key:"rayBegin",get:function(){return this._ray.origin}},{key:"rayEnd",
get:function(){return this._rayEnd}}]);return da}(),K=function(){function da(){this.min=new F(l.create());this.max=new F(l.create());this.hud={min:new N(l.create()),max:new N(l.create()),all:[]};this.ground=new F(l.create());this.all=[]}da.prototype.init=function(ja){this.min.init(ja);this.max.init(ja);this.ground.init(ja);this.all.length=0;this.hud.min.init(ja);this.hud.max.init(ja);this.hud.all.length=0};return da}(),F=function(){function da(V){this.intersector=k.IntersectorType.OBJECT;this.normal=
A.create();this.transformation=y.create();this._ray=l.create();this.init(V)}var ja=da.prototype;ja.getIntersectionPoint=function(V){if(!w.isValidIntersectorResult(this))return!1;q.scale(L,this.ray.direction,this.dist);q.add(V,this.ray.origin,L);return!0};ja.getTransformedNormal=function(V){q.copy(ba,this.normal);ba[3]=0;d.transformMat4(ba,ba,this.transformation);q.copy(V,ba);return q.normalize(V,V)};ja.init=function(V){this.drapedLayerGraphicOrder=this.drapedLayerOrder=this.target=this.dist=null;
this.intersector=k.IntersectorType.OBJECT;l.copy(V,this._ray)};ja.set=function(V,ma,ka,sa,g,t,H){this.intersector=V;this.dist=ka;q.copy(this.normal,b.unwrapOr(sa,A.UNIT_Z));m.copy(this.transformation,b.unwrapOr(g,y.IDENTITY));this.target=ma;this.drapedLayerOrder=t;this.drapedLayerGraphicOrder=H};ja.copy=function(V){l.copy(V.ray,this._ray);this.intersector=V.intersector;this.dist=V.dist;this.target=V.target;this.drapedLayerOrder=V.drapedLayerOrder;this.drapedLayerGraphicOrder=V.drapedLayerGraphicOrder;
q.copy(this.normal,V.normal);m.copy(this.transformation,V.transformation)};f._createClass(da,[{key:"ray",get:function(){return this._ray}},{key:"distanceInRenderSpace",get:function(){return b.isSome(this.dist)?(q.scale(L,this.ray.direction,this.dist),q.length(L)):null}}]);return da}(),N=function(da){function ja(){var V=da.apply(this,arguments)||this;V.intersector=k.IntersectorType.HUD;return V}f._inheritsLoose(ja,da);return ja}(F);const L=A.create(),ba=p.create();a.DEFAULT_TOLERANCE=1E-5;a.newIntersector=
function(da){return new z(da)};a.newIntersectorResult=function(da){return new F(da)};Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/webgl-engine/lib/IntersectorInterfaces":function(){define(["exports"],function(a){a.IntersectorType=void 0;(function(f){f[f.OBJECT=0]="OBJECT";f[f.HUD=1]="HUD";f[f.TERRAIN=2]="TERRAIN";f[f.OVERLAY=3]="OVERLAY";f[f.I3S=4]="I3S";f[f.PCL=5]="PCL";f[f.LOD=6]="LOD";f[f.VOXEL=7]="VOXEL"})(a.IntersectorType||(a.IntersectorType=
{}));a.StoreResults=void 0;(function(f){f[f.MIN=0]="MIN";f[f.MINMAX=1]="MINMAX";f[f.ALL=2]="ALL"})(a.StoreResults||(a.StoreResults={}));a.IntersectorOptions=function(){this.verticalOffset=0;this.selectionMode=!1;this.selectOpaqueTerrainOnly=this.hud=!0;this.invisibleTerrain=!1;this.backfacesTerrain=!0;this.isFiltered=!1;this.store=a.StoreResults.ALL};Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/webgl-engine/lib/intersectorUtils":function(){define("exports ../../../../core/maybe ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../chunks/boundedPlane ./IntersectorInterfaces".split(" "),
function(a,f,b,m,y,q){function A(p){return f.isSome(p)&&f.isSome(p.dist)}const d=m.create();a.isHudIntersectorResult=function(p){return A(p)&&p.intersector===q.IntersectorType.HUD&&!!p.target&&f.isSome(p.target.center)};a.isObjectIntersectorResult=function(p){return A(p)&&p.intersector===q.IntersectorType.OBJECT&&!!p.target};a.isValidIntersectorResult=A;a.sliceFilterPredicate=function(p){return(l,h,k)=>{b.lerp(d,l,h,k);return!y.extrusionContainsPoint(p,d)}};Object.defineProperties(a,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/chunks/boundedPlane":function(){define("exports ../core/has ../core/Logger ../core/mathUtils ../core/ObjectStack ./mat4 ./mat4f64 ./vec3 ./vec3f64 ../geometry/support/Axis ../geometry/support/lineSegment ../geometry/support/plane ../geometry/support/ray ../geometry/support/vector ../geometry/support/vectorStacks".split(" "),function(a,f,b,m,y,q,A,d,p,l,h,k,w,G,r){function z(e=S){return{plane:k.create(e.plane),origin:p.clone(e.origin),basis1:p.clone(e.basis1),
basis2:p.clone(e.basis2)}}function K(e,D,P){const Q=ca.get();Q.origin=e;Q.basis1=D;Q.basis2=P;Q.plane=k.wrap(0,0,0,0);ba(Q);return Q}function F(e,D=z()){return L(e.origin,e.basis1,e.basis2,D)}function N(e,D){d.copy(D.origin,e.origin);d.copy(D.basis1,e.basis1);d.copy(D.basis2,e.basis2);k.copy(D.plane,e.plane)}function L(e,D,P,Q=z()){d.copy(Q.origin,e);d.copy(Q.basis1,D);d.copy(Q.basis2,P);ba(Q);1E-6<Math.abs(d.dot(Q.basis1,Q.basis2)/(d.length(Q.basis1)*d.length(Q.basis2)))&&R.warn("fromValues()","Provided basis vectors are not perpendicular");
1E-6<Math.abs(d.dot(Q.basis1,ha(Q)))&&R.warn("fromValues()","Basis vectors and plane normal are not perpendicular");1E-6<Math.abs(-d.dot(ha(Q),Q.origin)-Q.plane[3])&&R.warn("fromValues()","Plane offset is not consistent with plane origin");return Q}function ba(e){k.fromVectorsAndPoint(e.basis2,e.basis1,e.origin,e.plane)}function da(e,D,P){e!==P&&F(e,P);e=d.scale(r.sv3d.get(),ha(e),D);d.add(P.origin,P.origin,e);P.plane[3]-=D;return P}function ja(e,D,P){V(D,P);da(P,J(e,e.origin),P);return P}function V(e,
D=z()){const P=(e[2]-e[0])/2,Q=(e[3]-e[1])/2;d.set(D.origin,e[0]+P,e[1]+Q,0);d.set(D.basis1,P,0,0);d.set(D.basis2,0,Q,0);k.fromValues(0,0,1,0,D.plane);return D}function ma(e,D,P){return k.intersectRay(e.plane,D,P)?u(e,P):!1}function ka(e,D,P){if(ma(e,D,P))return P;e=sa(e,D,r.sv3d.get());d.add(P,D.origin,d.scale(r.sv3d.get(),D.direction,d.distance(D.origin,e)/d.length(D.direction)));return P}function sa(e,D,P){const Q=E.get();var oa=E.get();C(e,D,Q,oa);oa=Number.POSITIVE_INFINITY;for(const ua of la){var qa=
x(e,ua,O.get());const va=r.sv3d.get();k.intersectLineSegment(Q,qa,va)&&(qa=d.direction(r.sv3d.get(),D.origin,va),qa=Math.abs(m.acosClamped(d.dot(D.direction,qa))),qa<oa&&(oa=qa,d.copy(P,va)))}return oa===Number.POSITIVE_INFINITY?g(e,D,P):P}function g(e,D,P){if(ma(e,D,P))return P;const Q=E.get(),oa=E.get();C(e,D,Q,oa);let qa=Number.POSITIVE_INFINITY;for(const va of la){var ua=x(e,va,O.get());const za=r.sv3d.get();k.intersectLineSegmentClamp(Q,ua,za)&&(ua=w.distance2(D,za),k.isPointInside(oa,za)&&ua<
qa&&(qa=ua,d.copy(P,za)))}U(e,D.origin)<qa&&t(e,D.origin,P);return P}function t(e,D,P){var Q=k.projectPoint(e.plane,D,r.sv3d.get());D=h.projectPointClamp(v(e,e.basis1),Q,-1,1,r.sv3d.get());Q=h.projectPointClamp(v(e,e.basis2),Q,-1,1,r.sv3d.get());d.subtract(P,d.add(r.sv3d.get(),D,Q),e.origin);return P}function H(e,D,P){const {origin:Q,basis1:oa,basis2:qa}=e,ua=d.subtract(r.sv3d.get(),D,Q);D=G.projectPointSignedLength(oa,ua);const va=G.projectPointSignedLength(qa,ua);e=G.projectPointSignedLength(ha(e),
ua);return d.set(P,D,va,e)}function U(e,D){D=H(e,D,r.sv3d.get());const {basis1:P,basis2:Q}=e;e=d.length(P);var oa=d.length(Q);e=Math.max(Math.abs(D[0])-e,0);oa=Math.max(Math.abs(D[1])-oa,0);D=D[2];return e*e+oa*oa+D*D}function T(e,D){return Math.sqrt(U(e,D))}function aa(e,D){let P=Number.NEGATIVE_INFINITY;for(const oa of la){var Q=x(e,oa,O.get());Q=h.distance2(Q,D);Q>P&&(P=Q)}return Math.sqrt(P)}function c(e,D){return k.isPointInside(e.plane,D)&&u(e,D)}function n(e,D,P,Q){switch(P){case l.Axis.X:d.copy(Q,
e.basis1);d.normalize(Q,Q);break;case l.Axis.Y:d.copy(Q,e.basis2);d.normalize(Q,Q);break;case l.Axis.Z:d.copy(Q,ha(e))}return Q}function J(e,D){const P=-e.plane[3];return G.projectPointSignedLength(ha(e),D)-P}function Y(e,D,P,Q){const oa=J(e,D);e=d.scale(W,ha(e),P-oa);d.add(Q,D,e);return Q}function ea(e,D){return d.exactEquals(e.basis1,D.basis1)&&d.exactEquals(e.basis2,D.basis2)&&d.exactEquals(e.origin,D.origin)}function pa(e,D,P){e!==P&&F(e,P);q.invert(X,D);q.transpose(X,X);d.transformMat4(P.basis1,
e.basis1,X);d.transformMat4(P.basis2,e.basis2,X);d.transformMat4(k.normal(P.plane),k.normal(e.plane),X);d.transformMat4(P.origin,e.origin,D);k.setOffsetFromPoint(P.plane,P.plane,P.origin);return P}function na(e,D,P,Q){e!==Q&&F(e,Q);q.fromRotation(B,D,P);d.transformMat4(Q.basis1,e.basis1,B);d.transformMat4(Q.basis2,e.basis2,B);ba(Q);return Q}function ha(e){return k.normal(e.plane)}function u(e,D){const P=d.subtract(r.sv3d.get(),D,e.origin);D=d.squaredLength(e.basis1);const Q=d.squaredLength(e.basis2),
oa=d.dot(e.basis1,P);e=d.dot(e.basis2,P);return 0>-oa-D&&0>oa-D&&0>-e-Q&&0>e-Q}function v(e,D){const P=O.get();d.copy(P.origin,e.origin);d.copy(P.vector,D);return P}function x(e,D,P){const {basis1:Q,basis2:oa,origin:qa}=e;e=d.scale(r.sv3d.get(),Q,D.origin[0]);const ua=d.scale(r.sv3d.get(),oa,D.origin[1]);d.add(P.origin,e,ua);d.add(P.origin,P.origin,qa);e=d.scale(r.sv3d.get(),Q,D.direction[0]);D=d.scale(r.sv3d.get(),oa,D.direction[1]);d.scale(P.vector,d.add(e,e,D),2);return P}function C(e,D,P,Q){e=
ha(e);k.fromVectorsAndPoint(e,D.direction,D.origin,P);k.fromVectorsAndPoint(k.normal(P),e,D.origin,Q)}const R=b.getLogger("esri.views.3d.support.geometryUtils.boundedPlane");f=function(){this.plane=k.create();this.origin=p.create();this.basis1=p.create();this.basis2=p.create()};const S={plane:k.create(),origin:p.fromValues(0,0,0),basis1:p.fromValues(1,0,0),basis2:p.fromValues(0,1,0)},E=new y.ObjectStack(k.create),O=new y.ObjectStack(h.create),W=p.create(),ca=new y.ObjectStack(()=>({origin:null,basis1:null,
basis2:null,plane:null})),la=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],X=A.create(),B=A.create();y=Object.freeze(Object.defineProperty({__proto__:null,BoundedPlaneClass:f,create:z,wrap:K,copy:F,copyWithoutVerify:N,fromValues:L,updateUnboundedPlane:ba,elevate:da,setExtent:ja,fromAABoundingRect:V,intersectRay:ma,intersectRayClosestSilhouette:ka,closestPointOnSilhouette:sa,closestPoint:g,projectPoint:t,projectPointLocal:H,
distance2:U,distance:T,distanceToSilhouette:aa,extrusionContainsPoint:c,axisAt:n,altitudeAt:J,setAltitudeAt:Y,equals:ea,transform:pa,rotate:na,normal:ha,UP:S},Symbol.toStringTag,{value:"Module"}));a.BoundedPlaneClass=f;a.UP=S;a.altitudeAt=J;a.axisAt=n;a.boundedPlane=y;a.closestPoint=g;a.closestPointOnSilhouette=sa;a.copy=F;a.copyWithoutVerify=N;a.create=z;a.distance=T;a.distance2=U;a.distanceToSilhouette=aa;a.elevate=da;a.equals=ea;a.extrusionContainsPoint=c;a.fromAABoundingRect=V;a.fromValues=L;
a.intersectRay=ma;a.intersectRayClosestSilhouette=ka;a.normal=ha;a.projectPoint=t;a.projectPointLocal=H;a.rotate=na;a.setAltitudeAt=Y;a.setExtent=ja;a.transform=pa;a.updateUnboundedPlane=ba;a.wrap=K})},"esri/geometry/support/lineSegment":function(){define("exports ../../core/mathUtils ../../core/ObjectStack ../../chunks/vec3 ../../chunks/vec3f64 ./vectorStacks".split(" "),function(a,f,b,m,y,q){function A(r){return r?{origin:y.clone(r.origin),vector:y.clone(r.vector)}:{origin:y.create(),vector:y.create()}}
function d(r,z){const K=G.get();K.origin=r;K.vector=z;return K}function p(r,z,K=A()){m.copy(K.origin,r);m.copy(K.vector,z);return K}function l(r,z){z=m.subtract(q.sv3d.get(),z,r.origin);var K=m.dot(r.vector,z);const F=m.dot(r.vector,r.vector);K=f.clamp(K/F,0,1);r=m.subtract(q.sv3d.get(),m.scale(q.sv3d.get(),r.vector,K),z);return m.dot(r,r)}function h(r,z,K,F,N){const {vector:L,origin:ba}=r;z=m.subtract(q.sv3d.get(),z,ba);z=m.dot(L,z)/m.squaredLength(L);m.scale(N,L,f.clamp(z,K,F));return m.add(N,N,
r.origin)}function k(r,z,K,F){const N=r.origin;var L=m.add(q.sv3d.get(),N,r.vector);r=z.origin;var ba=m.add(q.sv3d.get(),r,z.vector),da=q.sv3d.get();z=q.sv3d.get();da[0]=N[0]-r[0];da[1]=N[1]-r[1];da[2]=N[2]-r[2];z[0]=ba[0]-r[0];z[1]=ba[1]-r[1];z[2]=ba[2]-r[2];if(1E-6>Math.abs(z[0])&&1E-6>Math.abs(z[1])&&1E-6>Math.abs(z[2]))return!1;ba=q.sv3d.get();ba[0]=L[0]-N[0];ba[1]=L[1]-N[1];ba[2]=L[2]-N[2];if(1E-6>Math.abs(ba[0])&&1E-6>Math.abs(ba[1])&&1E-6>Math.abs(ba[2]))return!1;L=da[0]*z[0]+da[1]*z[1]+da[2]*
z[2];var ja=z[0]*ba[0]+z[1]*ba[1]+z[2]*ba[2];const V=z[0]*z[0]+z[1]*z[1]+z[2]*z[2],ma=(ba[0]*ba[0]+ba[1]*ba[1]+ba[2]*ba[2])*V-ja*ja;if(1E-6>Math.abs(ma))return!1;da=(L*ja-(da[0]*ba[0]+da[1]*ba[1]+da[2]*ba[2])*V)/ma;L=(L+ja*da)/V;K&&(da=f.clamp(da,0,1),L=f.clamp(L,0,1));K=q.sv3d.get();ja=q.sv3d.get();K[0]=N[0]+da*ba[0];K[1]=N[1]+da*ba[1];K[2]=N[2]+da*ba[2];ja[0]=r[0]+L*z[0];ja[1]=r[1]+L*z[1];ja[2]=r[2]+L*z[2];F.tA=da;F.tB=L;F.pA=K;F.pB=ja;F.distance2=m.squaredDistance(K,ja);return!0}const w={tA:0,
tB:0,pA:y.create(),pB:y.create(),distance2:0},G=new b.ObjectStack(()=>({origin:null,vector:null}));a.closestLineSegmentDistance2=function(r,z){return k(r,z,!0,w)?w.distance2:null};a.closestLineSegmentPoint=function(r,z,K){return k(r,z,!0,w)?(m.copy(K,w.pA),!0):!1};a.closestRayDistance2=function(r,z){if(k(r,d(z.origin,z.direction),!1,w)){const {tA:K,pB:F,distance2:N}=w;if(0<=K&&1>=K)return N;if(0>K)return m.squaredDistance(r.origin,F);if(1<K)return m.squaredDistance(m.add(q.sv3d.get(),r.origin,r.vector),
F)}return null};a.copy=function(r,z=A()){return p(r.origin,r.vector,z)};a.create=A;a.distance=function(r,z){return Math.sqrt(l(r,z))};a.distance2=l;a.fromPoints=function(r,z,K=A()){m.copy(K.origin,r);m.subtract(K.vector,z,r);return K};a.fromValues=p;a.pointAt=function(r,z,K){return m.add(K,r.origin,m.scale(K,r.vector,z))};a.projectPoint=function(r,z,K){return h(r,z,0,1,K)};a.projectPointClamp=h;a.wrap=d;Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/webgl-engine/lib/verticalOffsetUtils":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/mat3 ../../../../chunks/mat3f64 ../../../../chunks/mat4 ../../../../chunks/mat4f64 ../../../../chunks/quat ../../../../chunks/quatf64 ../../../../chunks/vec3 ../../../../chunks/vec3f32 ../../../../chunks/vec3f64 ../../../../chunks/sphere".split(" "),
function(a,f,b,m,y,q,A,d,p,l,h,k,w){let G=function(){function ka(){this._transform=A.create();this._transformInverse=new r({value:this._transform},q.invert,A.create);this._transformInverseTranspose=new r(this._transformInverse,q.transpose,A.create);this._transformTranspose=new r({value:this._transform},q.transpose,A.create);this._transformInverseRotation=new r({value:this._transform},m.normalFromMat4Legacy,y.create)}var sa=ka.prototype;sa._invalidateLazyTransforms=function(){this._transformInverse.invalidate();
this._transformInverseTranspose.invalidate();this._transformTranspose.invalidate();this._transformInverseRotation.invalidate()};sa.setTransformMatrix=function(g){q.copy(this._transform,g)};sa.multiplyTransform=function(g){q.multiply(this._transform,this._transform,g)};sa.set=function(g){q.copy(this._transform,g);this._invalidateLazyTransforms()};sa.setAndInvalidateLazyTransforms=function(g,t){this.setTransformMatrix(g);this.multiplyTransform(t);this._invalidateLazyTransforms()};f._createClass(ka,
[{key:"transform",get:function(){return this._transform}},{key:"inverse",get:function(){return this._transformInverse.value}},{key:"inverseTranspose",get:function(){return this._transformInverseTranspose.value}},{key:"inverseRotation",get:function(){return this._transformInverseRotation.value}},{key:"transpose",get:function(){return this._transformTranspose.value}}]);return ka}(),r=function(){function ka(sa,g,t){this.original=sa;this.update=g;this.dirty=!0;this.transform=t()}ka.prototype.invalidate=
function(){this.dirty=!0};f._createClass(ka,[{key:"value",get:function(){this.dirty&&(this.update(this.transform,this.original.value),this.dirty=!1);return this.transform}}]);return ka}(),z=function(){function ka(g=0){this.offset=g;this.tmpVertex=k.create()}var sa=ka.prototype;sa.applyToVertex=function(g,t,H){const U=g+this.localOrigin[0],T=t+this.localOrigin[1],aa=H+this.localOrigin[2],c=this.offset/Math.sqrt(U*U+T*T+aa*aa);this.tmpVertex[0]=g+U*c;this.tmpVertex[1]=t+T*c;this.tmpVertex[2]=H+aa*c;
return this.tmpVertex};sa.applyToAabb=function(g){for(var t=0;3>t;++t)K[t]=g[0+t]+this.localOrigin[t],F[t]=g[3+t]+this.localOrigin[t],N[t]=K[t];t=this.applyToVertex(K[0],K[1],K[2]);for(var H=0;3>H;++H)g[H]=t[H],g[H+3]=t[H];t=T=>{T=this.applyToVertex(T[0],T[1],T[2]);for(let aa=0;3>aa;++aa)g[aa+0]=Math.min(g[aa+0],T[aa]),g[aa+3]=Math.max(g[aa+3],T[aa])};for(H=1;8>H;++H){for(var U=0;3>U;++U)N[U]=0===(H&1<<U)?K[U]:F[U];t(N)}H=0;for(U=0;3>U;++U)0>K[U]*F[U]&&(H|=1<<U);if(0!==H&&7!==H)for(U=0;8>U;++U)if(0===
(H&U)){for(let T=0;3>T;++T)N[T]=H[T]?0:0!==(U&1<<T)?K[T]:F[T];t(N)}for(t=0;3>t;++t)g[t+0]-=this.localOrigin[t],g[t+3]-=this.localOrigin[t];return g};return ka}();const K=k.create(),F=k.create(),N=k.create();let L=function(){function ka(g=0){this.componentLocalOriginLength=0;this._tmpVertex=k.create();this._mbs=w.create();this._obb={center:k.create(),halfSize:h.create(),quaternion:null};this._offset=this._totalOffset=0;this._resetOffset(g)}var sa=ka.prototype;sa._resetOffset=function(g){this._totalOffset=
this._offset=g};sa.applyToVertex=function(g,t,H){const U=H+this.componentLocalOriginLength,T=this._totalOffset/Math.sqrt(g*g+t*t+U*U);this._tmpVertex[0]=g+g*T;this._tmpVertex[1]=t+t*T;this._tmpVertex[2]=H+U*T;return this._tmpVertex};sa.applyToAabb=function(g){const t=g[0],H=g[1],U=g[2]+this.componentLocalOriginLength,T=g[3],aa=g[4],c=g[5]+this.componentLocalOriginLength;var n=0>t*T?0:Math.min(Math.abs(t),Math.abs(T)),J=0>H*aa?0:Math.min(Math.abs(H),Math.abs(aa)),Y=0>U*c?0:Math.min(Math.abs(U),Math.abs(c));
n=Math.sqrt(n*n+J*J+Y*Y);if(n<this._totalOffset)return g[0]-=0>t?this._totalOffset:0,g[1]-=0>H?this._totalOffset:0,g[2]-=0>U?this._totalOffset:0,g[3]+=0<T?this._totalOffset:0,g[4]+=0<aa?this._totalOffset:0,g[5]+=0<c?this._totalOffset:0,g;J=Math.max(Math.abs(t),Math.abs(T));Y=Math.max(Math.abs(H),Math.abs(aa));const ea=Math.max(Math.abs(U),Math.abs(c));J=this._totalOffset/Math.sqrt(J*J+Y*Y+ea*ea);n=this._totalOffset/n;g[0]+=t*(0<t?J:n);g[1]+=H*(0<H?J:n);g[2]+=U*(0<U?J:n);g[3]+=T*(0>T?J:n);g[4]+=aa*
(0>aa?J:n);g[5]+=c*(0>c?J:n);return g};sa.applyToMbs=function(g){const t=Math.sqrt(g[0]*g[0]+g[1]*g[1]+g[2]*g[2]),H=this._totalOffset/t;this._mbs[0]=g[0]+g[0]*H;this._mbs[1]=g[1]+g[1]*H;this._mbs[2]=g[2]+g[2]*H;this._mbs[3]=g[3]+g[3]*this._totalOffset/t;return this._mbs};sa.applyToObb=function(g){var t=g.center;const H=this._totalOffset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);this._obb.center[0]=t[0]+t[0]*H;this._obb.center[1]=t[1]+t[1]*H;this._obb.center[2]=t[2]+t[2]*H;l.transformQuat(this._obb.halfSize,
g.halfSize,g.quaternion);l.add(this._obb.halfSize,this._obb.halfSize,g.center);t=this._totalOffset/Math.sqrt(this._obb.halfSize[0]*this._obb.halfSize[0]+this._obb.halfSize[1]*this._obb.halfSize[1]+this._obb.halfSize[2]*this._obb.halfSize[2]);this._obb.halfSize[0]+=this._obb.halfSize[0]*t;this._obb.halfSize[1]+=this._obb.halfSize[1]*t;this._obb.halfSize[2]+=this._obb.halfSize[2]*t;l.subtract(this._obb.halfSize,this._obb.halfSize,g.center);d.conjugate(ma,g.quaternion);l.transformQuat(this._obb.halfSize,
this._obb.halfSize,ma);this._obb.halfSize[0]*=0>this._obb.halfSize[0]?-1:1;this._obb.halfSize[1]*=0>this._obb.halfSize[1]?-1:1;this._obb.halfSize[2]*=0>this._obb.halfSize[2]?-1:1;this._obb.quaternion=g.quaternion;return this._obb};f._createClass(ka,[{key:"offset",get:function(){return this._offset},set:function(g){this._resetOffset(g)}},{key:"componentOffset",set:function(g){this._totalOffset=this._offset+g}},{key:"localOrigin",set:function(g){this.componentLocalOriginLength=Math.sqrt(g[0]*g[0]+g[1]*
g[1]+g[2]*g[2])}}]);return ka}(),ba=function(){function ka(g=0){this.offset=g;this.sphere=w.create();this.tmpVertex=k.create()}var sa=ka.prototype;sa.applyToVertex=function(g,t,H){const U=this.objectTransform.transform;let T=U[0]*g+U[4]*t+U[8]*H+U[12],aa=U[1]*g+U[5]*t+U[9]*H+U[13];g=U[2]*g+U[6]*t+U[10]*H+U[14];t=this.offset/Math.sqrt(T*T+aa*aa+g*g);T+=T*t;aa+=aa*t;g+=g*t;t=this.objectTransform.inverse;this.tmpVertex[0]=t[0]*T+t[4]*aa+t[8]*g+t[12];this.tmpVertex[1]=t[1]*T+t[5]*aa+t[9]*g+t[13];this.tmpVertex[2]=
t[2]*T+t[6]*aa+t[10]*g+t[14];return this.tmpVertex};sa.applyToMinMax=function(g,t){const H=this.offset/Math.sqrt(g[0]*g[0]+g[1]*g[1]+g[2]*g[2]);g[0]+=g[0]*H;g[1]+=g[1]*H;g[2]+=g[2]*H;g=this.offset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]+=t[0]*g;t[1]+=t[1]*g;t[2]+=t[2]*g};sa.applyToAabb=function(g){var t=this.offset/Math.sqrt(g[0]*g[0]+g[1]*g[1]+g[2]*g[2]);g[0]+=g[0]*t;g[1]+=g[1]*t;g[2]+=g[2]*t;t=this.offset/Math.sqrt(g[3]*g[3]+g[4]*g[4]+g[5]*g[5]);g[3]+=g[3]*t;g[4]+=g[4]*t;g[5]+=g[5]*t;return g};
sa.applyToBoundingSphere=function(g){const t=Math.sqrt(g[0]*g[0]+g[1]*g[1]+g[2]*g[2]),H=this.offset/t;this.sphere[0]=g[0]+g[0]*H;this.sphere[1]=g[1]+g[1]*H;this.sphere[2]=g[2]+g[2]*H;this.sphere[3]=g[3]+g[3]*this.offset/t;return this.sphere};return ka}();const da=new ba,ja=new L,V=new z,ma=p.create();a.I3SVerticalOffsetGlobalViewingMode=L;a.IntersectorTransform=G;a.Object3DVerticalOffsetGlobalViewingMode=ba;a.TERRAIN_ID="terrain";a.TerrainVerticalOffsetGlobalViewingMode=z;a.getVerticalOffsetI3S=function(ka){return b.isSome(ka)?
(ja.offset=ka,ja):null};a.getVerticalOffsetObject3D=function(ka){return b.isSome(ka)?(da.offset=ka,da):null};a.getVerticalOffsetTerrain=function(ka){return b.isSome(ka)?(V.offset=ka,V):null};Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/chunks/quat":function(){define("exports ./mat3f64 ./quatf64 ./vec3f64 ./common ./vec3 ./vec4".split(" "),function(a,f,b,m,y,q,A){function d(u){u[0]=0;u[1]=0;u[2]=0;u[3]=1;return u}function p(u,v,x){x*=.5;const C=
Math.sin(x);u[0]=C*v[0];u[1]=C*v[1];u[2]=C*v[2];u[3]=Math.cos(x);return u}function l(u,v){const x=2*Math.acos(v[3]),C=Math.sin(x/2);C>y.EPSILON?(u[0]=v[0]/C,u[1]=v[1]/C,u[2]=v[2]/C):(u[0]=1,u[1]=0,u[2]=0);return x}function h(u,v,x){const C=v[0],R=v[1],S=v[2];v=v[3];const E=x[0],O=x[1],W=x[2];x=x[3];u[0]=C*x+v*E+R*W-S*O;u[1]=R*x+v*O+S*E-C*W;u[2]=S*x+v*W+C*O-R*E;u[3]=v*x-C*E-R*O-S*W;return u}function k(u,v,x){x*=.5;const C=v[0],R=v[1],S=v[2];v=v[3];const E=Math.sin(x);x=Math.cos(x);u[0]=C*x+v*E;u[1]=
R*x+S*E;u[2]=S*x-R*E;u[3]=v*x-C*E;return u}function w(u,v,x){x*=.5;const C=v[0],R=v[1],S=v[2];v=v[3];const E=Math.sin(x);x=Math.cos(x);u[0]=C*x-S*E;u[1]=R*x+v*E;u[2]=S*x+C*E;u[3]=v*x-R*E;return u}function G(u,v,x){x*=.5;const C=v[0],R=v[1],S=v[2];v=v[3];const E=Math.sin(x);x=Math.cos(x);u[0]=C*x+R*E;u[1]=R*x-C*E;u[2]=S*x+v*E;u[3]=v*x-S*E;return u}function r(u,v){const x=v[0],C=v[1];v=v[2];u[0]=x;u[1]=C;u[2]=v;u[3]=Math.sqrt(Math.abs(1-x*x-C*C-v*v));return u}function z(u,v,x,C){const R=v[0],S=v[1],
E=v[2];v=v[3];let O=x[0],W=x[1],ca=x[2];x=x[3];let la;let X;var B=R*O+S*W+E*ca+v*x;0>B&&(B=-B,O=-O,W=-W,ca=-ca,x=-x);1-B>y.EPSILON?(la=Math.acos(B),X=Math.sin(la),B=Math.sin((1-C)*la)/X,C=Math.sin(C*la)/X):B=1-C;u[0]=B*R+C*O;u[1]=B*S+C*W;u[2]=B*E+C*ca;u[3]=B*v+C*x;return u}function K(u){var v=y.RANDOM();const x=y.RANDOM(),C=y.RANDOM(),R=Math.sqrt(1-v);v=Math.sqrt(v);u[0]=R*Math.sin(2*Math.PI*x);u[1]=R*Math.cos(2*Math.PI*x);u[2]=v*Math.sin(2*Math.PI*C);u[3]=v*Math.cos(2*Math.PI*C);return u}function F(u,
v){const x=v[0],C=v[1],R=v[2];v=v[3];var S=x*x+C*C+R*R+v*v;S=S?1/S:0;u[0]=-x*S;u[1]=-C*S;u[2]=-R*S;u[3]=v*S;return u}function N(u,v){u[0]=-v[0];u[1]=-v[1];u[2]=-v[2];u[3]=v[3];return u}function L(u,v){var x=v[0]+v[4]+v[8];if(0<x)x=Math.sqrt(x+1),u[3]=.5*x,x=.5/x,u[0]=(v[5]-v[7])*x,u[1]=(v[6]-v[2])*x,u[2]=(v[1]-v[3])*x;else{let C=0;v[4]>v[0]&&(C=1);v[8]>v[3*C+C]&&(C=2);const R=(C+1)%3,S=(C+2)%3;x=Math.sqrt(v[3*C+C]-v[3*R+R]-v[3*S+S]+1);u[C]=.5*x;x=.5/x;u[3]=(v[3*R+S]-v[3*S+R])*x;u[R]=(v[3*R+C]+v[3*
C+R])*x;u[S]=(v[3*S+C]+v[3*C+S])*x}return u}function ba(u,v,x,C){var R=.5*Math.PI/180;v*=R;x*=R;C*=R;R=Math.sin(v);v=Math.cos(v);const S=Math.sin(x);x=Math.cos(x);const E=Math.sin(C);C=Math.cos(C);u[0]=R*x*C-v*S*E;u[1]=v*S*C+R*x*E;u[2]=v*x*E-R*S*C;u[3]=v*x*C+R*S*E;return u}function da(u){return"quat("+u[0]+", "+u[1]+", "+u[2]+", "+u[3]+")"}function ja(u,v,x){const C=q.dot(v,x);if(-.999999>C)return q.cross(J,Y,v),1E-6>q.len(J)&&q.cross(J,ea,v),q.normalize(J,J),p(u,J,Math.PI),u;if(.999999<C)return u[0]=
0,u[1]=0,u[2]=0,u[3]=1,u;q.cross(J,v,x);u[0]=J[0];u[1]=J[1];u[2]=J[2];u[3]=1+C;return c(u,u)}function V(u,v,x,C,R,S){z(pa,v,R,S);z(na,x,C,S);z(u,pa,na,2*S*(1-S));return u}function ma(u,v,x,C){const R=ha;R[0]=x[0];R[3]=x[1];R[6]=x[2];R[1]=C[0];R[4]=C[1];R[7]=C[2];R[2]=-v[0];R[5]=-v[1];R[8]=-v[2];return c(u,L(u,R))}const ka=A.copy,sa=A.set,g=A.add,t=A.scale,H=A.dot,U=A.lerp,T=A.length,aa=A.squaredLength,c=A.normalize,n=A.exactEquals;A=A.equals;const J=m.create(),Y=m.fromValues(1,0,0),ea=m.fromValues(0,
1,0),pa=b.create(),na=b.create(),ha=f.create();f=Object.freeze(Object.defineProperty({__proto__:null,identity:d,setAxisAngle:p,getAxisAngle:l,multiply:h,rotateX:k,rotateY:w,rotateZ:G,calculateW:r,slerp:z,random:K,invert:F,conjugate:N,fromMat3:L,fromEuler:ba,str:da,copy:ka,set:sa,add:g,mul:h,scale:t,dot:H,lerp:U,length:T,len:T,squaredLength:aa,sqrLen:aa,normalize:c,exactEquals:n,equals:A,rotationTo:ja,sqlerp:V,setAxes:ma},Symbol.toStringTag,{value:"Module"}));a.add=g;a.calculateW=r;a.conjugate=N;a.copy=
ka;a.dot=H;a.equals=A;a.exactEquals=n;a.fromEuler=ba;a.fromMat3=L;a.getAxisAngle=l;a.identity=d;a.invert=F;a.len=T;a.length=T;a.lerp=U;a.mul=h;a.multiply=h;a.normalize=c;a.quat=f;a.random=K;a.rotateX=k;a.rotateY=w;a.rotateZ=G;a.rotationTo=ja;a.scale=t;a.set=sa;a.setAxes=ma;a.setAxisAngle=p;a.slerp=z;a.sqlerp=V;a.sqrLen=aa;a.squaredLength=aa;a.str=da})},"esri/chunks/vec3f32":function(){define(["exports"],function(a){function f(){return new Float32Array(3)}function b(K){const F=new Float32Array(3);
F[0]=K[0];F[1]=K[1];F[2]=K[2];return F}function m(K,F,N){const L=new Float32Array(3);L[0]=K;L[1]=F;L[2]=N;return L}function y(K,F){return new Float32Array(K,F,3)}function q(){return f()}function A(){return m(1,1,1)}function d(){return m(1,0,0)}function p(){return m(0,1,0)}function l(){return m(0,0,1)}const h=f(),k=A(),w=d(),G=p(),r=l(),z=Object.freeze(Object.defineProperty({__proto__:null,create:f,clone:b,fromValues:m,createView:y,zeros:q,ones:A,unitX:d,unitY:p,unitZ:l,ZEROS:h,ONES:k,UNIT_X:w,UNIT_Y:G,
UNIT_Z:r},Symbol.toStringTag,{value:"Module"}));a.ONES=k;a.UNIT_X=w;a.UNIT_Y=G;a.UNIT_Z=r;a.ZEROS=h;a.clone=b;a.create=f;a.createView=y;a.fromValues=m;a.ones=A;a.unitX=d;a.unitY=p;a.unitZ=l;a.vec3f32=z;a.zeros=q})},"esri/views/3d/webgl-engine/materials/renderers/utils":function(){define("exports ../../../../../core/maybe ../../../../../chunks/mat4 ../../../../../chunks/mat4f64 ../../lib/Util ../../../../webgl/doublePrecisionUtils".split(" "),function(a,f,b,m,y,q){const A=new Float64Array(3),d=new Float32Array(6),
p=m.create();a.addObject3DStateID=function(l,h){f.isNone(l)&&(l=[]);l.push(h);return l};a.calculateTransformRelativeToOrigin=function(l,h,k){const w=l.origin.vec3;y.setMatrixTranslation3(p,-w[0],-w[1],-w[2]);f.isSome(l.transformation)?b.multiply(h,p,l.transformation):b.copy(h,p);k&&(b.invert(k,h),b.transpose(k,k))};a.encodeDoubleVec3=function(l,h,k,w,G){A[0]=l.get(h,0);A[1]=l.get(h,1);A[2]=l.get(h,2);q.encodeDoubleArray(A,d,3);k.set(G,0,d[0]);w.set(G,0,d[1]);k.set(G,1,d[2]);w.set(G,1,d[3]);k.set(G,
2,d[4]);w.set(G,2,d[5])};a.isInstanceHidden=function(l){return f.isSome(l)?!l.visible:!1};a.removeObject3DStateID=function(l,h){if(f.isNone(l))return null;l=l.filter(k=>k!==h);return 0===l.length?null:l};Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/webgl-engine/lib/Util":function(){define(["exports","../../../../chunks/vec2f64","../../../../chunks/vec4","../../../../chunks/vec4f64"],function(a,f,b,m){function y(d,p){if(!d)throw p=p||"assert",
console.log(Error(p).stack),new A(p);}const q=m.create();let A=function(){function d(p){this.message=p}d.prototype.toString=function(){return`AssertException: ${this.message}`};return d}();a.assert=y;a.fovd2fovx=function(d,p,l){return 2*Math.atan(p*Math.tan(.5*d)/Math.sqrt(p*p+l*l))};a.fovd2fovy=function(d,p,l){return 2*Math.atan(l*Math.tan(.5*d)/Math.sqrt(p*p+l*l))};a.fovx2fovd=function(d,p,l){return 2*Math.atan(Math.sqrt(p*p+l*l)*Math.tan(.5*d)/p)};a.fovy2fovd=function(d,p,l){return 2*Math.atan(Math.sqrt(p*
p+l*l)*Math.tan(.5*d)/l)};a.isTranslationMatrix=function(d){return 1===d[0]&&0===d[1]&&0===d[2]&&0===d[3]&&0===d[4]&&1===d[5]&&0===d[6]&&0===d[7]&&0===d[8]&&0===d[9]&&1===d[10]&&0===d[11]&&1===d[15]};a.logWithBase=function(d,p){return Math.log(d)/Math.log(p)};a.project=function(d,p,l,h,k){k||(k=d);q[0]=d[0];q[1]=d[1];q[2]=d[2];q[3]=1;b.transformMat4(q,q,p);2<k.length&&(k[2]=-q[2]);b.transformMat4(q,q,l);y(0!==q[3]);k[0]=q[0]/q[3];k[1]=q[1]/q[3];k[2]=q[2]/q[3];k[0]=(.5*k[0]+.5)*h[2]+h[0];k[1]=(.5*
k[1]+.5)*h[3]+h[1]};a.rayBoxTest=function(d,p,l,h){let k,w=(l[0]-d[0])/p[0],G=(h[0]-d[0])/p[0];w>G&&(k=w,w=G,G=k);let r=(l[1]-d[1])/p[1],z=(h[1]-d[1])/p[1];r>z&&(k=r,r=z,z=k);if(w>z||r>G)return!1;r>w&&(w=r);z<G&&(G=z);l=(l[2]-d[2])/p[2];d=(h[2]-d[2])/p[2];l>d&&(k=l,l=d,d=k);if(w>d||l>G)return!1;d<G&&(G=d);return 0>G?!1:!0};a.rayRay2D=function(d,p,l,h,k,w=f.create()){const G=(h[k]-l[k])*(p[0]-d[0])-(h[0]-l[0])*(p[k]-d[k]);if(0===G)return!1;l=((h[0]-l[0])*(d[k]-l[k])-(h[k]-l[k])*(d[0]-l[0]))/G;w[0]=
d[0]+l*(p[0]-d[0]);w[1]=d[k]+l*(p[k]-d[k]);return!0};a.setMatrixTranslation3=function(d,p,l,h){d[12]=p;d[13]=l;d[14]=h};a.verify=function(d,p){d||console.warn("Verify failed: "+(p||"")+"\n"+Error("verify").stack)};Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/doublePrecisionUtils":function(){define(["exports"],function(a){const f=new Float32Array(2);a.decodeDoubleArray=function(b,m,y){for(let q=0;q<y;++q)m[q]=b[2*q]+b[2*q+1]};a.encodeDoubleArray=
function(b,m,y){for(let q=0;q<y;++q)m[2*q]=b[q],m[2*q+1]=b[q]-m[2*q]};a.encodeDoubleHi=function(b,m){const y=b.length;for(let q=0;q<y;++q)f[0]=b[q],m[q]=f[0];return m};a.encodeDoubleLo=function(b,m){const y=b.length;for(let q=0;q<y;++q)f[0]=b[q],f[1]=b[q]-f[0],m[q]=f[1];return m};Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/support/cameraUtils":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../Camera ../../../core/Cyclical ../../../core/Logger ../../../core/mathUtils ../../../core/maybe ../../../core/promiseUtils ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../geometry/Point ../../../geometry/projection ../../../geometry/projectionEllipsoid ../../../geometry/SpatialReference ../../../geometry/support/scaleUtils ../../ViewingMode ../camera/intersectionUtils ../../../chunks/cameraUtilsPlanar ../../../chunks/cameraUtilsSpherical ./earthUtils ./ElevationProvider ../../support/spatialReferenceSupport".split(" "),
function(a,f,b,m,y,q,A,d,p,l,h,k,w,G,r,z,K,F,N,L,ba,da){function ja(E){return"global"===E.viewingMode?N.cameraUtilsSpherical:F.cameraUtilsPlanar}function V(E,O,W){const ca=E.state.camera,la=ca.width/2/ca.pixelRatio;E.renderCoordsHelper.viewingMode===z.ViewingMode.Global&&null!=W&&(O*=Math.cos(q.deg2rad(W)));O/=E.renderCoordsHelper.unitInMeters;return la/(96*39.37/O)/Math.tan(ca.fovX/2)}function ma(E,O,W){const ca=E.state.camera;O=96*39.37/(ca.width/2/ca.pixelRatio/(O*Math.tan(ca.fovX/2)));E.renderCoordsHelper.viewingMode===
z.ViewingMode.Global&&(O/=Math.cos(q.deg2rad(W)));return O*=E.renderCoordsHelper.unitInMeters}function ka(E,O,W,ca,la,X){if(ea(X)){const B=new S(X.signal);c(E,ca.heading,ca.tilt,O,W,la,B);B.resolver.promise.then(e=>{e=Y(E,e,ca.fov);if(A.isNone(e))X.resolver.reject();else return X.resolver.resolve(e)},e=>X.resolver.reject(e))}else return O=c(E,ca.heading,ca.tilt,O,W,la),Y(E,O,ca.fov,X)}function sa(E,O,W,ca,la){return ja(E).directionToHeadingTilt(O,W,ca,la)}function g(E,O){return!!(E.basemapTerrain&&
E.renderCoordsHelper.fromRenderCoords(O,v,E.spatialReference)&&A.unwrapOr(ba.getElevationAtPoint(E.elevationProvider,v),0)>v.z-1)}function t(E,O,W){return H.apply(this,arguments)}function H(){H=f._asyncToGenerator(function*(E,O,W){if(!E.renderCoordsHelper.fromRenderCoords(O,v,E.spatialReference))return!1;E=yield E.elevationProvider.queryElevation(v.x,v.y,v.z,v.spatialReference,"ground",W);return A.unwrapOr(E,0)>v.z-1});return H.apply(this,arguments)}function U(E,O,W){return T.apply(this,arguments)}
function T(){T=f._asyncToGenerator(function*(E,O,W){const ca=l.create();O?O instanceof h?(k.projectPointToVector(O,ca,E.renderSpatialReference),null==O.z&&null!=E.basemapTerrain&&(O=yield E.elevationProvider.queryElevation(O.x,O.y,O.z,O.spatialReference,"ground",W),A.isSome(O)&&E.renderCoordsHelper.setAltitude(ca,O))):p.copy(ca,O):p.copy(ca,E.state.camera.center);return ca});return T.apply(this,arguments)}function aa(E,O){const W=l.create();O&&O instanceof h?(k.projectPointToVector(O,W,E.renderSpatialReference),
null==O.z&&null!=E.basemapTerrain&&(O=ba.getElevationAtPoint(E.elevationProvider,O),A.isSome(O)&&E.renderCoordsHelper.setAltitude(W,O))):O?p.copy(W,O):p.copy(W,E.state.camera.center);return W}function c(E,O,W,ca,la,X,B){const e=ca&&ca instanceof h?ca:null;if(ea(B))return U(E,ca,B.signal).then(D=>{n(E,O,W,e,D,la,X,B)},D=>B.resolver.reject(D)),null;ca=aa(E,ca);return n(E,O,W,e,ca,la,X,B)}function n(E,O,W,ca,la,X,B,e){if(A.isNone(ca)&&(ca=k.projectVectorToPoint(la,E.renderSpatialReference,E.spatialReference||
G.WGS84),A.isNone(ca)))return null;X=Math.max(X,E.state.constraints.minimumPoiDistance);var D=J(E,O,W,la,X,B);const P=ja(E).eyeForCenterWithHeadingTilt,Q=P(la,X,D.heading,D.tilt);if(B===a.OrientationMode.ADJUST&&"global"===E.viewingMode&&0<W){const oa=()=>{var qa=X,ua=X;var va=E.state.constraints.tilt(ua);ua=ja(E).eyeTiltToLookAtTilt(W,la,ua);ua=Math.min(ua,.5*Math.PI);va=va.min*(1-.7)+.7*ua;qa=ja(E).lookAtTiltToEyeTilt(va,la,qa);B=1>W-qa?a.OrientationMode.LOCKED:a.OrientationMode.ADJUST;return n(E,
O,qa,ca,la,X,B,e)};D=E.map.ground.navigationConstraint;if(!D||"stay-above"===D.type){if(g(E,Q.eye))return oa();if(ea(e))return t(E,Q.eye,e.signal).then(qa=>{if(qa)return oa();e.resolver.resolve({eye:Q.eye,up:Q.up,center:l.clone(la),heading:Q.heading,tilt:Q.tilt});return null}),null}}D=!e||ea(e)?{center:l.create(),eye:l.create(),up:l.create(),tilt:0,heading:0}:e;D.eye=Q.eye;D.up=Q.up;D.center=l.clone(la);D.heading=Q.heading;D.tilt=Q.tilt;ea(e)&&e.resolver.resolve(D);return D}function J(E,O,W,ca,la,
X){var B=0;if(X=X===a.OrientationMode.ADJUST)if(B=E.pointsOfInterest.centerOnSurfaceFrequent.distance,8<Math.log(la/B)/Math.LN2)X=!0;else{var e=E.renderSpatialReference,D=E.spatialReference||G.WGS84;X=k.projectVectorToPoint(ca,e,D);e=k.projectVectorToPoint(E.pointsOfInterest.centerOnSurfaceFrequent.renderLocation,e,D);A.isNone(X)||A.isNone(e)?X=!1:(B*=Math.tan(.5*E.state.camera.fov),X=5<e.distance(X)/B)}X?(O=0,X=E.state.constraints.tilt(la),X.max=Math.min(X.max,.5*Math.PI),X=X.min*(1-.7)+.7*X.max,
W=ja(E).eyeTiltToLookAtTilt(W,ca,la),B=Math.min(W,X)):B=ja(E).eyeTiltToLookAtTilt(W,ca,la);W=B=E.state.constraints.clampTilt(la,B);W=ja(E).lookAtTiltToEyeTilt(W,ca,la);return{heading:O,tilt:W}}function Y(E,O,W,ca){if(A.isNone(O))return null;E=k.projectVectorToPoint(O.eye,E.renderSpatialReference,E.spatialReference||G.WGS84);return A.isNone(E)?null:A.isSome(ca)?(ca.position=E,ca.heading=O.heading,ca.tilt=O.tilt,ca.fov=W,ca):new b(E,O.heading,O.tilt,W)}function ea(E){return E&&"resolver"in E}const pa=
y.getLogger("esri.views.3d.support.cameraUtils"),na=l.create(),ha=l.create(),u={heading:0,tilt:0},v=new h,x=new m.Cyclical(-2.0037508342788905E7,2.0037508342788905E7),C=new m.Cyclical(-180,180);a.OrientationMode=void 0;(function(E){E[E.LOCKED=0]="LOCKED";E[E.ADJUST=1]="ADJUST"})(a.OrientationMode||(a.OrientationMode={}));const R=l.create();let S=function(E){this.signal=E;this.resolver=d.createResolver()};a.AsyncContext=S;a.computeScale=function(E,O,W){const ca=E.renderSpatialReference;O||(O=E.state.camera);
var la=G.WGS84;O instanceof b?(la=O.position.latitude,k.projectPointToVector(O.position,na,ca),k.projectPointToVector(W,ha,ca),O=p.distance(na,ha)):(k.projectVectorToVector(O.center,ca,ha,la),la=ha[1],O=O.distance);return ma(E,O,la)};a.directionToHeadingTilt=sa;a.distanceToScale=ma;a.externalToInternal=function(E,O){if(A.isNone(O))return null;var W=E.renderSpatialReference;const ca=ja(E).headingTiltToDirectionUp,la=l.create();if(!k.projectPointToVector(O.position,la,W))return null;W=ca(la,O.heading,
O.tilt);p.scale(W.direction,W.direction,E.state.camera.distance);p.add(W.direction,W.direction,la);E=K.cameraOnContentAlongViewDirection(E,la,W.direction,W.up);E.fov=q.deg2rad(O.fov);return E};a.fromCenterDistance=ka;a.fromCenterScale=function(E,O,W,ca,la,X){W=V(E,W,O.latitude);return ka(E,O,W,ca,la,X)};a.fromExtent=function(E,O,W,ca,la,X=null){var B=null!=O.zmax&&null!=O.zmin;let e;if(E.state.isGlobal){if(!da.isSpatialReferenceSupported(O.spatialReference,z.ViewingMode.Global))return ea(X)&&X.resolver.reject(),
null;var D=new h(O.xmin,O.ymin,O.spatialReference);const oa=new h(O.xmax,O.ymax,O.spatialReference),qa=O.spatialReference.isGeographic?C:x;var P=new h({x:qa.center(D.x,oa.x),y:(oa.y+D.y)/2,z:B?(O.zmax+O.zmin)/2:null,spatialReference:O.spatialReference});const ua=w.getReferenceEllipsoid(O.spatialReference);var Q=L.getGreatCircleSpanAt(P,D,oa);e=Q.lon;Q=Q.lat;qa.diff(D.x,oa.x)>qa.range/2&&(e+=ua.halfCircumference);e=Math.min(e,ua.halfCircumference);Q=Math.min(Q,ua.halfCircumference)}else P=A.unwrapOr(E.renderSpatialReference,
O.spatialReference),P.equals(O.spatialReference)||(O=k.project(O,P)),e=O.xmax-O.xmin,Q=O.ymax-O.ymin,P=new h({x:O.xmin+.5*e,y:O.ymin+.5*Q,z:B?(O.zmax+O.zmin)/2:null,spatialReference:P});D=E.state.camera;O=Math.max(1/Math.tan(D.fovX/2)*e*.5,1/Math.tan(D.fovY/2)*Q*.5,1/Math.tan(D.fov/2)*(B?O.zmax-O.zmin:0)*.5)/1;if(ea(X))B=new S(X.signal),c(E,W,ca,P,O,la,B),B.resolver.promise.then(oa=>{oa=Y(E,oa,E.camera.fov);if(A.isNone(oa))X.resolver.reject();else return X.resolver.resolve(oa)},oa=>X.resolver.reject(oa));
else return W=c(E,W,ca,P,O,la),Y(E,W,E.camera.fov,X)};a.getObserverForPointAtDistance=c;a.headingTiltToDirectionUp=function(E,O,W,ca,la){return ja(E).headingTiltToDirectionUp(O,W,ca,la)};a.internalToExternal=function(E,O,W){const ca=E.renderSpatialReference,la=sa(E,O.eye,O.viewForward,O.up,u);E=E.spatialReference||G.WGS84;k.projectVectorToVector(O.eye,ca,R,E)||(E=G.WGS84,k.projectVectorToVector(O.eye,ca,R,E));if(A.isNone(W))return new b(new h(R,E),la.heading,la.tilt,q.rad2deg(O.fov));W.position.x=
R[0];W.position.y=R[1];W.position.z=R[2];W.position.spatialReference=E;W.heading=la.heading;W.tilt=la.tilt;W.fov=q.rad2deg(O.fov);return W};a.observerToCamera=Y;a.scaleToDistance=V;a.scaleToResolution=function(E,O){return E.spatialReference?r.getResolutionForScale(O,E.spatialReference):void 0};a.scaleToZoom=function(E,O){var W;if(E=null==(W=E.basemapTerrain)?void 0:W.tilingScheme)return E.levelAtScale(O);pa.error("#scaleToZoom()","Cannot compute zoom from scale without a tiling scheme")};a.toExtent=
function(E,O,W){const ca=k.projectVectorToPoint(W,E.renderSpatialReference,E.spatialReference||G.WGS84);if(A.isNone(ca))return null;var la=Math.tan(O.fovX/2),X=Math.tan(O.fovY/2);O=p.dist(O.eye,W);la*=2*O;X*=2*O;return"global"===E.viewingMode?N.toExtent(E,ca,la,X):F.toExtent(E,ca,la,X)};a.zoomToScale=function(E,O){var W;if(E=null==(W=E.basemapTerrain)?void 0:W.tilingScheme)return E.scaleAtLevel(O);pa.error("#zoomToScale()","Cannot compute scale from zoom without a tiling scheme")};Object.defineProperties(a,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/support/scaleUtils":function(){define(["exports","../../core/unitUtils"],function(a,f){function b(m,y){y=f.getMetersPerUnitForSR(y);return m/(y*f.inchesPerMeter*96)}a.getExtentForScale=function(m,y){const q=m.extent;m=m.width;y=b(y,q.spatialReference);return q.clone().expand(y*m/q.width)};a.getResolutionForScale=b;a.getScale=function(m,y){y=y||m.extent;m=m.width;const q=f.getMetersPerUnitForSR(y&&y.spatialReference);
return y&&m?y.width/m*q*f.inchesPerMeter*96:0};a.getScaleForResolution=function(m,y){y=f.getMetersPerUnitForSR(y);return m*y*f.inchesPerMeter*96};Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/chunks/cameraUtilsPlanar":function(){define("exports ../core/mathUtils ./mat4 ./mat4f64 ./vec3 ./vec3f64 ../geometry/Extent ../geometry/projection ../views/3d/support/cameraUtilsInternal".split(" "),function(a,f,b,m,y,q,A,d,p){function l(ba,da,ja,V=p.createDirectionUp()){const {direction:ma,
up:ka}=V;b.fromZRotation(F,-f.deg2rad(da));b.rotateX(F,F,f.deg2rad(ja));y.transformMat4(ma,K,F);y.scale(ma,ma,-1);y.transformMat4(ka,z,F);return V}function h(ba,da,ja,V){return p.directionToHeadingTilt(da,ja,V,K,z)}function k(ba,da,ja,V){const ma=l(ba,ja,V),ka=q.create();y.scale(ka,ma.direction,-da);y.add(ka,ka,ba);return{up:ma.up,eye:ka,heading:ja,tilt:V}}function w(ba){return f.rad2deg(ba)}function G(ba){return f.deg2rad(ba)}function r(ba,da,ja,V,ma){const ka=ba.renderSpatialReference;ba=ba.map&&
ba.spatialReference||da.spatialReference;d.projectPointToVector(da,N,ka);d.projectPointToVector(da,L,ka);N[0]-=ja/2;L[0]+=ja/2;N[1]-=V/2;L[1]+=V/2;d.projectVectorToVector(N,ka,N,ba);d.projectVectorToVector(L,ka,L,ba);ma?(ma.xmin=N[0],ma.ymin=N[1],ma.xmax=L[0],ma.ymax=L[1],ma.spatialReference=ba):ma=new A(N[0],N[1],L[0],L[1],ba);return ma}const z=q.fromValues(0,1,0),K=q.fromValues(0,0,1),F=m.create(),N=q.create(),L=q.create();m=Object.freeze(Object.defineProperty({__proto__:null,headingTiltToDirectionUp:l,
directionToHeadingTilt:h,eyeForCenterWithHeadingTilt:k,lookAtTiltToEyeTilt:w,eyeTiltToLookAtTilt:G,toExtent:r},Symbol.toStringTag,{value:"Module"}));a.cameraUtilsPlanar=m;a.directionToHeadingTilt=h;a.eyeForCenterWithHeadingTilt=k;a.eyeTiltToLookAtTilt=G;a.headingTiltToDirectionUp=l;a.lookAtTiltToEyeTilt=w;a.toExtent=r})},"esri/views/3d/support/cameraUtilsInternal":function(){define(["exports","../../../core/mathUtils","../../../chunks/vec3","../../../chunks/vec3f64"],function(a,f,b,m){const y=m.create(),
q=m.create();a.createDirectionUp=function(){return{direction:m.create(),up:m.create()}};a.directionToHeadingTilt=function(A,d,p,l,h){let k=b.normalize(y,A),w=b.dot(k,l);const G=0<w;w=Math.abs(w);.99<w&&(w=Math.abs(b.dot(d,l)),.99>w?(b.copy(k,d),G&&b.scale(k,k,-1)):k=null);d=0;k&&(b.scale(q,l,b.dot(l,k)),b.subtract(k,k,q),d=b.dot(k,h)/(b.length(k)*b.length(h)),b.cross(q,k,h),d=(0<b.dot(q,l)?1:-1)*f.rad2deg(f.acosClamped(d)));A=f.rad2deg(f.acosClamped(-b.dot(l,A)/b.length(A)));if(!p)return{heading:d,
tilt:A};p.heading=d;p.tilt=A;return p};Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/chunks/cameraUtilsSpherical":function(){define("exports ../core/Cyclical ../core/mathUtils ./mat4 ./mat4f64 ./vec3 ./vec3f64 ../geometry/Extent ../geometry/projectionEllipsoid ../geometry/SpatialReference ../geometry/support/webMercatorUtils ../views/3d/support/cameraUtilsInternal ../views/3d/support/earthUtils".split(" "),function(a,f,b,m,y,q,A,d,p,l,h,k,w){function G(g,
t,H,U=k.createDirectionUp()){q.cross(ka,g,da);0===q.dot(ka,ka)&&q.cross(ka,g,ja);m.fromRotation(ma,-b.deg2rad(t),g);m.rotate(ma,ma,-b.deg2rad(H),ka);const {up:T,direction:aa}=U;q.cross(T,ka,g);q.normalize(T,T);q.transformMat4(T,T,ma);q.normalize(aa,g);q.negate(aa,aa);q.transformMat4(aa,aa,ma);return U}function r(g,t,H,U){const T=ka,aa=sa;q.normalize(T,g);q.cross(sa,T,da);0===q.dot(sa,sa)&&q.cross(sa,T,ja);q.cross(aa,sa,T);return k.directionToHeadingTilt(t,H,U,T,aa)}function z(g,t,H,U){const T={eye:A.create(),
up:null,tilt:U,heading:H},aa=ka;aa[0]=g[0];aa[1]=g[2];aa[2]=-g[1];H=b.deg2rad(H);var c=b.deg2rad(U);U=Math.sin(H);H=Math.cos(H);var n=Math.sin(c),J=Math.cos(c);const Y=q.length(aa);if(1E-8>Math.abs(c))c=t+Y;else{var ea=Y/n,pa=b.asinClamped(t/ea);c=ea*Math.sin(Math.PI-c-pa)}J*=t;ea=t*t*n*n;pa=H*H*ea;const na=c-J,ha=na*na;var u=pa*(pa+ha-aa[1]*aa[1]);if(0>u)return q.scale(T.eye,aa,c/Y),T.tilt=0,T;var v=Math.sqrt(u);const x=aa[1]*na;u=pa+ha;v=0<H?-v+x:v+x;if(1E-8>Math.abs(u))return 1E-8>Y?(T.eye[0]=
0,T.eye[1]=0,T.eye[2]=t):q.scale(T.eye,aa,c/Y),T.tilt=0,K(T.eye),F(T,g);T.eye[1]=v/u;t*=n;v=T.eye[1]*T.eye[1];n=1-v;u=Math.sqrt(n);ea=pa*v+U*U*ea-2*H*t*T.eye[1]*u*na+n*ha;if(1E-8>Math.abs(ea))return q.scale(T.eye,aa,c/Y),T.tilt=0,K(T.eye),F(T,g);T.eye[0]=(n*(c*aa[0]-J*aa[0])-t*u*(aa[0]*T.eye[1]*H+aa[2]*U))/ea;T.eye[2]=(n*(c*aa[2]-J*aa[2])-t*u*(aa[2]*T.eye[1]*H-aa[0]*U))/ea;q.scale(T.eye,T.eye,c);K(T.eye);return F(T,g)}function K(g){const t=g[1];g[1]=-g[2];g[2]=t}function F(g,t){t=G(t,g.heading,g.tilt);
g.up=t.up;return g}function N(g,t,H){t=q.length(t);H=b.asinClamped(H/(Math.sqrt(H*H+t*t-2*H*t*Math.cos(Math.PI-g))/Math.sin(g)));return b.rad2deg(g-H)}function L(g,t,H){g=b.deg2rad(g);t=q.length(t);return b.asinClamped(H/(t/Math.sin(g)))+g}function ba(g,t,H,U,T){function aa(Y){const ea=Math.PI/2;Y=f.cyclical2PI.normalize(Y,-ea);Y>ea&&(Y=Math.PI-Y);return Y}var c=t.latitude;var n=p.getReferenceEllipsoid(g.spatialReference).radius;t=t.longitude;var J=w.getLonDeltaForDistance(c,H,n)/2;H=t-J;t+=J;c=b.deg2rad(c);
c=(1+Math.sin(c))/(1-Math.sin(c));J=(c+1)*Math.tan(U/n/2);c=1.5*Math.PI-2*Math.atan(.5*(J+Math.sqrt(4*c+J*J)));U=c+U/n;c=aa(c);U=aa(U);U<c&&(n=U,U=c,c=n);c=Math.max(b.rad2deg(c),-90);U=Math.min(b.rad2deg(U),90);t=V.monotonic(H,t);180<t-H&&(n=(t-H-180)/2,H+=n,t-=n);n=g.spatialReference&&g.spatialReference.isGeographic?g.spatialReference:l.WGS84;T?(T.xmin=H,T.ymin=c,T.xmax=t,T.ymax=U,T.spatialReference=n):T=new d(H,c,t,U,n);g.spatialReference&&g.spatialReference.isWebMercator&&h.geographicToWebMercator(T,
!1,T);return T}const da=A.fromValues(0,0,1),ja=q.normalize(A.create(),A.fromValues(1,1,1)),V=new f.Cyclical(-180,180),ma=y.create(),ka=A.create(),sa=A.create();y=Object.freeze(Object.defineProperty({__proto__:null,headingTiltToDirectionUp:G,directionToHeadingTilt:r,eyeForCenterWithHeadingTilt:z,lookAtTiltToEyeTilt:N,eyeTiltToLookAtTilt:L,toExtent:ba},Symbol.toStringTag,{value:"Module"}));a.cameraUtilsSpherical=y;a.directionToHeadingTilt=r;a.eyeForCenterWithHeadingTilt=z;a.eyeTiltToLookAtTilt=L;a.headingTiltToDirectionUp=
G;a.lookAtTiltToEyeTilt=N;a.toExtent=ba})},"esri/views/3d/support/earthUtils":function(){define(["exports","../../../core/mathUtils","../../../geometry/Point","../../../geometry/projectionEllipsoid"],function(a,f,b,m){function y(d,p,l){return q(d,p.longitude,p.latitude,l.longitude,l.latitude)}function q(d,p,l,h,k){l=f.deg2rad(l);k=f.deg2rad(k);p=f.deg2rad(p);const w=f.deg2rad(h);h=Math.sin((l-k)/2);p=Math.sin((p-w)/2);l=2*f.asinClamped(Math.sqrt(h*h+Math.cos(l)*Math.cos(k)*p*p));return Math.round(l*
d*1E4)/1E4}function A(d,p){d/=15;p||(d=Math.round(d));return d}a.getGreatCircleDistance=q;a.getGreatCircleDistanceFromPoints=y;a.getGreatCircleSpanAt=function(d,p,l){const h=p.spatialReference,k=m.getReferenceEllipsoid(h),w=new b(p.x,d.y,h),G=new b(l.x,d.y,h);p=new b(d.x,p.y,h);d=new b(d.x,l.y,h);return{lon:y(k.radius,w,G),lat:y(k.radius,p,d)}};a.getLatDeltaForDistance=function(d,p){return f.rad2deg(d/p)};a.getLonDeltaForDistance=function(d,p,l){p/=l;d=f.deg2rad(d);p=Math.sin(p/2);d=Math.cos(d);d=
2*f.asinClamped(Math.sqrt(p*p/(d*d)));return f.rad2deg(d)};a.getMaxCameraAltitude=function(d,p){d=f.deg2rad(d/2);return(1-Math.sin(d))*p/Math.sin(d)};a.longitudeToTimezone=A;a.pointToTimezone=function(d,p){return A(d.longitude,p)};a.positionToTimezoneInfo=function(d,p){p||(p={hours:0,minutes:0,seconds:0});p.hours=A(d[0],!0);d=p.hours%1;p.hours-=d;p.minutes=60*d;d=p.minutes%1;p.minutes-=d;p.seconds=Math.round(60*d);return p};Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/3d/support/ElevationProvider":function(){define(["exports","../../../core/maybe","../../../layers/graphics/dehydratedFeatureUtils"],function(a,f,b){function m(y){return"array"in y}a.SamplePosition=function(y,q=null,A=0){this.array=y;this.spatialReference=q;this.offset=A};a.getElevationAtPoint=function(y,q,A="ground"){if(b.isDehydratedPoint(q))return y.getElevation(q.x,q.y,q.z||0,q.spatialReference,A);if(m(q)){let d=q.offset;return y.getElevation(q.array[d++],q.array[d++],q.array[d]||0,
f.unwrapOr(q.spatialReference,y.spatialReference),A)}return y.getElevation(q[0],q[1],q[2]||0,y.spatialReference,A)};a.isSamplePosition=m;Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/dehydratedFeatureUtils":function(){define(["exports"],function(a){a.isDehydratedPoint=function(f){return"point"===f.type};Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/webdoc/support/SlideThumbnail":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,f,b,m,y,q,A,d,p){var l;a.SlideThumbnail=l=function(h){function k(){var G=h.apply(this,arguments)||this;G.url="";return G}f._inheritsLoose(k,h);var w=k.prototype;w.destroy=function(){this.url=""};w.clone=function(){return new l({url:this.url})};return k}(m.JSONSupport);b.__decorate([y.property({type:String,json:{write:{isRequired:!0}}})],a.SlideThumbnail.prototype,"url",void 0);a.SlideThumbnail=l=b.__decorate([p.subclass("esri.webdoc.support.SlideThumbnail")],a.SlideThumbnail);Object.defineProperties(a,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/webscene/support/Description":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(a,f,b,m,y,q,A,d){var p;b=p=function(l){function h(){var k=l.apply(this,arguments)||this;k.text="";return k}
a._inheritsLoose(h,l);h.prototype.clone=function(){return new p({text:this.text})};return h}(b.JSONSupport);f.__decorate([m.property({type:String,json:{write:!0}})],b.prototype,"text",void 0);return b=p=f.__decorate([d.subclass("esri.webscene.support.Description")],b)})},"esri/webscene/support/SlideEnvironment":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../views/3d/environment/SunnyWeather ../../views/3d/environment/weather ../lightingTypes ../SunLighting".split(" "),
function(a,f,b,m,y,q,A,d,p,l,h,k){var w;a.SlideEnvironment=w=function(G){function r(){var z=G.apply(this,arguments)||this;z.lighting=new k;z.weather=new p;return z}f._inheritsLoose(r,G);r.prototype.clone=function(){return new w({lighting:y.clone(this.lighting),weather:y.clone(this.weather)})};return r}(m.JSONSupport);b.__decorate([q.property({types:h.lightingTypes,json:{write:!0}})],a.SlideEnvironment.prototype,"lighting",void 0);b.__decorate([q.property({types:l.weatherTypes,json:{write:!0}})],a.SlideEnvironment.prototype,
"weather",void 0);a.SlideEnvironment=w=b.__decorate([d.subclass("esri.webscene.Environment")],a.SlideEnvironment);Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/webscene/support/SlideGround":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Ground ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../webdoc/support/opacityUtils".split(" "),
function(a,f,b,m,y,q,A,d,p,l){var h;m=h=function(k){function w(){var r=k.apply(this,arguments)||this;r.opacity=null;return r}a._inheritsLoose(w,k);var G=w.prototype;G.clone=function(){return new h({opacity:this.opacity})};G.cloneAndApplyTo=function(r){if(null==this.opacity)return r;r=null!=r?r.clone():new b;r.opacity=this.opacity;return r};w.fromGround=function(r){return new h({opacity:r.opacity})};return w}(m.JSONSupport);f.__decorate([y.property({type:Number,json:{type:d.Integer,read:{reader:l.transparencyToOpacity,
source:"transparency"},write:{writer:(k,w)=>{w.transparency=l.opacityToTransparency(k)},target:"transparency"}}})],m.prototype,"opacity",void 0);return m=h=f.__decorate([p.subclass("esri.webscene.support.SlideGround")],m)})},"esri/webscene/support/SlideVisibleLayer":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,f,b,m,y,q,A,d){var p;a.SlideVisibleLayer=p=function(l){function h(k){k=l.call(this,k)||this;k.id="";k.sublayerIds=null;return k}f._inheritsLoose(h,l);h.prototype.clone=function(){return new p({id:this.id,sublayerIds:y.clone(this.sublayerIds)})};return h}(m.JSONSupport);b.__decorate([q.property({type:String,json:{write:!0}})],a.SlideVisibleLayer.prototype,"id",void 0);b.__decorate([q.property({type:[A.Integer],json:{read:{source:"subLayerIds"},write:{target:"subLayerIds"}}})],a.SlideVisibleLayer.prototype,
"sublayerIds",void 0);a.SlideVisibleLayer=p=b.__decorate([d.subclass("esri.webscene.support.SlideVisibleLayer")],a.SlideVisibleLayer);Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/webscene/support/Title":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,f,b,m,y,q,A,d){var p;b=p=function(l){function h(){var k=l.apply(this,arguments)||this;k.text="";return k}a._inheritsLoose(h,l);h.prototype.clone=function(){return new p({text:this.text})};return h}(b.JSONSupport);f.__decorate([m.property({type:String,json:{write:{isRequired:!0}}})],b.prototype,"text",void 0);return b=p=f.__decorate([d.subclass("esri.webscene.support.Title")],b)})},"esri/webscene/TransportationNetwork":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass".split(" "),
function(a,f,b,m,y,q,A,d){var p;b=p=function(l){function h(k){return l.call(this,k)||this}a._inheritsLoose(h,l);h.prototype.clone=function(){return new p({name:this.name,path:this.path,title:this.title})};return h}(b.JSONSupport);f.__decorate([m.property({type:String,json:{write:!0}})],b.prototype,"name",void 0);f.__decorate([m.property({type:String,json:{write:!0}})],b.prototype,"path",void 0);f.__decorate([m.property({type:String,json:{write:!0}})],b.prototype,"title",void 0);return b=p=f.__decorate([d.subclass("esri.webscene.TransportationNetwork")],
b)})},"esri/webscene/Version":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","../core/Version"],function(a,f,b){b=function(m){function y(q,A){return m.call(this,q,A,"webscene")||this}f._inheritsLoose(y,m);f._createClass(y,[{key:"supportsGround",get:function(){return this.since(1,8)}},{key:"supportsVisibleElevationLayersInSlides",get:function(){return this.lessThan(1,8)}}]);return y}(b.Version);a.Version=b;Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/core/Version":function(){define(["exports","./Error"],function(a,f){let b=function(){function m(q,A,d=""){this.major=q;this.minor=A;this._context=d}var y=m.prototype;y.lessThan=function(q,A){return this.major<q||q===this.major&&this.minor<A};y.since=function(q,A){return!this.lessThan(q,A)};y.validate=function(q){if(this.major!==q.major)throw new f((this._context&&this._context+":")+"unsupported-version",`Required major ${this._context&&this._context+" "}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,
{version:q});};y.clone=function(){return new m(this.major,this.minor,this._context)};m.parse=function(q,A=""){const [d,p]=q.split(".");var l=/^\s*\d+\s*$/;if(!d||!d.match||!d.match(l))throw new f((A&&A+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:q});if(!p||!p.match||!p.match(l))throw new f((A&&A+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:q});q=parseInt(d,10);l=parseInt(p,10);return new m(q,l,A)};return m}();
a.Version=b;Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"*noref":1}});
define("require ./chunks/_rollupPluginBabelHelpers ./chunks/tslib.es6 ./kernel ./Map ./Viewpoint ./core/Collection ./core/Error ./core/Handles ./core/has ./core/lang ./core/Loadable ./core/loadAll ./core/Logger ./core/maybe ./core/MultiOriginJSONSupport ./core/Promise ./core/promiseUtils ./core/urlUtils ./core/accessorSupport/decorators/property ./core/accessorSupport/ensureType ./core/accessorSupport/decorators/reader ./core/accessorSupport/decorators/subclass ./core/accessorSupport/decorators/writer ./core/accessorSupport/originUtils ./core/accessorSupport/read ./geometry/Extent ./geometry/HeightModelInfo ./geometry/projection ./geometry/SpatialReference ./geometry/support/heightModelInfoUtils ./geometry/support/jsonUtils ./geometry/support/spatialReferenceUtils ./portal/Portal ./portal/PortalItem ./support/MapFloorInfo ./support/webSceneUtils ./views/ViewingMode ./views/support/spatialReferenceSupport ./webdoc/support/saveUtils ./webdoc/support/thumbnailUtils ./webscene/ApplicationProperties ./webscene/Environment ./webscene/InitialViewProperties ./webscene/Presentation ./webscene/TransportationNetwork ./webscene/Version".split(" "),function(a,
f,b,m,y,q,A,d,p,l,h,k,w,G,r,z,K,F,N,L,ba,da,ja,V,ma,ka,sa,g,t,H,U,T,aa,c,n,J,Y,ea,pa,na,ha,u,v,x,C,R,S){const E=G.getLogger("esri.WebScene"),O=new S.Version(1,28);y=function(ca){function la(B){var e=ca.call(this,B)||this;e._handles=new p;e.applicationProperties=null;e.clippingArea=null;e.clippingEnabled=!1;e.floorInfo=null;e.heightModelInfo=null;e.sourceVersion=null;e.transportationNetworks=null;e.presentation=new C;e.initialViewProperties=new x;e.portalItem=null;e.resourceInfo=null;e._debouncedSaveOperations=
F.debounce(function(){var D=f._asyncToGenerator(function*(P,Q,oa){switch(P){case W.SAVE:return e._saveImpl(Q);case W.SAVE_AS:return e._saveAsImpl(oa,Q)}});return function(P,Q,oa){return D.apply(this,arguments)}}());e.resourceReferences={portalItem:null,paths:[]};e.authoringApp=null;e.authoringAppVersion=null;e._isAuthoringAppSetByUser=!1;e._isAuthoringAppVersionSetByUser=!1;return e}f._inheritsLoose(la,ca);var X=la.prototype;X.initialize=function(){this.when().catch(B=>{E.error("#load()","Failed to load web scene",
B)});if(this.resourceInfo){let B;try{B=this._validateJSON(this.resourceInfo)}catch(e){this.addResolvingPromise(Promise.reject(e));return}this.read(B);this.addResolvingPromise(this._validateSpatialReference());this.addResolvingPromise(this._validateHeightModelInfo())}this._handles.add(this.allLayers.on("change",()=>this._scheduleLayersIdGC()))};X.destroy=function(){this._unscheduleLayersIdGC();this._handles.destroy();this.presentation&&this.presentation.destroy();const B=this.portalItem;this.portalItem=
null;null==B?void 0:B.destroy()};X.writeClippingArea=function(B,e){e.clippingArea||(e.clippingArea={});e.clippingArea.geometry=B.toJSON()};X.readClippingEnabled=function(B,e){return e.clippingArea?!!e.clippingArea.clip:!1};X.writeClippingEnabled=function(B,e){this.clippingArea&&(e.clippingArea||(e.clippingArea={}),e.clippingArea.clip=B)};X.writeLayers=function(B,e,D,P){const Q={...P,layerContainerType:"operational-layers"};B=B.map(oa=>this.verifyWriteLayer(oa,P)?oa.write({},Q):null).filter(oa=>!!oa);
e[D]=B.toArray()};X.verifyWriteLayer=function(B,e){return"write"in B?!0:(e&&e.messages&&e.messages.push(new d("layer:unsupported",`Layers (${B.title}, ${B.id}) of type '${B.declaredClass}' cannot be persisted in web scenes`,{layer:B})),!1)};X.readSourceVersion=function(B,e){const [D,P]=e.version.split(".");return new S.Version(parseInt(D,10),parseInt(P,10))};X.writeSourceVersion=function(B,e,D){e[D]=`${O.major}.${O.minor}`};X.writeAuthoringApp=function(B,e){e.authoringApp=B&&this._isAuthoringAppSetByUser?
B:"ArcGIS API for JavaScript"};X.writeAuthoringAppVersion=function(B,e){e.authoringAppVersion=B&&this._isAuthoringAppVersionSetByUser?B:m.version};X.writeGround=function(B,e,D,P){e[D]=B?B.write({},P):{transparency:0,layers:[]}};X.readInitialViewProperties=function(B,e){B={};e.initialState&&e.initialState.environment&&(B.environment=v.fromJSON(e.initialState.environment));B.spatialReference=e.spatialReference?H.fromJSON(e.spatialReference):H.WebMercator;B.viewingMode=e.viewingMode||"global";e.initialState&&
e.initialState.viewpoint&&(B.viewpoint=q.fromJSON(e.initialState.viewpoint));return new x(B)};X.load=function(B){this.addResolvingPromise(this._loadFromSource());return Promise.resolve(this)};X.loadAll=function(){return w.loadAll(this,B=>{const e=this.presentation&&this.presentation.slides;B(this.ground,this.basemap,this.layers,e&&e.map(D=>D.basemap))})};X.read=function(B,e){e={...e,origin:"web-scene"};const D=this._isAuthoringAppVersionSetByUser,P=this._isAuthoringAppSetByUser;ka.readLoadable(this,
B,Q=>ca.prototype.read.call(this,B,Q),e);P||(this._isAuthoringAppSetByUser=!1);D||(this._isAuthoringAppVersionSetByUser=!1);if(B.baseMap&&Array.isArray(B.baseMap.elevationLayers)&&this.sourceVersion.supportsVisibleElevationLayersInSlides){e=B.baseMap.elevationLayers.map(ua=>({id:ua.id}));const Q=this.presentation.slides,oa=(ua,va)=>ua.visibleLayers.some(za=>za.id===va),qa=e.filter(ua=>!Q.some(va=>oa(va,ua.id)));Q.forEach(ua=>{ua.visibleLayers.addMany(qa)})}};X._writeBasemapElevationLayers=function(B){const e=
B.ground&&B.ground.layers;!B.baseMap&&e&&e.length&&(B.baseMap={title:"Basemap",baseMapLayers:[]});B.baseMap&&(B.baseMap.elevationLayers=h.clone(e))};X.write=function(B,e){var D;if("loaded"!==this.loadStatus)throw e=new d("webscene:not-loaded","Web scene must be loaded before it can be serialized"),E.error("#toJSON()","Web scene must be loaded before it can be serialized",this.loadError||this.loadStatus),e;this._runLayersIdGC();var P=!(null!=(D=e)&&D.messages);e={messages:[],...e,origin:"web-scene"};
B=ca.prototype.write.call(this,B,e);if(P&&(e=e.messages.filter(Q=>"web-document-write:property-required"===Q.name),e.length))throw P=new d("web-document:property-required","One or more properties that are required in the webscene JSON are missing, see details for the specific errors",{errors:e}),E.error("#toJSON()","One or more properties that are required in the webscene JSON are missing",e),P;this._writeBasemapElevationLayers(B);return B};X.save=function(){var B=f._asyncToGenerator(function*(e){return this._debouncedSaveOperations(W.SAVE,
e)});return function(e){return B.apply(this,arguments)}}();X._saveImpl=function(){var B=f._asyncToGenerator(function*(e){this.portalItem||(E.error("save(): requires the .portalItem property to be set"),yield Promise.reject(new d("webscene:portal-item-not-set","Portal item to save to has not been set on the WebScene")));"Web Scene"!==this.portalItem.type&&(yield Promise.reject(new d("webscene:portal-item-wrong-type",'Portal item needs to have type "Web Scene"')));const D=this._updateFromPromise;yield this._ensureLoadBeforeSave();
const P=this._enableVerifyItemRelativeUrls({origin:"web-scene",url:this.portalItem.itemUrl&&N.urlToObject(this.portalItem.itemUrl),messages:[],portal:this.portalItem.portal||c.getDefault(),portalItem:this.portalItem,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}}),Q=this.write({},P);yield Promise.all(P.resources.pendingOperations);yield this._verifySave(Q,P,e);this._updateTypeKeywords(this.portalItem);yield this.portalItem.update({data:Q});
yield na.saveResources(this.resourceReferences,P,null);ma.updateOrigins(P);D&&(yield D);yield this._saveThumbnail();return this.portalItem});return function(e){return B.apply(this,arguments)}}();X.saveAs=function(){var B=f._asyncToGenerator(function*(e,D){return this._debouncedSaveOperations(W.SAVE_AS,D,e)});return function(e,D){return B.apply(this,arguments)}}();X._saveAsImpl=function(){var B=f._asyncToGenerator(function*(e,D){e=n.from(e);e||(E.error("saveAs(portalItem): requires a portal item parameter"),
yield Promise.reject(new d("webscene:portal-item-required","saveAs requires a portal item to save to")));e.id&&(e=e.clone(),e.id=null);const P=e.portal||c.getDefault();yield this._ensureLoadBeforeSave();e.type="Web Scene";e.portal=P;const Q=this._enableVerifyItemRelativeUrls({origin:"web-scene",url:null,messages:[],portal:P,portalItem:e,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}}),oa=this.write({},Q);yield Promise.all(Q.resources.pendingOperations);
yield this._verifySaveAs(oa,Q,D);const qa=this.thumbnailUrl,ua=!this._isOverridden("thumbnailUrl");this._updateTypeKeywords(e);yield P._signIn();yield P.user.addItem({item:e,folder:D&&D.folder,data:oa});yield na.saveResources(this.resourceReferences,Q,null);this.portalItem=e;z.MultiOriginJSONSupport.prototype.read.call(this,{version:oa.version,authoringApp:oa.authoringApp,authoringAppVersion:oa.authoringAppVersion},{name:"web-scene",ignoreDefaults:!0,url:e.itemUrl&&N.urlToObject(e.itemUrl)});ma.updateOrigins(Q);
qa&&(this.thumbnailUrl=ua?N.addQueryParameter(qa,"w","8192"):qa);Q.portalItem=e;yield this._saveThumbnail();return e});return function(e,D){return B.apply(this,arguments)}}();X._saveThumbnail=function(){var B=f._asyncToGenerator(function*(){this._isOverridden("thumbnailUrl")&&(yield this.portalItem.updateThumbnail({thumbnail:this.thumbnailUrl}),this._clearOverride("thumbnailUrl"),this.clear("thumbnailUrl","user"))});return function(){return B.apply(this,arguments)}}();X._verifySave=function(B,e,D,
P=!1){if(!aa.isEarth(this.spatialReference))return Promise.reject(new d("webscene:unsupported-spatial-reference","Webscenes using spatial reference systems from Mars or Moon can not be saved currently."));let Q=e.messages.filter(qa=>"error"===qa.type).map(qa=>new d(qa.name,qa.message,qa.details));e.blockedRelativeUrls&&(Q=Q.concat(e.blockedRelativeUrls.map(qa=>new d("url:unsupported",`Relative url '${qa}' is not supported in Web Scene`))));D&&D.ignoreUnsupported&&(Q=Q.filter(qa=>"layer:unsupported"!==
qa.name&&"symbol:unsupported"!==qa.name&&"symbol-layer:unsupported"!==qa.name&&"property:unsupported"!==qa.name&&"url:unsupported"!==qa.name&&"scenemodification:unsupported"!==qa.name));null!=D&&D.requiredPropertyChecksDisabled&&(Q=Q.filter(qa=>"web-document-write:property-required"!==qa.name));const oa=D&&D.strictSchemaValidationEnabled;return(oa?(new Promise((qa,ua)=>a(["./webscene/support/schemaValidator"],qa,ua))).then(qa=>{qa=qa.validate(B);if(0<qa.length){const ua=`webscene did not validate:\n${qa.join("\n")}`;
E.error(`${P?"saveAs":"save"}(): ${ua}`)}return qa.map(ua=>new d("webscene:schema-validation",ua))}).then(qa=>{if(oa&&0<qa.length)throw Y.createSchemaValidationError(qa.concat(Q));return Q}):Promise.resolve(Q)).then(qa=>{if(0<qa.length)throw new d("webscene:save","Failed to save webscene due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:qa});})};X._verifySaveAs=function(B,e,D){return this.canNotSaveAs(e)?Promise.reject(Y.createCopyError()):this._verifySave(B,
e,D,!0)};X.verifySaveAs=function(B){const e=this._enableVerifyItemRelativeUrls({origin:"web-scene",messages:[]}),D=this.write({},e);return this._verifySaveAs(D,e,B)};X.canNotSaveAs=function(B){B||(B=this._enableVerifyItemRelativeUrls({origin:"web-scene",messages:[]}),this.write({},B));return B.verifyItemRelativeUrls&&0<B.verifyItemRelativeUrls.writtenUrls.length};X.updateFrom=function(){var B=f._asyncToGenerator(function*(e,D={}){this._updateFromPromise=e=this._updateFrom(e,D);yield e;this._updateFromPromise===
e&&(this._updateFromPromise=null)});return function(e){return B.apply(this,arguments)}}();X._updateFrom=function(){var B=f._asyncToGenerator(function*(e,D={}){yield e.whenReady();!D.environmentExcluded&&e.environment&&(this.initialViewProperties.environment=v.prototype.clone.apply(e.environment));!D.viewpointExcluded&&e.viewpoint&&(this.initialViewProperties.viewpoint=e.viewpoint.clone());this.initialViewProperties.spatialReference=e.spatialReference.clone();this.initialViewProperties.viewingMode=
e.viewingMode;r.isSome(e.clippingArea)?e.clippingArea!==this.clippingArea&&(this.clippingArea=e.clippingArea.clone(),this.clippingEnabled=!0):this.clippingEnabled=!1;e.heightModelInfo&&(this.heightModelInfo=e.heightModelInfo.clone());if(e.map===this)for(const P of e.allLayerViews)"visible"in P&&"visible"in P.layer&&P._isOverridden("visible")&&(P.layer.visible=P.visible);if(!1===D.thumbnailExcluded||null==D.thumbnailExcluded&&!D.viewpointExcluded)yield this._updateFromThumbnail(e,D.thumbnailSize||
void 0)});return function(e){return B.apply(this,arguments)}}();X._updateFromThumbnail=function(){var B=f._asyncToGenerator(function*(e,D){D=ha.getOptimalThumbnailSize(e,D);this.thumbnailUrl=(yield e.takeScreenshot({format:"jpg",width:D.width,height:D.height,disableDecorations:!0})).dataUrl});return function(e,D){return B.apply(this,arguments)}}();X._loadFromSource=function(){return this.resourceInfo?this._loadFromJSON(this.resourceInfo,{origin:"web-scene"}):this.portalItem&&this.portalItem.id?this._loadFromItem(this.portalItem):
this._loadObjectsWithLayers()};X._readAndLoadFromJSON=function(B,e){B=this._validateJSON(B);this.read(B,e);return this._loadFromJSON(B,e)};X._extractOperationalLayers=function(B){const e=[];if(!this.sourceVersion.supportsGround&&B.baseMap&&Array.isArray(B.baseMap.elevationLayers))for(const Q of B.baseMap.elevationLayers)e.push(Q);const D=[],P=Q=>{Q.layers&&(Q.layers=Q.layers.filter(P));return"ArcGISTiledElevationServiceLayer"===Q.layerType?(this.sourceVersion.supportsGround||D.push(Q),!1):!0};return{operationalLayers:B.operationalLayers?
B.operationalLayers.filter(P):[],operationalElevationLayers:D,basemapElevationLayers:e}};X._loadFromJSON=function(B,e){const D=new A;return this._validateSpatialReference().then(()=>this._validateHeightModelInfo()).then(()=>new Promise((P,Q)=>a(["./layers/support/layersCreator"],P,Q))).then(({populateOperationalLayers:P})=>{const {operationalLayers:Q,operationalElevationLayers:oa,basemapElevationLayers:qa}=this._extractOperationalLayers(B),ua=[],va={context:{...e,layerContainerType:"operational-layers"}};
this.portalItem&&(va.context.portal=this.portalItem.portal||c.getDefault());0<qa.length&&ua.push(P(this.ground.layers,qa,{...va,context:{...va.context,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"}));0<oa.length&&ua.push(P(D,oa,{...va,context:{...va.context,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"}));Q&&0<Q.length&&ua.push(P(this.layers,Q,va));return F.eachAlways(ua).then(()=>{})}).then(()=>this._loadObjectsWithLayers()).then(()=>
{this.ground.layers.addMany(D)})};X._ensureLoadBeforeSave=function(){var B=f._asyncToGenerator(function*(){yield this.load();yield this._loadObjectsWithLayers();const e=[];for(const D of this.allLayers.items)if("beforeSave"in D&&"function"===typeof D.beforeSave){const P=D.beforeSave();P&&e.push(P)}yield F.eachAlways(e)});return function(){return B.apply(this,arguments)}}();X._loadObjectsWithLayers=function(){var B=f._asyncToGenerator(function*(){const e=[];this.ground&&e.push(this.ground.load());
this.basemap&&e.push(this.basemap.load());this.presentation.slides.forEach(D=>{D.basemap&&e.push(D.basemap.load())});yield F.eachAlways(e)});return function(){return B.apply(this,arguments)}}();X._loadFromItem=function(){var B=f._asyncToGenerator(function*(e){yield e.load().catch(Q=>{throw new d("webscene:load-portal-item","Failed to load portal item",{error:Q});});if("Web Scene"!==e.type)throw new d("webscene:invalid-portal-item","Invalid portal item type '${type}', expected 'Web Scene'",{type:e.type});
const D=yield e.fetchData();this.resourceInfo=D;const P={origin:"web-scene",url:N.urlToObject(e.itemUrl),portal:e.portal||c.getDefault(),portalItem:e,readResourcePaths:[]};yield this._readAndLoadFromJSON(D,P);this.resourceReferences={portalItem:e,paths:P.readResourcePaths}});return function(e){return B.apply(this,arguments)}}();X._validateSpatialReference=function(){const B=this.initialViewProperties,e=this._sceneSpatialReference;let D;if("local"!==B.viewingMode){if(!pa.isSpatialReferenceSupported(e,
ea.ViewingMode.Global))return Promise.reject(new d("webscene:unsupported-spatial-reference","Unsupported spatial reference (${spatialReference.wkid}) in global mode, only Web Mercator, WGS84 GCS or CGCS2000 are supported",{spatialReference:e,viewingMode:B.viewingMode}));D=oa=>!oa||t.canProjectWithoutEngine(oa,e)}else{if(!pa.isSpatialReferenceSupported(e,ea.ViewingMode.Local))return Promise.reject(new d("webscene:unsupported-spatial-reference","Unsupported spatial reference (${spatialReference.wkid}) in local mode, only projected coordinate systems are supported",
{spatialReference:e,viewingMode:B.viewingMode}));D=oa=>!oa||oa.equals(e)}const P=oa=>oa&&(r.isSome(oa.camera)&&oa.camera.position&&oa.camera.position.spatialReference||r.isSome(oa.targetGeometry)&&oa.targetGeometry.spatialReference);var Q=P(B.viewpoint);return Q&&!D(Q)?Promise.reject(new d("webscene:incompatible-camera-spatial-reference","Camera spatial reference (${cameraSpatialReference.wkid}) is incompatible with the scene spatial reference (${sceneSpatialReference.wkid})",{cameraSpatialReference:Q,
sceneSpatialReference:e,viewingMode:B.viewingMode})):(Q=this.presentation.slides.find(oa=>!D(P(oa.viewpoint))))?(Q=P(Q.viewpoint),Promise.reject(new d("webscene:incompatible-slide-spatial-reference","Slide spatial reference (${slideSpatialReference.wkid}) is incompatible with the scene spatial reference (${sceneSpatialReference.wkid})",{slideSpatialReference:Q,sceneSpatialReference:e,viewingMode:B.viewingMode}))):Promise.resolve()};X._validateHeightModelInfo=function(){const B=U.validateWebSceneError(this.heightModelInfo,
this._sceneSpatialReference);return B?Promise.reject(B):Promise.resolve()};X._validateJSON=function(B){const e=S.Version.parse(B.version||"","webscene");O.validate(e);B.version=`${e.major}.${e.minor}`;1===e.major&&2>=e.minor&&(B.spatialReference=H.WebMercator.toJSON());return B};X._updateTypeKeywords=function(B){"local"===this.initialViewProperties.viewingMode?B.typeKeywords?B.typeKeywords.includes("ViewingMode-Local")||B.typeKeywords.push("ViewingMode-Local"):B.typeKeywords=["ViewingMode-Local"]:
"global"===this.initialViewProperties.viewingMode&&B.typeKeywords&&(B.typeKeywords=B.typeKeywords.filter(e=>"ViewingMode-Local"!==e));B.typeKeywords&&(B.typeKeywords=B.typeKeywords.filter((e,D,P)=>P.indexOf(e)===D))};X._enableVerifyItemRelativeUrls=function(B){const e=this._verifyItemRelativeRootPath;e&&(B.verifyItemRelativeUrls={rootPath:e,writtenUrls:[]});return B};X._unscheduleLayersIdGC=function(){this._layersIdGCTimeoutId&&(clearTimeout(this._layersIdGCTimeoutId),this._layersIdGCTimeoutId=0)};
X._scheduleLayersIdGC=function(){this._unscheduleLayersIdGC();this._layersIdGCTimeoutId=setTimeout(()=>{this._layersIdGCTimeoutId=0;this._runLayersIdGC()},3E3)};X._runLayersIdGC=function(){this._unscheduleLayersIdGC();var B=this.applicationProperties&&this.applicationProperties.viewing&&this.applicationProperties.viewing.search;const e=D=>this.allLayers.some(P=>P.id===D);B&&B.layers&&(B.layers=B.layers.filter(D=>e(D.id)));(B=this.presentation&&this.presentation.slides)&&B.forEach(D=>{D.visibleLayers&&
(D.visibleLayers=D.visibleLayers.filter(P=>e(P.id)))})};la.fromJSON=function(B){if(!B)throw new d("webscene:empty-resource","Expected a JSON resource but got nothing");return new this({resourceInfo:B})};f._createClass(la,[{key:"thumbnailUrl",get:function(){return this.portalItem&&this.portalItem.thumbnailUrl||null},set:function(B){B?this._override("thumbnailUrl",B):(this._clearOverride("thumbnailUrl"),this.clear("thumbnailUrl","user"))}},{key:"authoringApp",set:function(B){this._isAuthoringAppSetByUser=
!0;this._set("authoringApp",B)}},{key:"authoringAppVersion",set:function(B){this._isAuthoringAppVersionSetByUser=!0;this._set("authoringAppVersion",B)}},{key:"spatialReference",get:function(){var B,e;return null!=(B=null==(e=this.initialViewProperties)?void 0:e.spatialReference)?B:H.WebMercator}},{key:"viewingMode",get:function(){var B,e;return null!=(B=null==(e=this.initialViewProperties)?void 0:e.viewingMode)?B:"global"}},{key:"_sceneSpatialReference",get:function(){return this.initialViewProperties.spatialReference||
H.WebMercator}},{key:"_verifyItemRelativeRootPath",get:function(){return this.portalItem&&this.portalItem.itemUrl?N.urlToObject(this.portalItem.itemUrl).path:null}}]);return la}(k.LoadableMixin(K.EsriPromiseMixin(z.MultiOriginJSONMixin(y))));y.VERSION=O;b.__decorate([L.property({type:u,json:{write:!0}})],y.prototype,"applicationProperties",void 0);b.__decorate([L.property({json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],y.prototype,"basemap",void 0);b.__decorate([L.property({type:sa,json:{read:{source:"clippingArea.geometry",
reader:T.fromJSON},write:{target:"clippingArea.geometry"}}})],y.prototype,"clippingArea",void 0);b.__decorate([V.writer("clippingArea")],y.prototype,"writeClippingArea",null);b.__decorate([L.property({type:Boolean,json:{write:{target:"clippingArea.clip"}}})],y.prototype,"clippingEnabled",void 0);b.__decorate([da.reader("clippingEnabled",["clippingArea"])],y.prototype,"readClippingEnabled",null);b.__decorate([V.writer("clippingEnabled")],y.prototype,"writeClippingEnabled",null);b.__decorate([L.property({type:J,
json:{read:{source:"mapFloorInfo"},write:{target:"mapFloorInfo"}}})],y.prototype,"floorInfo",void 0);b.__decorate([L.property({type:g,json:{write:!0}})],y.prototype,"heightModelInfo",void 0);b.__decorate([L.property({json:{write:{target:"operationalLayers",ignoreOrigin:!0}}})],y.prototype,"layers",void 0);b.__decorate([V.writer("layers")],y.prototype,"writeLayers",null);b.__decorate([L.property({readOnly:!0,type:S.Version,json:{type:(()=>{const ca=[],la=O.major;for(let X=8;X<=O.minor;X++)ca.push(`${la}.${X}`);
return ca})(),write:{ignoreOrigin:!0,target:"version",isRequired:!0,overridePolicy:()=>({enabled:!0,allowNull:!0,ignoreOrigin:!0})}}})],y.prototype,"sourceVersion",void 0);b.__decorate([da.reader("sourceVersion",["version"])],y.prototype,"readSourceVersion",null);b.__decorate([V.writer("sourceVersion")],y.prototype,"writeSourceVersion",null);b.__decorate([L.property({json:{read:!1,write:!1}})],y.prototype,"tables",void 0);b.__decorate([L.property()],y.prototype,"thumbnailUrl",null);b.__decorate([L.property({type:String,
json:{write:{writerEnsuresNonNull:!0,ignoreOrigin:!0}}})],y.prototype,"authoringApp",null);b.__decorate([V.writer("authoringApp")],y.prototype,"writeAuthoringApp",null);b.__decorate([L.property({type:String,json:{write:{writerEnsuresNonNull:!0,ignoreOrigin:!0}}})],y.prototype,"authoringAppVersion",null);b.__decorate([V.writer("authoringAppVersion")],y.prototype,"writeAuthoringAppVersion",null);b.__decorate([L.property({json:{write:{isRequired:!0,allowNull:!0,ignoreOrigin:!0,enabled:!0}}})],y.prototype,
"ground",void 0);b.__decorate([V.writer("ground")],y.prototype,"writeGround",null);b.__decorate([L.property({type:A.ofType(R),json:{write:!0}})],y.prototype,"transportationNetworks",void 0);b.__decorate([L.property({type:C,nonNullable:!0,json:{write:{ignoreOrigin:!0,writer:(ca,la,X,B)=>{ca.slides&&0<ca.slides.length&&(la.presentation=ca.write({},{...B,isPresentation:!0}))}}}})],y.prototype,"presentation",void 0);b.__decorate([L.property({type:x,nonNullable:!0,json:{write:{target:"initialState",isRequired:!0,
ignoreOrigin:!0},default:()=>new x({viewingMode:"global",spatialReference:H.WebMercator})}})],y.prototype,"initialViewProperties",void 0);b.__decorate([da.reader("initialViewProperties",["initialState.environment","spatialReference","viewingMode","initialState.viewpoint"])],y.prototype,"readInitialViewProperties",null);b.__decorate([L.property({type:H,json:{read:!1,write:{isRequired:!0,ignoreOrigin:!0}}})],y.prototype,"spatialReference",null);b.__decorate([L.property({type:["local","global"],json:{read:!1,
write:{isRequired:!0,ignoreOrigin:!0}}})],y.prototype,"viewingMode",null);b.__decorate([L.property({type:n})],y.prototype,"portalItem",void 0);b.__decorate([L.property()],y.prototype,"resourceInfo",void 0);y=b.__decorate([ja.subclass("esri.WebScene")],y);var W;(function(ca){ca[ca.SAVE=0]="SAVE";ca[ca.SAVE_AS=1]="SAVE_AS"})(W||(W={}));return y});