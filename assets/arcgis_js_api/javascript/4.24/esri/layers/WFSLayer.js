// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/graphics/sources/WFSSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/HandleOwner ../../../core/has ../../../core/Loadable ../../../core/maybe ../../../core/promiseUtils ../../../core/workers/workers ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../geometry/support/typeUtils ./support/clientSideDefaults ../../ogc/wfsUtils ../../../rest/support/FeatureSet ../../../geometry/Extent".split(" "),
function(t,g,G,y,B,A,H,S,C,O,K,L,T,D,I,l,U,P,a,h){t.WFSSource=function(q){function v(){var p=q.apply(this,arguments)||this;p.capabilities=U.createCapabilities(!1,!1);p.type="wfs";p.refresh=O.debounce(function(){var f=g._asyncToGenerator(function*(u){yield p.load();({extent:u}=yield p._connection.invoke("refresh",u));p.sourceJSON.extent=u;return{dataChanged:!0,updates:{extent:p.sourceJSON.extent}}});return function(u){return f.apply(this,arguments)}}());return p}g._inheritsLoose(v,q);var z=v.prototype;
z.load=function(p){var f;p=null!=(f=C.isSome(p)&&p.signal)?f:null;this.addResolvingPromise(this._startWorker({signal:p}));return Promise.resolve(this)};z.destroy=function(){var p;null==(p=this._connection)?void 0:p.close();this._connection=null};z.openPorts=function(){var p=g._asyncToGenerator(function*(){yield this.load();return this._connection.openPorts()});return function(){return p.apply(this,arguments)}}();z.queryFeatures=function(){var p=g._asyncToGenerator(function*(f,u={}){yield this.load(u);
f=yield this._connection.invoke("queryFeatures",f?f.toJSON():null,u);return a.fromJSON(f)});return function(f){return p.apply(this,arguments)}}();z.queryFeaturesJSON=function(){var p=g._asyncToGenerator(function*(f,u={}){yield this.load(u);return this._connection.invoke("queryFeatures",f?f.toJSON():null,u)});return function(f){return p.apply(this,arguments)}}();z.queryFeatureCount=function(){var p=g._asyncToGenerator(function*(f,u={}){yield this.load(u);return this._connection.invoke("queryFeatureCount",
f?f.toJSON():null,u)});return function(f){return p.apply(this,arguments)}}();z.queryObjectIds=function(){var p=g._asyncToGenerator(function*(f,u={}){yield this.load(u);return this._connection.invoke("queryObjectIds",f?f.toJSON():null,u)});return function(f){return p.apply(this,arguments)}}();z.queryExtent=function(){var p=g._asyncToGenerator(function*(f,u={}){yield this.load(u);f=yield this._connection.invoke("queryExtent",f?f.toJSON():null,u);return{count:f.count,extent:h.fromJSON(f.extent)}});return function(f){return p.apply(this,
arguments)}}();z.querySnapping=function(){var p=g._asyncToGenerator(function*(f,u={}){yield this.load(u);return this._connection.invoke("querySnapping",f,u)});return function(f){return p.apply(this,arguments)}}();z._createLoadOptions=function(){var p=g._asyncToGenerator(function*(f){const {url:u,customParameters:E,name:w,namespaceUri:J,spatialReference:R,fields:Q,geometryType:M,swapXY:F}=this.layer;if(!u)throw new B("wfs-layer:missing-url","WFSLayer must be created with a url");this.wfsCapabilities||
(this.wfsCapabilities=yield P.getCapabilities(u,{customParameters:E,...f}));f="fields geometryType name namespaceUri spatialReference swapXY".split(" ").some(Z=>null==this.layer[Z])?yield P.getWFSLayerInfo(this.wfsCapabilities,w,J,{spatialReference:R,customParameters:E,signal:null==f?void 0:f.signal}):{...P.prepareWFSLayerFields(Q),geometryType:M,name:w,namespaceUri:J,spatialReference:R,swapXY:F};const aa=C.unwrap(P.findFeatureType(this.wfsCapabilities.readFeatureTypes(),f.name,f.namespaceUri)),ca=
l.featureGeometryTypeKebabDictionary.toJSON(f.geometryType);return{customParameters:E,featureType:aa,fields:f.fields.map(Z=>Z.toJSON()),geometryField:f.geometryField,geometryType:ca,getFeatureUrl:this.wfsCapabilities.operations.GetFeature.url,getFeatureOutputFormat:this.wfsCapabilities.operations.GetFeature.outputFormat,objectIdField:f.objectIdField,spatialReference:f.spatialReference.toJSON(),swapXY:f.swapXY}});return function(f){return p.apply(this,arguments)}}();z._startWorker=function(){var p=
g._asyncToGenerator(function*(f){const [u,E]=yield O.eachAlways([this._createLoadOptions(f),K.open("WFSSourceWorker",{...f,strategy:H("feature-layers-workers")?"dedicated":"local"})]);var w=u.error||E.error||null;const J=E.value||null;if(w)throw J&&J.close(),w;w=u.value;this._connection=E.value;({extent:f}=yield this._connection.invoke("load",w,f));this.sourceJSON={extent:f,fields:w.fields,geometryType:w.geometryType,objectIdField:w.objectIdField,geometryField:w.geometryField,drawingInfo:U.createDrawingInfo(w.geometryType),
name:w.featureType.title,wfsInfo:{name:w.featureType.name,featureUrl:w.getFeatureUrl,maxFeatures:3E3,swapXY:w.swapXY,supportedSpatialReferences:w.featureType.supportedSpatialReferences,version:"2.0.0",wfsNamespace:w.featureType.namespaceUri}}});return function(f){return p.apply(this,arguments)}}();return v}(A.HandleOwnerMixin(S));G.__decorate([L.property()],t.WFSSource.prototype,"capabilities",void 0);G.__decorate([L.property({constructOnly:!0})],t.WFSSource.prototype,"layer",void 0);G.__decorate([L.property()],
t.WFSSource.prototype,"sourceJSON",void 0);G.__decorate([L.property()],t.WFSSource.prototype,"type",void 0);G.__decorate([L.property()],t.WFSSource.prototype,"wfsCapabilities",void 0);t.WFSSource=G.__decorate([I.subclass("esri.layers.graphics.sources.WFSSource")],t.WFSSource);Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/ogc/wfsUtils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../geometry ../../request ../../core/Error ../../core/iteratorUtils ../../core/maybe ../../core/promiseUtils ../../core/urlUtils ../../geometry/projection ../../geometry/support/spatialReferenceUtils ../../geometry/support/typeUtils ../graphics/sources/geojson/geojson ./dateUtils ./xmlUtils ../support/Field ../../geometry/SpatialReference ../../geometry/Extent".split(" "),
function(t,g,G,y,B,A,H,S,C,O,K,L,T,D,I,l,U,P){function a(){a=g._asyncToGenerator(function*(b,d){d=yield y(b,{responseType:"text",query:{SERVICE:"WFS",REQUEST:"GetCapabilities",VERSION:"2.0.0",...null==d?void 0:d.customParameters},signal:null==d?void 0:d.signal});d=h(d.data);C.isHTTPSProtocol(b)&&(C.hasSameOrigin(b,d.operations.DescribeFeatureType.url,!0)&&(d.operations.DescribeFeatureType.url=C.toHTTPS(d.operations.DescribeFeatureType.url)),C.hasSameOrigin(b,d.operations.GetFeature.url,!0)&&(d.operations.GetFeature.url=
C.toHTTPS(d.operations.GetFeature.url)));return d});return a.apply(this,arguments)}function h(b){b=ea(b);ja(b);fa(b);b=b.firstElementChild;const d=A.cache(v(b));return{operations:q(b),get featureTypes(){return Array.from(d())},readFeatureTypes:d}}function q(b){let d=!1;const e={GetCapabilities:{url:""},DescribeFeatureType:{url:""},GetFeature:{url:"",outputFormat:null,supportsPagination:!1}};I.visitXML(b,{OperationsMetadata:{Operation:n=>{switch(n.getAttribute("name")){case "GetCapabilities":return{DCP:{HTTP:{Get:k=>
{e.GetCapabilities.url=k.getAttribute("xlink:href")}}}};case "DescribeFeatureType":return{DCP:{HTTP:{Get:k=>{e.DescribeFeatureType.url=k.getAttribute("xlink:href")}}}};case "GetFeature":return{DCP:{HTTP:{Get:k=>{e.GetFeature.url=k.getAttribute("xlink:href")}}},Parameter:k=>{if("outputFormat"===k.getAttribute("name"))return{AllowedValues:{Value:m=>{m=m.textContent;ba.has(m.toLowerCase())&&(e.GetFeature.outputFormat=m)}}}}}}},Constraint:n=>{switch(n.getAttribute("name")){case "KVPEncoding":return{DefaultValue:k=>
{d="true"===k.textContent.toLowerCase()}};case "ImplementsResultPaging":return{DefaultValue:k=>{e.GetFeature.supportsPagination="true"===k.textContent.toLowerCase()}}}}}});if(!d)throw new B("wfs-layer:kvp-encoding-not-supported","WFS service doesn't support key/value pair (KVP) encoding");if(H.isNone(e.GetFeature.outputFormat))throw new B("wfs-layer:geojson-not-supported","WFS service doesn't support GeoJSON output format");return e}function v(b){return I.iterateXML(b,{FeatureTypeList:{FeatureType:d=>
{const e={typeName:"undefined:undefined",name:"",title:"",description:"",extent:null,namespacePrefix:"",namespaceUri:"",supportedSpatialReferences:[]},n=new Set([4326]),k=m=>{var c,r;m=parseInt(null==(c=m.textContent.match(/(?<wkid>\d+$)/i))?void 0:null==(r=c.groups)?void 0:r.wkid,10);Number.isNaN(m)||n.add(m)};I.visitXML(d,{Name:m=>{const {name:c,prefix:r}=X(m.textContent);e.typeName=`${r}:${c}`;e.name=c;e.namespacePrefix=r;e.namespaceUri=m.lookupNamespaceURI(r)},Abstract:m=>{e.description=m.textContent},
Title:m=>{e.title=m.textContent},WGS84BoundingBox:m=>{e.extent=z(m)},DefaultSRS:k,DefaultCRS:k,OtherSRS:k,OtherCRS:k});e.title||(e.title=e.name);e.supportedSpatialReferences.push(...n);return e}}})}function z(b){let d,e,n,k;for(const m of b.children)switch(m.localName){case "LowerCorner":[d,e]=m.textContent.split(" ").map(c=>Number.parseFloat(c));break;case "UpperCorner":[n,k]=m.textContent.split(" ").map(c=>Number.parseFloat(c))}return{xmin:d,ymin:e,xmax:n,ymax:k,spatialReference:K.WGS84}}function p(b,
d,e){return A.find(b,n=>e?n.name===d&&n.namespaceUri===e:n.typeName===d||n.name===d)}function f(){f=g._asyncToGenerator(function*(b,d,e,n={}){var k;const {featureType:m,extent:c}=yield u(b,d,e,n),{fields:r,geometryType:x,swapXY:N,objectIdField:Y,geometryField:W}=yield w(b,m.typeName,n);return{url:b.operations.GetCapabilities.url,name:m.name,namespaceUri:m.namespaceUri,fields:r,geometryField:W,geometryType:x,objectIdField:Y,spatialReference:null!=(k=n.spatialReference)?k:U.WGS84,extent:c,swapXY:N,
wfsCapabilities:b,customParameters:n.customParameters}});return f.apply(this,arguments)}function u(b,d,e){return E.apply(this,arguments)}function E(){E=g._asyncToGenerator(function*(b,d,e,n={}){const {spatialReference:k=U.WGS84}=n;b=b.readFeatureTypes();e=d?p(b,d,e):b.next().value;if(H.isNone(e)){if(d)throw new B("wfs-layer:feature-type-not-found",`The type '${d}' could not be found in the service`);throw new B("wfs-layer:empty-service","The service is empty");}d=new P({...e.extent,spatialReference:k});
if(!K.equals(k,K.WGS84))try{yield O.initializeProjection(K.WGS84,k,void 0,n),d=O.project(d,K.WGS84)}catch{throw new B("wfs-layer:unsupported-spatial-reference","Projection not supported");}return{extent:d,spatialReference:k,featureType:e}});return E.apply(this,arguments)}function w(b,d){return J.apply(this,arguments)}function J(){J=g._asyncToGenerator(function*(b,d,e={}){const [n,k]=yield S.eachAlways([F(b.operations.DescribeFeatureType.url,d,e),Q(b,d,e)]);if(n.error||k.error)throw new B("wfs-layer:getWFSLayerTypeInfo-error",
`An error occurred while getting info about the feature type '${d}'`,{error:n.error||k.error});const {fields:m,errors:c}=n.value;b=n.value.geometryType||k.value.geometryType;e=k.value.swapXY;if(H.isNone(b))throw new B("wfs-layer:unknown-geometry-type",`The geometry type could not be determined for type '${d}`,{typeName:d,geometryType:b,fields:m,errors:c});return{...R(m),geometryType:b,swapXY:e}});return J.apply(this,arguments)}function R(b){var d;const e=b.find(k=>"geometry"===k.type);let n=b.find(k=>
"oid"===k.type);b=b.filter(k=>"geometry"!==k.type);n||(n=new l({name:"__esri_wfs_id__",type:"oid",alias:"__esri_wfs_id__"}),b.unshift(n));return{geometryField:null!=(d=null==e?void 0:e.name)?d:null,objectIdField:n.name,fields:b}}function Q(b,d){return M.apply(this,arguments)}function M(){M=g._asyncToGenerator(function*(b,d,e={}){var n;let k,m=!1;const [c,r]=yield Promise.all([ha(b.operations.GetFeature.url,d,b.operations.GetFeature.outputFormat,{...e,count:1}),y(b.operations.GetFeature.url,{responseType:"text",
query:ia(d,void 0,{...e,count:1}),signal:null==e?void 0:e.signal})]);if(b="FeatureCollection"===c.type&&(null==(n=c.features[0])?void 0:n.geometry)){k=L.featureGeometryTypeKebabDictionary.fromJSON(T.getGeometryType(b.type));switch(b.type){case "Point":var x=b.coordinates;break;case "LineString":case "MultiPoint":x=b.coordinates[0];break;case "MultiLineString":case "Polygon":x=b.coordinates[0][0];break;case "MultiPolygon":x=b.coordinates[0][0][0]}if(b=/<[^>]*pos[^>]*> *(-?\d+(?:\.\d+)?) (-?\d+(?:\.\d+)?)/.exec(r.data))n=
x[0].toFixed(3),x=x[1].toFixed(3),d=parseFloat(b[1]).toFixed(3),b=parseFloat(b[2]).toFixed(3),n===b&&x===d&&(m=!0)}return{geometryType:k,swapXY:m}});return M.apply(this,arguments)}function F(b,d,e){return aa.apply(this,arguments)}function aa(){aa=g._asyncToGenerator(function*(b,d,e){b=yield y(b,{responseType:"text",query:{SERVICE:"WFS",REQUEST:"DescribeFeatureType",VERSION:"2.0.0",TYPENAME:d,...null==e?void 0:e.customParameters},signal:null==e?void 0:e.signal});return ca(d,b.data)});return aa.apply(this,
arguments)}function ca(b,d){const {name:e}=X(b);d=ea(d);fa(d);const n=A.find(I.iterateXML(d.firstElementChild,{element:k=>({name:k.getAttribute("name"),typeName:X(k.getAttribute("type")).name})}),({name:k})=>k===e);if(H.isSome(n)){const k=A.find(I.iterateXML(d.firstElementChild,{complexType:m=>m}),m=>m.getAttribute("name")===n.typeName);if(H.isSome(k))return Z(k)}throw new B("wfs-layer:feature-type-not-found",`Type '${b}' not found in document`,{document:(new XMLSerializer).serializeToString(d)});
}function Z(b){var d,e;const n=[],k=[];let m;var c=I.iterateXML(b,{complexContent:{extension:{sequence:{element:r=>r}}}});for(const r of c){c=r.getAttribute("name");if(!c)continue;let x,N;r.hasAttribute("type")?x=X(r.getAttribute("type")).name:I.visitXML(r,{simpleType:{restriction:ka=>{x=X(ka.getAttribute("base")).name;return{maxLength:la=>{N=+la.getAttribute("value")}}}}});if(!x)continue;const Y="true"===r.getAttribute("nillable");let W=!1;switch(x.toLowerCase()){case "integer":case "nonpositiveinteger":case "negativeinteger":case "long":case "int":case "short":case "byte":case "nonnegativeinteger":case "unsignedlong":case "unsignedint":case "unsignedshort":case "unsignedbyte":case "positiveinteger":k.push(new l({name:c,
alias:c,type:"integer",nullable:Y}));break;case "float":case "double":case "decimal":k.push(new l({name:c,alias:c,type:"double",nullable:Y}));break;case "boolean":case "string":case "gyearmonth":case "gyear":case "gmonthday":case "gday":case "gmonth":case "anyuri":case "qname":case "notation":case "normalizedstring":case "token":case "language":case "idrefs":case "entities":case "nmtoken":case "nmtokens":case "name":case "ncname":case "id":case "idref":case "entity":case "duration":case "time":k.push(new l({name:c,
alias:c,type:"string",nullable:Y,length:null!=(d=N)?d:255}));break;case "datetime":case "date":k.push(new l({name:c,alias:c,type:"date",nullable:Y,length:null!=(e=N)?e:36}));break;case "pointpropertytype":m="point";W=!0;break;case "multipointpropertytype":m="multipoint";W=!0;break;case "curvepropertytype":case "multicurvepropertytype":case "multilinestringpropertytype":m="polyline";W=!0;break;case "surfacepropertytype":case "multisurfacepropertytype":case "multipolygonpropertytype":m="polygon";W=
!0;break;case "geometrypropertytype":case "multigeometrypropertytype":W=!0;n.push(new B("wfs-layer:unknown-geometry-type",`geometry type '${x}' is not supported`,{type:(new XMLSerializer).serializeToString(b)}));break;default:n.push(new B("wfs-layer:unknown-field-type",`Unknown field type '${x}'`,{type:(new XMLSerializer).serializeToString(b)}))}W&&k.push(new l({name:c,alias:c,type:"geometry",nullable:Y}))}for(const r of k)if("integer"===r.type&&!r.nullable&&ma.has(r.name.toLowerCase())){r.type="oid";
break}return{geometryType:m,fields:k,errors:n}}function ha(b,d,e,n){return V.apply(this,arguments)}function V(){V=g._asyncToGenerator(function*(b,d,e,n){({data:b}=yield y(b,{responseType:"text",query:ia(d,e,n),signal:null==n?void 0:n.signal}));b=b.replace(/": +(-?\d+),(\d+)(,)?/g,'": $1.$2$3');try{var k;if(null!=n&&null!=(k=n.dateFields)&&k.length){const m=new Set(n.dateFields);return JSON.parse(b,(c,r)=>m.has(c)?D.parseDate(r):r)}return JSON.parse(b)}catch(m){throw new B("wfs-layer:malformed-json",
"Error while parsing the\u00a0response",{response:b,error:m});}});return V.apply(this,arguments)}function ia(b,d,e){return{SERVICE:"WFS",REQUEST:"GetFeature",VERSION:"2.0.0",TYPENAMES:b,OUTPUTFORMAT:d,SRSNAME:"EPSG:4326",STARTINDEX:null==e?void 0:e.startIndex,COUNT:null==e?void 0:e.count,...null==e?void 0:e.customParameters}}function da(){da=g._asyncToGenerator(function*(b,d,e){b=yield y(b,{responseType:"text",query:{SERVICE:"WFS",REQUEST:"GetFeature",VERSION:"2.0.0",TYPENAMES:d,RESULTTYPE:"hits",
...null==e?void 0:e.customParameters},signal:null==e?void 0:e.signal});b=ea(b.data);fa(b);b=Number.parseFloat(b.firstElementChild.getAttribute("numberMatched"));return Number.isNaN(b)?0:b});return da.apply(this,arguments)}function ea(b){return(new DOMParser).parseFromString(b.trim(),"text/xml")}function X(b){const [d,e]=b.split(":");return{prefix:e?d:"",name:null!=e?e:d}}function ja(b){if((b=b.firstElementChild.getAttribute("version"))&&"2.0.0"!==b)throw new B("wfs-layer:unsupported-wfs-version",
`Unsupported WFS version ${b}. Supported version: ${"2.0.0"}`);}function fa(b){let d,e;I.visitXML(b.firstElementChild,{Exception:n=>{d=n.getAttribute("exceptionCode");return{ExceptionText:k=>{e=k.textContent}}}});if(d)throw new B(`wfs-layer:${d}`,e);}const ba=new Set(["json","application/json","geojson","application/json; subtype\x3dgeojson"]),ma=new Set(["objectid","fid"]);t.WFS_OID_FIELD_NAME="__esri_wfs_id__";t.describeFeatureType=F;t.findFeatureType=p;t.getCapabilities=function(b,d){return a.apply(this,
arguments)};t.getFeature=ha;t.getFeatureCount=function(b,d,e){return da.apply(this,arguments)};t.getFeatureTypeInfo=u;t.getWFSLayerInfo=function(b,d,e){return f.apply(this,arguments)};t.parseDescribeFeatureTypeResponse=ca;t.parseGetCapabilitiesResponse=h;t.prepareWFSLayerFields=R;Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/sources/geojson/geojson":function(){define(["exports","../../../../core/Error","../../OptimizedFeature","../../OptimizedGeometry",
"../../../support/fieldUtils"],function(t,g,G,y,B){function*A(a){switch(a.type){case "Feature":yield a;break;case "FeatureCollection":for(const h of a.features)h&&(yield h)}}function*H(a){if(!a)return null;switch(a.type){case "Point":yield a.coordinates;break;case "LineString":case "MultiPoint":yield*a.coordinates;break;case "MultiLineString":case "Polygon":for(const h of a.coordinates)yield*h;break;case "MultiPolygon":for(const h of a.coordinates)for(const q of h)yield*q}}function*S(a,h={}){const {geometryType:q,
objectIdField:v}=h;for(const p of a){var z;const {geometry:f,properties:u,id:E}=p;if(f&&P[f.type]!==q)continue;a=u||{};let w=null!=(z=a[v])?z:null;v&&null!=E&&!a[v]&&(a[v]=w=E);yield new G.OptimizedFeature(f?L(new y,f,h):null,a,null,w)}}function C(a){for(const h of a)if(2<h.length)return!0;return!1}function O(a){let h=0;for(let q=0;q<a.length;q++){const v=a[q],z=a[(q+1)%a.length];h+=v[0]*z[1]-z[0]*v[1]}return 0>=h}function K(a){const h=a[0],q=a[a.length-1];h[0]===q[0]&&h[1]===q[1]&&h[2]===q[2]||a.push(h);
return a}function L(a,h,q){switch(h.type){case "LineString":return I(a,h.coordinates,q),a;case "MultiLineString":for(const z of h.coordinates)I(a,z,q);return a;case "MultiPoint":return I(a,h.coordinates,q),a;case "MultiPolygon":for(var v of h.coordinates)for(T(a,v[0],q),h=1;h<v.length;h++)D(a,v[h],q);return a;case "Point":return U(a,h.coordinates,q),a;case "Polygon":v=h.coordinates;T(a,v[0],q);for(h=1;h<v.length;h++)D(a,v[h],q);return a}}function T(a,h,q){h=K(h);O(h)?I(a,h,q):l(a,h,q)}function D(a,
h,q){h=K(h);O(h)?l(a,h,q):I(a,h,q)}function I(a,h,q){for(const v of h)U(a,v,q);a.lengths.push(h.length)}function l(a,h,q){for(let v=h.length-1;0<=v;v--)U(a,h[v],q);a.lengths.push(h.length)}function U(a,h,q){const [v,z,p]=h;a.coords.push(v,z);q.hasZ&&a.coords.push(p||0)}const P={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};t.createOptimizedFeatures=
function(a,h){return Array.from(S(A(a),h))};t.getGeometryType=function(a){return P[a]};t.inferLayerProperties=function(a,h={}){const q=[];var v=new Set;const z=new Set;var p=!1;let f=null,u=!1,E=void 0;({geometryType:h=null}=h);var w=!1;for(const J of A(a)){const {geometry:R,properties:Q,id:M}=J;if(R&&(h||(h=P[R.type]),P[R.type]!==h))continue;p||(p=H(R),p=C(p));!u&&(u=null!=M)&&(E=typeof M,f=Object.keys(Q).filter(F=>Q[F]===M));u&&null!=M&&(1<f.length?f=f.filter(F=>Q[F]===M):1===f.length&&(f=Q[f[0]]===
M?f:[]));if(!w&&Q){a=!0;for(const F in Q)if(!v.has(F))if(w=Q[F],null==w)a=!1,z.add(F);else{a:switch(typeof w){case "string":w="esriFieldTypeString";break a;case "number":w="esriFieldTypeDouble";break a;default:w="unknown"}"unknown"===w?z.add(F):(z.delete(F),v.add(F),q.push({name:F,alias:F,type:w}))}w=a}}if(v=f&&1===f.length&&f[0]||null)for(const J of q)if(J.name===v&&B.isNumericField(J)){J.type="esriFieldTypeOID";break}return{fields:q,geometryType:h,hasZ:p,objectIdFieldName:v,objectIdFieldType:E,
unknownFields:Array.from(z)}};t.validateGeoJSON=function(a){if(!a)throw new g("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==a.type&&"FeatureCollection"!==a.type)throw new g("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:a});({crs:a}=a);if(a){var h="string"===typeof a?a:"name"===a.type?a.properties.name:"EPSG"===a.type?a.properties.code:null,q=/.*(CRS84H?|4326)$/i;if(!h||!q.test(h))throw new g("geojson-layer:unsupported-crs","unsupported GeoJSON 'crs' member",
{crs:a});}};Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/ogc/dateUtils":function(){define(["exports"],function(t){function g(y){y=(new Date(y)).getTime();return Number.isNaN(y)?null:y}const G=/^(?:(?<year>-?\d{4,})-(?<month>\d{2})-(?<day>\d{2}))(?:T(?<hours>\d{2}):(?<minutes>\d{2}):(?<seconds>\d{2})(?:\.(?<ms>\d+))?)?(?:(?<isUTC>Z)|(?:(?<offsetSign>\+|-)(?<offsetHours>\d{2}):(?<offsetMinutes>\d{2})))?$/;t.parseDate=function(y){var B;var A,
H,S,C=G.exec(y);if(C){C=C.groups;var O=+C.year,K=+C.month-1,L=+C.day,T=+(null!=(A=C.hours)?A:0);A=+(null!=(H=C.minutes)?H:0);H=+(null!=(S=C.seconds)?S:0);if(23<T||59<A||59<H)var D=null;else D=(S=null!=(D=C.ms)?D:"0")?+S.padEnd(3,"0").substring(0,3):0,D=C.isUTC?Date.UTC(O,K,L,T,A,H,D):C.offsetSign?6E4*("+"===C.offsetSign?-1:1)*(60*+C.offsetHours+ +C.offsetMinutes)+Date.UTC(O,K,L,T,A,H,D):(new Date(O,K,L,T,A,H,D)).getTime(),D=Number.isNaN(D)?null:D}else D=null;return null!=(B=D)?B:g(y)};t.parseJSDate=
g;Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/ogc/xmlUtils":function(){define(["exports"],function(t){function g(y,B){for(const A of y.children)A.localName in B&&(y=B[A.localName],"function"===typeof y?(y=y(A))&&g(A,y):g(A,y))}function*G(y,B){for(const A of y.children)A.localName in B&&(y=B[A.localName],"function"===typeof y?yield y(A):yield*G(A,y))}t.iterateXML=G;t.visitXML=g;Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"*noref":1}});
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../geometry ../PopupTemplate ../renderers/ClassBreaksRenderer ../renderers/DictionaryRenderer ../renderers/DotDensityRenderer ../renderers/HeatmapRenderer ../renderers/PieChartRenderer ../renderers/Renderer ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../renderers/support/jsonUtils ../renderers/support/types ../core/maybe ../core/MultiOriginJSONSupport ../core/object ../core/urlUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ../geometry/support/typeUtils ./Layer ./graphics/sources/WFSSource ./mixins/BlendLayer ./mixins/CustomParametersMixin ./mixins/FeatureEffectLayer ./mixins/OperationalLayer ./mixins/OrderedLayer ./mixins/PortalLayer ./mixins/RefreshableLayer ./mixins/ScaleRangeLayer ./mixins/TemporalLayer ./ogc/wfsUtils ./support/commonProperties ./support/featureReductionUtils ./support/Field ./support/fieldProperties ./support/fieldUtils ./support/LabelClass ./support/labelingInfo ../rest/support/Query ../support/popupUtils ../geometry/Extent ../geometry/SpatialReference".split(" "),function(t,
g,G,y,B,A,H,S,C,O,K,L,T,D,I,l,U,P,a,h,q,v,z,p,f,u,E,w,J,R,Q,M,F,aa,ca,Z,ha,V,ia,da,ea,X,ja,fa,ba,ma,b,d){var e;G=ea.defineFieldProperties();l=e=function(n){function k(c){c=n.call(this,c)||this;c.capabilities=null;c.copyright=null;c.customParameters=null;c.definitionExpression=null;c.displayField=null;c.elevationInfo=null;c.featureReduction=null;c.featureUrl=void 0;c.fields=null;c.fieldsIndex=null;c.fullExtent=null;c.geometryType=null;c.labelsVisible=!0;c.labelingInfo=null;c.legendEnabled=!0;c.objectIdField=
null;c.operationalLayerType="WFS";c.maxFeatures=3E3;c.mode=0;c.name=null;c.namespaceUri=null;c.outFields=null;c.popupEnabled=!0;c.popupTemplate=null;c.screenSizePerspectiveEnabled=!0;c.source=new E.WFSSource({layer:t._assertThisInitialized(c)});c.spatialReference=d.WGS84;c.spatialReferences=[4326];c.swapXY=void 0;c.title="WFS";c.type="wfs";c.url=null;c.version=void 0;return c}t._inheritsLoose(k,n);k.fromWFSLayerInfo=function(c){const {customParameters:r,fields:x,geometryField:N,geometryType:Y,name:W,
namespaceUri:ka,objectIdField:la,spatialReference:na,swapXY:oa,url:pa,wfsCapabilities:qa}=c;return new e({customParameters:r,fields:x,geometryField:N,geometryType:Y,name:W,namespaceUri:ka,objectIdField:la,spatialReference:na,swapXY:oa,url:pa,wfsCapabilities:qa})};var m=k.prototype;m.destroy=function(){var c;null==(c=this.source)?void 0:c.destroy()};m.load=function(c){this.addResolvingPromise(this.loadFromPortal({supportedTypes:["WFS"]},c).then(()=>this.source.load(c)).then(()=>{this.read(this.source.sourceJSON,
{origin:"service",url:this.parsedUrl});this.revert("objectIdField fields timeInfo spatialReference name namespaceUri".split(" "),"service");X.fixRendererFields(this.renderer,this.fieldsIndex);X.fixTimeInfoFields(this.timeInfo,this.fieldsIndex)}));return Promise.resolve(this)};m.writeFields=function(c,r,x){c=c.filter(N=>N.name!==ha.WFS_OID_FIELD_NAME);this.geometryField&&c.unshift(new da({name:this.geometryField,alias:this.geometryField,type:"geometry"}));U.setDeepValue(x,c.map(N=>N.toJSON()),r)};
m.createPopupTemplate=function(c){return ma.createPopupTemplate(this,c)};m.createQuery=function(){const c=new ba;c.returnGeometry=!0;c.outFields=["*"];c.where=this.definitionExpression||"1\x3d1";const {timeOffset:r,timeExtent:x}=this;c.timeExtent=null!=r&&null!=x?x.offset(-r.value,r.unit):x||null;return c};m.getFieldDomain=function(c,r){var x;return null==(x=this.getField(c))?void 0:x.domain};m.getField=function(c){return this.fieldsIndex.get(c)};m.queryFeatures=function(c,r){return this.load().then(()=>
this.source.queryFeatures(ba.from(c)||this.createQuery(),r)).then(x=>{if(null!=x&&x.features)for(const N of x.features)N.layer=N.sourceLayer=this;return x})};m.queryObjectIds=function(c,r){return this.load().then(()=>this.source.queryObjectIds(ba.from(c)||this.createQuery(),r))};m.queryFeatureCount=function(c,r){return this.load().then(()=>this.source.queryFeatureCount(ba.from(c)||this.createQuery(),r))};m.queryExtent=function(c,r){return this.load().then(()=>this.source.queryExtent(ba.from(c)||this.createQuery(),
r))};m.hasDataChanged=function(){var c=t._asyncToGenerator(function*(){try{const {dataChanged:r,updates:x}=yield this.source.refresh(this.customParameters);I.isSome(x)&&this.read(x,{origin:"service",url:this.parsedUrl,ignoreDefaults:!0});return r}catch{}return!1});return function(){return c.apply(this,arguments)}}();t._createClass(k,[{key:"createQueryVersion",get:function(){this.commitProperty("definitionExpression");this.commitProperty("timeExtent");this.commitProperty("timeOffset");this.commitProperty("geometryType");
this.commitProperty("capabilities");return(this._get("createQueryVersion")||0)+1}},{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"parsedUrl",get:function(){return this.url?P.urlToObject(this.url):null}},{key:"renderer",set:function(c){X.fixRendererFields(c,this.fieldsIndex);this._set("renderer",c)}}]);return k}(M.OrderedLayer(J.CustomParametersMixin(R.FeatureEffectLayer(w.BlendLayer(Z.TemporalLayer(aa.RefreshableLayer(ca.ScaleRangeLayer(Q.OperationalLayer(F.PortalLayer(l.MultiOriginJSONMixin(u)))))))))));
g.__decorate([a.property({readOnly:!0,aliasOf:"source.capabilities"})],l.prototype,"capabilities",void 0);g.__decorate([a.property({type:String})],l.prototype,"copyright",void 0);g.__decorate([a.property({readOnly:!0})],l.prototype,"createQueryVersion",null);g.__decorate([a.property({json:{name:"wfsInfo.customParameters",write:{ignoreOrigin:!0}}})],l.prototype,"customParameters",void 0);g.__decorate([a.property({readOnly:!0})],l.prototype,"defaultPopupTemplate",null);g.__decorate([a.property({type:String,
json:{name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],l.prototype,"definitionExpression",void 0);g.__decorate([a.property({type:String})],l.prototype,"displayField",void 0);g.__decorate([a.property(V.elevationInfo)],l.prototype,"elevationInfo",void 0);g.__decorate([a.property(ia.featureReductionProperty)],l.prototype,"featureReduction",void 0);g.__decorate([a.property({type:String,readOnly:!0,json:{name:"wfsInfo.featureUrl",write:{ignoreOrigin:!0,isRequired:!0}}})],
l.prototype,"featureUrl",void 0);g.__decorate([a.property({type:[da],json:{name:"layerDefinition.fields",write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"fields"}}}})],l.prototype,"fields",void 0);g.__decorate([p.writer("fields")],l.prototype,"writeFields",null);g.__decorate([a.property(G.fieldsIndex)],l.prototype,"fieldsIndex",void 0);g.__decorate([a.property({type:b,json:{name:"extent"}})],l.prototype,"fullExtent",void 0);g.__decorate([a.property()],l.prototype,"geometryField",void 0);
g.__decorate([a.property({type:String,json:{read:{source:"layerDefinition.geometryType",reader:f.featureGeometryTypeKebabDictionary.read},write:{target:"layerDefinition.geometryType",writer:f.featureGeometryTypeKebabDictionary.write,ignoreOrigin:!0},origins:{service:{read:f.featureGeometryTypeKebabDictionary.read}}}})],l.prototype,"geometryType",void 0);g.__decorate([a.property({type:String})],l.prototype,"id",void 0);g.__decorate([a.property(V.labelsVisible)],l.prototype,"labelsVisible",void 0);
g.__decorate([a.property({type:[ja],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:fa.reader},write:!0}})],l.prototype,"labelingInfo",void 0);g.__decorate([a.property(V.legendEnabled)],l.prototype,"legendEnabled",void 0);g.__decorate([a.property({type:["show","hide"]})],l.prototype,"listMode",void 0);g.__decorate([a.property({type:String})],l.prototype,"objectIdField",void 0);g.__decorate([a.property({type:["WFS"]})],l.prototype,"operationalLayerType",void 0);g.__decorate([a.property({type:v.Integer,
json:{name:"wfsInfo.maxFeatures",write:{ignoreOrigin:!0,isRequired:!0}}})],l.prototype,"maxFeatures",void 0);g.__decorate([a.property({type:[0],readOnly:!0,json:{origins:{"web-map":{write:{ignoreOrigin:!0,isRequired:!0}}}}})],l.prototype,"mode",void 0);g.__decorate([a.property({type:String,json:{name:"wfsInfo.name",write:{ignoreOrigin:!0,isRequired:!0}}})],l.prototype,"name",void 0);g.__decorate([a.property({type:String,json:{name:"wfsInfo.wfsNamespace",write:{ignoreOrigin:!0,isRequired:!0}}})],l.prototype,
"namespaceUri",void 0);g.__decorate([a.property(V.opacityDrawingInfo)],l.prototype,"opacity",void 0);g.__decorate([a.property(G.outFields)],l.prototype,"outFields",void 0);g.__decorate([a.property({readOnly:!0})],l.prototype,"parsedUrl",null);g.__decorate([a.property(V.popupEnabled)],l.prototype,"popupEnabled",void 0);g.__decorate([a.property({type:y,json:{name:"popupInfo",write:!0}})],l.prototype,"popupTemplate",void 0);g.__decorate([a.property({types:D.rendererTypes,json:{origins:{service:{name:"drawingInfo.renderer"},
"web-scene":{types:D.webSceneRendererTypes,name:"layerDefinition.drawingInfo.renderer",write:!0}},name:"layerDefinition.drawingInfo.renderer",write:{ignoreOrigin:!0}}})],l.prototype,"renderer",null);g.__decorate([a.property(V.screenSizePerspectiveEnabled)],l.prototype,"screenSizePerspectiveEnabled",void 0);g.__decorate([a.property({readOnly:!0})],l.prototype,"source",void 0);g.__decorate([a.property({type:d,json:{name:"layerDefinition.spatialReference",write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"extent.spatialReference"}}}})],
l.prototype,"spatialReference",void 0);g.__decorate([a.property({readOnly:!0,type:[v.Integer],json:{name:"wfsInfo.supportedSpatialReferences",write:{ignoreOrigin:!0,isRequired:!0}}})],l.prototype,"spatialReferences",void 0);g.__decorate([a.property({type:Boolean,value:!1,json:{name:"wfsInfo.swapXY",write:{ignoreOrigin:!0,isRequired:!0}}})],l.prototype,"swapXY",void 0);g.__decorate([a.property({json:{write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"name"}}}})],l.prototype,"title",void 0);
g.__decorate([a.property({json:{read:!1},readOnly:!0})],l.prototype,"type",void 0);g.__decorate([a.property(V.url)],l.prototype,"url",void 0);g.__decorate([a.property({type:String,readOnly:!0,json:{name:"wfsInfo.version",write:{ignoreOrigin:!0,isRequired:!0}}})],l.prototype,"version",void 0);g.__decorate([a.property({aliasOf:"source.wfsCapabilities"})],l.prototype,"wfsCapabilities",void 0);return l=e=g.__decorate([z.subclass("esri.layers.WFSLayer")],l)});