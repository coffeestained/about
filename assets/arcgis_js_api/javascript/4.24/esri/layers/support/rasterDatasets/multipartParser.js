// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
define(["exports"],function(p){function r(b,d,a=0){var e="--"+d.boundary,c=[];for(var f=0;f<e.length;f++)c.push(e.charCodeAt(f));e=[];f="\n--"+d.boundary+"--";for(var g=0;g<f.length;g++)e.push(f.charCodeAt(g));g=[10];const h=[13,10];f=[];const n=c.length;b=new Uint8Array(b,a);const m=Math.min(5E4,b.length-n);let k=a=0;for(let l=0;l<m;l++){for(k=0;k<n&&b[l+k]===c[k];k++);k===n&&(a&&f.push(q(b.subarray(a,l),d)),l+=n-1,b[l+1]===g[0]?l+=1:b[l+1]===h[0]&&b[l+2]===h[1]&&(l+=2),a=l+1)}c=e.length;for(g=b.length-
c-10;g<b.length-c;g++){for(k=0;k<c&&b[g+k]===e[k];k++);if(k===c){f.push(q(b.subarray(a,g),d));break}}return f}function q(b,d){var a=String.fromCharCode.apply(null,b.subarray(0,Math.min(300,b.length))).split("\n"),e=Math.min(a.length,7);const c={contentDisposition:"inline"};let f=0;for(let h=0;h<e;h++){var g;if(4>a[h].length)f=f+a[h].length+1;else if("content"===a[h].slice(0,7).toLowerCase()){f=f+a[h].length+1;if(!a[h].includes(":"))continue;const n=a[h].substring(0,a[h].indexOf(":")).trim(),m=a[h].substring(a[h].indexOf(":")+
1).trim();switch(n.toLowerCase()){case "content-type":c.contentType=m;break;case "content-description":c.contentDescription=m;break;case "content-transfer-encoding":c.contentTransferEncoding=m;break;case "content-id":c.contentID=m;break;case "content-disposition":c.contentDisposition=m;break;case "content-location":c.contentLocation=m}}else if(c.contentDisposition.toLowerCase().includes("inline")&&4<=a[h].length&&-1<(null==(g=c.contentType)?void 0:g.toLowerCase().indexOf("image"))){a=!0;d=b.subarray(f,
b.length);if(0<c.contentType.toLowerCase().indexOf("tif")){if("base64"===c.contentTransferEncoding){a="";for(e=0;e<d.length;e+=65535)g=d.subarray(e,e+65535>d.length-1?d.length-1:e+65535),a+=String.fromCharCode.apply(null,g);a=atob(a);d=new Uint8Array(a.length);for(e=0;e<d.length;e++)d[e]=a.charCodeAt(e)}a=73===d[0]&&73===d[1]||77===d[0]&&77===d[1]}a&&(a=d.buffer,"base64"!==c.contentTransferEncoding&&(a=new ArrayBuffer(b.length-f),d=new Uint8Array(a),d.set(b.subarray(f,b.length))),c.contentData=a);
break}else if((""===d.start||c.contentID===d.start)&&c.contentType){if(c.contentType.includes("text")||c.contentType.includes("xml")){c.contentData=String.fromCharCode.apply(null,b.subarray(f,b.length));break}c.contentData=b.subarray(f,b.length)}}return c}p.getBoundary=function(b){b=new Uint8Array(b,0,2E3);var d=String.fromCharCode.apply(null,b);b=d.indexOf('boundary\x3d"');d=-1!==b?d.slice(b+10,d.indexOf('"',b+10)):"";return{boundary:d,offset:-1!==b?b+12+d.length:0}};p.parse=function(b){var d,a;
var e=null==(d=b.getHeader("Content-Type"))?void 0:d.split(";");if((null!=(a=null==e?void 0:e[0].trim())?a:"").startsWith("multipart/")){d={boundary:"",start:"",type:""};for(a=1;a<e.length;a++){var c=e[a].indexOf("\x3d");if(0<c){const f=e[a].slice(0,c).trim();c=e[a].slice(c+1).trim();d[f]=c.startsWith('"')?c.slice(1,c.length-1):c}}e=d}else e=null;return e?{isMultipart:!0,data:e.boundary?r(b.data,e,0):null}:{isMultipart:!1,data:null}};Object.defineProperties(p,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});