// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
define("require exports ../chunks/_rollupPluginBabelHelpers ../geometry ../core/maybe ../geometry/SpatialReference".split(" "),function(A,l,x,t,B,C){function y(){u||(u=x._asyncToGenerator(function*(){const c=yield new Promise((b,a)=>A(["./arcadeUtils"],b,a));return{arcade:c.arcade,arcadeUtils:c,Dictionary:c.Dictionary,Feature:c.arcadeFeature}})());return u}let u;t=(c,b,a)=>n.create(c,b,a,null,["$feature","$view"]);let n=function(){function c(a,g,e,p,m,f,h,d){this.script=a;this.evaluate=m;this.fields=
Array.isArray(h)?h:h.fields;this._syntaxTree=p;this._arcade=g;this._arcadeDictionary=e;this._arcadeFeature=f;this._spatialReference=d;this._referencesGeometry=g.scriptTouchesGeometry(this._syntaxTree);this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale")}c.create=function(){var a=x._asyncToGenerator(function*(g,e,p,m,f,h){const {arcade:d,Feature:D,Dictionary:v}=yield y(),w=C.fromJSON(e);e=d.parseScript(g,h);f=f.reduce((k,E)=>({...k,[E]:null}),{});let q=null;B.isSome(m)&&(q=
new v(m),q.immutable=!0,f.$config=null);m=d.scriptUsesGeometryEngine(e)&&d.enableGeometrySupport();h=d.scriptUsesFeatureSet(e)&&d.enableFeatureSetSupport();const z=d.scriptIsAsync(e)&&d.enableAsyncSupport();f={vars:f,spatialReference:w,useAsync:!!z};const r=new v;r.immutable=!1;r.setField("scale",0);const F=d.compileScript(e,f);yield Promise.all([m,h,z]);return new c(g,d,v,e,k=>{"$view"in k&&k.$view&&(r.setField("scale",k.$view.scale),k.$view=r);q&&(k.$config=q);return F({vars:k,spatialReference:w})},
new D,p,w)});return function(g,e,p,m,f,h){return a.apply(this,arguments)}}();var b=c.prototype;b.repurposeFeature=function(a){a.geometry&&!a.geometry.spatialReference&&(a.geometry.spatialReference=this._spatialReference);this._arcadeFeature.repurposeFromGraphicLikeObject(a.geometry,a.attributes,{fields:this.fields});return this._arcadeFeature};b.createDictionary=function(){return new this._arcadeDictionary};b.referencesMember=function(a){return this._arcade.referencesMember(this._syntaxTree,a)};b.referencesFunction=
function(a){return this._arcade.referencesFunction(this._syntaxTree,a)};b.referencesGeometry=function(){return this._referencesGeometry};b.referencesScale=function(){return this._referencesScale};b.extractFieldLiterals=function(){return this._arcade.extractExpectedFieldLiterals(this._syntaxTree)};return c}();l.ArcadeExpression=n;l.createDictionaryExpression=(c,b,a,g)=>n.create(c,b,a,g,["$feature","$view"]);l.createLabelExpression=(c,b,a)=>n.create(c,b,a,null,["$feature"]);l.createRendererExpression=
t;l.createVVExpression=t;l.loadArcade=y;Object.defineProperties(l,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});