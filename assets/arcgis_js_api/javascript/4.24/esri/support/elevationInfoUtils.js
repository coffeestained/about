// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
define(["exports","../core/maybe","../symbols/support/unitConversionUtils"],function(h,d,u){function n(a,b){return d.isNone(b)||!b.mode?a?"absolute-height":"on-the-ground":b.mode}function l(a,b){return n(d.isSome(a)?a.hasZ:!1,b)}function p(a){const b=m(a);return l(a.geometry,b)}function m(a){return a.layer&&"elevationInfo"in a.layer?a.layer.elevationInfo:null}function q(a,b,c,e,f,k,g=null){if(!d.isNone(k)){var r=d.isSome(g)?g.mode:"absolute-height";if("on-the-ground"===r)return 0;({absoluteZ:k}=t(b,
c,e,f,a,k));a:{g=d.isSome(g)&&d.isSome(g.offset)?g.offset:0;switch(r){case "absolute-height":a=k-g;break a;case "relative-to-ground":a=k-(d.unwrapOr(a.elevationProvider.getElevation(b,c,e,f,"ground"),0)+g);break a;case "relative-to-scene":a=k-(d.unwrapOr(a.elevationProvider.getElevation(b,c,e,f,"scene"),0)+g);break a}a=void 0}return a}}function t(a,b,c,e,f,k){const g=d.isSome(k.offset)?k.offset:0;switch(k.mode){case "absolute-height":return{absoluteZ:c+g,elevation:0};case "on-the-ground":return c=
d.unwrapOr(f.elevationProvider.getElevation(a,b,0,e,"ground"),0),{absoluteZ:c,elevation:c};case "relative-to-ground":return a=d.unwrapOr(f.elevationProvider.getElevation(a,b,c,e,"ground"),0),{absoluteZ:c+a+g,elevation:a};case "relative-to-scene":return a=d.unwrapOr(f.elevationProvider.getElevation(a,b,c,e,"scene"),0),{absoluteZ:c+a+g,elevation:a}}}h.absoluteHeightElevationInfo={mode:"absolute-height",offset:0};h.getConvertedElevation=function(a,b,c,e=null){return q(a,b.x,b.y,b.hasZ?b.z:0,b.spatialReference,
c,e)};h.getConvertedElevationFromVector=function(a,b,c,e,f=null){return q(a,b[0],b[1],2<b.length?b[2]:0,c,e,f)};h.getEffectiveElevationMode=n;h.getGeometryEffectiveElevationMode=l;h.getGraphicEffectiveElevationInfo=function(a){var b=m(a);a=l(a.geometry,b);b=d.isSome(b)&&"on-the-ground"!==a?d.unwrapOr(b.offset,0)*u.getMetersPerUnit(d.unwrapOr(b.unit,"meters")):0;return{mode:a,offset:b}};h.getGraphicEffectiveElevationMode=p;h.getZForElevationMode=function(a,b,c){if(!d.isNone(c)&&c.mode){var e=a.hasZ?
a.z:0,f=d.isSome(c.offset)?c.offset:0;switch(c.mode){case "absolute-height":return e-f;case "on-the-ground":return 0;case "relative-to-ground":return a=d.unwrapOr(b.elevationProvider.getElevation(a.x,a.y,a.z,a.spatialReference,"ground"),0)+f,e-a;case "relative-to-scene":return a=d.unwrapOr(b.elevationProvider.getElevation(a.x,a.y,a.z,a.spatialReference,"scene"),0)+f,e-a}}};h.hasGraphicFeatureExpressionInfo=function(a){if("on-the-ground"===p(a))return!1;a=m(a);a=d.isSome(a)&&a.featureExpressionInfo?
a.featureExpressionInfo.expression:null;return!(!a||"0"===a)};h.zValueInAbsoluteHeightMode=t;Object.defineProperties(h,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});