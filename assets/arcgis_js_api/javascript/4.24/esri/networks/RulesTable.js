// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../request ../core/JSONSupport ../core/Loadable ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ./support/typeUtils".split(" "),function(x,q,M,m,N,t,P,Q,R,O,p){m=function(z){function y(d){d=z.call(this,d)||this;d.request=M;return d}x._inheritsLoose(y,z);var u=y.prototype;u.initialize=function(){};u.load=function(){var d=x._asyncToGenerator(function*(e){e=
this.layer.load(e).then(()=>this._initializeRulesTable());this.addResolvingPromise(e);return this});return function(e){return d.apply(this,arguments)}}();u.getFeatureSQL=function(d,e){var a=d.layerId.toString(),f=d.fieldsIndex.normalizeFieldName("assetGroup");d=d.fieldsIndex.normalizeFieldName("assetType");f=e.attributes[f];e=e.attributes[d];if(a=this.rulesHash[a])if(a=a.assetGroupHash[f])return(a=a.assetTypeHash[e])?a:null;return null};u._initializeRulesTable=function(){var d=x._asyncToGenerator(function*(){const e=
{};let a;var f=a||(a={});f[f.from=0]="from";f[f.to=1]="to";f[f.via=2]="via";f=[{networkSourceId:"fromNetworkSource",assetGroupId:"fromAssetGroup",assetTypeId:"fromAssetType"},{networkSourceId:"toNetworkSource",assetGroupId:"toAssetGroup",assetTypeId:"toAssetType"},{networkSourceId:"viaNetworkSource",assetGroupId:"viaAssetGroup",assetTypeId:"viaAssetType"}];for(const h of this.rules)if(h.ruleType===p.RuleType.RTJunctionJunctionConnectivity||h.ruleType===p.RuleType.RTJunctionEdgeConnectivity||h.ruleType===
p.RuleType.RTEdgeJunctionEdgeConnectivity){var b=[[a.from,a.to],[a.to,a.from]];h.ruleType===p.RuleType.RTEdgeJunctionEdgeConnectivity&&(b=[[a.from,a.via],[a.via,a.from],[a.to,a.via],[a.via,a.to]]);for(const A of b){var B,C,D,E,F,G,H;b=A.shift();var k=A.shift(),l=!1;switch(h.ruleType){case p.RuleType.RTEdgeJunctionEdgeConnectivity:l=b===a.from||b===a.to;break;case p.RuleType.RTJunctionEdgeConnectivity:l=b===a.to}var g=f[b];b=h[g.networkSourceId].layerId.toString();const r=null==(B=h[g.assetGroupId])?
void 0:null==(C=B.assetGroupCode)?void 0:C.toString();g=h[g.assetTypeId];g=null==g?void 0:null==(D=g.assetTypeCode)?void 0:D.toString();var n=f[k];k=h[n.networkSourceId].layerId.toString();const I=null==(E=h[n.assetGroupId])?void 0:null==(F=E.assetGroupCode)?void 0:F.toString();n=h[n.assetTypeId];const J=null==n?void 0:null==(G=n.assetTypeCode)?void 0:G.toString(),v=e[b]?e[b]:{assetGroupHash:{}};if(!(r&&g&&I&&J))continue;const w=v.assetGroupHash[r]?v.assetGroupHash[r]:{assetTypeHash:{}},c=w.assetTypeHash[g]?
w.assetTypeHash[g]:{};c[k]=c[k]?c[k]:{};if(l&&(c[b]=c[b]?c[b]:{},l=`(assetgroup = ${r} AND assettype = ${g})`,c[b].anyVertex=c[b].anyVertex?`${c[b].anyVertex}`:`${l}`,"esriNECPEndVertex"===n.connectivityPolicy)){var K;c[b].endVertex=null!=(K=c[b])&&K.endVertex?`${c[b].endVertex}`:`${l}`}l=`(assetgroup = ${I} AND assettype = ${J})`;c[k].anyVertex=null!=(H=c[k])&&H.anyVertex?`${c[k].anyVertex} OR ${l}`:`${l}`;if("esriNECPEndVertex"===n.connectivityPolicy){var L;c[k].endVertex=null!=(L=c[k])&&L.endVertex?
`${c[k].endVertex} OR ${l}`:`${l}`}w.assetTypeHash[g]=c;v.assetGroupHash[r]=w;e[b]=v}}this.rulesHash=e});return function(){return d.apply(this,arguments)}}();return y}(m.JSONSupportMixin(N));q.__decorate([t.property({constructOnly:!0})],m.prototype,"layer",void 0);q.__decorate([t.property({constructOnly:!0})],m.prototype,"rules",void 0);q.__decorate([t.property()],m.prototype,"rulesHash",void 0);q.__decorate([t.property({constructOnly:!0})],m.prototype,"request",void 0);return m=q.__decorate([O.subclass("esri.networks.RulesTable")],
m)});