// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
define("exports ../chunks/_rollupPluginBabelHelpers ./ArcadePortal ./Attachment ./Dictionary ./Feature ./FunctionWrapper ./ImmutablePathArray ./ImmutablePointArray ../chunks/languageUtils ./treeAnalysis ../chunks/array ./functions/date ./functions/geomasync ./functions/geometry ./functions/maths ./functions/stats ./functions/string ../geometry/Extent ../geometry/Geometry ../geometry/Multipoint ../geometry/Point ../geometry/Polygon ../geometry/Polyline ../geometry/SpatialReference".split(" "),function(u,
m,Ja,Ka,v,xa,C,ya,La,e,q,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,za,Ua,Va,Wa,Xa,Ya){function F(a,b){return G.apply(this,arguments)}function G(){G=m._asyncToGenerator(function*(a,b){const c=[];for(let d=0;d<b.arguments.length;d++)c.push(yield h(a,b.arguments[d]));return c});return G.apply(this,arguments)}function w(a,b,c){return H.apply(this,arguments)}function H(){H=m._asyncToGenerator(function*(a,b,c){if(!0===b.preparsed)return c(a,null,b.arguments);const d=yield F(a,b);return c(a,b,d)});return H.apply(this,arguments)}
function A(a,b,c){return I.apply(this,arguments)}function I(){I=m._asyncToGenerator(function*(a,b,c){if(!0===b.preparsed)return c(a,null,b.arguments);const d=yield F(a,b);return c(a,b,d)});return I.apply(this,arguments)}function h(a,b,c){return J.apply(this,arguments)}function J(){J=m._asyncToGenerator(function*(a,b,c){if(b.breakpoint&&!0!==c)return yield b.breakpoint(),h(a,b,!0);switch(b.type){case "VariableDeclarator":return Za(a,b);case "VariableDeclaration":return Aa(a,b,0);case "BlockStatement":return $a(a,
b);case "FunctionDeclaration":return ab(a,b);case "ReturnStatement":return bb(a,b);case "IfStatement":return cb(a,b);case "ExpressionStatement":return db(a,b);case "UpdateExpression":return eb(a,b);case "AssignmentExpression":return fb(a,b);case "ForStatement":return gb(a,b);case "ForInStatement":return hb(a,b);case "BreakStatement":return e.breakResult;case "EmptyStatement":return e.voidOperation;case "ContinueStatement":return e.continueResult;case "TemplateElement":return ib(a,b);case "TemplateLiteral":return jb(a,
b);case "Identifier":return K(a,b);case "MemberExpression":return kb(a,b);case "Literal":return b.value;case "CallExpression":return lb(a,b);case "UnaryExpression":return mb(a,b);case "BinaryExpression":return nb(a,b);case "LogicalExpression":return ob(a,b);case "ArrayExpression":return pb(a,b);case "ObjectExpression":return qb(a,b);case "Property":return rb(a,b);default:throw Error(q.nodeErrorMessage(b,"RUNTIME","UNREOGNISED"));}});return J.apply(this,arguments)}function qb(a,b){return L.apply(this,
arguments)}function L(){L=m._asyncToGenerator(function*(a,b){var c=[];for(var d=0;d<b.properties.length;d++)c[d]=yield h(a,b.properties[d]);a={};for(b=0;b<c.length;b++){d=c[b];if(e.isFunctionParameter(d.value))throw Error("Illegal Argument");if(!1===e.isString(d.key))throw Error("Illegal Argument");a[d.key.toString()]=d.value===e.voidOperation?null:d.value}c=new v(a);c.immutable=!1;return c});return L.apply(this,arguments)}function rb(a,b){return M.apply(this,arguments)}function M(){M=m._asyncToGenerator(function*(a,
b){const c=yield h(a,b.value);return"Identifier"===b.key.type?{key:b.key.name,value:c}:{key:yield h(a,b.key),value:c}});return M.apply(this,arguments)}function sb(a,b,c){return N.apply(this,arguments)}function N(){N=m._asyncToGenerator(function*(a,b,c){const d=yield h(a,b.body);c.lastAction=d;if(c.lastAction===e.breakResult||c.lastAction instanceof e.ReturnResult)return c.testResult=!1,c;null!==b.update&&(yield h(a,b.update));return c});return N.apply(this,arguments)}function tb(a,b,c){return O.apply(this,
arguments)}function O(){O=m._asyncToGenerator(function*(a,b,c){if(null!==b.test){const d=yield h(a,b.test);if(!0===a.abortSignal.aborted)throw Error("Cancelled");c.testResult=d;if(!1===c.testResult)return c;if(!0!==c.testResult)throw Error(q.nodeErrorMessage(b,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION"));}return sb(a,b,c)});return O.apply(this,arguments)}function D(a,b,c,d,f,g){try{tb(a,b,c).then(()=>{try{!0===c.testResult?(g++,100<g?(g=0,setTimeout(()=>{D(a,b,c,d,f,g)},0)):D(a,b,c,d,f,g)):c.lastAction instanceof
e.ReturnResult?d(c.lastAction):d(e.voidOperation)}catch(k){f(k)}},k=>{f(k)})}catch(k){f(k)}}function gb(a,b){try{return null!==b.init?h(a,b.init).then(()=>new Promise((c,d)=>{D(a,b,{testResult:!0,lastAction:e.voidOperation},f=>{c(f)},f=>{d(f)},0)})):new Promise((c,d)=>{D(a,b,{testResult:!0,lastAction:e.voidOperation},f=>{c(f)},f=>{d(f)},0)})}catch(c){return Promise.reject(c)}}function P(a,b,c,d,f,g,k,l,n,p){try{d<=g?l(e.voidOperation):(f.value="k"===k?c[g]:g,h(a,b.body).then(t=>{try{t instanceof e.ReturnResult?
l(t):t===e.breakResult?l(e.voidOperation):(p++,100<p?(p=0,setTimeout(()=>{P(a,b,c,d,f,g+1,k,l,n,p)},0)):P(a,b,c,d,f,g+1,k,l,n,p))}catch(Q){n(Q)}},t=>{n(t)}))}catch(t){n(t)}}function R(a,b,c,d,f,g,k,l,n){try{c.length()<=f?k(e.voidOperation):(d.value="k"===g?c.get(f):f,h(a,b.body).then(p=>{p instanceof e.ReturnResult?k(p):p===e.breakResult?k(e.voidOperation):(n++,100<n?(n=0,setTimeout(()=>{R(a,b,c,d,f+1,g,k,l,n)},0)):R(a,b,c,d,f+1,g,k,l,n))},p=>{l(p)}))}catch(p){l(p)}}function S(a,b,c,d,f,g){try{void 0===
g&&(g="i"),0===c.length?d.resolve(e.voidOperation):P(a,b,c,c.length,f,0,g,k=>{d.resolve(k)},k=>{d.reject(k)},0)}catch(k){d.reject(k)}}function ub(a,b,c,d,f,g){try{void 0===g&&(g="i"),0===c.length?d.resolve(e.voidOperation):R(a,b,c,f,0,g,k=>{d.resolve(k)},k=>{d.reject(k)},0)}catch(k){d.reject(k)}}function vb(a,b,c,d,f){try{const g=c.keys();S(a,b,g,d,f,"k")}catch(g){d.reject(g)}}function T(a,b,c,d,f,g,k,l){try{a.next().then(n=>{try{if(null===n)g(e.voidOperation);else{const p=xa.createFromGraphicLikeObject(n.geometry,
n.attributes,d);p._underlyingGraphic=n;f.value=p;h(b,c.body).then(t=>{try{t===e.breakResult?g(e.voidOperation):t instanceof e.ReturnResult?g(t):(l++,100<l?(l=0,setTimeout(()=>{T(a,b,c,d,f,g,k,l)},0)):T(a,b,c,d,f,g,k,l))}catch(Q){k(Q)}},t=>{k(t)})}}catch(p){k(p)}},n=>{k(n)})}catch(n){k(n)}}function hb(a,b){return U.apply(this,arguments)}function U(){U=m._asyncToGenerator(function*(a,b){return new Promise((c,d)=>{h(a,b.right).then(f=>{try{let g=null;g="VariableDeclaration"===b.left.type?h(a,b.left):
Promise.resolve();g.then(()=>{try{let l="";if("VariableDeclaration"===b.left.type){var k=b.left.declarations[0].id;"Identifier"===k.type&&(l=k.name)}else"Identifier"===b.left.type&&(l=b.left.name);if(!l)throw Error(q.nodeErrorMessage(b,"RUNTIME","INVALIDVARIABLE"));l=l.toLowerCase();k=null;null!==a.localScope&&void 0!==a.localScope[l]&&(k=a.localScope[l]);null===k&&void 0!==a.globalScope[l]&&(k=a.globalScope[l]);null===k?d(Error(q.nodeErrorMessage(b,"RUNTIME","VARIABLENOTDECLARED"))):e.isArray(f)||
e.isString(f)?S(a,b,f,{reject:d,resolve:c},k):e.isImmutableArray(f)?ub(a,b,f,{reject:d,resolve:c},k):f instanceof v||e.isFeature(f)?vb(a,b,f,{reject:d,resolve:c},k):e.isFeatureSet(f)?T(f.iterator(a.abortSignal),a,b,f,k,n=>{c(n)},n=>{d(n)},0):S(a,b,[],{reject:d,resolve:c},k)}catch(l){d(l)}},d)}catch(g){d(g)}},d)})});return U.apply(this,arguments)}function eb(a,b){return V.apply(this,arguments)}function V(){V=m._asyncToGenerator(function*(a,b){var c=b.argument;if("MemberExpression"===c.type){var d=
null,f=null;d=yield h(a,c.object);!0===c.computed?f=yield h(a,c.property):"Identifier"===c.property.type&&(f=c.property.name);a=d;if(e.isArray(a))if(e.isNumber(f)){0>f&&(f=a.length+f);if(0>f||f>=a.length)throw Error("Assignment outside of array bounds");c=e.toNumber(a[f]);a[f]="++"===b.operator?c+1:c-1}else throw Error("Invalid Parameter");else if(a instanceof v){if(!1===e.isString(f))throw Error("Dictionary accessor must be a string");if(!0===a.hasField(f))c=e.toNumber(a.field(f)),a.setField(f,"++"===
b.operator?c+1:c-1);else throw Error("Invalid Parameter");}else if(e.isFeature(a)){if(!1===e.isString(f))throw Error("Feature accessor must be a string");if(!0===a.hasField(f))c=e.toNumber(a.field(f)),a.setField(f,"++"===b.operator?c+1:c-1);else throw Error("Invalid Parameter");}else{if(e.isImmutableArray(a))throw Error("Array is Immutable");throw Error("Invalid Parameter");}return!1===b.prefix?c:"++"===b.operator?c+1:c-1}f="Identifier"===b.argument.type?b.argument.name.toLowerCase():"";if(!f)throw Error("Invalid identifier");
if(null!==a.localScope&&void 0!==a.localScope[f])return c=e.toNumber(a.localScope[f].value),a.localScope[f]={value:"++"===b.operator?c+1:c-1,valueset:!0,node:b},!1===b.prefix?c:"++"===b.operator?c+1:c-1;if(void 0!==a.globalScope[f])return c=e.toNumber(a.globalScope[f].value),a.globalScope[f]={value:"++"===b.operator?c+1:c-1,valueset:!0,node:b},!1===b.prefix?c:"++"===b.operator?c+1:c-1;throw Error("Variable not recognised");});return V.apply(this,arguments)}function y(a,b,c,d){switch(b){case "\x3d":return a===
e.voidOperation?null:a;case "/\x3d":return e.toNumber(c)/e.toNumber(a);case "*\x3d":return e.toNumber(c)*e.toNumber(a);case "-\x3d":return e.toNumber(c)-e.toNumber(a);case "+\x3d":return e.isString(c)||e.isString(a)?e.toString(c)+e.toString(a):e.toNumber(c)+e.toNumber(a);case "%\x3d":return e.toNumber(c)%e.toNumber(a);default:throw Error(q.nodeErrorMessage(d,"RUNTIME","OPERATORNOTRECOGNISED"));}}function fb(a,b){return W.apply(this,arguments)}function W(){W=m._asyncToGenerator(function*(a,b){var c=
b.left;if("MemberExpression"===c.type){var d=yield h(a,b.right);const f=yield h(a,c.object);let g=null;if(!0===c.computed)g=yield h(a,c.property);else if("Identifier"===c.property.type)g=c.property.name;else throw Error("Expected computed or identifier for assignemnt target");if(e.isArray(f))if(e.isNumber(g)){0>g&&(g=f.length+g);if(0>g||g>f.length)throw Error("Assignment outside of array bounds");if(g===f.length&&"\x3d"!==b.operator)throw Error("Invalid Parameter");f[g]=y(d,b.operator,f[g],b)}else throw Error("Invalid Parameter");
else if(f instanceof v){if(!1===e.isString(g))throw Error("Dictionary accessor must be a string");if(!0===f.hasField(g))f.setField(g,y(d,b.operator,f.field(g),b));else{if("\x3d"!==b.operator)throw Error("Invalid Parameter");f.setField(g,y(d,b.operator,null,b))}}else if(e.isFeature(f)){if(!1===e.isString(g))throw Error("Feature accessor must be a string");if(!0===f.hasField(g))f.setField(g,y(d,b.operator,f.field(g),b));else{if("\x3d"!==b.operator)throw Error("Invalid Parameter");f.setField(g,y(d,b.operator,
null,b))}}else{if(e.isImmutableArray(f))throw Error("Array is Immutable");throw Error("Invalid Parameter");}return e.voidOperation}c=c.name.toLowerCase();if(null!==a.localScope&&void 0!==a.localScope[c])return d=yield h(a,b.right),a.localScope[c]={value:y(d,b.operator,a.localScope[c].value,b),valueset:!0,node:b.right},e.voidOperation;if(void 0!==a.globalScope[c])return d=yield h(a,b.right),a.globalScope[c]={value:y(d,b.operator,a.globalScope[c].value,b),valueset:!0,node:b.right},e.voidOperation;throw Error("Cannot assign undeclared variable");
});return W.apply(this,arguments)}function db(a,b){return X.apply(this,arguments)}function X(){X=m._asyncToGenerator(function*(a,b){if("AssignmentExpression"===b.expression.type)return h(a,b.expression);if("CallExpression"===b.expression.type)return a=yield h(a,b.expression),a===e.voidOperation?e.voidOperation:new e.ImplicitResult(a);a=yield h(a,b.expression);return a===e.voidOperation?e.voidOperation:new e.ImplicitResult(a)});return X.apply(this,arguments)}function cb(a,b){return Y.apply(this,arguments)}
function Y(){Y=m._asyncToGenerator(function*(a,b){if("AssignmentExpression"===b.test.type||"UpdateExpression"===b.test.type)throw Error(q.nodeErrorMessage(b.test,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));const c=yield h(a,b.test);if(!0===c)return h(a,b.consequent);if(!1===c)return null!==b.alternate?h(a,b.alternate):e.voidOperation;throw Error(q.nodeErrorMessage(b.test,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION"));});return Y.apply(this,arguments)}function $a(a,b){return Z.apply(this,arguments)}
function Z(){Z=m._asyncToGenerator(function*(a,b){return Ba(a,b,0)});return Z.apply(this,arguments)}function Ba(a,b,c){return aa.apply(this,arguments)}function aa(){aa=m._asyncToGenerator(function*(a,b,c){if(c>=b.body.length)return e.voidOperation;const d=yield h(a,b.body[c]);return d instanceof e.ReturnResult||d===e.breakResult||d===e.continueResult||c===b.body.length-1?d:Ba(a,b,c+1)});return aa.apply(this,arguments)}function bb(a,b){return ba.apply(this,arguments)}function ba(){ba=m._asyncToGenerator(function*(a,
b){if(null===b.argument)return new e.ReturnResult(e.voidOperation);a=yield h(a,b.argument);return new e.ReturnResult(a)});return ba.apply(this,arguments)}function ab(a,b){return ca.apply(this,arguments)}function ca(){ca=m._asyncToGenerator(function*(a,b){const c=b.id.name.toLowerCase();a.globalScope[c]={valueset:!0,node:null,value:new C(b,a)};return e.voidOperation});return ca.apply(this,arguments)}function Aa(a,b,c){return da.apply(this,arguments)}function da(){da=m._asyncToGenerator(function*(a,
b,c){if(c>=b.declarations.length)return e.voidOperation;yield h(a,b.declarations[c]);if(c===b.declarations.length-1)return e.voidOperation;yield Aa(a,b,c+1);return e.voidOperation});return da.apply(this,arguments)}function Za(a,b){return ea.apply(this,arguments)}function ea(){ea=m._asyncToGenerator(function*(a,b){let c=null;c=null===b.init?null:yield h(a,b.init);if(null!==a.localScope){c===e.voidOperation&&(c=null);if("Identifier"!==b.id.type)throw Error("Can only assign a regular variable");var d=
b.id.name.toLowerCase();a.localScope[d]={value:c,valueset:!0,node:b.init};return e.voidOperation}if("Identifier"!==b.id.type)throw Error("Can only assign a regular variable");d=b.id.name.toLowerCase();c===e.voidOperation&&(c=null);a.globalScope[d]={value:c,valueset:!0,node:b.init};return e.voidOperation});return ea.apply(this,arguments)}function Ca(a,b,c,d){b=b.toLowerCase();switch(b){case "hasz":return a=a.hasZ,void 0===a?!1:a;case "hasm":return a=a.hasM,void 0===a?!1:a;case "spatialreference":return b=
a.spatialReference._arcadeCacheId,void 0===b&&(c=!0,Object.freeze&&Object.isFrozen(a.spatialReference)&&(c=!1),c&&(x++,b=a.spatialReference._arcadeCacheId=x)),a=new v({wkt:a.spatialReference.wkt,wkid:a.spatialReference.wkid}),void 0!==b&&(a._arcadeCacheId="SPREF"+b.toString()),a}switch(a.type){case "extent":switch(b){case "xmin":case "xmax":case "ymin":case "ymax":case "zmin":case "zmax":case "mmin":case "mmax":return a=a[b],void 0!==a?a:null;case "type":return"Extent"}break;case "polygon":switch(b){case "rings":return b=
a.cache._arcadeCacheId,void 0===b&&(x++,b=x,a.cache._arcadeCacheId=b),new ya(a.rings,a.spatialReference,!0===a.hasZ,!0===a.hasM,b);case "type":return"Polygon"}break;case "point":switch(b){case "x":case "y":case "z":case "m":return void 0!==a[b]?a[b]:null;case "type":return"Point"}break;case "polyline":switch(b){case "paths":return b=a.cache._arcadeCacheId,void 0===b&&(x++,b=x,a.cache._arcadeCacheId=b),new ya(a.paths,a.spatialReference,!0===a.hasZ,!0===a.hasM,b);case "type":return"Polyline"}break;
case "multipoint":switch(b){case "points":return b=a.cache._arcadeCacheId,void 0===b&&(x++,b=x,a.cache._arcadeCacheId=b),new La(a.points,a.spatialReference,!0===a.hasZ,!0===a.hasM,b,1);case "type":return"Multipoint"}}throw Error(q.nodeErrorMessage(d,"RUNTIME","PROPERTYNOTFOUND"));}function kb(a,b){return fa.apply(this,arguments)}function fa(){fa=m._asyncToGenerator(function*(a,b){const c=yield h(a,b.object);if(null===c)throw Error(q.nodeErrorMessage(b,"RUNTIME","NOTFOUND"));if(!1===b.computed){if("Identifier"===
b.property.type){if(c instanceof v||e.isFeature(c))return c.field(b.property.name);if(c instanceof za)return Ca(c,b.property.name,a,b)}throw Error(q.nodeErrorMessage(b,"RUNTIME","INVALIDTYPE"));}let d=yield h(a,b.property);if(c instanceof v||e.isFeature(c)){if(e.isString(d))return c.field(d)}else if(c instanceof za){if(e.isString(d))return Ca(c,d,a,b)}else if(e.isArray(c)){if(e.isNumber(d)&&isFinite(d)&&Math.floor(d)===d){0>d&&(d=c.length+d);if(d>=c.length||0>d)throw Error(q.nodeErrorMessage(b,"RUNTIME",
"OUTOFBOUNDS"));return c[d]}}else if(e.isImmutableArray(c)){if(e.isNumber(d)&&isFinite(d)&&Math.floor(d)===d){0>d&&(d=c.length()+d);if(d>=c.length()||0>d)throw Error(q.nodeErrorMessage(b,"RUNTIME","OUTOFBOUNDS"));return c.get(d)}}else if(e.isString(c)&&e.isNumber(d)&&isFinite(d)&&Math.floor(d)===d){0>d&&(d=c.length+d);if(d>=c.length||0>d)throw Error(q.nodeErrorMessage(b,"RUNTIME","OUTOFBOUNDS"));return c[d]}throw Error(q.nodeErrorMessage(b,"RUNTIME","INVALIDTYPE"));});return fa.apply(this,arguments)}
function mb(a,b){return ha.apply(this,arguments)}function ha(){ha=m._asyncToGenerator(function*(a,b){a=yield h(a,b.argument);if(e.isBoolean(a)&&"!"===b.operator)return!a;if("-"===b.operator)return-1*e.toNumber(a);if("+"===b.operator)return 1*e.toNumber(a);if("~"===b.operator)return~e.toNumber(a);throw Error(q.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));});return ha.apply(this,arguments)}function pb(a,b){return ia.apply(this,arguments)}function ia(){ia=m._asyncToGenerator(function*(a,
b){const c=[];for(let d=0;d<b.elements.length;d++)c.push(yield h(a,b.elements[d]));for(a=0;a<c.length;a++){if(e.isFunctionParameter(c[a]))throw Error(q.nodeErrorMessage(b,"RUNTIME","FUNCTIONCONTEXTILLEGAL"));c[a]===e.voidOperation&&(c[a]=null)}return c});return ia.apply(this,arguments)}function nb(a,b){return ja.apply(this,arguments)}function ja(){ja=m._asyncToGenerator(function*(a,b){var c=[];c[0]=yield h(a,b.left);c[1]=yield h(a,b.right);a=c[0];c=c[1];switch(b.operator){case "|":case "\x3c\x3c":case "\x3e\x3e":case "\x3e\x3e\x3e":case "^":case "\x26":return e.binaryOperator(e.toNumber(a),
e.toNumber(c),b.operator);case "\x3d\x3d":return e.equalityTest(a,c);case "!\x3d":return!e.equalityTest(a,c);case "\x3c":return e.greaterThanLessThan(a,c,b.operator);case "\x3e":return e.greaterThanLessThan(a,c,b.operator);case "\x3c\x3d":return e.greaterThanLessThan(a,c,b.operator);case "\x3e\x3d":return e.greaterThanLessThan(a,c,b.operator);case "+":return e.isString(a)||e.isString(c)?e.toString(a)+e.toString(c):e.toNumber(a)+e.toNumber(c);case "-":return e.toNumber(a)-e.toNumber(c);case "*":return e.toNumber(a)*
e.toNumber(c);case "/":return e.toNumber(a)/e.toNumber(c);case "%":return e.toNumber(a)%e.toNumber(c);default:throw Error(q.nodeErrorMessage(b,"RUNTIME","OPERATORNOTRECOGNISED"));}});return ja.apply(this,arguments)}function ob(a,b){return ka.apply(this,arguments)}function ka(){ka=m._asyncToGenerator(function*(a,b){if("AssignmentExpression"===b.left.type||"UpdateExpression"===b.left.type)throw Error(q.nodeErrorMessage(b.left,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));if("AssignmentExpression"===
b.right.type||"UpdateExpression"===b.right.type)throw Error(q.nodeErrorMessage(b.right,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));const c=yield h(a,b.left);let d=null;if(e.isBoolean(c))switch(b.operator){case "||":if(!0===c)return c;d=yield h(a,b.right);if(e.isBoolean(d))return d;throw Error(q.nodeErrorMessage(b,"RUNTIME","ONLYORORAND"));case "\x26\x26":if(!1===c)return c;d=yield h(a,b.right);if(e.isBoolean(d))return d;throw Error(q.nodeErrorMessage(b,"RUNTIME","ONLYORORAND"));default:throw Error(q.nodeErrorMessage(b,
"RUNTIME","ONLYORORAND"));}else throw Error(q.nodeErrorMessage(b,"RUNTIME","ONLYBOOLEAN"));});return ka.apply(this,arguments)}function K(a,b){return la.apply(this,arguments)}function la(){la=m._asyncToGenerator(function*(a,b){const c=b.name.toLowerCase();if(null!==a.localScope&&void 0!==a.localScope[c]){b=a.localScope[c];if(!0===b.valueset)return b.value;if(null!==b.d)return b.d;b.d=h(a,b.node);a=yield b.d;b.value=a;b.valueset=!0;return a}if(void 0!==a.globalScope[c]){b=a.globalScope[c];if(!0===b.valueset)return b.value;
if(null!==b.d)return b.d;b.d=h(a,b.node);a=yield b.d;b.value=a;b.valueset=!0;return a}throw Error(q.nodeErrorMessage(b,"RUNTIME","VARIABLENOTFOUND"));});return la.apply(this,arguments)}function lb(a,b){return ma.apply(this,arguments)}function ma(){ma=m._asyncToGenerator(function*(a,b){if("Identifier"!==b.callee.type)throw Error(q.nodeErrorMessage(b,"RUNTIME","ONLYNODESSUPPORTED"));if(null!==a.localScope&&void 0!==a.localScope[b.callee.name.toLowerCase()]){var c=a.localScope[b.callee.name.toLowerCase()];
if(c.value instanceof e.NativeFunction)return c.value.fn(a,b);if(c.value instanceof C)return Da(a,b,c.value.definition);throw Error(q.nodeErrorMessage(b,"RUNTIME","NOTAFUNCTION"));}if(void 0!==a.globalScope[b.callee.name.toLowerCase()]){c=a.globalScope[b.callee.name.toLowerCase()];if(c.value instanceof e.NativeFunction)return c.value.fn(a,b);if(c.value instanceof C)return Da(a,b,c.value.definition);throw Error(q.nodeErrorMessage(b,"RUNTIME","NOTAFUNCTION"));}throw Error(q.nodeErrorMessage(b,"RUNTIME",
"NOTFOUND"));});return ma.apply(this,arguments)}function ib(a,b){return na.apply(this,arguments)}function na(){na=m._asyncToGenerator(function*(a,b){return b.value?b.value.cooked:""});return na.apply(this,arguments)}function jb(a,b){return oa.apply(this,arguments)}function oa(){oa=m._asyncToGenerator(function*(a,b){const c=[];for(var d=0;d<b.expressions.length;d++){const f=yield h(a,b.expressions[d]);c[d]=e.toString(f)}a="";d=0;for(const f of b.quasis)a+=f.value?f.value.cooked:"",!1===f.tail&&(a+=
c[d]?c[d]:"",d++);return a});return oa.apply(this,arguments)}function Ea(a){return null===a?"":e.isArray(a)||e.isImmutableArray(a)?"Array":e.isDate(a)?"Date":e.isString(a)?"String":e.isBoolean(a)?"Boolean":e.isNumber(a)?"Number":a instanceof Ka?"Attachment":a instanceof Ja?"Portal":a instanceof v?"Dictionary":e.isFeature(a)?"Feature":a instanceof Va?"Point":a instanceof Wa?"Polygon":a instanceof Xa?"Polyline":a instanceof Ua?"Multipoint":a instanceof Ta?"Extent":e.isFunctionParameter(a)?"Function":
e.isFeatureSet(a)?"FeatureSet":e.isFeatureSetCollection(a)?"FeatureSetCollection":a===e.voidOperation?"":"number"===typeof a&&isNaN(a)?"Number":"Unrecognised Type"}function Fa(a,b,c,d){return pa.apply(this,arguments)}function pa(){pa=m._asyncToGenerator(function*(a,b,c,d){var f=yield h(a,b.arguments[c]);if(e.equalityTest(f,d))return h(a,b.arguments[c+1]);f=b.arguments.length-c;return 1===f?h(a,b.arguments[c]):2===f?null:3===f?h(a,b.arguments[c+2]):Fa(a,b,c+2,d)});return pa.apply(this,arguments)}function Ga(a,
b,c,d){return qa.apply(this,arguments)}function qa(){qa=m._asyncToGenerator(function*(a,b,c,d){if(!0===d)return h(a,b.arguments[c+1]);if(3===b.arguments.length-c)return h(a,b.arguments[c+2]);d=yield h(a,b.arguments[c+2]);if(!1===e.isBoolean(d))throw Error("WHEN needs boolean test conditions");return Ga(a,b,c+2,d)});return qa.apply(this,arguments)}function ra(a,b){return sa.apply(this,arguments)}function sa(){sa=m._asyncToGenerator(function*(a,b){const c=a.length,d=Math.floor(c/2);if(0===c)return[];
if(1===c)return[a[0]];a=[ra(a.slice(0,d),b),ra(a.slice(d,c),b)];a=yield Promise.all(a);return E(a[0],a[1],b,[])});return sa.apply(this,arguments)}function E(a,b,c,d){return ta.apply(this,arguments)}function ta(){ta=m._asyncToGenerator(function*(a,b,c,d){if(0<a.length||0<b.length){if(0<a.length&&0<b.length){let f=yield c(a[0],b[0]);isNaN(f)&&(f=1);0>=f?(d.push(a[0]),a=a.slice(1)):(d.push(b[0]),b=b.slice(1));return E(a,b,c,d)}if(0<a.length)return d.push(a[0]),a=a.slice(1),E(a,b,c,d);if(0<b.length)return d.push(b[0]),
b=b.slice(1),E(a,b,c,d)}else return d});return ta.apply(this,arguments)}function z(a,b){const c=a.length,d=Math.floor(c/2);b||(b=function(f,g){return f<g?-1:f===g?0:1});return 0===c?[]:1===c?[a[0]]:wb(z(a.slice(0,d),b),z(a.slice(d,c),b),b)}function wb(a,b,c){const d=[];for(;0<a.length||0<b.length;)if(0<a.length&&0<b.length){let f=c(a[0],b[0]);isNaN(f)&&(f=1);0>=f?(d.push(a[0]),a=a.slice(1)):(d.push(b[0]),b=b.slice(1))}else 0<a.length?(d.push(a[0]),a=a.slice(1)):0<b.length&&(d.push(b[0]),b=b.slice(1));
return d}function Ha(a,b,c){return ua.apply(this,arguments)}function ua(){ua=m._asyncToGenerator(function*(a,b,c){const d=a.body;if(c.length!==a.params.length)throw Error("Invalid Parameter calls to function.");for(let f=0;f<c.length;f++){const g=a.params[f];"Identifier"===g.type&&(b.localScope[g.name.toLowerCase()]={d:null,value:c[f],valueset:!0,node:null})}a=yield h(b,d);if(a instanceof e.ReturnResult)return a.value;if(a===e.breakResult)throw Error("Cannot Break from a Function");if(a===e.continueResult)throw Error("Cannot Continue from a Function");
return a instanceof e.ImplicitResult?a.value:a});return ua.apply(this,arguments)}function Da(a,b,c){return A(a,b,function(d,f,g){d={spatialReference:a.spatialReference,services:a.services,console:a.console,lrucache:a.lrucache,interceptor:a.interceptor,localScope:{},abortSignal:a.abortSignal,globalScope:a.globalScope,depthCounter:a.depthCounter+1};if(64<d.depthCounter)throw Error("Exceeded maximum function depth");return Ha(c,d,g)})}function va(a){return function(){const b={abortSignal:a.context.abortSignal,
spatialReference:a.context.spatialReference,console:a.context.console,lrucache:a.context.lrucache,interceptor:a.context.interceptor,services:a.context.services,localScope:{},globalScope:a.context.globalScope,depthCounter:a.context.depthCounter+1};if(64<b.depthCounter)throw Error("Exceeded maximum function depth");return Ha(a.definition,b,arguments)}}function xb(a){console.log(a)}function Ia(a){const b={mode:"async",compiled:!1,functions:{},signatures:[],standardFunction:w,standardFunctionAsync:A,
evaluateIdentifier:K,arcadeCustomFunctionHandler:va};for(let c=0;c<a.length;c++)a[c].registerFunctions(b);for(const c in b.functions)r[c]={value:new e.NativeFunction(b.functions[c]),valueset:!0,node:null},B.prototype[c]=r[c];for(a=0;a<b.signatures.length;a++)q.addFunctionDeclaration(b.signatures[a],"async")}function wa(){wa=m._asyncToGenerator(function*(a,b){let c=b.spatialReference;if(null===c||void 0===c)c=new Ya({wkid:102100});{var d=b.vars;var f=b.customfunctions;const g=new B;if(void 0===d||
null===d)d={};if(void 0===f||null===f)f={};const k=new v({newline:"\n",tab:"\t",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});k.immutable=!1;g.textformatting={value:k,valueset:!0,node:null};for(const l in f)g[l]={value:new e.NativeFunction(f[l]),native:!0,valueset:!0,node:null};for(const l in d)g[l]=d[l]&&"esri.Graphic"===d[l].declaredClass?{value:xa.createFromGraphic(d[l]),valueset:!0,node:null}:{value:d[l],valueset:!0,node:null};d=g}a=yield h({spatialReference:c,services:b.services,
abortSignal:void 0===b.abortSignal||null===b.abortSignal?{aborted:!1}:b.abortSignal,globalScope:d,console:b.console?b.console:xb,lrucache:b.lrucache,interceptor:b.interceptor,localScope:null,depthCounter:1},a.body[0].body);a instanceof e.ReturnResult&&(a=a.value);a instanceof e.ImplicitResult&&(a=a.value);a===e.voidOperation&&(a=null);if(a===e.breakResult)throw Error("Cannot return BREAK");if(a===e.continueResult)throw Error("Cannot return CONTINUE");if(a instanceof e.NativeFunction)throw Error("Cannot return FUNCTION");
if(a instanceof C)throw Error("Cannot return FUNCTION");return a});return wa.apply(this,arguments)}let x=0;const r={};Na.registerFunctions(r,w);Sa.registerFunctions(r,w);Qa.registerFunctions(r,w);Pa.registerFunctions(r,w);Ra.registerFunctions(r,w);Oa.registerFunctions({functions:r,compiled:!1,signatures:null,evaluateIdentifier:null,arcadeCustomFunctionHandler:null,mode:"async",standardFunction:w,standardFunctionAsync:A});r.typeof=function(a,b){return w(a,b,function(c,d,f){e.pcCheck(f,1,1);c=Ea(f[0]);
if("Unrecognised Type"===c)throw Error("Unrecognised Type");return c})};r.iif=function(){var a=m._asyncToGenerator(function*(b,c){e.pcCheck(null===c.arguments?[]:c.arguments,3,3);const d=yield h(b,c.arguments[0]);if(!1===e.isBoolean(d))throw Error("IF Function must have a boolean test condition");const f=[];f[0]=yield h(b,c.arguments[1]);f[1]=yield h(b,c.arguments[2]);return d?f[0]:f[1]});return function(b,c){return a.apply(this,arguments)}}();r.decode=function(){var a=m._asyncToGenerator(function*(b,
c){if(2>c.arguments.length)throw Error("Missing Parameters");if(2===c.arguments.length)return h(b,c.arguments[1]);if(0===(c.arguments.length-1)%2)throw Error("Must have a default value result.");const d=yield h(b,c.arguments[0]);return Fa(b,c,1,d)});return function(b,c){return a.apply(this,arguments)}}();r.when=function(){var a=m._asyncToGenerator(function*(b,c){if(3>c.arguments.length)throw Error("Missing Parameters");if(0===c.arguments.length%2)throw Error("Must have a default value result.");const d=
yield h(b,c.arguments[0]);if(!1===e.isBoolean(d))throw Error("WHEN needs boolean test conditions");return Ga(b,c,0,d)});return function(b,c){return a.apply(this,arguments)}}();r.sort=function(a,b){return A(a,b,function(){var c=m._asyncToGenerator(function*(d,f,g){e.pcCheck(g,1,2);d=g[0];e.isImmutableArray(d)&&(d=d.toArray());if(!1===e.isArray(d))throw Error("Illegal Argument");if(1<g.length){if(!1===e.isFunctionParameter(g[1]))throw Error("Illegal Argument");var k=d;g=va(g[1]);return ra(k,g)}g=d;
if(0===g.length)return[];d={};for(f=0;f<g.length;f++){var l=Ea(g[f]);""!==l&&(d[l]=!0)}if(!0===d.Array||!0===d.Dictionary||!0===d.Feature||!0===d.Point||!0===d.Polygon||!0===d.Polyline||!0===d.Multipoint||!0===d.Extent||!0===d.Function)return g.slice(0);f=0;l="";for(k in d)f++,l=k;1<f||"String"===l?g=z(g,function(n,p){if(null===n||void 0===n||n===e.voidOperation)return null===p||void 0===p||p===e.voidOperation?0:1;if(null===p||void 0===p||p===e.voidOperation)return-1;n=e.toString(n);p=e.toString(p);
return n<p?-1:n===p?0:1}):"Number"===l?g=z(g,function(n,p){return n-p}):"Boolean"===l?g=z(g,function(n,p){return n===p?0:p?-1:1}):"Date"===l&&(g=z(g,function(n,p){return p-n}));return g});return function(d,f,g){return c.apply(this,arguments)}}())};const yb={fixSpatialReference:e.fixSpatialReference,parseArguments:F,standardFunction:w,standardFunctionAsync:A,evaluateIdentifier:K,arcadeCustomFunction:va};for(const a in r)r[a]={value:new e.NativeFunction(r[a]),valueset:!0,node:null};const B=function(){};
B.prototype=r;B.prototype.infinity={value:Number.POSITIVE_INFINITY,valueset:!0,node:null};B.prototype.pi={value:Math.PI,valueset:!0,node:null};Ia([Ma.ArrayFunctions]);u.executeScript=function(a,b){return wa.apply(this,arguments)};u.extend=Ia;u.extractFieldLiterals=function(a,b){return q.findFieldLiterals(a)};u.findFunctionCalls=function(a){return q.findFunctionCalls(a)};u.functionHelper=yb;u.referencesFunction=function(a,b){return q.referencesFunction(a,b)};u.referencesMember=function(a,b){return q.referencesMember(a,
b)};u.validateScript=function(a,b){return q.validateScript(a,b,"full")};Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});