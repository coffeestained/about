// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
define("exports ../ArcadePortal ../Attachment ../Dictionary ../../chunks/languageUtils ../featureset/support/shared ./convertdirection ./hash ../../geometry/Extent ../../geometry/Multipoint ../../geometry/Point ../../geometry/Polygon ../../geometry/Polyline ../../geometry/SpatialReference".split(" "),function(r,t,w,q,d,u,x,y,z,A,B,C,D,E){function v(c,e){if(c.x===e.x&&c.y===e.y){if(c.hasZ){if(c.z!==e.z)return!1}else if(e.hasZ)return!1;if(c.hasM){if(c.m!==e.m)return!1}else if(e.hasM)return!1;return!0}return!1}
function m(c,e,f){if(null===c)e.updateUint8Array([0,139]);else if(d.isArray(c)){e.updateUint8Array([61]);if(f.map.has(c))c=f.map.get(c),e.updateIntArray([c^61237541]);else{f.map.set(c,f.currentLength++);for(var h of c)m(h,e,f);f.map.delete(c);f.currentLength--}e.updateUint8Array([199])}else if(d.isImmutableArray(c)){e.updateUint8Array([61]);if(f.map.has(c))c=f.map.get(c),e.updateIntArray([c^61237541]);else{f.map.set(c,f.currentLength++);for(var b of c.toArray())m(b,e,f);f.map.delete(c);f.currentLength--}e.updateUint8Array([199])}else if(d.isDate(c))e.updateIntArray([c.getTime()]),
e.updateUint8Array([241]);else if(d.isString(c))e.updateIntArray([c.length]),e.updateWithString(c),e.updateUint8Array([41]);else if(d.isBoolean(c))e.updateUint8Array([!0===c?1:0,113]);else if(d.isNumber(c))e.updateFloatArray([c]),e.updateUint8Array([173]);else{if(c instanceof w)throw Error("Type not supported in Hash");if(c instanceof t)throw Error("Type not supported in Hash");if(c instanceof q){e.updateUint8Array([223]);if(f.map.has(c))c=f.map.get(c),e.updateIntArray([c^61237541]);else{f.map.set(c,
f.currentLength++);for(var g of c.keys())e.updateIntArray([g.length]),e.updateWithString(g),e.updateUint8Array([251]),h=c.field(g),m(h,e,f),e.updateUint8Array([239]);f.map.delete(c);f.currentLength--}e.updateUint8Array([73])}else{if(d.isFeature(c))throw Error("Type not supported in Hash");if(c instanceof B)e.updateIntArray([3833836621]),e.updateIntArray([0]),e.updateFloatArray([c.x]),e.updateIntArray([1]),e.updateFloatArray([c.y]),c.hasZ&&(e.updateIntArray([2]),e.updateFloatArray([c.z])),c.hasM&&
(e.updateIntArray([3]),e.updateFloatArray([c.m])),e.updateIntArray([3765347959]),m(c.spatialReference.wkid,e,f);else if(c instanceof C){e.updateIntArray([1266616829]);for(g=0;g<c.rings.length;g++){b=c.rings[g];h=[];var a=null;let k=null;for(let l=0;l<b.length;l++){const n=c.getPoint(g,l);if(0===l)a=n;else if(v(k,n))continue;k=n;l===b.length-1&&v(a,n)||h.push(n)}e.updateIntArray([1397116793,h.length]);for(b=0;b<h.length;b++)a=h[b],e.updateIntArray([3962308117,b]),m(a,e,f),e.updateIntArray([2716288009]);
e.updateIntArray([2278822459])}e.updateIntArray([3878477243]);m(c.spatialReference.wkid,e,f)}else if(c instanceof D){e.updateIntArray([4106883559]);for(g=0;g<c.paths.length;g++){h=c.paths[g];e.updateIntArray([1397116793,h.length]);for(b=0;b<h.length;b++)e.updateIntArray([3962308117,b]),m(c.getPoint(g,b),e,f),e.updateIntArray([2716288009]);e.updateIntArray([2278822459])}e.updateIntArray([2568784753]);m(c.spatialReference.wkid,e,f)}else if(c instanceof A){e.updateIntArray([588535921,c.points.length]);
for(g=0;g<c.points.length;g++)h=c.getPoint(g),e.updateIntArray([g]),m(h,e,f);e.updateIntArray([1700171621]);m(c.spatialReference.wkid,e,f)}else if(c instanceof z)e.updateIntArray([3483648373]),e.updateIntArray([0]),e.updateFloatArray([c.xmax]),e.updateIntArray([1]),e.updateFloatArray([c.xmin]),e.updateIntArray([2]),e.updateFloatArray([c.ymax]),e.updateIntArray([3]),e.updateFloatArray([c.ymin]),c.hasZ&&(e.updateIntArray([4]),e.updateFloatArray([c.zmax]),e.updateIntArray([5]),e.updateFloatArray([c.zmin])),
c.hasM&&(e.updateIntArray([6]),e.updateFloatArray([c.mmax]),e.updateIntArray([7]),e.updateFloatArray([c.mmin])),e.updateIntArray([3622027469]),m(c.spatialReference.wkid,e,f);else if(c instanceof E)e.updateIntArray([14]),void 0!==c.wkid&&null!==c.wkid&&e.updateIntArray([c.wkid]),c.wkt&&e.updateWithString(c.wkt);else{if(d.isFunctionParameter(c))throw Error("Type not supported in Hash");if(d.isFeatureSet(c))throw Error("Type not supported in Hash");d.isFeatureSetCollection(c);throw Error("Type not supported in Hash");
}}}}r.registerFunctions=function(c,e){c.portal=function(f,h){return e(f,h,function(b,g,a){d.pcCheck(a,1,1);return new t(d.toString(a[0]))})};c.trim=function(f,h){return e(f,h,function(b,g,a){d.pcCheck(a,1,1);return d.toString(a[0]).trim()})};c.tohex=function(f,h){return e(f,h,function(b,g,a){d.pcCheck(a,1,1);b=d.toNumber(a[0]);return isNaN(b)?b:b.toString(16)})};c.upper=function(f,h){return e(f,h,function(b,g,a){d.pcCheck(a,1,1);return d.toString(a[0]).toUpperCase()})};c.proper=function(f,h){return e(f,
h,function(b,g,a){d.pcCheck(a,1,2);b=1;2===a.length&&"firstword"===d.toString(a[1]).toLowerCase()&&(b=2);g=/\s/;a=d.toString(a[0]);let k="",l=!0;for(let n=0;n<a.length;n++){let p=a[n];g.test(p)?1===b&&(l=!0):p.toUpperCase()!==p.toLowerCase()&&(l?(p=p.toUpperCase(),l=!1):p=p.toLowerCase());k+=p}return k})};c.lower=function(f,h){return e(f,h,function(b,g,a){d.pcCheck(a,1,1);return d.toString(a[0]).toLowerCase()})};c.guid=function(f,h){return e(f,h,function(b,g,a){d.pcCheck(a,0,1);if(0<a.length)switch(d.toString(a[0]).toLowerCase()){case "digits":return d.generateUUID().replace("-",
"").replace("-","").replace("-","").replace("-","");case "digits-hyphen":return d.generateUUID();case "digits-hyphen-parentheses":return"("+d.generateUUID()+")"}return"{"+d.generateUUID()+"}"})};c.console=function(f,h){return e(f,h,function(b,g,a){0!==a.length&&(1===a.length?f.console(d.toString(a[0])):f.console(d.toString(a)));return d.voidOperation})};c.mid=function(f,h){return e(f,h,function(b,g,a){d.pcCheck(a,2,3);b=d.toNumber(a[1]);if(isNaN(b))return"";0>b&&(b=0);if(2===a.length)return d.toString(a[0]).substr(b);
g=d.toNumber(a[2]);if(isNaN(g))return"";0>g&&(g=0);return d.toString(a[0]).substr(b,g)})};c.find=function(f,h){return e(f,h,function(b,g,a){d.pcCheck(a,2,3);b=0;if(2<a.length){b=d.toNumber(d.defaultUndefined(a[2],0));if(isNaN(b))return-1;0>b&&(b=0)}return d.toString(a[1]).indexOf(d.toString(a[0]),b)})};c.left=function(f,h){return e(f,h,function(b,g,a){d.pcCheck(a,2,2);b=d.toNumber(a[1]);if(isNaN(b))return"";0>b&&(b=0);return d.toString(a[0]).substr(0,b)})};c.right=function(f,h){return e(f,h,function(b,
g,a){d.pcCheck(a,2,2);b=d.toNumber(a[1]);if(isNaN(b))return"";0>b&&(b=0);return d.toString(a[0]).substr(-1*b,b)})};c.split=function(f,h){return e(f,h,function(b,g,a){d.pcCheck(a,2,4);b=d.toNumber(d.defaultUndefined(a[2],-1));g=d.toBoolean(d.defaultUndefined(a[3],!1));-1===b||null===b||!0===g?a=d.toString(a[0]).split(d.toString(a[1])):(isNaN(b)&&(b=-1),-1>b&&(b=-1),a=d.toString(a[0]).split(d.toString(a[1]),b));if(!1===g)return a;g=[];for(let k=0;k<a.length&&!(-1!==b&&g.length>=b);k++)""!==a[k]&&void 0!==
a[k]&&g.push(a[k]);return g})};c.text=function(f,h){return e(f,h,function(b,g,a){d.pcCheck(a,1,2);return d.toStringExplicit(a[0],a[1])})};c.concatenate=function(f,h){return e(f,h,function(b,g,a){b=[];if(1>a.length)return"";if(d.isArray(a[0])){g=d.defaultUndefined(a[2],"");for(var k=0;k<a[0].length;k++)b[k]=d.toStringExplicit(a[0][k],g);return 1<a.length?b.join(a[1]):b.join("")}if(d.isImmutableArray(a[0])){g=d.defaultUndefined(a[2],"");for(k=0;k<a[0].length();k++)b[k]=d.toStringExplicit(a[0].get(k),
g);return 1<a.length?b.join(a[1]):b.join("")}for(g=0;g<a.length;g++)b[g]=d.toStringExplicit(a[g]);return b.join("")})};c.reverse=function(f,h){return e(f,h,function(b,g,a){d.pcCheck(a,1,1);if(d.isArray(a[0]))return b=a[0].slice(0),b.reverse(),b;if(d.isImmutableArray(a[0]))return b=a[0].toArray().slice(0),b.reverse(),b;throw Error("Invalid Parameter");})};c.replace=function(f,h){return e(f,h,function(b,g,a){d.pcCheck(a,3,4);b=d.toString(a[0]);g=d.toString(a[1]);const k=d.toString(a[2]);return(4===
a.length?d.toBoolean(a[3]):1)?d.multiReplace(b,g,k):b.replace(g,k)})};c.schema=function(f,h){return e(f,h,function(b,g,a){if(d.isFeature(a[0]))return(b=d.featureSchema(a[0]))?q.convertObjectToArcadeDictionary(b):null;throw Error("Invalid Parameter");})};c.subtypes=function(f,h){return e(f,h,function(b,g,a){d.pcCheck(a,1,1);if(d.isFeature(a[0]))return(b=d.featureSubtypes(a[0]))?q.convertObjectToArcadeDictionary(b):null;throw Error("Invalid Parameter");})};c.subtypecode=function(f,h){return e(f,h,function(b,
g,a){d.pcCheck(a,1,1);if(d.isFeature(a[0])){b=d.featureSubtypes(a[0]);if(!b)return null;if(b.subtypeField&&a[0].hasField(b.subtypeField)){a=a[0].field(b.subtypeField);for(const k of b.subtypes)if(k.code===a)return k.code}return null}throw Error("Invalid Parameter");})};c.subtypename=function(f,h){return e(f,h,function(b,g,a){d.pcCheck(a,1,1);if(d.isFeature(a[0])){b=d.featureSubtypes(a[0]);if(!b)return"";if(b.subtypeField&&a[0].hasField(b.subtypeField)){a=a[0].field(b.subtypeField);for(const k of b.subtypes)if(k.code===
a)return k.name}return""}throw Error("Invalid Parameter");})};c.gdbversion=function(f,h){return e(f,h,function(b,g,a){d.pcCheck(a,1,1);if(d.isFeature(a[0]))return a[0].gdbVersion();throw Error("Invalid Parameter");})};c.domain=function(f,h){return e(f,h,function(b,g,a){d.pcCheck(a,2,3);if(d.isFeature(a[0]))return(b=d.featureFullDomain(a[0],d.toString(a[1]),void 0===a[2]?void 0:d.toNumber(a[2])))&&b.domain?"coded-value"===b.domain.type||"codedValue"===b.domain.type?q.convertObjectToArcadeDictionary({type:"codedValue",
name:b.domain.name,dataType:u.layerFieldEsriConstants[b.field.type],codedValues:b.domain.codedValues.map(k=>({name:k.name,code:k.code}))}):q.convertObjectToArcadeDictionary({type:"range",name:b.domain.name,dataType:u.layerFieldEsriConstants[b.field.type],min:b.domain.min,max:b.domain.max}):null;throw Error("Invalid Parameter");})};c.domainname=function(f,h){return e(f,h,function(b,g,a){d.pcCheck(a,2,4);if(d.isFeature(a[0]))return d.featureDomainValueLookup(a[0],d.toString(a[1]),a[2],void 0===a[3]?
void 0:d.toNumber(a[3]));throw Error("Invalid Parameter");})};c.domaincode=function(f,h){return e(f,h,function(b,g,a){d.pcCheck(a,2,4);if(d.isFeature(a[0]))return d.featureDomainCodeLookup(a[0],d.toString(a[1]),a[2],void 0===a[3]?void 0:d.toNumber(a[3]));throw Error("Invalid Parameter");})};c.urlencode=function(f,h){return e(f,h,function(b,g,a){d.pcCheck(a,1,1);if(null===a[0])return"";if(a[0]instanceof q){b="";for(const k of a[0].keys())g=a[0].field(k),""!==b&&(b+="\x26"),b=null===g?b+(encodeURIComponent(k)+
"\x3d"):b+(encodeURIComponent(k)+"\x3d"+encodeURIComponent(g));return b}return encodeURIComponent(d.toString(a[0]))})};c.hash=function(f,h){return e(f,h,function(b,g,a){d.pcCheck(a,1,1);b=new y.XXH(0);m(a[0],b,{map:new Map,currentLength:0});return b.digest()})};c.convertdirection=function(f,h){return e(f,h,function(b,g,a){d.pcCheck(a,3,3);return x.convertDirection(a[0],a[1],a[2])})};c.fromjson=function(f,h){return e(f,h,function(b,g,a){d.pcCheck(a,1,1);if(!1===d.isString(a[0]))throw Error("Invalid Parameter");
return q.convertJsonToArcade(JSON.parse(d.toString(a[0])))})};c.expects=function(f,h){return e(f,h,function(b,g,a){if(1>a.length)throw Error("Function called with wrong number of Parameters");return d.voidOperation})};c.tocharcode=function(f,h){return e(f,h,function(b,g,a){d.pcCheck(a,1,2);b=d.toNumber(d.defaultUndefined(a[1],0));g=d.toString(a[0]);if(0===g.length&&1===a.length)return null;if(g.length<=b||0>b)throw Error("Illegal argument");return g.charCodeAt(b)})};c.tocodepoint=function(f,h){return e(f,
h,function(b,g,a){d.pcCheck(a,1,2);b=d.toNumber(d.defaultUndefined(a[1],0));g=d.toString(a[0]);if(0===g.length&&1===a.length)return null;if(g.length<=b||0>b)throw Error("Illegal argument");return g.codePointAt(b)})};c.fromcharcode=function(f,h){return e(f,h,function(b,g,a){if(1>a.length)throw Error("Function called with wrong number of Parameters");b=a.map(k=>Math.trunc(d.toNumber(k))).filter(k=>0<=k&&65535>=k);return 0===b.length?null:String.fromCharCode.apply(null,b)})};c.fromcodepoint=function(f,
h){return e(f,h,function(b,g,a){if(1>a.length)throw Error("Function called with wrong number of Parameters");let k;try{k=a.map(l=>Math.trunc(d.toNumber(l))).filter(l=>1114111>=l&&l>>>0===l)}catch(l){return null}return 0===k.length?null:String.fromCodePoint.apply(null,k)})}};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});