// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/has ../../../../../core/Evented ../../../../../core/HandleOwner ../../../../../core/Handles ../../../../../core/handleUtils ../../../../../core/maybe ../../../../../core/quantityUtils ../../../../../core/reactiveUtils ../../../../../core/unitUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/arrayUtils ../../../../../core/accessorSupport/ensureType ../../../../../core/accessorSupport/decorators/subclass ../../../../../chunks/mat4f64 ../../../../../chunks/vec3 ../../../../../chunks/vec3f64 ../../../../../geometry/Polyline ../../../../../geometry/support/plane ../../../../../geometry/support/vectorStacks ../../../../../layers/graphics/dehydratedFeatures ../../../../../support/elevationInfoUtils ../../../../../symbols/support/utils ../../Manipulator3D ../../manipulatorUtils ../../SegmentLabels3D ../../SnappingVisualizer3D ../dragEventPipeline3D ../ManipulatorType ../manipulatorUtils ../settings ../visualElementUtils ../manipulations/config ../manipulations/MoveManipulation ../manipulations/moveUtils ../manipulations/MoveXYGraphicManipulation ./edgeOffsetUtils ../../visualElements/OutlineVisualElement ../../../layers/graphics/GraphicState ../../../webgl-engine/lib/GeometryUtil ../../../../input/IViewEvents ../../../../interactive/dragEventPipeline ../../../../interactive/interfaces ../../../../interactive/editGeometry/EditGeometryOperations ../../../../interactive/editGeometry/interfaces ../../../../interactive/snapping/SnappingContext ../../../../interactive/snapping/SnappingDragPipelineStep ../../../../interactive/tooltip/ReshapeTooltipInfos ../../../../interactive/tooltip/Tooltip ../../../../interactive/tooltip/TranslateTooltipInfos ../../../../support/automaticAreaMeasurementUtils ../../../../support/automaticLengthMeasurementUtils ../../../../support/euclideanLengthMeasurementUtils ../../../../support/geodesicLengthMeasurementUtils".split(" "),
function(u,Y,w,Da,ka,la,ma,J,g,M,B,na,y,Ea,Fa,oa,pa,F,Z,qa,ra,sa,aa,K,ba,Q,C,ta,ca,N,R,S,m,ua,va,z,wa,xa,G,da,ya,H,ea,D,r,za,T,fa,ha,ia,Aa,U,Ba,V,W,Ca){u.ReshapeOperation=function(x){function O(a){a=x.call(this,a)||this;a._vertexManipulatorMaterial=C.createManipulatorMaterial(m.settings.colorToVec4(m.settings.reshapeManipulators.vertex.color),m.settings.reshapeManipulators.vertex.renderOccluded);a._vertexManipulatorOutlineMaterial=C.createManipulatorOutlineMaterial(m.settings.colorToVec4(m.settings.reshapeManipulators.vertex.outlineColor),
m.settings.reshapeManipulators.vertex.renderOccluded);a._vertexManipulatorHoverOutlineMaterial=C.createManipulatorOutlineMaterial(m.settings.colorToVec4(m.settings.reshapeManipulators.vertex.hoverOutlineColor),m.settings.reshapeManipulators.vertex.renderOccluded);a._edgeManipulatorMaterial=C.createManipulatorMaterial(m.settings.colorToVec4(m.settings.reshapeManipulators.edge.color),m.settings.reshapeManipulators.edge.renderOccluded);a._edgeManipulatorOutlineMaterial=C.createManipulatorOutlineMaterial(m.settings.colorToVec4(m.settings.reshapeManipulators.edge.outlineColor),
m.settings.reshapeManipulators.edge.renderOccluded);a._edgeOffsetManipulatorMaterial=C.createManipulatorMaterial(m.settings.colorToVec4(m.settings.reshapeManipulators.edgeOffset.color),m.settings.reshapeManipulators.edgeOffset.renderOccluded,!1);a._edgeOffsetManipulatorHoverMaterial=C.createManipulatorMaterial(m.settings.colorToVec4(m.settings.reshapeManipulators.edgeOffset.hoverColor),m.settings.reshapeManipulators.edgeOffset.renderOccluded,!1);a._selectedManipulatorMaterial=C.createManipulatorMaterial(m.settings.colorToVec4(m.settings.reshapeManipulators.selected.color),
m.settings.reshapeManipulators.selected.renderOccluded);a._selectedManipulatorOutlineMaterial=C.createManipulatorOutlineMaterial(m.settings.colorToVec4(m.settings.reshapeManipulators.selected.outlineColor),m.settings.reshapeManipulators.selected.renderOccluded);a._selectedManipulatorHoverOutlineMaterial=C.createManipulatorOutlineMaterial(m.settings.colorToVec4(m.settings.reshapeManipulators.selected.hoverOutlineColor),m.settings.reshapeManipulators.selected.renderOccluded);a._selectedIndex=0;a._vertexManipulatorGeometry=
null;a._vertexManipulatorOutlineGeometry=null;a._edgeManipulatorGeometry=null;a._edgeManipulatorOutlineGeometry=null;a._edgeOffsetManipulatorGeometryInside=null;a._edgeOffsetManipulatorGeometryOutside=null;a._manipulatorHandles=new ma;a._manipulatorInfos=[];a._editGeometryOperations=null;a._graphicMoveManipulation=null;a._moveManipulation=null;a._numGrabbing=0;a._numDragging=0;a._reshapeEventState=t.NONE;a._outlineVisualElement=null;a._segmentLabels=null;a.outputGeometry=null;a._snappingPipeline=
new ha.SnappingPipeline;a._snappingPipelineHandle=new ha.SnappingPipeline;a._vertexLaserLineVisualElement=null;return a}Y._inheritsLoose(O,x);var k=O.prototype;k.initialize=function(){const {graphic:a,view:b}=this,d=this._graphicState=new ya.GraphicState({graphic:a});this._tooltip=new Aa.Tooltip({view:b});this.own([B.watch(()=>d.displaying,c=>{for(const e of this._manipulatorInfos)e.manipulator.available=c}),B.watch(()=>({labels:this._segmentLabels,enabled:this._labelOptions.enabled,edgeOffsetEnabled:this.enableEdgeOffset}),
({labels:c,enabled:e,edgeOffsetEnabled:f})=>{g.isSome(c)&&(c.visible=e,c.edgeDistance=f?"far":"default")},B.initial),B.when(()=>!this._tooltipOptions.enabled,()=>this._tooltip.clear(),B.initial),this.view.trackGraphicState(d)])};k.destroy=function(){this._segmentLabels=g.destroyMaybe(this._segmentLabels);this._tooltip=g.destroyMaybe(this._tooltip);this._editGeometryOperations=g.destroyMaybe(this._editGeometryOperations);this._moveManipulation=g.destroyMaybe(this._moveManipulation);this._graphicMoveManipulation=
g.destroyMaybe(this._graphicMoveManipulation);this._manipulatorHandles=g.destroyMaybe(this._manipulatorHandles);this.manipulators.removeAll();this._manipulatorInfos=[];this._resetGrabbingDragging()};k.removeSelectedVertices=function(){const a=this._manipulatorInfos.filter(b=>b.manipulator.selected&&"vertex"===b.type);this._removeVertices(a)};k.manipulatorSelectionChanged=function(){this.emit("manipulators-changed")};k._removeManipulators=function(){this._moveManipulation=g.destroyMaybe(this._moveManipulation);
this._graphicMoveManipulation=g.destroyMaybe(this._graphicMoveManipulation);this._manipulatorHandles.removeAll();this.manipulators.removeAll();this._manipulatorInfos=[]};k._resetGrabbingDragging=function(){this._numDragging=this._numGrabbing=0};k._createManipulators=function(){if(!g.isNone(this._editGeometryOperations)){var a=K.getGraphicEffectiveElevationInfo(this.graphic);for(const b of this._editGeometryOperations.data.components){for(const d of b.vertices)this._createVertexOrEdgeManipulator(d,
a);for(const d of b.edges)this._createVertexOrEdgeManipulator(d,a)}this._createGraphicMoveManipulators(a)}};k.redo=function(){if(g.isNone(this._editGeometryOperations))return null;const a=this._editGeometryOperations.redo();g.isSome(a)&&(this.outputGeometry=this._editGeometryOperations.data.geometry,this._recreateManipulators());return a};k.undo=function(){if(g.isNone(this._editGeometryOperations))return null;this.emit("undo");const a=this._editGeometryOperations.undo();g.isSome(a)&&(this.outputGeometry=
this._editGeometryOperations.data.geometry,this._recreateManipulators());return a};k._recreateManipulators=function(){this._removeManipulators();this._resetGrabbingDragging();this._tooltip.clear();this._createManipulators()};k._recreateEditGeometryAndManipulators=function(a=this.inputGeometry){this._removeManipulators();this._resetGrabbingDragging();this._tooltip.clear();g.isNone(a)||(g.destroyMaybe(this._editGeometryOperations),this._editGeometryOperations=za.EditGeometryOperations.fromGeometry(a,
this.view.state.viewingMode),this._createManipulators(),g.destroyMaybe(this._segmentLabels),this._segmentLabels=new ta.SegmentLabels3D({context:{view:this.view,editGeometryOperations:this._editGeometryOperations,elevationInfo:K.getGraphicEffectiveElevationInfo(this.graphic),labelOptions:this._labelOptions,graphic:this.graphic,graphicState:this._graphicState},visible:this._labelOptions.enabled}))};k._perGraphicManipulatorDragAction=function(a,b){if("end"===b.action)return b;let d=0;const c=[],e=this._manipulatorInfos.some(f=>
"vertex"===f.type&&f.manipulator.selected);a=a===I.SELECTED_OR_ALL&&e;for(const f of this._manipulatorInfos)"vertex"===f.type&&(f.manipulator.grabbing||a&&!f.manipulator.selected||c.push(f),d++);if(0===c.length)return b;this._moveVertices(c,b);if(c.length===d){this._updateEventState(t.MOVING);if(this.destroyed)return b;this.emit("move",{type:"move",dx:b.screenDeltaX,dy:b.screenDeltaY,mover:this.graphic})}else{this._updateEventState(t.RESHAPING);if(this.destroyed)return b;this.emit("reshape",{type:"reshape",
mover:this.graphic})}return b};k._isMultiVertexSelection=function(){let a=0;for(const b of this._manipulatorInfos)"vertex"===b.type&&b.manipulator.selected&&a++;return 1<a};k._perVertexManipulatorDragAction=function(a){this._updateEventState(t.RESHAPING);if(!this.destroyed){var {mapDeltaX:b,mapDeltaY:d,mapDeltaZ:c}=a;if(b||d||c){var e=[];for(const f of this._manipulatorInfos)"vertex"===f.type&&(f.manipulator.selected&&!f.manipulator.grabbing||f===a.info)&&e.push(f);this._moveVertices(e,a,T.AccumulationBehaviour.ACCUMULATE_STEPS);
this.emit("reshape",{type:"reshape",mover:this.graphic})}}};k._updateEventState=function(a){if(a===this._reshapeEventState)return!1;switch(a){case t.NONE:if(0!==this._numGrabbing||0!==this._numDragging)return!1;switch(this._reshapeEventState){case t.MOVING:this.emit("move",{type:"move-stop",dx:0,dy:0,mover:this.graphic});break;case t.RESHAPING:this.emit("reshape",{type:"reshape-stop",mover:this.graphic})}break;case t.MOVING:switch(this._reshapeEventState){case t.NONE:this.emit("move",{type:"move-start",
dx:0,dy:0,mover:this.graphic});break;case t.RESHAPING:this.emit("reshape",{type:"reshape-stop",mover:this.graphic}),this.destroyed||this.emit("move",{type:"move-start",dx:0,dy:0,mover:this.graphic})}break;case t.RESHAPING:switch(this._reshapeEventState){case t.NONE:this.emit("reshape",{type:"reshape-start",mover:this.graphic});break;case t.MOVING:this.emit("move",{type:"move-stop",dx:0,dy:0,mover:this.graphic}),this.destroyed||this.emit("reshape",{type:"reshape-start",mover:this.graphic})}}if(this.destroyed)return!1;
const b=this._reshapeEventState!==a;this._reshapeEventState=a;return b};k._createGraphicMoveManipulators=function(a){const {graphic:b,handles:d,tool:c,view:e}=this,f=this._graphicState;this._graphicMoveManipulation=new xa.MoveXYGraphicManipulation({tool:c,view:e,graphicState:f});if(this.enableMoveGraphic){let h=null;this._manipulatorHandles.add(this._graphicMoveManipulation.createDragPipeline((p,n,v)=>{n.next(q=>this._trackNumDragging(q)).next(q=>{"start"===q.action&&(h=g.unwrap(this._editGeometryOperations).createUndoGroup());
return q}).next(q=>this._perGraphicManipulatorDragAction(I.ALL,q)).next(q=>{this._updateTranslateGraphicTooltip(z.ManipulationType.XY,q);return q}).next(q=>{"end"===q.action&&(this._tooltip.clear(),h=g.removeMaybe(h))});v.next(this._cancelDragOperation(()=>h=g.removeMaybe(h)))}))}else this._graphicMoveManipulation.forEachManipulator(h=>{h.grabbable=!1;h.cursor=null});this._graphicMoveManipulation.forEachManipulator(h=>this._manipulatorHandles.add([this._watchAndUpdateGrabState(h,!1),h.events.on("immediate-click",
p=>{this._manipulatorInfos.some(n=>n.manipulator.selected)?this._clearSelection():this.emit("immediate-click",{...p,graphic:this.graphic});p.stopPropagation()})]));this._moveManipulation=new z.MoveManipulation({tool:c,view:e,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:this.enableZShape&&S.canMoveZ(b),snapToScene:!1,radius:z.MoveManipulation.radiusForSymbol(b.symbol)});this._moveManipulation.forEachManipulator((h,p)=>{d.add([this._watchAndUpdateGrabState(h,!1),h.events.on("immediate-click",n=>{this._moveManipulation.zManipulation.hasManipulator(h)||
this._manipulatorInfos.some(v=>v.manipulator.selected)||this.emit("immediate-click",{...n,graphic:b});n.stopPropagation()})]);d.add(h.events.on("focus-changed",({action:n})=>{"focus"===n&&this._tooltipOptions.enabled?this._updateTranslateTooltip(p===R.ManipulatorType.TRANSLATE_Z?z.ManipulationType.Z:z.ManipulationType.XY):this._tooltip.clear()}))});this._moveManipulation.elevationInfo={mode:"absolute-height",offset:0};var l=g.unwrap(b.geometry).spatialReference;d.add([this._moveManipulation.createDragPipeline((h,
p,n,v,q)=>{p=n.next(A=>this._trackNumDragging(A)).next(A=>{const X=this._manipulatorInfos.filter(ja=>"vertex"===ja.type&&ja.manipulator.selected);return A.manipulatorType===R.ManipulatorType.TRANSLATE_XY&&1===X.length?{...A,info:X[0],snapOrigin:X[0].handle.pos}:{...A,info:null}}).next(this._snappingPipelineHandle.createSnapDragEventPipelineStep({predicate:A=>!!A.info,cancel:v,snappingManager:c.snappingManager,snappingContext:new fa.SnappingContext({editGeometryOperations:g.unwrap(this._editGeometryOperations),
elevationInfo:a,pointer:q,excludeFeature:b,visualizer:new ca.SnappingVisualizer3D}),updatingHandles:this.updatingHandles}),this._snappingPipelineHandle.next).next(D.addMapDelta()).next(A=>this._perGraphicManipulatorDragAction(I.SELECTED_OR_ALL,A)).next(A=>{this._updateTranslateTooltip(h,A);return A});v.next(this._cancelDragOperation());return p},a,l,b),B.watch(()=>null==f?void 0:f.displaying,()=>{this._updateMoveManipulationPosition()},B.initial),f.on("changed",()=>this._updateMoveManipulationPosition()),
B.watch(()=>null==f?void 0:f.isDraped,h=>{h?d.add(this.view.elevationProvider.on("elevation-change",()=>this._updateMoveManipulationPosition()),"align-move-manipulation"):d.remove("align-move-manipulation")},B.initial)]);this._updateMoveManipulationPosition();l=ua.createVisualElements({view:e,graphic:b,forEachManipulator:h=>{if(!this.destroyed){g.isSome(this._graphicMoveManipulation)&&this._graphicMoveManipulation.forEachManipulator(h);for(const p of this._manipulatorInfos)h(p.manipulator,R.ManipulatorType.TRANSLATE_XY);
this._moveManipulation.forEachManipulator(h)}},onManipulatorsChanged:h=>this.on("manipulators-changed",h)});g.isSome(l)&&(this._outlineVisualElement=l.visualElement instanceof da.OutlineVisualElement?l.visualElement:null);g.isSome(this._outlineVisualElement)&&this._manipulatorHandles.add([this._outlineVisualElement.events.on("attachment-origin-changed",()=>{f.isDraped||this._updateMoveManipulationPosition()}),B.watch(()=>f.isDraped,()=>this._updateMoveManipulationPosition())]);this._manipulatorHandles.add(l)};
k._createEdgeOffsetManipulator=function(a,b=K.getGraphicEffectiveElevationInfo(this.graphic)){var d=m.settings.reshapeManipulators.edgeOffset,c=d.size/2,e=c+d.collisionPadding;if(g.isNone(this._edgeOffsetManipulatorGeometryInside)||g.isNone(this._edgeOffsetManipulatorGeometryOutside)){c/=e;const l=c*Math.sqrt(3)/2;this._edgeOffsetManipulatorGeometryInside=H.createExtrudedTriangle(l,c/2,c/2,d.height,d.offset);this._edgeOffsetManipulatorGeometryOutside=H.createExtrudedTriangle(-l,c/2,c/2,d.height,-d.offset)}e=
new Q.Manipulator3D({view:this.view,renderObjects:[{geometry:this._edgeOffsetManipulatorGeometryInside,material:this._edgeOffsetManipulatorMaterial,stateMask:r.ManipulatorStateFlags.Unfocused},{geometry:this._edgeOffsetManipulatorGeometryInside,material:this._edgeOffsetManipulatorHoverMaterial,stateMask:r.ManipulatorStateFlags.Focused},{geometry:this._edgeOffsetManipulatorGeometryOutside,material:this._edgeOffsetManipulatorMaterial,stateMask:r.ManipulatorStateFlags.Unfocused},{geometry:this._edgeOffsetManipulatorGeometryOutside,
material:this._edgeOffsetManipulatorHoverMaterial,stateMask:r.ManipulatorStateFlags.Focused}],elevationInfo:"on-the-ground"!==b.mode||ba.isVolumetricSymbol(this.graphic.symbol)?{mode:"absolute-height",offset:0}:b,worldOriented:!1,focusMultiplier:1,radius:e,available:!(!this.graphic.visible||!this.graphic.layer.visible),collisionType:{type:"disc",direction:Z.fromValues(0,0,1)},collisionPriority:1});c=new Q.Manipulator3D({view:this.view,renderObjects:[],worldSized:!0,worldOriented:!1,available:!(!this.graphic.visible||
!this.graphic.layer.visible),collisionPriority:-10,cursor:this.enableMoveGraphic?"move":"default"});const f={manipulator:e,handle:a,locationUpdateHandle:null,type:"edge",selectedIndex:0,edgeManipulator:c,elevationInfo:b,visibilityHandle:null};this._autoHideEdgeOffsetManipulator(f,d.minSquaredEdgeLength);this._updateEdgeOffsetManipulator(f);a=this._getManipulatorInfoFromHandle(f.handle.leftVertex).manipulator.events.on("location-update",()=>this._updateEdgeOffsetManipulator(f));d=this._getManipulatorInfoFromHandle(f.handle.rightVertex).manipulator.events.on("location-update",
()=>this._updateEdgeOffsetManipulator(f));f.locationUpdateHandle=J.handlesGroup([a,d]);this._manipulatorHandles.add(f.locationUpdateHandle,e);this._manipulatorHandles.add([this._watchAndUpdateGrabState(e,!0),this._watchAndUpdateGrabState(c,!0)],e);this._manipulatorHandles.add(D.createManipulatorDragEventPipeline(e,this._createEdgeOffsetPipeline(f,b)),e);this._manipulatorHandles.add(D.createManipulatorDragEventPipeline(c,(l,h,p,n)=>{if("touch"===n)this._createEdgeOffsetPipeline(f,b)(l,h,p);else if(this.enableMoveGraphic){n=
this.graphic;const v=g.isSome(n.geometry)?n.geometry.spatialReference:null;h.next(q=>this._trackNumDragging(q)).next(D.dragAtLocation(this.view,l.elevationAlignedLocation)).next(N.screenToMapXYAtLocation(this.view,l.elevationAlignedLocation,b,v,n)).next(D.addScreenDelta()).next(D.addMapDelta()).next(q=>this._perGraphicManipulatorDragAction(I.ALL,q)).next(q=>{this._updateTranslateGraphicTooltip(z.ManipulationType.XY,q);return q}).next(q=>{"end"===q.action&&this._tooltip.clear()});p.next(this._cancelDragOperation())}}),
e);a=l=>{this._manipulatorInfos.some(h=>h.manipulator.selected)?this._clearSelection():this.emit("immediate-click",{...l,graphic:this.graphic});l.stopPropagation()};this._manipulatorHandles.add([e.events.on("immediate-click",a),c.events.on("immediate-click",a),e.events.on("focus-changed",({action:l})=>{const h=this._tooltipOptions;"focus"===l&&h.enabled?this._tooltip.info=new ia.ReshapeEdgeOffsetTooltipInfo({tooltipOptions:h}):this._tooltip.clear()})],e);this._manipulatorInfos.push(f);this.manipulators.add(e);
this.manipulators.add(c);this.emit("manipulators-changed");return f};k._autoHideEdgeOffsetManipulator=function(a,b){const d=a.manipulator,c=a.edgeManipulator,e=()=>{g.removeMaybe(a.visibilityHandle);const f=G.screenEdgeLengthSquared(this._getManipulatorInfoFromHandle(a.handle.leftVertex).manipulator.renderLocation,this._getManipulatorInfoFromHandle(a.handle.rightVertex).manipulator.renderLocation,this.view.state.camera)<b;if(!d.focused&&!c.focused||f)d.grabbable=!f,c.grabbable=!f,a.visibilityHandle=
J.handlesGroup([d.disableDisplay(),{remove:()=>{d.grabbable=!0;c.grabbable=this.enableMoveGraphic}}])};this._manipulatorHandles.add([d.events.on("focus-changed",e),c.events.on("focus-changed",e),{remove:()=>{g.removeMaybe(a.visibilityHandle);this.manipulators.remove(c)}}],d);e()};k._updateEdgeOffsetManipulator=function(a){this._updateManipulatorPosition(a);var b=g.unwrap(this._editGeometryOperations).data.coordinateHelper,d=G.createEdgeOffsetIntersectionPlane(this.view,a.manipulator.elevationAlignedLocation,
G.createEdgeOffsetOperation(b,a.handle,g.unwrap(a.manipulator.elevationInfo)));b=this._getManipulatorInfoFromHandle(a.handle.leftVertex).manipulator.renderLocation;const c=this._getManipulatorInfoFromHandle(a.handle.rightVertex).manipulator.renderLocation;d=g.isSome(d)?G.edgeOffsetRotationMatrix(d,b,c):pa.IDENTITY;a.manipulator.modelTransform=d;a.edgeManipulator.elevationAlignedLocation=a.manipulator.elevationAlignedLocation;a.edgeManipulator.modelTransform=d;b=F.length(F.subtract(P,b,c))/2;a.edgeManipulator.collisionType=
{type:"line",paths:[[[-b,0,0],[b,0,0]]]}};k._createEdgeOffsetPipeline=function(a,b){return(d,c,e)=>{this._clearSelection();const {step:f,cleanup:l}=this._initializeEdgeOffset(a,b);c.next(h=>this._trackNumDragging(h)).next(D.dragAtLocation(this.view,d.elevationAlignedLocation)).next(f).next(N.screenToRenderPlaneFromEvent(this.view)).next(N.convertToMapCoordinates(this.view,g.unwrap(this._editGeometryOperations).data.spatialReference)).next(D.addMapDelta()).next(this._applyComputeEdgeOffsetDistanceStep()).next(this._applyEdgeOffsetStep(a)).next(this._showEdgeOffsetTooltip()).next(h=>
{"end"===h.action&&l()});e.next(h=>{l();return h}).next(h=>{this._tooltip.clear();return h}).next(this._cancelDragOperation())}};k._initializeEdgeOffset=function(a,b){var d=g.unwrap(this._editGeometryOperations);const c=G.createEdgeOffsetOperation(d.data.coordinateHelper,a.handle,b);b=d.createUndoGroup();const e=G.createEdgeOffsetIntersectionPlane(this.view,a.manipulator.elevationAlignedLocation,c);c.requiresSplitEdgeLeft&&this._splitEdgeManipulator(this._getManipulatorInfoFromHandle(a.handle.leftVertex.leftEdge),
1);c.requiresSplitEdgeRight&&this._splitEdgeManipulator(this._getManipulatorInfoFromHandle(a.handle.rightVertex.rightEdge),0);const f=()=>new qa({paths:[[a.handle.leftVertex.pos,a.handle.rightVertex.pos]],spatialReference:g.unwrap(this._editGeometryOperations).data.spatialReference}),l=new da.OutlineVisualElement({view:this.view,isDraped:this._graphicState.isDraped,geometry:f(),elevationInfo:a.elevationInfo,width:m.settings.visualElements.lineGraphics.outline.width,color:m.settings.colorToVec4(m.colors.main),
attached:!0});let h;const p=()=>{this._cleanEdgeOffsetCollapsedEdges(a);h=g.removeMaybe(h)};d=this.on("undo",p);h=J.handlesGroup([J.destroyHandle(l),B.watch(()=>this._graphicState.isDraped,n=>l.isDraped=n),this._graphicState.on("changed",()=>l.geometry=f()),b,d]);return{step:n=>g.isNone(c)||g.isNone(e)?(p(),null):{...n,operation:c,plane:e},cleanup:p}};k._applyEdgeOffsetStep=function(a){return b=>{if(this.destroyed||g.isNone(b.operation))return b;this._updateEventState(t.RESHAPING);const {mapDeltaX:d,
mapDeltaY:c,mapDeltaZ:e}=b;if(d||c||e)this._offsetEdge(a,b),this.emit("reshape",{type:"reshape",mover:this.graphic});return b}};k._applyComputeEdgeOffsetDistanceStep=function(){return a=>{const {operation:b,mapEnd:d}=a;if(g.isNone(b)||g.isNone(d))return a;const c=b.signedDistanceToPoint(d);return{...a,signedDistance:c}}};k._showEdgeOffsetTooltip=function(){return a=>{const {mapEnd:b,signedDistance:d,operation:c}=a,e=this._tooltip,f=this._tooltipOptions;if(!f.enabled||g.isNone(d))return e.clear(),
a;a:{var l=-d;var h=c.plane,p=g.unwrap(this._editGeometryOperations).data.coordinateHelper;if(this._graphicState.isDraped){const n=p.toXYZ(p.pointToVector(b));h=ra.projectPoint(h,n,sa.sv3d.get());p=Ca.geodesicDistance(h,n,p.spatialReference);if(g.isSome(p)){l=M.createLength(p.value*Math.sign(l),p.unit);break a}}l=M.createLength(l*na.getMetersPerUnitForSR(b.spatialReference),"meters")}g.isNone(e.info)||"reshape-edge-offset"!==e.info.type?e.info=new ia.ReshapeEdgeOffsetTooltipInfo({tooltipOptions:f,
distance:l}):e.info.distance=l;return a}};k._cleanEdgeOffsetCollapsedEdges=function(a){var b,d;const c=null==(b=a.handle.leftVertex.leftEdge)?void 0:b.leftVertex;b=a.handle.leftVertex;const e=null==(d=a.handle.rightVertex.rightEdge)?void 0:d.rightVertex;a=a.handle.rightVertex;d=g.unwrap(this._editGeometryOperations).data.coordinateHelper;const f=[];c&&1E-6>d.distance(c.pos,b.pos)&&f.push(this._getManipulatorInfoFromHandle(b));(1E-6>d.distance(b.pos,a.pos)||e&&1E-6>d.distance(e.pos,a.pos))&&f.push(this._getManipulatorInfoFromHandle(a));
f.length&&this._removeVertices(f)};k._computeVertexManipulatorSizeAndOutline=function(a){const b=a.size/2,d=b+a.collisionPadding;return{size:b/d,outlineSize:(b+a.outlineSize)/d}};k._createVertexOrEdgeManipulator=function(a,b=K.getGraphicEffectiveElevationInfo(this.graphic)){if("edge"===a.type){if(this.enableEdgeOffset)return this._createEdgeOffsetManipulator(a,b);if(!this.enableMidpoints)return null}if(g.isNone(this._vertexManipulatorGeometry)||g.isNone(this._vertexManipulatorOutlineGeometry)){const {size:f,
outlineSize:l}=this._computeVertexManipulatorSizeAndOutline(m.settings.reshapeManipulators.vertex);this._vertexManipulatorGeometry=H.createSphereGeometry(f,16,16);this._vertexManipulatorOutlineGeometry=H.createSphereGeometry(l,16,16)}if(g.isNone(this._edgeManipulatorGeometry)||g.isNone(this._edgeManipulatorOutlineGeometry)){const {size:f,outlineSize:l}=this._computeVertexManipulatorSizeAndOutline(m.settings.reshapeManipulators.edge);this._edgeManipulatorGeometry=H.createSphereGeometry(f,16,16);this._edgeManipulatorOutlineGeometry=
H.createSphereGeometry(l,16,16)}var d=g.isSome(this.graphic.geometry)&&"point"===this.graphic.geometry.type?[]:[{geometry:this._vertexManipulatorGeometry,material:this._vertexManipulatorMaterial,stateMask:E.Vertex|r.ManipulatorStateFlags.Unselected},{geometry:this._vertexManipulatorOutlineGeometry,material:this._vertexManipulatorOutlineMaterial,stateMask:E.Vertex|r.ManipulatorStateFlags.Unfocused|r.ManipulatorStateFlags.Unselected},{geometry:this._vertexManipulatorOutlineGeometry,material:this._vertexManipulatorHoverOutlineMaterial,
stateMask:E.Vertex|r.ManipulatorStateFlags.Focused|r.ManipulatorStateFlags.Unselected},{geometry:this._vertexManipulatorGeometry,material:this._selectedManipulatorMaterial,stateMask:r.ManipulatorStateFlags.Selected},{geometry:this._vertexManipulatorOutlineGeometry,material:this._selectedManipulatorOutlineMaterial,stateMask:r.ManipulatorStateFlags.Selected|r.ManipulatorStateFlags.Unfocused},{geometry:this._vertexManipulatorOutlineGeometry,material:this._selectedManipulatorHoverOutlineMaterial,stateMask:r.ManipulatorStateFlags.Selected|
r.ManipulatorStateFlags.Focused}];this.enableMidpoints&&d.push({geometry:this._edgeManipulatorGeometry,material:this._vertexManipulatorMaterial,stateMask:E.Edge|r.ManipulatorStateFlags.Focused|r.ManipulatorStateFlags.Unselected},{geometry:this._edgeManipulatorOutlineGeometry,material:this._vertexManipulatorHoverOutlineMaterial,stateMask:E.Edge|r.ManipulatorStateFlags.Focused|r.ManipulatorStateFlags.Unselected},{geometry:this._edgeManipulatorGeometry,material:this._edgeManipulatorMaterial,stateMask:E.Edge|
r.ManipulatorStateFlags.Unfocused|r.ManipulatorStateFlags.Unselected},{geometry:this._edgeManipulatorOutlineGeometry,material:this._edgeManipulatorOutlineMaterial,stateMask:E.Edge|r.ManipulatorStateFlags.Unfocused|r.ManipulatorStateFlags.Unselected});const c=new Q.Manipulator3D({view:this.view,renderObjects:d,elevationInfo:b,focusMultiplier:1,touchMultiplier:1,available:!(!this.graphic.visible||!this.graphic.layer.visible)});this._setTypeSpecificManipulatorSettings(c,a,b);const e="edge"===a.type?
{manipulator:c,handle:a,locationUpdateHandle:null,type:"edge",selectedIndex:0}:{manipulator:c,handle:a,type:"vertex",selectedIndex:0};this._manipulatorInfos.push(e);this.manipulators.add(c);this._updateManipulatorPosition(e);"edge"===e.type&&(a=this._getManipulatorInfoFromHandle(e.handle.leftVertex).manipulator.events.on("location-update",()=>this._updateManipulatorPosition(e)),d=this._getManipulatorInfoFromHandle(e.handle.rightVertex).manipulator.events.on("location-update",()=>this._updateManipulatorPosition(e)),
e.locationUpdateHandle=J.handlesGroup([a,d]),this._manipulatorHandles.add(e.locationUpdateHandle,c));this._manipulatorHandles.add(this._watchAndUpdateGrabState(c,!0),c);a=D.createManipulatorDragEventPipeline(c,(f,l,h,p)=>{let n=null;l.next(v=>this._trackNumDragging(v)).next(v=>{"start"===v.action&&(n=g.unwrap(this._editGeometryOperations).createUndoGroup());if("edge"===e.type){const q=this._splitEdgeManipulator(e);return{...v,info:q,snapOrigin:q.handle.pos}}return{...v,info:e,snapOrigin:e.handle.pos}}).next(D.dragAtLocation(this.view,
f.elevationAlignedLocation)).next(N.screenToMapXYForGraphicAtLocation(this.view,this.graphic,f.elevationAlignedLocation,f.location.spatialReference,this.graphic)).next(this._snappingPipeline.createSnapDragEventPipelineStep({predicate:()=>!this._isMultiVertexSelection(),cancel:h,snappingManager:this.tool.snappingManager,snappingContext:new fa.SnappingContext({editGeometryOperations:g.unwrap(this._editGeometryOperations),elevationInfo:b,pointer:p,excludeFeature:this.graphic,visualizer:new ca.SnappingVisualizer3D}),
updatingHandles:this.updatingHandles}),this._snappingPipeline.next).next(D.addMapDelta()).next(v=>{this._perVertexManipulatorDragAction(v);"end"===v.action&&(n=g.removeMaybe(n));this._updateTranslateVertexTooltip(f,z.ManipulationType.XY,v)});h.next(this._cancelDragOperation(()=>n=g.removeMaybe(n)))});this._manipulatorHandles.add([a,c.events.on("immediate-click",f=>this._manipulatorClickCallback(f,e)),c.events.on("select-changed",()=>{e.selectedIndex=++this._selectedIndex;this._updateMoveManipulationPosition()}),
c.events.on("focus-changed",({action:f})=>{"focus"===f&&"edge"!==e.type?this._updateTranslateVertexTooltip(c,z.ManipulationType.XY):this._tooltip.clear()})],c);this.emit("manipulators-changed");return e};k._trackNumDragging=function(a){switch(a.action){case "start":this._numDragging++;break;case "end":this._numDragging--}return a};k._cancelDragOperation=function(a){return()=>{this._numDragging--;this.undo();this.outputGeometry=g.isSome(this._editGeometryOperations)?this._editGeometryOperations.data.geometry:
null;g.isSome(this.tool.snappingManager)&&this.tool.snappingManager.doneSnapping();this._tooltip.clear();switch(this._reshapeEventState){case t.MOVING:this.emit("move",{type:"move",dx:0,dy:0,mover:this.graphic});break;case t.RESHAPING:this.emit("reshape",{type:"reshape",mover:this.graphic})}a&&a();this.destroyed||this._updateEventState(t.NONE)}};k._setTypeSpecificManipulatorSettings=function(a,b,d){switch(b.type){case "vertex":a.state=E.Vertex;a.selectable=!0;a.cursor="move";a.collisionPriority=2;
a.radius=m.settings.reshapeManipulators.vertex.size/2+m.settings.reshapeManipulators.vertex.collisionPadding;a.elevationInfo=d;a.interactive=g.isSome(this.graphic.geometry)&&"point"!==this.graphic.geometry.type;break;case "edge":a.state=E.Edge,a.selectable=!1,a.cursor="copy",a.collisionPriority=-1,a.radius=m.settings.reshapeManipulators.edge.size/2+m.settings.reshapeManipulators.edge.collisionPadding,a.elevationInfo="on-the-ground"!==d.mode||ba.isVolumetricSymbol(this.graphic.symbol)?{mode:"absolute-height",
offset:0}:d}};k._watchAndUpdateGrabState=function(a,b){return a.events.on("grab-changed",d=>this._onGrabStateChanged(a,b,d.action,d.pointerType))};k._onGrabStateChanged=function(a,b,d,c="mouse"){if("start"===d)b&&this._updateSelection(a),this._numGrabbing++;else if(this._numGrabbing--,this._updateEventState(t.NONE),this.destroyed)return;this._moveManipulation.interactive=!this._numGrabbing;if("touch"!==c||this.enableEdgeOffset)this._manipulatorInfos.forEach(e=>{e.manipulator.interactive=!this._numGrabbing&&
g.isSome(this.graphic.geometry)&&"point"!==this.graphic.geometry.type;"edgeManipulator"in e&&(e.edgeManipulator.interactive=!this._numGrabbing)}),g.unwrap(this._graphicMoveManipulation).forEachManipulator(e=>e.interactive=!this._numGrabbing)};k._clearSelection=function(){for(const a of this._manipulatorInfos)a.manipulator.grabbing||(a.manipulator.selected=!1)};k._updateSelection=function(a){a.grabbing&&!a.selected&&a.selectable&&(this._clearSelection(),a.selected=!0,this.emit("manipulators-changed"))};
k._removeManipulator=function(a){a&&(a.manipulator.grabbing&&this._onGrabStateChanged(a.manipulator,!1,"end"),this._manipulatorHandles.remove(a.manipulator),this._manipulatorInfos.splice(this._manipulatorInfos.indexOf(a),1),this.manipulators.remove(a.manipulator),this.emit("manipulators-changed"))};k._getManipulatorInfoFromHandle=function(a){if(a)for(const b of this._manipulatorInfos)if(a===b.handle)return b;return null};k._updateManipulatorPosition=function(a){if(a){var b=g.unwrap(this._editGeometryOperations);
if("vertex"===a.type)a.manipulator.location=b.data.coordinateHelper.vectorToDehydratedPoint(a.handle.pos,L),a.manipulator.grabbing&&g.isSome(this._vertexLaserLineVisualElement)&&(this._vertexLaserLineVisualElement.visualElement.intersectsWorldUpAtLocation=a.manipulator.renderLocation);else if("edge"===a.type){var d=this._getManipulatorInfoFromHandle(a.handle.leftVertex).manipulator,c=this._getManipulatorInfoFromHandle(a.handle.rightVertex).manipulator;g.isSome(a.manipulator.elevationInfo)&&"on-the-ground"===
a.manipulator.elevationInfo.mode?(d=d.location,c=c.location,a.manipulator.location=aa.makeDehydratedPoint(d.x+.5*(c.x-d.x),d.y+.5*(c.y-d.y),d.hasZ&&c.hasZ?0:void 0,b.data.spatialReference)):(F.lerp(P,d.renderLocation,c.renderLocation,.5),a.manipulator.renderLocation=P)}}};k._splitEdgeManipulator=function(a,b=.5){var d=g.unwrap(this._editGeometryOperations);b=g.unwrap(d.splitEdge(a.handle,b).createdVertex);a.locationUpdateHandle.remove();a.locationUpdateHandle=void 0;var c=K.getGraphicEffectiveElevationInfo(this.graphic);
let e;this.enableEdgeOffset?(this._removeManipulator(a),e=this._createVertexOrEdgeManipulator(b)):(e=a,e.handle=b,e.type="vertex",this._setTypeSpecificManipulatorSettings(a.manipulator,a.handle,c));b.leftEdge&&this._createVertexOrEdgeManipulator(b.leftEdge);b.rightEdge&&this._createVertexOrEdgeManipulator(b.rightEdge);this.outputGeometry=d.data.geometry;this._updateManipulatorPosition(e);this.enableEdgeOffset||this._updateTranslateVertexTooltip(e.manipulator,z.ManipulationType.XY);this._updateSelection(a.manipulator);
a=this._updateEventState(t.RESHAPING);c=d.data.coordinateHelper.vectorToArray(e.handle.pos);d=d.data.components.indexOf(b.component);this.emit("vertex-add",{type:"vertex-add",vertices:[{coordinates:c,componentIndex:d,vertexIndex:g.unwrap(b.index)}],added:c});a&&this._updateEventState(t.NONE);return e};k._updateMoveManipulationPosition=function(){const a=F.set(P,0,0,0);let b=0,d=!1;var c=null;let e=null;for(var f of this._manipulatorInfos)if("vertex"===f.type)if(f.manipulator.selected)if(b++,F.add(a,
a,f.manipulator.renderLocation),g.isNone(c)||f.selectedIndex>c.selectedIndex)e=c,c=f;else{if(g.isNone(e)||f.selectedIndex>e.selectedIndex)e=f}else d=!0;0!==b?(f=this._graphicState.displaying,this._moveManipulation.xyManipulation.available=f,this._moveManipulation.xyAxisManipulation.available=f,this._moveManipulation.zManipulation.available=f&&this.enableZVertex&&S.canMoveZ(this.graphic),this._moveManipulation.xyAxisManipulation.orthogonalAvailable=f&&1!==b):(f=this._graphicState.displaying&&this.enableMoveGraphic,
this._moveManipulation.xyManipulation.available=f,this._moveManipulation.xyAxisManipulation.available=f,this._moveManipulation.xyAxisManipulation.orthogonalAvailable=f,this._moveManipulation.zManipulation.available=f&&this.enableZShape&&S.canMoveZ(this.graphic));if(0!==b){f=0;if(g.isSome(c)){const l=c.handle.pos,h=g.isSome(e)?e.handle.pos:c.handle.leftEdge&&c.handle.leftEdge.leftVertex?c.handle.leftEdge.leftVertex.pos:null;c=g.isNone(e)&&c.handle.rightEdge&&c.handle.rightEdge.rightVertex?c.handle.rightEdge.rightVertex.pos:
null;h&&c?this._moveManipulation.xyAxisManipulation.available=!1:h?f=Math.atan2(l[1]-h[1],l[0]-h[0])+Math.PI/2:c&&(f=Math.atan2(c[1]-l[1],c[0]-l[0])+Math.PI/2)}this._moveManipulation.angle=f;this._moveManipulation.radius=va.DISC_RADIUS_SMALL}else this._moveManipulation.angleDeferred=()=>wa.shapeOrientation(g.unwrap(this.graphic.geometry)),this._moveManipulation.radius=z.MoveManipulation.radiusForSymbol(this.graphic.symbol);0!==b&&d?(F.scale(a,a,1/b),L.spatialReference=g.unwrap(this._editGeometryOperations).data.spatialReference,
L.hasZ=!0,this.view.renderCoordsHelper.fromRenderCoords(a,L),this._moveManipulation.elevationAlignedLocation=L):g.isSome(this._outlineVisualElement)&&!this._graphicState.isDraped&&g.isSome(this._outlineVisualElement.attachmentOrigin)?this._moveManipulation.elevationAlignedLocation=this._outlineVisualElement.attachmentOrigin:C.placeAtGraphic(this.view,this._moveManipulation,this.graphic)};k._removeVertices=function(a){var b=[];const d=g.unwrap(this._editGeometryOperations);for(var c of a)"vertex"===
c.type&&d.canRemoveVertex()&&(b.push(c.handle),this._removeManipulator(c),this._removeManipulator(this._getManipulatorInfoFromHandle(c.handle.leftEdge)),this._removeManipulator(this._getManipulatorInfoFromHandle(c.handle.rightEdge)),(a=g.unwrap(d.removeVertices([c.handle]).removedVertices[0].createdEdge))&&this._createVertexOrEdgeManipulator(a));if(0<b.length&&(b=b.map(e=>{const f=d.data.components.indexOf(e.component);return{coordinates:d.data.coordinateHelper.vectorToArray(e.pos),componentIndex:f,
vertexIndex:g.unwrap(e.index)}}),this.outputGeometry=d.data.geometry,c=this._updateEventState(t.RESHAPING),!this.destroyed&&(this.emit("vertex-remove",{type:"vertex-remove",removed:b.map(e=>e.coordinates),vertices:b}),!this.destroyed))){if(c&&(this._updateEventState(t.NONE),this.destroyed))return;this._updateMoveManipulationPosition()}};k._moveVertices=function(a,b,d="start"===b.action?T.AccumulationBehaviour.NEW_STEP:T.AccumulationBehaviour.ACCUMULATE_STEPS){const c=g.unwrap(this._editGeometryOperations);
c.moveVertices(a.map(e=>e.handle),b.mapDeltaX,b.mapDeltaY,b.mapDeltaZ,d);this.outputGeometry=c.data.geometry;for(const e of a)this._updateManipulatorPosition(e)};k._offsetEdge=function(a,b){if(!g.isNone(b.operation)&&!g.isNone(b.signedDistance)){var d=g.unwrap(this._editGeometryOperations),c=b.operation.clone();c.distance=b.signedDistance;d.updateVertices([a.handle.leftVertex,a.handle.rightVertex],c);this.outputGeometry=d.data.geometry;this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(a.handle.leftVertex));
this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(a.handle.rightVertex))}};k._manipulatorClickCallback=function(a,b){a.shiftKey||this._clearSelection();"vertex"===b.type&&(b.manipulator.selected=!b.manipulator.selected,a.button===ea.MouseButton.Right&&this._removeVertices([b]));"edge"===b.type&&a.button===ea.MouseButton.Left&&this._splitEdgeManipulator(b);a.stopPropagation()};k._updateTranslateTooltip=function(a,b){const d=this._manipulatorInfos.filter(c=>"vertex"===c.type&&c.manipulator.selected);
1===d.length?this._updateTranslateVertexTooltip(d[0].manipulator,a,b):this._updateTranslateGraphicTooltip(a,b)};k._updateTranslateGraphicTooltip=function(a,b){var d=this._tooltipOptions;if(d.enabled){d=(a=a===z.ManipulationType.Z)?new U.TranslateZTooltipInfo({tooltipOptions:d}):new U.TranslateGraphicTooltipInfo({tooltipOptions:d});if(g.isSome(b)&&"end"!==b.action){const {mapStart:c,mapEnd:e}=b;b=a?W.verticalSignedDistanceBetweenPoints(c,e):V.autoHorizontalDistanceByElevationModeBetweenPoints(c,e,
this._graphicState.isDraped?"on-the-ground":"absolute-height");d.distance=g.isSome(b)?b:M.zeroMeters}this._tooltip.info=d}};k._updateTranslateVertexTooltip=function(a,b,d){var c=this._tooltipOptions;if(c.enabled){b=b===z.ManipulationType.Z;c=new U.TranslateVertexTooltipInfo({tooltipOptions:c});if(g.isSome(d)&&"end"!==d.action){const {mapStart:e,mapEnd:f}=d;d=b?W.verticalSignedDistanceBetweenPoints(e,f):V.autoHorizontalDistanceByElevationModeBetweenPoints(e,f,this._graphicState.isDraped?"on-the-ground":
"absolute-height");c.distance=g.isSome(d)?d:M.zeroMeters}a=W.elevationOfPoint(a.elevationAlignedLocation);g.isSome(a)&&(c.elevation={mode:"absolute-height",...a});({geometry:a}=this.graphic);g.isSome(a)&&!b&&(c.area="polygon"===a.type?Ba.autoAreaByDrapedStatus(a,this._graphicState.isDraped):null,c.totalLength="polyline"===a.type?V.autoLengthByElevationMode(a,this._graphicState.isDraped?"on-the-ground":"absolute-height"):null);this._tooltip.info=c}};Y._createClass(O,[{key:"inputGeometry",get:function(){return g.isSome(this._editGeometryOperations)?
this._editGeometryOperations.data.geometry:null},set:function(a){this._recreateEditGeometryAndManipulators(a)}},{key:"updating",get:function(){return this.updatingHandles.updating}},{key:"manipulators",get:function(){return this.tool.manipulators}},{key:"view",get:function(){return this.tool.view}},{key:"graphic",get:function(){return this.tool.graphic}},{key:"enableZShape",get:function(){return this.tool.enableZShape}},{key:"enableZVertex",get:function(){return this.tool.enableZVertex}},{key:"enableMoveGraphic",
get:function(){return this.tool.enableMoveGraphic}},{key:"enableMidpoints",get:function(){return this.tool.enableMidpoints}},{key:"enableEdgeOffset",get:function(){return this.tool.enableEdgeOffset}},{key:"_labelOptions",get:function(){return this.tool.labelOptions}},{key:"_tooltipOptions",get:function(){return this.tool.tooltipOptions}},{key:"canRedo",get:function(){return g.isSome(this._editGeometryOperations)&&this._editGeometryOperations.canRedo}},{key:"canUndo",get:function(){return g.isSome(this._editGeometryOperations)&&
this._editGeometryOperations.canUndo}},{key:"test",get:function(){return{segmentLabels:this._segmentLabels,tooltip:this._tooltip}}}]);return O}(ka.EventedMixin(la.HandleOwner));w.__decorate([y.property()],u.ReshapeOperation.prototype,"_segmentLabels",void 0);w.__decorate([y.property({constructOnly:!0})],u.ReshapeOperation.prototype,"tool",void 0);w.__decorate([y.property()],u.ReshapeOperation.prototype,"_tooltip",void 0);w.__decorate([y.property()],u.ReshapeOperation.prototype,"inputGeometry",null);
w.__decorate([y.property()],u.ReshapeOperation.prototype,"outputGeometry",void 0);w.__decorate([y.property({readOnly:!0})],u.ReshapeOperation.prototype,"updating",null);w.__decorate([y.property()],u.ReshapeOperation.prototype,"manipulators",null);w.__decorate([y.property()],u.ReshapeOperation.prototype,"view",null);w.__decorate([y.property()],u.ReshapeOperation.prototype,"graphic",null);w.__decorate([y.property()],u.ReshapeOperation.prototype,"enableZShape",null);w.__decorate([y.property()],u.ReshapeOperation.prototype,
"enableZVertex",null);w.__decorate([y.property()],u.ReshapeOperation.prototype,"enableMoveGraphic",null);w.__decorate([y.property()],u.ReshapeOperation.prototype,"enableMidpoints",null);w.__decorate([y.property()],u.ReshapeOperation.prototype,"enableEdgeOffset",null);w.__decorate([y.property()],u.ReshapeOperation.prototype,"_labelOptions",null);w.__decorate([y.property()],u.ReshapeOperation.prototype,"_tooltipOptions",null);u.ReshapeOperation=w.__decorate([oa.subclass("esri.views.3d.interactive.editingTools.reshapeGraphic.ReshapeOperation")],
u.ReshapeOperation);const L=aa.makeDehydratedPoint(0,0,null,null),P=Z.create();var E;(function(x){x.Vertex=r.ManipulatorStateCustomFlags.Custom1;x.Edge=r.ManipulatorStateCustomFlags.Custom2})(E||(E={}));var t;(function(x){x[x.NONE=0]="NONE";x[x.MOVING=1]="MOVING";x[x.RESHAPING=2]="RESHAPING"})(t||(t={}));var I;(function(x){x[x.ALL=0]="ALL";x[x.SELECTED_OR_ALL=1]="SELECTED_OR_ALL"})(I||(I={}));Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});