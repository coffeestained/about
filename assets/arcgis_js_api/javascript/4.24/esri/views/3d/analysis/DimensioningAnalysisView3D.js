// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Collection ../../../core/maybe ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./AnalysisView3D ./Dimensioning/DimensioningTool ./Dimensioning/DimensioningVisualization ./Dimensioning/LengthDimensionComputation ../../analysis/analysisViewUtils".split(" "),
function(m,d,c,r,h,t,e,z,A,B,u,v,p,w,x,n){c=function(q){function k(a){a=q.call(this,a)||this;a.type="dimensioning-view-3d";a.tool=null;a._computations=new r;a._dimensionsToResults=new Map;a._placementTask=null;return a}m._inheritsLoose(k,q);var g=k.prototype;g.initialize=function(){this.own([n.connectAnalysisViewToTool(this,p.DimensioningTool),t.on(()=>this.analysis.dimensions,"change",({added:a,removed:b})=>{for(const f of b)this._removeDimension(f);for(const f of a)this._addDimension(f)},{onListenerAdd:a=>
{for(const b of a)this._addDimension(b)},onListenerRemove:a=>{for(const b of a)this._removeDimension(b)}})]);this._analysisVisualization=new w.DimensioningVisualization({view:this.view,computations:this._computations})};g.destroy=function(){this._placementTask=h.abortMaybe(this._placementTask);this._analysisVisualization=h.destroyMaybe(this._analysisVisualization);this._computations.drain(a=>a.destroy());n.removeAnalysisViewTool(this)};g.createLengthDimensions=function(){var a=m._asyncToGenerator(function*(b){this._placementTask=
h.abortMaybe(this._placementTask);this._placementTask=n.activateTemporaryAnalysisViewTool(this,p.DimensioningTool,b);return this._placementTask.promise});return function(b){return a.apply(this,arguments)}}();g._addDimension=function(a){const b=this._dimensionsToResults;if(!b.has(a)){var f=this._computations,l=new x.LengthDimensionComputation({dimension:a});f.add(l);b.set(a,l.result)}};g._removeDimension=function(a){var b=this._computations;const f=this._dimensionsToResults,l=b.findIndex(y=>y.dimension===
a);b=b.removeAt(l);f.delete(a);h.destroyMaybe(b)};m._createClass(k,[{key:"results",get:function(){return this.analysis.dimensions.map(a=>this._dimensionsToResults.get(a))}},{key:"testInfo",get:function(){return{visualization:this._analysisVisualization}}}]);return k}(v.AnalysisView3D(c));d.__decorate([e.property({readOnly:!0})],c.prototype,"type",void 0);d.__decorate([e.property({constructOnly:!0,nonNullable:!0})],c.prototype,"analysis",void 0);d.__decorate([e.property()],c.prototype,"tool",void 0);
d.__decorate([e.property({readOnly:!0})],c.prototype,"results",null);d.__decorate([e.property()],c.prototype,"_analysisVisualization",void 0);d.__decorate([e.property()],c.prototype,"_computations",void 0);d.__decorate([e.property()],c.prototype,"_dimensionsToResults",void 0);d.__decorate([e.property()],c.prototype,"_placementTask",void 0);return c=d.__decorate([u.subclass("esri.views.3d.analysis.DimensioningAnalysisView3D")],c)});