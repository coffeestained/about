// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Evented ../../../../core/Handles ../../../../core/maybe ../../../../core/PooledArray ./basicInterfaces ./ContentObject ./ContentObjectType ./DirtyEvents ./Octree".split(" "),function(k,m,t,u,e,v,n,l,p,w,x){l=function(g){function h(a,b=""){var f,q,r;var d=g.call(this)||this;d.apiLayerUid=b;d.type=p.ContentObjectType.Layer;d.events=new t;d.isSliceable=!1;d._objects=new v;d._stageHandles=new u;d.apiLayerUid=b;d.isVisible=null!=
(f=null==a?void 0:a.isVisible)?f:!0;d.isPickable=null!=(q=null==a?void 0:a.isPickable)?q:!0;d.updatePolicy=null!=(r=null==a?void 0:a.updatePolicy)?r:n.UpdatePolicy.ASYNC;return d}m._inheritsLoose(h,g);var c=h.prototype;c.destroy=function(){this.detachStage();this._stage=null};c.attachStage=function(a){this.detachStage();this._stage=a;for(const b of w.DirtyEventNames)this._stageHandles.add(this.events.on(b,f=>a.handleEvent(b,f)))};c.detachStage=function(){this._stageHandles.removeAll();this.invalidateSpatialQueryAccelerator()};
c.add=function(a){this._objects.push(a);a.parentLayer=this;this.events.emit("layerObjectAdded",{layer:this,object:a});e.isSome(this._octree)&&this._octree.add([a])};c.remove=function(a){this._objects.removeUnordered(a)&&(a.parentLayer=null,this.events.emit("layerObjectRemoved",{layer:this,object:a}),e.isSome(this._octree)&&this._octree.remove([a]))};c.addMany=function(a){this._objects.pushArray(a);for(const b of a)b.parentLayer=this;this.events.emit("layerObjectsAdded",{layer:this,objects:a});e.isSome(this._octree)&&
this._octree.add(a)};c.removeMany=function(a){const b=[];this._objects.removeUnorderedMany(a,a.length,b);if(0!==b.length){for(const f of b)f.parentLayer=null;this.events.emit("layerObjectsRemoved",{layer:this,objects:b});e.isSome(this._octree)&&this._octree.remove(b)}};c.sync=function(){e.isSome(this._stage)&&this.updatePolicy!==n.UpdatePolicy.SYNC&&this._stage.syncLayer(this.id)};c.notifyObjectBBChanged=function(a,b){e.isSome(this._octree)&&this._octree.update(a,b)};c.getSpatialQueryAccelerator=
function(){e.isNone(this._octree)&&50<this._objects.length&&this._createOctree();return this._octree};c.shaderTransformationChanged=function(){this.invalidateSpatialQueryAccelerator();this.events.emit("shaderTransformationChanged",this)};c.invalidateSpatialQueryAccelerator=function(){this._octree=e.destroyMaybe(this._octree)};c._createOctree=function(){this._octree=new x(a=>a.boundingVolumeWorldSpace.bounds);this._octree.add(this._objects.data,this._objects.length)};m._createClass(h,[{key:"objects",
get:function(){return this._objects}}]);return h}(l.ContentObject);k.WebGLLayer=l;k.isWebGLLayer=function(g){return e.isSome(g)&&g.type===p.ContentObjectType.Layer};Object.defineProperties(k,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});