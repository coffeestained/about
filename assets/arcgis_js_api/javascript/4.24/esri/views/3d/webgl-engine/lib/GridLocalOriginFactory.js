// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
define("exports ../../../../core/maybe ../../../../core/uid ../../../../chunks/mat4f64 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../chunks/vec4f64 ../../../../geometry/projection ./basicInterfaces ./Geometry ./LocalOriginFactory ./Object3D ./testUtils ./VertexAttribute ./WebGLLayer ../materials/RibbonLineMaterial".split(" "),function(p,v,w,x,q,y,z,A,B,C,n,D,E,r,F,G){let H=function(){function t(a,b=125E4){this._originSR=a;this._gridSize=b;this._origins=new Map;this._objects=new Map;
this._rootOriginId="root/"+w.generateUID()}var u=t.prototype;u.getOrigin=function(a){var b=this._origins.get(this._rootOriginId);if(null==b){b=E.gridLocalOriginFactory.rootOrigin;if(v.isSome(b))return this._origins.set(this._rootOriginId,n.fromValues(b[0],b[1],b[2],this._rootOriginId)),this.getOrigin(a);a=n.fromValues(a[0]+Math.random()-.5,a[1]+Math.random()-.5,a[2]+Math.random()-.5,this._rootOriginId);this._origins.set(this._rootOriginId,a);return a}var e=this._gridSize;const m=Math.round(a[0]/e),
l=Math.round(a[1]/e),f=Math.round(a[2]/e),h=`${m}/${l}/${f}`;let g=this._origins.get(h);const k=.5*e;q.subtract(c,a,b.vec3);c[0]=Math.abs(c[0]);c[1]=Math.abs(c[1]);c[2]=Math.abs(c[2]);if(c[0]<k&&c[1]<k&&c[2]<k)return g&&(e=Math.max(...c),q.subtract(c,a,g.vec3),c[0]=Math.abs(c[0]),c[1]=Math.abs(c[1]),c[2]=Math.abs(c[2]),Math.max(...c)<e)?g:b;g||(g=n.fromValues(m*e,l*e,f*e,h),this._origins.set(h,g));return g};u._drawOriginBox=function(a,b=z.fromValues(1,1,0,1)){const e=window.view,m=e._stage;var l=
b.toString();if(!this._objects.has(l)){this._material=new G.RibbonLineMaterial({width:2,color:b});m.add(this._material);b=new F.WebGLLayer({isPickable:!1});var f=new D.Object3D({castShadow:!1});m.add(f);b.add(f);m.add(b);this._objects.set(l,f)}l=this._objects.get(l);b=[0,1,5,4,0,2,1,7,6,2,0,1,3,7,5,4,6,2,0];f=b.length;const h=Array(3*f),g=new Uint16Array(2*(f-1)),k=.5*this._gridSize;for(let d=0;d<f;d++)h[3*d]=a[0]+(b[d]&1?k:-k),h[3*d+1]=a[1]+(b[d]&2?k:-k),h[3*d+2]=a[2]+(b[d]&4?k:-k),0<d&&(g[2*d]=
d-1,g[2*d+1]=d);A.projectBuffer(h,this._originSR,0,h,e.renderSpatialReference,0,f);a=new C.Geometry([[r.VertexAttribute.POSITION,{size:3,data:h,exclusive:!0}]],[[r.VertexAttribute.POSITION,g]],B.PrimitiveType.Line);m.add(a);l.addGeometry(a,this._material,x.IDENTITY)};return t}();const c=y.create();p.GridLocalOriginFactory=H;Object.defineProperties(p,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});