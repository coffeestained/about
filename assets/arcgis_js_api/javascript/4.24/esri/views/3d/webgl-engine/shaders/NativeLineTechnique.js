// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../core/shaderLibrary/ShaderOutputOptions ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../lib/DefaultVertexAttributeLocations ../lib/Program ../lib/StencilUtils ../../../../chunks/NativeLine.glsl ../../../webgl/enums ../../../webgl/renderState".split(" "),function(t,p,q,u,r,v,k,w,x,l,y,f,g){k=function(e){function d(a,b,c){b=e.call(this,a,b,c)||this;b.stipplePattern=
null;b.stippleTextureBind=null;b.stippleTextureRepository=a.stippleTextureRepository;return b}q._inheritsLoose(d,e);var h=d.prototype;h.initializeProgram=function(a){const b=d.shader.get().build(this.configuration);return new x.Program(a.rctx,b,w.Default3D)};h.destroy=function(){e.prototype.destroy.call(this);this.stippleTextureRepository.release(this.stipplePattern);this.stippleTextureBind=this.stipplePattern=null};h.bindPass=function(a,b){this.program.bindPass(a,b);this.stipplePattern!==a.stipplePattern&&
(a=a.stipplePattern,this.stippleTextureBind=this.stippleTextureRepository.swap(this.stipplePattern,a),this.stipplePattern=a);if(this.stippleEnabled){const {pixelSize:c,sdfNormalizer:m,pixels:n}=u.isSome(this.stippleTextureBind)?this.stippleTextureBind(this.program):{pixelSize:1,sdfNormalizer:1,pixels:1};this.program.setUniform1f("stipplePatternSDFNormalizer",m);this.program.setUniform1f("stipplePatternTextureSize",n);this.program.setUniform1f("stipplePatternPixelSize",c);this.program.setUniform1f("stipplePatternPixelSizeInv",
1/c)}};h.initializePipeline=function(){const a=this.configuration,b=g.separateBlendingParams(f.BlendFactor.SRC_ALPHA,f.BlendFactor.ONE,f.BlendFactor.ONE_MINUS_SRC_ALPHA,f.BlendFactor.ONE_MINUS_SRC_ALPHA),c=(m,n=null,z=null)=>g.makePipelineState({blending:n,depthTest:l.depthCompareLess,depthWrite:z,colorWrite:g.defaultColorWriteParams,stencilWrite:a.hasOccludees?l.stencilWriteMaskOn:null,stencilTest:a.hasOccludees?m?l.stencilToolMaskBaseParams:l.stencilBaseAllZerosParams:null});return a.output===r.ShaderOutput.Color?
(this._occludeePipelineState=c(!0,a.transparent||this.stippleEnabled?b:null,g.defaultDepthWriteParams),c(!1,a.transparent||this.stippleEnabled?b:null,g.defaultDepthWriteParams)):c(!1)};h.getPipelineState=function(a,b){return b?this._occludeePipelineState:e.prototype.getPipelineState.call(this,a,b)};q._createClass(d,[{key:"stippleEnabled",get:function(){return this.configuration.stippleEnabled&&this.configuration.output!==r.ShaderOutput.Highlight}},{key:"primitiveType",get:function(){return f.PrimitiveType.LINES}}]);
return d}(k.ShaderTechnique);k.shader=new v.ReloadableShaderModule(y.NativeLine,()=>new Promise((e,d)=>t(["./NativeLine.glsl"],e,d)));p.NativeLineTechnique=k;Object.defineProperties(p,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});