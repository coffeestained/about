// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/Handles ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/reactiveUtils ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec3f64 ../../../../geometry/Point ../../../../geometry/support/aaBoundingRect".split(" "),
function(b,h,d,m,n,p,q,k,e,w,x,y,r,t,u,v){b.StableSurfaceCenter=function(l){function f(a){a=l.call(this,a)||this;a.location=null;a._updateController=null;a._handles=new n;return a}h._inheritsLoose(f,l);var g=f.prototype;g.initialize=function(){this.view.state.isLocal&&(this._handles.add([k.watch(()=>{var a,c;return[null==(a=this.surfaceView)?void 0:a.spatialReference,null==(c=this.surfaceView)?void 0:c.extent]},()=>this._update()),k.on(()=>{var a;return null==(a=this.surface)?void 0:a.layers},"change",
()=>this._update())]),this._update())};g.destroy=function(){this._handles.destroy()};g._update=function(){this._updateController&&(this._updateController.abort(),this._updateController=null);if(this.surfaceView&&!p.isNone(this.surfaceView.extent)&&this.surfaceView.spatialReference){var a=v.center(this.surfaceView.extent);a=new u({x:a[0],y:a[1],z:0,spatialReference:this.surfaceView.spatialReference});this.surface&&0<this.surface.layers.length?(this._set("location",null),this._updateController=new AbortController,
this.surface.queryElevation(a,{noDataValue:0,signal:this._updateController.signal,cache:this.cache}).then(c=>{this._updateController=null;this._set("location",c.geometry)}).catch(c=>{q.isAbortError(c)||c&&"elevation-query:invalid-layer"===c.name||console.error("StableSurfaceCenter failed to update: ",c)})):this._set("location",a)}else this._set("location",null)};h._createClass(f,[{key:"renderLocation",get:function(){if(!this.location)return null;const a=t.create();this.view.renderCoordsHelper.toRenderCoords(this.location,
a);return a}}]);return f}(m);d.__decorate([e.property({constructOnly:!0})],b.StableSurfaceCenter.prototype,"view",void 0);d.__decorate([e.property({constructOnly:!0})],b.StableSurfaceCenter.prototype,"cache",void 0);d.__decorate([e.property({readOnly:!0,aliasOf:"view.map.ground"})],b.StableSurfaceCenter.prototype,"surface",void 0);d.__decorate([e.property({readOnly:!0,aliasOf:"view.basemapTerrain"})],b.StableSurfaceCenter.prototype,"surfaceView",void 0);d.__decorate([e.property({readOnly:!0})],b.StableSurfaceCenter.prototype,
"location",void 0);d.__decorate([e.property({readOnly:!0})],b.StableSurfaceCenter.prototype,"renderLocation",null);b.StableSurfaceCenter=d.__decorate([r.subclass("esri.views.3d.terrain.StableSurfaceCenter")],b.StableSurfaceCenter);Object.defineProperties(b,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});