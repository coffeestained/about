// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/mathUtils ../../../../../core/screenUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/arrayUtils ../../../../../core/has ../../../../../core/accessorSupport/ensureType ../../../../../core/accessorSupport/decorators/subclass ../../../../../chunks/vec2 ../../../../../chunks/vec2f64 ../../../../../chunks/vec3 ../../../../../chunks/vec3f64 ../../../../../geometry/support/plane ../../../camera/constraintUtils ../../../camera/constraintUtils/common ../InteractiveController ../../utils/navigationUtils ../../../webgl-engine/lib/verticalOffsetUtils".split(" "),
function(k,p,q,y,z,A,F,G,H,B,r,t,b,e,u,v,m,C,f,D){k.ZoomController=function(w){function l(a){a=w.call(this,a)||this;a.view=null;a.tmpP=e.create();a.tmpDir=e.create();a.tmpN=e.create();a.tmpP0=t.create();a.tmpPoi=e.create();a.tmpRayDir=e.create();a.dragBeginPoint=z.createScreenPointArray();a.normalizedAnchorPoint=t.create();a.constraintOptions={selection:m.ConstraintTypes.ALL,interactionType:m.InteractionType.ZOOM,interactionFactor:0,interactionStartCamera:null,interactionDirection:e.create(),tiltMode:m.TiltMode.TUMBLE};
a.plane=u.create();return a}p._inheritsLoose(l,w);var n=l.prototype;n.begin=function(a){if(this.active){r.copy(this.dragBeginPoint,a);f.normalizeCoordinate(this.startCamera,a,this.normalizedAnchorPoint);var d=this.intersectionHelper.intersectScreenFreePointFallback(a,this.tmpP,0===this.view.map.ground.opacity?E:{});b.subtract(this.tmpDir,this.tmpP,this.startCamera.eye);var g=b.length(this.tmpDir);b.normalize(this.tmpDir,this.tmpDir);var c;this.view.camera.position.hasZ&&(c=Math.abs(this.view.camera.position.z));
c=y.clamp(f.PIVOT_DISTANCE_MODIFIER*c,f.DISTANCE_CLAMP_VALUES[0],f.DISTANCE_CLAMP_VALUES[1]);c=(a=this.view._stage.renderView.getMinimalDepthForArea(this.view.voxelWasm,a[0],a[1],this.view.state.camera,f.SCREEN_PIXEL_AREA))?Math.min(c,a):c;c=d?Math.min(c,g):c;b.scale(this.tmpDir,this.tmpDir,c);b.add(this.tmpP,this.startCamera.eye,this.tmpDir);b.subtract(this.tmpN,this.startCamera.eye,this.startCamera.center);b.normalize(this.tmpN,this.tmpN);0>this.tmpN[1]&&b.negate(this.tmpN,this.tmpN);u.fromPositionAndNormal(this.tmpP,
this.tmpN,this.plane);this.constraintOptions.interactionStartCamera=this.startCamera}};n.update=function(a){if(this.active){f.intersectPlaneFromScreenPoint(this.plane,this.currentCamera,this.dragBeginPoint,this.tmpPoi)||b.copy(this.tmpPoi,this.currentCamera.center);f.normalizeCoordinate(this.currentCamera,a,this.tmpP0);var d=4*(this.tmpP0[1]-this.normalizedAnchorPoint[1]);r.copy(this.normalizedAnchorPoint,this.tmpP0);b.subtract(this.tmpRayDir,this.tmpPoi,this.currentCamera.eye);var g=b.length(this.tmpRayDir),
c=g*(1-d);b.copy(this.constraintOptions.interactionDirection,this.tmpRayDir);b.scale(this.constraintOptions.interactionDirection,this.constraintOptions.interactionDirection,Math.sign(d)/g);var x=this.view.state.constraints.minimumPoiDistance;0<=d&&c<x&&(c=x,d=-(c-g)/g);1E-6>Math.abs(g-c)||(b.scale(this.tmpRayDir,this.tmpRayDir,d),this.currentCamera.eye=b.add(h,this.currentCamera.eye,this.tmpRayDir),b.lerp(h,this.currentCamera.center,this.tmpPoi,d),h[2]=this.tmpPoi[2]>this.startCamera.center[2]?Math.max(this.startCamera.center[2],
h[2]):Math.min(this.startCamera.center[2],h[2]),this.currentCamera.center=h,this.constraintOptions.interactionFactor=v.pixelDistanceToInteractionFactor(this.dragBeginPoint,a),v.applyAll(this.view,this.currentCamera,this.constraintOptions))}};n.end=function(){this.active&&this.finishController()};p._createClass(l,[{key:"intersectionHelper",get:function(){return this.view.sceneIntersectionHelper}}]);return l}(C.InteractiveController);q.__decorate([A.property({constructOnly:!0})],k.ZoomController.prototype,
"view",void 0);k.ZoomController=q.__decorate([B.subclass("esri.views.3d.state.controllers.local.ZoomController")],k.ZoomController);const h=e.create(),E={exclude:new Set([D.TERRAIN_ID])};Object.defineProperties(k,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});