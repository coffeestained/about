// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
define("require ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Error ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass ./LayerView3D ../../layers/LayerView".split(" "),function(u,l,k,p,d,q,r,m,v,e,w){e=function(t){function n(a){a=t.call(this,a)||this;a.type="line-of-sight-3d";a._analysisModules={"line-of-sight":null};return a}l._inheritsLoose(n,
t);var f=n.prototype;f.initialize=function(){this.handles.add(r.watch(()=>this.layer.analysis,a=>{this._destroyAnalysisView();d.isSome(a)&&this._createAnalysisView(a)},r.syncAndInitial),"analysis-view-handles")};f.destroy=function(){this.handles.remove("analysis-view-handles");this._destroyAnalysisView()};f.whenAnalysisView=function(){var a=l._asyncToGenerator(function*(){if(d.isSome(this.analysisView))return this.analysisView;if(d.isSome(this._createAnalysisViewTask))return this._createAnalysisViewTask.promise;
throw new p("layerview:no-analysisview-for-analysis","The analysis has not been set on the LineOfSightLayer of this layer view");});return function(){return a.apply(this,arguments)}}();f.isUpdating=function(){return d.isSome(this._createAnalysisViewTask)||d.isSome(this.analysisView)&&this.analysisView.updating};f._createAnalysisView=function(a){var b=this;const h=q.createTask(function(){var c=l._asyncToGenerator(function*(g){b.analysisView=yield b._createAnalysisViewPromise(a,g);b._createAnalysisViewTask===
h&&(b._createAnalysisViewTask=null);return b.analysisView});return function(g){return c.apply(this,arguments)}}());this._createAnalysisViewTask=h};f._destroyAnalysisView=function(){this.analysisView=d.destroyMaybe(this.analysisView);this._createAnalysisViewTask=d.abortMaybe(this._createAnalysisViewTask)};f._createAnalysisViewPromise=function(){var a=l._asyncToGenerator(function*(b,h){var c=b.type,g=this._analysisModules[c];d.isNone(g)&&(g=yield this._loadAnalysisModule(c),this._analysisModules[c]=
g);c=new g.default({analysis:b,view:this.view,parent:this});yield c.when();if(q.isAborted(h))throw c.destroy(),new p("layerview:no-analysisview-for-analysis","The analysis has not been added to the LineOfSightLayer of this layer view",{analysis:b});return c});return function(b,h){return a.apply(this,arguments)}}();f._loadAnalysisModule=function(a){switch(a){case "line-of-sight":return new Promise((b,h)=>u(["../analysis/LineOfSightAnalysisView3D"],c=>b(Object.freeze(Object.defineProperty({__proto__:null,
default:c},Symbol.toStringTag,{value:"Module"}))),h));default:return null}};return n}(e.LayerView3D(w));k.__decorate([m.property()],e.prototype,"type",void 0);k.__decorate([m.property()],e.prototype,"layer",void 0);k.__decorate([m.property()],e.prototype,"analysisView",void 0);k.__decorate([m.property()],e.prototype,"_createAnalysisViewTask",void 0);return e=k.__decorate([v.subclass("esri.views.3d.layers.LineOfSightLayerView3D")],e)});