// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
define(["exports","../../../../symbols/cim/enums","./definitions"],function(ha,t,ka){function ia(f,l){return f.x===l.x&&f.y===l.y}function O(f,l){f.x=l.y;f.y=-l.x;return f}function L(f,l){f.x=-l.y;f.y=l.x;return f}function ja(f,l){f.x=l.x;f.y=l.y;return f}function da(f,l){f.x=-l.x;f.y=-l.y;return f}function ea(f){return Math.sqrt(f.x*f.x+f.y*f.y)}function W(f,l,e,c){f.x=l.x*e+l.y*c;f.y=l.x*c-l.y*e;return f}let na=function(){function f(e,c,u){this.writeVertex=e;this.writeTriangle=c;this.canUseThinTessellation=
u;this.prevNormal={x:void 0,y:void 0};this.nextNormal={x:void 0,y:void 0};this.textureNormalLeft={x:0,y:1};this.textureNormalRight={x:0,y:-1};this.textureNormal={x:void 0,y:void 0};this.joinNormal={x:void 0,y:void 0};this.inner={x:void 0,y:void 0};this.outer={x:void 0,y:void 0};this.roundStart={x:void 0,y:void 0};this.roundEnd={x:void 0,y:void 0};this.startBreak={x:void 0,y:void 0};this.endBreak={x:void 0,y:void 0};this.innerPrev={x:void 0,y:void 0};this.innerNext={x:void 0,y:void 0};this.bevelStart=
{x:void 0,y:void 0};this.bevelEnd={x:void 0,y:void 0};this.bevelMiddle={x:void 0,y:void 0}}var l=f.prototype;l.tessellate=function(e,c){if(e){var u=e.length;if(!(1>=u)){var J=0;for(let C=1;C<u;C++)ia(e[C],e[J])||++J===C||(e[J]=e[C]);e.length=J+1}}this.canUseThinTessellation&&c.halfWidth<ka.THIN_LINE_HALF_WIDTH_THRESHOLD&&!c.offset?this._tessellateThin(e,c):this._tessellate(e,c)};l._tessellateThin=function(e,c){if(!(2>e.length)){var u=c.wrapDistance||65535;c=c.initialDistance||0;var J=!1,C=e[0].x,
F=e[0].y,aa=e.length;for(let M=1;M<aa;++M){J&&(J=!1,c=0);let B=e[M].x,d=e[M].y;var D=B-C;let b=d-F;var P=Math.sqrt(D*D+b*b);D/=P;b/=P;if(c+P>u){J=!0;var S=(u-c)/P;P=u-c;B=(1-S)*C+S*B;d=(1-S)*F+S*d;--M}S=this.writeVertex(C,F,0,0,D,b,b,-D,0,-1,c);C=this.writeVertex(C,F,0,0,D,b,-b,D,0,1,c);c+=P;P=this.writeVertex(B,d,0,0,D,b,b,-D,0,-1,c);D=this.writeVertex(B,d,0,0,D,b,-b,D,0,1,c);this.writeTriangle(S,C,P);this.writeTriangle(C,P,D);C=B;F=d}}};l._tessellate=function(e,c){var u=e[e.length-1];const J=ia(e[0],
u);if(!(e.length<(J?3:2))){var C=c.pixelCoordRatio,F=null!=c.capType?c.capType:t.CapType.BUTT,aa=null!=c.joinType?c.joinType:t.JoinType.MITER,D=null!=c.miterLimit?Math.min(c.miterLimit,4):2,P=null!=c.roundLimit?Math.min(c.roundLimit,1.05):1.05,S=null!=c.halfWidth?c.halfWidth:2,M=!!c.textured,B=null,d=null,b=this.prevNormal,a=this.nextNormal,X=-1,T=-1,h=this.joinNormal,ba=this.textureNormalLeft,ca=this.textureNormalRight,y=this.textureNormal,q=-1,r=-1,fa=c.wrapDistance||65535,n=c.initialDistance||
0,la=this.writeVertex,ma=this.writeTriangle;c=(E,Q,R,Y,U,V)=>{E=la(z,A,v,w,R,Y,E,Q,U,V,n);0<=q&&0<=r&&0<=E&&ma(q,r,E);q=r;return r=E};J&&(B=e[e.length-2],a.x=u.x-B.x,a.y=u.y-B.y,T=ea(a),a.x/=T,a.y/=T);u=!1;for(let E=0;E<e.length;++E){u&&(u=!1,n=0);B&&(b.x=-a.x,b.y=-a.y,X=T,n+X>fa&&(u=!0));u?(d=(fa-n)/X,X=fa-n,B={x:(1-d)*B.x+d*e[E].x,y:(1-d)*B.y+d*e[E].y},--E):B=e[E];var z=B.x;var A=B.y;var g=0>=E&&!u,p=E===e.length-1;g||(n+=X);(d=p?J?e[1]:null:e[E+1])?(a.x=d.x-z,a.y=d.y-A,T=ea(a),a.x/=T,a.y/=T):(a.x=
void 0,a.y=void 0);if(!J){if(g){L(h,a);var v=h.x;var w=h.y;F===t.CapType.SQUARE&&(c(-a.y-a.x,a.x-a.y,a.x,a.y,0,-1),c(a.y-a.x,-a.x-a.y,a.x,a.y,0,1));F===t.CapType.ROUND&&(c(-a.y-a.x,a.x-a.y,a.x,a.y,-1,-1),c(a.y-a.x,-a.x-a.y,a.x,a.y,-1,1));if(F===t.CapType.ROUND||F===t.CapType.BUTT)c(-a.y,a.x,a.x,a.y,0,-1),c(a.y,-a.x,a.x,a.y,0,1);continue}if(p){O(h,b);v=h.x;w=h.y;if(F===t.CapType.ROUND||F===t.CapType.BUTT)c(b.y,-b.x,-b.x,-b.y,0,-1),c(-b.y,b.x,-b.x,-b.y,0,1);F===t.CapType.SQUARE&&(c(b.y-b.x,-b.x-b.y,
-b.x,-b.y,0,-1),c(-b.y-b.x,b.x-b.y,-b.x,-b.y,0,1));F===t.CapType.ROUND&&(c(b.y-b.x,-b.x-b.y,-b.x,-b.y,1,-1),c(-b.y-b.x,b.x-b.y,-b.x,-b.y,1,1));continue}}var m=void 0;g=-(b.x*a.y-b.y*a.x);.01>Math.abs(g)?0<b.x*a.x+b.y*a.y?(h.x=b.x,h.y=b.y,g=1,m=Number.MAX_VALUE,d=!0):(L(h,a),m=g=1,d=!1):(h.x=(b.x+a.x)/g,h.y=(b.y+a.y)/g,m=ea(h),d=(m-1)*S*C,d=4<m||d>X&&d>T);v=h.x;w=h.y;var k=aa;switch(aa){case t.JoinType.BEVEL:1.05>m&&(k=t.JoinType.MITER);break;case t.JoinType.ROUND:m<P&&(k=t.JoinType.MITER);break;case t.JoinType.MITER:m>
D&&(k=t.JoinType.BEVEL)}switch(k){case t.JoinType.MITER:c(h.x,h.y,-b.x,-b.y,0,-1);c(-h.x,-h.y,-b.x,-b.y,0,1);if(p)break;M&&(d=u?0:n,q=this.writeVertex(z,A,v,w,a.x,a.y,h.x,h.y,0,-1,d),r=this.writeVertex(z,A,v,w,a.x,a.y,-h.x,-h.y,0,1,d));break;case t.JoinType.BEVEL:g=0>g;var G=void 0;g?(k=q,q=r,r=k,G=ba,k=ca):(G=ca,k=ba);var H=void 0,N=void 0;d?(H=g?L(this.innerPrev,b):O(this.innerPrev,b),N=g?O(this.innerNext,a):L(this.innerNext,a)):H=N=g?da(this.inner,h):ja(this.inner,h);m=g?O(this.bevelStart,b):L(this.bevelStart,
b);c(H.x,H.y,-b.x,-b.y,G.x,G.y);H=c(m.x,m.y,-b.x,-b.y,k.x,k.y);if(p)break;p=g?L(this.bevelEnd,a):O(this.bevelEnd,a);d?(d=this.writeVertex(z,A,v,w,-b.x,-b.y,0,0,0,0,n),q=this.writeVertex(z,A,v,w,a.x,a.y,N.x,N.y,G.x,G.y,n),r=this.writeVertex(z,A,v,w,a.x,a.y,p.x,p.y,k.x,k.y,n),this.writeTriangle(H,d,r)):(M?(d=this.bevelMiddle,d.x=(m.x+p.x)/2,d.y=(m.y+p.y)/2,W(y,d,-b.x,-b.y),c(d.x,d.y,-b.x,-b.y,y.x,y.y),W(y,d,a.x,a.y),q=this.writeVertex(z,A,v,w,a.x,a.y,d.x,d.y,y.x,y.y,n),r=this.writeVertex(z,A,v,w,a.x,
a.y,N.x,N.y,G.x,G.y,n)):(d=q,q=r,r=d),c(p.x,p.y,a.x,a.y,k.x,k.y));g&&(d=q,q=r,r=d);break;case t.JoinType.ROUND:{g=0>g;var K=void 0;g?(k=q,q=r,r=k,k=ba,K=ca):(k=ca,K=ba);var x=g?da(this.inner,h):ja(this.inner,h);d?(N=g?L(this.innerPrev,b):O(this.innerPrev,b),G=g?O(this.innerNext,a):L(this.innerNext,a)):G=N=x;H=g?O(this.roundStart,b):L(this.roundStart,b);var Z=g?L(this.roundEnd,a):O(this.roundEnd,a);N=c(N.x,N.y,-b.x,-b.y,k.x,k.y);H=c(H.x,H.y,-b.x,-b.y,K.x,K.y);if(p)break;p=this.writeVertex(z,A,v,w,
-b.x,-b.y,0,0,0,0,n);d||this.writeTriangle(q,r,p);x=da(this.outer,x);K=this.writeVertex(z,A,v,w,a.x,a.y,Z.x,Z.y,K.x,K.y,n);let Q,R;if(Z=2<m){var I=void 0;m!==Number.MAX_VALUE?(x.x/=m,x.y/=m,I=b.x*x.x+b.y*x.y,I=(m*(I*I-1)+1)/I):I=-1;Q=g?O(this.startBreak,b):L(this.startBreak,b);Q.x+=b.x*I;Q.y+=b.y*I;R=g?L(this.endBreak,a):O(this.endBreak,a);R.x+=a.x*I;R.y+=a.y*I}W(y,x,-b.x,-b.y);m=this.writeVertex(z,A,v,w,-b.x,-b.y,x.x,x.y,y.x,y.y,n);W(y,x,a.x,a.y);x=M?this.writeVertex(z,A,v,w,a.x,a.y,x.x,x.y,y.x,
y.y,n):m;I=p;const Y=M?this.writeVertex(z,A,v,w,a.x,a.y,0,0,0,0,n):p;let U=-1,V=-1;Z&&(W(y,Q,-b.x,-b.y),U=this.writeVertex(z,A,v,w,-b.x,-b.y,Q.x,Q.y,y.x,y.y,n),W(y,R,a.x,a.y),V=this.writeVertex(z,A,v,w,a.x,a.y,R.x,R.y,y.x,y.y,n));M?Z?(this.writeTriangle(I,H,U),this.writeTriangle(I,U,m),this.writeTriangle(Y,x,V),this.writeTriangle(Y,V,K)):(this.writeTriangle(I,H,m),this.writeTriangle(Y,x,K)):Z?(this.writeTriangle(p,H,U),this.writeTriangle(p,U,V),this.writeTriangle(p,V,K)):(this.writeTriangle(p,H,m),
this.writeTriangle(p,x,K));d?q=this.writeVertex(z,A,v,w,a.x,a.y,G.x,G.y,k.x,k.y,n):(q=M?this.writeVertex(z,A,v,w,a.x,a.y,G.x,G.y,k.x,k.y,n):N,this.writeTriangle(q,Y,K));r=K;g&&(d=q,q=r,r=d)}}}}};return f}();ha.LineTessellation=na;Object.defineProperties(ha,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});