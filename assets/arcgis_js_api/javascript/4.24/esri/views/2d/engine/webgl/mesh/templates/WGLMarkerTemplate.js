// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),function(G,H,m,I,J,u,x,q,K,p,L,v,M,N){return function(F){function r(a,c,l,e,h,d,k,f,n,z,A,B,C,D,g,E,y,w,t,O,P,Q,R){var b=F.call(this)||
this;b.angle=e;b.height=k;b.width=d;b.xOffset=c*t;b.yOffset=l*t;b._markerPlacement=O;b._effects=P;b._anchorX=.5-(.5+E)*g.width/g.width;b._anchorY=.5-(.5+y)*g.height/g.height;b._minMaxZoom=p.i1616to32(Math.round(Q*q.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(R*q.MIN_MAX_ZOOM_PRECISION_FACTOR));c=(D===u.Alignment.MAP?q.BITSET_MARKER_ALIGNMENT_MAP:q.BITSET_MARKER_ALIGNMENT_SCREEN)|(A?q.BITSET_GENERIC_LOCK_COLOR:0)|(C?q.BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE:0)|(B?q.BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY:
0);l=g&&g.sdf;a=L.MarkerMaterialKey.load(a);a.sdf=l;a.pattern=!0;a.textureBinding=g.textureBinding;b._materialKey=a.data;b._fillColor=h;b._outlineColor=n;b._sizeOutlineWidth=p.i8888to32(Math.round(Math.min(Math.sqrt(128*d),255)),Math.round(Math.min(Math.sqrt(128*k),255)),Math.round(Math.min(Math.sqrt(128*z),255)),Math.round(Math.min(Math.sqrt(128*f),255)));h=g.rect.x+q.SPRITE_PADDING;f=g.rect.y+q.SPRITE_PADDING;n=h+g.width;g=f+g.height;b._offsets.xUpperLeft=h;b._offsets.yUpperLeft=f;b._offsets.xUpperRight=
n;b._offsets.yUpperRight=f;b._offsets.xBottomLeft=h;b._offsets.yBottomLeft=g;b._offsets.xBottomRight=n;b._offsets.yBottomRight=g;a.symbologyType===K.WGLSymbologyType.PIE_CHART?(b._texUpperLeft=p.i1616to32(0,1),b._texUpperRight=p.i1616to32(1,1),b._texBottomLeft=p.i1616to32(0,0),b._texBottomRight=p.i1616to32(1,0)):(b._texUpperLeft=p.i1616to32(h,f),b._texUpperRight=p.i1616to32(n,f),b._texBottomLeft=p.i1616to32(h,g),b._texBottomRight=p.i1616to32(n,g));d=d*w*t;k=k*w*t;b._bitestAndDistRatio=p.i1616to32(c,
Math.round(64*w));b._computedWidth=d;b._computedHeight=k;d=J.create();k=I.create();b._applyTransformation(k,d);return b}G._inheritsLoose(r,F);r.fromCIMMarker=function(a,c,l){const e=a.size,h=(c&&c.width||1)/(c&&c.height||1)*a.scaleX;var d=a.scaleSymbolsProportionally&&a.frameHeight?e/a.frameHeight:1;let k=x.premultiplyAlphaRGBA(a.color);const f=x.premultiplyAlphaRGBA(a.outlineColor),n=m.pt2px(e),z=n*h,A=m.pt2px(a.offsetX||0),B=m.pt2px(a.offsetY||0);d*=m.pt2px(a.outlineWidth||0);const C=a.alignment||
u.Alignment.SCREEN,D=m.pt2px(a.referenceSize),[g,E]=v.getMinMaxZoom(a.scaleInfo,l);c.sdf||0!==k||(k=-1);l=a.rotation||0;a.rotateClockwise||(l=-l);let y=0,w=0;const t=a.anchorPoint;t&&(a.isAbsoluteAnchorPoint?e&&(y=-t.x/(e*h),w=t.y/e):(y=t.x,w=t.y));c=new r(a.materialKey,A,B,l,k,z,n,D,f,d,a.colorLocked,a.scaleSymbolsProportionally,!1,C,c,y,w,a.sizeRatio,H.unwrapOr(a.scaleFactor,1),a.markerPlacement,a.effects,g,E);c._vertexBoundsScaleX=a.maxVVSize?a.maxVVSize/z:1;c._vertexBoundsScaleY=a.maxVVSize?a.maxVVSize/
n:1;return c};r.fromPictureMarker=function(a,c){const l=Math.round(m.pt2px(a.width)),e=Math.round(m.pt2px(a.height)),h=q.PICTURE_FILL_COLOR,d=Math.round(m.pt2px(a.xoffset||0)),k=Math.round(m.pt2px(a.yoffset||0));c=new r(a.materialKey,d,k,a.angle,h,l,e,e,0,0,!1,!1,!1,u.Alignment.SCREEN,c,0,0,1,1,null,null,v.DEFAULT_MIN_ZOOM,v.DEFAULT_MAX_ZOOM);c._vertexBoundsScaleX=a.maxVVSize?a.maxVVSize/a.width:1;c._vertexBoundsScaleY=a.maxVVSize?a.maxVVSize/a.height:1;return c};r.fromSimpleMarker=function(a,c){const l=
x.premultiplyAlphaRGBAArray(a.color),e=Math.round(m.pt2px(a.size)),h=Math.round(m.pt2px(a.xoffset||0)),d=Math.round(m.pt2px(a.yoffset||0)),k=a.style;var f=a.outline;const n=(f&&f.color&&x.premultiplyAlphaRGBAArray(f.color))|0;f=(f&&f.width&&Math.round(m.pt2px(f.width)))|0;c=new r(a.materialKey,h,d,a.angle,l,e,e,e,n,f,!1,!1,"esriSMSCross"===k||"esriSMSX"===k,u.Alignment.SCREEN,c,0,0,1.96875,1,null,null,v.DEFAULT_MIN_ZOOM,v.DEFAULT_MAX_ZOOM);c.boundsType="esriSMSCircle"===k?"circle":"square";c._vertexBoundsScaleX=
a.maxVVSize?a.maxVVSize/a.size:1;c._vertexBoundsScaleY=a.maxVVSize?a.maxVVSize/a.size:1;return c};r.fromLineSymbolMarker=function(a,c){const l=x.premultiplyAlphaRGBAArray(a.color),e=Math.round(m.pt2px(6*a.lineWidth)),h="cross"===a.style||"x"===a.style;switch(a.placement){case "begin-end":var d=u.ExtremityPlacement.Both;break;case "begin":d=u.ExtremityPlacement.JustBegin;break;case "end":d=u.ExtremityPlacement.JustEnd;break;default:d=u.ExtremityPlacement.None}d={type:"CIMMarkerPlacementAtExtremities",
angleToLine:!0,offset:0,extremityPlacement:d,offsetAlongLine:0};c=new r(a.materialKey,0,0,0,l,e,e,e/6,l,h?Math.round(m.pt2px(a.lineWidth)):0,!1,!1,h,u.Alignment.MAP,c,0,0,1.96875,1,d,null,v.DEFAULT_MIN_ZOOM,v.DEFAULT_MAX_ZOOM);c.boundsType="circle"===a.style?"circle":"square";return c};return r}(M(N))});