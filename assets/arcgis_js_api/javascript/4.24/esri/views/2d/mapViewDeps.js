// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/2d/engine/Stage":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Error ../../../core/events ../../../core/has ../../../core/maybe ../../../core/reactiveUtils ../../../core/scheduling ../../../chunks/mat3f32 ../../../symbols/cim/CIMResourceManager ./Container ./webgl/enums ./webgl/Painter ./webgl/Profiler ../support/Timeline ../../support/screenshotUtils ../../webgl/context-util ../../webgl/enums ../../webgl/FramebufferObject ../../webgl/RenderingContext".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c,f,h,p,k,e,m,r,v){let x=function(g){function u(z,w){var B=g.call(this)||this;B._trash=new Set;B._renderRemainingTime=0;B._lastFrameRenderTime=0;B.renderRequested=!1;B.stage=t._assertThisInitialized(B);B._stationary=!0;const {canvas:F=document.createElement("canvas"),alpha:G=!0,stencil:H=!0,contextOptions:I={}}=w;B._canvas=F;const L=e.createContextOrErrorHTML("2d",F,{alpha:G,antialias:!1,depth:!0,stencil:H});B.context=new v.RenderingContext(A.isSome(L)?L:null,I);B.resourceManager=
new a;B.painter=new f(B.context,t._assertThisInitialized(B),B.resourceManager);C("esri-2d-profiler")&&(B._debugOutput=document.createElement("div"),B._debugOutput.setAttribute("style","margin: 24px 64px; position: absolute; color: red;"),z.appendChild(B._debugOutput));B._renderParameters={drawPhase:0,state:B.state,pixelRatio:window.devicePixelRatio,stationary:!1,globalOpacity:1,blendMode:null,deltaTime:-1,time:0,inFadeTransition:!1,effects:null,context:B.context,painter:B.painter,timeline:w.timeline||
new p.Timeline,renderingOptions:w.renderingOptions,requestRender:()=>B.requestRender(),requireFBO:!1,profiler:new h.Profiler(B.context,B._debugOutput),dataUploadCounter:0};B._taskHandle=l.addFrameTask({render:N=>B.renderFrame(N)});B._taskHandle.pause();B._lostWebGLContextHandle=E.on(F,"webglcontextlost",()=>{B.emit("webgl-error",{error:new D("webgl-context-lost")})});F.setAttribute("style","width: 100%; height:100%; display:block;");z.appendChild(F);return B}t._inheritsLoose(u,g);var y=u.prototype;
y.destroy=function(){this.removeAllChildren();this._emptyTrash();this._taskHandle.remove();this._taskHandle=null;this._lostWebGLContextHandle&&(this._lostWebGLContextHandle.remove(),this._lostWebGLContextHandle=null);this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas);this._debugOutput&&this._debugOutput.parentNode&&this._debugOutput.parentNode.removeChild(this._debugOutput);this.highlightOptions=null;this.resourceManager.destroy();this.painter.dispose();this.context.dispose();
this._canvas=null};y.trashDisplayObject=function(z){this._trash.add(z);this.requestRender()};y.untrashDisplayObject=function(z){return this._trash.delete(z)};y.requestRender=function(){this._renderRemainingTime=2E3;this.renderRequested||(this.renderRequested=!0,this.emit("will-render"),this._taskHandle.resume())};y.renderFrame=function(z){this._renderRemainingTime-=this._lastFrameRenderTime?z.time-this._lastFrameRenderTime:0;0>=this._renderRemainingTime&&this._taskHandle.pause();this._lastFrameRenderTime=
z.time;this.renderRequested=!1;this._renderParameters.state=this._state;this._renderParameters.stationary=this.stationary;this._renderParameters.pixelRatio=window.devicePixelRatio;this._renderParameters.globalOpacity=1;this._renderParameters.time=z.time;this._renderParameters.deltaTime=z.deltaTime;this._renderParameters.effects=null;this.processRender(this._renderParameters);this._emptyTrash();this.emit("post-render")};y._createTransforms=function(){return{dvs:d.create()}};y.renderChildren=function(z){for(const w of this.children)w.beforeRender(z);
this._renderChildren(this.children,z);for(const w of this.children)w.afterRender(z)};y._renderChildren=function(z,w){const B=this.context;B.resetInfo();w.profiler.recordStart("drawLayers");w.dataUploadCounter=0;w.drawPhase=c.WGLDrawPhase.MAP;this.painter.beforeRenderLayers(B,this.background);for(const F of z)F.processRender(w);this.painter.prepareDisplay(w,this.background,this.state.padding);this.painter.renderLayers(B);w.drawPhase=c.WGLDrawPhase.HIGHLIGHT;this.painter.beforeRenderLayers(B);for(const F of z)F.processRender(w);
this.painter.renderLayers(B);if(this._isLabelDrawPhaseRequired(z)){w.drawPhase=c.WGLDrawPhase.LABEL;this.painter.beforeRenderLayers(B);for(const F of z)F.processRender(w);this.painter.renderLayers(B)}if(C("esri-tiles-debug")){w.drawPhase=c.WGLDrawPhase.DEBUG;this.painter.beforeRenderLayers(B);for(const F of z)F.processRender(w);this.painter.renderLayers(B)}w.profiler.recordEnd("drawLayers");B.logInfo()};y.doRender=function(z){const w=this.context,{state:B,pixelRatio:F}=z;this._resizeCanvas(z);w.setViewport(0,
0,F*B.size[0],F*B.size[1]);w.setDepthWriteEnabled(!0);w.setStencilWriteMask(255);g.prototype.doRender.call(this,z)};y.takeScreenshot=function(){var z=t._asyncToGenerator(function*(w){const {framebufferWidth:B,framebufferHeight:F}={framebufferWidth:Math.round(this.state.size[0]*w.resolutionScale),framebufferHeight:Math.round(this.state.size[1]*w.resolutionScale)};var G=this.context,H=this._state.clone();if(null!=w.rotation){var I=H.viewpoint;H.viewpoint.rotation=w.rotation;H.viewpoint=I}var L={...this._renderParameters,
drawPhase:null,globalOpacity:1,stationary:!0,state:H,pixelRatio:1,time:performance.now(),deltaTime:0,blendMode:null,effects:null,inFadeTransition:!1};const N=new r.FramebufferObject(G,{colorTarget:m.TargetType.TEXTURE,depthStencilTarget:m.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER,width:B,height:F});H=G.getBoundFramebufferObject();I=G.getViewport();G.bindFramebuffer(N);G.setViewport(0,0,B,F);this._renderChildren(w.children,L);L=this._readbackScreenshot(N,{...w.cropArea,y:F-(w.cropArea.y+w.cropArea.height)});
G.bindFramebuffer(H);G.setViewport(I.x,I.y,I.width,I.height);this.requestRender();G=yield L;1===w.outputScale?w=G:(w=new ImageData(Math.round(G.width*w.outputScale),Math.round(G.height*w.outputScale)),k.resampleHermite(G,w,!0));return w});return function(w){return z.apply(this,arguments)}}();y._readbackScreenshot=function(){var z=t._asyncToGenerator(function*(w,B){const F=k.createEmptyImageData(B.width,B.height,document.createElement("canvas"));yield w.readPixelsAsync(B.x,B.y,B.width,B.height,m.PixelFormat.RGBA,
m.PixelType.UNSIGNED_BYTE,new Uint8Array(F.data.buffer));return F});return function(w,B){return z.apply(this,arguments)}}();y._resizeCanvas=function(z){const w=this._canvas,B=w.style,{state:{size:F},pixelRatio:G}=z;z=F[0];const H=F[1],I=Math.round(z*G),L=Math.round(H*G);if(w.width!==I||w.height!==L)w.width=I,w.height=L;B.width=z+"px";B.height=H+"px"};y._emptyTrash=function(){for(;0<this._trash.size;){const z=Array.from(this._trash);this._trash.clear();for(const w of z)w.processDetach()}};y._isLabelDrawPhaseRequired=
function(z){let w=!1;for(const B of z){if(!(B instanceof b.Container)){w=w||!1;break}if(B.hasLabels)return!0;w=w||this._isLabelDrawPhaseRequired(B.children)}return w};t._createClass(u,[{key:"background",get:function(){return this._background},set:function(z){this._background=z;this.requestRender()}},{key:"highlightOptions",get:function(){return this._highlightOptions},set:function(z){this._highlightOptionsHandle&&(this._highlightOptionsHandle.remove(),this._highlightOptionsHandle=null);if(this._highlightOptions=
z)this._highlightOptionsHandle=n.watch(()=>{var w;return null==(w=this._highlightOptions)?void 0:w.version},()=>{this.painter.setHighlightOptions(z);this.requestRender()},n.initial)}},{key:"renderingOptions",get:function(){return this._renderingOptions},set:function(z){this._renderingOptions=z;this.requestRender()}},{key:"state",get:function(){return this._state},set:function(z){this._state=z;this.requestRender()}},{key:"stationary",get:function(){return this._stationary},set:function(z){this._stationary!==
z&&(this._stationary=z,this.requestRender())}}]);return u}(b.Container);q.EXTRA_RENDER_TIME=2E3;q.Stage=x;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMResourceManager":function(){define(["../../chunks/_rollupPluginBabelHelpers","../../request","../../core/Error","../../core/promiseUtils"],function(q,t,D,E){function C(A,n){if(A.includes(";base64,")){const l=new Image;l.src=A;return l.decode().then(()=>({ok:!0,value:l})).catch(d=>E.isAbortError(d)?
{ok:!1,error:d}:{ok:!1,error:new D("invalid-resource",`Could not fetch requested resource at ${A}`)})}return t(A,{responseType:"image",...n}).then(l=>({ok:!0,value:l.data})).catch(l=>E.isAbortError(l)?{ok:!1,error:l}:{ok:!1,error:new D("invalid-resource",`Could not fetch requested resource at ${A}`)})}return function(){function A(){this._resourceMap=new Map;this._inFlightResourceMap=new Map;this.geometryEngine=null}var n=A.prototype;n.destroy=function(){this._inFlightResourceMap.clear();this._resourceMap.clear()};
n.getResource=function(l){var d;return null!=(d=this._resourceMap.get(l))?d:null};n.fetchResource=function(){var l=q._asyncToGenerator(function*(d,a){const b={width:0,height:0},c=this._resourceMap;var f=c.get(d);if(f)return b.width=f.width,b.height=f.height,b;if(f=this._inFlightResourceMap.get(d))return f;f=C(d,a);this._inFlightResourceMap.set(d,f);return f=f.then(h=>{this._inFlightResourceMap.delete(d);h.ok&&(c.set(d,h.value),h=h.value,b.width=h.width,b.height=h.height);return b})});return function(d,
a){return l.apply(this,arguments)}}();n.deleteResource=function(l){this._inFlightResourceMap.delete(l);this._resourceMap.delete(l)};return A}()})},"esri/views/2d/engine/Container":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../chunks/mat3f32","../../../layers/effects/EffectView","./DisplayObject"],function(q,t,D,E,C){C=function(A){function n(){var d=A.apply(this,arguments)||this;d._childrenSet=new Set;d._needsSort=!1;d.children=[];d._effectView=null;return d}t._inheritsLoose(n,
A);var l=n.prototype;l.updateTransitionProperties=function(d,a){A.prototype.updateTransitionProperties.call(this,d,a);this._effectView&&(this._effectView.transitionStep(d,a),this._effectView.transitioning&&this.requestRender())};l.doRender=function(d){d=this.createRenderParams(d);this.renderChildren(d)};l.addChild=function(d){return this.addChildAt(d,this.children.length)};l.addChildAt=function(d,a=this.children.length){if(!d||this.contains(d))return d;this._needsSort=!0;const b=d.parent;b&&b!==this&&
b.removeChild(d);a>=this.children.length?this.children.push(d):this.children.splice(a,0,d);this._childrenSet.add(d);d.parent=this;d.stage=this.stage;this!==this.stage&&(d.clips=this.clips);this.requestRender();return d};l.contains=function(d){return this._childrenSet.has(d)};l.removeAllChildren=function(){this._childrenSet.clear();this._needsSort=!0;for(const d of this.children)this!==this.stage&&(d.clips=null),d.stage=null,d.parent=null;this.children.length=0};l.removeChild=function(d){return this.contains(d)?
this.removeChildAt(this.children.indexOf(d)):d};l.removeChildAt=function(d){if(0>d||d>=this.children.length)return null;this._needsSort=!0;d=this.children.splice(d,1)[0];this._childrenSet.delete(d);this!==this.stage&&(d.clips=null);d.stage=null;d.parent=null;return d};l.sortChildren=function(d){this._needsSort&&(this.children.sort(d),this._needsSort=!1)};l._createTransforms=function(){return{dvs:D.create()}};l.onAttach=function(){A.prototype.onAttach.call(this);const d=this.stage;for(const a of this.children)a.stage=
d};l.onDetach=function(){A.prototype.onDetach.call(this);for(const d of this.children)d.stage=null};l.renderChildren=function(d){for(const a of this.children)a.beforeRender(d);for(const a of this.children)a.processRender(d);for(const a of this.children)a.afterRender(d)};l.createRenderParams=function(d){return{...d,blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:d.globalOpacity*this.computedOpacity,inFadeTransition:this.inFadeTransition}};t._createClass(n,[{key:"blendMode",get:function(){return this._blendMode},
set:function(d){this._blendMode=d;this.requestRender()}},{key:"clips",get:function(){return this._clips},set:function(d){this._clips=d;this.children.forEach(a=>a.clips=d)}},{key:"computedEffects",get:function(){var d,a;return null!=(d=null==(a=this._effectView)?void 0:a.effects)?d:null}},{key:"effect",get:function(){var d,a;return null!=(d=null==(a=this._effectView)?void 0:a.effect)?d:""},set:function(d){if(this._effectView||d)this._effectView||(this._effectView=new E.EffectView),this._effectView.effect=
d,this.requestRender()}}]);return n}(C.DisplayObject);q.Container=C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/effects/EffectView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/has ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./parser ./utils".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c){function f(k){k=b.parse(k)||[];var e=(e=k[0])?"type"in e:!1;return e?[{scale:-1,effects:k}]:k}function h(k,e,m){var r,v,x,g;return null!=(r=k[0])&&r.effects&&null!=(v=e[0])&&v.effects?(-1===(null==(x=k[0])?void 0:x.scale)||-1===(null==(g=e[0])?void 0:g.scale))&&(1<k.length||1<e.length)&&0>=m?!1:c.canInterpolateEffects(k[0].effects,e[0].effects):!0}function p(k,e,m){var r,v;const x=k.length>e.length?k:e;k=k.length>e.length?e:k;const g=k[k.length-1];e=null!=(r=null==
g?void 0:g.scale)?r:m;r=null!=(v=null==g?void 0:g.effects)?v:[];for(v=k.length;v<x.length;v++)k.push({scale:e,effects:[...r]});for(v=0;v<x.length;v++)k[v].scale=-1===k[v].scale?m:k[v].scale,x[v].scale=-1===x[v].scale?m:x[v].scale,c.normalizeEffects(k[v].effects,x[v].effects)}q.EffectView=function(k){function e(r){r=k.call(this,r)||this;r._from=null;r._to=null;r._final=null;r._current=[];r._time=0;r.duration=C("mapview-transitions-duration");r.effects=[];return r}t._inheritsLoose(e,k);var m=e.prototype;
m.canTransitionTo=function(r){try{return 0<this.scale&&h(this._current,f(r),this.scale)}catch{return!1}};m.transitionStep=function(r,v){this._applyTimeTransition(r);this._updateForScale(v)};m.end=function(){this._applyTimeTransition(this.duration)};m._transitionTo=function(r){0<this.scale&&h(this._current,r,this.scale)?(this._final=r,this._to=A.clone(r),p(this._current,this._to,this.scale),this._from=A.clone(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=r);this._set("effects",
this._current[0]?A.clone(this._current[0].effects):[])};m._applyTimeTransition=function(r){if(this._to&&this._from&&this._current&&this._final){this._time+=r;r=Math.min(1,this._time/this.duration);for(let x=0;x<this._current.length;x++){const g=this._current[x],u=this._from[x],y=this._to[x];var v=u.scale;g.scale=v+(y.scale-v)*r;for(v=0;v<g.effects.length;v++)g.effects[v].interpolate(u.effects[v],y.effects[v],r)}1===r&&(this._current=this._final,this._set("effects",this._current[0]?A.clone(this._current[0].effects):
[]),this._from=this._to=this._final=null)}};m._updateForScale=function(r){this._set("scale",r);if(0!==this._current.length){var v=this._current,x=this._current.length-1,g,u=1;if(1===v.length||r>=v[0].scale)var y=g=v[0].effects;else if(r<=v[x].scale)y=g=v[x].effects;else for(let z=0;z<x;z++){const w=v[z],B=v[z+1];if(w.scale>=r&&B.scale<=r){u=(r-w.scale)/(B.scale-w.scale);g=w.effects;y=B.effects;break}}for(r=0;r<this.effects.length;r++)this.effects[r].interpolate(g[r],y[r],u)}};t._createClass(e,[{key:"effect",
set:function(r){const v=this._get("effect");r=r||"";if(v!==r){this._set("effect",r);try{this._transitionTo(f(r))}catch(x){this._transitionTo([]),n.getLogger(this.declaredClass).warn("Invalid Effect",{effect:r,error:x})}}}},{key:"hasEffects",get:function(){return this.transitioning||!!this.effects.length}},{key:"scale",set:function(r){this._updateForScale(r)}},{key:"transitioning",get:function(){return null!==this._to}}]);return e}(E);D.__decorate([l.property()],q.EffectView.prototype,"_to",void 0);
D.__decorate([l.property()],q.EffectView.prototype,"duration",void 0);D.__decorate([l.property({value:""})],q.EffectView.prototype,"effect",null);D.__decorate([l.property({readOnly:!0})],q.EffectView.prototype,"effects",void 0);D.__decorate([l.property({readOnly:!0})],q.EffectView.prototype,"hasEffects",null);D.__decorate([l.property({value:0})],q.EffectView.prototype,"scale",null);D.__decorate([l.property({readOnly:!0})],q.EffectView.prototype,"transitioning",null);q.EffectView=D.__decorate([a.subclass("esri.layers.effects.EffectView")],
q.EffectView);q.canInterpolateEffectStops=h;q.convertEffectToStops=f;q.normalizeEffectStops=p;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/DisplayObject":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Evented ../../../core/has ../../../core/maybe ../../../core/promiseUtils".split(" "),function(q,t,D,E,C,A){const n=1/E("mapview-transitions-duration");D=function(l){function d(){var b=l.apply(this,
arguments)||this;b._fadeOutResolver=null;b._fadeInResolver=null;b._clips=null;b.computedVisible=!0;b.computedOpacity=1;b.fadeTransitionEnabled=!1;b.inFadeTransition=!1;b._isReady=!1;b._opacity=1;b._stage=null;b._visible=!0;return b}t._inheritsLoose(d,l);var a=d.prototype;a._getTransforms=function(){C.isNone(this._transforms)&&(this._transforms=this._createTransforms());return this._transforms};a.fadeIn=function(){if(this._fadeInResolver)return this._fadeInResolver.promise;this._fadeOutResolver&&(this._fadeOutResolver(),
this._fadeOutResolver=null);this.computedOpacity=0;this.fadeTransitionEnabled=!0;this._fadeInResolver=A.createResolver();this.requestRender();return this._fadeInResolver.promise};a.fadeOut=function(){if(this._fadeOutResolver)return this._fadeOutResolver.promise;this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null);this.fadeTransitionEnabled=!0;this._fadeOutResolver=A.createResolver();this.requestRender();return this._fadeOutResolver.promise};a.beforeRender=function(b){this.updateTransitionProperties(b.deltaTime,
b.state.scale)};a.afterRender=function(b){this._fadeInResolver&&this.computedOpacity===this.opacity?(this._fadeInResolver(),this._fadeInResolver=null):this._fadeOutResolver&&0===this.computedOpacity&&(this._fadeOutResolver(),this._fadeOutResolver=null)};a.remove=function(){var b;null==(b=this.parent)?void 0:b.removeChild(this)};a.setTransform=function(b){};a.processRender=function(b){this.stage&&this.computedVisible&&this.doRender(b)};a.requestRender=function(){this.stage&&this.stage.requestRender()};
a.processDetach=function(){this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null);this._fadeOutResolver&&(this._fadeOutResolver(),this._fadeOutResolver=null);this.onDetach();this.emit("detach")};a.updateTransitionProperties=function(b,c){if(this.fadeTransitionEnabled){c=this._fadeOutResolver||!this.visible?0:this.opacity;const f=this.computedOpacity;f===c?this.computedVisible=this.visible:(b*=n,this.computedOpacity=f>c?Math.max(c,f-b):Math.min(c,f+b),this.computedVisible=0<this.computedOpacity,
b=c===this.computedOpacity,this.inFadeTransition=!b,b||this.requestRender())}else this.computedOpacity=this.opacity,this.computedVisible=this.visible};a.onAttach=function(){};a.onDetach=function(){};a.doRender=function(b){};a.ready=function(){this._isReady||(this._isReady=!0,this.emit("isReady"),this.requestRender())};t._createClass(d,[{key:"clips",get:function(){return this._clips},set:function(b){this._clips=b;this.requestRender()}},{key:"isReady",get:function(){return this._isReady}},{key:"opacity",
get:function(){return this._opacity},set:function(b){this._opacity!==b&&(this._opacity=Math.min(1,Math.max(b,0)),this.requestRender())}},{key:"stage",get:function(){return this._stage},set:function(b){if(this._stage!==b){var c=this._stage;(this._stage=b)?this._stage.untrashDisplayObject(this)||(this.onAttach(),this.emit("attach")):c.trashDisplayObject(this)}}},{key:"transforms",get:function(){return this._getTransforms()}},{key:"visible",get:function(){return this._visible},set:function(b){this._visible!==
b&&(this._visible=b,this.requestRender())}}]);return d}(D);q.DisplayObject=D;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/enums":function(){define(["exports"],function(q){q.WGLGeometryType=void 0;(function(t){t[t.FILL=0]="FILL";t[t.LINE=1]="LINE";t[t.MARKER=2]="MARKER";t[t.TEXT=3]="TEXT";t[t.LABEL=4]="LABEL"})(q.WGLGeometryType||(q.WGLGeometryType={}));q.WGLGeometryTransactionStatus=void 0;(function(t){t[t.SUCCEEDED=0]="SUCCEEDED";
t[t.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"})(q.WGLGeometryTransactionStatus||(q.WGLGeometryTransactionStatus={}));q.WGLDrawPhase=void 0;(function(t){t[t.NONE=0]="NONE";t[t.MAP=1]="MAP";t[t.LABEL=2]="LABEL";t[t.LABEL_ALPHA=4]="LABEL_ALPHA";t[t.HITTEST=8]="HITTEST";t[t.HIGHLIGHT=16]="HIGHLIGHT";t[t.CLIP=32]="CLIP";t[t.DEBUG=64]="DEBUG";t[t.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(q.WGLDrawPhase||(q.WGLDrawPhase={}));q.VVType=void 0;(function(t){t[t.SIZE=0]="SIZE";t[t.COLOR=1]="COLOR";t[t.OPACITY=
2]="OPACITY";t[t.ROTATION=3]="ROTATION"})(q.VVType||(q.VVType={}));q.WGLVVFlag=void 0;(function(t){t[t.NONE=0]="NONE";t[t.OPACITY=1]="OPACITY";t[t.COLOR=2]="COLOR";t[t.ROTATION=4]="ROTATION";t[t.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";t[t.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";t[t.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";t[t.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(q.WGLVVFlag||(q.WGLVVFlag={}));q.WGLVVTarget=void 0;(function(t){t[t.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";t[t.SCALE_TARGETS_OUTLINE=
256]="SCALE_TARGETS_OUTLINE";t[t.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";t[t.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(q.WGLVVTarget||(q.WGLVVTarget={}));q.MosaicType=void 0;(function(t){t[t.SPRITE=0]="SPRITE";t[t.GLYPH=1]="GLYPH"})(q.MosaicType||(q.MosaicType={}));q.WGLSymbologyType=void 0;(function(t){t[t.DEFAULT=0]="DEFAULT";t[t.SIMPLE=1]="SIMPLE";t[t.DOT_DENSITY=2]="DOT_DENSITY";t[t.OUTLINE_FILL=3]="OUTLINE_FILL";t[t.OUTLINE_FILL_SIMPLE=4]="OUTLINE_FILL_SIMPLE";t[t.HEATMAP=
5]="HEATMAP";t[t.PIE_CHART=6]="PIE_CHART"})(q.WGLSymbologyType||(q.WGLSymbologyType={}));Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/Painter":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../brushes ../vectorTiles/shaders/VTLMaterialManager ./BitBlitRenderer ./enums ./MaterialManager ./TextureManager ./WorldExtentClipRenderer ./effects/AnimationEffect ./effects/BlendEffect ./effects/FeatureEffect ./effects/HighlightEffect ./effects/HittestEffect ./effects/HittestEffectVTL ./effects/post-processing/EffectManager ./painter/RenderPass ../../../webgl/enums ../../../webgl/FramebufferObject ../../../webgl/Renderbuffer".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c,f,h,p,k,e,m,r,v){function x(u,y){switch(u){case A.WGLGeometryType.LINE:return D.brushes.line;case A.WGLGeometryType.TEXT:return D.brushes.text;case A.WGLGeometryType.LABEL:return D.brushes.label;case A.WGLGeometryType.FILL:switch(y){case A.WGLSymbologyType.DOT_DENSITY:return D.brushes.dotDensity;default:return D.brushes.fill}case A.WGLGeometryType.MARKER:switch(y){case A.WGLSymbologyType.HEATMAP:return D.brushes.heatmap;case A.WGLSymbologyType.PIE_CHART:return D.brushes.pieChart;
default:return D.brushes.marker}}}function g(u,y,z,w){return u!==A.WGLDrawPhase.HIGHLIGHT&&(1!==w||t.isSome(y)&&"normal"!==y||t.isSome(z)&&0<z.length)}return function(){function u(z,w,B){this.context=z;this._blitRenderer=new C.BitBlitRenderer;this._worldExtentClipRenderer=new d.WorldExtentClipRenderer;this._isClippedToWorldExtent=!1;this._brushCache=new Map;this._vtlMaterialManager=new E;this._blendEffect=new b.BlendEffect;this._fboPool=[];this.effects={highlight:new f,hittest:new h.HittestEffect,
hittestVTL:new p.HittestEffectVTL,integrate:new a.AnimationEffect,insideEffect:new c.FeatureEffect("inside"),outsideEffect:new c.FeatureEffect("outside")};this.materialManager=new n(z);this.textureManager=new l(w,B);this._effectsManager=new k.EffectManager}var y=u.prototype;y.getRenderTarget=function(){return this._renderTarget};y.setRenderTarget=function(z){this._renderTarget=z};y.getFbos=function(z,w){if(z!==this._lastWidth||w!==this._lastHeight){this._lastWidth=z;this._lastHeight=w;if(this._fbos){for(var B in this._fbos)this._fbos[B].resize(z,
w);return this._fbos}B={target:m.TextureType.TEXTURE_2D,pixelFormat:m.PixelFormat.RGBA,dataType:m.PixelType.UNSIGNED_BYTE,samplingMode:m.TextureSamplingMode.NEAREST,wrapMode:m.TextureWrapMode.CLAMP_TO_EDGE,width:z,height:w};const F={colorTarget:m.TargetType.TEXTURE,depthStencilTarget:m.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER};this._stencilBuf=z=new v.Renderbuffer(this.context,{width:z,height:w,internalFormat:m.RenderbufferFormat.DEPTH_STENCIL});this._fbos={output:new r.FramebufferObject(this.context,
F,B,z),blend:new r.FramebufferObject(this.context,F,B,z),effect0:new r.FramebufferObject(this.context,F,B,z)}}return this._fbos};y.acquireFbo=function(z,w){let B;B=0<this._fboPool.length?this._fboPool.pop():new r.FramebufferObject(this.context,{colorTarget:m.TargetType.TEXTURE,depthStencilTarget:m.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER},{target:m.TextureType.TEXTURE_2D,pixelFormat:m.PixelFormat.RGBA,dataType:m.PixelType.UNSIGNED_BYTE,samplingMode:m.TextureSamplingMode.NEAREST,wrapMode:m.TextureWrapMode.CLAMP_TO_EDGE,
width:z,height:w},this._stencilBuf);const F=B.descriptor;F.width===z&&F.height===w||B.resize(z,w);return B};y.releaseFbo=function(z){this._fboPool.push(z)};y.getSharedStencilBuffer=function(){return this._stencilBuf};y.beforeRenderLayers=function(z,w=null){const {width:B,height:F}=z.getViewport();this._prevFBO=z.getBoundFramebufferObject();const G=this.getFbos(B,F);z.bindFramebuffer(G.output);z.setColorMask(!0,!0,!0,!0);if(t.isSome(w)){const {r:H,g:I,b:L,a:N}=w.color;z.setClearColor(N*H/255,N*I/255,
N*L/255,N)}else z.setClearColor(0,0,0,0);z.setDepthWriteEnabled(!0);z.setClearDepth(1);z.clear(z.gl.COLOR_BUFFER_BIT|z.gl.DEPTH_BUFFER_BIT);z.setDepthWriteEnabled(!1)};y.beforeRenderLayer=function(z,w,B){const {context:F,blendMode:G,effects:H,requireFBO:I,drawPhase:L}=z;I||g(L,G,H,B)?(F.bindFramebuffer(this._fbos.blend),F.setColorMask(!0,!0,!0,!0),F.setClearColor(0,0,0,0),F.setDepthWriteEnabled(!0),F.setClearDepth(1),F.clear(F.gl.COLOR_BUFFER_BIT|F.gl.DEPTH_BUFFER_BIT),F.setDepthWriteEnabled(!1)):
(z=this._getOutputFBO(),F.bindFramebuffer(z));F.setDepthWriteEnabled(!1);F.setDepthTestEnabled(!1);F.setStencilTestEnabled(!0);F.setClearStencil(w);F.setStencilWriteMask(255);F.clear(F.gl.STENCIL_BUFFER_BIT)};y.compositeLayer=function(z,w){const {context:B,blendMode:F,effects:G,requireFBO:H,drawPhase:I}=z;if(H||g(I,F,G,w)){t.isSome(G)&&0<G.length&&I===A.WGLDrawPhase.MAP&&this._applyEffects(z,G);var L=this._getOutputFBO();B.bindFramebuffer(L);B.setStencilTestEnabled(!1);B.setStencilWriteMask(0);B.setBlendingEnabled(!0);
B.setBlendFunctionSeparate(m.BlendFactor.ONE,m.BlendFactor.ONE_MINUS_SRC_ALPHA,m.BlendFactor.ONE,m.BlendFactor.ONE_MINUS_SRC_ALPHA);B.setColorMask(!0,!0,!0,!0);L=t.isNone(F)||I===A.WGLDrawPhase.HIGHLIGHT?"normal":F;this._blendEffect.draw(z,this._fbos.blend.colorTexture,m.TextureSamplingMode.NEAREST,L,w)}};y.renderLayers=function(z){z.bindFramebuffer(this._prevFBO);if(this._fbos){var w=this._getOutputFBO();z.setDepthTestEnabled(!1);z.setStencilWriteMask(0);this._isClippedToWorldExtent?(z.setStencilTestEnabled(!0),
z.setStencilFunction(m.CompareFunction.EQUAL,1,255)):z.setStencilTestEnabled(!1);this.blitTexture(z,w.colorTexture,m.TextureSamplingMode.NEAREST)}};y.prepareDisplay=function(z,w,B){const {context:F}=z;F.bindFramebuffer(this._prevFBO);F.setColorMask(!0,!0,!0,!0);if(t.isSome(w)){const {r:G,g:H,b:I,a:L}=w.color;F.setClearColor(L*G/255,L*H/255,L*I/255,L)}else F.setClearColor(0,0,0,0);F.setStencilWriteMask(255);F.setClearStencil(0);F.clear(F.gl.COLOR_BUFFER_BIT|F.gl.STENCIL_BUFFER_BIT);this._isClippedToWorldExtent=
this._worldExtentClipRenderer.render(z,B)};y.dispose=function(){this.materialManager.dispose();this.textureManager.dispose();this._blitRenderer=t.disposeMaybe(this._blitRenderer);this._worldExtentClipRenderer=t.disposeMaybe(this._worldExtentClipRenderer);this._brushCache&&(this._brushCache.forEach(z=>z.dispose()),this._brushCache.clear(),this._brushCache=null);if(this._fbos)for(const z in this._fbos)this._fbos[z]&&this._fbos[z].dispose();for(const z of this._fboPool)z.dispose();this._fboPool.length=
0;if(this.effects)for(const z in this.effects)this.effects[z]&&this.effects[z].dispose();this._effectsManager.dispose();this._vtlMaterialManager=t.disposeMaybe(this._vtlMaterialManager);this._prevFBO=null};y.getBrush=function(z,w){z=x(z,w);w=this._brushCache.get(z);void 0===w&&(w=new z,this._brushCache.set(z,w));return this._brushCache.get(z)};y.renderObject=function(z,w,B,F){B=D.brushes[B];if(!B)return null;let G=this._brushCache.get(B);void 0===G&&(G=new B,this._brushCache.set(B,G));G.prepareState(z,
w,F);G.draw(z,w,F)};y.renderObjects=function(z,w,B,F){B=D.brushes[B];if(!B)return null;let G=this._brushCache.get(B);void 0===G&&(G=new B,this._brushCache.set(B,G));G.drawMany(z,w,F)};y.registerRenderPass=function(z){const w=z.brushes.map(B=>{this._brushCache.has(B)||this._brushCache.set(B,new B);return this._brushCache.get(B)});return new e(w,z)};y.setHighlightOptions=function(z){this.effects.highlight.setHighlightOptions(z)};y.blitTexture=function(z,w,B,F=1){z.setBlendingEnabled(!0);z.setBlendFunctionSeparate(m.BlendFactor.ONE,
m.BlendFactor.ONE_MINUS_SRC_ALPHA,m.BlendFactor.ONE,m.BlendFactor.ONE_MINUS_SRC_ALPHA);z.setColorMask(!0,!0,!0,!0);this._blitRenderer.render(z,w,B,F)};y.getPostProcessingEffects=function(z){return this._effectsManager.getPostProcessingEffects(z)};y._getOutputFBO=function(){return null!=this._renderTarget?this._renderTarget:this._fbos.output};y._applyEffects=function(z,w){const {context:B}=z;w=this._effectsManager.getPostProcessingEffects(w);for(const {postProcessingEffect:F,effect:G}of w)B.bindFramebuffer(this._fbos.blend),
F.draw(z,this._fbos.blend,G)};q._createClass(u,[{key:"vectorTilesMaterialManager",get:function(){return this._vtlMaterialManager}}]);return u}()})},"esri/views/2d/engine/brushes":function(){define("exports ./flow/BrushFlow ./imagery/BrushRasterBitmap ./imagery/BrushVectorField ./webgl/brushes/BrushBitmap ./webgl/brushes/BrushClip ./webgl/brushes/BrushOverlay ./webgl/brushes/WGLBrushDotDensity ./webgl/brushes/WGLBrushHeatmap ./webgl/brushes/WGLBrushInfo ./webgl/brushes/WGLBrushPieChart ./webgl/brushes/WGLBrushStencil ./webgl/brushes/WGLBrushVTLBackground ./webgl/brushes/WGLBrushVTLCircle ./webgl/brushes/WGLBrushVTLFill ./webgl/brushes/WGLBrushVTLLine ./webgl/brushes/WGLBrushVTLSymbol ./webgl/brushes/WGLGeometryBrushFill ./webgl/brushes/WGLGeometryBrushLabel ./webgl/brushes/WGLGeometryBrushLine ./webgl/brushes/WGLGeometryBrushMarker ./webgl/brushes/WGLGeometryBrushText".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c,f,h,p,k,e,m,r,v,x,g){const u={vtlBackground:f.WGLBrushVTLBackground,vtlFill:p.WGLBrushVTLFill,vtlLine:k.WGLBrushVTLLine,vtlCircle:h.WGLBrushVTLCircle,vtlSymbol:e.WGLBrushVTLSymbol};q.brushes={marker:x,line:v,fill:m,text:g,label:r,clip:A,stencil:c,bitmap:C,overlay:n,raster:D,rasterVF:E,flow:t,tileInfo:a,vtlBackground:f.WGLBrushVTLBackground,vtlFill:p.WGLBrushVTLFill,vtlLine:k.WGLBrushVTLLine,vtlCircle:h.WGLBrushVTLCircle,vtlSymbol:e.WGLBrushVTLSymbol,dotDensity:l,heatmap:d,
pieChart:b};q.vtlBrushes=u;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/flow/BrushFlow":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","../../../../chunks/mat3f32","../webgl/brushes/WGLBrush","../../../webgl/enums"],function(q,t,D,E,C){return function(A){function n(){var d=A.apply(this,arguments)||this;d._visualState={time:0,dvsMat3:D.create(),displayViewMat3:D.create()};return d}q._inheritsLoose(n,
A);var l=n.prototype;l.dispose=function(){};l.prepareState=function(d){({context:d}=d);d.setColorMask(!0,!0,!0,!0);d.setStencilFunction(C.CompareFunction.EQUAL,0,255)};l.draw=function(d,a){const {requestRender:b}=d,{displayData:c}=a;if(!t.isNone(c)&&("loaded"===c.state.name&&c.attach(d),"attached"===c.state.name)){var f=c.state.resources;!f.ready&&t.isSome(b)?b():(this._visualState.time=d.time/1E3,this._visualState.dvsMat3=a.transforms.dvs,this._visualState.displayViewMat3=d.state.displayViewMat3,
c.flowStyle.render(d,this._visualState,f),c.flowStyle.animated&&t.isSome(b)&&b())}};return n}(E)})},"esri/views/2d/engine/webgl/brushes/WGLBrush":function(){define(function(){return function(){function q(){this.name=this.constructor.name||"UnnamedBrush"}var t=q.prototype;t.prepareState=function(D,E,C){};t.draw=function(D,E,C){};t.drawMany=function(D,E,C){for(const A of E)this.draw(D,A,C)};return q}()})},"esri/views/2d/engine/imagery/BrushRasterBitmap":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ./RasterBitmap ../webgl/VertexStream ../webgl/brushes/WGLBrush ../../../webgl/enums ../../../webgl/rasterUtils".split(" "),
function(q,t,D,E,C,A,n){return function(l){function d(){var b=l.apply(this,arguments)||this;b._desc={lut:{vsPath:"raster/lut",fsPath:"raster/lut",attributes:new Map([["a_position",0],["a_texcoord",1]])},stretch:{vsPath:"raster/stretch",fsPath:"raster/stretch",attributes:new Map([["a_position",0],["a_texcoord",1]])},hillshade:{vsPath:"raster/hillshade",fsPath:"raster/hillshade",attributes:new Map([["a_position",0],["a_texcoord",1]])}};b._rendererUniformInfos=new Map;return b}q._inheritsLoose(d,l);
var a=d.prototype;a.dispose=function(){this._quad&&this._quad.dispose()};a.prepareState=function({context:b},c){b.setBlendingEnabled(!0);b.setBlendFunctionSeparate(A.BlendFactor.ONE,A.BlendFactor.ONE_MINUS_SRC_ALPHA,A.BlendFactor.ONE,A.BlendFactor.ONE_MINUS_SRC_ALPHA);b.setColorMask(!0,!0,!0,!0);b.setStencilWriteMask(0);b.setStencilTestEnabled(!0);b.setStencilFunction(A.CompareFunction.EQUAL,c.stencilRef,255)};a.draw=function(b,c){var f;if(D.hasSource(c)&&!c.suspended){var {timeline:h,context:p,painter:k,
requestRender:e}=b;h.begin(this.name);var m=!(null!=(f=p.capabilities.textureFloat)&&f.textureFloatLinear);c.updateTexture(b);b=this._getShaderVariations(c,m);b=k.materialManager.getProgram(this._desc[c.symbolizerParameters.type],b);this._drawWithProgram(p,b,c,e);h.end(this.name)}};a._drawWithProgram=function(b,c,f,h,p=1,k=[0,0],e=!1){this._quad||(this._quad=new E(b,[0,0,1,0,0,1,1,1]));if(t.isSome(h)&&!c.isCompiled)h();else{var {symbolizerParameters:m,transformGrid:r,width:v,height:x,opacity:g}=f;
h=m.type;b.useProgram(c);var u=this._getShaderVariations(f);h=this._getUniformInfos(h,b,c,u);var {names:y,textures:z}=f.getTextures();n.setTextures(b,c,y,z);b=n.getBasicGridUniforms(p,k);e=n.getCommonUniforms(r,[v,x],[f.source.width,f.source.height],g,e);n.setUniforms(c,h,{u_coordScale:f.coordScale,u_dvsMat3:f.transforms.dvs,...b,...e});if(m.colormap){const {colormap:w,colormapOffset:B}=m;f=n.getColormapUniforms(w,B);n.setUniforms(c,h,f)}"stretch"===m.type?(f=n.getStretchUniforms(m),n.setUniforms(c,
h,f)):"hillshade"===m.type&&(f=n.getShadedReliefUniforms(m),n.setUniforms(c,h,f));this._quad.draw()}};a._getUniformInfos=function(b,c,f,h){b=0<h.length?b+"-"+h.join("-"):b;if(this._rendererUniformInfos.has(b))return this._rendererUniformInfos.get(b);c=n.getUniformLocationInfos(c,f);this._rendererUniformInfos.set(b,c);return c};a._getShaderVariations=function(b,c=!1){const f=[],{interpolation:h}=b,{type:p,colormap:k}=b.symbolizerParameters;"cubic"===h?f.push("bicubic"):"bilinear"===h&&"stretch"===
p&&null!=k?(f.push("bilinear"),f.push("nnedge")):c&&"bilinear"===h&&f.push("bilinear");b.isRendereredSource?f.push("noop"):k&&f.push("applyColormap");b.transformGrid&&(f.push("applyProjection"),1===b.transformGrid.spacing[0]&&f.push("lookupProjection"));return f};return d}(C)})},"esri/views/2d/engine/imagery/RasterBitmap":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../../../../chunks/vec2f32 ../../../../layers/support/rasterFunctions/pixelUtils ../DisplayObject ../../../webgl/enums ../../../webgl/rasterUtils".split(" "),
function(q,t,D,E,C,A,n,l,d,a){const b={bandCount:3,outMin:0,outMax:1,minCutOff:[0,0,0],maxCutOff:[255,255,255],factor:[1/255,1/255,1/255],useGamma:!1,gamma:[1,1,1],gammaCorrection:[1,1,1],colormap:null,colormapOffset:null,stretchType:"none",type:"stretch"};l=function(f){function h(k=null,e=null,m=null){var r=f.call(this)||this;r._textureInvalidated=!0;r._colormapTextureInvalidated=!0;r._supportsBilinearTexture=!0;r.stencilRef=0;r.coordScale=[1,1];r._symbolizerParameters=null;r.height=null;r.isRendereredSource=
!1;r.pixelRatio=1;r.resolution=0;r.rotation=0;r._source=null;r.rawPixelData=null;r._suspended=!1;r._bandIds=null;r._interpolation=null;r._transformGrid=null;r.width=null;r.x=0;r.y=0;r.source=k;r.transformGrid=e;r.interpolation=m;return r}t._inheritsLoose(h,f);var p=h.prototype;p.destroy=function(){const k=this.getTextures();null==k?void 0:k.textures.forEach(e=>e.dispose());this._colormapTexture=this._transformGridTexture=this._rasterTexture=null};p.invalidateTexture=function(){this._textureInvalidated||
(this._textureInvalidated=!0,this.requestRender())};p._createTransforms=function(){return{dvs:C.create()}};p.setTransform=function(k){const e=E.identity(this.transforms.dvs),[m,r]=k.toScreenNoRotation([0,0],[this.x,this.y]);var v=this.resolution/this.pixelRatio/k.resolution;const x=v*this.width;v*=this.height;const g=Math.PI*this.rotation/180;E.translate(e,e,A.fromValues(m,r));E.translate(e,e,A.fromValues(x/2,v/2));E.rotate(e,e,-g);E.translate(e,e,A.fromValues(-x/2,-v/2));E.scaleByVec2(e,e,A.fromValues(x,
v));E.multiply(this.transforms.dvs,k.displayViewMat3,e)};p.getTextures=function(){if(!this._rasterTexture)return null;const k=[],e=[];this._transformGridTexture&&(e.push(this._transformGridTexture),k.push("u_transformGrid"));this._rasterTexture&&(e.push(this._rasterTexture),k.push("u_image"));this._colormapTexture&&(e.push(this._colormapTexture),k.push("u_colormap"));return{names:k,textures:e}};p.onAttach=function(){this.invalidateTexture()};p.onDetach=function(){this.invalidateTexture()};p.updateTexture=
function({context:k}){if(this.stage){var e=this._isValidSource(this.source);e&&this._colormapTextureInvalidated&&(this._colormapTextureInvalidated=!1,this._updateColormapTexture(k));this._textureInvalidated&&(this._textureInvalidated=!1,this._createOrDestroyRasterTexture(k),this._rasterTexture&&(e?this.transformGrid&&!this._transformGridTexture&&(this._transformGridTexture=a.createTransformTexture(k,this.transformGrid)):this._rasterTexture.setData(null)),this.suspended||(this.ready(),this.requestRender()))}else{var m,
r;null==(e=this._rasterTexture)?void 0:e.dispose();null==(m=this._transformGridTexture)?void 0:m.dispose();null==(r=this._colormapTexture)?void 0:r.dispose();this._colormapTexture=this._transformGridTexture=this._rasterTextureBandIds=this._rasterTexture=null}};p._createOrDestroyRasterTexture=function(k){var e,m;const r=D.isSome(this.source)?n.extractBands(this.source,this.bandIds):null;if(this._isValidSource(r)){var v=!this._isBandIdschanged(this.bandIds);if(this._rasterTexture){if(v)return;this._rasterTexture.dispose();
this._rasterTexture=this._rasterTextureBandIds=null}this._supportsBilinearTexture=null==(e=k.capabilities.textureFloat)?void 0:e.textureFloatLinear;e=this._getTextureSamplingMethod(this.interpolation);v=this.isRendereredSource||!(null!=(m=k.capabilities.textureFloat)&&m.textureFloat);this._rasterTexture=a.createRasterTexture(k,r,e,v);this._rasterTextureBandIds=this.bandIds?[...this.bandIds]:null}else this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=this._rasterTextureBandIds=
null)};p._isBandIdschanged=function(k){const e=this._rasterTextureBandIds;return!(null==e&&null==k||e&&k&&e.join("")===k.join(""))};p._isValidSource=function(k){var e;return D.isSome(k)&&0<(null==(e=k.pixels)?void 0:e.length)};p._getTextureSamplingMethod=function(k){const {type:e,colormap:m}=this.symbolizerParameters,r="lut"===e||"stretch"===e&&D.isSome(m);return!this._supportsBilinearTexture||r||"bilinear"!==k&&"cubic"!==k?"nearest":"bilinear"};p._updateColormapTexture=function(k){const e=this._colormap,
m=this.symbolizerParameters.colormap;if(!m)this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormap=null;else if(!e)this._colormapTexture=a.createColormapTexture(k,m),this._colormap=m;else if(m.length!==e.length||m.some((r,v)=>r!==e[v]))this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormapTexture=a.createColormapTexture(k,m),this._colormap=m};t._createClass(h,[{key:"symbolizerParameters",get:function(){return this._symbolizerParameters||
b},set:function(k){this._symbolizerParameters!==k&&(this._symbolizerParameters=k,this._colormapTextureInvalidated=!0)}},{key:"source",get:function(){return this._source},set:function(k){this._source!==k&&(this._source=k,this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTextureBandIds=this._rasterTexture=null),this.invalidateTexture())}},{key:"suspended",get:function(){return this._suspended},set:function(k){this._suspended&&!k&&this.stage&&(this.ready(),this.requestRender());this._suspended=
k}},{key:"bandIds",get:function(){return this._bandIds},set:function(k){this._bandIds=k;this._isBandIdschanged(k)&&this.invalidateTexture()}},{key:"interpolation",get:function(){return this._interpolation||"nearest"},set:function(k){this._interpolation=k;this._rasterTexture&&this._rasterTexture.setSamplingMode("bilinear"===this._getTextureSamplingMethod(k)?d.TextureSamplingMode.LINEAR:d.TextureSamplingMode.NEAREST)}},{key:"transformGrid",get:function(){return this._transformGrid},set:function(k){this._transformGrid=
k;this._transformGridTexture&&(this._transformGridTexture.dispose(),this._transformGridTexture=null)}}]);return h}(l.DisplayObject);let c=function(f){function h(){return f.apply(this,arguments)||this}t._inheritsLoose(h,f);t._createClass(h,[{key:"source",get:function(){return this._source}}]);return h}(l);q.RasterBitmap=l;q.RasterBitmapWithSource=c;q.hasSource=function(f){return D.isSome(f.source)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["exports",
"../../../core/maybe","../PixelBlock"],function(q,t,D){function E(k){return t.isSome(k)&&"esri.layers.support.PixelBlock"===k.declaredClass&&k.pixels&&0<k.pixels.length}function C(k,e,m,r,v,x,g,u){return{xmin:v<=m*k?0:v<m*k+k?v-m*k:k,ymin:x<=r*e?0:x<r*e+e?x-r*e:e,xmax:v+g<=m*k?0:v+g<m*k+k?v+g-m*k:k,ymax:x+u<=r*e?0:x+u<r*e+e?x+u-r*e:e}}function A(k,e,m,r,v,x){const {width:g,height:u}=m.block,{x:y,y:z}=m.offset,{width:w,height:B}=m.mosaic;m=C(g,u,r,v,y,z,w,B);let F=0;var G=0;if(x){var H=x.hasGCSSShiftTransform?
360:x.halfWorldWidth,I=g*x.resolutionX,L=x.startX+r*I;I=L+I;L<H&&I>H?G=x.rightPadding:L>=H&&(F=x.leftMargin-x.rightPadding,G=0)}m.xmax-=G;if("number"===typeof e)for(x=m.ymin;x<m.ymax;x++)for(G=(v*u+x-z)*w+(r*g-y)+F,H=m.xmin;H<m.xmax;H++)k[G+H]=e;else for(x=m.ymin;x<m.ymax;x++)for(G=(v*u+x-z)*w+(r*g-y)+F,H=x*g,L=m.xmin;L<m.xmax;L++)k[G+L]=e[H+L]}function n(k,e,m={}){const {clipOffset:r,clipSize:v,alignmentInfo:x,blockWidths:g}=m;if(g)return l(k,e,{blockWidths:g});var u=k.find(J=>E(J));if(t.isNone(u))return null;
m=v?v.width:e.width;const y=v?v.height:e.height;var z=u.width,w=u.height;const B=e.width/z,F=e.height/w;e={offset:r||{x:0,y:0},mosaic:v||e,block:{width:z,height:w}};z=u.pixelType;w=D.getPixelArrayConstructor(z);var G=u.pixels.length;u=[];for(var H=0;H<G;H++){var I=new w(m*y);for(let J=0;J<F;J++)for(let K=0;K<B;K++){var L=k[J*B+K];E(L)&&(L=L.pixels[H],A(I,L,e,K,J,x))}u.push(I)}let N;if(k.some(J=>t.isNone(J)||J.mask&&0<J.mask.length))for(N=new Uint8Array(m*y),w=0;w<F;w++)for(G=0;G<B;G++)I=k[w*B+G],
(H=t.isSome(I)?I.mask:null)?A(N,H,e,G,w,x):I?A(N,1,e,G,w,x):A(N,0,e,G,w,x);k=new D({width:m,height:y,pixels:u,pixelType:z,mask:N});k.updateStatistics();return k}function l(k,e,m){const r=k.find(G=>t.isSome(G));if(t.isNone(r))return null;var v=k.some(G=>t.isSome(G)?!!G.mask:!0);const {width:x,height:g}=e;e=v?new Uint8Array(x*g):null;({blockWidths:m}=m);const u=[],y=r.getPlaneCount(),z=D.getPixelArrayConstructor(r.pixelType);if(v)for(let G=0,H=0;G<k.length;H+=m[G],G++)if(v=k[G],E(v)){var w=v.mask;for(var B=
0;B<g;B++)for(var F=0;F<m[G];F++)e[B*x+F+H]=null==w?255:w[B*v.width+F]}for(v=0;v<y;v++){w=new z(x*g);for(let G=0,H=0;G<k.length;H+=m[G],G++)if(B=k[G],E(B)&&(F=B.pixels[v],null!=F))for(let I=0;I<g;I++)for(let L=0;L<m[G];L++)w[I*x+L+H]=F[I*B.width+L];u.push(w)}k=new D({width:x,height:g,mask:e,pixels:u,pixelType:r.pixelType});k.updateStatistics();return k}function d(k){if(!E(k))return null;const e=k.clone(),{width:m,height:r,pixels:v,mask:x}=k;var g=v[0];k=e.pixels[0];for(let z=2;z<r-1;z++){const w=
new Map;for(var u=z-2;u<z+2;u++)for(var y=0;4>y;y++){const B=u*m+y;c(w,g[B],x?x[B]:1)}k[z*m]=a(w);k[z*m+1]=k[z*m+2]=k[z*m];for(u=3;u<m-1;u++)y=(z-2)*m+u+1,c(w,g[y],x?x[y]:1),y=(z-1)*m+u+1,c(w,g[y],x?x[y]:1),y=z*m+u+1,c(w,g[y],x?x[y]:1),y=(z+1)*m+u+1,c(w,g[y],x?x[y]:1),y=(z-2)*m+u-3,b(w,g[y],x?x[y]:1),y=(z-1)*m+u-3,b(w,g[y],x?x[y]:1),y=z*m+u-3,b(w,g[y],x?x[y]:1),y=(z+1)*m+u-3,b(w,g[y],x?x[y]:1),k[z*m+u]=a(w);k[z*m+u+1]=k[z*m+u]}for(g=0;g<m;g++)k[g]=k[m+g]=k[2*m+g],k[(r-1)*m+g]=k[(r-2)*m+g];e.updateStatistics();
return e}function a(k){if(0===k.size)return 0;let e=0,m=-1,r=0;const v=k.keys();let x=v.next();for(;!x.done;)r=k.get(x.value),r>e&&(m=x.value,e=r),x=v.next();return m}function b(k,e,m){0!==m&&(m=k.get(e),1===m?k.delete(e):k.set(e,m-1))}function c(k,e,m){0!==m&&k.set(e,k.has(e)?k.get(e)+1:1)}function f(k,e,m){let {x:r,y:v}=e;const {width:x,height:g}=m;if(0===r&&0===v&&g===k.height&&x===k.width)return k;const {width:u,height:y}=k;e=Math.max(0,v);const z=Math.max(0,r),w=Math.min(r+x,u),B=Math.min(v+
g,y);if(0>w||0>B||!E(k))return null;r=Math.max(0,-r);v=Math.max(0,-v);const {pixels:F,mask:G}=k;var H=x*g,I=F.length;const L=[];for(var N=0;N<I;N++){var J=F[N],K=D.createEmptyBand(k.pixelType,H);for(let O=e;O<B;O++){const W=O*u;let aa=(O+v-e)*x+r;for(let ba=z;ba<w;ba++)K[aa++]=J[W+ba]}L.push(K)}H=new Uint8Array(H);for(I=e;I<B;I++)for(N=I*u,J=(I+v-e)*x+r,K=z;K<w;K++)H[J++]=G?G[N+K]:1;k=new D({width:m.width,height:m.height,pixelType:k.pixelType,pixels:L,mask:H});k.updateStatistics();return k}function h(k,
e=!0){if(!E(k))return null;const {pixels:m,width:r,height:v,mask:x,pixelType:g}=k;k=[];const u=Math.round(r/2),y=Math.round(v/2),z=v-1,w=r-1;for(var B=0;B<m.length;B++){var F=m[B],G=D.createEmptyBand(g,u*y),H=0;for(var I=0;I<v;I+=2)for(var L=0;L<r;L+=2){var N=F[I*r+L];if(e){var J=L===w?N:F[I*r+L+1];const K=I===z?N:F[I*r+L+r],O=L===w?K:I===z?J:F[I*r+L+r+1];G[H++]=(N+J+K+O)/4}else G[H++]=N}k.push(G)}B=null;if(x)for(B=new Uint8Array(u*y),F=0,G=0;G<v;G+=2)for(H=0;H<r;H+=2)I=x[G*r+H],e?(L=H===w?I:x[G*
r+H+1],N=G===z?I:x[G*r+H+r],J=H===w?N:G===z?L:x[G*r+H+r+1],B[F++]=I*L*N*J?1:0):B[F++]=I;return new D({width:u,height:y,pixelType:g,pixels:k,mask:B})}function p(k,e,m,r,v=.5){const {width:x,height:g}=k,{width:u,height:y}=e;k=r.cols;r=r.rows;e=Math.ceil(u/k-.1/k);const z=Math.ceil(y/r-.1/r);let w,B,F,G,H;const I=e*k;var L=I*z*r;const N=new Float32Array(L),J=new Float32Array(L),K=new Uint32Array(L),O=new Uint32Array(L);let W=0,aa,ba;for(let Q=0;Q<z;Q++)for(let Y=0;Y<e;Y++){var S=12*(Q*e+Y);L=m[S];w=
m[S+1];B=m[S+2];F=m[S+3];G=m[S+4];H=m[S+5];for(var M=0;M<r;M++){W=(Q*r+M)*I+Y*k;ba=(M+.5)/r;for(let V=0;V<M;V++)aa=(V+.5)/k,N[W+V]=(L*aa+w*ba+B)*x-v,J[W+V]=(F*aa+G*ba+H)*g-v,K[W+V]=Math.round(N[W+V]),O[W+V]=Math.round(J[W+V])}S+=6;L=m[S];w=m[S+1];B=m[S+2];F=m[S+3];G=m[S+4];H=m[S+5];for(S=0;S<r;S++)for(W=(Q*r+S)*I+Y*k,ba=(S+.5)/r,M=S;M<k;M++)aa=(M+.5)/k,N[W+M]=(L*aa+w*ba+B)*x-v,J[W+M]=(F*aa+G*ba+H)*g-v,K[W+M]=Math.round(N[W+M]),O[W+M]=Math.round(J[W+M])}return{offsets_x:N,offsets_y:J,offsets_xi:K,
offsets_yi:O,gridWidth:I}}q.approximateTransform=function(k,e,m,r,v="nearest"){if(!E(k))return null;"majority"===v&&(k=d(k));const {pixels:x,mask:g,pixelType:u}=k,y=k.width;var z=k.height;const w=D.getPixelArrayConstructor(u),B=x.length,{width:F,height:G}=e;k=!1;for(let O=0;O<m.length;O+=3)-1===m[O]&&-1===m[O+1]&&-1===m[O+2]&&(k=!0);const {offsets_x:H,offsets_y:I,offsets_xi:L,offsets_yi:N,gridWidth:J}=p({width:y,height:z},e,m,r,"majority"===v?0:.5);let K;e=(O,W,aa)=>{const ba=O instanceof Float32Array||
O instanceof Float64Array?0:.5;for(let S=0;S<G;S++){K=S*J;for(let M=0;M<F;M++){if(0>H[K]||0>I[K])O[S*F+M]=0;else if(aa)O[S*F+M]=W[L[K]+N[K]*y];else{const Q=Math.floor(H[K]),Y=Math.floor(I[K]),V=Math.ceil(H[K]),P=Math.ceil(I[K]),X=H[K]-Q,R=I[K]-Y;O[S*F+M]=!g||g[Q+Y*y]&&g[Q+Y*y]&&g[Q+P*y]&&g[V+P*y]?(1-R)*((1-X)*W[Q+Y*y]+X*W[V+Y*y])+R*((1-X)*W[Q+P*y]+X*W[V+P*y])+ba:W[L[K]+N[K]*y]}K++}}};m=[];for(z=0;z<B;z++)r=new w(F*G),e(r,x[z],"nearest"===v||"majority"===v),m.push(r);v=new D({width:F,height:G,pixelType:u,
pixels:m});if(g)v.mask=new Uint8Array(F*G),e(v.mask,g,!0);else if(k)for(v.mask=new Uint8Array(F*G),k=0;k<F*G;k++)v.mask[k]=0>H[k]||0>I[k]?0:1;v.updateStatistics();return v};q.clip=f;q.colorize=function(k,e){if(!E(k)||!e&&(e.indexedColormap||e.indexed2DColormap))return k;const m=k.clone();var r=m.pixels;let v=m.mask;const x=m.width*m.height;if(1!==r.length)return k;const {indexedColormap:g,indexed2DColormap:u,offset:y,alphaSpecified:z}=e;e=g.length-1;k=0;r=r[0];const w=new Uint8Array(r.length),B=new Uint8Array(r.length),
F=new Uint8Array(r.length);let G=0;if(g)if(v)for(k=0;k<x;k++)v[k]&&(G=4*(r[k]-y),G<y||G>e?v[k]=0:(w[k]=g[G],B[k]=g[G+1],F[k]=g[G+2],v[k]=g[G+3]));else{v=new Uint8Array(x);for(k=0;k<x;k++)G=4*(r[k]-y),G<y||G>e?v[k]=0:(w[k]=g[G],B[k]=g[G+1],F[k]=g[G+2],v[k]=g[G+3]);m.mask=v}else if(v)for(k=0;k<x;k++)v[k]&&(e=u[r[k]],w[k]=e[0],B[k]=e[1],F[k]=e[2],v[k]=e[3]);else{v=new Uint8Array(x);for(k=0;k<x;k++)e=u[r[k]],w[k]=e[0],B[k]=e[1],F[k]=e[2],v[k]=e[3];m.mask=v}m.pixels=[w,B,F];m.statistics=null;m.pixelType=
"u8";m.maskIsAlpha=z;return m};q.createColormapLUT=function(k){if(k){var e=k.colormap;if(e&&0!==e.length){e=e.sort((z,w)=>z[0]-w[0]);var m=0;0>e[0][0]&&(m=e[0][0]);var r=Math.max(256,e[e.length-1][0]-m+1),v=new Uint8Array(4*r),x=[],g=0,u=0,y=5===e[0].length;if(65536<r)return e.forEach(z=>{x[z[0]-m]=y?z.slice(1):z.slice(1).concat([255])}),{indexed2DColormap:x,offset:m,alphaSpecified:y};if(k.fillUnspecified)for(k=e[u],g=k[0]-m;g<r;g++)v[4*g]=k[1],v[4*g+1]=k[2],v[4*g+2]=k[3],v[4*g+3]=y?k[4]:255,g===
k[0]-m&&(k=u===e.length-1?k:e[++u]);else for(g=0;g<e.length;g++)k=e[g],u=4*(k[0]-m),v[u]=k[1],v[u+1]=k[2],v[u+2]=k[3],v[u+3]=y?k[4]:255;return{indexedColormap:v,offset:m,alphaSpecified:y}}}};q.extractBands=function(k,e){if(null==e||!e.length||!E(k))return k;const m=k.pixels.length;return e&&e.some(r=>r>=m)||1===m&&1===e.length&&0===e[0]||m===e.length&&!e.some((r,v)=>r!==v)?k:new D({pixelType:k.pixelType,width:k.width,height:k.height,mask:k.mask,validPixelCount:k.validPixelCount,maskIsAlpha:k.maskIsAlpha,
pixels:e.map(r=>k.pixels[r]),statistics:k.statistics&&e.map(r=>k.statistics[r])})};q.getClipBounds=C;q.getLocalArithmeticNorthRotations=function(k,e){const {coefficients:m,spacing:r}=e,{offsets_x:v,offsets_y:x,gridWidth:g}=p(k,k,m,{rows:r[0],cols:r[1]},.5),{width:u,height:y}=k;k=new Float32Array(u*y);e=180/Math.PI;for(let B=0;B<y;B++)for(let F=0;F<u;F++){var z=B*g+F,w=0===B?z:z-g;const G=B===y-1?z:z+g;z=v[w]-v[G];w=x[G]-x[w];isNaN(z)||isNaN(w)?k[B*u+F]=90:(w=Math.atan2(w,z)*e,w=(360+w)%360,k[B*u+
F]=w)}return k};q.isValidPixelBlock=E;q.lookupPixels=function(k,e){if(!E(k))return null;const {pixels:m,mask:r}=k,v=k.width*k.height,x=m.length;let g=e.lut;({offset:e}=e);let u,y;g&&1===g[0].length&&(g=m.map(()=>g));const z=[];let w,B,F;if(e)if(null==r)for(u=0;u<x;u++){w=m[u];B=g[u];F=new Uint8Array(v);for(y=0;y<v;y++)F[y]=B[w[y]-e];z.push(F)}else for(u=0;u<x;u++){w=m[u];B=g[u];F=new Uint8Array(v);for(y=0;y<v;y++)r[y]&&(F[y]=B[w[y]-e]);z.push(F)}else if(null==r)for(u=0;u<x;u++){w=m[u];B=g[u];F=new Uint8Array(v);
for(y=0;y<v;y++)F[y]=B[w[y]];z.push(F)}else for(u=0;u<x;u++){w=m[u];B=g[u];F=new Uint8Array(v);for(y=0;y<v;y++)r[y]&&(F[y]=B[w[y]]);z.push(F)}k=new D({width:k.width,height:k.height,pixels:z,mask:r,pixelType:"u8"});k.updateStatistics();return k};q.mosaic=n;q.mosaicPixelData=function(k,e){if(!k||0===k.length)return null;var m=k.find(B=>B.pixelBlock);if(!m||t.isNone(m.pixelBlock))return null;var r=(m.extent.xmax-m.extent.xmin)/m.pixelBlock.width;const v=(m.extent.ymax-m.extent.ymin)/m.pixelBlock.height,
x=.01*Math.min(r,v),g=k.sort((B,F)=>Math.abs(B.extent.ymax-F.extent.ymax)>x?F.extent.ymax-B.extent.ymax:Math.abs(B.extent.xmin-F.extent.xmin)>x?B.extent.xmin-F.extent.xmin:0);var u=Math.min.apply(null,g.map(B=>B.extent.xmin));const y=Math.min.apply(null,g.map(B=>B.extent.ymin)),z=Math.max.apply(null,g.map(B=>B.extent.xmax)),w=Math.max.apply(null,g.map(B=>B.extent.ymax));k={x:Math.round((e.xmin-u)/r),y:Math.round((w-e.ymax)/v)};u={width:Math.round((z-u)/r),height:Math.round((w-y)/v)};r={width:Math.round((e.xmax-
e.xmin)/r),height:Math.round((e.ymax-e.ymin)/v)};if(Math.round(u.width/m.pixelBlock.width)*Math.round(u.height/m.pixelBlock.height)!==g.length||0>k.x||0>k.y||u.width<r.width||u.height<r.height)return null;m=g.map(B=>B.pixelBlock);m=n(m,u,{clipOffset:k,clipSize:r});return{extent:e,pixelBlock:m}};q.remapColor=function(k,e){if(!E(k))return null;k=k.clone();var {pixels:m}=k;const r=k.width*k.height,v=e.length,x=Math.floor(v/2),g=e[Math.floor(x)];m=m[0];let u,y,z,w,B,F,G=!1;const H=new Uint8Array(r),I=
new Uint8Array(r),L=new Uint8Array(r);let N=k.mask;const J=4===e[0].mappedColor.length;N||(N=new Uint8Array(r),N.fill(J?255:1),k.mask=N);for(B=0;B<r;B++)if(N[B]){u=m[B];G=!1;F=x;y=g;z=0;for(w=v-1;1<w-z;){if(u===y.value){G=!0;break}u>y.value?z=F:w=F;F=Math.floor((z+w)/2);y=e[Math.floor(F)]}G||(u===e[z].value?(y=e[z],G=!0):u===e[w].value?(y=e[w],G=!0):u<e[z].value?(G=!1,y=null):u>e[z].value&&(u<e[w].value?(y=e[z],G=!0):w===v-1?(G=!1,y=null):(y=e[w],G=!0)));G?(H[B]=y.mappedColor[0],I[B]=y.mappedColor[1],
L[B]=y.mappedColor[2],N[B]=y.mappedColor[3]):H[B]=I[B]=L[B]=N[B]=0}k.pixels=[H,I,L];k.mask=N;k.pixelType="u8";k.maskIsAlpha=J;return k};q.resampleByMajority=d;q.setValidBoundary=function(k,e,m){if(!E(k))return null;const {width:r,height:v}=k,x=e.x;e=e.y;const g=m.width+x;m=m.height+e;if(0>x||0>e||g>r||m>v||0===x&&0===e&&g===r&&m===v)return k;k.mask||(k.mask=new Uint8Array(r*v));const u=k.mask;for(let y=0;y<v;y++){const z=y*r;for(let w=0;w<r;w++)u[z+w]=y<e||y>=m||w<x||w>=g?0:1}k.updateStatistics();
return k};q.split=function(k,e,m){if(!E(k))return null;const {width:r,height:v}=e;let {width:x,height:g}=k;const u=new Map,y={x:0,y:0};m=null==m?1:1+m;for(let z=0;z<m;z++){const w=Math.ceil(x/r),B=Math.ceil(g/v);for(let F=0;F<B;F++){y.y=F*v;for(let G=0;G<w;G++){y.x=G*r;const H=f(k,y,e);u.set(`${z}/${F}/${G}`,H)}}z<m-1&&(k=h(k));x=Math.round(x/2);g=Math.round(g/2)}return u};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/PixelBlock":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Error ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b){var c;const f=n.getLogger("esri.layers.support.PixelBlock");D=c=function(h){function p(e){e=h.call(this,e)||this;e.width=null;e.height=null;e.pixelType="f32";e.validPixelCount=null;e.mask=null;e.maskIsAlpha=!1;e.pixels=null;e.statistics=null;return e}q._inheritsLoose(p,h);p.createEmptyBand=function(e,m){return new (c.getPixelArrayConstructor(e))(m)};p.getPixelArrayConstructor=function(e){let m;switch(e){case "u1":case "u2":case "u4":case "u8":m=Uint8Array;break;case "u16":m=
Uint16Array;break;case "u32":m=Uint32Array;break;case "s8":m=Int8Array;break;case "s16":m=Int16Array;break;case "s32":m=Int32Array;break;case "f32":m=Float32Array;break;case "f64":m=Float64Array;break;case "c64":case "c128":case "unknown":m=Float32Array}return m};var k=p.prototype;k.castPixelType=function(e){if(!e)return"f32";e=e.toLowerCase();["u1","u2","u4"].includes(e)?e="u8":"unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").includes(e)||(e="f32");return e};k.getPlaneCount=function(){return this.pixels&&
this.pixels.length};k.addData=function(e){if(!e.pixels||e.pixels.length!==this.width*this.height)throw new E("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]);this.statistics||(this.statistics=[]);this.pixels.push(e.pixels);this.statistics.push(e.statistics||{minValue:null,maxValue:null})};k.getAsRGBA=function(){const e=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(e);
break;default:this._fillFrom8Bit(e)}return new Uint8ClampedArray(e)};k.getAsRGBAFloat=function(){const e=new Float32Array(this.width*this.height*4);this._fillFrom32Bit(e);return e};k.updateStatistics=function(){this.statistics=this.pixels.map(r=>this._calculateBandStatistics(r,this.mask));const e=this.mask;let m=0;if(e)for(let r=0;r<e.length;r++)e[r]&&m++;else m=this.width*this.height;this.validPixelCount=m};k.clamp=function(e){if(e&&"f64"!==e&&"f32"!==e){switch(e){case "u8":var m=[0,255];break;case "u16":m=
[0,65535];break;case "u32":m=[0,4294967295];break;case "s8":m=[-128,127];break;case "s16":m=[-32768,32767];break;case "s32":m=[-2147483648,2147483647];break;default:m=[-3.4*1E39,3.4*1E39]}var [r,v]=m;m=this.pixels;var x=this.width*this.height,g=m.length,u=[];for(let B=0;B<g;B++){var y=c.createEmptyBand(e,x);var z=m[B];for(let F=0;F<x;F++){var w=z[F];y[F]=w>v?v:w<r?r:w}u.push(y)}this.pixels=u;this.pixelType=e}};k.extractBands=function(e){if(l.isNone(e)||0===e.length||null==this.pixels||0===this.pixels.length)return this;
var m=this.pixels.length;const r=e.some(v=>v>=this.pixels.length);m=m===e.length&&!e.some((v,x)=>v!==x);return r||m?this:new c({pixelType:this.pixelType,width:this.width,height:this.height,mask:this.mask,validPixelCount:this.validPixelCount,maskIsAlpha:this.maskIsAlpha,pixels:e.map(v=>this.pixels[v]),statistics:this.statistics&&e.map(v=>this.statistics[v])})};k.clone=function(){const e=new c({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});
this.mask&&(e.mask=this.mask instanceof Uint8Array?new Uint8Array(this.mask):this.mask.slice(0));let m;const r=c.getPixelArrayConstructor(this.pixelType);if(this.pixels&&0<this.pixels.length){e.pixels=[];const v=this.pixels[0].slice;for(m=0;m<this.pixels.length;m++)e.pixels[m]=v?this.pixels[m].slice(0,this.pixels[m].length):new r(this.pixels[m])}if(this.statistics)for(e.statistics=[],m=0;m<this.statistics.length;m++)e.statistics[m]=A.clone(this.statistics[m]);return e};k._fillFrom8Bit=function(e){const {mask:m,
maskIsAlpha:r,pixels:v}=this;if(e&&v&&v.length){var x,g;var u=x=g=v[0];3<=v.length?(x=v[1],g=v[2]):2===v.length&&(x=v[1]);var y=new Uint32Array(e),z=this.width*this.height;if(u.length!==z)f.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(m&&m.length===z)if(r)for(e=0;e<z;e++)m[e]&&(y[e]=m[e]<<24|g[e]<<16|x[e]<<8|u[e]);else for(e=0;e<z;e++)m[e]&&(y[e]=-16777216|g[e]<<16|x[e]<<8|u[e]);else for(e=0;e<z;e++)y[e]=-16777216|g[e]<<16|x[e]<<8|u[e]}else f.error("getAsRGBA()",
"Unable to convert to RGBA. The input pixel block is empty.")};k._fillFromNon8Bit=function(e){const {pixels:m,mask:r,statistics:v}=this;if(e&&m&&m.length){var x=this.pixelType,g=1,u=0;g=1;v&&0<v.length?(u=v.map(F=>F.minValue).reduce((F,G)=>Math.min(F,G)),g=v.map(F=>F.maxValue-F.minValue).reduce((F,G)=>Math.max(F,G)),g=255/g):(g=255,"s8"===x?(u=-128,g=127):"u16"===x?g=65535:"s16"===x?(u=-32768,g=32767):"u32"===x?g=4294967295:"s32"===x?(u=-2147483648,g=2147483647):"f32"===x?(u=-3.4*1E39,g=3.4*1E39):
"f64"===x&&(u=-Number.MAX_VALUE,g=Number.MAX_VALUE),g=255/(g-u));e=new Uint32Array(e);x=this.width*this.height;var y,z,w;var B=y=z=m[0];if(B.length!==x)return f.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(2<=m.length)if(y=m[1],3<=m.length&&(z=m[2]),r&&r.length===x)for(w=0;w<x;w++)r[w]&&(e[w]=-16777216|(z[w]-u)*g<<16|(y[w]-u)*g<<8|(B[w]-u)*g);else for(w=0;w<x;w++)e[w]=-16777216|(z[w]-u)*g<<16|(y[w]-u)*g<<8|(B[w]-u)*g;else if(r&&r.length===x)for(w=0;w<x;w++)y=(B[w]-
u)*g,r[w]&&(e[w]=-16777216|y<<16|y<<8|y);else for(w=0;w<x;w++)y=(B[w]-u)*g,e[w]=-16777216|y<<16|y<<8|y}else f.error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};k._fillFrom32Bit=function(e){const {pixels:m,mask:r}=this;if(!e||!m||!m.length)return f.error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");let v,x,g,u;v=x=g=m[0];3<=m.length?(x=m[1],g=m[2]):2===m.length&&(x=m[1]);const y=this.width*this.height;if(v.length!==y)return f.error("getAsRGBAFloat()",
"Unable to convert to RGBA. The pixelblock is invalid.");let z=0;if(r&&r.length===y)for(u=0;u<y;u++)e[z++]=v[u],e[z++]=x[u],e[z++]=g[u],e[z++]=r[u]&1;else for(u=0;u<y;u++)e[z++]=v[u],e[z++]=x[u],e[z++]=g[u],e[z++]=1};k._calculateBandStatistics=function(e,m){let r=Infinity,v=-Infinity;const x=e.length;let g,u=0;if(m)for(g=0;g<x;g++)m[g]&&(u=e[g],r=u<r?u:r,v=u>v?u:v);else for(g=0;g<x;g++)u=e[g],r=u<r?u:r,v=u>v?u:v;return{minValue:r,maxValue:v}};return p}(C.JSONSupport);t.__decorate([d.property({json:{write:!0}})],
D.prototype,"width",void 0);t.__decorate([d.property({json:{write:!0}})],D.prototype,"height",void 0);t.__decorate([d.property({json:{write:!0}})],D.prototype,"pixelType",void 0);t.__decorate([a.cast("pixelType")],D.prototype,"castPixelType",null);t.__decorate([d.property({json:{write:!0}})],D.prototype,"validPixelCount",void 0);t.__decorate([d.property({json:{write:!0}})],D.prototype,"mask",void 0);t.__decorate([d.property({json:{write:!0}})],D.prototype,"maskIsAlpha",void 0);t.__decorate([d.property({json:{write:!0}})],
D.prototype,"pixels",void 0);t.__decorate([d.property({json:{write:!0}})],D.prototype,"statistics",void 0);return D=c=t.__decorate([b.subclass("esri.layers.support.PixelBlock")],D)})},"esri/views/webgl/rasterUtils":function(){define("exports ../../chunks/vec2f64 ./context-util ./enums ./FramebufferObject ./Texture".split(" "),function(q,t,D,E,C,A){q.createColormapTexture=function(n,l){return new A.Texture(n,{width:l.length/4,height:1,target:E.TextureType.TEXTURE_2D,pixelFormat:E.PixelFormat.RGBA,
internalFormat:E.PixelFormat.RGBA,dataType:E.PixelType.UNSIGNED_BYTE,samplingMode:E.TextureSamplingMode.NEAREST,wrapMode:E.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1},l)};q.createFrameBuffer=function(n,l,d,a){a=new A.Texture(n,{width:l,height:d,target:E.TextureType.TEXTURE_2D,pixelFormat:E.PixelFormat.RGBA,internalFormat:E.PixelFormat.RGBA,samplingMode:E.TextureSamplingMode.NEAREST,dataType:a?E.PixelType.UNSIGNED_BYTE:E.PixelType.FLOAT,wrapMode:E.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1});return new C.FramebufferObject(n,
{colorTarget:E.TargetType.TEXTURE,depthStencilTarget:E.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER,width:l,height:d},a)};q.createRasterTexture=function(n,l,d="nearest",a=!1){var b;const c=(a=!(a&&"u8"===l.pixelType))?E.PixelType.FLOAT:E.PixelType.UNSIGNED_BYTE,f=null==l.pixels||0===l.pixels.length?null:a?l.getAsRGBAFloat():l.getAsRGBA(),h=null==(b=n.capabilities.textureFloat)?void 0:b.textureFloatLinear;return new A.Texture(n,{width:l.width,height:l.height,target:E.TextureType.TEXTURE_2D,pixelFormat:E.PixelFormat.RGBA,
internalFormat:n.type===D.ContextType.WEBGL2&&a?E.SizedPixelFormat.RGBA32F:E.PixelFormat.RGBA,samplingMode:!h||"bilinear"!==d&&"cubic"!==d?E.TextureSamplingMode.NEAREST:E.TextureSamplingMode.LINEAR,dataType:c,wrapMode:E.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1},f)};q.createTransformTexture=function(n,l){const {spacing:d,offsets:a,coefficients:b,size:[c,f]}=l;var h=1<d[0];l={width:h?4*c:c,height:f,target:E.TextureType.TEXTURE_2D,pixelFormat:E.PixelFormat.RGBA,internalFormat:n.type===D.ContextType.WEBGL2?
E.SizedPixelFormat.RGBA32F:E.PixelFormat.RGBA,dataType:E.PixelType.FLOAT,samplingMode:E.TextureSamplingMode.NEAREST,wrapMode:E.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1};const p=new Float32Array(h?c*f*16:2*a.length);if(h)for(let k=0,e=0;k<b.length;k++)p[e++]=b[k],2===k%3&&(p[e++]=1);else for(h=0;h<f;h++)for(let k=0;k<c;k++){const e=4*(h*c+k),m=2*(k*f+h);p[e]=a[m];p[e+1]=a[m+1];p[e+3]=-1===a[m]?0:1}return new A.Texture(n,l,p)};q.getBasicGridUniforms=function(n,l){return{u_scale:n,u_offset:l}};q.getColormapUniforms=
function(n,l){return{u_colormapOffset:l||0,u_colormapMaxIndex:n?n.length/4-1:0}};q.getCommonUniforms=function(n,l,d,a=1,b=!0){return{u_flipY:b,u_applyTransform:n?!0:!1,u_opacity:a,u_transformSpacing:n?n.spacing:t.ZEROS,u_transformGridSize:n?n.size:t.ZEROS,u_targetImageSize:l,u_srcImageSize:d}};q.getShadedReliefUniforms=function(n){return{u_hillshadeType:n.hillshadeType,u_sinZcosAs:n.sinZcosAs,u_sinZsinAs:n.sinZsinAs,u_cosZs:n.cosZs,u_weights:n.weights,u_factor:n.factor,u_minValue:n.minValue,u_maxValue:n.maxValue}};
q.getStretchUniforms=function(n){return{u_bandCount:n.bandCount,u_minOutput:n.outMin,u_maxOutput:n.outMax,u_minCutOff:n.minCutOff,u_maxCutOff:n.maxCutOff,u_factor:n.factor,u_useGamma:n.useGamma,u_gamma:n.gamma,u_gammaCorrection:n.gammaCorrection}};q.getUniformLocationInfos=function(n,l){n=n.gl;l=l.glName;const d=n.getProgramParameter(l,n.ACTIVE_UNIFORMS),a=new Map;let b;for(let c=0;c<d;c++)(b=n.getActiveUniform(l,c))&&a.set(b.name,{location:n.getUniformLocation(l,b.name),info:b});return a};q.setTextures=
function(n,l,d,a){d.length===a.length&&(a.some(b=>null==b)||d.some(b=>null==b)||d.forEach((b,c)=>{l.setUniform1i(b,c);n.bindTexture(a[c],c)}))};q.setUniforms=function(n,l,d){Object.keys(d).forEach(a=>{var b=l.get(a)||l.get(a+"[0]");if(b){var c=d[a];if(null!==b&&null!=c)switch({info:b}=b,b.type){case E.UniformType.FLOAT:1<b.size?n.setUniform1fv(a,c):n.setUniform1f(a,c);break;case E.UniformType.FLOAT_VEC2:n.setUniform2fv(a,c);break;case E.UniformType.FLOAT_VEC3:n.setUniform3fv(a,c);break;case E.UniformType.FLOAT_VEC4:n.setUniform4fv(a,
c);break;case E.UniformType.FLOAT_MAT3:n.setUniformMatrix3fv(a,c);break;case E.UniformType.FLOAT_MAT4:n.setUniformMatrix4fv(a,c);break;case E.UniformType.INT:1<b.size?n.setUniform1iv(a,c):n.setUniform1i(a,c);break;case E.UniformType.BOOL:n.setUniform1i(a,c?1:0);break;case E.UniformType.INT_VEC2:case E.UniformType.BOOL_VEC2:n.setUniform2iv(a,c);break;case E.UniformType.INT_VEC3:case E.UniformType.BOOL_VEC3:n.setUniform3iv(a,c);break;case E.UniformType.INT_VEC4:case E.UniformType.BOOL_VEC4:n.setUniform4iv(a,
c)}}})};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/VertexStream":function(){define(["../../../webgl/BufferObject","../../../webgl/enums","../../../webgl/VertexArrayObject","../../../webgl/VertexElementDescriptor"],function(q,t,D,E){return function(){function C(n,l){this.rctx=n;this._vertexBuffer=q.BufferObject.createVertex(n,t.Usage.STATIC_DRAW,new Uint16Array(l));this._vao=new D.VertexArrayObject(n,new Map([["a_position",
0]]),{geometry:[new E.VertexElementDescriptor("a_position",2,t.DataType.SHORT,0,4)]},{geometry:this._vertexBuffer});this._count=l.length/2}var A=C.prototype;A.bind=function(){this.rctx.bindVAO(this._vao)};A.unbind=function(){this.rctx.bindVAO(null)};A.dispose=function(){this._vao.dispose(!1);this._vertexBuffer.dispose()};A.draw=function(){this.rctx.bindVAO(this._vao);this.rctx.drawArrays(t.PrimitiveType.TRIANGLE_STRIP,0,this._count)};return C}()})},"esri/views/webgl/VertexElementDescriptor":function(){define(["exports"],
function(q){q.VertexElementDescriptor=function(t,D,E,C,A,n=!1,l=0){this.name=t;this.count=D;this.type=E;this.offset=C;this.stride=A;this.normalized=n;this.divisor=l};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/imagery/BrushVectorField":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","../webgl/brushes/WGLBrush","../../../webgl/enums"],function(q,t,D,E){const C=new Float32Array([.27058823529411763,
.4588235294117647,.7098039215686275,1,.396078431372549,.5372549019607843,.7215686274509804,1,.5176470588235295,.6196078431372549,.7294117647058823,1,.6352941176470588,.7058823529411765,.7411764705882353,1,.7529411764705882,.8,.7450980392156863,1,.8705882352941177,.8901960784313725,.7490196078431373,1,1,1,.7490196078431373,1,1,.8627450980392157,.6313725490196078,1,.9803921568627451,.7254901960784313,.5176470588235295,1,.9607843137254902,.596078431372549,.4117647058823529,1,.9294117647058824,.4588235294117647,
.3176470588235294,1,.9098039215686274,.08235294117647059,.08235294117647059,1]),A={beaufort_ft:C,beaufort_m:C,beaufort_km:C,beaufort_mi:C,beaufort_kn:new Float32Array([.1568627450980392,.5725490196078431,.7803921568627451,1,.34901960784313724,.6352941176470588,.7294117647058823,1,.5058823529411764,.7019607843137254,.6705882352941176,1,.6274509803921569,.7607843137254902,.6078431372549019,1,.7490196078431373,.8313725490196079,.5411764705882353,1,.8549019607843137,.9019607843137255,.4666666666666667,
1,.9803921568627451,.9803921568627451,.39215686274509803,1,.9882352941176471,.8352941176470589,.3254901960784314,1,.9882352941176471,.7019607843137254,.4,1,.9803921568627451,.5529411764705883,.20392156862745098,1,.9686274509803922,.43137254901960786,.16470588235294117,1,.9411764705882353,.2784313725490196,.11372549019607843,1]),classified_arrow:new Float32Array([.2196078431372549,.6588235294117647,0,1,.5450980392156862,1.2117647058823529,0,1,1,1,0,1,1,.5019607843137255,0,1,1,0,0,1]),ocean_current_m:new Float32Array([.3058823529411765,
.10196078431372549,.6,1,.7019607843137254,.10588235294117647,.10196078431372549,1,.792156862745098,.5019607843137255,.10196078431372549,1,.6941176470588235,.6941176470588235,.6941176470588235,1]),ocean_current_kn:new Float32Array([0,0,0,1,0,.1450980392156863,.39215686274509803,1,.3058823529411765,.10196078431372549,.6,1,.592156862745098,0,.39215686274509803,1,.7019607843137254,.10588235294117647,.10196078431372549,1,.6941176470588235,.3058823529411765,.10196078431372549,1,.792156862745098,.5019607843137255,
.10196078431372549,1,.6941176470588235,.7019607843137254,.20392156862745098,1,.6941176470588235,.6941176470588235,.6941176470588235,1]),single_arrow:new Float32Array([0,92/255,230/255,1]),wind_speed:new Float32Array([0,0,0,1])};return function(n){function l(){var a=n.apply(this,arguments)||this;a._desc={magdir:{vsPath:"raster/magdir",fsPath:"raster/magdir",attributes:new Map([["a_pos",0],["a_offset",1],["a_vv",2]])},scalar:{vsPath:"raster/scalar",fsPath:"raster/scalar",attributes:new Map([["a_pos",
0],["a_offset",1],["a_vv",2]])}};return a}q._inheritsLoose(l,n);var d=l.prototype;d.dispose=function(){};d.prepareState=function({context:a},b){a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(E.BlendFactor.ONE,E.BlendFactor.ONE_MINUS_SRC_ALPHA,E.BlendFactor.ONE,E.BlendFactor.ONE_MINUS_SRC_ALPHA);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilOp(E.StencilOperation.KEEP,E.StencilOperation.KEEP,E.StencilOperation.REPLACE);a.setStencilFunction(E.CompareFunction.EQUAL,
b.stencilRef,255)};d.draw=function(a,b){if(!t.isNone(b.source)&&0!==b.source.validPixelCount){var {timeline:c}=a;c.begin(this.name);b.updateVectorFieldVAO(a);if("scalar"===a.renderPass){var f=b.vaoData.scalar;f&&this._drawScalars(a,b,f.vao,f.elementCount)}else(f=b.vaoData.magdir)&&this._drawTriangles(a,b,f.vao,f.elementCount);c.end(this.name)}};d._drawTriangles=function(a,b,c,f){const {context:h,painter:p,requestRender:k}=a,{symbolizerParameters:e}=b;var m=e.dataRange?["dataRange"]:[];"geographic"===
e.rotationType&&m.push("rotationGeographic");m=p.materialManager.getProgram(this._desc.magdir,m);if(t.isSome(k)&&!m.isCompiled)k();else{h.useProgram(m);var {coordScale:r,opacity:v,transforms:x}=b;m.setUniform2fv("u_coordScale",r);m.setUniform1f("u_opacity",v);m.setUniformMatrix3fv("u_dvsMat3",x.dvs);var {style:g,dataRange:u,rotation:y,symbolPercentRange:z}=e;m.setUniform4fv("u_colors",A[g]||A.single_arrow);m.setUniform2fv("u_dataRange",u);m.setUniform1f("u_rotation",y);m.setUniform2fv("u_symbolPercentRange",
z);a=this._getSymbolSize(a,b);m.setUniform2fv("u_symbolSize",a);h.bindVAO(c);h.drawElements(E.PrimitiveType.TRIANGLES,f,E.DataType.UNSIGNED_INT,0)}};d._drawScalars=function(a,b,c,f){const {context:h,painter:p,requestRender:k}=a,{symbolizerParameters:e}=b;var m=[];"wind_speed"===e.style?m.push("innerCircle"):e.dataRange&&m.push("dataRange");"geographic"===e.rotationType&&m.push("rotationGeographic");m=p.materialManager.getProgram(this._desc.scalar,m);if(t.isSome(k)&&!m.isCompiled)k();else{h.useProgram(m);
var {coordScale:r,opacity:v,transforms:x}=b;m.setUniform2fv("u_coordScale",r);m.setUniform1f("u_opacity",v);m.setUniformMatrix3fv("u_dvsMat3",x.dvs);var {dataRange:g,symbolPercentRange:u}=e;m.setUniform2fv("u_dataRange",g);m.setUniform2fv("u_symbolPercentRange",u);a=this._getSymbolSize(a,b);m.setUniform2fv("u_symbolSize",a);h.bindVAO(c);h.drawElements(E.PrimitiveType.TRIANGLES,f,E.DataType.UNSIGNED_INT,0)}};d._getSymbolSize=function(a,b){a=b.key?2**(a.displayLevel-b.key.level):b.resolution/a.state.resolution;
const {symbolTileSize:c}=b.symbolizerParameters;return[c/(Math.round((b.width-b.offset[0])/c)*c)/a,c/(Math.round((b.height-b.offset[1])/c)*c)/a]};return l}(D)})},"esri/views/2d/engine/webgl/brushes/BrushBitmap":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../VertexStream ./WGLBrush ../../../../webgl/enums".split(" "),function(q,t,D,E,C,A){const n={nearest:{defines:[],samplingMode:A.TextureSamplingMode.NEAREST,mips:!1},bilinear:{defines:[],
samplingMode:A.TextureSamplingMode.LINEAR,mips:!1},bicubic:{defines:["bicubic"],samplingMode:A.TextureSamplingMode.LINEAR,mips:!1},trilinear:{defines:[],samplingMode:A.TextureSamplingMode.LINEAR_MIPMAP_LINEAR,mips:!0}};return function(l){function d(){var b=l.apply(this,arguments)||this;b._desc={vsPath:"raster/bitmap",fsPath:"raster/bitmap",attributes:new Map([["a_pos",0]])};return b}q._inheritsLoose(d,l);var a=d.prototype;a.dispose=function(){this._quad&&this._quad.dispose()};a.prepareState=function({context:b},
c){b.setBlendingEnabled(!0);"additive"===c.blendFunction?b.setBlendFunctionSeparate(A.BlendFactor.ONE,A.BlendFactor.ONE,A.BlendFactor.ONE,A.BlendFactor.ONE):b.setBlendFunctionSeparate(A.BlendFactor.ONE,A.BlendFactor.ONE_MINUS_SRC_ALPHA,A.BlendFactor.ONE,A.BlendFactor.ONE_MINUS_SRC_ALPHA);b.setColorMask(!0,!0,!0,!0);b.setStencilWriteMask(0);b.setStencilTestEnabled(!0);b.setStencilFunction(A.CompareFunction.EQUAL,c.stencilRef,255)};a.draw=function(b,c){const {context:f,renderingOptions:h,painter:p,
requestRender:k}=b;if(c.source){if("dynamic"===h.samplingMode){({state:r}=b);var e=c.resolution/c.pixelRatio/r.resolution,m=Math.round(b.pixelRatio)!==b.pixelRatio;e=1.05<e||.95>e;var r=r.rotation||e||m||c.isSourceScaled||c.rotation?n.bilinear:n.nearest}else r=n[h.samplingMode];m=p.materialManager.getProgram(this._desc,r.defines);if(t.isSome(k)&&!m.isCompiled)k();else{b.timeline.begin(this.name);this._quad||(this._quad=new E(f,[0,0,1,0,0,1,1,1]));var {coordScale:v,computedOpacity:x,transforms:g}=
c;c.setSamplingProfile(r);c.bind(b.context,D.TEXTURE_BINDING_BITMAP);f.useProgram(m);m.setUniformMatrix3fv("u_dvsMat3",g.dvs);m.setUniform1i("u_texture",D.TEXTURE_BINDING_BITMAP);m.setUniform2fv("u_coordScale",v);m.setUniform1f("u_opacity",x);this._quad.draw();b.timeline.end(this.name)}}};return d}(C)})},"esri/views/2d/engine/webgl/definitions":function(){define(["exports"],function(q){q.ANGLE_FACTOR_256=256/360;q.ATTRIBUTE_DATA_ANIMATION=1;q.ATTRIBUTE_DATA_DD0=3;q.ATTRIBUTE_DATA_DD1=4;q.ATTRIBUTE_DATA_FILTER_FLAGS=
0;q.ATTRIBUTE_DATA_GPGPU=2;q.ATTRIBUTE_DATA_VV=3;q.ATTRIBUTE_STORE_TEXTURE_SIZE=1024;q.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}};q.BITSET_FILL_RANDOM_PATTERN_OFFSET=4;q.BITSET_GENERIC_CONSIDER_ALPHA_ONLY=16;q.BITSET_GENERIC_LOCK_COLOR=2;q.BITSET_LINE_SCALE_DASH=4;q.BITSET_MARKER_ALIGNMENT_MAP=1;q.BITSET_MARKER_ALIGNMENT_SCREEN=0;q.BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE=4;q.BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY=8;q.BITSET_TYPE_FILL_OUTLINE=1;q.BUFFER_DATA_MINIMUM_SIZE=
128;q.BUFFER_DATA_POOL_SIZE=4;q.CHART_MAX_FIELDS=10;q.COLLISION_BOX_PADDING=16;q.COLLISION_BUCKET_SIZE=128;q.COLLISION_EARLY_REJECT_BUCKET_SIZE=16;q.COLLISION_MAX_ZOOM_DELTA=1;q.COLLISION_PLACEMENT_PADDING=8;q.COLLISION_TILE_BOX_SIZE=4;q.DEBUG_LABELS=!1;q.DISPLAY_RECORD_INT_PER_ELEMENT=8;q.DOT_DENSITY_MAX_FIELDS=8;q.EFFECT_FLAG_0=4;q.ENABLE_EARLY_LABEL_DISCARD=!1;q.EXTRUDE_SCALE=64;q.FILTER_FLAG_0=2;q.GLYPH_SIZE=24;q.HEURISTIC_GLYPHS_PER_FEATURE=10;q.HEURISTIC_GLYPHS_PER_LINE=50;q.HIGHLIGHT_FLAG=
1;q.HITTEST_RADIUS=3;q.MAGIC_LABEL_LINE_HEIGHT=29;q.MAX_FILTERS=2;q.MAX_GPU_UPLOADS_PER_FRAME=2;q.MIN_MAX_ZOOM_PRECISION_FACTOR=10;q.NAN_MAGIC_NUMBER=1E-30;q.PATCH_PIXEL_BUFFER_ALLOC_SIZE=500;q.PICTURE_FILL_COLOR=4294967295;q.RANDOM_INSIDE_POLYGON_TEXTURE_SIZE=1024;q.RASTER_TILE_SIZE=256;q.SPRITE_PADDING=2;q.TEXTURE_BINDING_ATTRIBUTE_DATA_0=1;q.TEXTURE_BINDING_ATTRIBUTE_DATA_1=2;q.TEXTURE_BINDING_ATTRIBUTE_DATA_2=3;q.TEXTURE_BINDING_ATTRIBUTE_DATA_3=4;q.TEXTURE_BINDING_ATTRIBUTE_DATA_4=5;q.TEXTURE_BINDING_ATTRIBUTE_DATA_5=
6;q.TEXTURE_BINDING_BITMAP=0;q.TEXTURE_BINDING_GLYPH_ATLAS=0;q.TEXTURE_BINDING_GPGPU=12;q.TEXTURE_BINDING_HIGHLIGHT_0=5;q.TEXTURE_BINDING_HIGHLIGHT_1=6;q.TEXTURE_BINDING_RENDERER_0=5;q.TEXTURE_BINDING_RENDERER_1=6;q.TEXTURE_BINDING_SPRITE_ATLAS=0;q.TEXT_PLACEMENT_PADDING=8;q.THIN_LINE_HALF_WIDTH_THRESHOLD=1.05;q.TILE_SIZE=512;q.VTL_HIGH_RES_CUTOFF=1.15;q.VTL_TEXTURE_BINDING_UNIT_GLYPHS=6;q.VTL_TEXTURE_BINDING_UNIT_SPRITES=5;q.WEBGL_MAX_INNER_STOPS=6;q.WEBGL_MAX_STOPS=8;Object.defineProperties(q,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/brushes/BrushClip":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec4f32 ../Utils ./WGLBrush ../shaders/BackgroundPrograms ../../../../webgl/enums ../../../../webgl/ProgramTemplate".split(" "),function(q,t,D,E,C,A,n,l){return function(d){function a(){var c=d.apply(this,arguments)||this;c._color=D.fromValues(0,1,0,1);return c}q._inheritsLoose(a,d);var b=a.prototype;
b.dispose=function(){this._program&&this._program.dispose()};b.prepareState=function({context:c}){c.setStencilTestEnabled(!0);c.setBlendingEnabled(!1);c.setFaceCullingEnabled(!1);c.setColorMask(!1,!1,!1,!1);c.setStencilOp(n.StencilOperation.KEEP,n.StencilOperation.KEEP,n.StencilOperation.REPLACE);c.setStencilWriteMask(255);c.setStencilFunction(n.CompareFunction.ALWAYS,0,255)};b.draw=function(c,f){const {context:h,state:p,requestRender:k}=c;c=E.createProgramDescriptor("clip",{geometry:[{location:0,
name:"a_pos",count:2,type:n.DataType.SHORT}]});f=f.getVAO(h,p,c.attributes,c.bufferLayouts);t.isNone(f.indexBuffer)||(this._program||(this._program=l.createProgram(h,A.background)),t.isSome(k)&&!this._program.isCompiled?k():(h.useProgram(this._program),this._program.setUniform2fv("u_coord_range",[1,1]),this._program.setUniform4fv("u_color",this._color),this._program.setUniformMatrix3fv("u_dvsMat3",p.displayMat3),h.bindVAO(f),h.drawElements(n.PrimitiveType.TRIANGLES,f.indexBuffer.size,n.DataType.UNSIGNED_INT,
0),h.bindVAO()))};return a}(C)})},"esri/chunks/vec4f32":function(){define(["exports"],function(q){function t(){return new Float32Array(4)}function D(r){const v=new Float32Array(4);v[0]=r[0];v[1]=r[1];v[2]=r[2];v[3]=r[3];return v}function E(r,v,x,g){const u=new Float32Array(4);u[0]=r;u[1]=v;u[2]=x;u[3]=g;return u}function C(r,v){return new Float32Array(r,v,4)}function A(){return t()}function n(){return E(1,1,1,1)}function l(){return E(1,0,0,0)}function d(){return E(0,1,0,0)}function a(){return E(0,
0,1,0)}function b(){return E(0,0,0,1)}const c=t(),f=n(),h=l(),p=d(),k=a(),e=b(),m=Object.freeze(Object.defineProperty({__proto__:null,create:t,clone:D,fromValues:E,createView:C,zeros:A,ones:n,unitX:l,unitY:d,unitZ:a,unitW:b,ZEROS:c,ONES:f,UNIT_X:h,UNIT_Y:p,UNIT_Z:k,UNIT_W:e},Symbol.toStringTag,{value:"Module"}));q.ONES=f;q.UNIT_W=e;q.UNIT_X=h;q.UNIT_Y=p;q.UNIT_Z=k;q.ZEROS=c;q.clone=D;q.create=t;q.createView=C;q.fromValues=E;q.ones=n;q.unitW=b;q.unitX=l;q.unitY=d;q.unitZ=a;q.vec4f32=m;q.zeros=A})},
"esri/views/2d/engine/webgl/Utils":function(){define("exports ../../../../core/Error ../../../../core/Logger ../../../../core/mathUtils ../../../../core/screenUtils ../../../../symbols/cim/enums ./color ./enums ./SymbolProperties ../../../webgl/enums ../../../webgl/Texture ../../../webgl/VertexElementDescriptor".split(" "),function(q,t,D,E,C,A,n,l,d,a,b,c){function f(P){const X={};for(const R of P)X[R.name]=R.strideInBytes;return X}function h(P){switch(P){case l.WGLGeometryType.MARKER:return J;case l.WGLGeometryType.FILL:return K;
case l.WGLGeometryType.LINE:return O;case l.WGLGeometryType.TEXT:return W;case l.WGLGeometryType.LABEL:return aa}}function p(P){switch(P%4){case 0:case 2:return 4;case 1:case 3:return 1}}function k(P){switch(P){case a.DataType.BYTE:case a.DataType.UNSIGNED_BYTE:return 1;case a.DataType.SHORT:case a.DataType.UNSIGNED_SHORT:return 2;case a.DataType.FLOAT:case a.DataType.INT:case a.DataType.UNSIGNED_INT:return 4}}function e(P){const X={};for(const R in P){let T=0;X[R]=P[R].map(Z=>{const ca=new c.VertexElementDescriptor(Z.name,
Z.count,Z.type,T,0,Z.normalized||!1);T+=Z.count*k(Z.type);return ca});X[R].forEach(Z=>Z.stride=T)}return X}const m=D.getLogger("esri.views.2d.engine.webgl.Utils");D=[{name:"geometry",strideInBytes:36}];const r=[{name:"geometry",strideInBytes:12}],v=[{name:"geometry",strideInBytes:36}],x=[{name:"geometry",strideInBytes:24}],g=[{name:"geometry",strideInBytes:12}],u=[{name:"geometry",strideInBytes:40}],y=[{name:"geometry",strideInBytes:36}],z=[{name:"geometry",strideInBytes:36}],w=f(D),B=f(r),F=f(v),
G=f(x),H=f(g),I=f(u),L=f(y),N=f(z),J=["geometry"],K=["geometry"],O=["geometry"],W=["geometry"],aa=["geometry"],ba={["geometry"]:a.Usage.STATIC_DRAW},S=new Map,M=P=>P.startsWith("data:image/gif"),Q=P=>P.startsWith("data:image/png"),Y=P=>{if(!P)return!1;P=P.trim();return/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(P)&&/[\dz]$/i.test(P)&&4<P.length?!0:!1},V=P=>{var X,R;return"fill"===P.type&&"CIMMarkerPlacementInsidePolygon"===(null==P?void 0:null==(X=P.cim)?void 0:null==(R=X.markerPlacement)?void 0:
R.type)};q.C_FILL_STRIDE_SPEC=F;q.C_FILL_STRIDE_SPEC_DD=H;q.C_FILL_STRIDE_SPEC_SIMPLE=G;q.C_FILL_VERTEX_DEF=v;q.C_FILL_VERTEX_DEF_DD=g;q.C_FILL_VERTEX_DEF_SIMPLE=x;q.C_HEATMAP_STRIDE_SPEC=B;q.C_HEATMAP_VERTEX_DEF=r;q.C_ICON_STRIDE_SPEC=w;q.C_ICON_VERTEX_DEF=D;q.C_LABEL_STRIDE_SPEC=N;q.C_LABEL_VERTEX_DEF=z;q.C_LINE_STRIDE_SPEC=I;q.C_LINE_VERTEX_DEF=u;q.C_TEXT_STRIDE_SPEC=L;q.C_TEXT_VERTEX_DEF=y;q.C_VBO_GEOMETRY="geometry";q.C_VBO_INFO=ba;q.C_VBO_PERINSTANCE="per_instance";q.C_VBO_PERINSTANCE_VV="per_instance_vv";
q.allocateTypedArrayBuffer=function(P,X){switch(X%4){case 0:case 2:return new Uint32Array(Math.floor(P*X/4));case 1:case 3:return new Uint8Array(P*X)}};q.allocateTypedArrayBufferwithData=function(P,X){switch(X%4){case 0:case 2:return new Uint32Array(P);case 1:case 3:return new Uint8Array(P)}};q.charCodes=function(P){const X=[];for(let R=0;R<P.length;R++)X.push(P.charCodeAt(R));return X};q.copyMeshData=function(P,X,R,T,Z,ca,ja){for(const fa in ca){var U=ca[fa].stride,da=p(U);const ia=ca[fa].data,ea=
R[fa].data,ha=U*Z.vertexCount/da,ka=U*P/da;U=U*Z.vertexFrom/da;for(da=0;da<ha;++da)ea[da+ka]=ia[da+U]}R=Z.indexCount;for(ca=0;ca<R;++ca)T[ca+X]=ja[ca+Z.indexFrom]-Z.vertexFrom+P};q.createGeometryData=function(P,X){const R=[];for(let T=0;5>T;++T){const Z=h(T),ca={};for(const ja of Z)ca[ja]={data:X(T,ja)};R.push({data:P(T),buffers:ca})}return R};q.createProgramDescriptor=(P,X)=>{if(!S.has(P)){const Z=e(X);var R=Z;var T={};for(const ca in R){const ja=R[ca];T[ca]=ja.length?ja[0].stride:0}R=T;T=new Map;
for(const ca in X)for(const ja of X[ca])T.set(ja.name,ja.location);X=T;S.set(P,{strides:R,bufferLayouts:Z,attributes:X})}return S.get(P)};q.createTextureFromTexelData=function(P,X){let R,T;E.isPowerOfTwo(X.width)&&E.isPowerOfTwo(X.height)?(R=!0,T=a.TextureSamplingMode.LINEAR_MIPMAP_LINEAR):(R=!1,T=a.TextureSamplingMode.LINEAR);return new b.Texture(P,{target:a.TextureType.TEXTURE_2D,pixelFormat:a.PixelFormat.RGBA,internalFormat:a.PixelFormat.RGBA,dataType:a.PixelType.UNSIGNED_BYTE,hasMipmap:R,samplingMode:T,
wrapMode:a.TextureWrapMode.CLAMP_TO_EDGE,flipped:!0},X)};q.forEachGeometryType=function(P){P(l.WGLGeometryType.FILL);P(l.WGLGeometryType.LINE);P(l.WGLGeometryType.MARKER);P(l.WGLGeometryType.TEXT);P(l.WGLGeometryType.LABEL)};q.geometryToMappedGeometry=function(P){return{vertexFrom:void 0,vertexTo:void 0,geometry:P}};q.getBytes=k;q.getCapType=function(P){switch(P){case "butt":return A.CapType.BUTT;case "round":return A.CapType.ROUND;case "square":return A.CapType.SQUARE;default:return m.error(new t("mapview-invalid-type",
`Cap type ${P} is not a valid option. Defaulting to round`)),A.CapType.ROUND}};q.getJoinType=function(P){switch(P){case "miter":return A.JoinType.MITER;case "bevel":return A.JoinType.BEVEL;case "round":return A.JoinType.ROUND;default:return m.error(new t("mapview-invalid-type",`Join type ${P} is not a valid option. Defaulting to round`)),A.JoinType.ROUND}};q.getNamedBuffers=h;q.getPMSResourceSize=function(P){const X="maxVVSize"in P&&P.maxVVSize;P="width"in P&&P.width||"size"in P&&P.size||0;return X?
X:P};q.getPixelArrayCtor=function(P){switch(P){case a.PixelType.UNSIGNED_BYTE:return Uint8Array;case a.PixelType.UNSIGNED_SHORT_4_4_4_4:return Uint16Array;case a.PixelType.FLOAT:return Float32Array;default:m.error(new t("webgl-utils",`Unable to handle type ${P}`))}};q.getPixelBytes=function(P){switch(P){case a.PixelType.UNSIGNED_BYTE:return 1;case a.PixelType.UNSIGNED_SHORT_4_4_4_4:return 2;case a.PixelType.FLOAT:return 4;default:m.error(new t("webgl-utils",`Unable to handle type ${P}`))}};q.getStrides=
function(P,X){switch(P){case l.WGLGeometryType.MARKER:switch(X){case l.WGLSymbologyType.HEATMAP:return B;default:return w}case l.WGLGeometryType.FILL:switch(X){case l.WGLSymbologyType.DOT_DENSITY:return H;case l.WGLSymbologyType.SIMPLE:case l.WGLSymbologyType.OUTLINE_FILL_SIMPLE:return G;default:return F}case l.WGLGeometryType.LINE:return I;case l.WGLGeometryType.TEXT:return L;case l.WGLGeometryType.LABEL:return N}};q.getTextProperties=function(P){return d.TextProperties.pool.acquire(P.color?n.copyAndPremultiply(P.color):
[255,255,255,255],P.haloColor?n.copyAndPremultiply(P.haloColor):[255,255,255,255],C.pt2px(P.haloSize),C.pt2px(P.font.size),P.angle*Math.PI/180,P.xoffset/P.font.size,P.yoffset/P.font.size,"left"===P.horizontalAlignment?0:"right"===P.horizontalAlignment?1:.5,"top"===P.verticalAlignment?0:"bottom"===P.verticalAlignment?1:.5)};q.getTransformParams=function(P){const {transform:X,hasZ:R,hasM:T}=P;return{transform:X,hasZ:R,hasM:T}};q.getUrl=P=>"imageData"in P&&P.imageData&&"contentType"in P&&P.contentType?
`data:${P.contentType};base64,${P.imageData}`:"url"in P?P.url:null;q.getVVType=function(P){switch(P){case "opacity":return l.VVType.OPACITY;case "color":return l.VVType.COLOR;case "rotation":return l.VVType.ROTATION;case "size":return l.VVType.SIZE;default:return m.error(`Cannot interpret unknown vv: ${P}`),null}};q.is3D=P=>P.type&&P.type.toLowerCase().includes("3d");q.isDefined=function(P){return null!=P};q.isGIF=P=>"url"in P&&P.url&&(P.url.includes(".gif")||M(P.url))||"contentType"in P&&"image/gif"===
P.contentType||"imageData"in P&&M(P.imageData);q.isGIFDataUri=M;q.isImageResource=P=>"url"in P&&P.url||"imageData"in P&&P.imageData;q.isMarkerPlacementInsidePolygon=V;q.isNumber=function(P){return"number"===typeof P};q.isPNG=P=>"url"in P&&P.url&&(P.url.includes(".png")||Q(P.url))||"contentType"in P&&"image/png"===P.contentType||"imageData"in P&&Q(P.imageData);q.isPNGDataUri=Q;q.isSVGImage=P=>P.includes("data:image/svg+xml");q.isSVGResource=P=>"path"in P&&Y(P.path);q.isSimple=function(P){switch(P.type){case "line":return"CIMSolidStroke"===
P.cim.type&&!P.dashTemplate;case "fill":return"CIMSolidFill"===P.cim.type;case "esriSFS":return"esriSFSSolid"===P.style||"esriSFSNull"===P.style;case "esriSLS":return"esriSLSSolid"===P.style||"esriSLSNull"===P.style;default:return!1}};q.isValidSVG=Y;q.shouldRepeat=function(P){switch("cim"in P?P.cim.type:P.type){case "esriSMS":case "esriPMS":case "CIMPointSymbol":return!1;case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":return V(P);default:return!0}};q.strideToPackingFactor=
p;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/enums":function(){define(["exports"],function(q){q.CapType=void 0;(function(t){t[t.BUTT=0]="BUTT";t[t.ROUND=1]="ROUND";t[t.SQUARE=2]="SQUARE";t[t.UNKNOWN=4]="UNKNOWN"})(q.CapType||(q.CapType={}));q.JoinType=void 0;(function(t){t[t.BEVEL=0]="BEVEL";t[t.ROUND=1]="ROUND";t[t.MITER=2]="MITER";t[t.UNKNOWN=4]="UNKNOWN"})(q.JoinType||(q.JoinType={}));q.Alignment=void 0;(function(t){t[t.SCREEN=
0]="SCREEN";t[t.MAP=1]="MAP"})(q.Alignment||(q.Alignment={}));q.ExternalColorMixMode=void 0;(function(t){t[t.Tint=0]="Tint";t[t.Ignore=1]="Ignore";t[t.Multiply=99]="Multiply"})(q.ExternalColorMixMode||(q.ExternalColorMixMode={}));q.ExtremityPlacement=void 0;(function(t){t.Both="Both";t.JustBegin="JustBegin";t.JustEnd="JustEnd";t.None="None"})(q.ExtremityPlacement||(q.ExtremityPlacement={}));q.FillMode=void 0;(function(t){t[t.Mosaic=0]="Mosaic";t[t.Centered=1]="Centered"})(q.FillMode||(q.FillMode=
{}));q.FontEffects=void 0;(function(t){t[t.Normal=0]="Normal";t[t.Superscript=1]="Superscript";t[t.Subscript=2]="Subscript"})(q.FontEffects||(q.FontEffects={}));q.FontEncoding=void 0;(function(t){t[t.MSSymbol=0]="MSSymbol";t[t.Unicode=1]="Unicode"})(q.FontEncoding||(q.FontEncoding={}));q.FontType=void 0;(function(t){t[t.Unspecified=0]="Unspecified";t[t.TrueType=1]="TrueType";t[t.PSOpenType=2]="PSOpenType";t[t.TTOpenType=3]="TTOpenType";t[t.Type1=4]="Type1"})(q.FontType||(q.FontType={}));q.AngleAlignment=
void 0;(function(t){t[t.Display=0]="Display";t[t.Map=1]="Map"})(q.AngleAlignment||(q.AngleAlignment={}));q.AnimatedSymbolRepeatType=void 0;(function(t){t.None="None";t.Loop="Loop";t.Oscillate="Oscillate"})(q.AnimatedSymbolRepeatType||(q.AnimatedSymbolRepeatType={}));q.DominantSizeAxis=void 0;(function(t){t[t.Z=0]="Z";t[t.X=1]="X";t[t.Y=2]="Y"})(q.DominantSizeAxis||(q.DominantSizeAxis={}));q.RotationOrder=void 0;(function(t){t[t.XYZ=0]="XYZ";t[t.ZXY=1]="ZXY";t[t.YXZ=2]="YXZ"})(q.RotationOrder||(q.RotationOrder=
{}));q.BalloonCalloutStyle=void 0;(function(t){t[t.Rectangle=0]="Rectangle";t[t.RoundedRectangle=1]="RoundedRectangle";t[t.Oval=2]="Oval"})(q.BalloonCalloutStyle||(q.BalloonCalloutStyle={}));q.BlendingMode=void 0;(function(t){t[t.None=0]="None";t[t.Alpha=1]="Alpha";t[t.Screen=2]="Screen";t[t.Multiply=3]="Multiply";t[t.Add=4]="Add"})(q.BlendingMode||(q.BlendingMode={}));q.BlockProgression=void 0;(function(t){t[t.TTB=0]="TTB";t[t.RTL=1]="RTL";t[t.BTT=2]="BTT"})(q.BlockProgression||(q.BlockProgression=
{}));q.BillBoardMode=void 0;(function(t){t[t.None=0]="None";t[t.SignPost=1]="SignPost";t[t.FaceNearPlane=2]="FaceNearPlane"})(q.BillBoardMode||(q.BillBoardMode={}));q.CGAAttributeType=void 0;(function(t){t[t.Float=0]="Float";t[t.String=1]="String";t[t.Boolean=2]="Boolean"})(q.CGAAttributeType||(q.CGAAttributeType={}));q.ClippingType=void 0;(function(t){t[t.Intersect=0]="Intersect";t[t.Subtract=1]="Subtract"})(q.ClippingType||(q.ClippingType={}));q.GeometricEffectArrowType=void 0;(function(t){t.OpenEnded=
"OpenEnded";t.Block="Block";t.Crossed="Crossed"})(q.GeometricEffectArrowType||(q.GeometricEffectArrowType={}));q.GeometricEffectControlMeasureLineRule=void 0;(function(t){t.FullGeometry="FullGeometry";t.PerpendicularFromFirstSegment="PerpendicularFromFirstSegment";t.ReversedFirstSegment="ReversedFirstSegment";t.PerpendicularToSecondSegment="PerpendicularToSecondSegment";t.SecondSegmentWithTicks="SecondSegmentWithTicks";t.DoublePerpendicular="DoublePerpendicular";t.OppositeToFirstSegment="OppositeToFirstSegment";
t.TriplePerpendicular="TriplePerpendicular";t.HalfCircleFirstSegment="HalfCircleFirstSegment";t.HalfCircleSecondSegment="HalfCircleSecondSegment";t.HalfCircleExtended="HalfCircleExtended";t.OpenCircle="OpenCircle";t.CoverageEdgesWithTicks="CoverageEdgesWithTicks";t.GapExtentWithDoubleTicks="GapExtentWithDoubleTicks";t.GapExtentMidline="GapExtentMidline";t.Chevron="Chevron";t.PerpendicularWithArc="PerpendicularWithArc";t.ClosedHalfCircle="ClosedHalfCircle";t.TripleParallelExtended="TripleParallelExtended";
t.ParallelWithTicks="ParallelWithTicks";t.Parallel="Parallel";t.PerpendicularToFirstSegment="PerpendicularToFirstSegment";t.ParallelOffset="ParallelOffset";t.OffsetOpposite="OffsetOpposite";t.OffsetSame="OffsetSame";t.CircleWithArc="CircleWithArc";t.DoubleJog="DoubleJog";t.PerpendicularOffset="PerpendicularOffset";t.LineExcludingLastSegment="LineExcludingLastSegment";t.MultivertexArrow="MultivertexArrow";t.CrossedArrow="CrossedArrow";t.ChevronArrow="ChevronArrow";t.ChevronArrowOffset="ChevronArrowOffset";
t.PartialFirstSegment="PartialFirstSegment";t.Arch="Arch";t.CurvedParallelTicks="CurvedParallelTicks";t.Arc90Degrees="Arc90Degrees"})(q.GeometricEffectControlMeasureLineRule||(q.GeometricEffectControlMeasureLineRule={}));q.GeometricEffectDonutMethod=void 0;(function(t){t.Mitered="Mitered";t.Bevelled="Bevelled";t.Rounded="Rounded";t.Square="Square";t.TrueBuffer="TrueBuffer"})(q.GeometricEffectDonutMethod||(q.GeometricEffectDonutMethod={}));q.GeometricEffectEnclosingPolygonMethod=void 0;(function(t){t.ClosePath=
"ClosePath";t.ConvexHull="ConvexHull";t.RectangularBox="RectangularBox"})(q.GeometricEffectEnclosingPolygonMethod||(q.GeometricEffectEnclosingPolygonMethod={}));q.GeometricEffectExtensionOrigin=void 0;(function(t){t.BeginningOfLine="BeginningOfLine";t.EndOfLine="EndOfLine"})(q.GeometricEffectExtensionOrigin||(q.GeometricEffectExtensionOrigin={}));q.GeometricEffectOffsetMethod=void 0;(function(t){t.Mitered="Mitered";t.Bevelled="Bevelled";t.Rounded="Rounded";t.Square="Square"})(q.GeometricEffectOffsetMethod||
(q.GeometricEffectOffsetMethod={}));q.GeometricEffectOffsetOption=void 0;(function(t){t.Fast="Fast";t.Accurate="Accurate"})(q.GeometricEffectOffsetOption||(q.GeometricEffectOffsetOption={}));q.GeometricEffectOffsetTangentMethod=void 0;(function(t){t.BeginningOfLine="BeginningOfLine";t.EndOfLine="EndOfLine"})(q.GeometricEffectOffsetTangentMethod||(q.GeometricEffectOffsetTangentMethod={}));q.GeometricEffectWaveform=void 0;(function(t){t.Sinus="Sinus";t.Square="Square";t.Triangle="Triangle";t.Random=
"Random"})(q.GeometricEffectWaveform||(q.GeometricEffectWaveform={}));q.GlyphHinting=void 0;(function(t){t[t.None=0]="None";t[t.Default=1]="Default";t[t.Force=2]="Force"})(q.GlyphHinting||(q.GlyphHinting={}));q.GradientAlignment=void 0;(function(t){t[t.Buffered=0]="Buffered";t[t.Left=1]="Left";t[t.Right=2]="Right";t[t.AlongLine=3]="AlongLine"})(q.GradientAlignment||(q.GradientAlignment={}));q.GradientFillMethod=void 0;(function(t){t[t.Linear=0]="Linear";t[t.Rectangular=1]="Rectangular";t[t.Circular=
2]="Circular";t[t.Buffered=3]="Buffered"})(q.GradientFillMethod||(q.GradientFillMethod={}));q.GradientStrokeType=void 0;(function(t){t[t.Discrete=0]="Discrete";t[t.Continuous=1]="Continuous"})(q.GradientStrokeType||(q.GradientStrokeType={}));q.GradientStrokeMethod=void 0;(function(t){t[t.AcrossLine=0]="AcrossLine";t[t.AloneLine=1]="AloneLine"})(q.GradientStrokeMethod||(q.GradientStrokeMethod={}));q.HorizontalAlignment=void 0;(function(t){t[t.Left=0]="Left";t[t.Right=1]="Right";t[t.Center=2]="Center";
t[t.Justify=3]="Justify"})(q.HorizontalAlignment||(q.HorizontalAlignment={}));q.LeaderLineStyle=void 0;(function(t){t[t.Base=0]="Base";t[t.MidPoint=1]="MidPoint";t[t.ThreePoint=2]="ThreePoint";t[t.FourPoint=3]="FourPoint";t[t.Underline=4]="Underline";t[t.CircularCW=5]="CircularCW";t[t.CircularCCW=6]="CircularCCW"})(q.LeaderLineStyle||(q.LeaderLineStyle={}));q.LineCapStyle=void 0;(function(t){t.Butt="Butt";t.Round="Round";t.Square="Square"})(q.LineCapStyle||(q.LineCapStyle={}));q.LineDashEnding=void 0;
(function(t){t.NoConstraint="NoConstraint";t.HalfPattern="HalfPattern";t.HalfGap="HalfGap";t.FullPattern="FullPattern";t.FullGap="FullGap";t.Custom="Custom"})(q.LineDashEnding||(q.LineDashEnding={}));q.LineDecorationStyle=void 0;(function(t){t[t.None=-1]="None";t[t.Custom=0]="Custom";t[t.Circle=1]="Circle";t[t.OpenArrow=2]="OpenArrow";t[t.ClosedArrow=3]="ClosedArrow";t[t.Diamond=4]="Diamond"})(q.LineDecorationStyle||(q.LineDecorationStyle={}));q.LineGapType=void 0;(function(t){t[t.ExtraLeading=0]=
"ExtraLeading";t[t.Multiple=1]="Multiple";t[t.Exact=2]="Exact"})(q.LineGapType||(q.LineGapType={}));q.LineJoinStyle=void 0;(function(t){t.Bevel="Bevel";t.Round="Round";t.Miter="Miter"})(q.LineJoinStyle||(q.LineJoinStyle={}));q.ExpressionReturnType=void 0;(function(t){t[t.Default=0]="Default";t[t.String=1]="String";t[t.Numeric=2]="Numeric"})(q.ExpressionReturnType||(q.ExpressionReturnType={}));q.MarkerPlacementType=void 0;(function(t){t[t.InsidePolygon=0]="InsidePolygon";t[t.PolygonCenter=1]="PolygonCenter";
t[t.RandomlyInsidePolygon=2]="RandomlyInsidePolygon"})(q.MarkerPlacementType||(q.MarkerPlacementType={}));q.MaterialMode=void 0;(function(t){t[t.Tint=0]="Tint";t[t.Replace=1]="Replace";t[t.Multiply=2]="Multiply"})(q.MaterialMode||(q.MaterialMode={}));q.PlacementClip=void 0;(function(t){t[t.ClipAtBoundary=0]="ClipAtBoundary";t[t.RemoveIfCenterOutsideBoundary=1]="RemoveIfCenterOutsideBoundary";t[t.DoNotTouchBoundary=2]="DoNotTouchBoundary";t[t.DoNotClip=3]="DoNotClip"})(q.PlacementClip||(q.PlacementClip=
{}));q.PlacementEndings=void 0;(function(t){t.NoConstraint="NoConstraint";t.WithMarkers="WithMarkers";t.WithFullGap="WithFullGap";t.WithHalfGap="WithHalfGap";t.Custom="Custom"})(q.PlacementEndings||(q.PlacementEndings={}));q.PlacementGridType=void 0;(function(t){t.Fixed="Fixed";t.Random="Random";t.RandomFixedQuantity="RandomFixedQuantity"})(q.PlacementGridType||(q.PlacementGridType={}));q.PlacementOnLineRelativeTo=void 0;(function(t){t.LineMiddle="LineMiddle";t.LineBeginning="LineBeginning";t.LineEnd=
"LineEnd";t.SegmentMidpoint="SegmentMidpoint"})(q.PlacementOnLineRelativeTo||(q.PlacementOnLineRelativeTo={}));q.PlacementPolygonCenterMethod=void 0;(function(t){t.OnPolygon="OnPolygon";t.CenterOfMass="CenterOfMass";t.BoundingBoxCenter="BoundingBoxCenter"})(q.PlacementPolygonCenterMethod||(q.PlacementPolygonCenterMethod={}));q.PlacementRandomlyAlongLineRandomization=void 0;(function(t){t[t.Low=0]="Low";t[t.Medium=1]="Medium";t[t.High=2]="High"})(q.PlacementRandomlyAlongLineRandomization||(q.PlacementRandomlyAlongLineRandomization=
{}));q.PlacementStepPosition=void 0;(function(t){t[t.MarkerCenter=0]="MarkerCenter";t[t.MarkerBounds=1]="MarkerBounds"})(q.PlacementStepPosition||(q.PlacementStepPosition={}));q.PointSymbolCalloutScale=void 0;(function(t){t[t.None=0]="None";t[t.PropUniform=1]="PropUniform";t[t.PropNonuniform=2]="PropNonuniform";t[t.DifUniform=3]="DifUniform";t[t.DifNonuniform=4]="DifNonuniform"})(q.PointSymbolCalloutScale||(q.PointSymbolCalloutScale={}));q.Simple3DLineStyle=void 0;(function(t){t.Tube="Tube";t.Strip=
"Strip";t.Wall="Wall"})(q.Simple3DLineStyle||(q.Simple3DLineStyle={}));q.SizeVariationMethod=void 0;(function(t){t[t.Random=0]="Random";t[t.Increasing=1]="Increasing";t[t.Decreasing=2]="Decreasing";t[t.IncreasingThenDecreasing=3]="IncreasingThenDecreasing"})(q.SizeVariationMethod||(q.SizeVariationMethod={}));q.SymbolUnits=void 0;(function(t){t[t.Relative=0]="Relative";t[t.Absolute=1]="Absolute"})(q.SymbolUnits||(q.SymbolUnits={}));q.TextCase=void 0;(function(t){t[t.Normal=0]="Normal";t[t.LowerCase=
1]="LowerCase";t[t.Allcaps=2]="Allcaps"})(q.TextCase||(q.TextCase={}));q.TextReadingDirection=void 0;(function(t){t[t.LTR=0]="LTR";t[t.RTL=1]="RTL"})(q.TextReadingDirection||(q.TextReadingDirection={}));q.TextureFilter=void 0;(function(t){t.Draft="Draft";t.Picture="Picture";t.Text="Text"})(q.TextureFilter||(q.TextureFilter={}));q.VerticalAlignment=void 0;(function(t){t[t.Top=0]="Top";t[t.Center=1]="Center";t[t.Baseline=2]="Baseline";t[t.Bottom=3]="Bottom"})(q.VerticalAlignment||(q.VerticalAlignment=
{}));q.VerticalGlyphOrientation=void 0;(function(t){t[t.Right=0]="Right";t[t.Upright=1]="Upright"})(q.VerticalGlyphOrientation||(q.VerticalGlyphOrientation={}));q.WaterbodySize=void 0;(function(t){t[t.Small=0]="Small";t[t.Medium=1]="Medium";t[t.Large=2]="Large"})(q.WaterbodySize||(q.WaterbodySize={}));q.WaveStrength=void 0;(function(t){t[t.Calm=0]="Calm";t[t.Rippled=1]="Rippled";t[t.Slight=2]="Slight";t[t.Moderate=3]="Moderate"})(q.WaveStrength||(q.WaveStrength={}));Object.defineProperties(q,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/color":function(){define(["exports","../../../../core/maybe","./number"],function(q,t,D){function E(n,l){Array.isArray(l)?(n[0]=l[0],n[1]=l[1],n[2]=l[2],n[3]=l[3]):(n[0]=l.r,n[1]=l.g,n[2]=l.b,n[3]=l.a);return n}function C(n,l=0,d=!1){const a=n[l+3];n[l+0]*=a;n[l+1]*=a;n[l+2]*=a;d||(n[l+3]*=255);return n}const A=[0,0,0,0];q.copyAndPremultiply=function(n){return C(E([],n))};q.premultiplyAlpha=C;q.premultiplyAlphaRGBA=function(n){if(!n)return 0;
const {r:l,g:d,b:a,a:b}=n;return D.i8888to32(l*b,d*b,a*b,255*b)};q.premultiplyAlphaRGBAArray=function(n){if(!n)return 0;const [l,d,a,b]=n;return D.i8888to32(b/255*l,b/255*d,b/255*a,b)};q.premultiplyAlphaUint32=function(n){C(E(A,n));return D.i8888to32(A[0],A[1],A[2],A[3])};q.white=[255,255,255,1];q.writeColor=function(n,l,d=0){if(t.isNone(l))n[d+0]=0,n[d+1]=0,n[d+2]=0,n[d+3]=0;else{var {r:a,g:b,b:c,a:f}=l;n[d+0]=a*f/255;n[d+1]=b*f/255;n[d+2]=c*f/255;n[d+3]=f}};Object.defineProperties(q,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/number":function(){define(["exports"],function(q){function t(C,A,n){return Math.round(Math.max(Math.min(C,n),A))}const D=new Float32Array(1),E=new Uint32Array(D.buffer);q.i16=function(C){return t(C,-32768,32767)};q.i1616to32=function(C,A){return 65535&C|A<<16};q.i32=function(C){return t(C,-2147483648,2147483647)};q.i8=function(C){return t(C,-128,127)};q.i8816to32=function(C,A,n){return C&255|(A&255)<<8|n<<16};q.i8888to32=function(C,
A,n,l){return C&255|(A&255)<<8|(n&255)<<16|l<<24};q.numTo32=function(C){return C|0};q.toFloat32=function(C){E[0]=C;return D[0]};q.toUint32=function(C){D[0]=C;return E[0]};q.u16=function(C){return t(C,0,65535)};q.u32=function(C){return t(C,0,4294967295)};q.u32to4Xu8=function(C){return[C&255,(C&65280)>>>8,(C&16711680)>>>16,(C&4278190080)>>>24]};q.u4u4to8=function(C,A){return 15&C|(15&A)<<4};q.u8=function(C){return t(C,0,255)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/engine/webgl/SymbolProperties":function(){define(["exports","../../../../core/ObjectPool"],function(q,t){let D=function(){function E(){this.color=[0,0,0,0];this.haloColor=[0,0,0,0];this.haloSize=0;this.size=12;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=0}var C=E.prototype;C.acquire=function(A,n,l,d,a,b,c,f,h){this.color=A;this.haloColor=n;this.haloSize=l;this.size=d;this.angle=a;this.offsetX=b;this.offsetY=c;this.hAnchor=f;this.vAnchor=h};C.release=function(){this.color[0]=
this.color[1]=this.color[2]=this.color[3]=0;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=this.size=this.haloSize=this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0};return E}();D.pool=new t(D);q.TextProperties=D;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/shaders/BackgroundPrograms":function(){define(["exports","./sources/resolver"],function(q,t){t={shaders:{vertexShader:t.resolveIncludes("background/background.vert"),
fragmentShader:t.resolveIncludes("background/background.frag")},attributes:new Map([["a_pos",0]])};q.background=t;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/shaders/sources/resolver":function(){define(["exports","./shaderRepository","../../../../../webgl/ShaderCompiler"],function(q,t,D){const E=new D.ShaderCompiler(function(C){let A=t;C.split("/").forEach(n=>{A&&(A=A[n])});return A});q.resolveIncludes=function(C){return E.resolveIncludes(C)};
Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/shaders/sources/shaderRepository":function(){define(function(){return{background:{"background.frag":"uniform lowp vec4 u_color;\nvoid main() {\ngl_FragColor \x3d u_color;\n}","background.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_coord_range;\nuniform mediump float u_depth;\nvoid main() {\nvec3 v_pos \x3d u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0);\ngl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n}"},
bitBlit:{"bitBlit.frag":"uniform lowp sampler2D u_tex;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\nlowp vec4 color \x3d texture2D(u_tex, v_uv);\ngl_FragColor \x3d color *  u_opacity;\n}","bitBlit.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\nvarying mediump vec2 v_uv;\nvoid main(void) {\ngl_Position \x3d vec4(a_pos, 0.0, 1.0);\nv_uv \x3d a_tex;\n}"},blend:{"blend.frag":"precision mediump float;\nuniform sampler2D u_layerTexture;\nuniform lowp float u_opacity;\nuniform lowp float u_inFadeOpacity;\n#ifndef NORMAL\nuniform sampler2D u_backbufferTexture;\n#endif\nvarying mediump vec2 v_uv;\nfloat rgb2v(in vec3 c) {\nreturn max(c.x, max(c.y, c.z));\n}\nvec3 rgb2hsv(in vec3 c) {\nvec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\nvec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\nfloat d \x3d q.x - min(q.w, q.y);\nfloat e \x3d 1.0e-10;\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(in vec3 c) {\nvec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\nreturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec3 tint(in vec3 Cb, in vec3 Cs) {\nfloat vIn \x3d rgb2v(Cb);\nvec3 hsvTint \x3d rgb2hsv(Cs);\nvec3 hsvOut \x3d vec3(hsvTint.x, hsvTint.y, vIn * hsvTint.z);\nreturn hsv2rgb(hsvOut);\n}\nfloat overlay(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * (1.0 - 2.0 * (1.0 - Cs ) * (1.0 - Cb)) + step(0.5, Cs) * (2.0 * Cs * Cb);\n}\nfloat colorDodge(in float Cb, in float Cs) {\nreturn (Cb \x3d\x3d 0.0) ? 0.0 : (Cs \x3d\x3d 1.0) ? 1.0 : min(1.0, Cb / (1.0 - Cs));\n}\nfloat colorBurn(in float Cb, in float Cs) {\nreturn (Cb \x3d\x3d 1.0) ? 1.0 : (Cs \x3d\x3d 0.0) ? 0.0 : 1.0 - min(1.0, (1.0 - Cb) / Cs);\n}\nfloat hardLight(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * (2.0 * Cs * Cb) + step(0.5, Cs) * (1.0 - 2.0 * (1.0 - Cs) * (1.0 - Cb));\n}\nfloat reflectBlend(in float Cb, in float Cs) {\nreturn (Cs \x3d\x3d 1.0) ? Cs : min(Cb * Cb / (1.0 - Cs), 1.0);\n}\nfloat softLight(in float Cb, in float Cs) {\nif (Cs \x3c\x3d 0.5) {\nreturn Cb - (1.0 - 2.0 * Cs) * Cb * (1.0 - Cb);\n}\nif (Cb \x3c\x3d 0.25) {\nreturn Cb + (2.0 * Cs - 1.0) * Cb * ((16.0 * Cb - 12.0) * Cb + 3.0);\n}\nreturn Cb + (2.0 * Cs - 1.0) * (sqrt(Cb) - Cb);\n}\nfloat vividLight(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * colorBurn(Cb, 2.0 * Cs) + step(0.5, Cs) * colorDodge(Cb, (2.0 * (Cs - 0.5)));\n}\nfloat minv3(in vec3 c) {\nreturn min(min(c.r, c.g), c.b);\n}\nfloat maxv3(in vec3 c) {\nreturn max(max(c.r, c.g), c.b);\n}\nfloat lumv3(in vec3 c) {\nreturn dot(c, vec3(0.3, 0.59, 0.11));\n}\nfloat satv3(vec3 c) {\nreturn maxv3(c) - minv3(c);\n}\nvec3 clipColor(vec3 color) {\nfloat lum \x3d lumv3(color);\nfloat mincol \x3d minv3(color);\nfloat maxcol \x3d maxv3(color);\nif (mincol \x3c 0.0) {\ncolor \x3d lum + ((color - lum) * lum) / (lum - mincol);\n}\nif (maxcol \x3e 1.0) {\ncolor \x3d lum + ((color - lum) * (1.0 - lum)) / (maxcol - lum);\n}\nreturn color;\n}\nvec3 setLum(vec3 cbase, vec3 clum) {\nfloat lbase \x3d lumv3(cbase);\nfloat llum \x3d lumv3(clum);\nfloat ldiff \x3d llum - lbase;\nvec3 color \x3d cbase + vec3(ldiff);\nreturn clipColor(color);\n}\nvec3 setLumSat(vec3 cbase, vec3 csat, vec3 clum)\n{\nfloat minbase \x3d minv3(cbase);\nfloat sbase \x3d satv3(cbase);\nfloat ssat \x3d satv3(csat);\nvec3 color;\nif (sbase \x3e 0.0) {\ncolor \x3d (cbase - minbase) * ssat / sbase;\n} else {\ncolor \x3d vec3(0.0);\n}\nreturn setLum(color, clum);\n}\nvoid main() {\nvec4 src \x3d texture2D(u_layerTexture, v_uv);\n#ifdef NORMAL\ngl_FragColor \x3d src *  u_opacity;\n#else\nvec4 dst \x3d texture2D(u_backbufferTexture, v_uv);\nvec3 Cs \x3d src.a \x3d\x3d 0.0 ? src.rgb : vec3(src.rgb / src.a);\nvec3 Cb \x3d dst.a \x3d\x3d 0.0 ? dst.rgb : vec3(dst.rgb / dst.a);\nfloat as \x3d u_opacity * src.a;\nfloat ab \x3d dst.a;\n#ifdef DESTINATION_OVER\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb, as + ab - as * ab);\n#endif\n#ifdef SOURCE_IN\nvec4 color \x3d vec4(as * Cs * ab, as * ab);\nvec4 fadeColor \x3d (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\ngl_FragColor \x3d color + fadeColor;\n#endif\n#ifdef DESTINATION_IN\nvec4 color \x3d vec4(ab * Cb * as, ab * as);\nvec4 fadeColor \x3d (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\ngl_FragColor \x3d color + fadeColor;\n#endif\n#ifdef SOURCE_OUT\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab), as * (1.0 - ab));\n#endif\n#ifdef DESTINATION_OUT\ngl_FragColor \x3d vec4(ab * Cb * (1.0 - as), ab * (1.0 - as));\n#endif\n#ifdef SOURCE_ATOP\ngl_FragColor \x3d vec4(as * Cs * ab + ab * Cb * (1.0 - as), ab);\n#endif\n#ifdef DESTINATION_ATOP\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb * as, as);\n#endif\n#ifdef XOR\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb * (1.0 - as),\nas * (1.0 - ab) + ab * (1.0 - as));\n#endif\n#ifdef MULTIPLY\ngl_FragColor \x3d vec4(as * Cs * ab * Cb + (1.0 - ab) * as * Cs + (1.0 - as) * ab * Cb,\nas + ab * (1.0 - as));\n#endif\n#ifdef SCREEN\ngl_FragColor \x3d vec4((Cs + Cb - Cs * Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef OVERLAY\nvec3 f \x3d vec3(overlay(Cb.r, Cs.r), overlay(Cb.g, Cs.g), overlay(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef DARKEN\ngl_FragColor \x3d vec4(min(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef LIGHTER\ngl_FragColor \x3d vec4(as * Cs + ab * Cb, as + ab);\n#endif\n#ifdef LIGHTEN\ngl_FragColor \x3d vec4(max(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR_DODGE\nvec3 f \x3d vec3(colorDodge(Cb.r, Cs.r), colorDodge(Cb.g, Cs.g), colorDodge(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR_BURN\nvec3 f \x3d vec3(colorBurn(Cb.r, Cs.r), colorBurn(Cb.g, Cs.g), colorBurn(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef HARD_LIGHT\nvec3 f \x3d vec3(hardLight(Cb.r, Cs.r), hardLight(Cb.g, Cs.g), hardLight(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef SOFT_LIGHT\nvec3 f \x3d vec3(softLight(Cb.r, Cs.r), softLight(Cb.g, Cs.g), softLight(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef DIFFERENCE\ngl_FragColor \x3d vec4(abs(Cb - Cs) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef EXCLUSION\nvec3 f \x3d Cs + Cb - 2.0 * Cs * Cb;\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef INVERT\ngl_FragColor \x3d vec4((1.0 - Cb) * as * ab + Cb * ab * (1.0 - as), ab);\n#endif\n#ifdef VIVID_LIGHT\nvec3 f \x3d vec3(vividLight(Cb.r, Cs.r),\nvividLight(Cb.g, Cs.g),\nvividLight(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef HUE\nvec3 f \x3d setLumSat(Cs,Cb,Cb);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef SATURATION\nvec3 f \x3d setLumSat(Cb,Cs,Cb);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR\nvec3 f \x3d setLum(Cs,Cb);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef LUMINOSITY\nvec3 f \x3d setLum(Cb,Cs);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef PLUS\ngl_FragColor \x3d clamp(vec4(src.r + Cb.r, src.g + Cb.g, src.b + Cb.b, as + ab), 0.0, 1.0);\n#endif\n#ifdef MINUS\ngl_FragColor \x3d vec4(clamp(vec3(Cb.r - src.r, Cb.g - src.g, Cb.b - src.b), 0.0, 1.0), ab * as);\n#endif\n#ifdef AVERAGE\nvec3 f \x3d (Cb + Cs) / 2.0;\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef REFLECT\nvec3 f \x3d vec3(reflectBlend(Cb.r, Cs.r),\nreflectBlend(Cb.g, Cs.g),\nreflectBlend(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#endif\n}",
"blend.vert":"attribute vec2 a_position;\nvarying mediump vec2 v_uv;\nvoid main(void) {\ngl_Position \x3d vec4(a_position , 0.0, 1.0);\nv_uv \x3d (a_position + 1.0) / 2.0;\n}"},dot:{dot:{"dot.frag":"precision mediump float;\nvarying vec4 v_color;\nvarying float v_dotRatio;\nvarying float v_invEdgeRatio;\nuniform highp float u_tileZoomFactor;\nvoid main()\n{\nfloat dist \x3d length(gl_PointCoord - vec2(.5, .5)) * 2.;\nfloat alpha \x3d smoothstep(0., 1., v_invEdgeRatio * (dist - v_dotRatio) + 1.);\ngl_FragColor \x3d v_color * alpha;\n}",
"dot.vert":"precision highp float;\nattribute vec2 a_pos;\nuniform sampler2D u_texture;\nuniform highp mat3 u_dvsMat3;\nuniform highp float u_tileZoomFactor;\nuniform highp float u_dotSize;\nuniform highp float u_pixelRatio;\nvarying vec2 v_pos;\nvarying vec4 v_color;\nvarying float v_dotRatio;\nvarying float v_invEdgeRatio;\nconst float EPSILON \x3d 0.000001;\nvoid main()\n{\nmat3 tileToTileTexture \x3d mat3(  1., 0., 0.,\n0., -1., 0.,\n0., 1., 1.  );\nvec3 texCoords \x3d tileToTileTexture * vec3(a_pos.xy / 512., 1.);\nv_color \x3d texture2D(u_texture, texCoords.xy);\nfloat smoothEdgeWidth \x3d max(u_dotSize / 2., 1.) ;\nfloat z \x3d 0.;\nz +\x3d 2.0 * step(v_color.a, EPSILON);\ngl_PointSize \x3d (smoothEdgeWidth + u_dotSize);\ngl_Position \x3d vec4((u_dvsMat3 * vec3(a_pos + .5, 1.)).xy, z, 1.);\nv_dotRatio \x3d u_dotSize / gl_PointSize;\nv_invEdgeRatio \x3d -1. / ( smoothEdgeWidth / gl_PointSize );\ngl_PointSize  *\x3d (u_pixelRatio * u_tileZoomFactor);\n}"}},
filtering:{"bicubic.glsl":"vec4 computeWeights(float v) {\nfloat b \x3d 1.0 / 6.0;\nfloat v2 \x3d v * v;\nfloat v3 \x3d v2 * v;\nfloat w0 \x3d b * (-v3 + 3.0 * v2 - 3.0 * v + 1.0);\nfloat w1 \x3d b * (3.0 * v3  - 6.0 * v2 + 4.0);\nfloat w2 \x3d b * (-3.0 * v3 + 3.0 * v2 + 3.0 * v + 1.0);\nfloat w3 \x3d b * v3;\nreturn vec4(w0, w1, w2, w3);\n}\nvec4 bicubicOffsetsAndWeights(float v) {\nvec4 w \x3d computeWeights(v);\nfloat g0 \x3d w.x + w.y;\nfloat g1 \x3d w.z + w.w;\nfloat h0 \x3d 1.0 - (w.y / g0) + v;\nfloat h1 \x3d 1.0 + (w.w / g1) - v;\nreturn vec4(h0, h1, g0, g1);\n}\nvec4 sampleBicubicBSpline(sampler2D sampler, vec2 coords, vec2 texSize) {\nvec2 eX \x3d vec2(1.0 / texSize.x, 0.0);\nvec2 eY \x3d vec2(0.0, 1.0 / texSize.y);\nvec2 texel \x3d coords * texSize - 0.5;\nvec3 hgX \x3d bicubicOffsetsAndWeights(fract(texel).x).xyz;\nvec3 hgY \x3d bicubicOffsetsAndWeights(fract(texel).y).xyz;\nvec2 coords10 \x3d coords + hgX.x * eX;\nvec2 coords00 \x3d coords - hgX.y * eX;\nvec2 coords11 \x3d coords10 + hgY.x * eY;\nvec2 coords01 \x3d coords00 + hgY.x * eY;\ncoords10 \x3d coords10 - hgY.y * eY;\ncoords00 \x3d coords00 - hgY.y * eY;\nvec4 color00 \x3d texture2D(sampler, coords00);\nvec4 color10 \x3d texture2D(sampler, coords10);\nvec4 color01 \x3d texture2D(sampler, coords01);\nvec4 color11 \x3d texture2D(sampler, coords11);\ncolor00 \x3d mix(color00, color01, hgY.z);\ncolor10 \x3d mix(color10, color11, hgY.z);\ncolor00 \x3d mix(color00, color10, hgX.z);\nreturn color00;\n}",
"bilinear.glsl":"vec4 sampleBilinear(sampler2D sampler, vec2 coords, vec2 texSize) {\nvec2 texelStart \x3d floor(coords * texSize);\nvec2 coord0 \x3d texelStart / texSize;\nvec2 coord1 \x3d (texelStart +  vec2(1.0, 0.0)) / texSize;\nvec2 coord2 \x3d (texelStart +  vec2(0.0, 1.0)) / texSize;\nvec2 coord3 \x3d (texelStart +  vec2(1.0, 1.0)) / texSize;\nvec4 color0 \x3d texture2D(sampler, coord0);\nvec4 color1 \x3d texture2D(sampler, coord1);\nvec4 color2 \x3d texture2D(sampler, coord2);\nvec4 color3 \x3d texture2D(sampler, coord3);\nvec2 blend \x3d fract(coords * texSize);\nvec4 color01 \x3d mix(color0, color1, blend.x);\nvec4 color23 \x3d mix(color2, color3, blend.x);\nvec4 color \x3d mix(color01, color23, blend.y);\n#ifdef NNEDGE\nfloat alpha \x3d floor(color0.a * color1.a * color2.a * color3.a + 0.5);\ncolor \x3d color * alpha + (1.0 - alpha) * texture2D(sampler, coords);\n#endif\nreturn color;\n}",
"epx.glsl":"vec4 sampleEPX(sampler2D sampler, float size, vec2 coords, vec2 texSize) {\nvec2 invSize \x3d 1.0 / texSize;\nvec2 texel \x3d coords * texSize;\nvec2 texel_i \x3d floor(texel);\nvec2 texel_frac \x3d fract(texel);\nvec4 colorP \x3d texture2D(sampler, texel_i * invSize);\nvec4 colorP1 \x3d vec4(colorP);\nvec4 colorP2 \x3d vec4(colorP);\nvec4 colorP3 \x3d vec4(colorP);\nvec4 colorP4 \x3d vec4(colorP);\nvec4 colorA \x3d texture2D(sampler, (texel_i - vec2(0.0, 1.0)) * invSize);\nvec4 colorB \x3d texture2D(sampler, (texel_i + vec2(1.0, 0.0)) * invSize);\nvec4 colorC \x3d texture2D(sampler, (texel_i - vec2(1.0, 0.0)) * invSize);\nvec4 colorD \x3d texture2D(sampler, (texel_i + vec2(0.0, 1.0)) * invSize);\nif (colorC \x3d\x3d colorA \x26\x26 colorC !\x3d colorD \x26\x26 colorA !\x3d colorB) {\ncolorP1 \x3d colorA;\n}\nif (colorA \x3d\x3d colorB \x26\x26 colorA !\x3d colorC \x26\x26 colorB !\x3d colorD) {\ncolorP2 \x3d colorB;\n}\nif (colorD \x3d\x3d colorC \x26\x26 colorD !\x3d colorB \x26\x26 colorC !\x3d colorA) {\ncolorP3 \x3d colorC;\n}\nif (colorB \x3d\x3d colorD \x26\x26 colorB !\x3d colorA \x26\x26 colorD !\x3d colorC) {\ncolorP4 \x3d colorD;\n}\nvec4 colorP12 \x3d mix(colorP1, colorP2, texel_frac.x);\nvec4 colorP34 \x3d mix(colorP1, colorP2, texel_frac.x);\nreturn mix(colorP12, colorP34, texel_frac.y);\n}"},
fx:{integrate:{"integrate.frag":"precision mediump float;\nuniform lowp sampler2D u_sourceTexture;\nuniform lowp sampler2D u_maskTexture;\nuniform mediump float u_zoomLevel;\nuniform highp float u_timeDelta;\nuniform highp float u_animationTime;\nvarying highp vec2 v_texcoord;\n#include \x3cmaterials/utils.glsl\x3e\nvoid main()\n{\n#ifdef DELTA\nvec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\nvec4 data0 \x3d texture2D(u_maskTexture, v_texcoord);\nfloat flags \x3d data0.r * 255.0;\nfloat groupMinZoom \x3d data0.g * 255.0;\nfloat isVisible \x3d getFilterBit(flags, 0);\nfloat wouldClip \x3d step(groupMinZoom, u_zoomLevel);\nfloat direction \x3d wouldClip * 1.0 + (1.0 - wouldClip) * -1.0;\nfloat dt \x3d u_timeDelta / max(u_animationTime, 0.0001);\nvec4 nextState \x3d vec4(texel + direction * dt);\ngl_FragColor \x3d  vec4(nextState);\n#elif defined(UPDATE)\nvec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\ngl_FragColor \x3d texel;\n#endif\n}",
"integrate.vert":"precision mediump float;\nattribute vec2 a_pos;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos;\ngl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}"}},heatmap:{heatmapResolve:{"heatmapResolve.frag":"precision highp float;\n#ifdef HEATMAP_PRECISION_HALF_FLOAT\n#define COMPRESSION_FACTOR 4.0\n#else\n#define COMPRESSION_FACTOR 1.0\n#endif\nuniform sampler2D u_texture;\nuniform sampler2D u_gradient;\nuniform vec2 u_densityMinAndInvRange;\nuniform float u_densityNormalization;\nvarying vec2 v_uv;\nvoid main() {\nvec4 data \x3d texture2D(u_texture, v_uv);\nfloat density \x3d data.r * COMPRESSION_FACTOR;\ndensity *\x3d u_densityNormalization;\ndensity \x3d (density - u_densityMinAndInvRange.x) * u_densityMinAndInvRange.y;\nvec4 color \x3d texture2D(u_gradient, vec2(density, 0.5));\ngl_FragColor \x3d vec4(color.rgb * color.a, color.a);\n}",
"heatmapResolve.vert":"precision highp float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nvarying vec2 v_uv;\nconst float UV_TO_TILE_SPACE \x3d 512.;\nvoid main() {\nv_uv \x3d a_pos;\ngl_Position \x3d vec4((u_dvsMat3 * vec3(a_pos * UV_TO_TILE_SPACE, 1.)).xy, 1., 1.);\n}"}},highlight:{"blur.frag":"varying mediump vec2 v_texcoord;\nuniform mediump vec4 u_direction;\nuniform mediump mat4 u_channelSelector;\nuniform mediump float u_sigma;\nuniform sampler2D u_texture;\nmediump float gauss1(mediump vec2 dir) {\nreturn exp(-dot(dir, dir) / (2.0 * u_sigma * u_sigma));\n}\nmediump vec4 selectChannel(mediump vec4 sample) {\nreturn u_channelSelector * sample;\n}\nvoid accumGauss1(mediump float i, inout mediump float tot, inout mediump float weight) {\nmediump float w \x3d gauss1(i * u_direction.xy);\ntot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw))[3] * w;\nweight +\x3d w;\n}\nvoid main(void) {\nmediump float tot \x3d 0.0;\nmediump float weight \x3d 0.0;\naccumGauss1(-5.0, tot, weight);\naccumGauss1(-4.0, tot, weight);\naccumGauss1(-3.0, tot, weight);\naccumGauss1(-2.0, tot, weight);\naccumGauss1(-1.0, tot, weight);\naccumGauss1(0.0, tot, weight);\naccumGauss1(1.0, tot, weight);\naccumGauss1(2.0, tot, weight);\naccumGauss1(3.0, tot, weight);\naccumGauss1(4.0, tot, weight);\naccumGauss1(5.0, tot, weight);\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, tot / weight);\n}",
"highlight.frag":"varying mediump vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform mediump float u_sigma;\nuniform sampler2D u_shade;\nuniform mediump vec2 u_minMaxDistance;\nmediump float estimateDistance() {\nmediump float y \x3d texture2D(u_texture, v_texcoord)[3];\nconst mediump float y0 \x3d 0.5;\nmediump float m0 \x3d 1.0 / (sqrt(2.0 * 3.1415) * u_sigma);\nmediump float d \x3d (y - y0) / m0;\nreturn d;\n}\nmediump vec4 shade(mediump float d) {\nmediump float mappedDistance \x3d (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\nmappedDistance \x3d clamp(mappedDistance, 0.0, 1.0);\nreturn texture2D(u_shade, vec2(mappedDistance, 0.5));\n}\nvoid main(void) {\nmediump float d \x3d estimateDistance();\ngl_FragColor \x3d shade(d);\n}",
"textured.vert":"attribute mediump vec2 a_position;\nattribute mediump vec2 a_texcoord;\nvarying mediump vec2 v_texcoord;\nvoid main(void) {\ngl_Position \x3d vec4(a_position, 0.0, 1.0);\nv_texcoord \x3d a_texcoord;\n}"},magnifier:{"magnifier.frag":"uniform lowp vec4 u_background;\nuniform mediump sampler2D u_readbackTexture;\nuniform mediump sampler2D u_maskTexture;\nuniform mediump sampler2D u_overlayTexture;\nuniform bool u_maskEnabled;\nuniform bool u_overlayEnabled;\nvarying mediump vec2 v_texCoord;\nconst lowp float barrelFactor \x3d 1.1;\nlowp vec2 barrel(lowp vec2 uv) {\nlowp vec2 uvn \x3d uv * 2.0 - 1.0;\nif (uvn.x \x3d\x3d 0.0 \x26\x26 uvn.y \x3d\x3d 0.0) {\nreturn vec2(0.5, 0.5);\n}\nlowp float theta \x3d atan(uvn.y, uvn.x);\nlowp float r \x3d pow(length(uvn), barrelFactor);\nreturn r * vec2(cos(theta), sin(theta)) * 0.5 + 0.5;\n}\nvoid main(void)\n{\nlowp vec4 color \x3d texture2D(u_readbackTexture, barrel(v_texCoord));\ncolor \x3d (color + (1.0 - color.a) * u_background);\nlowp float mask \x3d u_maskEnabled ? texture2D(u_maskTexture, v_texCoord).a : 1.0;\ncolor *\x3d mask;\nlowp vec4 overlayColor \x3d u_overlayEnabled ? texture2D(u_overlayTexture, v_texCoord) : vec4(0);\ngl_FragColor \x3d overlayColor + (1.0 - overlayColor.a) * color;\n}",
"magnifier.vert":"precision mediump float;\nattribute mediump vec2 a_pos;\nuniform mediump vec4 u_drawPos;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\nv_texCoord \x3d a_pos;\ngl_Position \x3d vec4(u_drawPos.xy + vec2(a_pos - 0.5) * u_drawPos.zw, 0.0, 1.0);\n}"},materials:{"attributeData.glsl":"uniform highp sampler2D u_attributeData0;\nuniform highp sampler2D u_attributeData1;\nuniform highp sampler2D u_attributeData2;\nuniform highp sampler2D u_attributeData3;\nuniform highp sampler2D u_attributeData4;\nuniform highp sampler2D u_attributeData5;\nuniform highp int u_attributeTextureSize;\nhighp vec2 getAttributeDataCoords(in highp vec3 id) {\nhighp vec3  texel \x3d unpackDisplayIdTexel(id);\nhighp float size \x3d float(u_attributeTextureSize);\nhighp float u32 \x3d float(int(texel.r) + int(texel.g) * 256 + int(texel.b) * 256 * 256);\nhighp float col \x3d mod(u32, size);\nhighp float row \x3d (u32 - col) / size;\nhighp float u \x3d col / size;\nhighp float v \x3d row / size;\nreturn vec2(u, v);\n}\nhighp vec2 getAttributeDataTextureCoords(in highp vec3 id) {\nreturn (getAttributeDataCoords(id) * 2.0) - 1.0 + (.5 / vec2(u_attributeTextureSize));\n}\nhighp vec4 getAttributeData0(in highp vec3 id) {\nvec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData0, coords);\n}\nhighp vec4 getAttributeData1(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData1, coords);\n}\nhighp vec4 getAttributeData2(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData2, coords);\n}\nhighp vec4 getAttributeData3(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData3, coords);\n}\nhighp vec4 getAttributeData4(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData4, coords);\n}\nhighp vec4 getAttributeData5(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData5, coords);\n}\nfloat u88VVToFloat(in vec2 v) {\nbool isMagic \x3d v.x \x3d\x3d 255.0 \x26\x26 v.y \x3d\x3d 255.0;\nif (isMagic) {\nreturn NAN_MAGIC_NUMBER;\n}\nreturn (v.x + v.y * float(0x100)) - 32768.0;\n}",
"barycentric.glsl":"float inTriangle(vec3 bary) {\nvec3 absBary \x3d abs(bary);\nreturn step((absBary.x + absBary.y + absBary.z), 1.05);\n}\nvec3 xyToBarycentric(in vec2 pos, in vec2 v0,  in vec2 v1, in vec2 v2) {\nmat3 xyToBarycentricMat3 \x3d mat3(\nv1.x * v2.y - v2.x * v1.y, v2.x * v0.y - v0.x * v2.y, v0.x * v1.y - v1.x * v0.y,\nv1.y - v2.y, v2.y - v0.y, v0.y - v1.y,\nv2.x - v1.x, v0.x - v2.x, v1.x - v0.x\n);\nfloat A2 \x3d v0.x * (v1.y - v2.y) + v1.x * (v2.y - v0.y) + v2.x * (v0.y - v1.y);\nreturn (1. / A2) * xyToBarycentricMat3 * vec3(1., pos);\n}",
"constants.glsl":"const float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float C_RAD_TO_DEG \x3d 180.0 / 3.141592654;\nconst float SIGNED_BYTE_TO_UNSIGNED \x3d 128.0;\nconst float POSITION_PRECISION \x3d 1.0 / 8.0;\nconst float FILL_POSITION_PRECISION \x3d 1.0 / 1.0;\nconst float SOFT_EDGE_RATIO \x3d 1.0;\nconst float THIN_LINE_WIDTH_FACTOR \x3d 1.1;\nconst float THIN_LINE_HALF_WIDTH \x3d 1.0;\nconst float EXTRUDE_SCALE_PLACEMENT_PADDING \x3d 1.0 / 4.0;\nconst float OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float OUTLINE_SCALE \x3d 1.0 / 5.0;\nconst float SDF_FONT_SIZE \x3d 24.0;\nconst float MAX_SDF_DISTANCE \x3d 8.0;\nconst float PLACEMENT_PADDING \x3d 8.0;\nconst float EPSILON \x3d 0.00001;\nconst float EPSILON_HITTEST \x3d 0.05;\nconst int MAX_FILTER_COUNT \x3d 2;\nconst int ATTR_VV_SIZE \x3d 0;\nconst int ATTR_VV_COLOR \x3d 1;\nconst int ATTR_VV_OPACITY \x3d 2;\nconst int ATTR_VV_ROTATION \x3d 3;\nconst highp float NAN_MAGIC_NUMBER \x3d 1e-30;\nconst int BITSET_GENERIC_LOCK_COLOR \x3d 1;\nconst int BITSET_GENERIC_CONSIDER_ALPHA_ONLY \x3d 4;\nconst int BITSET_MARKER_ALIGNMENT_MAP \x3d 0;\nconst int BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE \x3d 2;\nconst int BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY \x3d 3;\nconst int BITSET_TYPE_FILL_OUTLINE \x3d 0;\nconst int BITSET_FILL_RANDOM_PATTERN_OFFSET \x3d 2;\nconst int BITSET_LINE_SCALE_DASH \x3d 2;",
fill:{"common.glsl":"#include \x3cmaterials/symbologyTypeUtils.glsl\x3e\n#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_sampleAlphaOnly;\n#endif\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nuniform lowp vec4 u_isActive[ 2 ];\nuniform highp float u_dotValue;\nuniform highp float u_tileDotsOverArea;\nuniform highp float u_dotTextureDotCount;\nuniform mediump float u_tileZoomFactor;\n#endif\nvarying highp vec3 v_id;\nvarying lowp vec4 v_color;\nvarying lowp float v_opacity;\nvarying mediump vec4 v_aux1;\n#ifdef PATTERN\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nvarying lowp float v_isOutline;\n#endif\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nvarying highp vec2 v_dotTextureCoords;\nvarying highp vec4 v_dotThresholds[ 2 ];\n#endif",
"fill.frag":"precision highp float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\n#endif\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nuniform mediump mat4 u_dotColors[ 2 ];\nuniform sampler2D u_dotTextures[ 2 ];\nuniform vec4 u_dotBackgroundColor;\n#endif\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.frag\x3e\nlowp vec4 drawLine() {\nfloat v_lineWidth \x3d v_aux1.x;\nvec2  v_normal    \x3d v_aux1.yz;\nLineData inputs \x3d LineData(\nv_color,\nv_normal,\nv_lineWidth,\nv_opacity,\nv_id\n);\nreturn shadeLine(inputs);\n}\n#endif\nlowp vec4 drawFill() {\nlowp vec4 out_color \x3d vec4(0.);\n#ifdef HITTEST\nout_color \x3d v_color;\n#elif defined(PATTERN)\nmediump vec4 v_tlbr \x3d v_aux1;\nmediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\nmediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color \x3d texture2D(u_texture, samplePos);\n#ifdef VV_COLOR\nif (v_sampleAlphaOnly \x3e 0.5) {\ncolor.rgb \x3d vec3(color.a);\n}\n#endif\nout_color \x3d v_opacity * v_color * color;\n#elif SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY \x26\x26 !defined(HIGHLIGHT)\nvec4 textureThresholds0 \x3d texture2D(u_dotTextures[0], v_dotTextureCoords);\nvec4 textureThresholds1 \x3d texture2D(u_dotTextures[1], v_dotTextureCoords);\nvec4 difference0 \x3d v_dotThresholds[0] - textureThresholds0;\nvec4 difference1 \x3d v_dotThresholds[1] - textureThresholds1;\n#ifdef DD_DOT_BLENDING\nvec4 isPositive0 \x3d step(0.0, difference0);\nvec4 isPositive1 \x3d step(0.0, difference1);\nfloat weightSum \x3d dot(isPositive0, difference0) + dot(isPositive1, difference1);\nfloat lessThanEqZero \x3d step(weightSum, 0.0);\nfloat greaterThanZero \x3d 1.0 - lessThanEqZero ;\nfloat divisor \x3d (weightSum + lessThanEqZero);\nvec4 weights0 \x3d difference0 * isPositive0 / divisor;\nvec4 weights1 \x3d difference1 * isPositive1 / divisor;\nvec4 dotColor \x3d u_dotColors[0] * weights0 + u_dotColors[1] * weights1;\nvec4 preEffectColor \x3d greaterThanZero * dotColor + lessThanEqZero * u_dotBackgroundColor;\n#else\nfloat diffMax \x3d max(max4(difference0), max4(difference1));\nfloat lessThanZero \x3d step(diffMax, 0.0);\nfloat greaterOrEqZero \x3d 1.0 - lessThanZero;\nvec4 isMax0 \x3d step(diffMax, difference0);\nvec4 isMax1 \x3d step(diffMax, difference1);\nvec4 dotColor \x3d u_dotColors[0] * isMax0 + u_dotColors[1] * isMax1;\nvec4 preEffectColor \x3d greaterOrEqZero * dotColor + lessThanZero * u_dotBackgroundColor;\n#endif\nout_color \x3d preEffectColor;\n#else\nout_color \x3d v_opacity * v_color;\n#endif\n#ifdef HIGHLIGHT\nout_color.a \x3d 1.0;\n#endif\nreturn out_color;\n}\nvoid main() {\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nif (v_isOutline \x3e 0.5) {\ngl_FragColor \x3d drawLine();\n} else {\ngl_FragColor \x3d drawFill();\n}\n#else\ngl_FragColor \x3d drawFill();\n#endif\n}",
"fill.vert":"#include \x3cmaterials/symbologyTypeUtils.glsl\x3e\n#define PACKED_LINE\nprecision highp float;\nattribute float a_bitset;\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nattribute float a_inverseArea;\nvec4 a_color \x3d vec4(0.0, 0.0, 0.0, 1.0);\nvec2 a_zoomRange \x3d vec2(0.0, 10000.0);\n#else\nattribute vec4 a_color;\nattribute vec4 a_aux2;\nattribute vec4 a_aux3;\n#ifndef SYMBOLOGY_TYPE_IS_SIMPLE_LIKE\nattribute vec4 a_aux1;\nattribute vec2 a_zoomRange;\n#else\nvec2 a_zoomRange \x3d vec2(0.0, 10000.0);\n#endif\n#endif\nuniform vec2 u_tileOffset;\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#include \x3cmaterials/fill/hittest.glsl\x3e\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nvec4 dotThreshold(vec4 featureAttrOverFeatureArea, float dotValue, float tileDotsOverArea) {\nreturn featureAttrOverFeatureArea * (1.0 / dotValue)  * (1.0 / tileDotsOverArea);\n}\n#endif\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.vert\x3e\nvoid drawLine(out lowp vec4 out_color, out highp vec3 out_pos) {\nLineData outputs \x3d buildLine(\nout_pos,\na_id,\na_pos,\na_color,\n(a_aux3.xy - 128.) / 16.,\n(a_aux3.zw - 128.) / 16.,\n0.,\na_aux2.z / 16.,\na_bitset,\nvec4(0.),\nvec2(0.),\na_aux2.w / 16.\n);\nv_id      \x3d outputs.id;\nv_opacity \x3d outputs.opacity;\nv_aux1    \x3d vec4(outputs.lineHalfWidth, outputs.normal, 0.);\nout_color \x3d outputs.color;\n}\n#endif\nvoid drawFill(out lowp vec4 out_color, out highp vec3 out_pos) {\nfloat a_bitSet \x3d a_bitset;\nout_color \x3d getColor(a_color, a_bitSet, BITSET_GENERIC_LOCK_COLOR);\nv_opacity \x3d getOpacity();\nv_id      \x3d norm(a_id);\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nmat3 tileToTileNormalized \x3d mat3(  2. / 512.,  0.,  0.,\n0., -2. / 512.,  0.,\n-1.,  1.,  1.  );\nout_pos   \x3d tileToTileNormalized * vec3((a_pos * FILL_POSITION_PRECISION), 1.);\n#else\nout_pos   \x3d u_dvsMat3 * vec3(a_pos * FILL_POSITION_PRECISION, 1.);\n#endif\n#ifdef PATTERN\nvec4  a_tlbr   \x3d a_aux1;\nfloat a_width  \x3d a_aux2.x;\nfloat a_height \x3d a_aux2.y;\nvec2  a_offset \x3d a_aux2.zw;\nvec2  a_scale  \x3d a_aux3.xy;\nfloat a_angle  \x3d a_aux3.z;\nvec2 scale \x3d (1.0 / SIGNED_BYTE_TO_UNSIGNED) * a_scale;\nfloat width \x3d u_zoomFactor * a_width * scale.x;\nfloat height \x3d u_zoomFactor * a_height * scale.y;\nfloat angle \x3d C_256_TO_RAD * a_angle;\nfloat sinA \x3d sin(angle);\nfloat cosA \x3d cos(angle);\nfloat dx \x3d 0.0;\nfloat dy \x3d 0.0;\nif (getBit(a_bitset, BITSET_FILL_RANDOM_PATTERN_OFFSET) \x3e 0.5) {\nfloat id \x3d rgba2float(vec4(a_id, 0.0));\ndx \x3d rand(vec2(id, 0.0));\ndy \x3d rand(vec2(0.0, id));\n}\nmat3 patternMatrix \x3d mat3(cosA / width, sinA / height, 0,\n-sinA / width, cosA / height, 0,\ndx,            dy,           1);\nvec2 tileOffset \x3d vec2(u_tileOffset.x * cosA - u_tileOffset.y * sinA, u_tileOffset.x * sinA + u_tileOffset.y * cosA);\ntileOffset \x3d mod(tileOffset, vec2(a_aux2.x, a_aux2.y));\nvec2 symbolOffset \x3d (a_offset - tileOffset) / vec2(width, height);\nv_tileTextureCoord \x3d (patternMatrix * vec3(a_pos * FILL_POSITION_PRECISION, 1.0)).xy - symbolOffset;\nv_aux1 \x3d a_tlbr / u_mosaicSize.xyxy;\nv_sampleAlphaOnly \x3d getBit(a_bitset, BITSET_GENERIC_CONSIDER_ALPHA_ONLY);\n#elif SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nvec4 ddAttributeData0 \x3d getAttributeData2(a_id) * u_isActive[0] * a_inverseArea;\nvec4 ddAttributeData1 \x3d getAttributeData3(a_id) * u_isActive[1] * a_inverseArea;\nfloat size \x3d u_tileZoomFactor * 512.0 * 1.0 / u_pixelRatio;\nv_dotThresholds[0] \x3d dotThreshold(ddAttributeData0, u_dotValue, u_tileDotsOverArea);\nv_dotThresholds[1] \x3d dotThreshold(ddAttributeData1, u_dotValue, u_tileDotsOverArea);\nv_dotTextureCoords \x3d (a_pos * FILL_POSITION_PRECISION + 0.5) / size;\n#endif\n}\n#ifdef HITTEST\nvoid draw(out lowp vec4 out_color, out highp vec3 out_pos) {\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nif (getBit(a_bitset, BITSET_TYPE_FILL_OUTLINE) \x3e 0.5) {\nout_pos \x3d vec3(0., 0., 2.);\nreturn;\n}\n#endif\nhittestFill(out_color, out_pos);\ngl_PointSize \x3d 1.0;\n}\n#elif defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE)\nvoid draw(out lowp vec4 out_color, out highp vec3 out_pos) {\nv_isOutline \x3d getBit(a_bitset, BITSET_TYPE_FILL_OUTLINE);\nif (v_isOutline \x3e 0.5) {\ndrawLine(out_color, out_pos);\n} else {\ndrawFill(out_color, out_pos);\n}\n}\n#else\n#define draw drawFill\n#endif\nvoid main()\n{\nINIT;\nhighp vec3 pos  \x3d vec3(0.);\nhighp vec4 color  \x3d vec4(0.);\ndraw(color, pos);\nv_color \x3d color;\ngl_Position \x3d vec4(clip(v_color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}",
"hittest.glsl":"#ifdef HITTEST\n#include \x3cmaterials/hittest/common.glsl\x3e\nattribute vec2 a_pos1;\nattribute vec2 a_pos2;\nvoid hittestFill(\nout lowp vec4 out_color,\nout highp vec3 out_pos\n) {\nvec3 pos        \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos  * FILL_POSITION_PRECISION, 1.);\nvec3 pos1       \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos1 * FILL_POSITION_PRECISION, 1.);\nvec3 pos2       \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos2 * FILL_POSITION_PRECISION, 1.);\nfloat hittestDist \x3d u_hittestDist;\nfloat dist \x3d distPointTriangle(u_hittestPos, pos.xy, pos1.xy, pos2.xy);\nout_pos \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nif (dist \x3c 0. || dist \x3e\x3d hittestDist) {\nout_pos.z +\x3d 2.0;\n}\nout_color \x3d vec4(1. / 255., 0, 0, dist \x3d\x3d 0. ? (1. / 255.) : 0.);\n}\n#endif"},
hittest:{"common.glsl":"#ifdef HITTEST\nuniform float u_hittestDist;\nuniform highp vec2 u_hittestPos;\nfloat projectScalar(vec2 a, vec2 b) {\nreturn dot(a, normalize(b));\n}\nfloat distPointSegment(vec2 p0, vec2 p1, vec2 p2) {\nvec2 L \x3d p2 - p1;\nvec2 A \x3d p0 - p1;\nfloat projAL \x3d projectScalar(A, L);\nfloat t \x3d clamp(projAL / length(L), 0., 1.);\nreturn distance(p0, p1 + t * (p2 - p1));\n}\nvoid hittestMarker(out lowp vec4 out_color, out highp vec3 out_pos, in highp vec3 pos, float size) {\nfloat dist \x3d distance(pos, vec3(u_hittestPos, 1.));\nout_pos \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nif ((dist - size) \x3e u_hittestDist) {\nout_pos.z +\x3d 2.0;\n}\nout_color \x3d vec4(1. / 255., 0, 0, (dist - size) \x3c 0. ? (1. / 255.) : 0.);\n}\nfloat intersectPointTriangleBary(vec2 p, vec2 a, vec2 b, vec2 c) {\nreturn inTriangle(xyToBarycentric(p, a, b, c));\n}\nfloat distPointTriangle(vec2 p, vec2 a, vec2 b, vec2 c) {\nvec2 ba \x3d b - a;\nvec2 ca \x3d c - a;\nfloat crossProduct \x3d ba.x * ca.y - ca.x * ba.y;\nbool isParallel \x3d crossProduct \x3c EPSILON_HITTEST \x26\x26 crossProduct \x3e -EPSILON_HITTEST;\nif (isParallel) {\nreturn -1.;\n}\nif (intersectPointTriangleBary(p.xy, a, b, c) \x3d\x3d 1.) {\nreturn 0.;\n}\nfloat distAB \x3d distPointSegment(p, a, b);\nfloat distBC \x3d distPointSegment(p, b, c);\nfloat distCA \x3d distPointSegment(p, c, a);\nreturn min(min(distAB, distBC), distCA);\n}\n#endif"},
icon:{"common.glsl":"#include \x3cutil/encoding.glsl\x3e\nuniform lowp vec2 u_mosaicSize;\nvarying lowp vec4 v_color;\nvarying highp vec3 v_id;\nvarying highp vec4 v_sizeTex;\nvarying mediump vec3 v_pos;\nvarying lowp float v_opacity;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\nvarying mediump float v_distRatio;\nvarying mediump float v_overridingOutlineColor;\nvarying mediump float v_isThin;\n#endif\n#ifdef SDF\nvec4 getColor(vec2 v_size, vec2 v_tex) {\nlowp vec4 fillPixelColor \x3d v_color;\nfloat d \x3d 0.5 - rgba2float(texture2D(u_texture, v_tex));\nfloat size \x3d max(v_size.x, v_size.y);\nfloat dist \x3d d * size * SOFT_EDGE_RATIO * v_distRatio;\nfillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\nfloat outlineWidth \x3d v_outlineWidth;\n#ifdef HIGHLIGHT\noutlineWidth \x3d max(outlineWidth, 4.0 * v_isThin);\n#endif\nif (outlineWidth \x3e 0.25) {\nlowp vec4 outlinePixelColor \x3d v_overridingOutlineColor * v_color + (1.0 - v_overridingOutlineColor) * v_outlineColor;\nfloat clampedOutlineSize \x3d min(outlineWidth, size);\noutlinePixelColor *\x3d clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\nreturn v_opacity * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n}\nreturn v_opacity * fillPixelColor;\n}\n#else\nvec4 getColor(vec2 _v_size, vec2 v_tex) {\nlowp vec4 texColor \x3d texture2D(u_texture, v_tex);\nreturn v_opacity * texColor * v_color;\n}\n#endif",
heatmapAccumulate:{"common.glsl":"varying lowp vec4 v_hittestResult;\nvarying mediump vec2 v_offsetFromCenter;\nvarying highp float v_fieldValue;","heatmapAccumulate.frag":"precision mediump float;\n#include \x3cmaterials/icon/heatmapAccumulate/common.glsl\x3e\n#ifdef HEATMAP_PRECISION_HALF_FLOAT\n#define COMPRESSION_FACTOR 0.25\n#else\n#define COMPRESSION_FACTOR 1.0\n#endif\nuniform lowp sampler2D u_texture;\nvoid main() {\n#ifdef HITTEST\ngl_FragColor \x3d v_hittestResult;\n#else\nfloat radius \x3d length(v_offsetFromCenter);\nfloat shapeWeight \x3d step(radius, 1.0);\nfloat oneMinusRadiusSquared \x3d 1.0 - radius * radius;\nfloat kernelWeight \x3d oneMinusRadiusSquared * oneMinusRadiusSquared;\ngl_FragColor \x3d vec4(shapeWeight * kernelWeight * v_fieldValue * COMPRESSION_FACTOR);\n#endif\n}",
"heatmapAccumulate.vert":"precision highp float;\nattribute vec2 a_vertexOffset;\nvec4 a_color \x3d vec4(0.0);\nvec2 a_zoomRange \x3d vec2(0.0, 10000.0);\nuniform float u_radius;\nuniform float u_isFieldActive;\nconst float TILE_TO_CLIP_SPACE \x3d 2.0 / 512.0;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/hittest/common.glsl\x3e\n#include \x3cmaterials/icon/heatmapAccumulate/common.glsl\x3e\nvoid main() {\nfloat filterFlags \x3d getFilterFlags();\n#ifdef HITTEST\nhighp vec4 out_hittestResult \x3d vec4(0.);\nhighp vec3 out_pos \x3d vec3(0.);\nvec3 pos \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos * POSITION_PRECISION, 1.0);\nhittestMarker(out_hittestResult, out_pos, pos, u_radius);\nv_hittestResult \x3d out_hittestResult;\ngl_PointSize \x3d 1.;\ngl_Position \x3d vec4(clip(a_color, out_pos, filterFlags, a_zoomRange), 1.0);\n#else\nv_offsetFromCenter \x3d sign(a_vertexOffset);\nv_fieldValue \x3d getAttributeData2(a_id).x * u_isFieldActive + 1.0 - u_isFieldActive;\nvec3 centerPos \x3d vec3(a_pos * POSITION_PRECISION * TILE_TO_CLIP_SPACE - 1.0, 1.0);\nvec3 vertexPos \x3d centerPos + vec3(v_offsetFromCenter, 0.0) * u_radius * TILE_TO_CLIP_SPACE;\ngl_Position \x3d vec4(clip(a_color, vertexPos, filterFlags, a_zoomRange), 1.0);\n#endif\n}"},
"hittest.glsl":"#ifdef HITTEST\n#include \x3cmaterials/hittest/common.glsl\x3e\nattribute vec2 a_vertexOffset1;\nattribute vec2 a_vertexOffset2;\nattribute vec2 a_texCoords1;\nattribute vec2 a_texCoords2;\nvec2 getTextureCoords(in vec3 bary, in vec2 texCoords0, in vec2 texCoords1, in vec2 texCoords2) {\nreturn texCoords0 * bary.x + texCoords1 * bary.y + texCoords2 * bary.z;\n}\nvoid hittestIcon(\ninout lowp vec4 out_color,\nout highp vec3 out_pos,\nin vec3 pos,\nin vec3 offset,\nin vec2 size,\nin float scaleFactor,\nin float isMapAligned\n) {\nout_pos \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nvec3 posBase \x3d u_viewMat3 * u_tileMat3  * pos;\nvec3 offset1 \x3d scaleFactor * vec3(a_vertexOffset1 / 16.0, 0.);\nvec3 offset2 \x3d scaleFactor * vec3(a_vertexOffset2 / 16.0, 0.);\nvec2 pos0    \x3d (posBase + getMatrixNoDisplay(isMapAligned) * offset).xy;\nvec2 pos1    \x3d (posBase + getMatrixNoDisplay(isMapAligned) * offset1).xy;\nvec2 pos2    \x3d (posBase + getMatrixNoDisplay(isMapAligned) * offset2).xy;\nvec3 bary0 \x3d xyToBarycentric(u_hittestPos + vec2(-u_hittestDist, -u_hittestDist), pos0, pos1, pos2);\nvec3 bary1 \x3d xyToBarycentric(u_hittestPos + vec2(0., -u_hittestDist), pos0, pos1, pos2);\nvec3 bary2 \x3d xyToBarycentric(u_hittestPos + vec2(u_hittestDist, -u_hittestDist), pos0, pos1, pos2);\nvec3 bary3 \x3d xyToBarycentric(u_hittestPos + vec2(-u_hittestDist, 0.), pos0, pos1, pos2);\nvec3 bary4 \x3d xyToBarycentric(u_hittestPos, pos0, pos1, pos2);\nvec3 bary5 \x3d xyToBarycentric(u_hittestPos + vec2(u_hittestDist, 0.), pos0, pos1, pos2);\nvec3 bary6 \x3d xyToBarycentric(u_hittestPos + vec2(-u_hittestDist, u_hittestDist), pos0, pos1, pos2);\nvec3 bary7 \x3d xyToBarycentric(u_hittestPos + vec2(0., u_hittestDist), pos0, pos1, pos2);\nvec3 bary8 \x3d xyToBarycentric(u_hittestPos + vec2(u_hittestDist, u_hittestDist), pos0, pos1, pos2);\nvec2 tex0 \x3d a_texCoords  / u_mosaicSize;\nvec2 tex1 \x3d a_texCoords1 / u_mosaicSize;\nvec2 tex2 \x3d a_texCoords2 / u_mosaicSize;\nfloat alphaSum \x3d 0.;\nalphaSum +\x3d inTriangle(bary0) * getColor(size, getTextureCoords(bary0, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary1) * getColor(size, getTextureCoords(bary1, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary2) * getColor(size, getTextureCoords(bary2, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary3) * getColor(size, getTextureCoords(bary3, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary4) * getColor(size, getTextureCoords(bary4, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary5) * getColor(size, getTextureCoords(bary5, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary6) * getColor(size, getTextureCoords(bary6, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary7) * getColor(size, getTextureCoords(bary7, tex0, tex1, tex2)).a;\nout_pos.z +\x3d step(alphaSum, .05) * 2.0;\nout_color \x3d vec4(1. / 255., 0., 0., alphaSum / 255.);\n}\n#endif",
"icon.frag":"precision mediump float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nvoid main()\n{\n#ifdef HITTEST\nvec4 color \x3d v_color;\n#else\nvec4 color \x3d getColor(v_sizeTex.xy, v_sizeTex.zw);\n#endif\n#ifdef HIGHLIGHT\ncolor.a \x3d step(1.0 / 255.0, color.a);\n#endif\ngl_FragColor \x3d color;\n}","icon.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec2 a_bitSetAndDistRatio;\nattribute vec2 a_zoomRange;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\n#include \x3cmaterials/icon/hittest.glsl\x3e\nfloat getMarkerScaleFactor(inout vec2 size, in float referenceSize) {\n#ifdef VV_SIZE\nfloat f \x3d getSize(size.y) / size.y;\nfloat sizeFactor \x3d size.y / referenceSize;\nreturn getSize(referenceSize) / referenceSize;\n#else\nreturn 1.;\n#endif\n}\nvoid main()\n{\nINIT;\nfloat a_bitSet \x3d a_bitSetAndDistRatio.x;\nvec3  pos           \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nvec2  size          \x3d a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 128.0;\nvec3  offset        \x3d vec3(a_vertexOffset / 16.0, 0.);\nfloat outlineSize   \x3d a_sizeAndOutlineWidth.z * a_sizeAndOutlineWidth.z / 128.0;\nfloat isMapAligned  \x3d getBit(a_bitSet, BITSET_MARKER_ALIGNMENT_MAP);\nfloat referenceSize \x3d a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 128.0;\nfloat scaleSymbolProportionally \x3d getBit(a_bitSet, BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY);\nfloat scaleFactor               \x3d getMarkerScaleFactor(size, referenceSize);\nsize.xy     *\x3d scaleFactor;\noffset.xy   *\x3d scaleFactor;\noutlineSize *\x3d scaleSymbolProportionally * (scaleFactor - 1.0) + 1.0;\nvec2 v_tex   \x3d a_texCoords / u_mosaicSize;\nfloat filterFlags \x3d getFilterFlags();\nv_color    \x3d getColor(a_color, a_bitSet, BITSET_GENERIC_LOCK_COLOR);\nv_opacity  \x3d getOpacity();\nv_id       \x3d norm(a_id);\nv_pos      \x3d u_dvsMat3 * pos + getMatrix(isMapAligned) * getRotation()  * offset;\nv_sizeTex  \x3d vec4(size.xy, v_tex.xy);\n#ifdef SDF\nv_isThin   \x3d getBit(a_bitSet, BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE);\n#ifdef VV_COLOR\nv_overridingOutlineColor \x3d v_isThin;\n#else\nv_overridingOutlineColor \x3d 0.0;\n#endif\nv_outlineWidth \x3d min(outlineSize, max(max(size.x, size.y) - 0.99, 0.0));\nv_outlineColor \x3d a_outlineColor;\nv_distRatio \x3d a_bitSetAndDistRatio.y / 126.0;\n#endif\n#ifdef HITTEST\nhighp vec4 out_color \x3d vec4(0.);\nhighp vec3 out_pos   \x3d vec3(0.);\nhittestIcon(out_color, out_pos, pos, offset, size, scaleFactor, isMapAligned);\nv_color \x3d out_color;\ngl_PointSize \x3d 1.;\ngl_Position \x3d vec4(clip(v_color, out_pos, filterFlags, a_zoomRange), 1.0);\n#else\ngl_Position \x3d vec4(clip(v_color, v_pos, filterFlags, a_zoomRange), 1.0);\n#endif\n}"},
label:{"common.glsl":"uniform mediump float u_zoomLevel;\nuniform mediump float u_mapRotation;\nuniform mediump float u_mapAligned;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying mediump vec4 v_color;\nvarying lowp vec4 v_animation;","label.frag":"#include \x3cmaterials/text/text.frag\x3e","label.vert":"precision highp float;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texAndSize;\nattribute vec4 a_refSymbolAndPlacementOffset;\nattribute vec4 a_glyphData;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nuniform float u_mapRotation;\nuniform float u_mapAligned;\nfloat getZ(in float minZoom, in float maxZoom, in float angle) {\nfloat glyphAngle \x3d angle * 360.0 / 254.0;\nfloat mapAngle \x3d u_mapRotation * 360.0 / 254.0;\nfloat diffAngle \x3d min(360.0 - abs(mapAngle - glyphAngle), abs(mapAngle - glyphAngle));\nfloat z \x3d 0.0;\nz +\x3d u_mapAligned * (2.0 * (1.0 - step(minZoom, u_currentZoom)));\nz +\x3d u_mapAligned * 2.0 * step(90.0, diffAngle);\nz +\x3d 2.0 * (1.0 - step(u_currentZoom, maxZoom));\nreturn z;\n}\nvoid main()\n{\nINIT;\nfloat groupMinZoom    \x3d getMinZoom();\nfloat glyphMinZoom    \x3d a_glyphData.x;\nfloat glyphMaxZoom    \x3d a_glyphData.y;\nfloat glyphAngle      \x3d a_glyphData.z;\nfloat a_minZoom          \x3d max(groupMinZoom, glyphMinZoom);\nfloat a_placementPadding \x3d a_refSymbolAndPlacementOffset.x * EXTRUDE_SCALE_PLACEMENT_PADDING;\nvec2  a_placementDir     \x3d unpack_u8_nf32(a_refSymbolAndPlacementOffset.zw);\nfloat a_refSymbolSize    \x3d a_refSymbolAndPlacementOffset.y;\nfloat fontSize           \x3d a_texAndSize.z;\nfloat haloSize           \x3d a_texAndSize.w * OUTLINE_SCALE;\nvec2  vertexOffset \x3d a_vertexOffset * OFFSET_PRECISION;\nvec3  pos          \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nfloat z            \x3d getZ(a_minZoom, glyphMaxZoom, glyphAngle);\nfloat fontScale    \x3d fontSize / SDF_FONT_SIZE;\nfloat halfSize     \x3d getSize(a_refSymbolSize) / 2.0;\nfloat animation    \x3d pow(getAnimationState(), vec4(2.0)).r;\nv_color     \x3d animation * ((1.0 - u_isHalo) * a_color + (u_isHalo * a_haloColor));\nv_opacity   \x3d 1.0;\nv_tex       \x3d a_texCoords / u_mosaicSize;\nv_edgeDistanceOffset \x3d u_isHalo * haloSize / fontScale / MAX_SDF_DISTANCE;\nv_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\nvec2 placementOffset \x3d a_placementDir * (halfSize + a_placementPadding);\nvec3 glyphOffset     \x3d u_displayMat3 * vec3(vertexOffset + placementOffset, 0.0);\nvec3 v_pos           \x3d vec3((u_dvsMat3 * pos + glyphOffset).xy, z);\ngl_Position \x3d vec4(v_pos, 1.0);\n#ifdef DEBUG\nv_color \x3d vec4(a_color.rgb, z \x3d\x3d 0.0 ? 1.0 : 0.645);\n#endif\n}"},
line:{"common.glsl":"varying lowp vec4 v_color;\nvarying highp vec3 v_id;\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp float v_opacity;\n#ifdef PATTERN\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\n#endif\n#if defined(PATTERN) || defined(SDF)\nvarying highp float v_accumulatedDistance;\n#endif\n#ifdef SDF\nvarying mediump float v_lineWidthRatio;\n#endif","hittest.glsl":"#include \x3cmaterials/hittest/common.glsl\x3e\n#ifdef HITTEST\nattribute vec2 a_pos1;\nattribute vec2 a_pos2;\nvoid hittestLine(out lowp vec4 out_color, out highp vec3 out_pos, float halfWidth) {\nvec3 pos        \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos  * POSITION_PRECISION, 1.);\nvec3 pos1       \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos1 * POSITION_PRECISION, 1.);\nvec3 pos2       \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos2 * POSITION_PRECISION, 1.);\nvec3 outTextureCoords \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nfloat dist \x3d min(distPointSegment(u_hittestPos, pos.xy, pos1.xy),\ndistPointSegment(u_hittestPos, pos.xy, pos2.xy)) - halfWidth;\nout_pos \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nif (dist \x3e\x3d u_hittestDist) {\nout_pos.z +\x3d 2.0;\n}\nout_color \x3d vec4(1. / 255., 0, 0, dist \x3c\x3d 0. ? (1. / 255.) : 0.);\n}\n#endif",
"line.frag":"precision lowp float;\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/symbologyTypeUtils.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.frag\x3e\n#ifdef HITTEST\nvoid main() {\ngl_FragColor \x3d v_color;\n}\n#else\nvoid main() {\nLineData inputs \x3d LineData(\nv_color,\nv_normal,\nv_lineHalfWidth,\nv_opacity,\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nv_tlbr,\nv_patternSize,\n#endif\n#ifdef SDF\nv_lineWidthRatio,\n#endif\n#if defined(PATTERN) || defined(SDF)\nv_accumulatedDistance,\n#endif\n#endif\nv_id\n);\ngl_FragColor \x3d shadeLine(inputs);\n}\n#endif",
"line.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistanceAndHalfWidth;\nattribute vec4 a_tlbr;\nattribute vec4 a_segmentDirection;\nattribute vec2 a_aux;\nattribute vec2 a_zoomRange;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/symbologyTypeUtils.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\n#include \x3cmaterials/line/hittest.glsl\x3e\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.vert\x3e\n#ifdef HITTEST\nvoid draw() {\nfloat aa        \x3d 0.5 * u_antialiasing;\nfloat a_halfWidth \x3d a_accumulatedDistanceAndHalfWidth.y / 16.;\nfloat a_cimHalfWidth \x3d a_aux.x / 16. ;\nvec2  a_offset \x3d a_offsetAndNormal.xy / 16.;\nfloat baseWidth \x3d getBaseLineHalfWidth(a_halfWidth, a_cimHalfWidth);\nfloat halfWidth \x3d getLineHalfWidth(baseWidth, aa);\nhighp vec3 pos  \x3d vec3(0.);\nv_color \x3d vec4(0.);\nhittestLine(v_color, pos, halfWidth);\ngl_PointSize \x3d 1.;\ngl_Position \x3d vec4(clip(v_color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}\n#else\nvoid draw()\n{\nhighp vec3 pos \x3d vec3(0.);\nLineData outputs \x3d buildLine(\npos,\na_id,\na_pos,\na_color,\na_offsetAndNormal.xy / 16.,\na_offsetAndNormal.zw / 16.,\na_accumulatedDistanceAndHalfWidth.x,\na_accumulatedDistanceAndHalfWidth.y / 16.,\na_segmentDirection.w,\na_tlbr,\na_segmentDirection.xy / 16.,\na_aux.x / 16.\n);\nv_id              \x3d outputs.id;\nv_color           \x3d outputs.color;\nv_normal          \x3d outputs.normal;\nv_lineHalfWidth   \x3d outputs.lineHalfWidth;\nv_opacity         \x3d outputs.opacity;\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nv_tlbr          \x3d outputs.tlbr;\nv_patternSize   \x3d outputs.patternSize;\n#endif\n#ifdef SDF\nv_lineWidthRatio \x3d outputs.lineWidthRatio;\n#endif\n#if defined(PATTERN) || defined(SDF)\nv_accumulatedDistance \x3d outputs.accumulatedDistance;\n#endif\n#endif\ngl_Position \x3d vec4(clip(outputs.color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}\n#endif\nvoid main() {\nINIT;\ndraw();\n}"},
pie:{"pie.frag":"precision mediump float;\n#include \x3cutil/atan2.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nvarying float v_size;\nvarying vec2 v_offset;\nvarying vec2 v_filteredSectorToColorId[NUMBER_OF_FIELDS];\nvarying float v_numOfEntries;\nvarying float v_maxSectorAngle;\nuniform lowp vec4 u_colors[NUMBER_OF_FIELDS];\nuniform lowp vec4 u_defaultColor;\nuniform lowp vec4 u_othersColor;\nuniform lowp vec4 u_outlineColor;\nuniform float u_donutRatio;\nuniform float u_sectorThreshold;\nstruct FilteredChartInfo {\nfloat endSectorAngle;\nint colorId;\n};\nlowp vec4 getSectorColor(in int index, in vec2 filteredSectorToColorId[NUMBER_OF_FIELDS]) {\n#if __VERSION__ \x3d\x3d 300\nmediump int colorIndex \x3d int(filteredSectorToColorId[index].y);\nreturn u_colors[colorIndex];\n#else\nmediump int colorIndex;\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; ++i) {\nif (i \x3d\x3d index) {\ncolorIndex \x3d int(filteredSectorToColorId[i].y);\n}\n}\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; ++i) {\nif (i \x3d\x3d colorIndex) {\nreturn u_colors[i];\n}\n}\nreturn u_colors[NUMBER_OF_FIELDS - 1];\n#endif\n}\nconst int OTHER_SECTOR_ID \x3d 255;\n#ifdef HITTEST\nvec4 getColor() {\nreturn v_color;\n}\n#else\nvec4 getColor() {\nfloat angle \x3d 90.0 - C_RAD_TO_DEG * atan2(v_offset.y, v_offset.x);\nif (angle \x3c 0.0) {\nangle +\x3d 360.0;\n} else if (angle \x3e 360.0) {\nangle \x3d mod(angle, 360.0);\n}\nint numOfEntries \x3d int(v_numOfEntries);\nfloat maxSectorAngle \x3d v_maxSectorAngle;\nlowp vec4 fillColor \x3d (maxSectorAngle \x3e 0.0 || u_sectorThreshold \x3e 0.0) ? u_othersColor : u_defaultColor;\nlowp vec4 prevColor \x3d vec4(0.0);\nlowp vec4 nextColor \x3d vec4(0.0);\nfloat startSectorAngle \x3d 0.0;\nfloat endSectorAngle \x3d 0.0;\nif (angle \x3c maxSectorAngle) {\nfor (int index \x3d 0; index \x3c NUMBER_OF_FIELDS; ++index) {\nstartSectorAngle \x3d endSectorAngle;\nendSectorAngle \x3d v_filteredSectorToColorId[index].x;\nif (endSectorAngle \x3e angle) {\nfillColor \x3d getSectorColor(index, v_filteredSectorToColorId);\nprevColor \x3d u_sectorThreshold !\x3d 0.0 \x26\x26 index \x3d\x3d 0 \x26\x26 abs(360.0 - maxSectorAngle) \x3c EPSILON ? u_othersColor :\ngetSectorColor(index \x3e 0 ? index - 1 : numOfEntries - 1, v_filteredSectorToColorId);\nnextColor \x3d u_sectorThreshold !\x3d 0.0 \x26\x26 abs(endSectorAngle - maxSectorAngle) \x3c EPSILON ? u_othersColor :\ngetSectorColor(index \x3c numOfEntries - 1 ? index + 1 : 0, v_filteredSectorToColorId);\nbreak;\n}\nif (index \x3d\x3d numOfEntries - 1) {\nbreak;\n}\n}\n} else {\nprevColor \x3d getSectorColor(numOfEntries - 1, v_filteredSectorToColorId);\nnextColor \x3d getSectorColor(0, v_filteredSectorToColorId);\nstartSectorAngle \x3d maxSectorAngle;\nendSectorAngle \x3d 360.0;\n}\nlowp vec4 outlineColor \x3d u_outlineColor;\nfloat offset \x3d length(v_offset);\nfloat distanceSize \x3d offset * v_size;\nif (startSectorAngle !\x3d 0.0 || endSectorAngle !\x3d 360.0) {\nfloat distanceToStartSector \x3d (angle - startSectorAngle);\nfloat distanceToEndSector \x3d (endSectorAngle - angle);\nfloat sectorThreshold \x3d 0.6;\nfloat beginSectorAlpha \x3d smoothstep(0.0, sectorThreshold, distanceToStartSector * offset);\nfloat endSectorAlpha \x3d smoothstep(0.0, sectorThreshold, distanceToEndSector * offset);\nif (endSectorAlpha \x3e 0.0) {\nfillColor \x3d mix(nextColor, fillColor, endSectorAlpha);\n} else if (beginSectorAlpha \x3e 0.0) {\nfillColor \x3d mix(prevColor, fillColor, beginSectorAlpha);\n}\n}\nfloat donutSize \x3d u_donutRatio * (v_size - v_outlineWidth);\nfloat endOfDonut \x3d donutSize - v_outlineWidth;\nfloat aaThreshold \x3d 0.75;\nfloat innerCircleAlpha \x3d endOfDonut - aaThreshold \x3e 0.0 ? smoothstep(endOfDonut - aaThreshold, endOfDonut + aaThreshold, distanceSize) : 1.0;\nfloat outerCircleAlpha \x3d 1.0 - smoothstep(v_size - aaThreshold, v_size + aaThreshold , distanceSize);\nfloat circleAlpha \x3d innerCircleAlpha * outerCircleAlpha;\nfloat startOfOutline \x3d v_size - v_outlineWidth;\nif (startOfOutline \x3e 0.0 \x26\x26 v_outlineWidth \x3e 0.25) {\nfloat outlineFactor \x3d smoothstep(startOfOutline - aaThreshold, startOfOutline + aaThreshold, distanceSize);\nfloat innerLineFactor \x3d donutSize - aaThreshold \x3e 0.0 ? 1.0 - smoothstep(donutSize - aaThreshold, donutSize + aaThreshold , distanceSize) : 0.0;\nfillColor \x3d mix(fillColor, outlineColor, innerLineFactor + outlineFactor);\n}\nreturn v_opacity * circleAlpha * fillColor;\n}\n#endif\nvoid main()\n{\nvec4 color \x3d getColor();\n#ifdef HIGHLIGHT\ncolor.a \x3d step(1.0 / 255.0, color.a);\n#endif\ngl_FragColor \x3d color;\n}",
"pie.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec2 a_bitSetAndDistRatio;\nattribute vec2 a_zoomRange;\nuniform float u_outlineWidth;\nuniform mediump float u_sectorThreshold;\nvarying float v_size;\nvarying vec2 v_offset;\nvarying vec2 v_filteredSectorToColorId[NUMBER_OF_FIELDS];\nvarying float v_numOfEntries;\nvarying float v_maxSectorAngle;\nstruct FilteredChartInfo {\nfloat endSectorAngle;\nint colorId;\n};\nint filter(in float sectorAngle,\nin int currentIndex,\ninout FilteredChartInfo filteredInfo,\ninout vec2 filteredSectorToColorId[NUMBER_OF_FIELDS]) {\nif (sectorAngle \x3e u_sectorThreshold * 360.0) {\nfilteredInfo.endSectorAngle +\x3d sectorAngle;\n#if __VERSION__ \x3d\x3d 300\nfilteredSectorToColorId[filteredInfo.colorId] \x3d vec2(filteredInfo.endSectorAngle, currentIndex);\n#else\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; i++) {\nif (i \x3d\x3d filteredInfo.colorId) {\nfilteredSectorToColorId[i] \x3d vec2(filteredInfo.endSectorAngle, currentIndex);\n}\n}\n#endif\n++filteredInfo.colorId;\n}\nreturn 0;\n}\nint filterValues(inout vec2 filteredSectorToColorId[NUMBER_OF_FIELDS],\ninout FilteredChartInfo filteredInfo,\nin float sectorAngles[NUMBER_OF_FIELDS]) {\nfor (int index \x3d 0; index \x3c NUMBER_OF_FIELDS; ++index) {\nfloat sectorValue \x3d sectorAngles[index];\nfilter(sectorValue, index, filteredInfo, filteredSectorToColorId);\n}\nreturn filteredInfo.colorId;\n}\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\n#include \x3cmaterials/hittest/common.glsl\x3e\nvec2 getMarkerSize(inout vec2 offset, inout vec2 baseSize, inout float outlineSize, in float referenceSize, in float bitSet) {\nvec2 outSize \x3d baseSize;\n#ifdef VV_SIZE\nfloat r \x3d 0.5 * getSize(referenceSize) / referenceSize;\noutSize.xy *\x3d r;\noffset.xy *\x3d r;\nfloat scaleSymbolProportionally \x3d getBit(bitSet, BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY);\noutlineSize *\x3d scaleSymbolProportionally * (r - 1.0) + 1.0;\n#endif\nreturn outSize;\n}\nvec3 getOffset(in vec2 in_offset, float a_bitSet) {\nfloat isMapAligned \x3d getBit(a_bitSet, BITSET_MARKER_ALIGNMENT_MAP);\nvec3  offset       \x3d vec3(in_offset, 0.0);\nreturn getMatrix(isMapAligned) * offset;\n}\nfloat filterNaNValues(in float value) {\nreturn value !\x3d NAN_MAGIC_NUMBER ? value : 0.0;\n}\nvoid main()\n{\nINIT;\nvec2  a_size   \x3d a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 128.0;\nvec2  a_offset \x3d a_vertexOffset / 16.0;\nfloat outlineSize \x3d u_outlineWidth;\nfloat a_bitSet \x3d a_bitSetAndDistRatio.x;\nvec2 size \x3d getMarkerSize(a_offset, a_size, outlineSize, a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 128.0, a_bitSet);\nfloat filterFlags \x3d getFilterFlags();\nvec3  pos         \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nv_opacity      \x3d getOpacity();\nv_id           \x3d norm(a_id);\nv_pos          \x3d u_dvsMat3 * pos + getOffset(a_offset, a_bitSet);\nv_offset       \x3d sign(a_texCoords - 0.5);\nv_size         \x3d max(size.x, size.y);\nv_outlineWidth \x3d outlineSize;\nfloat attributeData[10];\nvec4 attributeData0 \x3d getAttributeData3(a_id);\nattributeData[0] \x3d filterNaNValues(attributeData0.x);\nattributeData[1] \x3d filterNaNValues(attributeData0.y);\nattributeData[2] \x3d filterNaNValues(attributeData0.z);\nattributeData[3] \x3d filterNaNValues(attributeData0.w);\n#if (NUMBER_OF_FIELDS \x3e 4)\nvec4 attributeData1 \x3d getAttributeData4(a_id);\nattributeData[4] \x3d filterNaNValues(attributeData1.x);\nattributeData[5] \x3d filterNaNValues(attributeData1.y);\nattributeData[6] \x3d filterNaNValues(attributeData1.z);\nattributeData[7] \x3d filterNaNValues(attributeData1.w);\n#endif\n#if (NUMBER_OF_FIELDS \x3e 8)\nvec4 attributeData2 \x3d getAttributeData5(a_id);\nattributeData[8] \x3d filterNaNValues(attributeData2.x);\nattributeData[9] \x3d filterNaNValues(attributeData2.y);\n#endif\nfloat sum \x3d 0.0;\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; ++i) {\nsum +\x3d attributeData[i];\n}\nfloat sectorAngles[NUMBER_OF_FIELDS];\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; ++i) {\nsectorAngles[i] \x3d 360.0 * attributeData[i] / sum;\n}\nvec2 filteredSectorToColorId[NUMBER_OF_FIELDS];\nFilteredChartInfo filteredInfo \x3d FilteredChartInfo(0.0, 0);\nint numOfEntries \x3d filterValues(filteredSectorToColorId, filteredInfo, sectorAngles);\nv_numOfEntries \x3d float(numOfEntries);\nv_maxSectorAngle \x3d filteredInfo.endSectorAngle;\n#if __VERSION__ \x3d\x3d 300\nv_filteredSectorToColorId \x3d filteredSectorToColorId;\n#else\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; ++i) {\nif (i \x3d\x3d numOfEntries) {\nbreak;\n}\nv_filteredSectorToColorId[i] \x3d filteredSectorToColorId[i];\n}\n#endif\n#ifdef HITTEST\nhighp vec3 out_pos \x3d vec3(0.0);\nv_color            \x3d vec4(0.0);\nhittestMarker(v_color, out_pos, u_viewMat3 * u_tileMat3 *  pos, v_size);\ngl_PointSize \x3d 1.0;\ngl_Position \x3d vec4(clip(v_color, out_pos, filterFlags, a_zoomRange), 1.0);\n#else\ngl_Position \x3d vec4(clip(v_color, v_pos, filterFlags, a_zoomRange), 1.0);\n#endif\n}"},
shared:{line:{"common.glsl":"#if !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE) \x26\x26 defined(PATTERN)\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_sampleAlphaOnly;\n#endif\nstruct LineData {\nlowp vec4 color;\nmediump vec2 normal;\nmediump float lineHalfWidth;\nlowp float opacity;\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nmediump vec4 tlbr;\nmediump vec2 patternSize;\n#endif\n#ifdef SDF\nmediump float lineWidthRatio;\n#endif\n#if defined(PATTERN) || defined(SDF)\nhighp float accumulatedDistance;\n#endif\n#endif\nhighp vec3 id;\n};",
"line.frag":"uniform lowp float u_blur;\n#if !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE) \x26\x26 !defined(HIGHLIGHT)\n#if defined(PATTERN) || defined(SDF)\nuniform sampler2D u_texture;\nuniform highp float u_pixelRatio;\n#endif\n#endif\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT) \x26\x26 !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE)\nlowp vec4 getLineColor(LineData line) {\nmediump float adjustedPatternWidth \x3d line.patternSize.x * 2.0 * line.lineWidthRatio;\nmediump float relativeTexX \x3d fract(line.accumulatedDistance / adjustedPatternWidth);\nmediump float relativeTexY \x3d 0.5 + 0.25 * line.normal.y;\nmediump vec2 texCoord \x3d mix(line.tlbr.xy, line.tlbr.zw, vec2(relativeTexX, relativeTexY));\nmediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\nfloat dist \x3d d * line.lineHalfWidth;\nreturn line.opacity * clamp(0.5 - dist, 0.0, 1.0) * line.color;\n}\n#elif defined(PATTERN) \x26\x26 !defined(HIGHLIGHT) \x26\x26 !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE)\nlowp vec4 getLineColor(LineData line) {\nmediump float lineHalfWidth \x3d line.lineHalfWidth;\nmediump float adjustedPatternWidth \x3d line.patternSize.x * 2.0 * lineHalfWidth / line.patternSize.y;\nmediump float relativeTexX \x3d fract(line.accumulatedDistance / adjustedPatternWidth);\nmediump float relativeTexY \x3d 0.5 + 0.5 * line.normal.y;\nmediump vec2 texCoord \x3d mix(line.tlbr.xy, line.tlbr.zw, vec2(relativeTexY, relativeTexX));\nlowp vec4 color \x3d texture2D(u_texture, texCoord);\n#ifdef VV_COLOR\nif (v_sampleAlphaOnly \x3e 0.5) {\ncolor.rgb \x3d vec3(color.a);\n}\n#endif\nreturn line.opacity * line.color * color;\n}\n#else\nlowp vec4 getLineColor(LineData line) {\nreturn line.opacity * line.color;\n}\n#endif\nvec4 shadeLine(LineData line)\n{\nmediump float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(line.lineHalfWidth, THIN_LINE_HALF_WIDTH), 1.0);\nmediump float fragDist \x3d length(line.normal) * line.lineHalfWidth;\nlowp float alpha \x3d clamp(thinLineFactor * (line.lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\nlowp vec4 out_color \x3d getLineColor(line) * alpha;\n#ifdef HIGHLIGHT\nout_color.a \x3d step(1.0 / 255.0, out_color.a);\n#endif\n#ifdef ID\nif (out_color.a \x3c 1.0 / 255.0) {\ndiscard;\n}\nout_color \x3d vec4(line.id, 0.0);\n#endif\nreturn out_color;\n}",
"line.vert":"float getBaseLineHalfWidth(in float lineHalfWidth, in float referenceHalfWidth) {\n#ifdef VV_SIZE\nfloat refLineWidth \x3d 2.0 * referenceHalfWidth;\nreturn 0.5 * (lineHalfWidth / max(referenceHalfWidth, EPSILON)) * getSize(refLineWidth);\n#else\nreturn lineHalfWidth;\n#endif\n}\nfloat getLineHalfWidth(in float baseWidth, in float aa) {\nfloat halfWidth \x3d max(baseWidth + aa, 0.45) + 0.1 * aa;\n#ifdef HIGHLIGHT\nhalfWidth \x3d max(halfWidth, 2.0);\n#endif\nreturn halfWidth;\n}\nvec2 getDist(in vec2 offset, in float halfWidth) {\nfloat thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(halfWidth, THIN_LINE_HALF_WIDTH), 1.0);\nreturn thinLineFactor * halfWidth * offset;\n}\nLineData buildLine(\nout vec3 out_pos,\nin vec3 in_id,\nin vec2 in_pos,\nin vec4 in_color,\nin vec2 in_offset,\nin vec2 in_normal,\nin float in_accumulatedDist,\nin float in_lineHalfWidth,\nin float in_bitSet,\nin vec4 in_tlbr,\nin vec2 in_segmentDirection,\nin float in_referenceHalfWidth\n)\n{\nfloat aa        \x3d 0.5 * u_antialiasing;\nfloat baseWidth \x3d getBaseLineHalfWidth(in_lineHalfWidth, in_referenceHalfWidth);\nfloat halfWidth \x3d getLineHalfWidth(baseWidth, aa);\nfloat z         \x3d 2.0 * step(baseWidth, 0.0);\nvec2  dist      \x3d getDist(in_offset, halfWidth);\nvec3  offset    \x3d u_displayViewMat3 * vec3(dist, 0.0);\nvec3  pos       \x3d u_dvsMat3 * vec3(in_pos * POSITION_PRECISION, 1.0) + offset;\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nvec4  color     \x3d in_color;\nfloat opacity   \x3d 1.0;\n#else\nvec4  color     \x3d getColor(in_color, in_bitSet, BITSET_GENERIC_LOCK_COLOR);\nfloat opacity   \x3d getOpacity();\n#ifdef SDF\nconst float SDF_PATTERN_HALF_WIDTH \x3d 15.5;\nfloat scaleDash \x3d getBit(in_bitSet, BITSET_LINE_SCALE_DASH);\nfloat lineWidthRatio \x3d (scaleDash * max(halfWidth - 0.55 * u_antialiasing, 0.25) + (1.0 - scaleDash)) / SDF_PATTERN_HALF_WIDTH;\n#endif\n#endif\n#if !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE) \x26\x26 defined(PATTERN)\nv_sampleAlphaOnly \x3d getBit(in_bitSet, BITSET_GENERIC_CONSIDER_ALPHA_ONLY);\n#endif\nout_pos \x3d vec3(pos.xy, z);\nreturn LineData(\ncolor,\nin_normal,\nhalfWidth,\nopacity,\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nin_tlbr / u_mosaicSize.xyxy,\nvec2(in_tlbr.z - in_tlbr.x, in_tlbr.w - in_tlbr.y),\n#endif\n#ifdef SDF\nlineWidthRatio,\n#endif\n#if defined(PATTERN) || defined(SDF)\nin_accumulatedDist * u_zoomFactor + dot(in_segmentDirection, dist),\n#endif\n#endif\nnorm(in_id)\n);\n}"}},
"symbologyTypeUtils.glsl":"#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_OUTLINE_FILL || SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_OUTLINE_FILL_SIMPLE\n#define SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#endif\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_SIMPLE || SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_OUTLINE_FILL_SIMPLE\n#define SYMBOLOGY_TYPE_IS_SIMPLE_LIKE\n#endif",text:{"common.glsl":"uniform highp vec2 u_mosaicSize;\nvarying highp vec3 v_id;\nvarying mediump vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec2 v_tex;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying lowp float v_transparency;",
"hittest.glsl":"#include \x3cmaterials/hittest/common.glsl\x3e","text.frag":"precision mediump float;\n#include \x3cmaterials/text/common.glsl\x3e\nuniform lowp sampler2D u_texture;\n#ifdef HITTEST\nvec4 getColor() {\nreturn v_color;\n}\n#else\nvec4 getColor()\n{\nfloat SDF_CUTOFF \x3d (2.0 / 8.0);\nfloat SDF_BASE_EDGE_DIST \x3d 1.0 - SDF_CUTOFF;\nlowp float dist \x3d texture2D(u_texture, v_tex).a;\nmediump float edge \x3d SDF_BASE_EDGE_DIST - v_edgeDistanceOffset;\n#ifdef HIGHLIGHT\nedge /\x3d 2.0;\n#endif\nlowp float aa \x3d v_antialiasingWidth;\nlowp float alpha \x3d smoothstep(edge - aa, edge + aa, dist);\nreturn alpha * v_color * v_opacity;\n}\n#endif\nvoid main()\n{\ngl_FragColor \x3d getColor();\n}",
"text.vert":"precision highp float;\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\n#include \x3cmaterials/text/hittest.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texFontSize;\nattribute vec4 a_aux;\nattribute vec2 a_zoomRange;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nfloat getTextSize(inout vec2 offset, inout float baseSize, in float referenceSize) {\n#ifdef VV_SIZE\nfloat r \x3d getSize(referenceSize) / referenceSize;\nbaseSize *\x3d r;\noffset.xy *\x3d r;\nreturn baseSize;\n#endif\nreturn baseSize;\n}\nvoid main()\n{\nINIT;\nfloat a_referenceSize \x3d a_aux.z * a_aux.z / 256.0;\nfloat a_bitSet        \x3d a_aux.w;\nfloat a_fontSize      \x3d a_texFontSize.z;\nvec2  a_offset        \x3d a_vertexOffset * OFFSET_PRECISION;\nvec3  in_pos        \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nfloat fontSize      \x3d getTextSize(a_offset, a_fontSize, a_referenceSize);\nfloat fontScale     \x3d fontSize / SDF_FONT_SIZE;\nvec3  offset        \x3d getRotation() * vec3(a_offset, 0.0);\nmat3  extrudeMatrix \x3d getBit(a_bitSet, 0) \x3d\x3d 1.0 ? u_displayViewMat3 : u_displayMat3;\nv_color   \x3d u_isHalo * a_haloColor + (1.0 - u_isHalo) * getColor(a_color, a_bitSet, 1);\nv_opacity \x3d getOpacity();\nv_id      \x3d norm(a_id);\nv_tex     \x3d a_texCoords / u_mosaicSize;\nv_pos     \x3d u_dvsMat3 * in_pos + extrudeMatrix * offset;\nv_edgeDistanceOffset \x3d u_isHalo * OUTLINE_SCALE * a_texFontSize.w / fontScale / MAX_SDF_DISTANCE;\nv_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n#ifdef HITTEST\nhighp vec3 out_pos  \x3d vec3(0.);\nv_color \x3d vec4(0.);\nhittestMarker(v_color, out_pos, u_viewMat3 * u_tileMat3 *  vec3(a_pos * POSITION_PRECISION, 1.0)\n+ u_tileMat3 * offset, fontSize / 2.);\ngl_PointSize \x3d 1.;\ngl_Position \x3d vec4(clip(v_color, out_pos, getFilterFlags(), a_zoomRange), 1.0);\n#else\ngl_Position \x3d  vec4(clip(v_color, v_pos, getFilterFlags(), a_zoomRange), 1.0);\n#endif\n}"},
"utils.glsl":"float rshift(in float u32, in int amount) {\nreturn floor(u32 / pow(2.0, float(amount)));\n}\nfloat getBit(in float bitset, in int bitIndex) {\nfloat offset \x3d pow(2.0, float(bitIndex));\nreturn mod(floor(bitset / offset), 2.0);\n}\nfloat getFilterBit(in float bitset, in int bitIndex) {\nreturn getBit(bitset, bitIndex + 1);\n}\nfloat getHighlightBit(in float bitset) {\nreturn getBit(bitset, 0);\n}\nhighp vec3 unpackDisplayIdTexel(in highp vec3 bitset) {\nfloat isAggregate \x3d getBit(bitset.b, 7);\nreturn (1.0 - isAggregate) * bitset + isAggregate * (vec3(bitset.rgb) - vec3(0.0, 0.0, float(0x80)));\n}\nvec4 unpack(in float u32) {\nfloat r \x3d mod(rshift(u32, 0), 255.0);\nfloat g \x3d mod(rshift(u32, 8), 255.0);\nfloat b \x3d mod(rshift(u32, 16), 255.0);\nfloat a \x3d mod(rshift(u32, 24), 255.0);\nreturn vec4(r, g, b, a);\n}\nvec3 norm(in vec3 v) {\nreturn v /\x3d 255.0;\n}\nvec4 norm(in vec4 v) {\nreturn v /\x3d 255.0;\n}\nfloat max4(vec4 target) {\nreturn max(max(max(target.x, target.y), target.z), target.w);\n}\nvec2 unpack_u8_nf32(vec2 bytes) {\nreturn (bytes - 127.0) / 127.0;\n}\nhighp float rand(in vec2 co) {\nhighp float a \x3d 12.9898;\nhighp float b \x3d 78.233;\nhighp float c \x3d 43758.5453;\nhighp float dt \x3d dot(co, vec2(a,b));\nhighp float sn \x3d mod(dt, 3.14);\nreturn fract(sin(sn) * c);\n}",
"vcommon.glsl":"#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/attributeData.glsl\x3e\n#include \x3cmaterials/vv.glsl\x3e\n#include \x3cmaterials/barycentric.glsl\x3e\nattribute vec2 a_pos;\nattribute highp vec3 a_id;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform highp mat3 u_tileMat3;\nuniform highp mat3 u_viewMat3;\nuniform highp float u_pixelRatio;\nuniform mediump float u_zoomFactor;\nuniform mediump float u_antialiasing;\nuniform mediump float u_currentZoom;\nvec4 VV_ADATA \x3d vec4(0.0);\nvoid loadVisualVariableData(inout vec4 target) {\n#ifdef SUPPORTS_TEXTURE_FLOAT\ntarget.rgba \x3d getAttributeData2(a_id);\n#else\nvec4 data0 \x3d getAttributeData2(a_id);\nvec4 data1 \x3d getAttributeData3(a_id);\ntarget.r \x3d u88VVToFloat(data0.rg * 255.0);\ntarget.g \x3d u88VVToFloat(data0.ba * 255.0);\ntarget.b \x3d u88VVToFloat(data1.rg * 255.0);\ntarget.a \x3d u88VVToFloat(data1.ba * 255.0);\n#endif\n}\n#ifdef VV\n#define INIT loadVisualVariableData(VV_ADATA)\n#else\n#define INIT\n#endif\nvec4 getColor(in vec4 a_color, in float a_bitSet, int index) {\n#ifdef VV_COLOR\nfloat isColorLocked   \x3d getBit(a_bitSet, index);\nreturn getVVColor(VV_ADATA[ATTR_VV_COLOR], a_color, isColorLocked);\n#else\nreturn a_color;\n#endif\n}\nfloat getOpacity() {\n#ifdef VV_OPACITY\nreturn getVVOpacity(VV_ADATA[ATTR_VV_OPACITY]);\n#else\nreturn 1.0;\n#endif\n}\nfloat getSize(in float in_size) {\n#ifdef VV_SIZE\nreturn getVVSize(in_size, VV_ADATA[ATTR_VV_SIZE]);\n#else\nreturn in_size;\n#endif\n}\nmat3 getRotation() {\n#ifdef VV_ROTATION\nreturn getVVRotationMat3(mod(VV_ADATA[ATTR_VV_ROTATION], 360.0));\n#else\nreturn mat3(1.0);\n#endif\n}\nfloat getFilterFlags() {\n#ifdef IGNORES_SAMPLER_PRECISION\nreturn ceil(getAttributeData0(a_id).x * 255.0);\n#else\nreturn getAttributeData0(a_id).x * 255.0;\n#endif\n}\nvec4 getAnimationState() {\nreturn getAttributeData1(a_id);\n}\nfloat getMinZoom() {\nvec4 data0 \x3d getAttributeData0(a_id) * 255.0;\nreturn data0.g;\n}\nmat3 getMatrixNoDisplay(float isMapAligned) {\nreturn isMapAligned * u_viewMat3 * u_tileMat3 + (1.0 - isMapAligned) * u_tileMat3;\n}\nmat3 getMatrix(float isMapAligned) {\nreturn isMapAligned * u_displayViewMat3 + (1.0 - isMapAligned) * u_displayMat3;\n}\nvec3 clip(inout vec4 color, inout vec3 pos, in float filterFlags, in vec2 minMaxZoom) {\npos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifdef INSIDE\npos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 1));\n#elif defined(OUTSIDE)\npos.z +\x3d 2.0 * getFilterBit(filterFlags, 1);\n#elif defined(HIGHLIGHT)\n#if !defined(HIGHLIGHT_ALL)\npos.z +\x3d 2.0 * (1.0 - getHighlightBit(filterFlags));\n#endif\n#endif\npos.z +\x3d 2.0 * (step(minMaxZoom.y, u_currentZoom) + (1.0 - step(minMaxZoom.x, u_currentZoom)));\nreturn pos;\n}",
"vv.glsl":"#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n#define VV_SIZE\n#endif\n#if defined(VV_COLOR) || defined(VV_SIZE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n#define VV\n#endif\n#ifdef VV_COLOR\nuniform highp float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform highp vec4 u_vvSizeMinMaxValue;\n#endif\n#ifdef VV_SIZE_SCALE_STOPS\nuniform highp float u_vvSizeScaleStopsValue;\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nuniform highp float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nuniform highp float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif\n#ifdef VV_OPACITY\nuniform highp float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif\nbool isNan(float val) {\nreturn (val \x3d\x3d NAN_MAGIC_NUMBER);\n}\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nfloat interpolationRatio \x3d (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\ninterpolationRatio \x3d clamp(interpolationRatio, 0.0, 1.0);\nreturn u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n}\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N \x3d 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nif (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\nreturn u_vvSizeFieldStopsSizes[0];\n}\nfor (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\nif (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\nfloat f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\nreturn mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n}\n}\nreturn u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nreturn u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N \x3d 8;\nfloat getVVOpacity(float opacityValue) {\nif (isNan(opacityValue)) {\nreturn 1.0;\n}\nif (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\nreturn u_vvOpacities[0];\n}\nfor (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\nif (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\nfloat f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\nreturn mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n}\n}\nreturn u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\nif (isNan(rotationValue)) {\nreturn mat4(1, 0, 0, 0,\n0, 1, 0, 0,\n0, 0, 1, 0,\n0, 0, 0, 1);\n}\nfloat rotation \x3d rotationValue;\nif (u_vvRotationType \x3d\x3d 1.0) {\nrotation \x3d 90.0 - rotation;\n}\nfloat angle \x3d C_DEG_TO_RAD * rotation;\nfloat sinA \x3d sin(angle);\nfloat cosA \x3d cos(angle);\nreturn mat4(cosA, sinA, 0, 0,\n-sinA,  cosA, 0, 0,\n0,     0, 1, 0,\n0,     0, 0, 1);\n}\nmat3 getVVRotationMat3(float rotationValue) {\nif (isNan(rotationValue)) {\nreturn mat3(1, 0, 0,\n0, 1, 0,\n0, 0, 1);\n}\nfloat rotation \x3d rotationValue;\nif (u_vvRotationType \x3d\x3d 1.0) {\nrotation \x3d 90.0 - rotation;\n}\nfloat angle \x3d C_DEG_TO_RAD * -rotation;\nfloat sinA \x3d sin(angle);\nfloat cosA \x3d cos(angle);\nreturn mat3(cosA, -sinA, 0,\nsinA, cosA, 0,\n0,    0,    1);\n}\n#endif\n#ifdef VV_COLOR\nconst int VV_COLOR_N \x3d 8;\nvec4 getVVColor(float colorValue, vec4 fallback, float isColorLocked) {\nif (isNan(colorValue) || isColorLocked \x3d\x3d 1.0) {\nreturn fallback;\n}\nif (colorValue \x3c\x3d u_vvColorValues[0]) {\nreturn u_vvColors[0];\n}\nfor (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\nif (u_vvColorValues[i] \x3e\x3d colorValue) {\nfloat f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\nreturn mix(u_vvColors[i-1], u_vvColors[i], f);\n}\n}\nreturn u_vvColors[VV_COLOR_N - 1];\n}\n#endif\nfloat getVVSize(in float size, in float vvSize)  {\n#ifdef VV_SIZE_MIN_MAX_VALUE\nreturn getVVMinMaxSize(vvSize, size);\n#elif defined(VV_SIZE_SCALE_STOPS)\nreturn u_vvSizeScaleStopsValue;\n#elif defined(VV_SIZE_FIELD_STOPS)\nfloat outSize \x3d getVVStopsSize(vvSize, size);\nreturn isNan(outSize) ? size : outSize;\n#elif defined(VV_SIZE_UNIT_VALUE)\nreturn getVVUnitValue(vvSize, size);\n#else\nreturn size;\n#endif\n}"},
overlay:{overlay:{"overlay.frag":"precision lowp float;\nuniform lowp sampler2D u_texture;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\nvec4 color \x3d texture2D(u_texture, v_uv);\ngl_FragColor \x3d color *  u_opacity;\n}","overlay.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_uv;\nuniform highp mat3 u_dvsMat3;\nvarying mediump vec2 v_uv;\nvoid main(void) {\nv_uv \x3d a_uv;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0);\ngl_Position \x3d vec4(pos.xy, 0.0, 1.0);\n}"}},
"post-processing":{blit:{"blit.frag":"precision mediump float;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\ngl_FragColor \x3d texture2D(u_texture, v_uv);\n}"},bloom:{composite:{"composite.frag":"precision mediump float;\nvarying vec2 v_uv;\nuniform sampler2D u_blurTexture1;\nuniform sampler2D u_blurTexture2;\nuniform sampler2D u_blurTexture3;\nuniform sampler2D u_blurTexture4;\nuniform sampler2D u_blurTexture5;\nuniform float u_bloomStrength;\nuniform float u_bloomRadius;\nuniform float u_bloomFactors[NUMMIPS];\nuniform vec3 u_bloomTintColors[NUMMIPS];\nfloat lerpBloomFactor(const in float factor) {\nfloat mirrorFactor \x3d 1.2 - factor;\nreturn mix(factor, mirrorFactor, u_bloomRadius);\n}\nvoid main() {\ngl_FragColor \x3d u_bloomStrength * (\nlerpBloomFactor(u_bloomFactors[0]) * vec4(u_bloomTintColors[0], 1.0) * texture2D(u_blurTexture1, v_uv) +\nlerpBloomFactor(u_bloomFactors[1]) * vec4(u_bloomTintColors[1], 1.0) * texture2D(u_blurTexture2, v_uv) +\nlerpBloomFactor(u_bloomFactors[2]) * vec4(u_bloomTintColors[2], 1.0) * texture2D(u_blurTexture3, v_uv) +\nlerpBloomFactor(u_bloomFactors[3]) * vec4(u_bloomTintColors[3], 1.0) * texture2D(u_blurTexture4, v_uv) +\nlerpBloomFactor(u_bloomFactors[4]) * vec4(u_bloomTintColors[4], 1.0) * texture2D(u_blurTexture5, v_uv)\n);\n}"},
gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\n#define SIGMA RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\nreturn 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\nvec2 invSize \x3d 1.0 / u_texSize;\nfloat fSigma \x3d float(SIGMA);\nfloat weightSum \x3d gaussianPdf(0.0, fSigma);\nvec4 pixelColorSum \x3d texture2D(u_colorTexture, v_uv) * weightSum;\nfor (int i \x3d 1; i \x3c KERNEL_RADIUS; i ++) {\nfloat x \x3d float(i);\nfloat w \x3d gaussianPdf(x, fSigma);\nvec2 uvOffset \x3d u_direction * invSize * x;\nvec4 sample1 \x3d texture2D(u_colorTexture, v_uv + uvOffset);\nvec4 sample2 \x3d texture2D(u_colorTexture, v_uv - uvOffset);\npixelColorSum +\x3d (sample1 + sample2) * w;\nweightSum +\x3d 2.0 * w;\n}\ngl_FragColor \x3d pixelColorSum /weightSum;\n}"},
luminosityHighPass:{"luminosityHighPass.frag":"precision mediump float;\nuniform sampler2D u_texture;\nuniform vec3 u_defaultColor;\nuniform float u_defaultOpacity;\nuniform float u_luminosityThreshold;\nuniform float u_smoothWidth;\nvarying vec2 v_uv;\nvoid main() {\nvec4 texel \x3d texture2D(u_texture, v_uv);\nvec3 luma \x3d vec3(0.299, 0.587, 0.114);\nfloat v \x3d dot(texel.xyz, luma);\nvec4 outputColor \x3d vec4(u_defaultColor.rgb, u_defaultOpacity);\nfloat alpha \x3d smoothstep(u_luminosityThreshold, u_luminosityThreshold + u_smoothWidth, v);\ngl_FragColor \x3d mix(outputColor, texel, alpha);\n}"}},
blur:{gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nuniform float u_sigma;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\nreturn 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\nvec2 invSize \x3d 1.0 / u_texSize;\nfloat fSigma \x3d u_sigma;\nfloat weightSum \x3d gaussianPdf(0.0, fSigma);\nvec4 pixelColorSum \x3d texture2D(u_colorTexture, v_uv) * weightSum;\nfor (int i \x3d 1; i \x3c KERNEL_RADIUS; i ++) {\nfloat x \x3d float(i);\nfloat w \x3d gaussianPdf(x, fSigma);\nvec2 uvOffset \x3d u_direction * invSize * x;\nvec4 sample1 \x3d texture2D(u_colorTexture, v_uv + uvOffset);\nvec4 sample2 \x3d texture2D(u_colorTexture, v_uv - uvOffset);\npixelColorSum +\x3d (sample1 + sample2) * w;\nweightSum +\x3d 2.0 * w;\n}\ngl_FragColor \x3d pixelColorSum /weightSum;\n}"},
"radial-blur":{"radial-blur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nconst float sampleDist \x3d 1.0;\nconst float sampleStrength \x3d 2.2;\nvoid main(void) {\nfloat samples[10];\nsamples[0] \x3d -0.08;\nsamples[1] \x3d -0.05;\nsamples[2] \x3d -0.03;\nsamples[3] \x3d -0.02;\nsamples[4] \x3d -0.01;\nsamples[5] \x3d  0.01;\nsamples[6] \x3d  0.02;\nsamples[7] \x3d  0.03;\nsamples[8] \x3d  0.05;\nsamples[9] \x3d  0.08;\nvec2 dir \x3d 0.5 - v_uv;\nfloat dist \x3d sqrt(dir.x * dir.x + dir.y * dir.y);\ndir \x3d dir / dist;\nvec4 color \x3d texture2D(u_colorTexture,v_uv);\nvec4 sum \x3d color;\nfor (int i \x3d 0; i \x3c 10; i++) {\nsum +\x3d texture2D(u_colorTexture, v_uv + dir * samples[i] * sampleDist);\n}\nsum *\x3d 1.0 / 11.0;\nfloat t \x3d dist * sampleStrength;\nt \x3d clamp(t, 0.0, 1.0);\ngl_FragColor \x3d mix(color, sum, t);\n}"}},
dra:{"dra.frag":"precision mediump float;\nuniform sampler2D u_minColor;\nuniform sampler2D u_maxColor;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\nvec4 minColor \x3d texture2D(u_minColor, vec2(0.5));\nvec4 maxColor \x3d texture2D(u_maxColor, vec2(0.5));\nvec4 color \x3d texture2D(u_texture, v_uv);\nvec3 minColorUnpremultiply \x3d minColor.rgb / minColor.a;\nvec3 maxColorUnpremultiply \x3d maxColor.rgb / maxColor.a;\nvec3 colorUnpremultiply \x3d color.rgb / color.a;\nvec3 range \x3d maxColorUnpremultiply - minColorUnpremultiply;\ngl_FragColor \x3d vec4(color.a * (colorUnpremultiply - minColorUnpremultiply) / range, color.a);\n}",
"min-max":{"min-max.frag":"#extension GL_EXT_draw_buffers : require\nprecision mediump float;\n#define CELL_SIZE 2\nuniform sampler2D u_minTexture;\nuniform sampler2D u_maxTexture;\nuniform vec2 u_srcResolution;\nuniform vec2 u_dstResolution;\nvarying vec2 v_uv;\nvoid main() {\nvec2 srcPixel \x3d floor(gl_FragCoord.xy) * float(CELL_SIZE);\nvec2 onePixel \x3d vec2(1.0) / u_srcResolution;\nvec2 uv \x3d (srcPixel + 0.5) / u_srcResolution;\nvec4 minColor \x3d vec4(1.0);\nvec4 maxColor \x3d vec4(0.0);\nfor (int y \x3d 0; y \x3c CELL_SIZE; ++y) {\nfor (int x \x3d 0; x \x3c CELL_SIZE; ++x) {\nvec2 offset \x3d uv + vec2(x, y) * onePixel;\nminColor \x3d min(minColor, texture2D(u_minTexture, offset));\nmaxColor \x3d max(maxColor, texture2D(u_maxTexture, offset));\n}\n}\ngl_FragData[0] \x3d minColor;\ngl_FragData[1] \x3d maxColor;\n}"}},
"drop-shadow":{composite:{"composite.frag":"precision mediump float;\nuniform sampler2D u_layerFBOTexture;\nuniform sampler2D u_blurTexture;\nuniform vec4 u_shadowColor;\nuniform vec2 u_shadowOffset;\nuniform highp mat3 u_displayViewMat3;\nvarying vec2 v_uv;\nvoid main() {\nvec3 offset \x3d u_displayViewMat3 * vec3(u_shadowOffset, 0.0);\nvec4 layerColor \x3d texture2D(u_layerFBOTexture, v_uv);\nvec4 blurColor \x3d texture2D(u_blurTexture, v_uv - offset.xy / 2.0);\ngl_FragColor \x3d ((1.0 - layerColor.a) * blurColor.a * u_shadowColor + layerColor);\n}"}},
"edge-detect":{"frei-chen":{"frei-chen.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nvarying vec2 v_uv;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[9];\nconst mat3 g0 \x3d mat3( 0.3535533845424652, 0, -0.3535533845424652, 0.5, 0, -0.5, 0.3535533845424652, 0, -0.3535533845424652 );\nconst mat3 g1 \x3d mat3( 0.3535533845424652, 0.5, 0.3535533845424652, 0, 0, 0, -0.3535533845424652, -0.5, -0.3535533845424652 );\nconst mat3 g2 \x3d mat3( 0, 0.3535533845424652, -0.5, -0.3535533845424652, 0, 0.3535533845424652, 0.5, -0.3535533845424652, 0 );\nconst mat3 g3 \x3d mat3( 0.5, -0.3535533845424652, 0, -0.3535533845424652, 0, 0.3535533845424652, 0, 0.3535533845424652, -0.5 );\nconst mat3 g4 \x3d mat3( 0, -0.5, 0, 0.5, 0, 0.5, 0, -0.5, 0 );\nconst mat3 g5 \x3d mat3( -0.5, 0, 0.5, 0, 0, 0, 0.5, 0, -0.5 );\nconst mat3 g6 \x3d mat3( 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.6666666865348816, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204 );\nconst mat3 g7 \x3d mat3( -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, 0.6666666865348816, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408 );\nconst mat3 g8 \x3d mat3( 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408 );\nvoid main() {\nG[0] \x3d g0,\nG[1] \x3d g1,\nG[2] \x3d g2,\nG[3] \x3d g3,\nG[4] \x3d g4,\nG[5] \x3d g5,\nG[6] \x3d g6,\nG[7] \x3d g7,\nG[8] \x3d g8;\nmat3 I;\nfloat cnv[9];\nvec3 sample;\nfor (float i \x3d 0.0; i \x3c 3.0; i++) {\nfor (float j \x3d 0.0; j \x3c 3.0; j++) {\nsample \x3d texture2D(u_colorTexture, v_uv + texel * vec2(i - 1.0,j - 1.0)).rgb;\nI[int(i)][int(j)] \x3d length(sample);\n}\n}\nfor (int i \x3d 0; i \x3c 9; i++) {\nfloat dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] \x3d dp3 * dp3;\n}\nfloat M \x3d (cnv[0] + cnv[1]) + (cnv[2] + cnv[3]);\nfloat S \x3d (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]) + (cnv[8] + M);\ngl_FragColor \x3d vec4(vec3(sqrt(M / S)), texture2D(u_colorTexture, v_uv).a);\n}"},
sobel:{"sobel.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 \x3d mat3( 1.0, 2.0, 1.0, 0.0, 0.0, 0.0, -1.0, -2.0, -1.0 );\nconst mat3 g1 \x3d mat3( 1.0, 0.0, -1.0, 2.0, 0.0, -2.0, 1.0, 0.0, -1.0 );\nvoid main() {\nmat3 I;\nfloat cnv[2];\nvec3 sample;\nG[0] \x3d g0;\nG[1] \x3d g1;\nfor (float i \x3d 0.0; i \x3c 3.0; i++) {\nfor (float j \x3d 0.0; j \x3c 3.0; j++) {\nsample \x3d texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\nI[int(i)][int(j)] \x3d length(sample);\n}\n}\nfor (int i \x3d 0; i \x3c 2; i++) {\nfloat dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] \x3d dp3 * dp3;\n}\ngl_FragColor \x3d vec4(vec3(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1])), texture2D(u_colorTexture, v_uv).a);\n}"}},
"edge-enhance":{"edge-enhance.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 \x3d mat3( 1.0, 0.0, -1.0, 1.0, 0.0, -1.0, 1.0, 0.0, -1.0 );\nconst mat3 g1 \x3d mat3( 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, -1.0, -1.0, -1.0 );\nvoid main() {\nmat3 I;\nfloat cnv[2];\nvec3 sample;\nG[0] \x3d g0;\nG[1] \x3d g1;\nfor (float i \x3d 0.0; i \x3c 3.0; i++) {\nfor (float j \x3d 0.0; j \x3c 3.0; j++) {\nsample \x3d texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\nI[int(i)][int(j)] \x3d length(sample);\n}\n}\nfor (int i \x3d 0; i \x3c 2; i++) {\nfloat dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] \x3d dp3 * dp3;\n}\nvec4 color \x3d texture2D(u_colorTexture, v_uv);\ngl_FragColor \x3d vec4(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1]) * color);\n}"},
filterEffect:{"filterEffect.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform mat4 u_coefficients;\nvarying vec2 v_uv;\nvoid main() {\nvec4 color \x3d texture2D(u_colorTexture, v_uv);\nvec4 rgbw \x3d u_coefficients * vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\nfloat a \x3d color.a;\ngl_FragColor \x3d vec4(a * rgbw.rgb, a);\n}"},pp:{"pp.vert":"precision mediump float;\nattribute vec2 a_position;\nvarying vec2 v_uv;\nvoid main() {\ngl_Position \x3d vec4(a_position, 0.0, 1.0);\nv_uv \x3d (a_position + 1.0) / 2.0;\n}"}},
raster:{bitmap:{"bitmap.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform highp vec2 u_coordScale;\nuniform lowp float u_opacity;\n#include \x3cfiltering/bicubic.glsl\x3e\nvoid main() {\n#ifdef BICUBIC\nvec4 color \x3d sampleBicubicBSpline(u_texture, v_texcoord, u_coordScale);\n#else\nvec4 color \x3d texture2D(u_texture, v_texcoord);\n#endif\nfloat alpha \x3d u_opacity * color.a;\ngl_FragColor \x3d vec4(alpha * color.rgb, alpha);\n}","bitmap.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
common:{"common.glsl":"uniform sampler2D u_image;\nuniform int u_bandCount;\nuniform bool u_flipY;\nuniform float u_opacity;\nuniform int u_resampling;\nuniform vec2 u_srcImageSize;\n#ifdef APPLY_PROJECTION\n#include \x3craster/common/projection.glsl\x3e\n#endif\n#ifdef BICUBIC\n#include \x3cfiltering/bicubic.glsl\x3e\n#endif\n#ifdef BILINEAR\n#include \x3cfiltering/bilinear.glsl\x3e\n#endif\nvec2 getPixelLocation(vec2 coords) {\nvec2 targetLocation \x3d u_flipY ? vec2(coords.s, 1.0 - coords.t) : coords;\n#ifdef APPLY_PROJECTION\ntargetLocation \x3d projectPixelLocation(targetLocation);\n#endif\nreturn targetLocation;\n}\nbool isOutside(vec2 coords){\nif (coords.t\x3e1.00001 ||coords.t\x3c-0.00001 || coords.s\x3e1.00001 ||coords.s\x3c-0.00001) {\nreturn true;\n} else {\nreturn false;\n}\n}\nvec4 getPixel(vec2 pixelLocation) {\n#ifdef BICUBIC\nvec4 color \x3d sampleBicubicBSpline(u_image, pixelLocation, u_srcImageSize);\n#elif defined(BILINEAR)\nvec4 color \x3d sampleBilinear(u_image, pixelLocation, u_srcImageSize);\n#else\nvec4 color \x3d texture2D(u_image, pixelLocation);\n#endif\nreturn color;\n}",
"contrastBrightness.glsl":"uniform float u_contrastOffset;\nuniform float u_brightnessOffset;\nvec4 adjustContrastBrightness(vec4 currentPixel, bool isFloat) {\nvec4 pixelValue \x3d isFloat ? currentPixel * 255.0 : currentPixel;\nfloat maxI \x3d 255.0;\nfloat mid \x3d 128.0;\nfloat c \x3d u_contrastOffset;\nfloat b \x3d u_brightnessOffset;\nvec4 v;\nif (c \x3e 0.0 \x26\x26 c \x3c 100.0) {\nv \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) / (2.0 * (100.0 - c)) + mid;\n} else if (c \x3c\x3d 0.0 \x26\x26 c \x3e -100.0) {\nv \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) * (100.0 + c) / 20000.0 + mid;\n} else if (c \x3d\x3d 100.0) {\nv \x3d (200.0 * pixelValue - 100.0 * maxI + (maxI + 1.0) * (100.0 - c) + 2.0 * maxI * b);\nv \x3d (sign(v) + 1.0) / 2.0;\n} else if (c \x3d\x3d -100.0) {\nv \x3d vec4(mid, mid, mid, currentPixel.a);\n}\nreturn vec4(v.r / 255.0, v.g / 255.0, v.b / 255.0, currentPixel.a);\n}",
"projection.glsl":"uniform sampler2D u_transformGrid;\nuniform vec2 u_transformSpacing;\nuniform vec2 u_transformGridSize;\nuniform vec2 u_targetImageSize;\nvec2 projectPixelLocation(vec2 coords) {\n#ifdef LOOKUP_PROJECTION\nvec4 pv \x3d texture2D(u_transformGrid, coords);\nreturn vec2(pv.r, pv.g);\n#endif\nvec2 index_image \x3d floor(coords * u_targetImageSize);\nvec2 oneTransformPixel \x3d vec2(0.25 / u_transformGridSize.s, 1.0 / u_transformGridSize.t);\nvec2 index_transform \x3d floor(index_image / u_transformSpacing) / u_transformGridSize;\nvec2 pos \x3d fract((index_image + vec2(0.5, 0.5)) / u_transformSpacing);\nvec2 srcLocation;\nvec2 transform_location \x3d index_transform + oneTransformPixel * 0.5;\nif (pos.s \x3c\x3d pos.t) {\nvec4 ll_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s, transform_location.t));\nvec4 ll_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + oneTransformPixel.s, transform_location.t));\nsrcLocation.s \x3d dot(ll_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t \x3d dot(ll_def.rgb, vec3(pos, 1.0));\n} else {\nvec4 ur_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s + 2.0 * oneTransformPixel.s, transform_location.t));\nvec4 ur_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + 3.0 * oneTransformPixel.s, transform_location.t));\nsrcLocation.s \x3d dot(ur_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t \x3d dot(ur_def.rgb, vec3(pos, 1.0));\n}\nreturn srcLocation;\n}"},
flow:{"getFadeOpacity.glsl":"uniform float u_decayRate;\nuniform float u_fadeToZero;\nfloat getFadeOpacity(float x) {\nfloat cutOff \x3d mix(0.0, exp(-u_decayRate), u_fadeToZero);\nreturn (exp(-u_decayRate * x) - cutOff) / (1.0 - cutOff);\n}","getFragmentColor.glsl":"vec4 getFragmentColor(vec4 color, float dist, float size, float featheringSize) {\nfloat featheringStart \x3d clamp(0.5 - featheringSize / size, 0.0, 0.5);\nif (dist \x3e featheringStart) {\ncolor *\x3d 1.0 - (dist - featheringStart) / (0.5 - featheringStart);\n}\nreturn color;\n}",
imagery:{"imagery.frag":"precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform float u_Min;\nuniform float u_Max;\nuniform float u_featheringSize;\n#include \x3craster/flow/vv.glsl\x3e\nfloat getIntensity(float v) {\nreturn u_Min + v * (u_Max - u_Min);\n}\nvoid main(void) {\nvec4 sampled \x3d texture2D(u_texture, v_texcoord);\nfloat intensity \x3d getIntensity(sampled.r);\ngl_FragColor \x3d getColor(intensity);\ngl_FragColor.a *\x3d getOpacity(sampled.r);\ngl_FragColor.a *\x3d sampled.a;\ngl_FragColor.rgb *\x3d gl_FragColor.a;\n}",
"imagery.vert":"attribute vec2 a_position;\nattribute vec2 a_texcoord;\nuniform mat3 u_dvsMat3;\nvarying vec2 v_texcoord;\nvoid main(void) {\nvec2 xy \x3d (u_dvsMat3 * vec3(a_position, 1.0)).xy;\ngl_Position \x3d vec4(xy, 0.0, 1.0);\nv_texcoord \x3d a_texcoord;\n}"},particles:{"particles.frag":"precision highp float;\nvarying vec4 v_color;\nvarying vec2 v_texcoord;\nvarying float v_size;\nuniform float u_featheringSize;\n#include \x3craster/flow/getFragmentColor.glsl\x3e\nvoid main(void) {\ngl_FragColor \x3d getFragmentColor(v_color, length(v_texcoord - 0.5), v_size, u_featheringSize);\n}",
"particles.vert":"attribute vec4 a_xyts0;\nattribute vec4 a_xyts1;\nattribute vec4 a_typeIdDurationSeed;\nattribute vec4 a_extrudeInfo;\nuniform mat3 u_dvsMat3;\nuniform mat3 u_displayViewMat3;\nuniform float u_time;\nuniform float u_trailLength;\nuniform float u_flowSpeed;\nvarying vec4 v_color;\nvarying vec2 v_texcoord;\nvarying float v_size;\nuniform float u_featheringSize;\nuniform float u_introFade;\n#include \x3craster/flow/vv.glsl\x3e\n#include \x3craster/flow/getFadeOpacity.glsl\x3e\nvoid main(void) {\nvec2 position0 \x3d a_xyts0.xy;\nfloat t0 \x3d a_xyts0.z;\nfloat speed0 \x3d a_xyts0.w;\nvec2 position1 \x3d a_xyts1.xy;\nfloat t1 \x3d a_xyts1.z;\nfloat speed1 \x3d a_xyts1.w;\nfloat type \x3d a_typeIdDurationSeed.x;\nfloat id \x3d a_typeIdDurationSeed.y;\nfloat duration \x3d a_typeIdDurationSeed.z;\nfloat seed \x3d a_typeIdDurationSeed.w;\nvec2 e0 \x3d a_extrudeInfo.xy;\nvec2 e1 \x3d a_extrudeInfo.zw;\nfloat animationPeriod \x3d duration + u_trailLength;\nfloat scaledTime \x3d u_time * u_flowSpeed;\nfloat randomizedTime \x3d scaledTime + seed * animationPeriod;\nfloat t \x3d mod(randomizedTime, animationPeriod);\nfloat fUnclamped \x3d (t - t0) / (t1 - t0);\nfloat f \x3d clamp(fUnclamped, 0.0, 1.0);\nfloat clampedTime \x3d mix(t0, t1, f);\nfloat speed \x3d mix(speed0, speed1, f);\nvec2 extrude;\nvec2 position;\nfloat fadeOpacity;\nfloat introOpacity;\nif (type \x3d\x3d 2.0) {\nif (fUnclamped \x3c 0.0 || (fUnclamped \x3e 1.0 \x26\x26 t1 !\x3d duration)) {\ngl_Position \x3d vec4(0.0, 0.0, -2.0, 1.0);\nreturn;\n}\nvec2 ortho \x3d mix(e0, e1, f);\nvec2 parallel;\nparallel \x3d normalize(position1 - position0) * 0.5;\nif (id \x3d\x3d 1.0) {\nextrude \x3d ortho;\nv_texcoord \x3d vec2(0.5, 0.0);\n} else if (id \x3d\x3d 2.0) {\nextrude \x3d -ortho;\nv_texcoord \x3d vec2(0.5, 1.0);\n} else if (id \x3d\x3d 3.0) {\nextrude \x3d ortho + parallel;\nv_texcoord \x3d vec2(1.0, 0.0);\n} else if (id \x3d\x3d 4.0) {\nextrude \x3d -ortho + parallel;\nv_texcoord \x3d vec2(1.0, 1.0);\n}\nfadeOpacity \x3d getFadeOpacity((t - clampedTime) / u_trailLength);\nintroOpacity \x3d 1.0 - exp(-clampedTime);\nv_size \x3d getSize(speed);\nv_color \x3d getColor(speed);\nv_color.a *\x3d getOpacity(speed);\nposition \x3d mix(position0, position1, f);\n} else {\nif (fUnclamped \x3c 0.0) {\ngl_Position \x3d vec4(0.0, 0.0, -2.0, 1.0);\nreturn;\n}\nif (id \x3d\x3d 1.0) {\nextrude \x3d e0;\nv_texcoord \x3d vec2(0.5, 0.0);\nfadeOpacity \x3d getFadeOpacity((t - t0) / u_trailLength);\nintroOpacity \x3d 1.0 - exp(-t0);\nv_size \x3d getSize(speed0);\nv_color \x3d getColor(speed0);\nv_color.a *\x3d getOpacity(speed0);\nposition \x3d position0;\n} else if (id \x3d\x3d 2.0) {\nextrude \x3d -e0;\nv_texcoord \x3d vec2(0.5, 1.0);\nfadeOpacity \x3d getFadeOpacity((t - t0) / u_trailLength);\nintroOpacity \x3d 1.0 - exp(-t0);\nv_size \x3d getSize(speed0);\nv_color \x3d getColor(speed0);\nv_color.a *\x3d getOpacity(speed0);\nposition \x3d position0;\n} else if (id \x3d\x3d 3.0) {\nextrude \x3d mix(e0, e1, f);\nv_texcoord \x3d vec2(0.5, 0.0);\nfadeOpacity \x3d getFadeOpacity((t - clampedTime) / u_trailLength);\nintroOpacity \x3d 1.0 - exp(-clampedTime);\nv_size \x3d getSize(speed);\nv_color \x3d getColor(speed);\nv_color.a *\x3d getOpacity(speed);\nposition \x3d mix(position0, position1, f);\n} else if (id \x3d\x3d 4.0) {\nextrude \x3d -mix(e0, e1, f);\nv_texcoord \x3d vec2(0.5, 1.0);\nfadeOpacity \x3d getFadeOpacity((t - clampedTime) / u_trailLength);\nintroOpacity \x3d 1.0 - exp(-clampedTime);\nv_size \x3d getSize(speed);\nv_color \x3d getColor(speed);\nv_color.a *\x3d getOpacity(speed);\nposition \x3d mix(position0, position1, f);\n}\n}\nvec2 xy \x3d (u_dvsMat3 * vec3(position, 1.0) + u_displayViewMat3 * vec3(extrude * v_size, 0.0)).xy;\ngl_Position \x3d vec4(xy, 0.0, 1.0);\nv_color.a *\x3d fadeOpacity;\nv_color.a *\x3d mix(1.0, introOpacity, u_introFade);\nv_color.rgb *\x3d v_color.a;\n}"},
streamlines:{"streamlines.frag":"precision highp float;\nvarying float v_side;\nvarying float v_time;\nvarying float v_totalTime;\nvarying float v_timeSeed;\nvarying vec4 v_color;\nvarying float v_size;\nuniform float u_time;\nuniform float u_trailLength;\nuniform float u_flowSpeed;\nuniform float u_featheringSize;\nuniform float u_introFade;\n#include \x3craster/flow/getFragmentColor.glsl\x3e\n#include \x3craster/flow/getFadeOpacity.glsl\x3e\nvoid main(void) {\nfloat t \x3d mod(v_timeSeed * (v_totalTime + u_trailLength) + u_time * u_flowSpeed, v_totalTime + u_trailLength) - v_time;\nvec4 color \x3d v_color * step(0.0, t) * getFadeOpacity(t / u_trailLength);\ncolor *\x3d mix(1.0, 1.0 - exp(-v_time), u_introFade);\ngl_FragColor \x3d getFragmentColor(color, length((v_side + 1.0) / 2.0 - 0.5), v_size, u_featheringSize);\n}",
"streamlines.vert":"attribute vec3 a_positionAndSide;\nattribute vec3 a_timeInfo;\nattribute vec2 a_extrude;\nattribute float a_speed;\nuniform mat3 u_dvsMat3;\nuniform mat3 u_displayViewMat3;\nvarying float v_time;\nvarying float v_totalTime;\nvarying float v_timeSeed;\nvarying vec4 v_color;\nvarying float v_side;\nvarying float v_size;\nuniform float u_featheringSize;\n#include \x3craster/flow/vv.glsl\x3e\nvoid main(void) {\nvec4 lineColor \x3d getColor(a_speed);\nfloat lineOpacity \x3d getOpacity(a_speed);\nfloat lineSize \x3d getSize(a_speed);\nvec2 position \x3d a_positionAndSide.xy;\nv_side \x3d a_positionAndSide.z;\nvec2 xy \x3d (u_dvsMat3 * vec3(position, 1.0) + u_displayViewMat3 * vec3(a_extrude * lineSize, 0.0)).xy;\ngl_Position \x3d vec4(xy, 0.0, 1.0);\nv_time \x3d a_timeInfo.x;\nv_totalTime \x3d a_timeInfo.y;\nv_timeSeed \x3d a_timeInfo.z;\nv_color \x3d lineColor;\nv_color.a *\x3d lineOpacity;\nv_color.rgb *\x3d v_color.a;\nv_size \x3d lineSize;\n}"},
"vv.glsl":"#define MAX_STOPS 8\n#ifdef VV_COLOR\nuniform float u_color_stops[MAX_STOPS];\nuniform vec4 u_color_values[MAX_STOPS];\nuniform int u_color_count;\n#else\nuniform vec4 u_color;\n#endif\n#ifdef VV_OPACITY\nuniform float u_opacity_stops[MAX_STOPS];\nuniform float u_opacity_values[MAX_STOPS];\nuniform int u_opacity_count;\n#else\nuniform float u_opacity;\n#endif\n#ifdef VV_SIZE\nuniform float u_size_stops[MAX_STOPS];\nuniform float u_size_values[MAX_STOPS];\nuniform int u_size_count;\n#else\nuniform float u_size;\n#endif\nuniform float u_featheringOffset;\nvec4 getColor(float x) {\n#ifdef VV_COLOR\nvec4 color \x3d u_color_values[0];\n{\nfor (int i \x3d 1; i \x3c MAX_STOPS; i++) {\nif (i \x3e\x3d u_color_count) {\nbreak;\n}\nfloat x1 \x3d u_color_stops[i - 1];\nif (x \x3c x1) {\nbreak;\n}\nfloat x2 \x3d u_color_stops[i];\nvec4 y2 \x3d u_color_values[i];\nif (x \x3c x2) {\nvec4 y1 \x3d u_color_values[i - 1];\ncolor \x3d y1 + (y2 - y1) * (x - x1) / (x2 - x1);\n} else {\ncolor \x3d y2;\n}\n}\n}\n#else\nvec4 color \x3d u_color;\n#endif\nreturn color;\n}\nfloat getOpacity(float x) {\n#ifdef VV_OPACITY\nfloat opacity \x3d u_opacity_values[0];\n{\nfor (int i \x3d 1; i \x3c MAX_STOPS; i++) {\nif (i \x3e\x3d u_opacity_count) {\nbreak;\n}\nfloat x1 \x3d u_opacity_stops[i - 1];\nif (x \x3c x1) {\nbreak;\n}\nfloat x2 \x3d u_opacity_stops[i];\nfloat y2 \x3d u_opacity_values[i];\nif (x \x3c x2) {\nfloat y1 \x3d u_opacity_values[i - 1];\nopacity \x3d y1 + (y2 - y1) * (x - x1) / (x2 - x1);\n} else {\nopacity \x3d y2;\n}\n}\n}\n#else\nfloat opacity \x3d u_opacity;\n#endif\nreturn opacity;\n}\nfloat getSize(float x) {\n#ifdef VV_SIZE\nfloat size \x3d u_size_values[0];\n{\nfor (int i \x3d 1; i \x3c MAX_STOPS; i++) {\nif (i \x3e\x3d u_size_count) {\nbreak;\n}\nfloat x1 \x3d u_size_stops[i - 1];\nif (x \x3c x1) {\nbreak;\n}\nfloat x2 \x3d u_size_stops[i];\nfloat y2 \x3d u_size_values[i];\nif (x \x3c x2) {\nfloat y1 \x3d u_size_values[i - 1];\nsize \x3d y1 + (y2 - y1) * (x - x1) / (x2 - x1);\n} else {\nsize \x3d y2;\n}\n}\n}\n#else\nfloat size \x3d u_size;\n#endif\nreturn size + 2.0 * u_featheringSize * u_featheringOffset;\n}"},
hillshade:{"hillshade.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform int u_hillshadeType;\nuniform float u_sinZcosAs[6];\nuniform float u_sinZsinAs[6];\nuniform float u_cosZs[6];\nuniform float u_weights[6];\nuniform vec2 u_factor;\nuniform float u_minValue;\nuniform float u_maxValue;\n#include \x3craster/lut/colorize.glsl\x3e\nfloat getNeighborHoodAlpha(float a, float b, float c, float d, float e, float f, float g, float h, float i){\nif (a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0) {\nreturn 0.0;\n}\nelse {\nreturn e;\n}\n}\nvec3 rgb2hsv(vec3 c) {\nvec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\nvec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\nfloat d \x3d q.x - min(q.w, q.y);\nfloat e \x3d 1.0e-10;\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(vec3 c) {\nvec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\nreturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec4 overlay(float val, float minValue, float maxValue, float hillshade) {\nval \x3d clamp((val - minValue) / (maxValue - minValue), 0.0, 1.0);\nvec4 rgb \x3d colorize(vec4(val, val, val, 1.0), 255.0);\nvec3 hsv \x3d rgb2hsv(rgb.xyz);\nhsv.z \x3d hillshade;\nreturn vec4(hsv2rgb(hsv), 1.0) * rgb.a;\n}\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\nif (currentPixel.a \x3d\x3d 0.0) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec2 axy \x3d vec2(-1.0, -1.0);\nvec2 bxy \x3d vec2(0.0, -1.0);\nvec2 cxy \x3d vec2(1.0, -1.0);\nvec2 dxy \x3d vec2(-1.0, 0.0);\nvec2 fxy \x3d vec2(1.0, 0.0);\nvec2 gxy \x3d vec2(-1.0, 1.0);\nvec2 hxy \x3d vec2(0.0, 1.0);\nvec2 ixy \x3d vec2(1.0, 1.0);\nvec2 onePixel \x3d 1.0 / u_srcImageSize;\nif (pixelLocation.s \x3c onePixel.s) {\naxy[0] \x3d 1.0;\ndxy[0] \x3d 1.0;\ngxy[0] \x3d 1.0;\n}\nif (pixelLocation.t \x3c onePixel.t) {\naxy[1] \x3d 1.0;\nbxy[1] \x3d 1.0;\ncxy[1] \x3d 1.0;\n}\nif (pixelLocation.s \x3e 1.0 - onePixel.s) {\ncxy[0] \x3d -1.0;\nfxy[0] \x3d -1.0;\nixy[0] \x3d -1.0;\n}\nif (pixelLocation.t \x3e 1.0 - onePixel.t) {\ngxy[1] \x3d -1.0;\nhxy[1] \x3d -1.0;\nixy[1] \x3d -1.0;\n}\nvec4 va \x3d texture2D(u_image, pixelLocation + onePixel * axy);\nvec4 vb \x3d texture2D(u_image, pixelLocation + onePixel * bxy);\nvec4 vc \x3d texture2D(u_image, pixelLocation + onePixel * cxy);\nvec4 vd \x3d texture2D(u_image, pixelLocation + onePixel * dxy);\nvec4 ve \x3d texture2D(u_image, pixelLocation);\nvec4 vf \x3d texture2D(u_image, pixelLocation + onePixel * fxy);\nvec4 vg \x3d texture2D(u_image, pixelLocation + onePixel * gxy);\nvec4 vh \x3d texture2D(u_image, pixelLocation + onePixel * hxy);\nvec4 vi \x3d texture2D(u_image, pixelLocation + onePixel * ixy);\nfloat dzx \x3d (vc + 2.0 * vf + vi - va - 2.0 * vd - vg).r * u_factor.s;\nfloat dzy \x3d (vg + 2.0 * vh + vi - va - 2.0 * vb - vc).r * u_factor.t;\nfloat dzd \x3d sqrt(1.0 + dzx * dzx + dzy * dzy);\nfloat hillshade \x3d 0.0;\nif (u_hillshadeType \x3d\x3d 0){\nfloat cosDelta \x3d u_sinZsinAs[0] * dzy - u_sinZcosAs[0] * dzx;\nfloat z \x3d (u_cosZs[0] + cosDelta) / dzd;\nif (z \x3c 0.0)  z \x3d 0.0;\nhillshade \x3d z;\n} else {\nfor (int k \x3d 0; k \x3c 6; k++) {\nfloat cosDelta \x3d u_sinZsinAs[k] * dzy - u_sinZcosAs[k] * dzx;\nfloat z \x3d (u_cosZs[k] + cosDelta) / dzd;\nif (z \x3c 0.0) z \x3d 0.0;\nhillshade \x3d hillshade + z * u_weights[k];\nif (k \x3d\x3d 5) break;\n}\n}\nfloat alpha \x3d getNeighborHoodAlpha(va.a, vb.a, vc.a, vd.a, ve.a, vf.a, vg.a, vh.a, vi.a);\n#ifdef APPLY_COLORMAP\ngl_FragColor \x3d overlay(ve.r, u_minValue, u_maxValue, hillshade) * alpha * u_opacity;\n#else\ngl_FragColor \x3d vec4(hillshade, hillshade, hillshade, 1.0) * alpha * u_opacity;\n#endif\n}",
"hillshade.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},lut:{"colorize.glsl":"uniform sampler2D u_colormap;\nuniform float u_colormapOffset;\nuniform float u_colormapMaxIndex;\nvec4 colorize(vec4 currentPixel, float scaleFactor) {\nfloat clrIndex \x3d clamp(currentPixel.r * scaleFactor - u_colormapOffset, 0.0, u_colormapMaxIndex);\nvec2 clrPosition \x3d vec2((clrIndex + 0.5) / (u_colormapMaxIndex + 1.0), 0.0);\nvec4 color \x3d texture2D(u_colormap, clrPosition);\nvec4 result \x3d vec4(color.rgb, color.a * currentPixel.a);\nreturn result;\n}",
"lut.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\n#include \x3craster/lut/colorize.glsl\x3e\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\nvec4 result \x3d colorize(currentPixel, 1.0);\ngl_FragColor \x3d vec4(result.xyz, 1.0) * result.a * u_opacity;\n}","lut.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos * u_scale + u_offset;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
magdir:{"magdir.frag":"precision mediump float;\nvarying vec4 v_color;\nuniform lowp float u_opacity;\nvoid main() {\ngl_FragColor \x3d v_color * u_opacity;\n}","magdir.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_vv;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform vec2 u_symbolSize;\nuniform vec2 u_symbolPercentRange;\nuniform vec2 u_dataRange;\nuniform float u_rotation;\nuniform vec4 u_colors[12];\nvarying vec4 v_color;\nvoid main()\n{\nfloat angle \x3d a_offset.y + u_rotation;\n#ifndef ROTATION_GEOGRAPHIC\nangle \x3d 3.14159265359 * 2.0 - angle - 3.14159265359 / 2.0;\n#endif\nvec2 offset \x3d vec2(cos(angle), sin(angle)) * a_offset.x;\n#ifdef DATA_RANGE\nfloat valuePercentage \x3d clamp((a_vv.y - u_dataRange.x) / (u_dataRange.y - u_dataRange.x), 0.0, 1.0);\nfloat sizeRatio \x3d u_symbolPercentRange.x + valuePercentage * (u_symbolPercentRange.y - u_symbolPercentRange.x);\nfloat sizePercentage \x3d clamp(sizeRatio, u_symbolPercentRange.x, u_symbolPercentRange.y);\n#else\nfloat sizePercentage \x3d (u_symbolPercentRange.x + u_symbolPercentRange.y) / 2.0;\n#endif\nvec2 pos \x3d a_pos + offset * sizePercentage * u_symbolSize;\nv_color \x3d u_colors[int(a_vv.x)];\ngl_Position \x3d vec4(u_dvsMat3 * vec3(pos * u_coordScale, 1.0), 1.0);\n}"},
reproject:{"reproject.frag":"precision mediump float;\nvarying vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 1.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\ngl_FragColor \x3d vec4(currentPixel.rgb, 1.0) * currentPixel.a * u_opacity;\n}","reproject.vert":"precision mediump float;\nattribute vec2 a_position;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_position;\ngl_Position \x3d vec4(2.0 * (a_position - 0.5), 0.0, 1.0);\n}"},
scalar:{"scalar.frag":"precision mediump float;\nuniform lowp float u_opacity;\nvarying vec2 v_pos;\nconst vec4 outlineColor \x3d vec4(0.2, 0.2, 0.2, 1.0);\nconst float outlineSize \x3d 0.02;\nconst float innerRadius \x3d 0.25;\nconst float outerRadius \x3d 0.42;\nconst float innerSquareLength \x3d 0.15;\nvoid main() {\nmediump float dist \x3d length(v_pos);\nmediump float fillalpha1 \x3d smoothstep(outerRadius, outerRadius + outlineSize, dist);\nfillalpha1 *\x3d (1.0-smoothstep(outerRadius + outlineSize, outerRadius + 0.1 + outlineSize, dist));\n#ifdef INNER_CIRCLE\nmediump float fillalpha2 \x3d smoothstep(innerRadius, innerRadius + outlineSize, dist);\nfillalpha2 *\x3d (1.0-smoothstep(innerRadius + outlineSize, innerRadius + 0.1 + outlineSize, dist));\n#else\nmediump float fillalpha2 \x3d (abs(v_pos.x) \x3c innerSquareLength ? 1.0 : 0.0) * (abs(v_pos.y) \x3c innerSquareLength ? 1.0 : 0.0);\n#endif\ngl_FragColor \x3d (fillalpha2 + fillalpha1) * outlineColor * u_opacity;\n}",
"scalar.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_vv;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform vec2 u_symbolSize;\nuniform vec2 u_symbolPercentRange;\nuniform vec2 u_dataRange;\nvarying vec2 v_pos;\nvoid main()\n{\n#ifdef DATA_RANGE\nfloat valuePercentage \x3d clamp((a_vv.y - u_dataRange.x) / (u_dataRange.y - u_dataRange.x), 0.0, 1.0);\nfloat sizeRatio \x3d u_symbolPercentRange.x + valuePercentage * (u_symbolPercentRange.y - u_symbolPercentRange.x);\nfloat sizePercentage \x3d clamp(sizeRatio, u_symbolPercentRange.x, u_symbolPercentRange.y);\n#else\nfloat sizePercentage \x3d (u_symbolPercentRange.x + u_symbolPercentRange.y) / 2.0;\n#endif\nvec2 size \x3d u_symbolSize * sizePercentage;\nvec2 pos \x3d a_pos + a_offset * size;\nv_pos \x3d a_offset;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(pos * u_coordScale, 1.0), 1.0);\n}"},
stretch:{"stretch.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput;\nuniform float u_maxOutput;\nuniform float u_factor[3];\nuniform bool u_useGamma;\nuniform float u_gamma[3];\nuniform float u_gammaCorrection[3];\n#include \x3craster/lut/colorize.glsl\x3e\nfloat stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, bool useGamma, float gamma, float gammaCorrection) {\nif (val \x3e\x3d maxCutOff) {\nreturn maxOutput;\n} else if (val \x3c\x3d minCutOff) {\nreturn minOutput;\n}\nfloat stretchedVal;\nif (useGamma) {\nfloat tempf \x3d 1.0;\nfloat outRange \x3d maxOutput - minOutput;\nfloat relativeVal \x3d (val - minCutOff) / (maxCutOff - minCutOff);\nif (gamma \x3e 1.0) {\ntempf -\x3d pow(1.0 / outRange, relativeVal * gammaCorrection);\n}\nstretchedVal \x3d (tempf * outRange * pow(relativeVal, 1.0 / gamma) + minOutput) / 255.0;\n} else {\nstretchedVal \x3d minOutput + (val - minCutOff) * factor;\n}\nreturn stretchedVal;\n}\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\n#ifdef NOOP\ngl_FragColor \x3d vec4(currentPixel.rgb, 1.0) * currentPixel.a * u_opacity;\nreturn;\n#endif\nif (u_bandCount \x3d\x3d 1) {\nfloat grayVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n#ifdef APPLY_COLORMAP\nvec4 result \x3d colorize(vec4(grayVal, grayVal, grayVal, 1.0), u_useGamma ? 255.0 : 1.0);\ngl_FragColor \x3d vec4(result.xyz, 1.0) * result.a * currentPixel.a * u_opacity;\n#else\ngl_FragColor \x3d vec4(grayVal, grayVal, grayVal, 1.0) * currentPixel.a * u_opacity;\n#endif\n} else {\nfloat redVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\nfloat greenVal \x3d stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_useGamma, u_gamma[1], u_gammaCorrection[1]);\nfloat blueVal \x3d stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_useGamma, u_gamma[2], u_gammaCorrection[2]);\ngl_FragColor \x3d vec4(redVal, greenVal, blueVal, 1.0) * currentPixel.a * u_opacity;\n}\n}",
"stretch.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos * u_scale + u_offset;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"}},stencil:{"stencil.frag":"void main() {\ngl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n}","stencil.vert":"attribute vec2 a_pos;\nuniform mat3 u_worldExtent;\nvoid main() {\ngl_Position \x3d vec4(u_worldExtent * vec3(a_pos, 1.0), 1.0);\n}"},
tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\nvoid main(void) {\nlowp vec4 color \x3d texture2D(u_texture, v_tex);\ngl_FragColor \x3d 0.75 * color;\n}","tileInfo.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_coord_ratio;\nuniform mediump vec2 u_delta;\nuniform mediump vec2 u_dimensions;\nvarying mediump vec2 v_tex;\nvoid main() {\nmediump vec2 offset \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\nvec3 v_pos \x3d u_dvsMat3 * vec3(offset, 1.0);\ngl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\nv_tex \x3d a_pos;\n}"},
util:{"atan2.glsl":"float atan2(in float y, in float x) {\nfloat t0, t1, t2, t3, t4;\nt3 \x3d abs(x);\nt1 \x3d abs(y);\nt0 \x3d max(t3, t1);\nt1 \x3d min(t3, t1);\nt3 \x3d 1.0 / t0;\nt3 \x3d t1 * t3;\nt4 \x3d t3 * t3;\nt0 \x3d         - 0.013480470;\nt0 \x3d t0 * t4 + 0.057477314;\nt0 \x3d t0 * t4 - 0.121239071;\nt0 \x3d t0 * t4 + 0.195635925;\nt0 \x3d t0 * t4 - 0.332994597;\nt0 \x3d t0 * t4 + 0.999995630;\nt3 \x3d t0 * t3;\nt3 \x3d (abs(y) \x3e abs(x)) ? 1.570796327 - t3 : t3;\nt3 \x3d x \x3c 0.0 ?  3.141592654 - t3 : t3;\nt3 \x3d y \x3c 0.0 ? -t3 : t3;\nreturn t3;\n}",
"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n255.0 / (256.0),\n255.0 / (256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n);\nfloat rgba2float(vec4 rgba) {\nreturn dot(rgba, rgba2float_factors);\n}"}}})},"esri/views/2d/engine/webgl/brushes/BrushOverlay":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../Utils ./WGLBrush ../../../../webgl/enums".split(" "),function(q,t,D,E,C,A){return function(n){function l(){var a=
n.apply(this,arguments)||this;a._desc={vsPath:"overlay/overlay",fsPath:"overlay/overlay",attributes:new Map([["a_pos",0],["a_uv",1]])};return a}q._inheritsLoose(l,n);var d=l.prototype;d.dispose=function(){};d.prepareState=function({context:a}){a.setBlendingEnabled(!0);a.setColorMask(!0,!0,!0,!0);a.setBlendFunctionSeparate(A.BlendFactor.ONE,A.BlendFactor.ONE_MINUS_SRC_ALPHA,A.BlendFactor.ONE,A.BlendFactor.ONE_MINUS_SRC_ALPHA);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(A.CompareFunction.GREATER,
255,255)};d.draw=function(a,b){const {context:c,painter:f,requestRender:h}=a;if(b.isReady){var {computedOpacity:p,dvsMat3:k,isWrapAround:e,texture:m}=b;a.timeline.begin(this.name);var r=f.materialManager.getProgram(this._desc);if(t.isSome(h)&&!r.isCompiled)h();else{var v=E.createProgramDescriptor("overlay",{geometry:[{location:0,name:"a_pos",count:2,type:A.DataType.FLOAT}],tex:[{location:1,name:"a_uv",count:2,type:A.DataType.UNSIGNED_SHORT}]});if(b=b.getVAO(c,v.bufferLayouts,v.attributes))c.bindVAO(b),
c.useProgram(r),c.bindTexture(m,D.TEXTURE_BINDING_BITMAP),r.setUniformMatrix3fv("u_dvsMat3",k),r.setUniform1i("u_texture",D.TEXTURE_BINDING_BITMAP),r.setUniform1f("u_opacity",p),c.drawArrays(A.PrimitiveType.TRIANGLE_STRIP,0,e?10:4),c.bindVAO(),a.timeline.end(this.name)}}};return l}(C)})},"esri/views/2d/engine/webgl/brushes/WGLBrushDotDensity":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../core/RandomLCG ../definitions ../enums ./WGLGeometryBrushFill ../techniques/utils ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/FramebufferObject ../../../../webgl/Renderbuffer ../../../../webgl/Texture ../../../../webgl/VertexArrayObject".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c,f){return function(h){function p(){var e=h.apply(this,arguments)||this;e._dotTextureSize=0;e._dotTextures=null;e._dotSamplers=new Int32Array([E.TEXTURE_BINDING_RENDERER_0,E.TEXTURE_BINDING_RENDERER_1]);e._dotVAO=null;e._dotDesc={vsPath:"dot/dot",fsPath:"dot/dot",attributes:new Map([["a_pos",0]])};return e}q._inheritsLoose(p,h);var k=p.prototype;k.dispose=function(){h.prototype.dispose.call(this);this._disposeTextures();this._dotFBO=t.disposeMaybe(this._dotFBO);this._dotVAO=
t.disposeMaybe(this._dotVAO)};k.getGeometryType=function(){return C.WGLGeometryType.FILL};k.supportsSymbology=function(e){return e===C.WGLSymbologyType.DOT_DENSITY};k._drawFills=function(e,m,r,v,x,g){const {passOptions:u}=e;t.isSome(u)&&"hittest"===u.type?h.prototype._drawFills.call(this,e,m,r,v,x,g):(r=this._drawDotLocations(e,m,r,x,g),this._drawDotDensity(e,m,r))};k._drawDotDensity=function(e,m,r){const {context:v,painter:x,rendererInfo:g,requestRender:u}=e,y=x.materialManager.getProgram(this._dotDesc);
if(t.isSome(u)&&!y.isCompiled)u();else{var {rendererSchema:z}=g;n.assertRendererSchema(z,"dot-density");var w=this._createDotDensityMesh(v,this._dotDesc.attributes,{geometry:[{name:"a_pos",count:2,type:d.DataType.SHORT,divisor:0,normalized:!1,offset:0,stride:4}]});v.setStencilTestEnabled(!0);v.useProgram(y);y.setUniform1f("u_tileZoomFactor",1);y.setUniform1i("u_texture",this._dotSamplers[0]);y.setUniform1f("u_dotSize",Math.max(z.dotSize,1));y.setUniform1f("u_pixelRatio",window.devicePixelRatio);this._setSharedUniforms(y,
e,m);v.bindTexture(r,this._dotSamplers[0]);v.bindVAO(w);v.drawArrays(d.PrimitiveType.POINTS,0,262144)}};k._drawDotLocations=function(e,m,r,v,x){const {context:g,rendererInfo:u,requiredLevel:y}=e,z=g.getViewport();var {rendererSchema:w}=u;n.assertRendererSchema(w,"dot-density");const {dotScale:B,colors:F,activeDots:G,backgroundColor:H,dotValue:I}=w;g.setViewport(0,0,512,512);w=g.getBoundFramebufferObject();const L=this._createFBO(g);g.bindFramebuffer(L);g.setClearColor(0,0,0,0);g.clear(g.gl.COLOR_BUFFER_BIT|
g.gl.STENCIL_BUFFER_BIT);g.setStencilTestEnabled(!1);m=1/2**(y-m.key.level);const N=E.TILE_SIZE,J=N*window.devicePixelRatio*N*window.devicePixelRatio,K=1/m*(1/m);e=B?e.state.scale/B:1;r.setUniform1f("u_tileZoomFactor",m);r.setUniform1f("u_tileDotsOverArea",J/(E.TILE_SIZE*window.devicePixelRatio*E.TILE_SIZE*window.devicePixelRatio));r.setUniformMatrix4fv("u_dotColors",F);r.setUniform4fv("u_isActive",G);r.setUniform4fv("u_dotBackgroundColor",H);r.setUniform1f("u_dotValue",Math.max(1,I*e*K));this._bindDotDensityTextures(g,
r,u,N);g.drawElements(d.PrimitiveType.TRIANGLES,v,d.DataType.UNSIGNED_INT,x);g.setViewport(z.x,z.y,z.width,z.height);g.bindFramebuffer(w);return L.colorTexture};k._createFBO=function(e){if(t.isNone(this._dotFBO)){const m={target:d.TextureType.TEXTURE_2D,pixelFormat:d.PixelFormat.RGBA,dataType:d.PixelType.UNSIGNED_BYTE,samplingMode:d.TextureSamplingMode.NEAREST,wrapMode:d.TextureWrapMode.CLAMP_TO_EDGE,width:512,height:512},r={colorTarget:d.TargetType.TEXTURE,depthStencilTarget:d.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER},
v=new b.Renderbuffer(e,{width:512,height:512,internalFormat:d.RenderbufferFormat.DEPTH_STENCIL});this._dotFBO=new a.FramebufferObject(e,r,m,v)}return this._dotFBO};k._disposeTextures=function(){if(this._dotTextures){for(let e=0;e<this._dotTextures.length;e++)this._dotTextures[e].dispose();this._dotTextures=null}};k._bindDotDensityTextures=function(e,m,r,v){({rendererSchema:r}=r);n.assertRendererSchema(r,"dot-density");v=this._createDotDensityTextures(e,v,r.seed);m.setUniform1iv("u_dotTextures",this._dotSamplers);
for(m=0;m<v.length;m++)e.bindTexture(v[m],this._dotSamplers[m])};k._createDotDensityMesh=function(e,m,r){if(t.isNone(this._dotVAO)){var v=new Int16Array(524288);for(let x=0;512>x;x++)for(let g=0;512>g;g++)v[2*(g+512*x)]=g,v[2*(g+512*x)+1]=x;v=l.BufferObject.createVertex(e,d.Usage.STATIC_DRAW,v);this._dotVAO=new f.VertexArrayObject(e,m,r,{geometry:v},null)}return this._dotVAO};k._createDotDensityTextures=function(e,m,r){if(this._dotTextureSize!==m||this._seed!==r)this._disposeTextures(),this._dotTextureSize=
m,this._seed=r;null===this._dotTextures&&(r=new D(r),this._dotTextures=[this._allocDotDensityTexture(e,m,r),this._allocDotDensityTexture(e,m,r)]);return this._dotTextures};k._allocDotDensityTexture=function(e,m,r){const v=new Float32Array(m*m*4);for(let x=0;x<v.length;x++)v[x]=r.getFloat();return new c.Texture(e,{wrapMode:d.TextureWrapMode.REPEAT,pixelFormat:d.PixelFormat.RGBA,dataType:d.PixelType.FLOAT,samplingMode:d.TextureSamplingMode.NEAREST,width:m,height:m},v)};return p}(A)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushFill":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../techniques/utils ../../../../webgl/enums".split(" "),
function(q,t,D,E,C,A,n,l){function d(a){const b={geometry:[{location:0,name:"a_pos",count:2,type:l.DataType.SHORT},{location:1,name:"a_id",count:3,type:l.DataType.UNSIGNED_BYTE},{location:2,name:"a_bitset",count:1,type:l.DataType.UNSIGNED_BYTE},{location:3,name:"a_color",count:4,type:l.DataType.UNSIGNED_BYTE,normalized:!0},{location:4,name:"a_aux1",count:4,type:l.DataType.UNSIGNED_SHORT},{location:5,name:"a_aux2",count:4,type:l.DataType.SHORT},{location:6,name:"a_aux3",count:4,type:l.DataType.UNSIGNED_BYTE},
{location:7,name:"a_zoomRange",count:2,type:l.DataType.UNSIGNED_SHORT}]};switch(a.symbologyType){case D.WGLSymbologyType.SIMPLE:case D.WGLSymbologyType.OUTLINE_FILL_SIMPLE:b.geometry.splice(7,1),b.geometry.splice(4,1)}return{shader:"materials/fill",vertexLayout:b}}return function(a){function b(){return a.apply(this,arguments)||this}q._inheritsLoose(b,a);var c=b.prototype;c.dispose=function(){};c.getGeometryType=function(){return D.WGLGeometryType.FILL};c.supportsSymbology=function(f){return f!==D.WGLSymbologyType.DOT_DENSITY};
c.drawGeometry=function(f,h,p,k){const {context:e,painter:m,rendererInfo:r,requiredLevel:v,passOptions:x,requestRender:g}=f;var u=A.FillMaterialKey.load(p.materialKey),y=n.getTechniqueFromMaterialKey(u.data);const z=t.isSome(x)&&"hittest"===x.type;var w=m.materialManager;const {shader:B,vertexLayout:F,hittestAttributes:G}=t.unwrapOr(y.programSpec,d(u));y=l.PrimitiveType.TRIANGLES;let H=E.createProgramDescriptor(u.data,F);z&&(H=this._getTriangleDesc(p.materialKey,H,G),y=l.PrimitiveType.POINTS);const {attributes:I,
bufferLayouts:L}=H;k=w.getMaterialProgram(f,u,B,I,k);!t.isSome(g)||z||k.isCompiled?(e.useProgram(k),this._setSharedUniforms(k,f,h),k.setUniform2f("u_tileOffset",512*h.key.col,512*h.key.row),u.textureBinding&&(m.textureManager.bindTextures(e,k,u),k.setUniform1f("u_zoomFactor",1/2**(v-h.key.level))),w=1/f.pixelRatio,k.setUniform1f("u_blur",w),k.setUniform1f("u_antialiasing",w),this._setSizeVVUniforms(u,k,r,h),this._setColorAndOpacityVVUniforms(u,k,r),u=p.target.getVAO(e,L,I,z),w=p.indexCount,p=p.indexFrom*
Uint32Array.BYTES_PER_ELEMENT,z&&(w/=3,p/=3),e.bindVAO(u),this._drawFills(f,h,k,y,w,p)):g()};c._drawFills=function(f,h,p,k,e,m){f.context.drawElements(k,e,l.DataType.UNSIGNED_INT,m)};return b}(C)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrush":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ./WGLBrush ../materialKey/MaterialKey ../../../../webgl/enums".split(" "),function(q,t,D,E,C,A){return function(n){function l(){var a=n.apply(this,
arguments)||this;a._computeDesc=new Map;return a}q._inheritsLoose(l,n);var d=l.prototype;d.prepareState=function({context:a},b,c){c&&c.includes("hittest")?a.setBlendFunctionSeparate(A.BlendFactor.ONE,A.BlendFactor.ONE,A.BlendFactor.ONE,A.BlendFactor.ONE):a.setBlendFunctionSeparate(A.BlendFactor.ONE,A.BlendFactor.ONE_MINUS_SRC_ALPHA,A.BlendFactor.ONE,A.BlendFactor.ONE_MINUS_SRC_ALPHA);a.setBlendingEnabled(!0);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(A.CompareFunction.EQUAL,
b.stencilRef,255)};d.draw=function(a,b,c){var f=this.getGeometryType();b.commit(a);f=b.getGeometry(f);t.isNone(f)||(a.timeline.begin(this.name),a.attributeView.bindTextures(a.context),f.forEachCommand(h=>{const p=C.MaterialKeyBase.load(h.materialKey).symbologyType;this.supportsSymbology(p)&&this.drawGeometry(a,b,h,c)}))};d._setSharedUniforms=function(a,b,c){const {displayLevel:f,pixelRatio:h,state:p,passOptions:k}=b;t.isSome(k)&&"hittest"===k.type&&(a.setUniform2fv("u_hittestPos",k.position),a.setUniform1f("u_hittestDist",
k.distance));a.setUniform1f("u_pixelRatio",h);a.setUniformMatrix3fv("u_tileMat3",c.transforms.tileMat3);a.setUniformMatrix3fv("u_viewMat3",p.viewMat3);a.setUniformMatrix3fv("u_dvsMat3",c.transforms.dvs);a.setUniformMatrix3fv("u_displayViewMat3",p.displayViewMat3);a.setUniform1f("u_currentZoom",Math.round(f*D.MIN_MAX_ZOOM_PRECISION_FACTOR));a.setUniform1i("u_attributeTextureSize",b.attributeView.size);a.setUniform1i("u_attributeData0",D.TEXTURE_BINDING_ATTRIBUTE_DATA_0);a.setUniform1i("u_attributeData1",
D.TEXTURE_BINDING_ATTRIBUTE_DATA_1);a.setUniform1i("u_attributeData2",D.TEXTURE_BINDING_ATTRIBUTE_DATA_2);a.setUniform1i("u_attributeData3",D.TEXTURE_BINDING_ATTRIBUTE_DATA_3);a.setUniform1i("u_attributeData4",D.TEXTURE_BINDING_ATTRIBUTE_DATA_4);a.setUniform1i("u_attributeData5",D.TEXTURE_BINDING_ATTRIBUTE_DATA_5)};d._setSizeVVUniforms=function(a,b,c,f){a.vvSizeMinMaxValue&&b.setUniform4fv("u_vvSizeMinMaxValue",c.vvSizeMinMaxValue);a.vvSizeScaleStops&&b.setUniform1f("u_vvSizeScaleStopsValue",c.vvSizeScaleStopsValue);
a.vvSizeFieldStops&&(f=c.getSizeVVFieldStops(f.key.level),b.setUniform1fv("u_vvSizeFieldStopsValues",f.values),b.setUniform1fv("u_vvSizeFieldStopsSizes",f.sizes));a.vvSizeUnitValue&&b.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",c.vvSizeUnitValueToPixelsRatio)};d._setColorAndOpacityVVUniforms=function(a,b,c){a.vvColor&&(b.setUniform1fv("u_vvColorValues",c.vvColorValues),b.setUniform4fv("u_vvColors",c.vvColors));a.vvOpacity&&(b.setUniform1fv("u_vvOpacityValues",c.vvOpacityValues),b.setUniform1fv("u_vvOpacities",
c.vvOpacities))};d._setRotationVVUniforms=function(a,b,c){a.vvRotation&&b.setUniform1f("u_vvRotationType","geographic"===c.vvMaterialParameters.vvRotationType?0:1)};d._getTriangleDesc=function(a,b,c=["a_pos"]){const f=b.bufferLayouts.geometry;c=c.map(k=>f.findIndex(e=>e.name===k));a=`${a}-${c.join("-")}`;var h=this._computeDesc.get(a);if(!h){h=b.strides;const k=b.strides.geometry,e=new Map(b.attributes);var p=f.map(r=>({...r}));b=Math.max(...b.attributes.values());p={geometry:p};let m=0;for(const r of c)c=
f[r],p.geometry.push({count:c.count,name:c.name+"1",divisor:c.divisor,normalized:c.normalized,offset:k+c.offset,stride:k,type:c.type}),p.geometry.push({count:c.count,name:c.name+"2",divisor:c.divisor,normalized:c.normalized,offset:2*k+c.offset,stride:k,type:c.type}),e.set(c.name+"1",b+ ++m),e.set(c.name+"2",b+ ++m);h={bufferLayouts:p,attributes:e,strides:h};this._computeDesc.set(a,h)}return h};return l}(E)})},"esri/views/2d/engine/webgl/materialKey/MaterialKey":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../core/Error","../alignmentUtils","../enums"],function(q,t,D,E,C){function A(r){return r===C.WGLSymbologyType.SIMPLE||r===C.WGLSymbologyType.OUTLINE_FILL_SIMPLE}function n(r){return r===C.WGLSymbologyType.OUTLINE_FILL||r===C.WGLSymbologyType.OUTLINE_FILL_SIMPLE}const l=Object.keys(C.WGLSymbologyType).filter(r=>"number"===typeof C.WGLSymbologyType[r]).reduce((r,v)=>({...r,[v]:C.WGLSymbologyType[v]}),{});let d=function(){function r(x){this._data=0;this._data=x}r.load=function(x){const g=
this.shared;g.data=x;return g};var v=r.prototype;v.setBit=function(x,g){x=1<<x;this._data=g?this._data|x:this._data&~x};v.bit=function(x){return(this._data&1<<x)>>x};v.setBits=function(x,g,u){for(let y=g,z=0;y<u;y++,z++)this.setBit(y,0!==(x&1<<z))};v.bits=function(x,g){let u=0;for(let y=x,z=0;y<g;y++,z++)u|=this.bit(y)<<z;return u};v.hasVV=function(){return!1};v.setVV=function(x,g){};v.getVariation=function(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf,symbologyType:{value:C.WGLSymbologyType[this.symbologyType],
options:l,namespace:"SYMBOLOGY_TYPE"}}};v.getVariationHash=function(){return this._data&~(7&this.textureBinding)};t._createClass(r,[{key:"data",get:function(){return this._data},set:function(x){this._data=x}},{key:"geometryType",get:function(){return this.bits(8,11)},set:function(x){this.setBits(x,8,11)}},{key:"mapAligned",get:function(){return!!this.bit(20)},set:function(x){this.setBit(20,x)}},{key:"sdf",get:function(){return!!this.bit(11)},set:function(x){this.setBit(11,x)}},{key:"pattern",get:function(){return!!this.bit(12)},
set:function(x){this.setBit(12,x)}},{key:"textureBinding",get:function(){return this.bits(0,8)},set:function(x){this.setBits(x,0,8)}},{key:"symbologyType",get:function(){return this.bits(21,26)},set:function(x){this.setBits(x,21,26)}},{key:"geometryTypeString",get:function(){switch(this.geometryType){case C.WGLGeometryType.FILL:return"fill";case C.WGLGeometryType.MARKER:return"marker";case C.WGLGeometryType.LINE:return"line";case C.WGLGeometryType.TEXT:return"text";case C.WGLGeometryType.LABEL:return"label";
default:throw new D(`Unable to handle unknown geometryType: ${this.geometryType}`);}}}]);return r}();d.shared=new d(0);const a=r=>function(v){function x(){return v.apply(this,arguments)||this}t._inheritsLoose(x,v);var g=x.prototype;g.hasVV=function(){return v.prototype.hasVV.call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue};g.setVV=function(u,y){v.prototype.setVV.call(this,u,y);{var z=this.geometryType;const w=C.WGLVVFlag.SIZE_FIELD_STOPS|C.WGLVVFlag.SIZE_MINMAX_VALUE|
C.WGLVVFlag.SIZE_SCALE_STOPS|C.WGLVVFlag.SIZE_UNIT_VALUE,B=(u&(C.WGLVVTarget.FIELD_TARGETS_OUTLINE|C.WGLVVTarget.MINMAX_TARGETS_OUTLINE|C.WGLVVTarget.SCALE_TARGETS_OUTLINE|C.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;y=z===C.WGLGeometryType.LINE&&y.isOutline||z===C.WGLGeometryType.FILL&&n(y.symbologyType)?w&B:w&~B}u&=y;this.vvSizeMinMaxValue=!!(u&C.WGLVVFlag.SIZE_MINMAX_VALUE);this.vvSizeFieldStops=!!(u&C.WGLVVFlag.SIZE_FIELD_STOPS);this.vvSizeUnitValue=!!(u&C.WGLVVFlag.SIZE_UNIT_VALUE);this.vvSizeScaleStops=
!!(u&C.WGLVVFlag.SIZE_SCALE_STOPS)};t._createClass(x,[{key:"vvSizeMinMaxValue",get:function(){return 0!==this.bit(16)},set:function(u){this.setBit(16,u)}},{key:"vvSizeScaleStops",get:function(){return 0!==this.bit(17)},set:function(u){this.setBit(17,u)}},{key:"vvSizeFieldStops",get:function(){return 0!==this.bit(18)},set:function(u){this.setBit(18,u)}},{key:"vvSizeUnitValue",get:function(){return 0!==this.bit(19)},set:function(u){this.setBit(19,u)}}]);return x}(r),b=r=>function(v){function x(){return v.apply(this,
arguments)||this}t._inheritsLoose(x,v);var g=x.prototype;g.hasVV=function(){return v.prototype.hasVV.call(this)||this.vvRotation};g.setVV=function(u,y){v.prototype.setVV.call(this,u,y);this.vvRotation=!y.isOutline&&!!(u&C.WGLVVFlag.ROTATION)};t._createClass(x,[{key:"vvRotation",get:function(){return 0!==this.bit(15)},set:function(u){this.setBit(15,u)}}]);return x}(r),c=r=>function(v){function x(){return v.apply(this,arguments)||this}t._inheritsLoose(x,v);var g=x.prototype;g.hasVV=function(){return v.prototype.hasVV.call(this)||
this.vvColor};g.setVV=function(u,y){v.prototype.setVV.call(this,u,y);this.vvColor=!y.isOutline&&!!(u&C.WGLVVFlag.COLOR)};t._createClass(x,[{key:"vvColor",get:function(){return 0!==this.bit(13)},set:function(u){this.setBit(13,u)}}]);return x}(r),f=r=>function(v){function x(){return v.apply(this,arguments)||this}t._inheritsLoose(x,v);var g=x.prototype;g.hasVV=function(){return v.prototype.hasVV.call(this)||this.vvOpacity};g.setVV=function(u,y){v.prototype.setVV.call(this,u,y);this.vvOpacity=!y.isOutline&&
!!(u&C.WGLVVFlag.OPACITY)};t._createClass(x,[{key:"vvOpacity",get:function(){return 0!==this.bit(14)},set:function(u){this.setBit(14,u)}}]);return x}(r);let h=function(r){function v(){return r.apply(this,arguments)||this}t._inheritsLoose(v,r);v.load=function(x){const g=this.shared;g.data=x;return g};v.from=function(x){const {symbologyType:g,vvFlags:u}=x,y=this.load(0);y.geometryType=C.WGLGeometryType.FILL;y.symbologyType=g;g!==C.WGLSymbologyType.DOT_DENSITY&&y.setVV(u,x);return y.data};v.prototype.getVariation=
function(){return{...r.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return v}(c(f(a(d))));h.shared=new h(0);let p=function(r){function v(){return r.apply(this,arguments)||this}t._inheritsLoose(v,r);v.load=function(x){const g=this.shared;g.data=x;return g};v.from=function(x){const {symbologyType:g,vvFlags:u}=
x,y=this.load(0);y.geometryType=C.WGLGeometryType.MARKER;y.symbologyType=g;g!==C.WGLSymbologyType.HEATMAP&&y.setVV(u,x);return y.data};v.prototype.getVariation=function(){return{...r.prototype.getVariation.call(this),vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return v}(c(f(b(a(d)))));p.shared=new p(0);let k=function(r){function v(){return r.apply(this,
arguments)||this}t._inheritsLoose(v,r);v.load=function(x){const g=this.shared;g.data=x;return g};v.from=function(x){const g=this.load(0);g.geometryType=C.WGLGeometryType.LINE;g.symbologyType=x.symbologyType;g.setVV(x.vvFlags,x);return g.data};v.prototype.getVariation=function(){return{...r.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};
return v}(c(f(a(d))));k.shared=new k(0);let e=function(r){function v(){return r.apply(this,arguments)||this}t._inheritsLoose(v,r);v.load=function(x){const g=this.shared;g.data=x;return g};v.from=function(x){const g=this.load(0);g.geometryType=C.WGLGeometryType.TEXT;g.symbologyType=x.symbologyType;g.setVV(x.vvFlags,x);return g.data};v.prototype.getVariation=function(){return{...r.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,
vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return v}(c(f(b(a(d)))));e.shared=new e(0);let m=function(r){function v(){return r.apply(this,arguments)||this}t._inheritsLoose(v,r);v.load=function(x){const g=this.shared;g.data=x;return g};v.from=function(x){const g=this.load(0);g.geometryType=C.WGLGeometryType.LABEL;g.symbologyType=x.symbologyType;g.setVV(x.vvFlags,x);g.mapAligned=E.isMapAligned(x.placement);return g.data};v.prototype.getVariation=
function(){return{...r.prototype.getVariation.call(this),vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return v}(a(d));m.shared=new m(0);q.FillMaterialKey=h;q.LabelMaterialKey=m;q.LineMaterialKey=k;q.MarkerMaterialKey=p;q.MaterialKeyBase=d;q.TextMaterialKey=e;q.createMaterialKey=function(r,v){switch(r){case C.WGLGeometryType.FILL:return h.from(v);case C.WGLGeometryType.LINE:return k.from(v);
case C.WGLGeometryType.MARKER:return p.from(v);case C.WGLGeometryType.TEXT:return e.from(v);case C.WGLGeometryType.LABEL:return m.from(v);default:throw Error(`Unable to createMaterialKey for unknown geometryType ${r}`);}};q.hasOutlineFillSymbology=function(r){return n(r.symbologyType)};q.hasSimpleSymbology=function(r){return A(r.symbologyType)};q.hydrateMaterialKey=function(r){switch(d.load(r).geometryType){case C.WGLGeometryType.MARKER:return new p(r);case C.WGLGeometryType.FILL:return new h(r);
case C.WGLGeometryType.LINE:return new k(r);case C.WGLGeometryType.TEXT:return new e(r);case C.WGLGeometryType.LABEL:return new m(r)}};q.isOutlineFillSymbology=n;q.isSimpleSymbology=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/alignmentUtils":function(){define(["exports"],function(q){q.HAlign=void 0;(function(t){t[t.Left=-1]="Left";t[t.Center=0]="Center";t[t.Right=1]="Right"})(q.HAlign||(q.HAlign={}));q.VAlign=void 0;(function(t){t[t.Top=
1]="Top";t[t.Center=0]="Center";t[t.Bottom=-1]="Bottom";t[t.Baseline=2]="Baseline"})(q.VAlign||(q.VAlign={}));q.getAlignmentFromPlacement=function(t){switch(t){case "above-left":case "esriServerPointLabelPlacementAboveLeft":return[q.HAlign.Right,q.VAlign.Bottom];case "above-center":case "above-along":case "esriServerPointLabelPlacementAboveCenter":case "esriServerLinePlacementAboveAlong":return[q.HAlign.Center,q.VAlign.Bottom];case "above-right":case "esriServerPointLabelPlacementAboveRight":return[q.HAlign.Left,
q.VAlign.Bottom];case "center-left":case "esriServerPointLabelPlacementCenterLeft":return[q.HAlign.Right,q.VAlign.Center];case "center-center":case "center-along":case "esriServerPointLabelPlacementCenterCenter":case "esriServerLinePlacementCenterAlong":return[q.HAlign.Center,q.VAlign.Center];case "center-right":case "esriServerPointLabelPlacementCenterRight":return[q.HAlign.Left,q.VAlign.Center];case "below-left":case "esriServerPointLabelPlacementBelowLeft":return[q.HAlign.Right,q.VAlign.Top];case "below-center":case "below-along":case "esriServerPointLabelPlacementBelowCenter":case "esriServerLinePlacementBelowAlong":return[q.HAlign.Center,
q.VAlign.Top];case "below-right":case "esriServerPointLabelPlacementBelowRight":return[q.HAlign.Left,q.VAlign.Top];case "always-horizontal":case "esriServerPolygonPlacementAlwaysHorizontal":return[q.HAlign.Center,q.VAlign.Center];default:return console.debug(`Found invalid placement type ${t}`),[q.HAlign.Center,q.VAlign.Center]}};q.getJustification=function(t){switch(t){case "left":return q.HAlign.Left;case "right":return q.HAlign.Right;case "center":return q.HAlign.Center}};q.getXAnchorDirection=
function(t){switch(t){case "left":return q.HAlign.Left;case "right":return q.HAlign.Right;case "center":return q.HAlign.Center}};q.getXDirection=function(t){switch(t){case q.HAlign.Right:return-1;case q.HAlign.Center:return 0;case q.HAlign.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${t}`),0}};q.getYAnchorDirection=function(t){switch(t){case "top":return q.VAlign.Top;case "middle":return q.VAlign.Center;case "baseline":return q.VAlign.Baseline;case "bottom":return q.VAlign.Bottom}};
q.getYDirection=function(t){switch(t){case q.VAlign.Top:return 1;case q.VAlign.Center:return 0;case q.VAlign.Bottom:case q.VAlign.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${t}`),0}};q.isMapAligned=function(t){switch(t){case "above-along":case "below-along":case "center-along":case "esriServerLinePlacementAboveAlong":case "esriServerLinePlacementBelowAlong":case "esriServerLinePlacementCenterAlong":return!0;default:return!1}};Object.defineProperties(q,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/techniques/utils":function(){define("exports ../../../../../core/Error ../enums ../materialKey/MaterialKey ./Technique ./dotDensity/TechniqueDotDensity ./heatmap/TechniqueHeatmap ./pieChart/TechniquePieChart".split(" "),function(q,t,D,E,C,A,n,l){q.assertRendererSchema=function(d,a){if(d.type!==a)throw new t("material-view-model:unexpected-renderer-schema",`expected to find renderer schema of type "${a}" but found type "${d.type}"`);
};q.getTechniqueFromMaterialKey=function(d){const {geometryType:a,symbologyType:b}=E.MaterialKeyBase.load(d);switch(a){case D.WGLGeometryType.FILL:switch(b){case D.WGLSymbologyType.DOT_DENSITY:return A.DotDensityTechnique}break;case D.WGLGeometryType.MARKER:switch(b){case D.WGLSymbologyType.HEATMAP:return n.HeatmapTechnique;case D.WGLSymbologyType.PIE_CHART:return l.PieChartTechnique}}return C.Technique};q.getTechniqueFromRenderer=function(d){switch(d.type){case "dot-density":return A.DotDensityTechnique;
case "heatmap":return n.HeatmapTechnique;case "pie-chart":return l.PieChartTechnique;default:return C.Technique}};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/techniques/Technique":function(){define(["exports","../../../../../core/maybe"],function(q,t){let D=function(){function E(){}E.getStorageSpec=function(C){return null};E.createOrUpdateRendererSchema=function(C,A){return t.isSome(C)&&"default"===C.type?C:{type:"default"}};
E.getVariation=function(C){return{}};E.getVariationHash=function(C){return 0};return E}();D.type="default";D.programSpec=null;q.Technique=D;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/techniques/dotDensity/TechniqueDotDensity":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../color ../../definitions ../Technique ../../../../../webgl/enums".split(" "),function(q,
t,D,E,C,A,n){A=function(l){function d(){return l.apply(this,arguments)||this}t._inheritsLoose(d,l);d.getStorageSpec=function({attributes:a}){return{visualVariables:!1,attributes:null!=a?a:null}};d._createRendererSchema=function(){return{type:"dot-density",colors:new Float32Array(32),dotValue:-1,dotSize:-1,dotScale:-1,dotBlending:!1,backgroundColor:new Float32Array(4),activeDots:new Float32Array(8),seed:-1}};d.createOrUpdateRendererSchema=function(a,b){const {attributes:c,dotValue:f,referenceScale:h,
dotSize:p,dotBlendingEnabled:k,seed:e,backgroundColor:m}=b;a=D.isSome(a)&&"dot-density"===a.type?a:this._createRendererSchema();a.dotValue=f;a.dotSize=p;a.dotScale=h;a.dotBlending=k;a.seed=e;const {colors:r,activeDots:v,backgroundColor:x}=a;for(var g=0;g<C.DOT_DENSITY_MAX_FIELDS;g++)E.writeColor(r,g>=c.length?null:c[g].color,4*g);for(g=0;8>g;g++)v[g]=g<b.attributes.length?1:0;E.writeColor(x,m);return a};d.getVariation=function(a){return{ddDotBlending:a.dotBlending}};d.getVariationHash=function(a){return a.dotBlending?
1:0};return d}(A.Technique);A.type="dot-density";A.programSpec={shader:"materials/fill",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:n.DataType.SHORT},{location:1,name:"a_id",count:3,type:n.DataType.UNSIGNED_BYTE},{location:2,name:"a_bitset",count:1,type:n.DataType.UNSIGNED_BYTE},{location:3,name:"a_inverseArea",count:1,type:n.DataType.FLOAT}]}};q.DotDensityTechnique=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/techniques/heatmap/TechniqueHeatmap":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../renderers/support/heatmapUtils ../Technique ../../../../../webgl/enums".split(" "),
function(q,t,D,E,C,A,n){A=function(l){function d(){return l.apply(this,arguments)||this}t._inheritsLoose(d,l);d.getStorageSpec=function({field:a,valueExpression:b}){return{visualVariables:!1,attributes:a||b?[{field:a,valueExpression:b}]:null}};d._createRendererSchema=function(){return{type:"heatmap",radius:-1,referenceScale:-1,isFieldActive:0,minDensity:-1,densityRange:-1,kernel:null,gradient:null,gradientHash:"invalid"}};d.createOrUpdateRendererSchema=function(a,b){const {radius:c,minDensity:f,maxDensity:h,
referenceScale:p,field:k,valueExpression:e,colorStops:m}=b;b=h-f;const r=k||e?1:0,v=m.map(({color:u,ratio:y})=>`${y}:${u.toString()}`).join();let x=!0,g;D.isSome(a)&&"heatmap"===a.type?(g=a,x=v!==a.gradientHash):g=this._createRendererSchema();g.radius=E.pt2px(c);g.minDensity=f;g.densityRange=b;g.referenceScale=p;g.isFieldActive=r;x&&(g.gradient=C.generateGradient(m),g.gradientHash=v);return g};return d}(A.Technique);A.type="heatmap";A.programSpec={shader:"materials/icon/heatmapAccumulate",vertexLayout:{geometry:[{location:0,
name:"a_pos",count:2,type:n.DataType.SHORT},{location:1,name:"a_vertexOffset",count:2,type:n.DataType.SHORT},{location:4,name:"a_id",count:4,type:n.DataType.UNSIGNED_BYTE}]}};q.HeatmapTechnique=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/techniques/pieChart/TechniquePieChart":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../Color ../../../../../../core/maybe ../../../../../../core/screenUtils ../../color ../../definitions ../Technique ../../../../../webgl/enums".split(" "),
function(q,t,D,E,C,A,n,l,d){l=function(a){function b(){return a.apply(this,arguments)||this}t._inheritsLoose(b,a);b.getStorageSpec=function({attributes:c}){return{visualVariables:!0,attributes:null!=c?c:null}};b._createRendererSchema=function(){return{type:"pie-chart",colors:new Float32Array(4*n.CHART_MAX_FIELDS),defaultColor:new Float32Array(4),othersColor:new Float32Array(4),outlineColor:new Float32Array(4),holePercentage:0,sectorThreshold:0,outlineWidth:1,numberOfFields:10}};b.createOrUpdateRendererSchema=
function(c,f){const {attributes:h,defaultColor:p,holePercentage:k,othersCategory:e,outline:m}=f;c=E.isSome(c)&&"pie-chart"===c.type?c:this._createRendererSchema();for(f=0;f<n.CHART_MAX_FIELDS;f++){const r=f>=h.length?new D([0,0,0,0]):h[f].color;A.writeColor(c.colors,r,4*f)}A.writeColor(c.defaultColor,p);A.writeColor(c.othersColor,null==e?void 0:e.color);A.writeColor(c.outlineColor,null==m?void 0:m.color);c.outlineWidth=C.pt2px((null==m?void 0:m.width)||0);c.holePercentage=k;c.sectorThreshold=(null==
e?void 0:e.threshold)||0;c.numberOfFields=h.length;return c};b.getVariation=function(c){return{numberOfFields:c.numberOfFields}};b.getVariationHash=function(c){return c.numberOfFields};return b}(l.Technique);l.type="pie-chart";l.programSpec={shader:"materials/pie",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:d.DataType.SHORT},{location:1,name:"a_vertexOffset",count:2,type:d.DataType.SHORT},{location:2,name:"a_texCoords",count:2,type:d.DataType.UNSIGNED_SHORT},{location:3,name:"a_bitSetAndDistRatio",
count:2,type:d.DataType.UNSIGNED_SHORT},{location:4,name:"a_id",count:4,type:d.DataType.UNSIGNED_BYTE},{location:5,name:"a_color",count:4,type:d.DataType.UNSIGNED_BYTE,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:d.DataType.UNSIGNED_BYTE,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:d.DataType.UNSIGNED_BYTE},{location:8,name:"a_zoomRange",count:2,type:d.DataType.UNSIGNED_SHORT}]},hittestAttributes:["a_vertexOffset","a_texCoords"]};q.PieChartTechnique=l;Object.defineProperties(q,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/brushes/WGLBrushHeatmap":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Logger ../../../../../core/maybe ../enums ../VertexStream ./WGLGeometryBrushMarker ../techniques/utils ../../../../webgl/context-util ../../../../webgl/enums ../../../../webgl/FramebufferObject ../../../../webgl/Texture".split(" "),function(q,t,D,E,C,A,n,l,d,a,b){const c=t.getLogger("esri.views.2d.engine.webgl.brushes.WGLBrushHeatmap"),
f={vsPath:"heatmap/heatmapResolve",fsPath:"heatmap/heatmapResolve",attributes:new Map([["a_position",0]])};return function(h){function p(){return h.apply(this,arguments)||this}q._inheritsLoose(p,h);var k=p.prototype;k.supportsSymbology=function(e){return e===E.WGLSymbologyType.HEATMAP};k.dispose=function(){h.prototype.dispose.call(this);this._accumulateOutputTexture=D.disposeMaybe(this._accumulateOutputTexture);this._accumulateFramebuffer=D.disposeMaybe(this._accumulateFramebuffer);this._resolveGradientTexture=
D.disposeMaybe(this._resolveGradientTexture);this._tileQuad=D.disposeMaybe(this._tileQuad)};k.drawGeometry=function(e,m,r,v){const {defines:x}=this._loadQualityProfile(e.context);h.prototype.drawGeometry.call(this,e,m,r,v?[...v,...x]:x)};k._drawMarkers=function(e,m,r,v,x,g,u){const {context:y}=e,z=y.getBoundFramebufferObject(),w=y.getViewport();this._prepareAccumulatePass(e,m,r,u);y.drawElements(v,x,d.DataType.UNSIGNED_INT,g);u||this._drawResolvePass(e,m,z,w)};k._prepareAccumulatePass=function(e,
m,r,v){const {context:x,rendererInfo:g,state:u,displayLevel:y}=e;({rendererSchema:e}=g);n.assertRendererSchema(e,"heatmap");const {referenceScale:z,radius:w,isFieldActive:B}=e;this._loadResources(x);this._updateResources(e);r.setUniform1f("u_radius",w*(0!==z?z/u.scale:1)*2**(m.key.level-y));v||(x.bindFramebuffer(this._accumulateFramebuffer),r.setUniform1f("u_isFieldActive",B),x.setViewport(0,0,this._accumulateFramebuffer.width,this._accumulateFramebuffer.height),x.setBlendingEnabled(!0),x.setBlendFunction(d.BlendFactor.ONE,
d.BlendFactor.ONE),x.setClearColor(0,0,0,0),x.clear(d.ClearBufferBit.COLOR_BUFFER_BIT))};k._drawResolvePass=function(e,m,r,v){const {context:x,painter:g,rendererInfo:u}=e;var {rendererSchema:y}=u;n.assertRendererSchema(y,"heatmap");const {radius:z,minDensity:w,densityRange:B}=y;({defines:y}=this._loadQualityProfile(x));y=g.materialManager.getProgram(f,y);x.useProgram(y);this._setSharedUniforms(y,e,m);x.bindFramebuffer(r);x.setViewport(0,0,v.width,v.height);x.setBlendFunction(d.BlendFactor.ONE,d.BlendFactor.ONE_MINUS_SRC_ALPHA);
x.bindTexture(this._accumulateOutputTexture,8);x.bindTexture(this._resolveGradientTexture,9);y.setUniform1i("u_texture",8);y.setUniform1i("u_gradient",9);y.setUniform2f("u_densityMinAndInvRange",w,1/B);y.setUniform1f("u_densityNormalization",3/(z*z*Math.PI));this._tileQuad.draw()};k._loadResources=function(e){var m,r,v,x;const g=e.type===l.ContextType.WEBGL2,{dataType:u,samplingMode:y,shadingRate:z}=this._loadQualityProfile(e);null!=(m=this._accumulateOutputTexture)?m:this._accumulateOutputTexture=
new b.Texture(e,{target:d.TextureType.TEXTURE_2D,pixelFormat:g?d.PixelFormat.RED:d.PixelFormat.RGBA,internalFormat:g?u===d.PixelType.FLOAT?d.SizedPixelFormat.R32F:d.SizedPixelFormat.R16F:d.PixelFormat.RGBA,dataType:u,samplingMode:y,wrapMode:d.TextureWrapMode.CLAMP_TO_EDGE,width:Math.round(512*z),height:Math.round(512*z)});null!=(r=this._accumulateFramebuffer)?r:this._accumulateFramebuffer=new a.FramebufferObject(e,{},this._accumulateOutputTexture);null!=(v=this._resolveGradientTexture)?v:this._resolveGradientTexture=
new b.Texture(e,{target:d.TextureType.TEXTURE_2D,pixelFormat:d.PixelFormat.RGBA,dataType:d.PixelType.UNSIGNED_BYTE,samplingMode:d.TextureSamplingMode.LINEAR,wrapMode:d.TextureWrapMode.CLAMP_TO_EDGE});null!=(x=this._tileQuad)?x:this._tileQuad=new C(e,[0,0,1,0,0,1,1,1])};k._updateResources=function(e){const {gradientHash:m,gradient:r}=e;this._prevGradientHash!==m&&(this._resolveGradientTexture.resize(r.length/4,1),this._resolveGradientTexture.setData(r),this._prevGradientHash=m)};k._loadQualityProfile=
function(e){if(D.isNone(this._qualityProfile)){const {textureFloat:m,colorBufferFloat:r}=e.capabilities,{textureFloat:v,textureFloatLinear:x,textureHalfFloat:g,textureHalfFloatLinear:u,HALF_FLOAT:y}=m,{textureFloat:z,textureHalfFloat:w,floatBlend:B}=r;let F,G;e=v&&z&&B;const H=g&&w;e&&x?(F=d.PixelType.FLOAT,G=d.TextureSamplingMode.LINEAR):H&&u?(F=y,G=d.TextureSamplingMode.LINEAR):e?(F=d.PixelType.FLOAT,G=d.TextureSamplingMode.NEAREST):H?(F=y,G=d.TextureSamplingMode.NEAREST):c.error("Missing webgl extensions for heatmap!");
G===d.TextureSamplingMode.NEAREST&&c.warnOnce("Missing linear filtering webgl extension(s). Heatmap quality may be reduced.");this._qualityProfile={dataType:F,samplingMode:G,shadingRate:.5,defines:F===y?["heatmapPrecisionHalfFloat"]:[]}}return this._qualityProfile};return p}(A)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushMarker":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../techniques/utils ../../../../webgl/enums".split(" "),
function(q,t,D,E,C,A,n,l){const d={shader:"materials/icon",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:l.DataType.SHORT},{location:1,name:"a_vertexOffset",count:2,type:l.DataType.SHORT},{location:2,name:"a_texCoords",count:2,type:l.DataType.UNSIGNED_SHORT},{location:3,name:"a_bitSetAndDistRatio",count:2,type:l.DataType.UNSIGNED_SHORT},{location:4,name:"a_id",count:4,type:l.DataType.UNSIGNED_BYTE},{location:5,name:"a_color",count:4,type:l.DataType.UNSIGNED_BYTE,normalized:!0},{location:6,
name:"a_outlineColor",count:4,type:l.DataType.UNSIGNED_BYTE,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:l.DataType.UNSIGNED_BYTE},{location:8,name:"a_zoomRange",count:2,type:l.DataType.UNSIGNED_SHORT}]},hittestAttributes:["a_vertexOffset","a_texCoords"]};return function(a){function b(){return a.apply(this,arguments)||this}q._inheritsLoose(b,a);var c=b.prototype;c.dispose=function(){};c.getGeometryType=function(){return D.WGLGeometryType.MARKER};c.supportsSymbology=function(f){return f!==
D.WGLSymbologyType.HEATMAP&&f!==D.WGLSymbologyType.PIE_CHART};c.drawGeometry=function(f,h,p,k){const {context:e,painter:m,rendererInfo:r,state:v,passOptions:x,requestRender:g}=f;var u=A.MarkerMaterialKey.load(p.materialKey),y=n.getTechniqueFromMaterialKey(u.data);const z=t.isSome(x)&&"hittest"===x.type,{shader:w,vertexLayout:B,hittestAttributes:F}=t.unwrapOr(y.programSpec,d);y=l.PrimitiveType.TRIANGLES;var G=E.createProgramDescriptor(u.data,B);z&&(G=this._getTriangleDesc(p.materialKey,G,F),y=l.PrimitiveType.POINTS);
const {attributes:H,bufferLayouts:I}=G;k=m.materialManager.getMaterialProgram(f,u,w,H,k);!t.isSome(g)||z||k.isCompiled?(e.useProgram(k),u.textureBinding&&m.textureManager.bindTextures(e,k,u,!0),this._setSharedUniforms(k,f,h),k.setUniformMatrix3fv("u_displayMat3",u.vvRotation?v.displayViewMat3:v.displayMat3),this._setSizeVVUniforms(u,k,r,h),this._setColorAndOpacityVVUniforms(u,k,r),this._setRotationVVUniforms(u,k,r),u=p.target.getVAO(e,I,H,z),G=p.indexCount,p=p.indexFrom*Uint32Array.BYTES_PER_ELEMENT,
z&&(G/=3,p/=3),e.bindVAO(u),this._drawMarkers(f,h,k,y,G,p,z),e.bindVAO(null)):g()};c._drawMarkers=function(f,h,p,k,e,m,r){f.context.drawElements(k,e,l.DataType.UNSIGNED_INT,m)};return b}(C)})},"esri/views/2d/engine/webgl/brushes/WGLBrushInfo":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec4f32 ../DefaultVertexAttributeLayouts ./WGLBrush ../shaders/BackgroundPrograms ../shaders/TileInfoPrograms ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/ProgramTemplate ../../../../webgl/Texture ../../../../webgl/VertexArrayObject".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c){return function(f){function h(){var k=f.apply(this,arguments)||this;k._color=D.fromValues(1,0,0,1);return k}q._inheritsLoose(h,f);var p=h.prototype;p.dispose=function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null);this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null);this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=null);this._tileInfoVertexArrayObject&&
(this._tileInfoVertexArrayObject.dispose(),this._tileInfoVertexArrayObject=null);this._canvas=null};p.prepareState=function({context:k}){k.setBlendingEnabled(!0);k.setBlendFunctionSeparate(d.BlendFactor.ONE,d.BlendFactor.ONE_MINUS_SRC_ALPHA,d.BlendFactor.ONE,d.BlendFactor.ONE_MINUS_SRC_ALPHA);k.setColorMask(!0,!0,!0,!0);k.setStencilWriteMask(0);k.setStencilTestEnabled(!1)};p.draw=function(k,e){const {context:m,requestRender:r}=k;if(e.isReady)if(this._loadWGLResources(m),!t.isSome(r)||this._outlineProgram.isCompiled&&
this._tileInfoProgram.isCompiled){m.bindVAO(this._outlineVertexArrayObject);m.useProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix3fv("u_dvsMat3",e.transforms.dvs);this._outlineProgram.setUniform2f("u_coord_range",e.rangeX,e.rangeY);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);m.drawArrays(d.PrimitiveType.LINE_STRIP,0,4);if(k=this._getTexture(m,e))m.bindVAO(this._tileInfoVertexArrayObject),m.useProgram(this._tileInfoProgram),
m.bindTexture(k,0),this._tileInfoProgram.setUniformMatrix3fv("u_dvsMat3",e.transforms.dvs),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform2f("u_coord_ratio",e.rangeX/e.width,e.rangeY/e.height),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",k.descriptor.width,k.descriptor.height),m.drawArrays(d.PrimitiveType.TRIANGLE_STRIP,0,4);m.bindVAO()}else r()};p._loadWGLResources=function(k){if(!this._outlineProgram||!this._tileInfoProgram){var e=
a.createProgram(k,A.background),m=a.createProgram(k,n.tileInfo),r=new Int8Array([0,0,1,0,1,1,0,1]);r=l.BufferObject.createVertex(k,d.Usage.STATIC_DRAW,r);r=new c.VertexArrayObject(k,A.background.attributes,E.Pos2b,{geometry:r});var v=new Int8Array([0,0,1,0,0,1,1,1]);v=l.BufferObject.createVertex(k,d.Usage.STATIC_DRAW,v);k=new c.VertexArrayObject(k,n.tileInfo.attributes,E.Pos2b,{geometry:v});this._outlineProgram=e;this._tileInfoProgram=m;this._outlineVertexArrayObject=r;this._tileInfoVertexArrayObject=
k}};p._getTexture=function(k,e){if(e.texture&&e.triangleCountReportedInDebug===e.triangleCount)return e.texture;e.triangleCountReportedInDebug=e.triangleCount;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width","300"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));const m=e.triangleCount;let r=e.key.id;0<e.triangleCount&&(r+=`, ${m}`);const v=this._canvas,x=v.getContext("2d");
x.font="24px sans-serif";x.textAlign="left";x.textBaseline="top";x.clearRect(0,0,300,32);1E5<m?(x.fillStyle="red",x.fillRect(0,0,300,32),x.fillStyle="black"):(x.clearRect(0,0,300,32),x.fillStyle="blue");x.fillText(r,0,0);e.texture=new b.Texture(k,{target:d.TextureType.TEXTURE_2D,pixelFormat:d.PixelFormat.RGBA,dataType:d.PixelType.UNSIGNED_BYTE,samplingMode:d.TextureSamplingMode.NEAREST,wrapMode:d.TextureWrapMode.CLAMP_TO_EDGE},v);return e.texture};return h}(C)})},"esri/views/2d/engine/webgl/DefaultVertexAttributeLayouts":function(){define(["exports",
"../../../webgl/enums","../../../webgl/VertexElementDescriptor"],function(q,t,D){const E={geometry:[new D.VertexElementDescriptor("a_pos",2,t.DataType.BYTE,0,2)]},C={geometry:[new D.VertexElementDescriptor("a_pos",2,t.DataType.BYTE,0,4),new D.VertexElementDescriptor("a_tex",2,t.DataType.BYTE,2,4)]};t={geometry:[new D.VertexElementDescriptor("a_pos",2,t.DataType.UNSIGNED_SHORT,0,4)]};q.Pos2b=E;q.Pos2us=t;q.PosTex2b=C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/engine/webgl/shaders/TileInfoPrograms":function(){define(["exports","./sources/resolver"],function(q,t){t={shaders:{vertexShader:t.resolveIncludes("tileInfo/tileInfo.vert"),fragmentShader:t.resolveIncludes("tileInfo/tileInfo.frag")},attributes:new Map([["a_pos",0]])};q.tileInfo=t;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/brushes/WGLBrushPieChart":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers",
"../enums","./WGLGeometryBrushMarker","../techniques/utils","../../../../webgl/enums"],function(q,t,D,E,C){return function(A){function n(){return A.apply(this,arguments)||this}q._inheritsLoose(n,A);var l=n.prototype;l.supportsSymbology=function(d){return d===t.WGLSymbologyType.PIE_CHART};l._drawMarkers=function(d,a,b,c,f,h,p){({context:a}=d);({rendererInfo:d}=d);({rendererSchema:d}=d);E.assertRendererSchema(d,"pie-chart");b.setUniform4fv("u_colors",d.colors);b.setUniform4fv("u_defaultColor",d.defaultColor);
b.setUniform4fv("u_othersColor",d.othersColor);b.setUniform4fv("u_outlineColor",d.outlineColor);b.setUniform1f("u_donutRatio",d.holePercentage);b.setUniform1f("u_sectorThreshold",d.sectorThreshold);b.setUniform1f("u_outlineWidth",d.outlineWidth);a.drawElements(c,f,C.DataType.UNSIGNED_INT,h)};return n}(D)})},"esri/views/2d/engine/webgl/brushes/WGLBrushStencil":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec4f32 ../DefaultVertexAttributeLayouts ./WGLBrush ../shaders/BackgroundPrograms ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/ProgramTemplate ../../../../webgl/VertexArrayObject".split(" "),
function(q,t,D,E,C,A,n,l,d,a){return function(b){function c(){var h=b.apply(this,arguments)||this;h._color=D.fromValues(1,0,0,1);h._initialized=!1;return h}q._inheritsLoose(c,b);var f=c.prototype;f.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null);this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)};f.prepareState=function({context:h},p){h.setDepthWriteEnabled(!1);h.setDepthTestEnabled(!1);h.setStencilTestEnabled(!0);
h.setBlendingEnabled(!1);h.setColorMask(!1,!1,!1,!1);h.setStencilOp(l.StencilOperation.KEEP,l.StencilOperation.KEEP,l.StencilOperation.REPLACE);h.setStencilWriteMask(255);h.setStencilFunctionSeparate(l.Face.FRONT_AND_BACK,l.CompareFunction.GREATER,p.stencilRef,255)};f.draw=function(h,p){const {context:k,requestRender:e}=h;this._initialized||this._initialize(k);t.isSome(e)&&!this._solidProgram.isCompiled?e():(k.bindVAO(this._solidVertexArrayObject),k.useProgram(this._solidProgram),this._solidProgram.setUniformMatrix3fv("u_dvsMat3",
p.transforms.dvs),this._solidProgram.setUniform2fv("u_coord_range",[p.rangeX,p.rangeY]),this._solidProgram.setUniform1f("u_depth",0),this._solidProgram.setUniform4fv("u_color",this._color),k.drawArrays(l.PrimitiveType.TRIANGLE_STRIP,0,4),k.bindVAO())};f._initialize=function(h){if(this._initialized)return!0;const p=d.createProgram(h,A.background);if(!p)return!1;var k=new Int8Array([0,0,1,0,0,1,1,1]);k=n.BufferObject.createVertex(h,l.Usage.STATIC_DRAW,k);h=new a.VertexArrayObject(h,A.background.attributes,
E.Pos2b,{geometry:k});this._solidProgram=p;this._solidVertexArrayObject=h;return this._initialized=!0};return c}(C)})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLBackground":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../chunks/mat3f32 ../../../../../chunks/vec4f32 ../definitions ../enums ../number ./WGLBrush ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/VertexArrayObject".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c,f){a=function(h){function p(){var e=h.apply(this,arguments)||this;e._color=A.fromValues(1,0,0,1);e._patternMatrix=C.create();e._programOptions={id:!1,pattern:!1};return e}t._inheritsLoose(p,h);var k=p.prototype;k.dispose=function(){this._vao&&(this._vao.dispose(),this._vao=null)};k.drawMany=function(e,m){const {context:r,painter:v,styleLayerUID:x,requestRender:g}=e;this._loadWGLResources(e);const u=e.displayLevel;var y=e.styleLayer,z=y.backgroundMaterial;const w=v.vectorTilesMaterialManager;
var B=y.getPaintValue("background-color",u);const F=y.getPaintValue("background-opacity",u),G=y.getPaintValue("background-pattern",u),H=void 0!==G,I=B[3]*F,L=e.spriteMosaic;let N,J;const K=(window.devicePixelRatio|1)>n.VTL_HIGH_RES_CUTOFF?2:1;e=e.drawPhase===l.WGLDrawPhase.HITTEST;const O=this._programOptions;O.id=e;O.pattern=H;z=w.getMaterialProgram(r,z,O);if(!E.isSome(g)||e||z.isCompiled){r.bindVAO(this._vao);r.useProgram(z);if(H){B=L.getMosaicItemPosition(G,!0);if(E.isSome(B)){const {tl:W,br:aa,
page:ba}=B;N=aa[0]-W[0];J=aa[1]-W[1];B=L.getPageSize(ba);E.isSome(B)&&(L.bind(r,c.TextureSamplingMode.LINEAR,ba,n.VTL_TEXTURE_BINDING_UNIT_SPRITES),z.setUniform4f("u_tlbr",W[0],W[1],aa[0],aa[1]),z.setUniform2fv("u_mosaicSize",B),z.setUniform1i("u_texture",n.VTL_TEXTURE_BINDING_UNIT_SPRITES))}z.setUniform1f("u_opacity",F)}else this._color[0]=I*B[0],this._color[1]=I*B[1],this._color[2]=I*B[2],this._color[3]=I,z.setUniform4fv("u_color",this._color);z.setUniform1f("u_depth",y.z||0);e&&(y=d.u32to4Xu8(x+
1),z.setUniform4fv("u_id",y));for(const W of m)z.setUniform1f("u_coord_range",W.rangeX),z.setUniformMatrix3fv("u_dvsMat3",W.transforms.dvs),H&&(y=K*W.width*Math.max(2**(Math.round(u)-W.key.level),1),m=y/D.nextPowerOfTwo(N),y/=D.nextPowerOfTwo(J),this._patternMatrix[0]=m,this._patternMatrix[4]=y,z.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),r.setStencilFunction(c.CompareFunction.EQUAL,W.stencilRef,255),r.drawArrays(c.PrimitiveType.TRIANGLE_STRIP,0,4)}else g()};k._loadWGLResources=
function(e){if(!this._vao){var {context:m,styleLayer:r}=e;e=r.backgroundMaterial;var v=new Int8Array([0,0,1,0,0,1,1,1]);v=b.BufferObject.createVertex(m,c.Usage.STATIC_DRAW,v);this._vao=new f.VertexArrayObject(m,e.getAttributeLocations(),e.getLayoutInfo(),{geometry:v})}};return p}(a);q.WGLBrushVTLBackground=a;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLCircle":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../vectorTiles/style/StyleDefinition ../enums ../number ./WGLBrush ../../../../webgl/enums".split(" "),
function(q,t,D,E,C,A,n,l){n=function(d){function a(){var c=d.apply(this,arguments)||this;c._programOptions={id:!1};return c}t._inheritsLoose(a,d);var b=a.prototype;b.dispose=function(){};b.drawMany=function(c,f){const {context:h,displayLevel:p,requiredLevel:k,state:e,drawPhase:m,painter:r,spriteMosaic:v,styleLayerUID:x,requestRender:g}=c;if(f.some(G=>{var H,I;return null!=(H=null==(I=G.layerData.get(x))?void 0:I.circleIndexCount)?H:!1})){c=c.styleLayer;var u=c.circleMaterial,y=r.vectorTilesMaterialManager,
z=c.getPaintValue("circle-translate",p),w=c.getPaintValue("circle-translate-anchor",p),B=m===C.WGLDrawPhase.HITTEST,F=this._programOptions;F.id=B;y=y.getMaterialProgram(h,u,F);if(B||!D.isSome(g)||y.isCompiled){h.useProgram(y);y.setUniformMatrix3fv("u_displayMat3",w===E.TranslateAnchor.VIEWPORT?e.displayMat3:e.displayViewMat3);y.setUniform2fv("u_circleTranslation",z);y.setUniform1f("u_depth",c.z);y.setUniform1f("u_antialiasingWidth",1.2);z=-1;B&&(B=A.u32to4Xu8(x+1),y.setUniform4fv("u_id",B));for(const G of f)G.layerData.has(x)&&
(G.key.level!==z&&(z=G.key.level,u.setDataUniforms(y,p,c,z,v)),f=G.layerData.get(x),f.circleIndexCount&&(f.prepareForRendering(h),B=f.circleVertexArrayObject,D.isNone(B)||(h.bindVAO(B),y.setUniformMatrix3fv("u_dvsMat3",G.transforms.dvs),k!==G.key.level?h.setStencilFunction(l.CompareFunction.EQUAL,G.stencilRef,255):h.setStencilFunction(l.CompareFunction.GREATER,255,255),h.drawElements(l.PrimitiveType.TRIANGLES,f.circleIndexCount,l.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*f.circleIndexStart),
G.triangleCount+=f.circleIndexCount/3)))}else g()}};return a}(n);q.WGLBrushVTLCircle=n;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/vectorTiles/style/StyleDefinition":function(){define(["exports","../../../../../symbols/cim/enums"],function(q,t){q.StyleLayerType=void 0;(function(E){E[E.BACKGROUND=0]="BACKGROUND";E[E.FILL=1]="FILL";E[E.LINE=2]="LINE";E[E.SYMBOL=3]="SYMBOL";E[E.CIRCLE=4]="CIRCLE"})(q.StyleLayerType||(q.StyleLayerType=
{}));q.Visibility=void 0;(function(E){E[E.VISIBLE=0]="VISIBLE";E[E.NONE=1]="NONE"})(q.Visibility||(q.Visibility={}));q.SymbolPlacement=void 0;(function(E){E[E.POINT=0]="POINT";E[E.LINE=1]="LINE";E[E.LINE_CENTER=2]="LINE_CENTER"})(q.SymbolPlacement||(q.SymbolPlacement={}));q.RotationAlignment=void 0;(function(E){E[E.MAP=0]="MAP";E[E.VIEWPORT=1]="VIEWPORT";E[E.AUTO=2]="AUTO"})(q.RotationAlignment||(q.RotationAlignment={}));q.TextJustification=void 0;(function(E){E[E.AUTO=0]="AUTO";E[E.LEFT=1]="LEFT";
E[E.CENTER=2]="CENTER";E[E.RIGHT=3]="RIGHT"})(q.TextJustification||(q.TextJustification={}));q.SymbolAnchor=void 0;(function(E){E[E.CENTER=0]="CENTER";E[E.LEFT=1]="LEFT";E[E.RIGHT=2]="RIGHT";E[E.TOP=3]="TOP";E[E.BOTTOM=4]="BOTTOM";E[E.TOP_LEFT=5]="TOP_LEFT";E[E.TOP_RIGHT=6]="TOP_RIGHT";E[E.BOTTOM_LEFT=7]="BOTTOM_LEFT";E[E.BOTTOM_RIGHT=8]="BOTTOM_RIGHT"})(q.SymbolAnchor||(q.SymbolAnchor={}));q.TextTransform=void 0;(function(E){E[E.NONE=0]="NONE";E[E.UPPERCASE=1]="UPPERCASE";E[E.LOWERCASE=2]="LOWERCASE"})(q.TextTransform||
(q.TextTransform={}));q.TranslateAnchor=void 0;(function(E){E[E.MAP=0]="MAP";E[E.VIEWPORT=1]="VIEWPORT"})(q.TranslateAnchor||(q.TranslateAnchor={}));q.TextWritingMode=void 0;(function(E){E[E.HORIZONTAL=0]="HORIZONTAL";E[E.VERTICAL=1]="VERTICAL"})(q.TextWritingMode||(q.TextWritingMode={}));let D=function(){};D.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:q.Visibility.VISIBLE}};D.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:q.Visibility.VISIBLE}};
D.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:q.Visibility.VISIBLE},"line-cap":{type:"enum",values:["butt","round","square"],default:t.CapType.BUTT},"line-join":{type:"enum",values:["bevel","round","miter"],default:t.JoinType.MITER},"line-miter-limit":{type:"number",default:2},"line-round-limit":{type:"number",default:1.05}};D.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:q.Visibility.VISIBLE},"symbol-avoid-edges":{type:"boolean",
default:!1},"symbol-placement":{type:"enum",values:["point","line","line-center"],default:q.SymbolPlacement.POINT},"symbol-sort-key":{type:"number",default:-1},"symbol-spacing":{type:"number",minimum:1,default:250},"icon-allow-overlap":{type:"boolean",default:!1},"icon-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),default:q.SymbolAnchor.CENTER},"icon-ignore-placement":{type:"boolean",default:!1},"icon-image":{type:"string"},"icon-keep-upright":{type:"boolean",
default:!1},"icon-offset":{type:"array",value:"number",length:2,default:[0,0]},"icon-optional":{type:"boolean",default:!1},"icon-padding":{type:"number",minimum:0,default:2},"icon-rotate":{type:"number",default:0},"icon-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:q.RotationAlignment.AUTO},"icon-size":{type:"number",minimum:0,default:1},"text-allow-overlap":{type:"boolean",default:!1},"text-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),
default:q.SymbolAnchor.CENTER},"text-field":{type:"string"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"]},"text-ignore-placement":{type:"boolean",default:!1},"text-justify":{type:"enum",values:["auto","left","center","right"],default:q.TextJustification.CENTER},"text-keep-upright":{type:"boolean",default:!0},"text-letter-spacing":{type:"number",default:0},"text-line-height":{type:"number",default:1.2},"text-max-angle":{type:"number",minimum:0,default:45},
"text-max-width":{type:"number",minimum:0,default:10},"text-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-optional":{type:"boolean",default:!1},"text-padding":{type:"number",minimum:0,default:2},"text-rotate":{type:"number",default:0},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:q.RotationAlignment.AUTO},"text-size":{type:"number",minimum:0,default:16},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],default:q.TextTransform.NONE},
"text-writing-mode":{type:"array",value:"enum",values:["horizontal","vertical"],default:[q.TextWritingMode.HORIZONTAL]}};D.circleLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:q.Visibility.VISIBLE}};D.backgroundPaintDefinition={"background-color":{type:"color",default:[0,0,0,1]},"background-opacity":{type:"number",minimum:0,maximum:1,default:1},"background-pattern":{type:"string"}};D.fillPaintDefinition={"fill-antialias":{type:"boolean",default:!0},"fill-color":{type:"color",
default:[0,0,0,1]},"fill-opacity":{type:"number",minimum:0,maximum:1,default:1},"fill-outline-color":{type:"color",default:[0,0,0,0]},"fill-pattern":{type:"string"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],default:q.TranslateAnchor.MAP}};D.linePaintDefinition={"line-blur":{type:"number",minimum:0,default:0},"line-color":{type:"color",default:[0,0,0,1]},"line-dasharray":{type:"array",value:"number",default:[]},
"line-gap-width":{type:"number",minimum:0,default:0},"line-offset":{type:"number",default:0},"line-opacity":{type:"number",minimum:0,maximum:1,default:1},"line-pattern":{type:"string"},"line-translate":{type:"array",value:"number",length:2,default:[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],default:q.TranslateAnchor.MAP},"line-width":{type:"number",minimum:0,default:1}};D.symbolPaintDefinition={"icon-color":{type:"color",default:[0,0,0,1]},"icon-halo-blur":{type:"number",
minimum:0,default:0},"icon-halo-color":{type:"color",default:[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,default:0},"icon-opacity":{type:"number",minimum:0,maximum:1,default:1},"icon-translate":{type:"array",value:"number",length:2,default:[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],default:q.TranslateAnchor.MAP},"text-color":{type:"color",default:[0,0,0,1]},"text-halo-blur":{type:"number",minimum:0,default:0},"text-halo-color":{type:"color",default:[0,0,0,0]},
"text-halo-width":{type:"number",minimum:0,default:0},"text-opacity":{type:"number",minimum:0,maximum:1,default:1},"text-translate":{type:"array",value:"number",length:2,default:[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],default:q.TranslateAnchor.MAP}};D.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,default:1},"raster-hue-rotate":{type:"number",default:0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,default:0},"raster-brightness-max":{type:"number",
minimum:0,maximum:1,default:1},"raster-saturation":{type:"number",minimum:-1,maximum:1,default:0},"raster-contrast":{type:"number",minimum:-1,maximum:1,default:0},"raster-fade-duration":{type:"number",minimum:0,default:300}};D.circlePaintDefinition={"circle-blur":{type:"number",minimum:0,default:0},"circle-color":{type:"color",default:[0,0,0,1]},"circle-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-radius":{type:"number",minimum:0,default:5},"circle-stroke-color":{type:"color",default:[0,
0,0,1]},"circle-stroke-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-stroke-width":{type:"number",minimum:0,default:0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],default:q.TranslateAnchor.MAP}};q.StyleDefinition=D;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLFill":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../vectorTiles/style/StyleDefinition ../definitions ../enums ../number ./WGLBrush ../../../../webgl/enums".split(" "),
function(q,t,D,E,C,A,n,l,d){const a=1/65536;l=function(b){function c(){var h=b.apply(this,arguments)||this;h._fillProgramOptions={id:!1,pattern:!1};h._outlineProgramOptions={id:!1};return h}t._inheritsLoose(c,b);var f=c.prototype;f.dispose=function(){};f.drawMany=function(h,p){const {displayLevel:k,drawPhase:e,renderPass:m,spriteMosaic:r,styleLayerUID:v}=h;var x=!1;for(var g of p)if(g.layerData.has(v)){var u=g.layerData.get(v);if(0<u.fillIndexCount||0<u.outlineIndexCount){x=!0;break}}if(x){x=h.styleLayer;
var y=x.getPaintProperty("fill-pattern");u=(g=void 0!==y)&&y.isDataDriven;if(g&&!u){var z=y.getValue(k);z=r.getMosaicItemPosition(z,!0)}y=!g&&x.getPaintValue("fill-antialias",k);var w=!0,B=1;if(!g){var F=x.getPaintProperty("fill-color"),G=x.getPaintProperty("fill-opacity");null!=F&&F.isDataDriven||null!=G&&G.isDataDriven||(B=x.getPaintValue("fill-color",k),B=x.getPaintValue("fill-opacity",k)*B[3],1<=B&&(w=!1))}if(!w||"opaque"!==m){var H;e===A.WGLDrawPhase.HITTEST&&(H=n.u32to4Xu8(v+1));F=x.getPaintValue("fill-translate",
k);G=x.getPaintValue("fill-translate-anchor",k);(w||"translucent"!==m)&&this._drawFill(h,v,x,p,F,G,g,z,u,H);z=!x.hasDataDrivenOutlineColor&&x.outlineUsesFillColor&&1>B;y&&"opaque"!==m&&!z&&this._drawOutline(h,v,x,p,F,G,H)}}};f._drawFill=function(h,p,k,e,m,r,v,x,g,u){if(!v||g||!D.isNone(x)){var {context:y,displayLevel:z,state:w,drawPhase:B,painter:F,pixelRatio:G,spriteMosaic:H,requestRender:I}=h;h=k.fillMaterial;var L=F.vectorTilesMaterialManager,N=G>C.VTL_HIGH_RES_CUTOFF?2:1,J=B===A.WGLDrawPhase.HITTEST,
K=this._fillProgramOptions;K.id=J;K.pattern=v;L=L.getMaterialProgram(y,h,K);if(!D.isSome(I)||J||L.isCompiled){y.useProgram(L);D.isSome(x)&&({page:x}=x,K=H.getPageSize(x),D.isSome(K)&&(H.bind(y,d.TextureSamplingMode.LINEAR,x,C.VTL_TEXTURE_BINDING_UNIT_SPRITES),L.setUniform2fv("u_mosaicSize",K),L.setUniform1i("u_texture",C.VTL_TEXTURE_BINDING_UNIT_SPRITES)));L.setUniformMatrix3fv("u_displayMat3",r===E.TranslateAnchor.VIEWPORT?w.displayMat3:w.displayViewMat3);L.setUniform2fv("u_fillTranslation",m);L.setUniform1f("u_depth",
k.z+a);J&&L.setUniform4fv("u_id",u);m=-1;for(const O of e)if(O.layerData.has(p)&&(O.key.level!==m&&(m=O.key.level,h.setDataUniforms(L,z,k,m,H)),e=O.layerData.get(p),e.fillIndexCount&&(e.prepareForRendering(y),r=e.fillVertexArrayObject,!D.isNone(r)))){y.bindVAO(r);L.setUniformMatrix3fv("u_dvsMat3",O.transforms.dvs);y.setStencilFunction(d.CompareFunction.EQUAL,O.stencilRef,255);v&&L.setUniform1f("u_patternFactor",O.rangeX/(N*O.width*Math.max(2**(Math.round(z)-O.key.level),1)));if(g){r=e.patternMap;
if(!r)continue;for(const [W,aa]of r)r=H.getPageSize(W),D.isSome(r)&&(H.bind(y,d.TextureSamplingMode.LINEAR,W,C.VTL_TEXTURE_BINDING_UNIT_SPRITES),L.setUniform2fv("u_mosaicSize",r),L.setUniform1i("u_texture",C.VTL_TEXTURE_BINDING_UNIT_SPRITES),y.drawElements(d.PrimitiveType.TRIANGLES,aa[1],d.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*aa[0]))}else y.drawElements(d.PrimitiveType.TRIANGLES,e.fillIndexCount,d.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*e.fillIndexStart);O.triangleCount+=
e.fillIndexCount/3}}else I()}};f._drawOutline=function(h,p,k,e,m,r,v){const {context:x,displayLevel:g,state:u,drawPhase:y,painter:z,pixelRatio:w,spriteMosaic:B,requestRender:F}=h;h=k.outlineMaterial;var G=z.vectorTilesMaterialManager;const H=.75/w,I=y===A.WGLDrawPhase.HITTEST,L=this._outlineProgramOptions;L.id=I;G=G.getMaterialProgram(x,h,L);if(!D.isSome(F)||I||G.isCompiled){x.useProgram(G);G.setUniformMatrix3fv("u_displayMat3",r===E.TranslateAnchor.VIEWPORT?u.displayMat3:u.displayViewMat3);G.setUniform2fv("u_fillTranslation",
m);G.setUniform1f("u_depth",k.z+a);G.setUniform1f("u_outline_width",H);I&&G.setUniform4fv("u_id",v);m=-1;for(const N of e)N.layerData.has(p)&&(N.key.level!==m&&(m=N.key.level,h.setDataUniforms(G,g,k,m,B)),e=N.layerData.get(p),e.prepareForRendering(x),e.outlineIndexCount&&(r=e.outlineVertexArrayObject,D.isNone(r)||(x.bindVAO(r),G.setUniformMatrix3fv("u_dvsMat3",N.transforms.dvs),x.setStencilFunction(d.CompareFunction.EQUAL,N.stencilRef,255),x.drawElements(d.PrimitiveType.TRIANGLES,e.outlineIndexCount,
d.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*e.outlineIndexStart),N.triangleCount+=e.outlineIndexCount/3)))}else F()};return c}(l);q.WGLBrushVTLFill=l;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLLine":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../vectorTiles/style/StyleDefinition ../definitions ../enums ../number ./WGLBrush ../../../../webgl/enums".split(" "),
function(q,t,D,E,C,A,n,l,d){l=function(a){function b(){var f=a.apply(this,arguments)||this;f._programOptions={id:!1,pattern:!1,sdf:!1};return f}t._inheritsLoose(b,a);var c=b.prototype;c.dispose=function(){};c.drawMany=function(f,h){const {context:p,displayLevel:k,state:e,drawPhase:m,painter:r,pixelRatio:v,spriteMosaic:x,styleLayerUID:g,requestRender:u}=f;if(h.some(O=>{var W,aa;return null!=(W=null==(aa=O.layerData.get(g))?void 0:aa.lineIndexCount)?W:!1})){f=f.styleLayer;var y=f.lineMaterial,z=r.vectorTilesMaterialManager,
w=f.getPaintValue("line-translate",k),B=f.getPaintValue("line-translate-anchor",k),F=f.getPaintProperty("line-pattern"),G=void 0!==F,H=G&&F.isDataDriven;if(G&&!H){F=F.getValue(k);var I=x.getMosaicItemPosition(F)}var L;F=!1;if(!G){var N=f.getPaintProperty("line-dasharray");F=(L=void 0!==N)&&N.isDataDriven;L&&!F&&(I=N.getValue(k),I=f.getDashKey(I,f.getLayoutValue("line-cap",k)),I=x.getMosaicItemPosition(I))}N=1/v;var J=m===A.WGLDrawPhase.HITTEST,K=this._programOptions;K.id=J;K.pattern=G;K.sdf=L;L=z.getMaterialProgram(p,
y,K);if(!D.isSome(u)||J||L.isCompiled){p.useProgram(L);L.setUniformMatrix3fv("u_displayViewMat3",e.displayViewMat3);L.setUniformMatrix3fv("u_displayMat3",B===E.TranslateAnchor.VIEWPORT?e.displayMat3:e.displayViewMat3);L.setUniform2fv("u_lineTranslation",w);L.setUniform1f("u_depth",f.z);L.setUniform1f("u_antialiasing",N);J&&(w=n.u32to4Xu8(g+1),L.setUniform4fv("u_id",w));I&&D.isSome(I)&&({page:w}=I,B=x.getPageSize(w),D.isSome(B)&&(x.bind(p,d.TextureSamplingMode.LINEAR,w,C.VTL_TEXTURE_BINDING_UNIT_SPRITES),
L.setUniform2fv("u_mosaicSize",B),L.setUniform1i("u_texture",C.VTL_TEXTURE_BINDING_UNIT_SPRITES)));w=-1;for(const O of h)if(O.layerData.has(g)&&(O.key.level!==w&&(w=O.key.level,y.setDataUniforms(L,k,f,w,x)),L.setUniform1f("u_zoomFactor",2**(k-w)/v),h=O.layerData.get(g),h.lineIndexCount&&(h.prepareForRendering(p),B=h.lineVertexArrayObject,!D.isNone(B)))){p.bindVAO(B);L.setUniformMatrix3fv("u_dvsMat3",O.transforms.dvs);p.setStencilFunction(d.CompareFunction.EQUAL,O.stencilRef,255);if(H||F){B=h.patternMap;
if(!B)continue;for(const [W,aa]of B)B=x.getPageSize(W),D.isSome(B)&&(x.bind(p,d.TextureSamplingMode.LINEAR,W,C.VTL_TEXTURE_BINDING_UNIT_SPRITES),L.setUniform2fv("u_mosaicSize",B),L.setUniform1i("u_texture",C.VTL_TEXTURE_BINDING_UNIT_SPRITES),p.drawElements(d.PrimitiveType.TRIANGLES,aa[1],d.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*aa[0]))}else p.drawElements(d.PrimitiveType.TRIANGLES,h.lineIndexCount,d.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*h.lineIndexStart);O.triangleCount+=
h.lineIndexCount/3}}else u()}};return b}(l);q.WGLBrushVTLLine=l;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLSymbol":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec2f32 ../../vectorTiles/decluttering/config ../../vectorTiles/style/StyleDefinition ../definitions ../enums ../GeometryUtils ../number ./WGLBrush ../../../../webgl/enums".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c){const f=1/65536;b=function(h){function p(){var e=h.apply(this,arguments)||this;e._iconProgramOptions={id:!1,sdf:!1};e._sdfProgramOptions={id:!1};e._spritesTextureSize=E.create();return e}t._inheritsLoose(p,h);var k=p.prototype;k.dispose=function(){};k.drawMany=function(e,m){const {drawPhase:r,styleLayerUID:v}=e,x=e.styleLayer;let g;r===l.WGLDrawPhase.HITTEST&&(g=a.u32to4Xu8(v+1));this._drawIcons(e,x,m,g);this._drawText(e,x,m,g)};k._drawIcons=function(e,m,r,v){const {context:x,
displayLevel:g,drawPhase:u,painter:y,spriteMosaic:z,state:w,styleLayerUID:B,requestRender:F}=e,G=m.iconMaterial;var H=y.vectorTilesMaterialManager,I=!1;for(var L of r)if(L.layerData.has(B)){var N=L.layerData.get(B);if(0<N.iconPerPageElementsMap.size){I=!0;break}}if(I){I=m.getPaintValue("icon-translate",g);L=m.getPaintValue("icon-translate-anchor",g);var J=m.getLayoutValue("icon-rotation-alignment",g);J===A.RotationAlignment.AUTO&&(J=m.getLayoutValue("symbol-placement",g)===A.SymbolPlacement.POINT?
A.RotationAlignment.VIEWPORT:A.RotationAlignment.MAP);var K=J===A.RotationAlignment.MAP;K=m.getLayoutValue("icon-keep-upright",g)&&K;var O=N.isIconSDF;N=u===l.WGLDrawPhase.HITTEST;var W=this._iconProgramOptions;W.id=N;W.sdf=O;H=H.getMaterialProgram(x,G,W);if(!D.isSome(F)||N||H.isCompiled){x.useProgram(H);H.setUniformMatrix3fv("u_displayViewMat3",J===A.RotationAlignment.MAP?w.displayViewMat3:w.displayMat3);H.setUniformMatrix3fv("u_displayMat3",L===A.TranslateAnchor.VIEWPORT?w.displayMat3:w.displayViewMat3);
H.setUniform2fv("u_iconTranslation",I);H.setUniform1f("u_depth",m.z);H.setUniform1f("u_mapRotation",d.degToByte(w.rotation));H.setUniform1f("u_keepUpright",K?1:0);H.setUniform1f("u_level",10*g);H.setUniform1i("u_texture",n.VTL_TEXTURE_BINDING_UNIT_SPRITES);H.setUniform1f("u_fadeDuration",C.FADE_DURATION/1E3);N&&H.setUniform4fv("u_id",v);v=-1;for(const aa of r)if(aa.layerData.has(B)&&(aa.key.level!==v&&(v=aa.key.level,G.setDataUniforms(H,g,m,v,z)),N=aa.layerData.get(B),0!==N.iconPerPageElementsMap.size&&
(N.prepareForRendering(x),N.updateOpacityInfo(),r=N.iconVertexArrayObject,!D.isNone(r)))){x.bindVAO(r);H.setUniformMatrix3fv("u_dvsMat3",aa.transforms.dvs);H.setUniform1f("u_time",(performance.now()-N.lastOpacityUpdate)/1E3);for(const [ba,S]of N.iconPerPageElementsMap)this._renderIconRange(e,H,S,ba,aa)}}else F()}};k._renderIconRange=function(e,m,r,v,x){const {context:g,spriteMosaic:u}=e;this._spritesTextureSize[0]=u.getWidth(v)/4;this._spritesTextureSize[1]=u.getHeight(v)/4;m.setUniform2fv("u_mosaicSize",
this._spritesTextureSize);u.bind(g,c.TextureSamplingMode.LINEAR,v,n.VTL_TEXTURE_BINDING_UNIT_SPRITES);g.setStencilTestEnabled(!0);g.setStencilFunction(c.CompareFunction.GREATER,255,255);g.setStencilWriteMask(0);g.drawElements(c.PrimitiveType.TRIANGLES,r[1],c.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*r[0]);x.triangleCount+=r[1]/3};k._drawText=function(e,m,r,v){const {context:x,displayLevel:g,drawPhase:u,glyphMosaic:y,painter:z,pixelRatio:w,spriteMosaic:B,state:F,styleLayerUID:G,requestRender:H}=
e;e=m.textMaterial;const I=z.vectorTilesMaterialManager;var L=!1;for(var N of r)if(N.layerData.has(G)){var J=N.layerData.get(G);if(0<J.glyphPerPageElementsMap.size){L=!0;break}}if(L&&(J=m.getPaintProperty("text-opacity"),!J||J.isDataDriven||0!==J.getValue(g))){J=m.getPaintProperty("text-color");var K=!J||J.isDataDriven||0<J.getValue(g)[3];J=m.getPaintProperty("text-halo-width");N=m.getPaintProperty("text-halo-color");var O=(!J||J.isDataDriven||0<J.getValue(g))&&(!N||N.isDataDriven||0<N.getValue(g)[3]);
if(K||O){J=m.getLayoutValue("text-rotation-alignment",g);J===A.RotationAlignment.AUTO&&(J=m.getLayoutValue("symbol-placement",g)===A.SymbolPlacement.POINT?A.RotationAlignment.VIEWPORT:A.RotationAlignment.MAP);N=J===A.RotationAlignment.MAP;N=m.getLayoutValue("text-keep-upright",g)&&N;L=u===l.WGLDrawPhase.HITTEST;var W=.8*3/w;this._glyphTextureSize||(this._glyphTextureSize=E.fromValues(y.width/4,y.height/4));var aa=m.getPaintValue("text-translate",g),ba=m.getPaintValue("text-translate-anchor",g),S=
this._sdfProgramOptions;S.id=L;var M=I.getMaterialProgram(x,e,S);if(!D.isSome(H)||L||M.isCompiled){x.useProgram(M);M.setUniformMatrix3fv("u_displayViewMat3",J===A.RotationAlignment.MAP?F.displayViewMat3:F.displayMat3);M.setUniformMatrix3fv("u_displayMat3",ba===A.TranslateAnchor.VIEWPORT?F.displayMat3:F.displayViewMat3);M.setUniform2fv("u_textTranslation",aa);M.setUniform1f("u_depth",m.z+f);M.setUniform2fv("u_mosaicSize",this._glyphTextureSize);M.setUniform1f("u_mapRotation",d.degToByte(F.rotation));
M.setUniform1f("u_keepUpright",N?1:0);M.setUniform1f("u_level",10*g);M.setUniform1i("u_texture",n.VTL_TEXTURE_BINDING_UNIT_GLYPHS);M.setUniform1f("u_antialiasingWidth",W);M.setUniform1f("u_fadeDuration",C.FADE_DURATION/1E3);L&&M.setUniform4fv("u_id",v);v=-1;for(const Q of r)Q.layerData.has(G)&&(Q.key.level!==v&&(v=Q.key.level,e.setDataUniforms(M,g,m,v,B)),J=Q.layerData.get(G),0!==J.glyphPerPageElementsMap.size&&(J.prepareForRendering(x),J.updateOpacityInfo(),r=J.textVertexArrayObject,D.isNone(r)||
(x.bindVAO(r),M.setUniformMatrix3fv("u_dvsMat3",Q.transforms.dvs),x.setStencilTestEnabled(!0),x.setStencilFunction(c.CompareFunction.GREATER,255,255),x.setStencilWriteMask(0),r=(performance.now()-J.lastOpacityUpdate)/1E3,M.setUniform1f("u_time",r),J.glyphPerPageElementsMap.forEach((Y,V)=>{this._renderGlyphRange(x,Y,V,y,M,O,K,Q)}))))}else H()}}};k._renderGlyphRange=function(e,m,r,v,x,g,u,y){v.bind(e,c.TextureSamplingMode.LINEAR,r,n.VTL_TEXTURE_BINDING_UNIT_GLYPHS);g&&(x.setUniform1f("u_halo",1),e.drawElements(c.PrimitiveType.TRIANGLES,
m[1],c.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*m[0]),y.triangleCount+=m[1]/3);u&&(x.setUniform1f("u_halo",0),e.drawElements(c.PrimitiveType.TRIANGLES,m[1],c.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*m[0]),y.triangleCount+=m[1]/3)};return p}(b);q.WGLBrushVTLSymbol=b;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/vectorTiles/decluttering/config":function(){define(["exports"],function(q){q.COLLISION_GRID_CELL_SIZE=
32;q.DECLUTTER_BUDGET=1.5;q.DECLUTTER_TILES=!0;q.FADE_DURATION=200;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/GeometryUtils":function(){define(["exports"],function(q){function t(l,d){l%=d;return 0<=l?l:l+d}const D=Number.POSITIVE_INFINITY,E=Math.PI,C=128/E,A=256/360,n=1/Math.LN2;q.C_256_TO_RAD=E/128;q.C_2PI=2*E;q.C_DEG_TO_256=A;q.C_DEG_TO_RAD=E/180;q.C_INFINITY=D;q.C_PI=E;q.C_PI_BY_2=E/2;q.C_RAD_TO_256=C;q.C_SQRT2=1.414213562;
q.C_SQRT2_INV=1/1.414213562;q.between=function(l,d,a){return l>=d&&l<=a||l>=a&&l<=d};q.degToByte=function(l){return t(l*A,256)};q.interpolate=function(l,d,a){return l*(1-a)+d*a};q.log2=function(l){return Math.log(l)*n};q.positiveMod=t;q.radToByte=function(l){return t(l*C,256)};q.sqr=function(l){return l*l};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLabel":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../../../../webgl/enums".split(" "),
function(q,t,D,E,C,A,n){return function(l){function d(){return l.apply(this,arguments)||this}q._inheritsLoose(d,l);var a=d.prototype;a.dispose=function(){};a.getGeometryType=function(){return D.WGLGeometryType.LABEL};a.supportsSymbology=function(b){return!0};a.drawGeometry=function(b,c,f,h){const {context:p,painter:k,state:e,rendererInfo:m,passOptions:r,requestRender:v}=b,x=A.LabelMaterialKey.load(f.materialKey);var g=t.isSome(r)&&"hittest"===r.type;const u=x.mapAligned?1:0;if(u||!(1<=Math.abs(c.key.level-
Math.round(100*b.displayLevel)/100))){var {bufferLayouts:y,attributes:z}=E.createProgramDescriptor(x.data,{geometry:[{location:0,name:"a_pos",count:2,type:n.DataType.SHORT},{location:1,name:"a_id",count:4,type:n.DataType.UNSIGNED_BYTE},{location:2,name:"a_color",count:4,type:n.DataType.UNSIGNED_BYTE,normalized:!0},{location:3,name:"a_haloColor",count:4,type:n.DataType.UNSIGNED_BYTE,normalized:!0},{location:4,name:"a_texAndSize",count:4,type:n.DataType.UNSIGNED_BYTE},{location:5,name:"a_refSymbolAndPlacementOffset",
count:4,type:n.DataType.UNSIGNED_BYTE},{location:6,name:"a_glyphData",count:4,type:n.DataType.UNSIGNED_BYTE},{location:7,name:"a_vertexOffset",count:2,type:n.DataType.SHORT},{location:8,name:"a_texCoords",count:2,type:n.DataType.UNSIGNED_SHORT}]});h=k.materialManager.getMaterialProgram(b,x,"materials/label",z,h);!t.isSome(v)||g||h.isCompiled?(b.context.setStencilFunction(n.CompareFunction.EQUAL,0,255),p.useProgram(h),this._setSharedUniforms(h,b,c),k.textureManager.bindTextures(p,h,x),g=1===u?e.displayViewMat3:
e.displayMat3,this._setSizeVVUniforms(x,h,m,c),h.setUniform1f("u_mapRotation",Math.floor(e.rotation/360*254)),h.setUniform1f("u_mapAligned",u),h.setUniformMatrix3fv("u_displayMat3",g),h.setUniform1f("u_opacity",1),h.setUniform2fv("u_screenSize",b.state.size),h.setUniform1f("u_isHalo",1),b=f.target.getVAO(p,y,z),c=f.indexFrom*Uint32Array.BYTES_PER_ELEMENT,p.bindVAO(b),p.drawElements(n.PrimitiveType.TRIANGLES,f.indexCount,n.DataType.UNSIGNED_INT,c),h.setUniform1f("u_isHalo",0),p.drawElements(n.PrimitiveType.TRIANGLES,
f.indexCount,n.DataType.UNSIGNED_INT,c),p.setStencilTestEnabled(!0),p.setBlendingEnabled(!0)):v()}};return d}(C)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLine":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../../../../webgl/enums".split(" "),function(q,t,D,E,C,A,n){return function(l){function d(){return l.apply(this,arguments)||this}q._inheritsLoose(d,l);var a=d.prototype;a.dispose=
function(){};a.getGeometryType=function(){return D.WGLGeometryType.LINE};a.supportsSymbology=function(b){return!0};a.drawGeometry=function(b,c,f,h){const {context:p,painter:k,rendererInfo:e,displayLevel:m,passOptions:r,requestRender:v}=b,x=A.LineMaterialKey.load(f.materialKey),g=t.isSome(r)&&"hittest"===r.type;var u=E.createProgramDescriptor(x.data,{geometry:[{location:0,name:"a_pos",count:2,type:n.DataType.SHORT},{location:1,name:"a_id",count:4,type:n.DataType.UNSIGNED_BYTE},{location:2,name:"a_color",
count:4,type:n.DataType.UNSIGNED_BYTE,normalized:!0},{location:3,name:"a_offsetAndNormal",count:4,type:n.DataType.BYTE},{location:4,name:"a_accumulatedDistanceAndHalfWidth",count:2,type:n.DataType.UNSIGNED_SHORT},{location:5,name:"a_tlbr",count:4,type:n.DataType.UNSIGNED_SHORT},{location:6,name:"a_segmentDirection",count:4,type:n.DataType.BYTE},{location:7,name:"a_aux",count:2,type:n.DataType.UNSIGNED_SHORT},{location:8,name:"a_zoomRange",count:2,type:n.DataType.UNSIGNED_SHORT}]});let y=n.PrimitiveType.TRIANGLES;
g&&(u=this._getTriangleDesc(f.materialKey,u),y=n.PrimitiveType.POINTS);const {attributes:z,bufferLayouts:w}=u;h=k.materialManager.getMaterialProgram(b,x,"materials/line",z,h);!t.isSome(v)||g||h.isCompiled?(u=1/b.pixelRatio,p.useProgram(h),this._setSharedUniforms(h,b,c),x.textureBinding&&k.textureManager.bindTextures(p,h,x),h.setUniform1f("u_zoomFactor",2**(m-c.key.level)),h.setUniform1f("u_blur",0+u),h.setUniform1f("u_antialiasing",u),this._setSizeVVUniforms(x,h,e,c),this._setColorAndOpacityVVUniforms(x,
h,e),p.setFaceCullingEnabled(!1),b=f.target.getVAO(p,w,z,g),c=f.indexCount,f=f.indexFrom*Uint32Array.BYTES_PER_ELEMENT,g&&(c/=3,f/=3),p.bindVAO(b),p.drawElements(y,c,n.DataType.UNSIGNED_INT,f)):v()};return d}(C)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushText":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../../../../webgl/enums".split(" "),function(q,t,D,E,C,A,n){return function(l){function d(){return l.apply(this,
arguments)||this}q._inheritsLoose(d,l);var a=d.prototype;a.dispose=function(){};a.getGeometryType=function(){return D.WGLGeometryType.TEXT};a.supportsSymbology=function(b){return!0};a.drawGeometry=function(b,c,f,h){const {context:p,painter:k,rendererInfo:e,state:m,passOptions:r,requestRender:v}=b,x=A.TextMaterialKey.load(f.materialKey),g=t.isSome(r)&&"hittest"===r.type,{bufferLayouts:u,attributes:y}=E.createProgramDescriptor(x.data,{geometry:[{location:0,name:"a_pos",count:2,type:n.DataType.SHORT},
{location:1,name:"a_id",count:4,type:n.DataType.UNSIGNED_BYTE},{location:2,name:"a_color",count:4,type:n.DataType.UNSIGNED_BYTE,normalized:!0},{location:3,name:"a_haloColor",count:4,type:n.DataType.UNSIGNED_BYTE,normalized:!0},{location:4,name:"a_texFontSize",count:4,type:n.DataType.UNSIGNED_BYTE},{location:5,name:"a_aux",count:4,type:n.DataType.BYTE},{location:6,name:"a_zoomRange",count:2,type:n.DataType.UNSIGNED_SHORT},{location:7,name:"a_vertexOffset",count:2,type:n.DataType.SHORT},{location:8,
name:"a_texCoords",count:2,type:n.DataType.UNSIGNED_SHORT}]});h=k.materialManager.getMaterialProgram(b,x,"materials/text",y,h);if(!t.isSome(v)||g||h.isCompiled){p.useProgram(h);var z=n.PrimitiveType.TRIANGLES;g&&(z=n.PrimitiveType.POINTS);this._setSharedUniforms(h,b,c);k.textureManager.bindTextures(p,h,x);h.setUniformMatrix3fv("u_displayMat3",m.displayMat3);h.setUniformMatrix3fv("u_displayViewMat3",m.displayViewMat3);this._setSizeVVUniforms(x,h,e,c);this._setColorAndOpacityVVUniforms(x,h,e);this._setRotationVVUniforms(x,
h,e);h.setUniform1f("u_isHalo",1);b=f.target.getVAO(p,u,y);c=f.indexFrom*Uint32Array.BYTES_PER_ELEMENT;p.bindVAO(b);p.drawElements(n.PrimitiveType.TRIANGLES,f.indexCount,n.DataType.UNSIGNED_INT,c);h.setUniform1f("u_isHalo",0);p.drawElements(z,f.indexCount,n.DataType.UNSIGNED_INT,c)}else v()};return d}(C)})},"esri/views/2d/engine/vectorTiles/shaders/VTLMaterialManager":function(){define(["../enums","./Programs"],function(q,t){return function(){function D(){this._programByKey=new Map}var E=D.prototype;
E.dispose=function(){this._programByKey.forEach(C=>C.dispose());this._programByKey.clear()};E.getMaterialProgram=function(C,A,n){const l=A.key<<3|this._getMaterialOptionsValue(A.type,n);if(this._programByKey.has(l))return this._programByKey.get(l);var d=this._getProgramTemplate(A.type);({shaders:d}=d);const {vertexShader:a,fragmentShader:b}=d(n);n=A.getShaderHeader();d=A.getShaderMain();n=a.replace("#pragma header",n).replace("#pragma main",d);C=C.programCache.acquire(n,b,A.getAttributeLocations());
this._programByKey.set(l,C);return C};E._getMaterialOptionsValue=function(C,A){switch(C){case q.ShaderProgramType.BACKGROUND:return(A.pattern?1:0)<<1|(A.id?1:0);case q.ShaderProgramType.FILL:return(A.pattern?1:0)<<1|(A.id?1:0);case q.ShaderProgramType.OUTLINE:return A.id?1:0;case q.ShaderProgramType.LINE:return(A.sdf?1:0)<<2|(A.pattern?1:0)<<1|(A.id?1:0);case q.ShaderProgramType.ICON:return(A.sdf?1:0)<<1|(A.id?1:0);case q.ShaderProgramType.CIRCLE:return A.id?1:0;case q.ShaderProgramType.TEXT:return A.id?
1:0;default:return 0}};E._getProgramTemplate=function(C){switch(C){case q.ShaderProgramType.BACKGROUND:return t.background;case q.ShaderProgramType.CIRCLE:return t.circle;case q.ShaderProgramType.FILL:return t.fill;case q.ShaderProgramType.ICON:return t.icon;case q.ShaderProgramType.LINE:return t.line;case q.ShaderProgramType.OUTLINE:return t.outline;case q.ShaderProgramType.TEXT:return t.text;default:return null}};return D}()})},"esri/views/2d/engine/vectorTiles/enums":function(){define(["exports"],
function(q){q.MemoryBufferType=void 0;(function(t){t[t.UNKNOWN=0]="UNKNOWN";t[t.FILL_VERTEX=1]="FILL_VERTEX";t[t.FILL_DD_VERTEX=2]="FILL_DD_VERTEX";t[t.FILL_INDEX=3]="FILL_INDEX";t[t.OUTLINE_VERTEX=4]="OUTLINE_VERTEX";t[t.OUTLINE_DD_VERTEX=5]="OUTLINE_DD_VERTEX";t[t.OUTLINE_INDEX=6]="OUTLINE_INDEX";t[t.LINE_VERTEX=7]="LINE_VERTEX";t[t.LINE_DD_VERTEX=8]="LINE_DD_VERTEX";t[t.LINE_INDEX=9]="LINE_INDEX";t[t.ICON_VERTEX=10]="ICON_VERTEX";t[t.ICON_DD_VERTEX=11]="ICON_DD_VERTEX";t[t.ICON_INDEX=12]="ICON_INDEX";
t[t.TEXT_VERTEX=13]="TEXT_VERTEX";t[t.TEXT_DD_VERTEX=14]="TEXT_DD_VERTEX";t[t.TEXT_INDEX=15]="TEXT_INDEX";t[t.CIRCLE_VERTEX=16]="CIRCLE_VERTEX";t[t.CIRCLE_INDEX=17]="CIRCLE_INDEX"})(q.MemoryBufferType||(q.MemoryBufferType={}));q.BucketType=void 0;(function(t){t[t.FILL=1]="FILL";t[t.LINE=2]="LINE";t[t.SYMBOL=3]="SYMBOL";t[t.CIRCLE=4]="CIRCLE"})(q.BucketType||(q.BucketType={}));q.DrawPhase=void 0;(function(t){t[t.BACKGROUND=0]="BACKGROUND";t[t.OPAQUE=1]="OPAQUE";t[t.TRANSLUCENT=2]="TRANSLUCENT";t[t.SYMBOLS=
3]="SYMBOLS";t[t.HITTEST=4]="HITTEST"})(q.DrawPhase||(q.DrawPhase={}));q.ShaderProgramType=void 0;(function(t){t[t.BACKGROUND=0]="BACKGROUND";t[t.FILL=1]="FILL";t[t.OUTLINE=2]="OUTLINE";t[t.LINE=3]="LINE";t[t.ICON=4]="ICON";t[t.CIRCLE=5]="CIRCLE";t[t.TEXT=6]="TEXT";t[t.TILEINFO=7]="TILEINFO"})(q.ShaderProgramType||(q.ShaderProgramType={}));q.StyleUpdateType=void 0;(function(t){t[t.PAINTER_CHANGED=0]="PAINTER_CHANGED";t[t.LAYOUT_CHANGED=1]="LAYOUT_CHANGED";t[t.LAYER_CHANGED=2]="LAYER_CHANGED";t[t.LAYER_REMOVED=
3]="LAYER_REMOVED";t[t.SPRITES_CHANGED=4]="SPRITES_CHANGED"})(q.StyleUpdateType||(q.StyleUpdateType={}));Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/vectorTiles/shaders/Programs":function(){define(["exports","./sources/resolver","../../../../webgl/programUtils"],function(q,t,D){q.background={shaders:E=>({vertexShader:D.glslifyDefineMap({ID:E.id,PATTERN:E.pattern})+t.resolveIncludes("background/background.vert"),fragmentShader:D.glslifyDefineMap({ID:E.id,
PATTERN:E.pattern})+t.resolveIncludes("background/background.frag")})};q.circle={shaders:E=>({vertexShader:D.glslifyDefineMap({ID:E.id})+t.resolveIncludes("circle/circle.vert"),fragmentShader:D.glslifyDefineMap({ID:E.id})+t.resolveIncludes("circle/circle.frag")})};q.fill={shaders:E=>({vertexShader:D.glslifyDefineMap({ID:E.id,PATTERN:E.pattern})+t.resolveIncludes("fill/fill.vert"),fragmentShader:D.glslifyDefineMap({ID:E.id,PATTERN:E.pattern})+t.resolveIncludes("fill/fill.frag")})};q.icon={shaders:E=>
({vertexShader:D.glslifyDefineMap({ID:E.id,SDF:E.sdf})+t.resolveIncludes("icon/icon.vert"),fragmentShader:D.glslifyDefineMap({ID:E.id,SDF:E.sdf})+t.resolveIncludes("icon/icon.frag")})};q.line={shaders:E=>({vertexShader:D.glslifyDefineMap({ID:E.id,PATTERN:E.pattern,SDF:E.sdf})+t.resolveIncludes("line/line.vert"),fragmentShader:D.glslifyDefineMap({ID:E.id,PATTERN:E.pattern,SDF:E.sdf})+t.resolveIncludes("line/line.frag")})};q.outline={shaders:E=>({vertexShader:D.glslifyDefineMap({ID:E.id})+t.resolveIncludes("outline/outline.vert"),
fragmentShader:D.glslifyDefineMap({ID:E.id})+t.resolveIncludes("outline/outline.frag")})};q.text={shaders:E=>({vertexShader:D.glslifyDefineMap({ID:E.id})+t.resolveIncludes("text/text.vert"),fragmentShader:D.glslifyDefineMap({ID:E.id})+t.resolveIncludes("text/text.frag")})};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/vectorTiles/shaders/sources/resolver":function(){define(["exports","./shaderRepository","../../../../../webgl/ShaderCompiler"],
function(q,t,D){const E=new D.ShaderCompiler(function(C){let A=t;C.split("/").forEach(n=>{A&&(A=A[n])});return A});q.resolveIncludes=function(C){return E.resolveIncludes(C)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/vectorTiles/shaders/sources/shaderRepository":function(){define(function(){return{background:{"background.frag":"#ifdef PATTERN\nuniform lowp float u_opacity;\nuniform lowp sampler2D u_texture;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#else\nuniform lowp vec4 u_color;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main() {\n#ifdef PATTERN\nmediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\nmediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color \x3d texture2D(u_texture, samplePos);\ngl_FragColor \x3d u_opacity * color;\n#else\ngl_FragColor \x3d u_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"background.vert":"precision mediump float;\nattribute vec2 a_pos;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\nuniform mediump vec4 u_tlbr;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\n#endif\nvoid main() {\ngl_Position \x3d vec4((u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0)).xy, u_depth, 1.0);\n#ifdef PATTERN\nv_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\nv_tlbr             \x3d u_tlbr / u_mosaicSize.xyxy;\n#endif\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\n}"},
circle:{"circle.frag":"precision lowp float;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nmediump float dist \x3d length(v_offset);\nmediump float alpha \x3d smoothstep(0.0, -v_blur, dist - 1.0);\nlowp float color_mix_ratio \x3d v_stroke_width \x3c 0.01 ? 0.0 : smoothstep(-v_blur, 0.0, dist - v_radius / (v_radius + v_stroke_width));\ngl_FragColor \x3d alpha * mix(v_color, v_stroke_color, color_mix_ratio);\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"circle.vert":"precision mediump float;\nattribute vec2 a_pos;\n#pragma header\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_circleTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_antialiasingWidth;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\nv_stroke_color \x3d stroke_color * stroke_opacity;\nv_stroke_width \x3d stroke_width;\nv_radius \x3d radius;\nv_blur \x3d max(blur, u_antialiasingWidth / (radius + stroke_width));\nmediump vec2 offset \x3d vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\nv_offset \x3d offset;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos * 0.5, 1.0) + u_displayMat3 * vec3((v_radius + v_stroke_width) * offset + u_circleTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
fill:{"fill.frag":"precision lowp float;\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\nvarying mediump vec4 v_tlbr;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvec4 mixColors(vec4 color1, vec4 color2) {\nfloat compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\nvec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\nreturn vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef PATTERN\nmediump vec2 normalizedTextureCoord \x3d fract(v_tileTextureCoord);\nmediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color \x3d texture2D(u_texture, samplePos);\ngl_FragColor \x3d v_color[3] * color;\n#else\ngl_FragColor \x3d v_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"fill.vert":"precision mediump float;\nattribute vec2 a_pos;\n#pragma header\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_fillTranslation;\n#ifdef PATTERN\n#include \x3cutil/util.glsl\x3e\nuniform mediump vec2 u_mosaicSize;\nuniform mediump float u_patternFactor;\nvarying mediump vec2 v_tileTextureCoord;\nvarying mediump vec4 v_tlbr;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\n#ifdef PATTERN\nfloat patternWidth \x3d nextPOT(tlbr.z - tlbr.x);\nfloat patternHeight \x3d nextPOT(tlbr.w - tlbr.y);\nfloat scaleX \x3d 1.0 / (patternWidth * u_patternFactor);\nfloat scaleY \x3d 1.0 / (patternHeight * u_patternFactor);\nmat3 patterMat \x3d mat3(scaleX, 0.0,    0.0,\n0.0,    -scaleY, 0.0,\n0.0,    0.0,    1.0);\nv_tileTextureCoord \x3d (patterMat * vec3(a_pos, 1.0)).xy;\nv_tlbr             \x3d tlbr / u_mosaicSize.xyxy;\n#endif\nvec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(u_fillTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
icon:{"icon.frag":"precision mediump float;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nuniform lowp vec4 u_color;\nuniform lowp vec4 u_outlineColor;\n#endif\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nvarying lowp vec4 v_color;\n#ifdef SDF\nvarying mediump flaot v_halo_width;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\n#include \x3cutil/encoding.glsl\x3e\nvec4 mixColors(vec4 color1, vec4 color2) {\nfloat compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\nvec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\nreturn vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef SDF\nlowp vec4 fillPixelColor \x3d v_color;\nfloat d \x3d rgba2float(texture2D(u_texture, v_tex)) - 0.5;\nconst float softEdgeRatio \x3d 0.248062016;\nfloat size \x3d max(v_size.x, v_size.y);\nfloat dist \x3d d * softEdgeRatio * size;\nfillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\nif (v_halo_width \x3e 0.25) {\nlowp vec4 outlinePixelColor \x3d u_outlineColor;\nconst float outlineLimitRatio \x3d (16.0 / 86.0);\nfloat clampedOutlineSize \x3d softEdgeRatio * min(v_halo_width, outlineLimitRatio * max(v_size.x, v_size.y));\noutlinePixelColor *\x3d clamp(0.5 - (abs(dist) - clampedOutlineSize), 0.0, 1.0);\ngl_FragColor \x3d v_opacity * mixColors(fillPixelColor, outlinePixelColor);\n}\nelse {\ngl_FragColor \x3d v_opacity * fillPixelColor;\n}\n#else\nlowp vec4 texColor \x3d texture2D(u_texture, v_tex);\ngl_FragColor \x3d v_opacity * texColor;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\n#pragma header\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\n#ifdef SDF\nvarying mediump float v_halo_width;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_iconTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeDuration;\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nconst float C_OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float tileCoordRatio \x3d 1.0 / 8.0;\nuniform highp float u_time;\nvoid main()\n{\n#pragma main\nv_color \x3d color;\nv_opacity \x3d opacity;\n#ifdef SDF\nv_halo_width \x3d halo_width;\n#endif\nfloat modded \x3d mod(a_opacityInfo, 128.0);\nfloat targetOpacity \x3d (a_opacityInfo - modded) / 128.0;\nfloat startOpacity \x3d modded / 127.0;\nfloat interpolatedOpacity \x3d clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\nv_opacity *\x3d interpolatedOpacity;\nmediump float a_angle         \x3d a_levelInfo[1];\nmediump float a_minLevel      \x3d a_levelInfo[2];\nmediump float a_maxLevel      \x3d a_levelInfo[3];\nmediump vec2 a_tex            \x3d a_texAngleRange.xy;\nmediump float delta_z \x3d 0.0;\nmediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\ndelta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\ndelta_z +\x3d 1.0 - step(a_minLevel, u_level);\ndelta_z +\x3d step(a_maxLevel, u_level);\ndelta_z +\x3d step(v_opacity, 0.0);\nvec2 offset \x3d C_OFFSET_PRECISION * a_vertexOffset;\nv_size \x3d abs(offset);\n#ifdef SDF\noffset \x3d (120.0 / 86.0) * offset;\n#endif\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayViewMat3 * vec3(size * offset, 0.0) + u_displayMat3 * vec3(u_iconTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nv_tex \x3d a_tex.xy / u_mosaicSize;\n}"},
line:{"line.frag":"precision lowp float;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying mediump float v_blur;\n#if defined (PATTERN) || defined(SDF)\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\nvarying mediump float v_widthRatio;\nuniform sampler2D u_texture;\nuniform mediump float u_antialiasing;\n#endif\n#ifdef SDF\n#include \x3cutil/encoding.glsl\x3e\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nmediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\nlowp float alpha \x3d clamp((v_lineHalfWidth - fragDist) / v_blur, 0.0, 1.0);\n#ifdef PATTERN\nmediump float relativeTexX \x3d fract(v_accumulatedDistance / (v_patternSize.x * v_widthRatio));\nmediump float relativeTexY \x3d 0.5 + v_normal.y * v_lineHalfWidth / (v_patternSize.y * v_widthRatio);\nmediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\nlowp vec4 color \x3d texture2D(u_texture, texCoord);\ngl_FragColor \x3d alpha * v_color[3] * color;\n#elif defined(SDF)\nmediump float relativeTexX \x3d fract((v_accumulatedDistance * 0.5) / (v_patternSize.x * v_widthRatio));\nmediump float relativeTexY \x3d  0.5 + 0.25 * v_normal.y;\nmediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\nmediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\nfloat dist \x3d d * (v_lineHalfWidth + u_antialiasing / 2.0);\ngl_FragColor \x3d alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n#else\ngl_FragColor \x3d alpha * v_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec4 a_extrude_offset;\nattribute vec4 a_dir_normal;\nattribute vec2 a_accumulatedDistance;\n#pragma header\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump float u_zoomFactor;\nuniform mediump vec2 u_lineTranslation;\nuniform mediump float u_antialiasing;\nuniform mediump float u_depth;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nconst float scale \x3d 1.0 / 31.0;\nconst mediump float tileCoordRatio \x3d 8.0;\n#if defined (SDF)\nconst mediump float sdfPatternHalfWidth \x3d 15.5;\n#endif\n#if defined (PATTERN) || defined(SDF)\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\nvarying mediump float v_widthRatio;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvarying mediump float v_lineHalfWidth;\nvarying mediump float v_blur;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\nv_blur \x3d blur + u_antialiasing;\nv_normal \x3d a_dir_normal.zw * scale;\n#if defined (PATTERN) || defined(SDF)\nv_tlbr          \x3d tlbr / u_mosaicSize.xyxy;\nv_patternSize   \x3d vec2(tlbr.z - tlbr.x, tlbr.y - tlbr.w);\n#if defined (PATTERN)\nv_widthRatio \x3d width / v_patternSize.y;\n#else\nv_widthRatio \x3d width / sdfPatternHalfWidth / 2.0;\n#endif\n#endif\nv_lineHalfWidth \x3d (width + u_antialiasing) * 0.5;\nmediump vec2 dir \x3d a_dir_normal.xy * scale;\nmediump vec2 offset_ \x3d a_extrude_offset.zw * scale * offset;\nmediump vec2 dist \x3d v_lineHalfWidth * scale * a_extrude_offset.xy;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos + offset_ * tileCoordRatio / u_zoomFactor, 1.0) + u_displayViewMat3 * vec3(dist, 0.0) + u_displayMat3 * vec3(u_lineTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n#if defined (PATTERN) || defined(SDF)\nv_accumulatedDistance \x3d a_accumulatedDistance.x * u_zoomFactor / tileCoordRatio + dot(dir, dist + offset_);\n#endif\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\n}"},
outline:{"outline.frag":"varying lowp vec4 v_color;\nvarying mediump vec2 v_normal;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nlowp float dist \x3d abs(v_normal.y);\nlowp float alpha \x3d smoothstep(1.0, 0.0, dist);\ngl_FragColor \x3d alpha * v_color;\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}","outline.vert":"attribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_xnormal;\n#pragma header\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_fillTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_outline_width;\nvarying lowp vec2 v_normal;\nconst float scale \x3d 1.0 / 15.0;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nv_normal \x3d a_xnormal;\nmediump vec2 dist \x3d u_outline_width * scale * a_offset;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(dist + u_fillTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
text:{"text.frag":"uniform lowp sampler2D u_texture;\nvarying lowp vec2 v_tex;\nvarying lowp vec4 v_color;\nvarying mediump float v_edgeWidth;\nvarying mediump float v_edgeDistance;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nlowp float dist \x3d texture2D(u_texture, v_tex).a;\nmediump float alpha \x3d smoothstep(v_edgeDistance - v_edgeWidth, v_edgeDistance + v_edgeWidth, dist);\ngl_FragColor \x3d alpha * v_color;\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\n#pragma header\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_textTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeDuration;\nvarying lowp vec2 v_tex;\nconst float offsetPrecision \x3d 1.0 / 8.0;\nconst mediump float edgePos \x3d 0.75;\nuniform mediump float u_antialiasingWidth;\nvarying mediump float v_edgeDistance;\nvarying mediump float v_edgeWidth;\nuniform lowp float u_halo;\nconst float sdfFontScale \x3d 1.0 / 24.0;\nconst float sdfPixel \x3d 3.0;\nuniform highp float u_time;\nvoid main()\n{\n#pragma main\nif (u_halo \x3e 0.5)\n{\nv_color \x3d halo_color * opacity;\nhalo_width *\x3d sdfPixel;\nhalo_blur *\x3d sdfPixel;\n}\nelse\n{\nv_color \x3d color * opacity;\nhalo_width \x3d 0.0;\nhalo_blur \x3d 0.0;\n}\nfloat modded \x3d mod(a_opacityInfo, 128.0);\nfloat targetOpacity \x3d (a_opacityInfo - modded) / 128.0;\nfloat startOpacity \x3d modded / 127.0;\nfloat interpolatedOpacity \x3d clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\nv_color *\x3d interpolatedOpacity;\nmediump float a_angle       \x3d a_levelInfo[1];\nmediump float a_minLevel    \x3d a_levelInfo[2];\nmediump float a_maxLevel    \x3d a_levelInfo[3];\nmediump vec2 a_tex          \x3d a_texAngleRange.xy;\nmediump float a_visMinAngle    \x3d a_texAngleRange.z;\nmediump float a_visMaxAngle    \x3d a_texAngleRange.w;\nmediump float delta_z \x3d 0.0;\nmediump float angle \x3d mod(a_angle + u_mapRotation, 256.0);\nif (a_visMinAngle \x3c a_visMaxAngle)\n{\ndelta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) + (1.0 - step(a_visMinAngle, angle)));\n}\nelse\n{\ndelta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) * (1.0 - step(a_visMinAngle, angle)));\n}\ndelta_z +\x3d 1.0 - step(a_minLevel, u_level);\ndelta_z +\x3d step(a_maxLevel, u_level);\ndelta_z +\x3d step(v_color[3], 0.0);\nv_tex \x3d a_tex.xy / u_mosaicSize;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nv_edgeDistance \x3d edgePos - halo_width / size;\nv_edgeWidth \x3d (u_antialiasingWidth + halo_blur) / size;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + sdfFontScale * u_displayViewMat3 * vec3(offsetPrecision * size * a_vertexOffset, 0.0) + u_displayMat3 * vec3(u_textTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n255.0 / (256.0),\n255.0 / (256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n);\nfloat rgba2float(vec4 rgba) {\nreturn dot(rgba, rgba2float_factors);\n}","util.glsl":"float nextPOT(in float x) {\nreturn pow(2.0, ceil(log2(abs(x))));\n}"}}})},"esri/views/2d/engine/webgl/BitBlitRenderer":function(){define("exports ../../../../core/maybe ./DefaultVertexAttributeLayouts ./shaders/BitBlitPrograms ../../../webgl/BufferObject ../../../webgl/enums ../../../webgl/ProgramTemplate ../../../webgl/VertexArrayObject".split(" "),
function(q,t,D,E,C,A,n,l){let d=function(){function a(){this._initialized=!1}var b=a.prototype;b.dispose=function(){this._program=t.disposeMaybe(this._program);this._vertexArrayObject=t.disposeMaybe(this._vertexArrayObject)};b.render=function(c,f,h,p){c&&(this._initialized||this._initialize(c),c.setBlendFunctionSeparate(A.BlendFactor.ONE,A.BlendFactor.ONE_MINUS_SRC_ALPHA,A.BlendFactor.ONE,A.BlendFactor.ONE_MINUS_SRC_ALPHA),c.bindVAO(this._vertexArrayObject),c.useProgram(this._program),f.setSamplingMode(h),
c.bindTexture(f,0),this._program.setUniform1i("u_tex",0),this._program.setUniform1f("u_opacity",p),c.drawArrays(A.PrimitiveType.TRIANGLE_STRIP,0,4),c.bindTexture(null,0),c.bindVAO())};b._initialize=function(c){if(this._initialized)return!0;const f=n.createProgram(c,E.bitBlit);if(!f)return!1;const h=new Int8Array(16);h[0]=-1;h[1]=-1;h[2]=0;h[3]=0;h[4]=1;h[5]=-1;h[6]=1;h[7]=0;h[8]=-1;h[9]=1;h[10]=0;h[11]=1;h[12]=1;h[13]=1;h[14]=1;h[15]=1;c=new l.VertexArrayObject(c,E.bitBlit.attributes,D.PosTex2b,{geometry:C.BufferObject.createVertex(c,
A.Usage.STATIC_DRAW,h)});this._program=f;this._vertexArrayObject=c;return this._initialized=!0};return a}();q.BitBlitRenderer=d;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/shaders/BitBlitPrograms":function(){define(["exports","./sources/resolver"],function(q,t){t={shaders:{vertexShader:t.resolveIncludes("bitBlit/bitBlit.vert"),fragmentShader:t.resolveIncludes("bitBlit/bitBlit.frag")},attributes:new Map([["a_pos",0],["a_tex",
1]])};q.bitBlit=t;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/MaterialManager":function(){define(["../../../../core/maybe","./enums","./shaders/MaterialPrograms"],function(q,t,D){const E=n=>n===t.WGLDrawPhase.HITTEST||n===t.WGLDrawPhase.LABEL_ALPHA,C=({rendererInfo:n,drawPhase:l},d,a,b)=>{d=d.getVariationHash();b=b.join(".");l=(E(l)?1:0)|(l===t.WGLDrawPhase.HIGHLIGHT?2:0);return`${d}-${b}-${l}-${n.getVariationHash()}-${q.isSome(a)&&
a.join(".")}`},A=(n,l,d,a)=>{a=a.reduce((b,c)=>({...b,[c]:n.context.driverTest[c]}),{});l={...l.getVariation(),...n.rendererInfo.getVariation(),highlight:n.drawPhase===t.WGLDrawPhase.HIGHLIGHT,id:E(n.drawPhase),...a};if(q.isSome(d))for(const b of d)l[b]=!0;return l};return function(){function n(d){this._rctx=d;this._programByKey=new Map}var l=n.prototype;l.dispose=function(){this._programByKey.forEach(d=>d.dispose());this._programByKey.clear()};l.getProgram=function(d,a=[],b=[]){const c=d.vsPath+
"."+d.fsPath+JSON.stringify(a)+b.join(".");if(this._programByKey.has(c))return this._programByKey.get(c);b=b.reduce((k,e)=>({...k,[e]:this._rctx.driverTest[e]}),{});a={...a.map(k=>"string"===typeof k?{name:k,value:!0}:k).reduce((k,e)=>({...k,[e.name]:e.value}),{}),...b};const {vsPath:f,fsPath:h,attributes:p}=d;d=D.createProgramTemplate(f,h,p,a);d=this._rctx.programCache.acquire(d.shaders.vertexShader,d.shaders.fragmentShader,d.attributes);if(!d)throw Error("Unable to get program for key: ${key}");
this._programByKey.set(c,d);return d};l.getMaterialProgram=function(d,a,b,c,f,h=["ignoresSamplerPrecision"]){const p=C(d,a,f,h);if(this._programByKey.has(p))return this._programByKey.get(p);d=A(d,a,f,h);b=D.createProgramTemplate(b,b,c,d);b=this._rctx.programCache.acquire(b.shaders.vertexShader,b.shaders.fragmentShader,b.attributes);if(!b)throw Error("Unable to get program for key: ${key}");this._programByKey.set(p,b);return b};return n}()})},"esri/views/2d/engine/webgl/shaders/MaterialPrograms":function(){define(["exports",
"./sources/resolver","../../../../webgl/programUtils"],function(q,t,D){q.createProgramTemplate=(E,C,A,n)=>{E+=E.substring(E.lastIndexOf("/"));C+=C.substring(C.lastIndexOf("/"));{const d={};for(const a in n){{let b=void 0;var l=a;b=""+l[0].toUpperCase();for(let c=1;c<l.length;c++){const f=l[c];f===f.toUpperCase()?(b+="_",b+=f):b+=f.toUpperCase()}l=b}d[l]=n[a]}n=D.glslifyDefineMap(d)}return{attributes:A,shaders:{vertexShader:n+t.resolveIncludes(`${E}.vert`),fragmentShader:n+t.resolveIncludes(`${C}.frag`)}}};
Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/TextureManager":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../config ../../../../request ../../../../core/BidiText ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/screenUtils ../../../../chunks/vec2 ../../../../chunks/vec2f32 ../../../../symbols/cim/Rasterizer ./definitions ./enums ./fontUtils ./GlyphMosaic ./GlyphSource ./SDFConverter ./SpriteMosaic ./Utils ./animatedFormats/apng ./animatedFormats/gif ./util/Result ./util/symbolUtils ../../../support/QueueProcessor ../../../webgl/enums".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c,f,h,p,k,e,m,r,v,x,g,u,y,z,w){function B(N,J){return F.apply(this,arguments)}function F(){F=q._asyncToGenerator(function*(N,J){N=v.getUrl(N);var K;if(N.includes(";base64,")){J=N.indexOf(";base64,")+8;J=N.substring(J);J=atob(J);N=new Uint8Array(J.length);for(K=0;K<J.length;K++)N[K]=J.charCodeAt(K);K=N.buffer}else try{const {data:O}=yield D(N,{responseType:"array-buffer",...J});K=O}catch(O){if(!l.isAbortError(O))return new C("mapview-invalid-resource",`Could not fetch requested resource at ${N}`)}return K});
return F.apply(this,arguments)}function G(N,J){J=Math.round(d.pt2px(J)*window.devicePixelRatio);return Math.min(N,J*(128<=J?2:4))}const H=b.create(),I=A.getLogger("esri.views.2d.engine.webgl.TextureManager");let L=function(){function N(J,K,O){this.mosaicType=J;this.page=K;this.sdf=O}N.fromMosaic=function(J,K){return new N(J,K.page,K.sdf)};return N}();return function(){function N(K,O){this._requestRender=K;this.resourceManager=O;this._invalidFontsMap=new Map;this._sdfConverter=new m(126);this._bindingInfos=
[];this._hashToBindingIndex=new Map;this._ongoingRasterizations=new Map;this._imageRequestQueue=new z.QueueProcessor({concurrency:10,process:function(){var W=q._asyncToGenerator(function*(aa,ba){l.throwIfAborted(ba);try{return yield D(aa,{responseType:"image",signal:ba})}catch(S){if(!l.isAbortError(S))throw new C("mapview-invalid-resource",`Could not fetch requested resource at ${aa}`,S);throw S;}});return function(aa,ba){return W.apply(this,arguments)}}()});this._spriteMosaic=new r(2048,2048,500);
this._glyphSource=new e(`${t.fontsUrl}/{fontstack}/{range}.pbf`);this._glyphMosaic=new k(1024,1024,this._glyphSource);this._rasterizer=new c(O)}var J=N.prototype;J.dispose=function(){this._spriteMosaic.dispose();this._glyphMosaic.dispose();this._rasterizer.dispose();this._sdfConverter.dispose();this._sdfConverter=this._glyphMosaic=this._spriteMosaic=null;this._hashToBindingIndex.clear();this._bindingInfos=this._hashToBindingIndex=null;this._ongoingRasterizations.clear();this._ongoingRasterizations=
null;this._imageRequestQueue.clear();this._imageRequestQueue=null};J.rasterizeItem=function(){var K=q._asyncToGenerator(function*(O,W,aa,ba){if(n.isNone(O))return I.error(new C("mapview-null-resource","Unable to rasterize null resource",void 0)),null;switch(O.type){case "text":case "esriTS":return O=yield this._rasterizeText(O,aa,ba),O.forEach(S=>this._setTextureBinding(h.MosaicType.GLYPH,S)),{glyphMosaicItems:O};default:if(v.is3D(O))return I.error(new C("mapview-invalid-type",`MapView does not support symbol type: ${O.type}`,
O)),null;O=yield this._rasterizeSpriteSymbol(O,W,ba);u.ok(O)&&O&&this._setTextureBinding(h.MosaicType.SPRITE,O);return{spriteMosaicItem:O}}});return function(O,W,aa,ba){return K.apply(this,arguments)}}();J.bindTextures=function(K,O,W,aa=!1){if(0!==W.textureBinding){var ba=this._bindingInfos[W.textureBinding-1];W=ba.page;aa=aa?w.TextureSamplingMode.LINEAR_MIPMAP_LINEAR:w.TextureSamplingMode.LINEAR;switch(ba.mosaicType){case h.MosaicType.SPRITE:{ba=this.sprites.getWidth(W);const S=this.sprites.getHeight(W);
ba=a.set(H,ba,S);this._spriteMosaic.bind(K,aa,W,f.TEXTURE_BINDING_SPRITE_ATLAS);O.setUniform1i("u_texture",f.TEXTURE_BINDING_SPRITE_ATLAS);O.setUniform2fv("u_mosaicSize",ba);break}case h.MosaicType.GLYPH:ba=a.set(H,this.glyphs.width,this.glyphs.height);this._glyphMosaic.bind(K,aa,W,f.TEXTURE_BINDING_GLYPH_ATLAS);O.setUniform1i("u_texture",f.TEXTURE_BINDING_GLYPH_ATLAS);O.setUniform2fv("u_mosaicSize",ba);break;default:I.error("mapview-texture-manager",`Cannot handle unknown type ${ba.mosaicType}`)}}};
J._hashMosaic=function(K,O){return 1|K<<1|(O.sdf?1:0)<<2|O.page<<3};J._setTextureBinding=function(K,O){const W=this._hashMosaic(K,O);this._hashToBindingIndex.has(W)||(K=L.fromMosaic(K,O),this._hashToBindingIndex.set(W,this._bindingInfos.length+1),this._bindingInfos.push(K));O.textureBinding=this._hashToBindingIndex.get(W)};J._rasterizeText=function(){var K=q._asyncToGenerator(function*(O,W,aa){let ba,S;ba="cim"in O?O.fontName:p.getFullyQualifiedFontName(O.font);S=O.text;O=this._invalidFontsMap.has(ba);
W=W?W:v.charCodes(E.bidiText(S)[0]);try{return yield this._glyphMosaic.getGlyphItems(O?"arial-unicode-ms-regular":ba,W,aa)}catch(M){return I.error(new C("mapview-invalid-resource",`Couldn't find font ${ba}. Falling back to Arial Unicode MS Regular`,void 0)),this._invalidFontsMap.set(ba,!0),this._glyphMosaic.getGlyphItems("arial-unicode-ms-regular",W,aa)}});return function(O,W,aa){return K.apply(this,arguments)}}();J._rasterizeSpriteSymbol=function(){var K=q._asyncToGenerator(function*(O,W,aa){if(v.isSimple(O))return null;
W=y.keyFromSymbol(O);if(this._spriteMosaic.has(W))return this._spriteMosaic.getSpriteItem(W);if(v.isSVGResource(O)||v.isImageResource(O)&&!v.isMarkerPlacementInsidePolygon(O))return this._handleAsyncResource(W,O,aa);if(aa=this._rasterizer.rasterizeJSONResource(O,1)){const {size:ba,image:S,sdf:M,simplePattern:Q}=aa;return this._addItemToMosaic(W,ba,{type:"static",data:S},v.shouldRepeat(O),M,Q)}return new C("TextureManager","unrecognized or null rasterized image")});return function(O,W,aa){return K.apply(this,
arguments)}}();J._handleAsyncResource=function(){var K=q._asyncToGenerator(function*(O,W,aa){if(this._ongoingRasterizations.has(O))return this._ongoingRasterizations.get(O);W=v.isSVGResource(W)?this._handleSVG(W,O,aa):this._handleImage(W,O,aa);this._ongoingRasterizations.set(O,W);try{yield W,this._ongoingRasterizations.delete(O)}catch{this._ongoingRasterizations.delete(O)}return W});return function(O,W,aa){return K.apply(this,arguments)}}();J._handleSVG=function(){var K=q._asyncToGenerator(function*(O,
W,aa){O=yield this._sdfConverter.draw(O.path,aa);return this._addItemToMosaic(W,[126,126],{type:"static",data:new Uint32Array(O.buffer)},!1,!0,!0)});return function(O,W,aa){return K.apply(this,arguments)}}();J._handleGIFOrPNG=function(){var K=q._asyncToGenerator(function*(O,W,aa){var ba=yield B(O,aa);if(u.ok(ba)){var S=g.isGIF(ba);const M=x.isPNG(ba);if(!S&&!M)return new C("mapview-invalid-resource","Image data is neither GIF nor PNG!");let Q;try{const Y=O.animatedSymbolProperties||{},V=O.objectId;
S&&g.isAnimatedGIF(ba)?Q=yield g.GIF.create(ba,Y,V,this._requestRender,aa):M&&x.isAnimatedPNG(ba)&&(Q=yield x.APNG.create(ba,Y,V,this._requestRender,aa))}catch(Y){if(!l.isAbortError(Y))return new C("mapview-invalid-resource","Could not fetch requested resource!")}if(Q&&u.ok(Q))return this._addItemToMosaic(W,[Q.width,Q.height],{type:"animated",data:Q},v.shouldRepeat(O),!1,!1);aa=new Blob([ba],{type:S?"image/gif":"image/png"});if((aa=yield this._imageFromBlob(aa))&&aa instanceof HTMLImageElement){ba=
aa.width;S=aa.height;"esriPMS"===O.type&&(ba=Math.round(G(aa.width,v.getPMSResourceSize(O))),S=Math.round(ba/aa.width*aa.height));const {size:Y,sdf:V,image:P}=this._rasterizer.rasterizeImageResource(ba,S,aa,"cim"in O?O.cim.colorSubstitutions:void 0);return this._addItemToMosaic(W,Y,{type:"static",data:P},v.shouldRepeat(O),V,!1)}}return new C("mapview-invalid-resource","Could not handle resource!")});return function(O,W,aa){return K.apply(this,arguments)}}();J._handleImage=function(){var K=q._asyncToGenerator(function*(O,
W,aa){if(v.isGIF(O)||v.isPNG(O))return this._handleGIFOrPNG(O,W,aa);const ba=v.getUrl(O);try{let M;const Q=this.resourceManager.getResource(ba);if(n.isSome(Q))M=Q;else{const {data:T}=yield this._imageRequestQueue.push(ba,{...aa});M=T}if(v.isSVGImage(ba))if("width"in O&&"height"in O)M.width=d.pt2px(O.width),M.height=d.pt2px(O.height);else if("cim"in O){var S;const T=O.cim;M.width=d.pt2px(null!=(S=T.width)?S:T.scaleX*T.size);M.height=d.pt2px(T.size)}if(!M.width||!M.height)return null;let Y=M.width,
V=M.height;"esriPMS"===O.type&&(Y=Math.round(G(M.width,v.getPMSResourceSize(O))),V=Math.round(Y/M.width*M.height));const {size:P,sdf:X,image:R}=this._rasterizer.rasterizeImageResource(Y,V,M,"cim"in O?O.cim.colorSubstitutions:void 0);return this._addItemToMosaic(W,P,{type:"static",data:R},v.shouldRepeat(O),X,!1)}catch(M){if(!l.isAbortError(M))return new C("mapview-invalid-resource",`Could not fetch requested resource at ${ba}. ${M.message}`)}});return function(O,W,aa){return K.apply(this,arguments)}}();
J._imageFromBlob=function(){var K=q._asyncToGenerator(function*(O){O=window.URL.createObjectURL(O);try{const {data:W}=yield this._imageRequestQueue.push(O);window.URL.revokeObjectURL(O);return W}catch(W){window.URL.revokeObjectURL(O);if(!l.isAbortError(W))return new C("mapview-invalid-resource",`Could not fetch requested resource at ${O}`);throw W;}});return function(O){return K.apply(this,arguments)}}();J._addItemToMosaic=function(K,O,W,aa,ba,S){return this._spriteMosaic.addSpriteItem(K,O,W,aa,ba,
S)};q._createClass(N,[{key:"sprites",get:function(){return this._spriteMosaic}},{key:"glyphs",get:function(){return this._glyphMosaic}}]);return N}()})},"esri/core/BidiText":function(){define(["exports","./BidiEngine"],function(q,t){const D=new t;q.bidiText=function(E){if(!D.hasBidiChar(E))return[E,!1];let C;C="rtl"===D.checkContextual(E)?"IDNNN":"ICNNN";return[D.bidiTransform(E,C,"VLYSN"),!0]};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/BidiEngine":function(){define(["./bidiEngineTables"],
function(q){function t(g,u,y,z,w){var B=g;void 0===u&&(u=w.defInFormat);void 0===y&&(y=w.defOutFormat);void 0===z&&(z=w.defSwap);if(u!==y){var F=u.substring(0,1),G=y.substring(0,1);var H=u.substring(1,4);var I=y.substring(1,4);"C"===H.charAt(0)&&(H=D(B),H="ltr"===H||"rtl"===H?H.toUpperCase():"L"===u.charAt(2)?"LTR":"RTL",u=F+H);"C"===I.charAt(0)&&(H=D(B),"rtl"===H?I="RTL":"ltr"===H?(B=B.split(""),B.reverse(),H=D(B.join("")),I=H.toUpperCase()):I="L"===y.charAt(2)?"LTR":"RTL",y=G+I)}if(u===y)return g;
G=u.substring(0,1);B=u.substring(1,4);F=y.substring(0,1);I=y.substring(1,4);w.inFormat=u;w.outFormat=y;w.swap=z;if("L"===G&&"VLTR"===y){if("LTR"===B)return w.dir=0,E(g,w);if("RTL"===B)return w.dir=1,E(g,w)}if("V"===G&&"V"===F)return w.dir="RTL"===B?1:0,A(g,w);if("L"===G&&"VRTL"===y)return w.dir="LTR"===B?0:1,g=E(g,w),A(g);if("VLTR"===u&&"LLTR"===y)return w.dir=0,E(g,w);if("V"===G&&"L"===F&&B!==I)return g=A(g),"RTL"===B?t(g,"LLTR","VLTR",z,w):t(g,"LRTL","VRTL",z,w);if("VRTL"===u&&"LRTL"===y)return t(g,
"LRTL","VRTL",z,w);"L"===G&&"L"===F&&(u=w.swap,w.swap=u.substr(0,1)+"N","RTL"===B?(w.dir=1,g=E(g,w),w.swap="N"+u.substr(1,2),w.dir=0,g=E(g,w)):(w.dir=0,g=E(g,w),w.swap="N"+u.substr(1,2),g=t(g,"VLTR","LRTL",w.swap,w)));return g}function D(g){return(g=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(g))?"z">=g[0]?"ltr":"rtl":""}function E(g,u){g=g.split("");const y=[];C(g,y,u);if(0!==u.hiLevel&&u.swap.substr(0,1)!==u.swap.substr(1,2))for(let B=0;B<g.length;B++)if(1===
y[B]){var z=B;b:{let F=void 0;var w=g[B];let G=0,H=q.SwapTable.length-1;for(;G<=H;)if(F=Math.floor((G+H)/2),w<q.SwapTable[F][0])H=F-1;else if(w>q.SwapTable[F][0])G=F+1;else{w=q.SwapTable[F][1];break b}}g[z]=w}d(2,g,y,u);d(1,g,y,u);m=y;return g.join("")}function C(g,u,y){const z=g.length;var w=y.dir?q.impTabRtl:q.impTabLtr,B=0,F=-1;const G=[],H=[];y.hiLevel=y.dir;y.lastArabic=!1;y.hasUbatAl=!1;y.hasUbatB=!1;y.hasUbatS=!1;for(var I=0;I<z;I++){var L=I;{var N=g[I].charCodeAt(0);const J=q.PrimaryTable[N>>
8];N=J<q.TBBASE?J:q.UnicodeTable[J-q.TBBASE][N&255]}G[L]=N}for(L=0;L<z;L++){I=a(g,G,H,L,y);H[L]=I;B=w[B][I];N=B&240;B&=15;I=w[B][5];u[L]=I;if(0<N){if(16===N)for(;F<L;F++)u[F]=1;F=-1}if(w[B][6])-1===F&&(F=L);else if(-1<F){for(;F<L;F++)u[F]=I;F=-1}G[L]===q.UBAT_B&&(u[L]=0);y.hiLevel|=I}if(y.hasUbatS)for(g=0;g<z;g++)if(G[g]===q.UBAT_S)for(u[g]=y.dir,w=g-1;0<=w;w--)if(G[w]===q.UBAT_WS)u[w]=y.dir;else break}function A(g,u){g=g.split("");if(u){const y=[];C(g,y,u);m=y}g.reverse();k.reverse();return g.join("")}
function n(g){for(let u=0;u<q.ArabicAlefBetIntervalsBegine.length;u++)if(g>=q.ArabicAlefBetIntervalsBegine[u]&&g<=q.ArabicAlefBetIntervalsEnd[u])return!0;return!1}function l(g,u,y,z){for(;u*y<z&&c(g[u]);)u+=y;return u*y<z&&n(g[u])?!0:!1}function d(g,u,y,z){if(!(z.hiLevel<g))if(1!==g||1!==z.dir||z.hasUbatB){z=u.length;for(var w=0,B,F,G;w<z;){if(y[w]>=g){for(B=w+1;B<z&&y[B]>=g;)B++;for(F=B-1;w<F;w++,F--)G=u[w],u[w]=u[F],u[F]=G,G=k[w],k[w]=k[F],k[F]=G;w=B}w++}}else u.reverse(),k.reverse()}function a(g,
u,y,z,w){return{UBAT_L:()=>{w.lastArabic=!1;return q.UBAT_L},UBAT_R:()=>{w.lastArabic=!1;return q.UBAT_R},UBAT_ON:()=>q.UBAT_ON,UBAT_AN:()=>q.UBAT_AN,UBAT_EN:()=>w.lastArabic?q.UBAT_AN:q.UBAT_EN,UBAT_AL:()=>{w.lastArabic=!0;w.hasUbatAl=!0;return q.UBAT_R},UBAT_WS:()=>q.UBAT_ON,UBAT_CS:()=>{let B,F;if(1>z||z+1>=u.length||(B=y[z-1])!==q.UBAT_EN&&B!==q.UBAT_AN||(F=u[z+1])!==q.UBAT_EN&&F!==q.UBAT_AN)return q.UBAT_ON;w.lastArabic&&(F=q.UBAT_AN);return F===B?F:q.UBAT_ON},UBAT_ES:()=>(0<z?y[z-1]:q.UBAT_B)===
q.UBAT_EN&&z+1<u.length&&u[z+1]===q.UBAT_EN?q.UBAT_EN:q.UBAT_ON,UBAT_ET:()=>{if(0<z&&y[z-1]===q.UBAT_EN)return q.UBAT_EN;if(w.lastArabic)return q.UBAT_ON;let B=z+1;const F=u.length;for(;B<F&&u[B]===q.UBAT_ET;)B++;return B<F&&u[B]===q.UBAT_EN?q.UBAT_EN:q.UBAT_ON},UBAT_NSM:()=>{if("VLTR"===w.inFormat){for(var B=u.length,F=z+1;F<B&&u[F]===q.UBAT_NSM;)F++;if(F<B&&(B=g[z].charCodeAt[0],F=u[F],(1425<=B&&2303>=B||64286===B)&&(F===q.UBAT_R||F===q.UBAT_AL)))return q.UBAT_R}return 1>z||u[z-1]===q.UBAT_B?q.UBAT_ON:
y[z-1]},UBAT_B:()=>{w.lastArabic=!0;w.hasUbatB=!0;return w.dir},UBAT_S:()=>{w.hasUbatS=!0;return q.UBAT_ON},UBAT_LRE:()=>{w.lastArabic=!1;return q.UBAT_ON},UBAT_RLE:()=>{w.lastArabic=!1;return q.UBAT_ON},UBAT_LRO:()=>{w.lastArabic=!1;return q.UBAT_ON},UBAT_RLO:()=>{w.lastArabic=!1;return q.UBAT_ON},UBAT_PDF:()=>{w.lastArabic=!1;return q.UBAT_ON},UBAT_BN:()=>q.UBAT_ON}[q.TYPES_NAMES[u[z]]]()}function b(g,u){for(let y=0;y<q.BaseForm.length;y++)if(g===q.BaseForm[y])return u[y];return g}function c(g){return"\u064b"<=
g&&"\u0655">=g?!0:!1}function f(g){return"L"===g?"LTR":"R"===g?"RTL":"C"===g?"CLR":"D"===g?"CRL":""}function h(g,u){for(let y=0;y<q.AlefTable.length;y++)if(g===q.AlefTable[y])return u[y];return g}function p(g,u,y,z){for(let w=0;w<g.length;w++)if(g[w]>u||!y&&g[w]===u)g[w]+=z}let k=[],e=[],m=[];const r={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1,defOutFormat:""},v=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,
x=/[\u0591-\u06ff\ufb1d-\ufefc]/;return function(){function g(){this.inputFormat="ILYNN";this.outputFormat="VLNNN";this.sourceToTarget=[];this.targetToSource=[];this.levels=[]}var u=g.prototype;u.bidiTransform=function(y,z,w){this.sourceToTarget=[];this.targetToSource=[];if(!y)return"";var B=this.sourceToTarget,F=this.targetToSource,G=y.length;k=[];m=[];for(var H=0;H<G;H++)B[H]=H,F[H]=H,k[H]=H;if(!this.checkParameters(z,w))return y;z=this.inputFormat;w=this.outputFormat;B=y;G=f(z.charAt(1));B=f(w.charAt(1));
H="I"===z.charAt(0)?"L":z.charAt(0);F="I"===w.charAt(0)?"L":w.charAt(0);G=H+G;B=F+B;F=z.charAt(2)+w.charAt(2);r.defInFormat=G;r.defOutFormat=B;r.defSwap=F;y=t(y,G,B,F,r);B=!1;if("R"===w.charAt(1))B=!0;else if("C"===w.charAt(1)||"D"===w.charAt(1))B="rtl"===this.checkContextual(y);F=this.sourceToTarget=k;G=Array(F.length);for(H=0;H<F.length;H++)G[F[H]]=H;e=this.targetToSource=F=G;if(z.charAt(3)===w.charAt(3))B=y;else if("S"===w.charAt(3))if(z=B,w=!0,0===y.length)B="";else{void 0===z&&(z=!0);void 0===
w&&(w=!0);y=String(y);y=y.split("");G=0;B=1;F=y.length;z||(G=y.length-1,B=-1,F=1);var I=G;G=w;var L=0;H=[];for(var N=0;I*B<F;I+=B)if(n(y[I])||c(y[I])){var J;if(J="\u0644"===y[I])b:{for(var K=y,O=I+B,W=B,aa=F;O*W<aa&&c(K[O]);)O+=W;J=" ";if(O*W<aa)for(J=K[O],K=0;K<q.AlefTable.length;K++)if(q.AlefTable[K]===J){J=!0;break b}J=!1}if(J){y[I]=0===L?h(y[I+B],q.LamAlefInialTableFE):h(y[I+B],q.LamAlefMedialTableFE);I+=B;L=y;J=I;K=B;for(O=F;J*K<O&&c(L[J]);)J+=K;J*K<O&&(L[J]=" ");G&&(H[N]=I,N++);L=0}else{J=y[I];
if(1===L){K=I;if(l(y,I+B,B,F))b:for(O=y[I],W=0;W<q.BaseForm.length;W++){if(O===q.BaseForm[W]){O=q.MedialForm[W];break b}}else O=b(y[I],q.FinalForm);y[K]=O}else!0===l(y,I+B,B,F)?y[I]=b(y[I],q.InitialForm):y[I]=b(y[I],q.IsolatedForm);c(J)||(L=1);b:{for(K=0;K<q.StandAlonForm.length;K++)if(q.StandAlonForm[K]===J){J=!0;break b}J=!1}!0===J&&(L=0)}}else L=0;B=H;F="";for(G=0;G<y.length;G++){if(H=w){b:{for(H=0;H<B.length;H++)if(B[H]===G)break b;H=-1}H=-1<H}H?(p(e,G,!z,-1),k.splice(G,1)):F+=y[G]}B=F}else if(z=
y,w=B,y=!0,0===z.length)B="";else for(void 0===y&&(y=!0),void 0===w&&(w=!0),z=String(z),B="",F=z.split(""),G=0;G<z.length;G++)H=!1,"\ufe70"<=F[G]&&"\ufeff">F[G]?(N=z.charCodeAt(G),"\ufef5"<=F[G]&&"\ufefc">=F[G]?(w?(0<G&&y&&" "===F[G-1]?B=B.substring(0,B.length-1)+"\u0644":(B+="\u0644",H=!0),B+=q.AlefTable[(N-65269)/2]):(B+=q.AlefTable[(N-65269)/2],B+="\u0644",G+1<z.length&&y&&" "===F[G+1]?G++:H=!0),H&&(p(e,G,!0,1),k.splice(G,0,k[G]))):B+=q.FETo06Table[N-65136]):B+=F[G];this.sourceToTarget=k;this.targetToSource=
e;this.levels=m;return B};u._inputFormatSetter=function(y){if(!v.test(y))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=y};u._outputFormatSetter=function(y){if(!v.test(y))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=y};u.checkParameters=function(y,z){y?this._inputFormatSetter(y):y=this.inputFormat;z?this._outputFormatSetter(z):z=this.outputFormat;return y===z?!1:!0};u.checkContextual=function(y){y=D(y);if("ltr"!==
y&&"rtl"!==y){try{y=document.dir.toLowerCase()}catch(z){}"ltr"!==y&&"rtl"!==y&&(y="ltr")}return y};u.hasBidiChar=function(y){return x.test(y)};return g}()})},"esri/core/bidiEngineTables":function(){define(["exports"],function(q){q.AlefTable=["\u0622","\u0623","\u0625","\u0627"];q.ArabicAlefBetIntervalsBegine=["\u0621","\u0641"];q.ArabicAlefBetIntervalsEnd=["\u063a","\u064a"];q.BaseForm="\u0627\u0628\u062a\u062b\u062c\u062d\u062e\u062f\u0630\u0631\u0632\u0633\u0634\u0635\u0636\u0637\u0638\u0639\u063a\u0641\u0642\u0643\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u06cc\u0626\u0624".split("");
q.FETo06Table="\u064b\u064b\u064c\u061f\u064d\u061f\u064e\u064e\u064f\u064f\u0650\u0650\u0651\u0651\u0652\u0652\u0621\u0622\u0622\u0623\u0623\u0624\u0624\u0625\u0625\u0626\u0626\u0626\u0626\u0627\u0627\u0628\u0628\u0628\u0628\u0629\u0629\u062a\u062a\u062a\u062a\u062b\u062b\u062b\u062b\u062c\u062c\u062c\u062c\u062d\u062d\u062d\u062d\u062e\u062e\u062e\u062e\u062f\u062f\u0630\u0630\u0631\u0631\u0632\u0632\u0633\u0633\u0633\u0633\u0634\u0634\u0634\u0634\u0635\u0635\u0635\u0635\u0636\u0636\u0636\u0636\u0637\u0637\u0637\u0637\u0638\u0638\u0638\u0638\u0639\u0639\u0639\u0639\u063a\u063a\u063a\u063a\u0641\u0641\u0641\u0641\u0642\u0642\u0642\u0642\u0643\u0643\u0643\u0643\u0644\u0644\u0644\u0644\u0645\u0645\u0645\u0645\u0646\u0646\u0646\u0646\u0647\u0647\u0647\u0647\u0648\u0648\u0649\u0649\u064a\u064a\u064a\u064a\ufef5\ufef6\ufef7\ufef8\ufef9\ufefa\ufefb\ufefc\u061f\u061f\u061f".split("");
q.FinalForm="\ufe8e\ufe90\ufe96\ufe9a\ufe9e\ufea2\ufea6\ufeaa\ufeac\ufeae\ufeb0\ufeb2\ufeb6\ufeba\ufebe\ufec2\ufec6\ufeca\ufece\ufed2\ufed6\ufeda\ufede\ufee2\ufee6\ufeea\ufeee\ufef2\ufe88\ufe84\ufe82\ufe94\ufef0\ufbfd\ufe8a\ufe86\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8a\ufe86".split("");q.InitialForm="\ufe8d\ufe91\ufe97\ufe9b\ufe9f\ufea3\ufea7\ufea9\ufeab\ufead\ufeaf\ufeb3\ufeb7\ufebb\ufebf\ufec3\ufec7\ufecb\ufecf\ufed3\ufed7\ufedb\ufedf\ufee3\ufee7\ufeeb\ufeed\ufef3\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfe\ufe8b\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8b\ufe85".split("");
q.IsolatedForm="\ufe8d\ufe8f\ufe95\ufe99\ufe9d\ufea1\ufea5\ufea9\ufeab\ufead\ufeaf\ufeb1\ufeb5\ufeb9\ufebd\ufec1\ufec5\ufec9\ufecd\ufed1\ufed5\ufed9\ufedd\ufee1\ufee5\ufee9\ufeed\ufef1\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfc\ufe89\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe89\ufe85".split("");q.LamAlefInialTableFE=["\ufef5","\ufef7","\ufef9","\ufefb"];q.LamAlefMedialTableFE=["\ufef6","\ufef8","\ufefa","\ufefc"];q.MedialForm="\ufe8e\ufe92\ufe98\ufe9c\ufea0\ufea4\ufea8\ufeaa\ufeac\ufeae\ufeb0\ufeb4\ufeb8\ufebc\ufec0\ufec4\ufec8\ufecc\ufed0\ufed4\ufed8\ufedc\ufee0\ufee4\ufee8\ufeec\ufeee\ufef4\ufe88\ufe84\ufe82\ufe94\ufef0\ufbff\ufe8c\ufe86\ufe71\ufe72\ufe74\ufe77\ufe79\ufe7b\ufe7d\ufe7f\ufe80\ufe8c\ufe86".split("");
q.PrimaryTable=[100,0,0,0,0,101,102,103,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,104,4,4,4,0,4,0,4,0,4,4,4,0,0,4,4,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,0,0,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,
4,4,4,4,4,4,4,4,4,4,0,0,0,105,7,7,106,107];q.StandAlonForm="\u0621\u0622\u0623\u0624\u0625\u0627\u0629\u062f\u0630\u0631\u0632\u0648\u0649".split("");q.SwapTable=[["(",")"],[")","("],["\x3c","\x3e"],["\x3e","\x3c"],["[","]"],["]","["],["{","}"],["}","{"],["\u00ab","\u00bb"],["\u00bb","\u00ab"],["\u2039","\u203a"],["\u203a","\u2039"],["\u207d","\u207e"],["\u207e","\u207d"],["\u208d","\u208e"],["\u208e","\u208d"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232a"],["\u232a","\u2329"],["\ufe59",
"\ufe5a"],["\ufe5a","\ufe59"],["\ufe5b","\ufe5c"],["\ufe5c","\ufe5b"],["\ufe5d","\ufe5e"],["\ufe5e","\ufe5d"],["\ufe64","\ufe65"],["\ufe65","\ufe64"]];q.TBBASE=100;q.TYPES_NAMES="UBAT_L UBAT_R UBAT_EN UBAT_AN UBAT_ON UBAT_B UBAT_S UBAT_AL UBAT_WS UBAT_CS UBAT_ES UBAT_ET UBAT_NSM UBAT_LRE UBAT_RLE UBAT_PDF UBAT_LRO UBAT_RLO UBAT_BN".split(" ");q.UBAT_AL=7;q.UBAT_AN=3;q.UBAT_B=5;q.UBAT_BN=18;q.UBAT_CS=9;q.UBAT_EN=2;q.UBAT_ES=10;q.UBAT_ET=11;q.UBAT_L=0;q.UBAT_LRE=13;q.UBAT_LRO=16;q.UBAT_NSM=12;q.UBAT_ON=
4;q.UBAT_PDF=15;q.UBAT_R=1;q.UBAT_RLE=14;q.UBAT_RLO=17;q.UBAT_S=6;q.UBAT_WS=8;q.UnicodeTable=[[18,18,18,18,18,18,18,18,18,6,5,6,8,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,5,5,5,6,8,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,18,18,18,18,18,18,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,9,4,11,11,11,11,4,4,4,4,0,
4,4,18,4,4,11,11,2,2,4,0,4,4,4,2,0,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,4,4,4,4,4,4,4,12,12,12,12,12,12,12,12,12,12,12,12,
12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,1,12,1,12,12,1,12,12,1,12,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4],[3,3,3,3,4,4,4,4,7,11,11,7,9,7,4,4,12,12,12,12,12,12,12,12,12,12,12,7,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,3,3,3,3,3,3,3,3,3,3,11,3,3,7,7,7,12,
7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,3,4,12,12,12,12,12,12,7,7,12,12,4,12,12,12,12,7,7,2,2,2,2,2,2,2,2,2,2,7,7,7,7,7,7],[7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,7,7,12,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,4,4,7,7,7,7,7,7,
7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,12,12,12,12,12,12,12,12,12,1,1,4,4,4,4,1,4,4,4,4,4],[8,8,8,8,8,8,8,8,8,8,8,18,18,18,0,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,5,13,14,15,16,17,9,11,11,11,11,11,4,4,4,4,4,4,4,
4,4,4,4,4,4,4,4,9,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,18,18,18,18,18,4,4,4,4,4,18,18,18,18,18,18,2,0,4,4,2,2,2,2,2,2,10,10,4,4,4,0,2,2,2,2,2,2,2,2,2,2,10,10,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,
4,4,0,0,0,0,0,4,4,4,4,4,1,12,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,4,1,1,1,1,1,4,1,4,1,1,4,1,1,4,1,1,1,1,1,1,1,1,1,1,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],[12,12,12,12,12,12,12,
12,12,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,9,4,4,9,4,4,4,4,4,4,4,4,4,11,4,4,10,10,4,4,4,4,4,11,11,4,4,4,4,4,7,7,7,7,7,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
7,7,7,7,7,7,4,4,18],[4,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,4,4,4,11,11,4,4,4,11,11,4,4,4,4,4,
4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4]];q.impTabLtr=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]];q.impTabRtl=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]];Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/Rasterizer":function(){define(["./CIMSymbolHelper","./Rect","./SDFHelper","./utils"],function(q,t,D,E){return function(){function C(n){this._resourceManager=
n}var A=C.prototype;A.dispose=function(){this._rasterizationCanvas=null};A.rasterizeJSONResource=function(n,l,d){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));if("simple-fill"===n.type||"esriSFS"===n.type){const [e,m,r]=q.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,n.style,l);return{size:[m,r],image:new Uint32Array(e.buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0}}if("simple-line"===n.type||"esriSLS"===n.type||"line"===n.type&&n.dashTemplate){if("simple-line"===
n.type||"esriSLS"===n.type)switch(d=q.slsDashToTemplateArray(n.style,n.cap),n.cap){case "butt":n="Butt";break;case "square":n="Square";break;default:n="Round"}else d=n.dashTemplate,n=n.cim.capStyle;const [e,m,r]=q.SymbolHelper.rasterizeSimpleLine(d,n);return{size:[m,r],image:new Uint32Array(e.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}}let a,b;"simple-marker"===n.type||"esriSMS"===n.type||"line-marker"===n.type?(n=q.CIMSymbolHelper.fromSimpleMarker(n),b=D.getSDFInfo(n)):n.cim&&"CIMHatchFill"===
n.cim.type?(n=q.CIMSymbolHelper.fromCIMHatchFill(n.cim),a=new t(n.frame.xmin,-n.frame.ymax,n.frame.xmax-n.frame.xmin,n.frame.ymax-n.frame.ymin)):n.cim.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===n.cim.markerPlacement.type?(n=q.CIMSymbolHelper.fromCIMInsidePolygon(n.cim),a=new t(n.frame.xmin,-n.frame.ymax,n.frame.xmax-n.frame.xmin,n.frame.ymax-n.frame.ymin)):(n=n.cim,b=D.getSDFInfo(n));if(b&&!d){const [e,m,r]=D.buildSDF(b);return e?{size:[m,r],image:new Uint32Array(e.buffer),sdf:!0,simplePattern:!0,
anchorX:0,anchorY:0}:null}const [c,f,h,p,k]=q.CIMSymbolHelper.rasterize(this._rasterizationCanvas,n,a,this._resourceManager,!d);return c?{size:[f,h],image:new Uint32Array(c.buffer),sdf:!1,simplePattern:!1,anchorX:p,anchorY:k}:null};A.rasterizeImageResource=function(n,l,d,a){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));this._rasterizationCanvas.width=n;this._rasterizationCanvas.height=l;var b=this._rasterizationCanvas.getContext("2d");d instanceof ImageData?
b.putImageData(d,0,0):(d.setAttribute("width",`${n}px`),d.setAttribute("height",`${l}px`),b.drawImage(d,0,0,n,l));d=b.getImageData(0,0,n,l);d=new Uint8Array(d.data);if(a)for(var c of a)if(c&&c.oldColor&&4===c.oldColor.length&&c.newColor&&4===c.newColor.length){const [f,h,p,k]=c.oldColor,[e,m,r,v]=c.newColor;if(f!==e||h!==m||p!==r||k!==v)for(a=0;a<d.length;a+=4)f===d[a]&&h===d[a+1]&&p===d[a+2]&&k===d[a+3]&&(d[a]=e,d[a+1]=m,d[a+2]=r,d[a+3]=v)}for(a=0;a<d.length;a+=4)c=d[a+3]/255,d[a]*=c,d[a+1]*=c,d[a+
2]*=c;b=d;c=n;a=l;if(512<=c||512<=a){b=c/a;1<b?(c=512,a=Math.round(512/b)):(a=512,c=Math.round(512*b));b=new Uint8Array(4*c*a);const f=new Uint8ClampedArray(b.buffer);E.resampleHermite(d,n,l,f,c,a,!1)}return{size:[c,a],image:new Uint32Array(b.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};return C}()})},"esri/symbols/cim/CIMSymbolHelper":function(){define("exports ../../Color ../../core/BidiText ../../core/floatRGBA ../../core/lang ../../core/Logger ../../core/mathUtils ../../core/maybe ../../core/RandomLCG ../../core/screenUtils ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ./CIMPlacements ./CIMSymbolDrawHelper ./enums ./utils ../../views/2d/engine/vectorTiles/GeometryUtils ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/mesh/templates/shapingUtils".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c,f,h,p,k,e,m,r){function v(S,M){switch(M.type){case "CIMSymbolReference":return v(S,M.symbol);case "CIMPointSymbol":S.drawSymbol(M,{x:0,y:0});break;case "CIMLineSymbol":S.drawSymbol(M,{paths:[[[0,0],[0,1]]]});break;case "CIMPolygonSymbol":S.drawSymbol(M,{rings:[[[0,0],[0,1],[0,0]]]});break;case "CIMTextSymbol":S.drawSymbol(M,{x:0,y:0});break;case "CIMVectorMarker":{const Q=new f.Placement;S.drawMarker(M,Q)}}return S.envelope()}function x(S){if(!S)return 0;switch(S.type){case "CIMMarkerPlacementAlongLineSameSize":return Math.abs(S.offset);
case "CIMMarkerPlacementAlongLineRandomSize":return Math.abs(S.offset);case "CIMMarkerPlacementAtExtremities":return Math.abs(S.offset);case "CIMMarkerPlacementAtMeasuredUnits":return Math.abs(S.offset);case "CIMMarkerPlacementAtRatioPositions":return Math.abs(S.offset);case "CIMMarkerPlacementInsidePolygon":return 0;case "CIMMarkerPlacementOnLine":return Math.abs(S.offset);case "CIMMarkerPlacementOnVertices":return Math.abs(S.offset);case "CIMMarkerPlacementPolygonCenter":return 0;default:return 0}}
function g(S){if(!S)return 0;switch(S.type){case "CIMGeometricEffectArrow":return Math.abs(.5*S.width);case "CIMGeometricEffectBuffer":return Math.abs(S.size);case "CIMGeometricEffectExtension":return Math.abs(S.length);case "CIMGeometricEffectJog":return Math.abs(.5*S.length);case "CIMGeometricEffectMove":return Math.max(Math.abs(k.getValue(S.offsetX)),Math.abs(k.getValue(S.offsetY)));case "CIMGeometricEffectOffset":return Math.abs(S.offset);case "CIMGeometricEffectOffsetTangent":return Math.abs(S.offset);
case "CIMGeometricEffectRadial":return Math.abs(S.length);case "CIMGeometricEffectRegularPolygon":return Math.abs(S.radius);case "CIMGeometricEffectRotate":return 0;case "CIMGeometricEffectScale":return 0;case "CIMGeometricEffectTaperedPolygon":return.5*Math.max(Math.abs(S.fromWidth),Math.abs(S.toWidth));case "CIMGeometricEffectWave":return Math.abs(S.amplitude);default:return 0}}function u(S){if(!S)return 0;let M=0;for(const Q of S)M+=g(Q);return M}const y=Math.PI,z=y/2,w=96/72,B=Math.PI/180,F=A.getLogger("esri.symbols.cim.CIMSymbolHelper");
A=function(){function S(){}var M=S.prototype;M.getSymbolInflateSize=function(Q,Y,V,P,X){Q||(Q=[0,0,0,0]);return Y?this._getInflateSize(Q,Y,V,P,X):Q};S.safeSize=function(Q){const Y=Math.max(Math.abs(Q[0]),Math.abs(Q[2]));Q=Math.max(Math.abs(Q[1]),Math.abs(Q[3]));return Math.sqrt(Y*Y+Q*Q)};M._vectorMarkerBounds=function(Q,Y,V,P){let X=!0;const R=b.create();if(Y&&Y.markerGraphics)for(const T of Y.markerGraphics)Y=[0,0,0,0],T.geometry&&(c.getBoundsXY(R,T.geometry),Y[0]=0,Y[1]=0,Y[2]=0,Y[3]=0,this.getSymbolInflateSize(Y,
T.symbol,V,0,P),R[0]+=Y[0],R[1]+=Y[1],R[2]+=Y[2],R[3]+=Y[3],X?(Q[0]=R[0],Q[1]=R[1],Q[2]=R[2],Q[3]=R[3],X=!1):(Q[0]=Math.min(Q[0],R[0]),Q[1]=Math.min(Q[1],R[1]),Q[2]=Math.max(Q[2],R[2]),Q[3]=Math.max(Q[3],R[3])));return Q};M._getInflateSize=function(Q,Y,V,P,X){return void 0!==Y.symbolLayers?(Q=this._getLayersInflateSize(Q,Y.symbolLayers,V,P,X),Y=u(Y.effects),0<Y&&(Q[0]-=Y,Q[1]-=Y,Q[2]+=Y,Q[3]+=Y),Q):this._getTextInflatedSize(Q,Y,X)};M._getLayersInflateSize=function(Q,Y,V,P,X){let R=!0;if(!Y)return Q;
for(const da of Y)if(da){var T=[0,0,0,0];switch(da.type){case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":Y=da;var Z=Y.width;Z=Y.capStyle===p.LineCapStyle.Square||Y.joinStyle===p.LineJoinStyle.Miter?Z/1.4142135623730951:Z/2;T[0]=-Z;T[1]=-Z;T[2]=Z;T[3]=Z;break;case "CIMCharacterMarker":case "CIMVectorMarker":case "CIMPictureMarker":Y=da;if("CIMVectorMarker"===da.type){if(Z=da,T=this._vectorMarkerBounds(T,Z,V,X),Z.frame){var ca=(Z.frame.xmin+Z.frame.xmax)/2,ja=(Z.frame.ymin+Z.frame.ymax)/
2;T[0]-=ca;T[1]-=ja;T[2]-=ca;T[3]-=ja;Z=Z.size/(Z.frame.ymax-Z.frame.ymin);T[0]*=Z;T[1]*=Z;T[2]*=Z;T[3]*=Z}}else"CIMPictureMarker"===da.type?(T=da,ca=V.getResource(T.url),Z=1,l.isSome(ca)&&ca.height&&(Z=ca.width/ca.height),ca=Y.size/2,T=Y.size*Z*T.scaleX/2,T=[-T,-ca,T,ca]):(T=Y.size/2,T=[-T,-T,T,T]);Y.anchorPoint&&("Absolute"===Y.anchorPointUnits?(Z=Y.anchorPoint.x,ca=Y.anchorPoint.y):(Z=Y.anchorPoint.x*(T[2]-T[0]),ca=Y.anchorPoint.y*(T[3]-T[1])),T[0]-=Z,T[1]-=ca,T[2]-=Z,T[3]-=ca);Z=k.getValue(Y.rotation);
Y.rotateClockwise&&(Z=-Z);P&&(Z-=P);Z&&(ca=B*Z,Z=Math.cos(ca),ca=Math.sin(ca),ja=b.create([e.C_INFINITY,e.C_INFINITY,-e.C_INFINITY,-e.C_INFINITY]),b.expandPointInPlace(ja,[T[0]*Z-T[1]*ca,T[0]*ca+T[1]*Z]),b.expandPointInPlace(ja,[T[0]*Z-T[3]*ca,T[0]*ca+T[3]*Z]),b.expandPointInPlace(ja,[T[2]*Z-T[1]*ca,T[2]*ca+T[1]*Z]),b.expandPointInPlace(ja,[T[2]*Z-T[3]*ca,T[2]*ca+T[3]*Z]),T=ja);Z=k.getValue(Y.offsetX);ca=k.getValue(Y.offsetY);if(P){var U=B*P;ja=Math.cos(U);U=Math.sin(U);const fa=Z*U+ca*ja;Z=Z*ja-
ca*U;ca=fa}T[0]+=Z;T[1]+=ca;T[2]+=Z;T[3]+=ca;Y=x(Y.markerPlacement);0<Y&&(T[0]-=Y,T[1]-=Y,T[2]+=Y,T[3]+=Y)}Y=u(da.effects);0<Y&&(T[0]-=Y,T[1]-=Y,T[2]+=Y,T[3]+=Y);R?(Q[0]=T[0],Q[1]=T[1],Q[2]=T[2],Q[3]=T[3],R=!1):(Q[0]=Math.min(Q[0],T[0]),Q[1]=Math.min(Q[1],T[1]),Q[2]=Math.max(Q[2],T[2]),Q[3]=Math.max(Q[3],T[3]))}return Q};M._getTextInflatedSize=function(Q,Y,V){var P,X;const R=null!=(P=Y.height)?P:10;Q[0]=-R/2;Q[1]=-R/2;Q[2]=R/2;Q[3]=R/2;if(!V)return Q;V=V.get(Y);if(!V)return Q;const {text:T,mosaicItem:Z}=
V;if(!Z||0===Z.glyphMosaicItems.length)return Q;V=h.lineGapType2LineHeight(Y.lineGapType,null!=(X=Y.lineGap)?X:0,R);X=D.bidiText(T)[1];Y=r.shapeGlyphs(Z.glyphMosaicItems,X,{scale:R/m.GLYPH_SIZE,angle:k.getValue(Y.angle),xOffset:k.getValue(Y.offsetX),yOffset:k.getValue(Y.offsetY),hAlign:h.horizontalAlignment2HAlign(Y.horizontalAlignment),vAlign:h.verticalAlignment2VAlign(Y.verticalAlignment),maxLineWidth:512,lineHeight:m.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(V||1,4)),decoration:Y.font.decoration||
"none",isCIM:!0}).boundsT;Q[0]=Y.x-Y.halfWidth;Q[1]=-Y.y-Y.halfHeight;Q[2]=Y.x+Y.halfWidth;Q[3]=-Y.y+Y.halfHeight;return Q};return S}();let G=function(){function S(){}S.getEnvelope=function(M,Q){Q=new h.EnvDrawHelper(Q);if(Array.isArray(M)){let Y;for(const V of M)Y?Y.union(v(Q,V)):Y=v(Q,V);return Y}return v(Q,M)};S.getTextureAnchor=function(M,Q){M=this.getEnvelope(M,Q);if(!M)return[0,0,0];Q=M.height*w+2;return[(M.x+.5*M.width)*w/(M.width*w+2),-(M.y+.5*M.height)*w/Q,Q]};S.rasterize=function(M,Q,Y,
V,P=!0){var X=Y||this.getEnvelope(Q,V);if(!X)return[null,0,0,0,0];const R=(X.x+.5*X.width)*w,T=(X.y+.5*X.height)*w;M.width=X.width*w;M.height=X.height*w;Y||(M.width+=2,M.height+=2);Y=M.getContext("2d");X=h.Transformation.createScale(w,-w);X.translate(.5*M.width-R,.5*M.height+T);V=new h.CanvasDrawHelper(Y,V,X);switch(Q.type){case "CIMPointSymbol":V.drawSymbol(Q,{type:"point",x:0,y:0});break;case "CIMVectorMarker":X=new f.Placement,V.drawMarker(Q,X)}Q=Y.getImageData(0,0,M.width,M.height);Q=new Uint8Array(Q.data);
if(P)for(V=0;V<Q.length;V+=4)P=Q[V+3]/255,Q[V]*=P,Q[V+1]*=P,Q[V+2]*=P;return[Q,M.width,M.height,-R/M.width,-T/M.height]};S.fromTextSymbol=function(M){const {angle:Q,color:Y,font:V,haloColor:P,haloSize:X,horizontalAlignment:R,kerning:T,text:Z,verticalAlignment:ca,xoffset:ja,yoffset:U}=M;let da,fa;if(V){var ia=V.family;var ea=V.style;var ha=V.weight;da=V.size;fa=V.decoration}M=!1;Z&&(M=D.bidiText(Z)[1]);var ka=p.BlockProgression.BTT,la=p.FontEffects.Normal,ma=p.FontEncoding.Unicode;ia=ia||"Arial";b:{if(ha)switch(ha.toLowerCase()){case "bold":case "bolder":ha=
"bold";break b}ha=""}b:{if(ea)switch(ea.toLowerCase()){case "italic":case "oblique":ea="italic";break b}ea=""}ha=ha&&ea?`${ha}-${ea}`:`${ha}${ea}`;return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:10,billboardMode3D:"FaceNearPlane",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMTextSymbol",angle:Q,blockProgression:ka,depth3D:1,extrapolateBaselines:!0,
fontEffects:la,fontEncoding:ma,fontFamilyName:ia,fontStyleName:ha,fontType:p.FontType.Unspecified,haloSize:X,height:da,hinting:p.GlyphHinting.Default,horizontalAlignment:J(null!=R?R:"center"),kerning:T,letterWidth:100,ligatures:!0,lineGapType:"Multiple",offsetX:k.getValue(ja),offsetY:k.getValue(U),strikethrough:"line-through"===fa,underline:"underline"===fa,symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:O(Y)}]},haloSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",
enable:!0,color:O(P)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:"Normal",textDirection:M?p.TextReadingDirection.RTL:p.TextReadingDirection.LTR,verticalAlignment:K(null!=ca?ca:"baseline"),verticalGlyphOrientation:p.VerticalGlyphOrientation.Right,wordSpacing:100,billboardMode3D:p.BillBoardMode.FaceNearPlane},textString:Z}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:"Display"}};S.fromPictureFillSymbol=function(M){const {height:Q,outline:Y,width:V,
xoffset:P,xscale:X,yoffset:R,yscale:T}=M,Z=[],ca={type:"CIMPolygonSymbol",symbolLayers:Z};if(Y){const {cap:U,join:da,miterLimit:fa,width:ia}=Y;Z.push({type:"CIMSolidStroke",color:O(Y.color),capStyle:L(U),joinStyle:N(da),miterLimit:fa,width:ia})}let ja=M.url;"esriPFS"===M.type&&M.imageData&&(ja=M.imageData);M="angle"in M?M.angle:0;Z.push({type:"CIMPictureFill",invertBackfaceTexture:!1,scaleX:1,textureFilter:p.TextureFilter.Picture,tintColor:null,url:ja,height:Q*(T||1),width:V*(X||1),offsetX:k.getValue(P),
offsetY:k.getValue(R),rotation:k.getValue(-M),colorSubstitutions:null});return ca};S.fromSimpleFillSymbol=function(M){const {color:Q,style:Y,outline:V}=M;M=[];const P={type:"CIMPolygonSymbol",symbolLayers:M};var X=null;if(V){const {cap:T,join:Z,style:ca}=V;"solid"!==ca&&"none"!==ca&&"esriSLSSolid"!==ca&&"esriSLSNull"!==ca&&(X=[{type:"CIMGeometricEffectDashes",dashTemplate:W(ca,T),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);M.push({type:"CIMSolidStroke",color:O(V.color),capStyle:L(T),
joinStyle:N(Z),miterLimit:V.miterLimit,width:V.width,effects:X})}if(Y&&"solid"!==Y&&"none"!==Y&&"esriSFSSolid"!==Y&&"esriSFSNull"!==Y){X={type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",color:O(Q),capStyle:p.LineCapStyle.Butt,joinStyle:p.LineJoinStyle.Miter,width:.75}]};let T=0;var R=n.nextPowerOfTwo(Math.ceil(window.devicePixelRatio));R=ba(Y)?8*R:10*R;switch(Y){case "vertical":case "esriSFSVertical":T=90;break;case "forward-diagonal":case "esriSFSForwardDiagonal":T=-45;break;case "backward-diagonal":case "esriSFSBackwardDiagonal":T=
45;break;case "cross":case "esriSFSCross":T=0;break;case "diagonal-cross":case "esriSFSDiagonalCross":T=-45}M.push({type:"CIMHatchFill",lineSymbol:X,offsetX:0,offsetY:0,rotation:T,separation:R});"cross"===Y||"esriSFSCross"===Y?M.push({type:"CIMHatchFill",lineSymbol:C.clone(X),offsetX:0,offsetY:0,rotation:90,separation:R}):("diagonal-cross"===Y||"esriSFSDiagonalCross"===Y)&&M.push({type:"CIMHatchFill",lineSymbol:C.clone(X),offsetX:0,offsetY:0,rotation:45,separation:R})}else!Y||"solid"!==Y&&"esriSFSSolid"!==
Y||M.push({type:"CIMSolidFill",enable:!0,color:O(Q)});return P};S.fromSimpleLineSymbol=function(M){const {cap:Q,color:Y,join:V,marker:P,miterLimit:X,style:R,width:T}=M;M=null;"solid"!==R&&"none"!==R&&"esriSLSSolid"!==R&&"esriSLSNull"!==R&&(M=[{type:"CIMGeometricEffectDashes",dashTemplate:W(R,Q),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);const Z=[];if(P){let ca;switch(P.placement){case "begin-end":ca=p.ExtremityPlacement.Both;break;case "begin":ca=p.ExtremityPlacement.JustBegin;
break;case "end":ca=p.ExtremityPlacement.JustEnd;break;default:ca=p.ExtremityPlacement.None}const ja=S.fromSimpleMarker(P,T,Y).symbolLayers[0];ja.markerPlacement={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:ca,offsetAlongLine:0};Z.push(ja)}"none"!==R&&"esriSLSNull"!==R&&Z.push({type:"CIMSolidStroke",color:O(Y),capStyle:L(Q),joinStyle:N(V),miterLimit:X,width:T,effects:M});return{type:"CIMLineSymbol",symbolLayers:Z}};S.fromPictureMarker=function(M){const {angle:Q,
height:Y,width:V,xoffset:P,yoffset:X}=M;let R=M.url;"esriPMS"===M.type&&M.imageData&&(R=M.imageData);return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:p.TextureFilter.Picture,tintColor:null,url:R,size:Y,width:V,offsetX:k.getValue(P),offsetY:k.getValue(X),rotation:k.getValue(-Q)}]}};S.fromSimpleMarker=function(M,Q,Y){var V,{style:P}=M;Y=null!=(V=M.color)?V:Y;if("path"===P){Q=[];"outline"in M&&M.outline&&(V=M.outline,Q.push({type:"CIMSolidStroke",
enable:!0,width:a.pt2px(Math.round(a.px2pt(V.width))),color:O(V.color)}));Q.push({type:"CIMSolidFill",enable:!0,color:O(Y),path:M.path});const [Z,ca]=aa("square");return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:k.getValue(-M.angle),size:k.getValue(M.size||6),offsetX:k.getValue(M.xoffset),offsetY:k.getValue(M.yoffset),frame:Z,markerGraphics:[{type:"CIMMarkerGraphic",geometry:ca,symbol:{type:"CIMPolygonSymbol",symbolLayers:Q}}]}]}}const [X,R]=aa(P);let T;R&&X&&
(V=[],"outline"in M&&M.outline?(P=M.outline,V.push({type:"CIMSolidStroke",enable:!0,width:.667<P.width?a.pt2px(Math.round(a.px2pt(P.width))):P.width,color:O(P.color)})):!Q||"line-marker"!==M.type||"cross"!==M.style&&"x"!==M.style||V.push({type:"CIMSolidStroke",enable:!0,width:Q,color:O(Y)}),V.push({type:"CIMSolidFill",enable:!0,color:O(Y)}),Y={type:"CIMPolygonSymbol",symbolLayers:V},T={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:k.getValue(-M.angle),size:k.getValue(M.size||
6*Q),offsetX:k.getValue(M.xoffset),offsetY:k.getValue(M.yoffset),frame:X,markerGraphics:[{type:"CIMMarkerGraphic",geometry:R,symbol:Y}]}]});return T};S.fromCIMHatchFill=function(M){var Q;const Y=null!=(Q=M.separation)?Q:4;Q=Y/2;const V=M.lineSymbol;for(M=this._getLineSymbolPeriod(M.lineSymbol)||4;4>M;)M*=2;M/=2;return{type:"CIMVectorMarker",frame:{xmin:-M,xmax:M,ymin:-Q,ymax:Q},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-M,0],[M,0]]]},symbol:V}],size:Y}};S._getLineSymbolPeriod=function(M){if(M){const Q=
this._getEffectsRepeat(M.effects);if(Q)return Q;if(M.symbolLayers)for(const Y of M.symbolLayers)if(Y){if(M=this._getEffectsRepeat(Y.effects))return M;switch(Y.type){case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":case "CIMObjectMarker3D":case "CIMglTFMarker3D":if(M=this._getPlacementRepeat(Y.markerPlacement))return M}}}return 0};S._getEffectsRepeat=function(M){if(M)for(var Q of M)if(Q)switch(Q.type){case "CIMGeometricEffectDashes":if((M=Q.dashTemplate)&&M.length){Q=0;for(const Y of M)Q+=
Y;M.length&1&&(Q*=2);return Q}break;case "CIMGeometricEffectWave":return Q.period;default:F.error(`unsupported geometric effect type ${Q.type}`)}return 0};S._getPlacementRepeat=function(M){if(M)switch(M.type){case "CIMMarkerPlacementAlongLineSameSize":case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineVariableSize":if((M=M.placementTemplate)&&M.length){let Q=0;for(const Y of M)Q+=Y;M.length&1&&(Q*=2);return Q}}return 0};S.fromCIMInsidePolygon=function(M){var Q,Y=M.markerPlacement;
const V={type:M.type,...M,markerPlacement:null,anchorPoint:null};M=Math.abs(Y.stepX);const P=Math.abs(Y.stepY);var X=(null!=(Q=Y.randomness)?Q:100)/100;let R,T;if("Random"===Y.gridType){Q=a.px2pt(m.RANDOM_INSIDE_POLYGON_TEXTURE_SIZE);const Z=Math.max(Math.floor(Q/M),1),ca=Math.max(Math.floor(Q/P),1);Q=Z*M/2;R=ca*P/2;T=2*R;Y=new d(Y.seed);const ja=X*M/1.5,U=X*P/1.5;X=[];for(let da=0;da<Z;da++)for(let fa=0;fa<ca;fa++){const ia=da*M-Q+ja*(.5-Y.getFloat()),ea=fa*P-R+U*(.5-Y.getFloat());X.push({x:ia,y:ea});
0===da&&X.push({x:ia+2*Q,y:ea});0===fa&&X.push({x:ia,y:ea+2*R})}}else!0===Y.shiftOddRows?(Q=M/2,R=P,T=2*P,X=[{x:-Q,y:0},{x:Q,y:0},{x:0,y:R},{x:0,y:-R}]):(Q=M/2,R=P/2,T=P,X=[{x:0,y:0}]);M=X.map(Z=>({type:"CIMMarkerGraphic",geometry:Z,symbol:{type:"CIMPointSymbol",symbolLayers:[V]}}));return{type:"CIMVectorMarker",frame:{xmin:-Q,xmax:Q,ymin:-R,ymax:R},markerGraphics:M,size:T}};S.getFillColor=function(M){if(!M)return null;switch(M.type){case "CIMPolygonSymbol":if(M.symbolLayers)for(const Q of M.symbolLayers)if(M=
S.getFillColor(Q),null!=M)return M;break;case "CIMTextSymbol":return S.getFillColor(M.symbol);case "CIMSolidFill":return M.color}};S.getStrokeColor=function(M){if(M)switch(M.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(M.symbolLayers)for(const Q of M.symbolLayers)if(M=S.getStrokeColor(Q),void 0!==M)return M;break;case "CIMTextSymbol":return S.getStrokeColor(M.symbol);case "CIMSolidStroke":return M.color}};S.getStrokeWidth=function(M){if(M)switch(M.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(M.symbolLayers)for(const Q of M.symbolLayers)if(M=
S.getStrokeWidth(Q),void 0!==M)return M;break;case "CIMTextSymbol":return S.getStrokeWidth(M.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return M.width}};S.getSize=function(M){if(M)switch(M.type){case "CIMTextSymbol":return M.height;case "CIMPointSymbol":var Q=0;if(M.symbolLayers)for(var Y of M.symbolLayers)if(Y)switch(Y.type){case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":case "CIMObjectMarker3D":case "CIMglTFMarker3D":M=Y.size,M>Q&&(Q=
M)}return Q;case "CIMLineSymbol":case "CIMPolygonSymbol":Y=0;if(M.symbolLayers)for(Q of M.symbolLayers)if(Q)switch(Q.type){case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":M=Q.width;M>Y&&(Y=M);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":case "CIMObjectMarker3D":case "CIMglTFMarker3D":k.isCIMMarkerStrokePlacement(Q.markerPlacement)&&(M=Q.size,M>Y&&(Y=M))}return Y}};S.getMarkerScaleRatio=function(M){if(M)switch(M.type){case "CIMVectorMarker":if(!1!==
M.scaleSymbolsProportionally&&M.frame)return M.size/(M.frame.ymax-M.frame.ymin)}return 1};return S}(),H=function(){function S(){}S.rasterizeSimpleFill=function(M,Q,Y){"solid"!==Q&&"none"!==Q&&"esriSFSSolid"!==Q&&"esriSFSNull"!==Q||console.error("Unexpected: style does not require rasterization");Y=n.nextPowerOfTwo(Math.ceil(Y));var V=ba(Q)?8*Y:16*Y;const P=2*Y;M.width=V;M.height=V;const X=M.getContext("2d");X.strokeStyle="#FFFFFF";X.lineWidth=Y;X.beginPath();if("vertical"===Q||"cross"===Q||"esriSFSCross"===
Q||"esriSFSVertical"===Q)X.moveTo(V/2,-P),X.lineTo(V/2,V+P);if("horizontal"===Q||"cross"===Q||"esriSFSCross"===Q||"esriSFSHorizontal"===Q)X.moveTo(-P,V/2),X.lineTo(V+P,V/2);if("forward-diagonal"===Q||"diagonal-cross"===Q||"esriSFSDiagonalCross"===Q||"esriSFSForwardDiagonal"===Q)X.moveTo(-P,-P),X.lineTo(V+P,V+P),X.moveTo(V-P,-P),X.lineTo(V+P,P),X.moveTo(-P,V-P),X.lineTo(P,V+P);if("backward-diagonal"===Q||"diagonal-cross"===Q||"esriSFSBackwardDiagonal"===Q||"esriSFSDiagonalCross"===Q)X.moveTo(V+P,-P),
X.lineTo(-P,V+P),X.moveTo(P,-P),X.lineTo(-P,P),X.moveTo(V+P,V-P),X.lineTo(V-P,V+P);X.stroke();Q=X.getImageData(0,0,M.width,M.height);Q=new Uint8Array(Q.data);for(V=0;V<Q.length;V+=4)Y=Q[V+3]/255,Q[V]*=Y,Q[V+1]*=Y,Q[V+2]*=Y;return[Q,M.width,M.height]};S.rasterizeSimpleLine=function(M,Q){return this.rasterizeDash(M,Q)};S.rasterizeDash=function(M,Q){var Y="Butt"===Q,V="Square"===Q;Q=!Y&&!V;1===M.length%2&&(M=[...M,...M]);var P=0;for(var X of M)P+=X;X=Math.round(15.5*P);P=new Float32Array(31*X);let R=
0,T=0,Z=.5,ca=!0;for(var ja of M){R=T;for(T+=15.5*ja;Z<=T;){for(M=.5;31>M;){const U=Q?(M-15.5)*(M-15.5):Math.abs(M-15.5);P[(M-.5)*X+Z-.5]=ca?Y?Math.max(Math.max(R+7.75-Z,U),Math.max(Z-T+7.75,U)):U:Q?Math.min((Z-R)*(Z-R)+U,(Z-T)*(Z-T)+U):V?Math.min(Math.max(Z-R,U),Math.max(T-Z,U)):Math.min(Math.max(Z-R+7.75,U),Math.max(T+7.75-Z,U));M++}Z++}ca=!ca}Y=P.length;ja=new Uint8Array(4*Y);for(V=0;V<Y;++V)E.packFloatRGBA((Q?Math.sqrt(P[V]):P[V])/15.5,ja,4*V);return[ja,X,31]};return S}(),I=function(){function S(){}
S.findApplicableOverrides=function(M,Q,Y){if(M&&Q){if(M.primitiveName){let V=!1;for(const P of Y)if(P.primitiveName===M.primitiveName){V=!0;break}if(!V)for(const P of Q)P.primitiveName===M.primitiveName&&Y.push(P)}switch(M.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(M.effects)for(const V of M.effects)S.findApplicableOverrides(V,Q,Y);if(M.symbolLayers)for(const V of M.symbolLayers)S.findApplicableOverrides(V,Q,Y);break;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMSolidFill":case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":if(M.effects)for(const V of M.effects)S.findApplicableOverrides(V,
Q,Y);M.markerPlacement&&S.findApplicableOverrides(M.markerPlacement,Q,Y);if("CIMVectorMarker"===M.type){if(M.markerGraphics)for(const V of M.markerGraphics)S.findApplicableOverrides(V,Q,Y),S.findApplicableOverrides(V.symbol,Q,Y)}else"CIMCharacterMarker"===M.type?S.findApplicableOverrides(M.symbol,Q,Y):"CIMHatchFill"===M.type?S.findApplicableOverrides(M.lineSymbol,Q,Y):"CIMPictureMarker"===M.type&&S.findApplicableOverrides(M.animatedSymbolProperties,Q,Y)}}};S.findEffectOverrides=function(M,Q,Y){if(Q&&
M){var V=M.length;for(let X=0;X<V;X++){var P=M[X];if(P=null==P?void 0:P.primitiveName){let R=!1;for(const T of Y)if(T.primitiveName===P){R=!0;break}if(!R)for(const T of Q)T.primitiveName===P&&Y.push(T)}}}};S.applyOverrides=function(M,Q,Y,V){if(Q){if(M.primitiveName)for(const X of Q)if(X.primitiveName===M.primitiveName){var P=(P=X.propertyName)?P.charAt(0).toLowerCase()+P.substr(1):P;V&&V.push({cim:M,nocapPropertyName:P,value:M[P]});X.expression&&(X.value=S.toValue(X.propertyName,X.expression));if(Y){let R=
!1;for(const T of Y)T.primitiveName===M.primitiveName&&(R=!0);R||Y.push(X)}M[P]=X.value}switch(M.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(M.effects)for(const X of M.effects)S.applyOverrides(X,Q,Y,V);if(M.symbolLayers)for(const X of M.symbolLayers)S.applyOverrides(X,Q,Y,V);break;case "CIMSolidStroke":case "CIMSolidFill":case "CIMVectorMarker":if(M.effects)for(const X of M.effects)S.applyOverrides(X,Q,Y,V);if("CIMVectorMarker"===M.type&&M.markerGraphics)for(const X of M.markerGraphics)S.applyOverrides(X,
Q,Y,V),S.applyOverrides(X.symbol,Q,Y,V)}}};S.restoreOverrides=function(M){for(const Q of M)Q.cim[Q.nocapPropertyName]=Q.value};S.buildOverrideKey=function(M){let Q="";for(const Y of M)void 0!==Y.value&&(Q+=`${Y.primitiveName}${Y.propertyName}${JSON.stringify(Y.value)}`);return Q};S.toValue=function(M,Q){return"DashTemplate"===M?Q.split(" ").map(Y=>Number(Y)):"Color"===M?(M=(new t(Q)).toRgba(),M[3]*=255,M):Q};return S}();const L=S=>{if(!S)return p.LineCapStyle.Butt;switch(S){case "butt":return p.LineCapStyle.Butt;
case "square":return p.LineCapStyle.Square;case "round":return p.LineCapStyle.Round}},N=S=>{if(!S)return p.LineJoinStyle.Miter;switch(S){case "miter":return p.LineJoinStyle.Miter;case "round":return p.LineJoinStyle.Round;case "bevel":return p.LineJoinStyle.Bevel}},J=S=>{if(l.isNone(S))return"Center";switch(S){case "left":return"Left";case "right":return"Right";case "center":return"Center"}},K=S=>{if(l.isNone(S))return"Center";switch(S){case "baseline":return"Baseline";case "top":return"Top";case "middle":return"Center";
case "bottom":return"Bottom"}},O=S=>{if(!S)return[0,0,0,0];const {r:M,g:Q,b:Y,a:V}=S;return[M,Q,Y,255*V]},W=(S,M)=>{M="butt"===M;switch(S){case "dash":case "esriSLSDash":return M?[4,3]:[3,4];case "dash-dot":case "esriSLSDashDot":return M?[4,3,1,3]:[3,4,0,4];case "dot":case "esriSLSDot":return M?[1,3]:[0,4];case "long-dash":case "esriSLSLongDash":return M?[8,3]:[7,4];case "long-dash-dot":case "esriSLSLongDashDot":return M?[8,3,1,3]:[7,4,0,4];case "long-dash-dot-dot":case "esriSLSDashDotDot":return M?
[8,3,1,3,1,3]:[7,4,0,4,0,4];case "short-dash":case "esriSLSShortDash":return M?[4,1]:[3,2];case "short-dash-dot":case "esriSLSShortDashDot":return M?[4,1,1,1]:[3,2,0,2];case "short-dash-dot-dot":case "esriSLSShortDashDotDot":return M?[4,1,1,1,1,1]:[3,2,0,2,0,2];case "short-dot":case "esriSLSShortDot":return M?[1,1]:[0,2];case "solid":case "esriSLSSolid":case "none":return F.error("Unexpected: style does not require rasterization"),[0,0];default:return F.error(`Tried to rasterize SLS, but found an unexpected style: ${S}!`),
[0,0]}},aa=S=>{if("circle"===S||"esriSMSCircle"===S){var M=Math.acos(.995);S=Math.ceil(y/M/4);0===S&&(S=1);M=z/S;S*=4;var Q=[];Q.push([50,0]);for(let Y=1;Y<S;Y++)Q.push([50*Math.cos(Y*M),-50*Math.sin(Y*M)]);Q.push([50,0]);M={rings:[Q]};Q={xmin:-50,ymin:-50,xmax:50,ymax:50}}else"cross"===S||"esriSMSCross"===S?(M={rings:[[[0,50],[0,0],[50,0],[50,-0],[0,-0],[0,-50],[-0,-50],[-0,-0],[-50,-0],[-50,0],[-0,0],[-0,50],[0,50]]]},Q={xmin:-50,ymin:-50,xmax:50,ymax:50}):"diamond"===S||"esriSMSDiamond"===S?(M=
{rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},Q={xmin:-50,ymin:-50,xmax:50,ymax:50}):"square"===S||"esriSMSSquare"===S?(M={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},Q={xmin:-50,ymin:-50,xmax:50,ymax:50}):"x"===S||"esriSMSX"===S?(M={rings:[[[0,0],[50,50],[50,50],[0,0],[50,-50],[50,-50],[0,-0],[-50,-50],[-50,-50],[-0,0],[-50,50],[-50,50],[0,0]]]},Q={xmin:-50,ymin:-50,xmax:50,ymax:50}):"triangle"===S||"esriSMSTriangle"===S?(S=2/3*100,Q=S-100,M={rings:[[[-57.735026918962575,Q],[0,S],
[57.735026918962575,Q],[-57.735026918962575,Q]]]},Q={xmin:-57.735026918962575,ymin:Q,xmax:57.735026918962575,ymax:S}):"arrow"===S&&(M={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},Q={xmin:-50,ymin:-50,xmax:50,ymax:50});return[Q,M]},ba=S=>"vertical"===S||"horizontal"===S||"cross"===S||"esriSFSCross"===S||"esriSFSVertical"===S||"esriSFSHorizontal"===S;q.CIMSimbolInflatedSizeHelper=A;q.CIMSymbolHelper=G;q.OverrideHelper=I;q.SymbolHelper=H;q.slsDashToTemplateArray=W;q.symbolToCIM=
function(S){if(!S||!S.type)return null;let M;switch(S.type){case "cim":return S.data;case "web-style":return S;case "simple-marker":M=G.fromSimpleMarker(S);break;case "picture-marker":M=G.fromPictureMarker(S);break;case "simple-line":M=G.fromSimpleLineSymbol(S);break;case "simple-fill":M=G.fromSimpleFillSymbol(S);break;case "picture-fill":M=G.fromPictureFillSymbol(S);break;case "text":M=G.fromTextSymbol(S)}return{type:"CIMSymbolReference",symbol:M}};Object.defineProperties(q,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/floatRGBA":function(){define(["exports","./mathUtils"],function(q,t){function D(l,d=0){let a=0;for(let b=0;4>b;b++)a+=l[d+b]*A[b];return a}function E(l){return l-Math.floor(l)}const C=[1,256,65536,16777216],A=[1/256,1/65536,1/16777216,1/4294967296],n=D(new Uint8ClampedArray([255,255,255,255]));q.packFloatRGBA=function(l,d,a=0){l=t.clamp(l,0,n);for(let b=0;4>b;b++)d[a+b]=Math.floor(256*E(l*C[b]))};q.unpackFloatRGBA=D;Object.defineProperties(q,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMPlacements":function(){define(["exports"],function(q){let t=function(){function E(){this.setIdentity()}var C=E.prototype;C.getAngle=function(){if(null==this.rz||0===this.rz&&1!==this.rz_c&&0!==this.rz_s)this.rz=Math.atan2(this.rz_s,this.rz_c);return this.rz};C.setIdentity=function(){this.tz=this.ty=this.tx=0;this.s=1;this.rz=this.ry=this.rx=0;this.rz_c=1;this.rz_s=0};C.setTranslate=function(A,n){this.tx=A;this.ty=n};C.setTranslateZ=function(A){this.tz=
A};C.setRotateCS=function(A,n){this.rz=void 0;this.rz_c=A;this.rz_s=n};C.setRotate=function(A){this.rz=A;this.rz_s=this.rz_c=void 0};C.setRotateY=function(A){this.ry=A};C.setScale=function(A){this.s=A};C.setMeasure=function(A){this.m=A};return E}(),D=function(){function E(){}E.prototype.next=function(){return null};return E}();q.EmptyPlacementCursor=D;q.Placement=t;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMSymbolDrawHelper":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/BidiText ../../core/Logger ../../core/maybe ../../core/ObjectPool ../../core/screenUtils ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ../../geometry/support/centroid ../../geometry/support/jsonUtils ./CIMEffects ./CIMOperators ./CIMPlacements ./CIMResourceManager ./enums ./Rect ./TextRasterizer ../../views/2d/engine/webgl/alignmentUtils ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/mesh/templates/shapingUtils".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c,f,h,p,k,e,m,r,v,x){const g=Math.PI/180,u=E.getLogger("esri.symbols.cim.CIMSymbolDrawHelper");let y=function(){function L(J){this._t=J}L.createIdentity=function(){return new L([1,0,0,0,1,0])};var N=L.prototype;N.clone=function(){return new L(this._t.slice())};N.transform=function(J){const K=this._t;return[K[0]*J[0]+K[1]*J[1]+K[2],K[3]*J[0]+K[4]*J[1]+K[5]]};L.createScale=function(J,K){return new L([J,0,0,0,K,0])};N.scale=function(J,K){const O=this._t;O[0]*=J;O[1]*=J;
O[2]*=J;O[3]*=K;O[4]*=K;O[5]*=K;return this};N.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])};L.createTranslate=function(J,K){return new L([0,0,J,0,0,K])};N.translate=function(J,K){const O=this._t;O[2]+=J;O[5]+=K;return this};L.createRotate=function(J){const K=Math.cos(J);J=Math.sin(J);return new L([K,-J,0,J,K,0])};N.rotate=function(J){return L.multiply(this,L.createRotate(J),this)};L.multiply=function(J,K,O){J=J._t;K=K._t;const W=J[1]*K[0]+J[4]*K[1],aa=J[2]*
K[0]+J[5]*K[1]+K[2],ba=J[0]*K[3]+J[3]*K[4],S=J[1]*K[3]+J[4]*K[4],M=J[2]*K[3]+J[5]*K[4]+K[5],Q=O._t;Q[0]=J[0]*K[0]+J[3]*K[1];Q[1]=W;Q[2]=aa;Q[3]=ba;Q[4]=S;Q[5]=M;return O};N.invert=function(){const J=this._t;let K=J[0]*J[4]-J[1]*J[3];if(0===K)return new L([0,0,0,0,0,0]);K=1/K;return new L([J[4]*K,-J[1]*K,(J[1]*J[5]-J[2]*J[4])*K,-J[3]*K,J[0]*K,(J[2]*J[3]-J[0]*J[5])*K])};return L}();E=function(){function L(J,K){this._transfos=[];this._sizeTransfos=[];this._geomUnitsPerPoint=1;this._placementPool=new A(h.Placement,
null,null,100);this._earlyReturn=!1;this._mapRotation=0;this._resourceManager=J||new p;this._transfos.push(K||y.createIdentity());this._sizeTransfos.push(K?K.scaleRatio():1)}var N=L.prototype;N.setTransform=function(J,K){this._transfos=[J||y.createIdentity()];this._sizeTransfos=[K?K:J?J.scaleRatio():1]};N.setGeomUnitsPerPoint=function(J){this._geomUnitsPerPoint=J};N.transformPt=function(J){return this._transfos[this._transfos.length-1].transform(J)};N.transformSize=function(J){return J*this._sizeTransfos[this._sizeTransfos.length-
1]};N.reverseTransformPt=function(J){return this._transfos[this._transfos.length-1].invert().transform(J)};N.reverseTransformSize=function(J){return J/this._sizeTransfos[this._sizeTransfos.length-1]};N.geomUnitsPerPoint=function(){return this.isEmbedded()?1:this._geomUnitsPerPoint};N.isEmbedded=function(){return 1<this._transfos.length};N.back=function(){return this._transfos[this._transfos.length-1]};N.push=function(J,K){K=K?J.scaleRatio():1;y.multiply(J,this.back(),J);this._transfos.push(J);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-
1]*K)};N.pop=function(){this._transfos.splice(-1,1);this._sizeTransfos.splice(-1,1)};N.drawSymbol=function(J,K){if(J)switch(J.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(J,K);break;case "CIMTextSymbol":this.drawTextSymbol(J,K)}};N.drawMultiLayerSymbol=function(J,K){if(J){var O=J.symbolLayers;if(O)if((J=J.effects)&&0<J.length){if(K=this.executeEffects(J,K))for(J=K.next();J;)this.drawSymbolLayers(O,J),J=K.next()}else this.drawSymbolLayers(O,K)}};
N.executeEffects=function(J,K){const O=this._resourceManager.geometryEngine;K=new c.SimpleGeometryCursor(K);for(const W of J)(J=f.getEffectOperator(W))&&(K=J.execute(K,W,this.geomUnitsPerPoint(),O));return K};N.drawSymbolLayers=function(J,K){let O=J.length;for(;O--;){const aa=J[O];if(aa&&!1!==aa.enable){var W=aa.effects;if(W&&0<W.length){if(W=this.executeEffects(W,K)){let ba=null;for(;(ba=W.next())&&(this.drawSymbolLayer(aa,ba),!this._earlyReturn););}}else this.drawSymbolLayer(aa,K);if(this._earlyReturn)break}}};
N.drawSymbolLayer=function(J,K){switch(J.type){case "CIMSolidFill":this.drawSolidFill(K,J.color);break;case "CIMHatchFill":this.drawHatchFill(K,J);break;case "CIMPictureFill":this.drawPictureFill(K,J);break;case "CIMGradientFill":this.drawGradientFill(K,J);break;case "CIMSolidStroke":this.drawSolidStroke(K,J.color,J.width,J.capStyle,J.joinStyle,J.miterLimit);break;case "CIMPictureStroke":this.drawPictureStroke(K,J);break;case "CIMGradientStroke":this.drawGradientStroke(K,J);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":this.drawMarkerLayer(J,
K)}};N.drawHatchFill=function(J,K){const O=this._buildHatchPolyline(K,J,this.geomUnitsPerPoint());O&&(this.pushClipPath(J),this.drawMultiLayerSymbol(K.lineSymbol,O),this.popClipPath())};N.drawPictureFill=function(J,K){};N.drawGradientFill=function(J,K){};N.drawPictureStroke=function(J,K){};N.drawGradientStroke=function(J,K){};N.drawMarkerLayer=function(J,K){var O=J.markerPlacement;if(O){const aa=f.getPlacementOperator(O);if(aa){var W="CIMMarkerPlacementInsidePolygon"===O.type;W&&this.pushClipPath(K);
if(K=aa.execute(K,O,this.geomUnitsPerPoint(),this._resourceManager.geometryEngine))for(O=null;(O=K.next())&&(this.drawMarker(J,O),!this._earlyReturn););W&&this.popClipPath()}}else{O=this._placementPool.acquire();if(b.isPoint(K))O.tx=K.x,O.ty=K.y,this.drawMarker(J,O);else if(b.isPolygon(K))[O.tx,O.ty]=a.polygonCentroid(K),this.drawMarker(J,O);else for(W of K.points)if(O.tx=W[0],O.ty=W[1],this.drawMarker(J,O),this._earlyReturn)break;this._placementPool.release(O)}};N.drawMarker=function(J,K){switch(J.type){case "CIMCharacterMarker":case "CIMPictureMarker":this.drawPictureMarker(J,
K);break;case "CIMVectorMarker":this.drawVectorMarker(J,K)}};N.drawPictureMarker=function(J,K){var O,W,aa,ba,S;if(J){var M=this._resourceManager.getResource(J.url),Q=null!=(O=J.size)?O:10;if(!(C.isNone(M)||0>=Q)&&(O=M.width,M=M.height,O&&M)){M=O/M;O=null!=(W=J.scaleX)?W:1;W=y.createIdentity();var Y=J.anchorPoint;if(Y){let V=Y.x;Y=Y.y;"Absolute"!==J.anchorPointUnits&&(V*=Q*M*O,Y*=Q);W.translate(-V,-Y)}M=null!=(aa=J.rotation)?aa:0;J.rotateClockwise&&(M=-M);this._mapRotation&&(M+=this._mapRotation);
M&&W.rotate(M*g);aa=null!=(ba=J.offsetX)?ba:0;ba=null!=(S=J.offsetY)?S:0;if(aa||ba)this._mapRotation&&(M=g*this._mapRotation,S=Math.cos(M),M=Math.sin(M),O=aa*M+ba*S,aa=aa*S-ba*M,ba=O),W.translate(aa,ba);S=this.geomUnitsPerPoint();1!==S&&W.scale(S,S);(S=K.getAngle())&&W.rotate(S);W.translate(K.tx,K.ty);this.push(W,!1);this.drawImage(J.url,Q,J.scaleX);this.pop()}}};N.drawVectorMarker=function(J,K){var O,W,aa,ba;if(J){var S=J.markerGraphics;if(S){var M=null!=(O=J.size)?O:10,Q=(O=J.frame)?O.ymax-O.ymin:
0;Q=M&&Q?M/Q:1;M=y.createIdentity();O&&M.translate(.5*-(O.xmax+O.xmin),.5*-(O.ymax+O.ymin));var Y=J.anchorPoint;if(Y){let V=Y.x;Y=Y.y;"Absolute"!==J.anchorPointUnits?O&&(V*=O.xmax-O.xmin,Y*=O.ymax-O.ymin):(V/=Q,Y/=Q);M.translate(-V,-Y)}1!==Q&&M.scale(Q,Q);O=null!=(W=J.rotation)?W:0;J.rotateClockwise&&(O=-O);this._mapRotation&&(O+=this._mapRotation);O&&M.rotate(O*g);W=null!=(aa=J.offsetX)?aa:0;aa=null!=(ba=J.offsetY)?ba:0;if(W||aa)this._mapRotation&&(O=g*this._mapRotation,ba=Math.cos(O),O=Math.sin(O),
Q=W*O+aa*ba,W=W*ba-aa*O,aa=Q),M.translate(W,aa);ba=this.geomUnitsPerPoint();1!==ba&&M.scale(ba,ba);(ba=K.getAngle())&&M.rotate(ba);M.translate(K.tx,K.ty);this.push(M,J.scaleSymbolsProportionally);for(const V of S)if(V&&V.symbol&&V.geometry||u.error("Invalid marker graphic",V),this.drawSymbol(V.symbol,V.geometry),this._earlyReturn)break;this.pop()}}};N.drawTextSymbol=function(J,K){var O,W,aa,ba;if(J&&b.isPoint(K)&&!(0>=(null!=(O=J.height)?O:10))){O=y.createIdentity();var S=null!=(W=J.angle)?W:0;(S=
-S)&&O.rotate(S*g);W=null!=(aa=J.offsetX)?aa:0;aa=null!=(ba=J.offsetY)?ba:0;(W||aa)&&O.translate(W,aa);ba=this.geomUnitsPerPoint();1!==ba&&O.scale(ba,ba);O.translate(K.x,K.y);this.push(O,!1);this.drawText(J);this.pop()}};N._buildHatchPolyline=function(J,K,O){var W=(void 0!==J.separation?J.separation:4)*O,aa=void 0!==J.rotation?J.rotation:0;if(0===W)return null;0>W&&(W=-W);for(var ba=0,S=.5*W;ba>S;)ba-=W;for(;ba<-S;)ba+=W;ba=l.create();d.getBoundsXY(ba,K);ba[0]-=S;ba[1]-=S;ba[2]+=S;ba[3]+=S;for(var M=
[[ba[0],ba[1]],[ba[0],ba[3]],[ba[2],ba[3]],[ba[2],ba[1]]];180<aa;)aa-=180;for(;0>aa;)aa+=180;S=Math.cos(aa*g);var Q=Math.sin(aa*g);aa=-W*Q;K=W*S;ba=(void 0!==J.offsetX?J.offsetX*O:0)*Q-(void 0!==J.offsetY?J.offsetY*O:0)*S;let Y;var V=J=Number.MAX_VALUE;Y=O=-Number.MAX_VALUE;for(var P of M){var X=P[0];const R=P[1];M=S*X+Q*R;X=-Q*X+S*R;V=Math.min(V,M);J=Math.min(J,X);Y=Math.max(Y,M);O=Math.max(O,X)}J=Math.floor(J/W)*W;P=S*V-Q*J-aa*ba/W;V=Q*V+S*J-K*ba/W;M=S*Y-Q*J-aa*ba/W;ba=Q*Y+S*J-K*ba/W;W=1+Math.round((O-
J)/W);S=[];for(Q=0;Q<W;Q++)P+=aa,V+=K,M+=aa,ba+=K,S.push([[P,V],[M,ba]]);return{paths:S}};return L}();let z=function(L){function N(K,O){K=L.call(this,K,O)||this;K.reset();return K}t._inheritsLoose(N,L);var J=N.prototype;J.reset=function(){this._xmin=this._ymin=Infinity;this._xmax=this._ymax=-Infinity;this._clipCount=0};J.envelope=function(){return new e(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)};J.bounds=function(){return l.fromValues(this._xmin,this._ymin,this._xmax,this._ymax)};
J.drawSolidFill=function(K){!K||0<this._clipCount||(b.isPolygon(K)?this._processPath(K.rings,0):b.isPolyline(K)?this._processPath(K.paths,0):b.isExtent(K)?(K=F(K))&&this._processPath(K.rings,0):console.error("drawSolidFill Unexpected geometry type!"))};J.drawSolidStroke=function(K,O,W){!K||0<this._clipCount||(O=.5*this.transformSize(W),b.isPolygon(K)?this._processPath(K.rings,O):b.isPolyline(K)?this._processPath(K.paths,O):b.isExtent(K)?(K=F(K))&&this._processPath(K.rings,O):console.error("drawSolidStroke unexpected geometry type!"))};
J.pushClipPath=function(K){this.drawSolidFill(K);++this._clipCount};J.popClipPath=function(){--this._clipCount};J.drawImage=function(K,O,W){let aa=W*O,ba=O;K=this._resourceManager.getResource(K);!O&&C.isSome(K)&&(aa=W*K.width,ba=K.height);this._merge(this.transformPt([-aa/2,-ba/2]),0);this._merge(this.transformPt([-aa/2,ba/2]),0);this._merge(this.transformPt([aa/2,-ba/2]),0);this._merge(this.transformPt([aa/2,ba/2]),0)};J.drawText=function(K){this._textRasterizer||(this._textRasterizer=new m)};J._processPath=
function(K,O){if(K)for(const W of K)if(K=W?W.length:0,1<K){this._merge(this.transformPt(W[0]),O);for(let aa=1;aa<K;++aa)this._merge(this.transformPt(W[aa]),O)}};J._merge=function(K,O){K[0]-O<this._xmin&&(this._xmin=K[0]-O);K[0]+O>this._xmax&&(this._xmax=K[0]+O);K[1]-O<this._ymin&&(this._ymin=K[1]-O);K[1]+O>this._ymax&&(this._ymax=K[1]+O)};return N}(E),w=function(L){function N(){var K=L.apply(this,arguments)||this;K._searchPoint=[0,0];K._searchDistPoint=0;return K}t._inheritsLoose(N,L);var J=N.prototype;
J.hitTest=function(K,O,W,aa,ba,S){S*=n.pt2px(1);this.setTransform();this.setGeomUnitsPerPoint(S);this._searchPoint=[(K[0]+K[2])/2,(K[1]+K[3])/2];this._searchDistPoint=(K[2]-K[0])/2/S;this._textInfo=aa;this._mapRotation=O&&("CIMPointSymbol"===O.type&&"Map"!==O.angleAlignment||"CIMTextSymbol"===O.type)?ba:0;this._earlyReturn=!1;this.drawSymbol(O,W);return this._earlyReturn};J.drawSolidFill=function(K,O){this._hitTestFill(K)};J.drawHatchFill=function(K,O){this._hitTestFill(K)};J.drawPictureFill=function(K,
O){this._hitTestFill(K)};J.drawGradientFill=function(K,O){this._hitTestFill(K)};J.drawSolidStroke=function(K,O,W,aa,ba,S){this._hitTestStroke(K,W)};J.drawPictureStroke=function(K,O){this._hitTestStroke(K,O.width)};J.drawGradientStroke=function(K,O){this._hitTestStroke(K,O.width)};J.drawMarkerLayer=function(K,O){K.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===K.markerPlacement.type?this._hitTestFill(O):L.prototype.drawMarkerLayer.call(this,K,O)};J.pushClipPath=function(K){};J.popClipPath=function(){};
J.drawImage=function(K,O,W){K=this._resourceManager.getResource(K);if(!C.isNone(K)&&0!==K.height&&0!==O){O*=this.geomUnitsPerPoint();W=K.width/K.height*W*O;K=this.reverseTransformPt(this._searchPoint);var aa=this._searchDistPoint;Math.abs(K[0])<W/2+aa&&Math.abs(K[1])<O/2+aa&&(this._earlyReturn=!0)}};J.drawText=function(K){var O,W,aa=this._textInfo;if(aa&&(aa=aa.get(K))){var {text:ba,mosaicItem:S}=aa;if(S&&0!==S.glyphMosaicItems.length){aa=null!=(O=K.height)?O:10;O=I(K.lineGapType,null!=(W=K.lineGap)?
W:0,aa);W=D.bidiText(ba)[1];K=x.shapeGlyphs(S.glyphMosaicItems,W,{scale:aa/v.GLYPH_SIZE,angle:0,xOffset:0,yOffset:0,hAlign:G(K.horizontalAlignment),vAlign:H(K.verticalAlignment),maxLineWidth:512,lineHeight:v.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(O||1,4)),decoration:K.font.decoration||"none",isCIM:!0});O=this.reverseTransformPt(this._searchPoint);W=O[0];O=O[1];for(const M of K.glyphs)if(W>M.xTopLeft&&W<M.xBottomRight&&O>-M.yBottomRight&&O<-M.yTopLeft){this._earlyReturn=!0;break}}}};J._hitTestFill=
function(K){let O=null;if(b.isExtent(K))O=[[[K.xmin,K.ymin],[K.xmin,K.ymax],[K.xmax,K.ymax],[K.xmax,K.ymin],[K.xmin,K.ymin]]];else if(b.isPolygon(K))O=K.rings;else if(b.isPolyline(K))O=K.paths;else return;K=this.reverseTransformPt(this._searchPoint);this._pointInPolygon(K,O)&&(this._earlyReturn=!0);if(!this._earlyReturn){const W=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(K,O,W)&&(this._earlyReturn=!0)}};J._hitTestStroke=function(K,O){let W=null;if(b.isExtent(K))W=
[[[K.xmin,K.ymin],[K.xmin,K.ymax],[K.xmax,K.ymax],[K.xmax,K.ymin],[K.xmin,K.ymin]]];else if(b.isPolygon(K))W=K.rings;else if(b.isPolyline(K))W=K.paths;else return;K=this.reverseTransformPt(this._searchPoint);O*=this.geomUnitsPerPoint();const aa=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(K,W,O/2+aa)&&(this._earlyReturn=!0)};J._pointInPolygon=function(K,O){let W=0;for(const aa of O){O=aa.length;for(let ba=1;ba<O;++ba){const S=aa[ba-1],M=aa[ba];S[1]>K[1]!==
M[1]>K[1]&&(0<(M[0]-S[0])*(K[1]-S[1])-(M[1]-S[1])*(K[0]-S[0])?W++:W--)}}return 0!==W};J._nearLine=function(K,O,W){for(const ba of O){O=ba.length;for(let S=1;S<O;++S){var aa=ba[S-1];const M=ba[S];let Q=(M[0]-aa[0])*(M[0]-aa[0])+(M[1]-aa[1])*(M[1]-aa[1]);if(0!==Q&&(Q=Math.sqrt(Q),Math.abs(((M[0]-aa[0])*(K[1]-aa[1])-(M[1]-aa[1])*(K[0]-aa[0]))/Q)<W&&(aa=((M[0]-aa[0])*(K[0]-aa[0])+(M[1]-aa[1])*(K[1]-aa[1]))/Q,aa>-W&&aa<Q+W)))return!0}}return!1};return N}(E),B=function(L){function N(K,O,W){O=L.call(this,
O,W)||this;O._ctx=K;return O}t._inheritsLoose(N,L);var J=N.prototype;J.drawSolidFill=function(K,O){if(K){if(b.isPolygon(K))this._buildPath(K.rings,!0);else if(b.isPolyline(K))this._buildPath(K.paths,!0);else if(b.isExtent(K))this._buildPath(F(K).rings,!0);else if(b.isMultipoint(K))console.log("CanvasDrawHelper.drawSolidFill - No implementation!");else return;K=this._ctx;K.fillStyle="string"===typeof O?O:"rgba("+Math.round(O[0])+","+Math.round(O[1])+","+Math.round(O[2])+","+O[3]/255+")";K.fill("evenodd")}};
J.drawSolidStroke=function(K,O,W,aa,ba,S){if(K&&O&&0!==W){if(b.isPolygon(K))this._buildPath(K.rings,!0);else if(b.isPolyline(K))this._buildPath(K.paths,!1);else if(b.isExtent(K))this._buildPath(F(K).rings,!0);else{console.log("CanvasDrawHelper.drawSolidStroke isn't implemented!");return}K=this._ctx;K.strokeStyle="string"===typeof O?O:"rgba("+Math.round(O[0])+","+Math.round(O[1])+","+Math.round(O[2])+","+O[3]/255+")";K.lineWidth=this.transformSize(W)+.5;this._setCapStyle(aa);this._setJoinStyle(ba);
K.miterLimit=S;K.stroke()}};J.pushClipPath=function(K){this._ctx.save();if(b.isPolygon(K))this._buildPath(K.rings,!0);else if(b.isPolyline(K))this._buildPath(K.paths,!0);else if(b.isExtent(K))this._buildPath(F(K).rings,!0);else return;this._ctx.clip("evenodd")};J.popClipPath=function(){this._ctx.restore()};J.drawImage=function(K,O,W){K=this._resourceManager.getResource(K);if(!C.isNone(K)){var aa=this._ctx,ba=aa.canvas.width;aa=aa.canvas.height;var S=K.width/K.height*W*O,M=W*O;O||(S=W*K.width,M=W*
K.height);O=this.transformPt([0,0]);W=this.transformSize(S);M=this.transformSize(M);this._ctx.drawImage(K,0,0,K.width,K.height,O[0]-W/2,O[1]-M/2,Math.min(W,ba),Math.min(M,aa))}};J.drawText=function(K){this._textRasterizer||(this._textRasterizer=new m)};J._buildPath=function(K,O){const W=this._ctx;W.beginPath();if(K)for(const aa of K)if(K=aa?aa.length:0,1<K){let ba=this.transformPt(aa[0]);W.moveTo(ba[0],ba[1]);for(let S=1;S<K;++S)ba=this.transformPt(aa[S]),W.lineTo(ba[0],ba[1]);O&&W.closePath()}};
J._setCapStyle=function(K){switch(K){case k.LineCapStyle.Butt:this._ctx.lineCap="butt";break;case k.LineCapStyle.Round:this._ctx.lineCap="round";break;case k.LineCapStyle.Square:this._ctx.lineCap="square"}};J._setJoinStyle=function(K){switch(K){case k.LineJoinStyle.Bevel:this._ctx.lineJoin="bevel";break;case k.LineJoinStyle.Round:this._ctx.lineJoin="round";break;case k.LineJoinStyle.Miter:this._ctx.lineJoin="miter"}};return N}(E);const F=L=>L?{spatialReference:L.spatialReference,rings:[[[L.xmin,L.ymin],
[L.xmin,L.ymax],[L.xmax,L.ymax],[L.xmax,L.ymin],[L.xmin,L.ymin]]]}:null,G=L=>{switch(L){case "Left":return r.HAlign.Left;case "Right":return r.HAlign.Right;case "Center":return r.HAlign.Center;case "Justify":return u.warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),r.HAlign.Center}},H=L=>{switch(L){case "Top":return r.VAlign.Top;case "Center":return r.VAlign.Center;case "Bottom":return r.VAlign.Bottom;case "Baseline":return r.VAlign.Baseline}},I=(L,N,J)=>{switch(L){case "ExtraLeading":return 1+
N/J;case "Multiple":return N;case "Exact":return N/J}};q.CIMSymbolDrawHelper=E;q.C_DEG_TO_RAD=g;q.CanvasDrawHelper=B;q.EnvDrawHelper=z;q.HittestDrawHelper=w;q.Transformation=y;q.horizontalAlignment2HAlign=G;q.lineGapType2LineHeight=I;q.verticalAlignment2VAlign=H;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMEffects":function(){define(["exports","../../core/lang"],function(q,t){let D=function(){function E(C){this._geometry=C}E.prototype.next=
function(){const C=this._geometry;this._geometry=null;return C};return E}();q.SimpleGeometryCursor=D;q.clone=function(E){return t.clone(E)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMOperators":function(){define("exports ./effects/EffectAddControlPoints ./effects/EffectArrow ./effects/EffectBuffer ./effects/EffectControlMeasureLine ./effects/EffectCut ./effects/EffectDashes ./effects/EffectDonut ./effects/EffectJog ./effects/EffectMove ./effects/EffectOffset ./effects/EffectReverse ./effects/EffectRotate ./effects/EffectScale ./effects/EffectWave ./placements/PlacementAlongLineSameSize ./placements/PlacementAtExtremities ./placements/PlacementAtRatioPositions ./placements/PlacementInsidePolygon ./placements/PlacementOnLine ./placements/PlacementOnVertices ./placements/PlacementPolygonCenter".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c,f,h,p,k,e,m,r,v,x,g){q.getEffectOperator=function(u){if(!u)return null;switch(u.type){case "CIMGeometricEffectAddControlPoints":return t.EffectAddControlPoints.local();case "CIMGeometricEffectArrow":return D.EffectArrow.local();case "CIMGeometricEffectBuffer":return E.EffectBuffer.local();case "CIMGeometricEffectControlMeasureLine":return C.EffectControlMeasureLine.local();case "CIMGeometricEffectCut":return A.EffectCut.local();case "CIMGeometricEffectDashes":return n.EffectDashes.local();
case "CIMGeometricEffectDonut":return l.EffectDonut.local();case "CIMGeometricEffectJog":return d.EffectJog.local();case "CIMGeometricEffectMove":return a.EffectMove.local();case "CIMGeometricEffectOffset":return b.EffectOffset.local();case "CIMGeometricEffectReverse":return c.EffectReverse.local();case "CIMGeometricEffectRotate":return f.EffectRotate.local();case "CIMGeometricEffectScale":return h.EffectScale.local();case "CIMGeometricEffectWave":return p.EffectWave.local()}return null};q.getPlacementOperator=
function(u){if(!u)return null;switch(u.type){case "CIMMarkerPlacementAlongLineSameSize":return k.PlacementAlongLineSameSize.local();case "CIMMarkerPlacementAtExtremities":return e.PlacementAtExtremities.local();case "CIMMarkerPlacementAtRatioPositions":return m.PlacementAtRatioPositions.local();case "CIMMarkerPlacementInsidePolygon":return r.PlacementInsidePolygon.local();case "CIMMarkerPlacementOnLine":return v.PlacementOnLine.local();case "CIMMarkerPlacementOnVertices":return x.PlacementOnVertices.local();
case "CIMMarkerPlacementPolygonCenter":return g.PlacementPolygonCenter.local()}return null};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectAddControlPoints":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(q,t,D,E){let C=function(){function n(){}n.local=function(){null===n.instance&&(n.instance=new n);return n.instance};n.prototype.execute=function(l,d,a,b){return new A(l,
d,a)};return n}();C.instance=null;let A=function(){function n(d,a,b){this._inputGeometries=d;this._angleTolerance=void 0!==a.angleTolerance?a.angleTolerance:120;this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}var l=n.prototype;l.next=function(){for(var d=this._inputGeometries.next();d;){if(D.isPolygon(d))return this._isClosed=!0,d=t.clone(d),this._processMultipath(d.rings),d;if(D.isPolyline(d))return this._isClosed=!1,d=t.clone(d),this._processMultipath(d.paths),d;if(D.isExtent(d)){if(this._maxCosAngle)return d;
this._isClosed=!0;d=[[d.xmin,d.ymin],[d.xmin,d.ymax],[d.xmax,d.ymax],[d.xmax,d.ymin],[d.xmin,d.ymin]];this._processPath(d);return{rings:[d]}}d=this._inputGeometries.next()}return null};l._processMultipath=function(d){if(d)for(const a of d)this._processPath(a)};l._processPath=function(d){if(d){let a=d.length,b=d[0],c,f,h,p,k,e;this._isClosed&&++a;for(let m=1;m<a;++m){let r;r=this._isClosed&&m===a-1?d[0]:d[m];const v=r[0]-b[0],x=r[1]-b[1],g=Math.sqrt(v*v+x*x);1<m&&0<g&&0<h&&(c*v+f*x)/g/h<=this._maxCosAngle&&
E.setId(b,1);1===m&&(p=v,k=x,e=g);0<g&&(b=r,c=v,f=x,h=g)}this._isClosed&&0<h&&0<e&&(c*p+f*k)/e/h<=this._maxCosAngle&&E.setId(d[0],1)}};return n}();q.EffectAddControlPoints=C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMCursor":function(){define(["exports","../../core/lang","../../geometry/support/jsonUtils","./CIMPlacements"],function(q,t,D,E){function C(e){if(!e)return null;D.isPoint(e)?e.y=-e.y:D.isPolygon(e)?n(e.rings):D.isPolyline(e)?
n(e.paths):D.isMultipoint(e)&&A(e.points)}function A(e){if(e){const m=e.length;for(let r=0;r<m;r++)e[r][1]=-e[r][1]}}function n(e){if(e)for(const m of e)A(m)}function l(e){if(e){var m=e.length;for(--m;0<m;--m)e[m][0]-=e[m-1][0],e[m][1]-=e[m-1][1]}}function d(e){if(e)for(const m of e)l(m)}function a(e){if(e){const m=e.length;for(let r=1;r<m;++r)e[r][0]+=e[r-1][0],e[r][1]+=e[r-1][1]}}function b(e){if(e)for(const m of e)a(m)}function c(e){e&&(D.isPolygon(e)?b(e.rings):D.isPolyline(e)?b(e.paths):D.isMultipoint(e)&&
a(e.points),C(e))}function f(e){e&&e.reverse()}function h(e){return{rings:[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]}}let p=function(){function e(m,r,v,x){this.acceptPolygon=r;this.acceptPolyline=v;this.geomUnitsPerPoint=x;this.pathIndex=this.pathCount=-1;this.iteratePath=!1;m&&(D.isPolygon(m)?r&&(this.multiPath=m.rings,this.isClosed=!0):D.isPolyline(m)?v&&(this.multiPath=m.paths,this.isClosed=!1):D.isExtent(m)&&r&&(this.multiPath=h(m).rings,this.isClosed=
!0),this.multiPath&&(this.pathCount=this.multiPath.length));this.internalPlacement=new E.Placement}e.prototype.next=function(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;const m=this.processPath(this.multiPath[this.pathIndex]);if(m)return m}this.pathIndex=this.pathCount=-1;return this.multiPath=null};return e}(),k=function(){function e(m,r,v,x){this.inputGeometries=m;this.acceptPolygon=r;this.acceptPolyline=v;this.geomUnitsPerPoint=
x;this.pathIndex=this.pathCount=-1;this.iteratePath=!1}e.prototype.next=function(){for(;;){if(!this.multiPath){for(var m=this.inputGeometries.next();m;)if(D.isPolygon(m)?this.acceptPolygon&&(this.multiPath=m.rings,this.isClosed=!0):D.isPolyline(m)?this.acceptPolyline&&(this.multiPath=m.paths,this.isClosed=!1):D.isExtent(m)&&this.acceptPolygon&&(this.multiPath=h(m).rings,this.isClosed=!0),this.multiPath){this.pathCount=this.multiPath.length;this.pathIndex=-1;break}else m=this.inputGeometries.next();
if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;)if(this.iteratePath||this.pathIndex++,m=this.processPath(this.multiPath[this.pathIndex]))return m;this.pathIndex=this.pathCount=-1;this.multiPath=null}};return e}();q.PathGeometryCursor=k;q.PathTransformationCursor=p;q.cloneAndDecodeGeometry=function(e){e=t.clone(e);c(e);return e};q.deltaDecodeGeometry=c;q.deltaEncodeGeometry=function(e){e&&(C(e),D.isPolygon(e)?d(e.rings):D.isPolyline(e)?d(e.paths):D.isMultipoint(e)&&
l(e.points))};q.getCoord2D=function(e,m,r){return[e[0]+(m[0]-e[0])*r,e[1]+(m[1]-e[1])*r]};q.getId=function(e){return e[4]};q.isClosedPath=function(e){return e&&0!==e.length?e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]:!1};q.reverseMultipath=function(e){if(e)for(const m of e)f(m)};q.reversePath=f;q.setId=function(e,m){e[4]=m};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectArrow":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers",
"../CIMCursor","../CurveHelper","../enums"],function(q,t,D,E,C){const A=C.GeometricEffectArrowType.OpenEnded;let n=function(){function d(){}d.local=function(){null===d.instance&&(d.instance=new d);return d.instance};d.prototype.execute=function(a,b,c,f){return new l(a,b,c)};return d}();n.instance=null;let l=function(d){function a(c,f,h){c=d.call(this,c,!1,!0)||this;c._curveHelper=new E.CurveHelper;c._width=(void 0!==f.width?f.width:5)*h;c._arrowType=void 0!==f.geometricEffectArrowType?f.geometricEffectArrowType:
void 0!==f.arrowType?f.arrowType:A;c._offsetFlattenError=E.PIXEL_TOLERANCE*h;return c}t._inheritsLoose(a,d);var b=a.prototype;b.processPath=function(c){switch(this._arrowType){default:return this._constructSimpleArrow(c,!0);case C.GeometricEffectArrowType.Block:return this._constructSimpleArrow(c,!1);case C.GeometricEffectArrowType.Crossed:return this._constructCrossedArrow(c)}};b._constructSimpleArrow=function(c,f){var h=this._curveHelper.calculatePathLength(c),p=this._width;h<2*p&&(p=h/2);h=this._curveHelper.getSubCurve(c,
0,h-p);if(!h)return null;var k=p/2;if(this._curveHelper.isEmpty(h,!1))return null;p=this._constructOffset(h,-k);if(!p)return null;h=this._constructOffset(h,k);if(!h)return null;const e=this._constructArrowBasePoint(p,-k/2);if(!e)return null;k=this._constructArrowBasePoint(h,k/2);if(!k)return null;c=c[c.length-1];f||(this._makeControlPoint(h,!0),this._makeControlPoint(p,!0));const m=new E.PathHelper;m.addPath(h,!0);m.lineTo(k);this._makeControlPoint(m.path());m.lineTo(c);this._makeControlPoint(m.path());
m.lineTo(e);this._makeControlPoint(m.path());m.addPath(p,!1);return f?{paths:[m.path()]}:(m.close(),{rings:[m.path()]})};b._constructCrossedArrow=function(c){var f=this._curveHelper.calculatePathLength(c),h=this._width;f<3.732050807568877*h&&(h=f/3.732050807568877);var p=this._curveHelper.getSubCurve(c,0,f-2.732050807568877*h);if(!p)return null;var k=h/2;if(this._curveHelper.isEmpty(p,!1))return null;const e=this._constructOffset(p,k);if(!e)return null;p=this._constructOffset(p,-k);if(!p)return null;
f=this._curveHelper.getSubCurve(c,0,f-h);if(!f||this._curveHelper.isEmpty(f,!1))return null;h=this._constructOffset(f,k);if(!h)return null;var m=this._constructOffset(f,-k);if(!m)return null;f=h[h.length-1];h=this._constructArrowBasePoint(h,k/2);if(!h)return null;const r=m[m.length-1];k=this._constructArrowBasePoint(m,-k/2);if(!k)return null;c=c[c.length-1];this._makeControlPoint(e,!1);this._makeControlPoint(p,!1);m=new E.PathHelper;m.addPath(e,!0);this._makeControlPoint(m.path());m.lineTo(r);m.lineTo(k);
this._makeControlPoint(m.path());m.lineTo(c);this._makeControlPoint(m.path());m.lineTo(h);this._makeControlPoint(m.path());m.lineTo(f);this._makeControlPoint(m.path());m.addPath(p,!1);return{paths:[m.path()]}};b._constructOffset=function(c,f){return this._curveHelper.offset(c,f,C.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError)};b._constructArrowBasePoint=function(c,f){if(!c||2>c.length)return null;var h=c[c.length-2];c=c[c.length-1];h=[c[0]-h[0],c[1]-h[1]];this._curveHelper.normalize(h);
return[c[0]+h[1]*f,c[1]-h[0]*f]};b._makeControlPoint=function(c,f=!1){f?D.setId(c[0],1):D.setId(c[c.length-1],1)};return a}(D.PathGeometryCursor);q.EffectArrow=n;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CurveHelper":function(){define(["exports","./enums"],function(q,t){let D=function(){function C(){this._path=[]}var A=C.prototype;A.path=function(){return this._path};A.addPath=function(n,l){l||n.reverse();Array.prototype.push.apply(this._path,
n);l||n.reverse()};C.mergePath=function(n,l){l&&Array.prototype.push.apply(n,l)};A.startPath=function(n){this._path.push(n)};A.lineTo=function(n){this._path.push(n)};A.close=function(){const n=this._path;1<n.length&&(n[0][0]!==n[n.length-1][0]||n[0][1]!==n[n.length-1][1])&&n.push([n[0][0],n[0][1]])};return C}(),E=function(){function C(n,l){}var A=C.prototype;A.normalize=function(n){const l=Math.sqrt(n[0]*n[0]+n[1]*n[1]);0!==l&&(n[0]/=l,n[1]/=l)};A.calculateLength=function(n,l){const d=l[0]-n[0];n=
l[1]-n[1];return Math.sqrt(d*d+n*n)};A.calculateSegLength=function(n,l){return this.calculateLength(n[l],n[l+1])};A.calculatePathLength=function(n){let l=0;const d=n?n.length:0;for(let a=0;a<d-1;++a)l+=this.calculateSegLength(n,a);return l};A.calculatePathArea=function(n){let l=0;const d=n?n.length:0;for(let a=0;a<d-1;++a)l+=(n[a+1][0]-n[a][0])*(n[a+1][1]+n[a][1]);return l/2};A.getCoord2D=function(n,l,d){return[n[0]+(l[0]-n[0])*d,n[1]+(l[1]-n[1])*d]};A.getSegCoord2D=function(n,l,d){return this.getCoord2D(n[l],
n[l+1],d)};A.getAngle=function(n,l,d){return Math.atan2(l[1]-n[1],l[0]-n[0])};A.getSegAngle=function(n,l,d){return this.getAngle(n[l],n[l+1],d)};A.getAngleCS=function(n,l,d){d=l[0]-n[0];n=l[1]-n[1];l=Math.sqrt(d*d+n*n);return 0<l?[d/l,n/l]:[1,0]};A.getSegAngleCS=function(n,l,d){return this.getAngleCS(n[l],n[l+1],d)};A.cut=function(n,l,d,a){d=0>=d?n[l]:this.getSegCoord2D(n,l,d);n=1<=a?n[l+1]:this.getSegCoord2D(n,l,a);return[d,n]};A.addSegment=function(n,l,d){d&&n.push(l[0]);n.push(l[1])};A.getSubCurve=
function(n,l,d){const a=[];return this.appendSubCurve(a,n,l,d)?a:null};A.appendSubCurve=function(n,l,d,a){const b=l?l.length-1:0;let c=0,f=!0,h=0;for(;h<b;){const k=this.calculateSegLength(l,h);if(0!==k){if(f){if(c+k>d){var p=(d-c)/k;let e=1,m=!1;c+k>=a&&(e=(a-c)/k,m=!0);(p=this.cut(l,h,p,e))&&this.addSegment(n,p,f);if(m)break;f=!1}}else{if(c+k>a){(l=this.cut(l,h,0,(a-c)/k))&&this.addSegment(n,l,f);break}this.addSegment(n,[l[h],l[h+1]],f)}c+=k}++h}return!0};A.getCIMPointAlong=function(n,l){const d=
n?n.length-1:0;let a=0,b=-1;for(;b<d;){++b;const c=this.calculateSegLength(n,b);if(0!==c){if(a+c>l)return this.getCoord2D(n[b],n[b+1],(l-a)/c);a+=c}}return null};A.isEmpty=function(n,l){if(!n||1>=n.length)return!0;const d=n?n.length-1:0;let a=-1;for(;a<d;)if(++a,n[a+1][0]!==n[a][0]||n[a+1][1]!==n[a][1]||l&&n[a+1][2]!==n[a][2])return!1;return!0};A.offset=function(n,l,d,a,b){if(!n||2>n.length)return null;var c=0,f=n[c++];for(b=c;c<n.length;){var h=n[c];if(h[0]!==f[0]||h[1]!==f[1])c!==b&&(n[b]=n[c]),
f=n[b++];c++}(c=n[0][0]===n[b-1][0]&&n[0][1]===n[b-1][1])&&--b;if(b<(c?3:2))return null;h=[];f=c?n[b-1]:null;let p=n[0];for(let v=0;v<b;v++){const x=v===b-1?c?n[0]:null:n[v+1];if(f)if(x){var k=[x[0]-p[0],x[1]-p[1]];this.normalize(k);var e=[p[0]-f[0],p[1]-f[1]];this.normalize(e);var m=e[0]*k[1]-e[1]*k[0],r=e[0]*k[0]+e[1]*k[1];if(0===m&&1===r){p=x;continue}if(0<=m===0>=l)1>r&&(k=[k[0]-e[0],k[1]-e[1]],this.normalize(k),e=Math.sqrt((1+r)/2),e>1/a&&(e=-Math.abs(l)/e,h.push([p[0]-k[0]*e,p[1]-k[1]*e])));
else switch(d){case t.GeometricEffectOffsetMethod.Mitered:if(f=Math.sqrt((1+r)/2),0<f&&1/f<a){k=[k[0]-e[0],k[1]-e[1]];this.normalize(k);e=Math.abs(l)/f;h.push([p[0]-k[0]*e,p[1]-k[1]*e]);break}case t.GeometricEffectOffsetMethod.Bevelled:h.push([p[0]+e[1]*l,p[1]-e[0]*l]);h.push([p[0]+k[1]*l,p[1]-k[0]*l]);break;case t.GeometricEffectOffsetMethod.Rounded:if(1>r){h.push([p[0]+e[1]*l,p[1]-e[0]*l]);f=Math.floor(2.5*(1-r));if(0<f){m=r=1/f;for(let g=1;g<f;g++,m+=r){const u=[e[1]*(1-m)+k[1]*m,-e[0]*(1-m)-k[0]*
m];this.normalize(u);h.push([p[0]+u[0]*l,p[1]+u[1]*l])}}h.push([p[0]+k[1]*l,p[1]-k[0]*l])}break;default:0>m?(h.push([p[0]+(e[1]+e[0])*l,p[1]+(e[1]-e[0])*l]),h.push([p[0]+(k[1]-k[0])*l,p[1]-(k[0]+k[1])*l])):(f=Math.sqrt((1+Math.abs(r))/2),k=[k[0]-e[0],k[1]-e[1]],this.normalize(k),e=l/f,h.push([p[0]-k[0]*e,p[1]-k[1]*e]))}}else k=[p[0]-f[0],p[1]-f[1]],this.normalize(k),h.push([p[0]+k[1]*l,p[1]-k[0]*l]);else k=[x[0]-p[0],x[1]-p[1]],this.normalize(k),h.push([p[0]+k[1]*l,p[1]-k[0]*l]);f=p;p=x}if(h.length<
(c?3:2))return null;c&&h.push([h[0][0],h[0][1]]);return h};return C}();q.CurveHelper=E;q.PIXEL_TOLERANCE=.03;q.PathHelper=D;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectBuffer":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums"],function(q,t,D,E){let C=function(){function n(){}n.local=function(){null===n.instance&&(n.instance=new n);return n.instance};n.prototype.execute=function(l,
d,a,b){return new A(l,d,a,b)};return n}();C.instance=null;let A=function(){function n(l,d,a,b){this._inputGeometries=l;this._curveHelper=new D.CurveHelper;this._size=(void 0!==d.size?d.size:1)*a;this._offsetFlattenError=D.PIXEL_TOLERANCE*a}n.prototype.next=function(){let l=this._inputGeometries.next();for(;l;){if(t.isExtent(l))if(0<this._size){var d=this._curveHelper.offset([[l.xmin,l.ymin],[l.xmin,l.ymax],[l.xmax,l.ymax],[l.xmax,l.ymin],[l.xmin,l.ymin]],this._size,E.GeometricEffectOffsetMethod.Rounded,
4,this._offsetFlattenError);if(d)return{rings:[d]}}else if(0>this._size){if(0<Math.min(l.xmax-l.xmin,l.ymax-l.ymin)+2*this._size)return{xmin:l.xmin-this._size,xmax:l.xmax+this._size,ymin:l.ymin-this._size,ymax:l.ymax+this._size}}else return l;if(t.isPolygon(l)){if(0===this._size)return l;d=[];for(const b of l.rings){var a=this._curveHelper.offset(b,this._size,E.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);a&&d.push(a)}if(d.length)return{rings:d}}if(t.isPolyline(l)&&0<this._size){d=
[];for(const b of l.paths)if(b&&1<b.length){a=this._curveHelper.offset(b,this._size,E.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);const c=this._curveHelper.offset(b,-this._size,E.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);if(a&&c){for(let f=c.length-1;0<=f;f--)a.push(c[f]);a.push([a[0][0],a[0][1]]);d.push(a)}}if(d.length)return{rings:d}}t.isPoint(l);l=this._inputGeometries.next()}return null};return n}();q.EffectBuffer=C;Object.defineProperties(q,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectControlMeasureLine":function(){define(["exports","../../../geometry/support/jsonUtils","../CIMCursor","../enums"],function(q,t,D,E){let C=function(){function n(){}n.local=function(){null===n.instance&&(n.instance=new n);return n.instance};n.prototype.execute=function(l,d,a,b){return new A(l,d,a)};return n}();C.instance=null;let A=function(){function n(d,a,b){var c;this._default_point_size=20;this._inputGeometries=d;this._geomUnitsPerPoint=
b;this._rule=null!=(c=a.rule)?c:E.GeometricEffectControlMeasureLineRule.FullGeometry;this._default_size=this._default_point_size*b}var l=n.prototype;l.next=function(){let d;for(;d=this._inputGeometries.next();){let a;t.isPoint(d)?a=this._processGeom([[[d.x,d.y]]]):t.isMultipoint(d)?a=this._processGeom([d.points]):t.isPolyline(d)?a=this._processGeom(d.paths):t.isPolygon(d)&&(a=this._processGeom(d.rings));if(a&&a.length)return{paths:a}}return null};l._clone=function(d){return[d[0],d[1]]};l._mid=function(d,
a){return[(d[0]+a[0])/2,(d[1]+a[1])/2]};l._mix=function(d,a,b,c){return[d[0]*a+b[0]*c,d[1]*a+b[1]*c]};l._add=function(d,a){return[d[0]+a[0],d[1]+a[1]]};l._add2=function(d,a,b){return[d[0]+a,d[1]+b]};l._sub=function(d,a){return[d[0]-a[0],d[1]-a[1]]};l._dist=function(d,a){return Math.sqrt((d[0]-a[0])*(d[0]-a[0])+(d[1]-a[1])*(d[1]-a[1]))};l._norm=function(d){return Math.sqrt(d[0]*d[0]+d[1]*d[1])};l._normalize=function(d,a=1){a/=this._norm(d);d[0]*=a;d[1]*=a};l._leftPerpendicular=function(d){const a=
d[0];d[0]=-d[1];d[1]=a};l._leftPerp=function(d){return[-d[1],d[0]]};l._rightPerpendicular=function(d){const a=-d[0];d[0]=d[1];d[1]=a};l._rightPerp=function(d){return[d[1],-d[0]]};l._dotProduct=function(d,a){return d[0]*a[0]+d[1]*a[1]};l._crossProduct=function(d,a){return d[0]*a[1]-d[1]*a[0]};l._rotateDirect=function(d,a,b){const c=d[0]*b+d[1]*a;d[0]=d[0]*a-d[1]*b;d[1]=c};l._makeCtrlPt=function(d){d=[d[0],d[1]];D.setId(d,1);return d};l._addAngledTicks=function(d,a,b,c){const f=this._sub(b,a);this._normalize(f);
var h=this._crossProduct(f,this._sub(c,a));c=0<h?this._rightPerp(f):this._leftPerp(f);h=Math.abs(h)/2;const p=[];p.push([a[0]+(c[0]-f[0])*h,a[1]+(c[1]-f[1])*h]);p.push(a);p.push(b);p.push([b[0]+(c[0]+f[0])*h,b[1]+(c[1]+f[1])*h]);d.push(p)};l._addBezier2=function(d,a,b,c,f){if(0===f--)d.push(c);else{var h=this._mid(a,b);b=this._mid(b,c);var p=this._mid(h,b);this._addBezier2(d,a,h,p,f);this._addBezier2(d,p,b,c,f)}};l._addBezier3=function(d,a,b,c,f,h){if(0===h--)d.push(f);else{var p=this._mid(a,b),k=
this._mid(b,c);c=this._mid(c,f);b=this._mid(p,k);k=this._mid(k,c);var e=this._mid(b,k);this._addBezier3(d,a,p,b,e,h);this._addBezier3(d,e,k,c,f,h)}};l._add90DegArc=function(d,a,b,c,f){c=null!=f?f:0<this._crossProduct(this._sub(b,a),this._sub(c,a));f=this._mid(a,b);const h=this._sub(f,a);c?this._leftPerpendicular(h):this._rightPerpendicular(h);f[0]+=h[0];f[1]+=h[1];this._addBezier3(d,a,this._mix(a,.33333,f,.66667),this._mix(b,.33333,f,.66667),b,4)};l._addArrow=function(d,a,b){var c=a[0],f=a[1],h=a[a.length-
1],p=this._sub(c,f);this._normalize(p);const k=this._crossProduct(p,this._sub(h,f));f=.5*k;var e=this._leftPerp(p);const m=[h[0]-e[0]*k,h[1]-e[1]*k];var r=a.length-1;h=[];h.push(b?[-e[0],-e[1]]:e);var v=[-p[0],-p[1]];for(b=1;b<r-1;b++){p=this._sub(a[b+1],a[b]);this._normalize(p);var x=this._dotProduct(p,v);e=this._crossProduct(p,v);x=Math.sqrt((1+x)/2);v=this._sub(p,v);this._normalize(v);v[0]/=x;v[1]/=x;h.push(0>e?[-v[0],-v[1]]:v);v=p}h.push(this._rightPerp(v));for(r=h.length-1;0<r;r--)d.push([a[r][0]+
h[r][0]*f,a[r][1]+h[r][1]*f]);d.push([m[0]+h[0][0]*f,m[1]+h[0][1]*f]);d.push([m[0]+h[0][0]*k,m[1]+h[0][1]*k]);d.push(c);d.push([m[0]-h[0][0]*k,m[1]-h[0][1]*k]);d.push([m[0]-h[0][0]*f,m[1]-h[0][1]*f]);for(c=1;c<h.length;c++)d.push([a[c][0]-h[c][0]*f,a[c][1]-h[c][1]*f])};l._cp2=function(d,a,b){return 2<=d.length?d[1]:this._add2(d[0],a*this._default_size,b*this._default_size)};l._cp3=function(d,a,b,c){if(3<=d.length)return d[2];b=this._mix(d[0],1-b,a,b);d=this._sub(a,d[0]);this._normalize(d);this._rightPerpendicular(d);
return[b[0]+d[0]*c*this._default_size,b[1]+d[1]*c*this._default_size]};l._arrowPath=function(d){if(2<d.length)return d;const a=d[0];d=this._cp2(d,-4,0);const b=this._sub(a,d);this._normalize(b);const c=this._rightPerp(b);return[a,d,[a[0]+(c[0]-b[0])*this._default_size,a[1]+(c[1]-b[1])*this._default_size]]};l._arrowLastSeg=function(d){var a=d[0];const b=this._cp2(d,-4,0);if(3<=d.length)a=d[d.length-1];else{d=this._sub(a,b);this._normalize(d);const c=this._rightPerp(d);a=[a[0]+(c[0]-d[0])*this._default_size,
a[1]+(c[1]-d[1])*this._default_size]}return[b,a]};l._processGeom=function(d){if(!d)return null;const a=[];for(const b of d){if(!b||0===b.length)continue;const c=b.length;let f=b[0];switch(this._rule){case E.GeometricEffectControlMeasureLineRule.PerpendicularFromFirstSegment:{const h=this._cp2(b,0,-1),p=this._cp3(b,h,.5,4),k=[];k.push(p);k.push(this._mid(f,h));a.push(k);break}case E.GeometricEffectControlMeasureLineRule.ReversedFirstSegment:{const h=this._cp2(b,0,-1);a.push([h,f]);break}case E.GeometricEffectControlMeasureLineRule.PerpendicularToSecondSegment:{const h=
this._cp2(b,-4,1),p=this._cp3(b,h,.882353,-1.94),k=[];k.push(this._mid(h,p));k.push(f);a.push(k);break}case E.GeometricEffectControlMeasureLineRule.SecondSegmentWithTicks:{const h=this._cp2(b,-4,1),p=this._cp3(b,h,.882353,-1.94),k=this._sub(p,h);let e;e=0<this._crossProduct(k,this._sub(f,h))?this._rightPerp(e):this._leftPerp(k);const m=[];m.push([h[0]+(e[0]-k[0])/3,h[1]+(e[1]-k[1])/3]);m.push(h);m.push(p);m.push([p[0]+(e[0]+k[0])/3,p[1]+(e[1]+k[1])/3]);a.push(m);break}case E.GeometricEffectControlMeasureLineRule.DoublePerpendicular:{const h=
this._cp2(b,0,-1),p=this._cp3(b,h,.5,3),k=this._mid(f,h),e=this._sub(k,p);this._normalize(e);const m=this._crossProduct(e,this._sub(f,p));this._leftPerpendicular(e);const r=[];r.push(f);r.push([p[0]+e[0]*m,p[1]+e[1]*m]);a.push(r);const v=[];v.push([p[0]-e[0]*m,p[1]-e[1]*m]);v.push(h);a.push(v);break}case E.GeometricEffectControlMeasureLineRule.OppositeToFirstSegment:{const h=this._cp2(b,0,-1),p=this._cp3(b,h,.5,3),k=this._mid(f,h),e=this._sub(k,p);this._normalize(e);const m=this._crossProduct(e,this._sub(f,
p));this._leftPerpendicular(e);const r=[];r.push([p[0]+e[0]*m,p[1]+e[1]*m]);r.push([p[0]-e[0]*m,p[1]-e[1]*m]);a.push(r);break}case E.GeometricEffectControlMeasureLineRule.TriplePerpendicular:{const h=this._cp2(b,0,-1),p=this._cp3(b,h,.5,4),k=this._mid(f,h),e=this._sub(k,p);this._normalize(e);const m=this._crossProduct(e,this._sub(f,p));this._leftPerpendicular(e);const r=[];r.push([p[0]+e[0]*m*.8,p[1]+e[1]*m*.8]);r.push([k[0]+.8*(f[0]-k[0]),k[1]+.8*(f[1]-k[1])]);a.push(r);a.push([p,k]);const v=[];
v.push([p[0]-e[0]*m*.8,p[1]-e[1]*m*.8]);v.push([k[0]+.8*(h[0]-k[0]),k[1]+.8*(h[1]-k[1])]);a.push(v);break}case E.GeometricEffectControlMeasureLineRule.HalfCircleFirstSegment:{const h=this._cp2(b,0,-1),p=this._cp3(b,h,.5,4),k=this._mid(f,h);let e=this._sub(h,f);const m=Math.cos(Math.PI/18),r=Math.sin(Math.PI/18),v=Math.sqrt((1+m)/2),x=Math.sqrt((1-m)/2),g=[];let u;0<this._crossProduct(e,this._sub(p,f))?(g.push(f),e=this._sub(f,k),u=h):(g.push(h),e=this._sub(h,k),u=f);this._rotateDirect(e,v,x);e[0]/=
v;e[1]/=v;for(let y=1;18>=y;y++)g.push(this._add(k,e)),this._rotateDirect(e,m,r);g.push(u);a.push(g);break}case E.GeometricEffectControlMeasureLineRule.HalfCircleSecondSegment:{const h=this._cp2(b,0,-1),p=this._cp3(b,h,1,-1);let k=this._sub(f,h);this._normalize(k);const e=this._crossProduct(k,this._sub(p,h))/2;this._leftPerpendicular(k);const m=[h[0]+k[0]*e,h[1]+k[1]*e];k=this._sub(h,m);const r=Math.cos(Math.PI/18);let v=Math.sin(Math.PI/18);0<e&&(v=-v);const x=[h];for(let g=1;18>=g;g++)this._rotateDirect(k,
r,v),x.push(this._add(m,k));a.push(x);break}case E.GeometricEffectControlMeasureLineRule.HalfCircleExtended:{const h=this._cp2(b,0,-2),p=this._cp3(b,h,1,-1);let k;if(4<=c)k=b[3];else{const x=this._sub(f,h);k=this._add(p,x)}const e=this._dist(h,p)/2/.75,m=this._sub(h,f);this._normalize(m,e);const r=this._sub(p,k);this._normalize(r,e);a.push([k,p]);const v=[this._clone(p)];this._addBezier3(v,p,this._add(p,r),this._add(h,m),h,4);v.push(f);a.push(v);break}case E.GeometricEffectControlMeasureLineRule.OpenCircle:{const h=
this._cp2(b,-2,0),p=this._sub(h,f),k=Math.cos(Math.PI/18),e=-Math.sin(Math.PI/18),m=[h];for(let r=1;33>=r;r++)this._rotateDirect(p,k,e),m.push(this._add(f,p));a.push(m);break}case E.GeometricEffectControlMeasureLineRule.CoverageEdgesWithTicks:{const h=this._cp2(b,0,-1);let p;if(3<=c)p=b[2];else{const v=this._sub(h,f),x=this._leftPerp(v);p=[f[0]+x[0]-.25*v[0],f[1]+x[1]-.25*v[1]]}let k;if(4<=c)k=b[3];else{const v=this._mid(f,h),x=this._sub(f,h);this._normalize(x);this._leftPerpendicular(x);const g=
this._crossProduct(x,this._sub(p,v));this._rightPerpendicular(x);k=[p[0]+x[0]*g*2,p[1]+x[1]*g*2]}const e=this._sub(h,f);let m,r;m=0<this._crossProduct(e,this._sub(p,f))?this._rightPerp(e):this._leftPerp(e);r=[];r.push(p);r.push(f);r.push([f[0]+(m[0]-e[0])/3,f[1]+(m[1]-e[1])/3]);a.push(r);m=0<this._crossProduct(e,this._sub(k,h))?this._rightPerp(m):this._leftPerp(e);r=[];r.push([h[0]+(m[0]+e[0])/3,h[1]+(m[1]+e[1])/3]);r.push(h);r.push(k);a.push(r);break}case E.GeometricEffectControlMeasureLineRule.GapExtentWithDoubleTicks:{const h=
this._cp2(b,0,2),p=this._cp3(b,h,0,1);let k;if(4<=c)k=b[3];else{const e=this._sub(h,f);k=this._add(p,e)}this._addAngledTicks(a,f,h,this._mid(p,k));this._addAngledTicks(a,p,k,this._mid(f,h));break}case E.GeometricEffectControlMeasureLineRule.GapExtentMidline:{const h=this._cp2(b,2,0),p=this._cp3(b,h,0,1);let k;if(4<=c)k=b[3];else{const m=this._sub(h,f);k=this._add(p,m)}const e=[];e.push(this._mid(f,p));e.push(this._mid(h,k));a.push(e);break}case E.GeometricEffectControlMeasureLineRule.Chevron:{const h=
this._cp2(b,-1,-1);let p;if(3<=c)p=b[2];else{const k=this._sub(h,f);this._leftPerpendicular(k);p=this._add(f,k)}a.push([h,this._makeCtrlPt(f),p]);break}case E.GeometricEffectControlMeasureLineRule.PerpendicularWithArc:{const h=this._cp2(b,0,-2),p=this._cp3(b,h,.5,-1);let k=this._sub(h,f);const e=this._norm(k);k[0]/=e;k[1]/=e;const m=this._crossProduct(k,this._sub(p,f));let r=this._dotProduct(k,this._sub(p,f));r<.05*e?r=.05*e:r>.95*e&&(r=.95*e);const v=[f[0]+k[0]*r,f[1]+k[1]*r];this._leftPerpendicular(k);
let x=[];x.push([v[0]-k[0]*m,v[1]-k[1]*m]);x.push([v[0]+k[0]*m,v[1]+k[1]*m]);a.push(x);const g=[h[0]+k[0]*m,h[1]+k[1]*m];k=this._sub(h,g);const u=Math.cos(Math.PI/18);let y=Math.sin(Math.PI/18);0>m&&(y=-y);x=[f,h];for(let z=1;9>=z;z++)this._rotateDirect(k,u,y),x.push(this._add(g,k));a.push(x);break}case E.GeometricEffectControlMeasureLineRule.ClosedHalfCircle:{const h=this._cp2(b,2,0),p=this._mid(f,h),k=this._sub(h,p),e=Math.cos(Math.PI/18),m=Math.sin(Math.PI/18),r=[f,h];for(let v=1;18>=v;v++)this._rotateDirect(k,
e,m),r.push(this._add(p,k));a.push(r);break}case E.GeometricEffectControlMeasureLineRule.TripleParallelExtended:{const h=this._cp2(b,0,-2),p=this._cp3(b,h,1,-2),k=this._mid(f,h),e=this._sub(p,h);this._normalize(e);const m=Math.abs(this._crossProduct(e,this._sub(k,h)))/2,r=this._dist(h,p),v=[h,f];v.push([f[0]+e[0]*r*.5,f[1]+e[1]*r*.5]);a.push(v);const x=[];x.push([k[0]-e[0]*m,k[1]-e[1]*m]);x.push([k[0]+e[0]*r*.375,k[1]+e[1]*r*.375]);D.setId(x[x.length-1],1);x.push([k[0]+e[0]*r*.75,k[1]+e[1]*r*.75]);
a.push(x);a.push([h,p]);break}case E.GeometricEffectControlMeasureLineRule.ParallelWithTicks:{const h=this._cp2(b,3,0),p=this._cp3(b,h,.5,-1),k=this._sub(p,h);this._normalize(k);const e=this._crossProduct(k,this._sub(p,f));this._leftPerpendicular(k);this._addAngledTicks(a,f,h,p);this._addAngledTicks(a,this._mix(f,1,k,e),this._mix(h,1,k,e),this._mid(f,h));break}case E.GeometricEffectControlMeasureLineRule.Parallel:{const h=this._cp2(b,3,0),p=this._cp3(b,h,.5,-1),k=this._sub(h,f);this._normalize(k);
const e=this._leftPerp(k),m=this._crossProduct(k,this._sub(p,f));let r=[f,h];a.push(r);r=[];r.push([f[0]+e[0]*m,f[1]+e[1]*m]);r.push([h[0]+e[0]*m,h[1]+e[1]*m]);a.push(r);break}case E.GeometricEffectControlMeasureLineRule.PerpendicularToFirstSegment:{const h=this._cp2(b,3,0),p=this._cp3(b,h,.5,-1),k=this._mid(f,h),e=this._sub(h,f);this._normalize(e);const m=this._crossProduct(e,this._sub(p,f));this._leftPerpendicular(e);const r=[];r.push([k[0]-e[0]*m*.25,k[1]-e[1]*m*.25]);r.push([k[0]+e[0]*m*1.25,
k[1]+e[1]*m*1.25]);a.push(r);break}case E.GeometricEffectControlMeasureLineRule.ParallelOffset:{const h=this._cp2(b,3,0),p=this._cp3(b,h,.5,-1),k=this._sub(h,f);this._normalize(k);const e=this._crossProduct(k,this._sub(p,f));this._leftPerpendicular(k);const m=[];m.push([f[0]-k[0]*e,f[1]-k[1]*e]);m.push([h[0]-k[0]*e,h[1]-k[1]*e]);a.push(m);const r=[];r.push([f[0]+k[0]*e,f[1]+k[1]*e]);r.push([h[0]+k[0]*e,h[1]+k[1]*e]);a.push(r);break}case E.GeometricEffectControlMeasureLineRule.OffsetOpposite:{const h=
this._cp2(b,3,0),p=this._cp3(b,h,.5,-1),k=this._sub(h,f);this._normalize(k);const e=this._crossProduct(k,this._sub(p,f));this._leftPerpendicular(k);const m=[];m.push([f[0]-k[0]*e,f[1]-k[1]*e]);m.push([h[0]-k[0]*e,h[1]-k[1]*e]);a.push(m);break}case E.GeometricEffectControlMeasureLineRule.OffsetSame:{const h=this._cp2(b,3,0),p=this._cp3(b,h,.5,-1),k=this._sub(h,f);this._normalize(k);const e=this._crossProduct(k,this._sub(p,f));this._leftPerpendicular(k);const m=[];m.push([f[0]+k[0]*e,f[1]+k[1]*e]);
m.push([h[0]+k[0]*e,h[1]+k[1]*e]);a.push(m);break}case E.GeometricEffectControlMeasureLineRule.CircleWithArc:{let h=this._cp2(b,3,0);const p=this._cp3(b,h,.5,-1);let k,e;if(4<=c)k=b[3],e=0<this._crossProduct(this._sub(k,h),this._sub(p,h));else{k=h;e=0<this._crossProduct(this._sub(k,f),this._sub(p,f));const g=24*this._geomUnitsPerPoint,u=this._sub(k,f);this._normalize(u,g);const y=Math.sqrt(2)/2;this._rotateDirect(u,y,e?y:-y);h=this._add(f,u)}const m=this._sub(h,f),r=Math.cos(Math.PI/18),v=Math.sin(Math.PI/
18),x=[h];for(let g=1;36>=g;g++)this._rotateDirect(m,r,v),x.push(this._add(f,m));this._add90DegArc(x,h,k,p,e);D.setId(x[x.length-8],1);a.push(x);break}case E.GeometricEffectControlMeasureLineRule.DoubleJog:{let h=this._cp2(b,-3,1),p;p=3<=c?b[2]:this._add(f,this._sub(f,h));let k;if(4<=c)k=b[3];else{const z=f;f=h;k=p;const w=this._dist(f,z),B=this._dist(k,z);let F=30*this._geomUnitsPerPoint;.5*w<F&&(F=.5*w);.5*B<F&&(F=.5*B);h=this._mix(f,F/w,z,(w-F)/w);p=this._mix(k,F/B,z,(B-F)/B)}const e=this._mid(f,
h),m=this._mid(k,p),r=this._dist(f,h),v=this._dist(p,k);let x=Math.min(r,v)/8;x=Math.min(x,24*this._geomUnitsPerPoint);const g=Math.cos(Math.PI/4);let u=this._sub(f,h);this._normalize(u,x);0<this._crossProduct(u,this._sub(k,h))?this._rotateDirect(u,g,-g):this._rotateDirect(u,g,g);let y=[];y.push(h);y.push(this._add(e,u));y.push(this._sub(e,u));y.push(f);a.push(y);u=this._sub(k,p);this._normalize(u,x);0>this._crossProduct(u,this._sub(f,p))?this._rotateDirect(u,g,g):this._rotateDirect(u,g,-g);y=[];
y.push(p);y.push(this._add(m,u));y.push(this._sub(m,u));y.push(k);a.push(y);break}case E.GeometricEffectControlMeasureLineRule.PerpendicularOffset:{const h=this._cp2(b,-4,1),p=this._cp3(b,h,.882353,-1.94),k=this._sub(p,h);0<this._crossProduct(k,this._sub(f,h))?this._rightPerpendicular(k):this._leftPerpendicular(k);const e=[k[0]/8,k[1]/8],m=this._sub(this._mid(h,p),e);a.push([m,f]);break}case E.GeometricEffectControlMeasureLineRule.LineExcludingLastSegment:{const h=this._arrowPath(b),p=[];let k=h.length-
2;for(;k--;)p.push(h[k]);a.push(p);break}case E.GeometricEffectControlMeasureLineRule.MultivertexArrow:{const h=this._arrowPath(b),p=[];this._addArrow(p,h,!1);a.push(p);break}case E.GeometricEffectControlMeasureLineRule.CrossedArrow:{const h=this._arrowPath(b),p=[];this._addArrow(p,h,!0);a.push(p);break}case E.GeometricEffectControlMeasureLineRule.ChevronArrow:{const [h,p]=this._arrowLastSeg(b),k=10*this._geomUnitsPerPoint,e=this._sub(f,h);this._normalize(e);const m=this._crossProduct(e,this._sub(p,
h)),r=this._leftPerp(e),v=[p[0]-r[0]*m*2,p[1]-r[1]*m*2],x=[];x.push([p[0]+e[0]*k,p[1]+e[1]*k]);x.push(f);x.push([v[0]+e[0]*k,v[1]+e[1]*k]);a.push(x);break}case E.GeometricEffectControlMeasureLineRule.ChevronArrowOffset:{const [h,p]=this._arrowLastSeg(b),k=this._sub(f,h);this._normalize(k);const e=this._crossProduct(k,this._sub(p,h));this._leftPerpendicular(k);const m=[p[0]-k[0]*e,p[1]-k[1]*e],r=[];r.push([m[0]+k[0]*e*.5,m[1]+k[1]*e*.5]);r.push(this._mid(m,f));r.push([m[0]-k[0]*e*.5,m[1]-k[1]*e*.5]);
a.push(r);break}case E.GeometricEffectControlMeasureLineRule.PartialFirstSegment:{const [h,p]=this._arrowLastSeg(b),k=this._sub(f,h);this._normalize(k);const e=this._crossProduct(k,this._sub(p,h));this._leftPerpendicular(k);a.push([h,[p[0]-k[0]*e,p[1]-k[1]*e]]);break}case E.GeometricEffectControlMeasureLineRule.Arch:{const h=this._cp2(b,0,-1),p=this._cp3(b,h,.5,1),k=this._sub(f,h),e=this._mix(p,1,k,.55),m=this._mix(p,1,k,-.55),r=[f];this._addBezier2(r,f,e,p,4);this._addBezier2(r,p,m,h,4);a.push(r);
break}case E.GeometricEffectControlMeasureLineRule.CurvedParallelTicks:{const h=this._cp2(b,-4,1),p=this._cp3(b,h,.882353,-1.94),k=this._sub(p,h);0<this._crossProduct(k,this._sub(f,h))?this._rightPerpendicular(k):this._leftPerpendicular(k);const e=[k[0]/8,k[1]/8],m=this._sub(this._mid(h,p),e),r=this._sub(this._mix(h,.75,p,.25),e),v=this._sub(this._mix(h,.25,p,.75),e),x=[h];this._addBezier2(x,h,r,m,3);this._addBezier2(x,m,v,p,3);a.push(x);for(let g=0;8>g;g++){const u=x[2*g+1],y=[this._clone(u)];y.push(this._add(u,
[k[0]/4,k[1]/4]));a.push(y)}break}case E.GeometricEffectControlMeasureLineRule.Arc90Degrees:{const h=this._cp2(b,0,-1),p=this._cp3(b,h,.5,1),k=[h];this._add90DegArc(k,h,f,p);a.push(k);break}default:a.push(b)}}return a};return n}();q.EffectControlMeasureLine=C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectCut":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(q,
t,D,E){let C=function(){function n(){}n.local=function(){null===n.instance&&(n.instance=new n);return n.instance};n.prototype.execute=function(l,d,a,b){return new A(l,d,a)};return n}();C.instance=null;let A=function(n){function l(d,a,b){d=n.call(this,d,!0,!0)||this;d._curveHelper=new E.CurveHelper;d._beginCut=(void 0!==a.beginCut?a.beginCut:1)*b;d._endCut=(void 0!==a.endCut?a.endCut:1)*b;d._middleCut=(void 0!==a.middleCut?a.middleCut:0)*b;d._invert=void 0!==a.invert?a.invert:!1;0>d._beginCut&&(d._beginCut=
0);0>d._endCut&&(d._endCut=0);0>d._middleCut&&(d._middleCut=0);return d}t._inheritsLoose(l,n);l.prototype.processPath=function(d){var a=this._beginCut;const b=this._endCut,c=this._middleCut,f=this._curveHelper.calculatePathLength(d),h=[];if(!this._invert)0===a&&0===b&&0===c?h.push(d):a+b+c>=f||(0===c?(d=this._curveHelper.getSubCurve(d,a,f-b))&&h.push(d):((a=this._curveHelper.getSubCurve(d,a,.5*(f-c)))&&h.push(a),(a=this._curveHelper.getSubCurve(d,.5*(f+c),f-b))&&h.push(a)));else if(0!==a||0!==b||
0!==c)a+b+c>=f?h.push(d):((a=this._curveHelper.getSubCurve(d,0,a))&&h.push(a),(a=this._curveHelper.getSubCurve(d,.5*(f-c),.5*(f+c)))&&h.push(a),(a=this._curveHelper.getSubCurve(d,f-b,b))&&h.push(a));return 0===h.length?null:{paths:h}};return l}(D.PathGeometryCursor);q.EffectCut=C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectDashes":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../CIMCursor ../CurveHelper ../enums ../GeometryWalker".split(" "),
function(q,t,D,E,C,A){let n=function(){function d(){}d.local=function(){null===d.instance&&(d.instance=new d);return d.instance};d.prototype.execute=function(a,b,c,f){return new l(a,b,c)};return d}();n.instance=null;let l=function(d){function a(b,c,f){var h,p;b=d.call(this,b,!0,!0)||this;b._walker=new A.GeometryWalker;b._walker.updateTolerance(f);b._endings=c.lineDashEnding;b._customDashPos=-(null!=(h=c.offsetAlongLine)?h:0)*f;b._offsetAtEnd=(null!=(p=c.customEndingOffset)?p:0)*f;b._pattern=new A.DashPattern;
b._pattern.init(c.dashTemplate,!0);b._pattern.scale(f);return b}t._inheritsLoose(a,d);a.prototype.processPath=function(b){if(0===this._pattern.length())return this.iteratePath=!1,{paths:[b]};if(!this.iteratePath){var c=!0;switch(this._endings){default:this._pattern.extPtGap=0;break;case C.LineDashEnding.FullPattern:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case C.LineDashEnding.FullGap:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case C.LineDashEnding.NoConstraint:this.isClosed||
(c=!1);break;case C.LineDashEnding.Custom:this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}var f=this._walker.calculatePathLength(b);if(this._pattern.isEmpty()||f<.1*this._pattern.length()||!this._walker.init(b,this._pattern,c))return{paths:[b]}}if(this.iteratePath)b=this._pattern.nextValue();else{switch(this._endings){default:c=.5*this._pattern.firstValue();break;case C.LineDashEnding.HalfGap:c=.5*-this._pattern.lastValue();break;case C.LineDashEnding.FullGap:c=-this._pattern.lastValue();
break;case C.LineDashEnding.FullPattern:c=0;break;case C.LineDashEnding.NoConstraint:case C.LineDashEnding.Custom:c=-this._customDashPos}b=c/this._pattern.length();b-=Math.floor(b);c=b*this._pattern.length();this._pattern.reset();b=this._pattern.nextValue();for(f=!1;c>=b;)c-=b,b=this._pattern.nextValue(),f=!f;b-=c;f?(this._walker.nextPosition(b),b=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(b),b=this._pattern.nextValue(),this._walker.nextPosition(b),b=this._pattern.nextValue())}(c=
this._walker.nextCurve(b))?this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(this._firstCurve.splice(0,1),E.PathHelper.mergePath(c,this._firstCurve),this._firstCurve=null)):(b=this._pattern.nextValue(),!this._walker.nextPosition(b)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(c=this._firstCurve,this._firstCurve=null)):this.iteratePath=!0):(this.iteratePath=!1,c=this._firstCurve,this._firstCurve=null);return{paths:[c]}};return a}(D.PathGeometryCursor);q.EffectDashes=
n;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/GeometryWalker":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./CIMCursor","./CurveHelper"],function(q,t,D,E){let C=function(){function l(){this._values=[];this._currentValue=this._length=this.ctrlPtGap=this.extPtGap=0}var d=l.prototype;d.isEmpty=function(){return 0===this._values.length};d.size=function(){return this._values.length};d.init=function(a,b,c=!0){this._setEmpty();
if(!a||0===a.length)return!1;for(let f=0;f<a.length;f++){let h=Math.abs(a[f]);c&&1E-7>h&&(h=1E-7);this._values.push(h);this._length+=h}b&&a.length&1&&(this._length*=2);if(0===this._length)return!1;this.ctrlPtGap=this.extPtGap=0;this._currentValue=-1;return!0};d.scale=function(a){const b=this._values?this._values.length:0;for(let c=0;c<b;++c)this._values[c]*=a;this._length*=a;this.extPtGap*=a;this.ctrlPtGap*=a};d.addValue=function(a){this._length+=a;this._values.push(a)};d.firstValue=function(){return this._values[0]};
d.lastValue=function(){return this._values[this._values.length-1]};d.nextValue=function(){this._currentValue++;this._currentValue===this._values.length&&(this._currentValue=0);return this._values[this._currentValue]};d.reset=function(){this._currentValue=-1};d.length=function(){return this._length};d._setEmpty=function(){this.extPtGap=this.ctrlPtGap=this._length=0;this._currentValue=-1;this._values.length=0};return l}();q.EndType=void 0;(function(l){l[l.FAIL=0]="FAIL";l[l.END=1]="END";l[l.CONTINUE=
2]="CONTINUE"})(q.EndType||(q.EndType={}));let A=function(){function l(){this.reset()}var d=l.prototype;d.reset=function(){this.segment=-1;this.abscissa=this.segmentLength=0;this.isPartEnd=this.isPathEnd=!1};d.isValid=function(){return-1!==this.segment};d.copyTo=function(a){a.segment=this.segment;a.segmentLength=this.segmentLength;a.abscissa=this.abscissa;a.isPathEnd=this.isPathEnd;a.isPartEnd=this.isPartEnd};return l}(),n=function(l){function d(b=0,c=!1){b=l.call(this,b,c)||this;b._tolerance=E.PIXEL_TOLERANCE;
b._currentPosition=new A;return b}t._inheritsLoose(d,l);var a=d.prototype;a.updateTolerance=function(b){this._tolerance=E.PIXEL_TOLERANCE*b};a.init=function(b,c,f=!0){f?(this._patternLength=c.length(),this._partExtPtGap=c.extPtGap,this._partCtrlPtGap=c.ctrlPtGap):this._partCtrlPtGap=this._partExtPtGap=this._patternLength=0;this._currentPosition.reset();this._partSegCount=0;this._path=b;this._seg=-1;return this._setPosAtNextPart()};a.curPositionIsValid=function(){return this._currentPosition.isValid()};
a.nextPosition=function(b,c=q.EndType.FAIL){const f=new A;if(!this._nextPosition(b,f,null,c))return!1;f.copyTo(this._currentPosition);return!0};a.curPointAndAngle=function(b){b.pt=this._getPoint(this._currentPosition);const [c,f]=this._getAngle(this._currentPosition);b.ca=c;b.sa=f};a.nextPointAndAngle=function(b,c,f=q.EndType.FAIL){const h=new A;if(!this._nextPosition(b,h,null,f))return!1;h.copyTo(this._currentPosition);c.pt=this._getPoint(h);const [p,k]=this._getAngle(h);c.ca=p;c.sa=k;return!0};
a.nextCurve=function(b){if(0===b)return null;const c=[],f=new A;if(!this._nextPosition(b,f,c,q.EndType.END))return null;f.copyTo(this._currentPosition);return c};a.isPathEnd=function(){return this._currentPosition.isPathEnd};a.getPathEnd=function(){if(-1===this._currentPosition.segment)throw Error("missing segment");return this._path[this._currentPosition.segment+1]};a._nextPosition=function(b,c,f,h){if(this._currentPosition.isPathEnd)return!1;var p=this._currentPosition.abscissa;0<this._currentPosition.segmentLength&&
(p/=this._currentPosition.segmentLength);for(this._currentPosition.copyTo(c);c.abscissa+b*this._partLengthRatio>c.segmentLength+this._tolerance;)if(f&&(0===f.length&&(0===p?(p=this._path[c.segment],f.push([p[0],p[1]])):f.push(this.getSegCoord2D(this._path,c.segment,p))),p=this._path[c.segment+1],f.push([p[0],p[1]])),p=0,b-=(c.segmentLength-c.abscissa)/this._partLengthRatio,this._partSegCount)c.segment=this._nextSegment(),c.segmentLength=this.calculateSegLength(this._path,c.segment),c.abscissa=0,this._partSegCount--;
else{if(!this._setPosAtNextPart()){if(h===q.EndType.FAIL)return!1;c.segmentLength=this.calculateSegLength(this._path,c.segment);c.isPartEnd=!0;h===q.EndType.END?(c.abscissa=c.segmentLength,c.isPathEnd=!0):c.abscissa=c.segmentLength+b;return!0}this._currentPosition.copyTo(c)}c.abscissa+=b*this._partLengthRatio;f&&(0===f.length&&(0===p?(b=this._path[c.segment],f.push([b[0],b[1]])):f.push(this.getSegCoord2D(this._path,c.segment,p))),b=c.abscissa/c.segmentLength,1===b?(b=this._path[c.segment+1],f.push([b[0],
b[1]])):f.push(this.getSegCoord2D(this._path,c.segment,b)));!this._partSegCount&&Math.abs(c.abscissa-c.segmentLength)<this._tolerance&&(c.isPathEnd=this._partIsLast,c.isPartEnd=!0);return!0};a._getPoint=function(b){if(-1===b.segment)throw Error("missing segment");return this.getSegCoord2D(this._path,b.segment,0>=b.segmentLength?0:b.abscissa/b.segmentLength)};a._getAngle=function(b){if(-1===b.segment)throw Error("missing segment");return this.getSegAngleCS(this._path,b.segment,0>=b.segmentLength?0:
b.abscissa/b.segmentLength)};a._setPosAtNextPart=function(){for(;this._partSegCount;)this._hasNextSegment()&&this._nextSegment(),this._partSegCount--;if(!this._hasNextSegment())return!1;this._partLength=0;this._partIsLast=!0;for(this._partSegCount=0;this._hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,this._nextSegment()),this._partSegCount++,1===D.getId(this._path[this._getEndPointIndex()])){this._partIsLast=!this._hasNextSegment();break}for(var b=this._partSegCount;b;)this._previousSegment(),
--b;this._currentPosition.segment=this._nextSegment();this._currentPosition.segmentLength=this.calculateSegLength(this._path,this._currentPosition.segment);this._currentPosition.abscissa=0;this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1;--this._partSegCount;b=this._getStartPointIndex();this._ctrlPtBegin=1===D.getId(this._path[b]);b=b+this._partSegCount+1;b>=this._path.length&&(b=0);this._ctrlPtEnd=1===D.getId(this._path[b]);if(0<this._patternLength){b=this._ctrlPtBegin?this._partCtrlPtGap:
this._partExtPtGap;const c=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let f=Math.round((this._partLength-(b+c))/this._patternLength);0>=f&&(f=0<b+c?0:1);this._partLengthRatio=this._partLength/(b+c+f*this._patternLength);.01>this._partLengthRatio&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0};a._hasNextSegment=function(){return this._seg<this._path.length-2};a._previousSegment=function(){return--this._seg};a._nextSegment=function(){return++this._seg};a._getStartPointIndex=
function(){return this._seg};a._getEndPointIndex=function(){return this._seg+1};return d}(E.CurveHelper);q.DashPattern=C;q.GeometryWalker=n;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectDonut":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums"],function(q,t,D,E){let C=function(){function n(){}n.local=function(){null===n.instance&&(n.instance=new n);return n.instance};n.prototype.execute=
function(l,d,a,b){return new A(l,d,a)};return n}();C.instance=null;let A=function(){function n(l,d,a){this._inputGeometries=l;this._curveHelper=new D.CurveHelper;this._width=(void 0!==d.width?d.width:2)*a;switch(d.method){default:this._method=E.GeometricEffectOffsetMethod.Mitered;break;case E.GeometricEffectDonutMethod.Bevelled:this._method=E.GeometricEffectOffsetMethod.Bevelled;break;case E.GeometricEffectDonutMethod.Rounded:case E.GeometricEffectDonutMethod.TrueBuffer:this._method=E.GeometricEffectOffsetMethod.Rounded;
break;case E.GeometricEffectDonutMethod.Square:this._method=E.GeometricEffectOffsetMethod.Square}this._option=d.option;this._offsetFlattenError=D.PIXEL_TOLERANCE*a}n.prototype.next=function(){for(var l=this._inputGeometries.next();l;){if(t.isExtent(l)&&0<this._width){if(0>Math.min(l.xmax-l.xmin,l.ymax-l.ymin)-2*this._width)return l;var d=[];d.push([[l.xmin,l.ymin],[l.xmin,l.ymax],[l.xmax,l.ymax],[l.xmax,l.ymin],[l.xmin,l.ymin]]);d.push([[l.xmin+this._width,l.ymin+this._width],[l.xmax-this._width,
l.ymin+this._width],[l.xmax-this._width,l.ymax-this._width],[l.xmin+this._width,l.ymax-this._width],[l.xmin+this._width,l.ymin+this._width]]);return{rings:d}}if(t.isPolygon(l)&&0<this._width){d=[];for(const a of l.rings){l=this._curveHelper.calculatePathLength(a);const b=this._curveHelper.offset(a,this._width,this._method,4,this._offsetFlattenError);b&&(0>l&&b.reverse(),d.push(b))}if(d.length)return{rings:d}}l=this._inputGeometries.next()}return null};return n}();q.EffectDonut=C;Object.defineProperties(q,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectJog":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(q,t,D,E){let C=function(){function n(){}n.local=function(){null===n.instance&&(n.instance=new n);return n.instance};n.prototype.execute=function(l,d,a,b){return new A(l,d,a)};return n}();C.instance=null;let A=function(n){function l(d,a,b){d=n.call(this,d,!1,!0)||this;d._curveHelper=
new E.CurveHelper;d._length=(void 0!==a.length?a.length:20)*b;d._angle=void 0!==a.angle?a.angle:225;d._position=void 0!==a.position?a.position:50;0>d._length&&(d._length=-d._length);20>d._position&&(d._position=20);80<d._position&&(d._position=80);d._mirror=!1;return d}t._inheritsLoose(l,n);l.prototype.processPath=function(d){if(this._curveHelper.isEmpty(d,!1))return null;const a=d[0];d=d[d.length-1];this._curveHelper.normalize([d[0]-a[0],d[1]-a[1]]);const b=[a[0]+(d[0]-a[0])*this._position/100,a[1]+
(d[1]-a[1])*this._position/100],c=Math.cos((90-this._angle)/180*Math.PI);let f=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&(f=-f);this._mirror=!this._mirror;return{paths:[[a,[b[0]-this._length/2*c,b[1]-this._length/2*f],[b[0]+this._length/2*c,b[1]+this._length/2*f],d]]}};return l}(D.PathGeometryCursor);q.EffectJog=C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectMove":function(){define(["exports","../../../core/lang",
"../../../geometry/support/jsonUtils"],function(q,t,D){let E=function(){function A(){}A.local=function(){null===A.instance&&(A.instance=new A);return A.instance};A.prototype.execute=function(n,l,d,a){return new C(n,l,d)};return A}();E.instance=null;let C=function(){function A(l,d,a){this._inputGeometries=l;this._offsetX=void 0!==d.offsetX?d.offsetX*a:0;this._offsetY=void 0!==d.offsetY?-d.offsetY*a:0}var n=A.prototype;n.next=function(){for(var l=this._inputGeometries.next();l;){if(D.isExtent(l))return{xmin:l.xmin+
this._offsetX,xmax:l.xmax+this._offsetX,ymin:l.ymin+this._offsetY,ymax:l.ymax+this._offsetY};if(D.isPolygon(l))return l=t.clone(l),this._moveMultipath(l.rings,this._offsetX,this._offsetY),l;if(D.isPolyline(l))return l=t.clone(l),this._moveMultipath(l.paths,this._offsetX,this._offsetY),l;if(D.isMultipoint(l))return l=t.clone(l),this._movePath(l.points,this._offsetX,this._offsetY),l;if(D.isPoint(l))return{x:l.x+this._offsetX,y:l.y+this._offsetY};l=this._inputGeometries.next()}return null};n._moveMultipath=
function(l,d,a){if(l)for(const b of l)this._movePath(b,d,a)};n._movePath=function(l,d,a){if(l)for(const b of l)b[0]+=d,b[1]+=a};return A}();q.EffectMove=E;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectOffset":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums"],function(q,t,D,E){let C=function(){function n(){}n.local=function(){null===n.instance&&(n.instance=new n);return n.instance};
n.prototype.execute=function(l,d,a,b){return new A(l,d,a)};return n}();C.instance=null;let A=function(){function n(l,d,a){var b;this._inputGeometries=l;this._curveHelper=new D.CurveHelper;this._offset=(null!=(b=d.offset)?b:1)*a;this._method=d.method;this._option=d.option;this._offsetFlattenError=D.PIXEL_TOLERANCE*a}n.prototype.next=function(){for(var l=this._inputGeometries.next();l;){if(0===this._offset)return l;if(t.isExtent(l)){if(this._method===E.GeometricEffectOffsetMethod.Rounded&&0<this._offset){var d=
this._curveHelper.offset([[l.xmin,l.ymin],[l.xmin,l.ymax],[l.xmax,l.ymax],[l.xmax,l.ymin],[l.xmin,l.ymin]],-this._offset,this._method,4,this._offsetFlattenError);return d?{rings:[d]}:null}if(0<Math.min(l.xmax-l.xmin,l.ymax-l.ymin)+2*this._offset)return{xmin:l.xmin-this._offset,xmax:l.xmax+this._offset,ymin:l.ymin-this._offset,ymax:l.ymax+this._offset}}if(t.isPolygon(l)){var a=[];for(d of l.rings){const b=this._curveHelper.offset(d,-this._offset,this._method,4,this._offsetFlattenError);b&&a.push(b)}if(a.length)return{rings:a}}if(t.isPolyline(l)){a=
[];for(const b of l.paths)(l=this._curveHelper.offset(b,-this._offset,this._method,4,this._offsetFlattenError))&&a.push(l);if(a.length)return{paths:a}}l=this._inputGeometries.next()}return null};return n}();q.EffectOffset=C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectReverse":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(q,t,D,E){let C=function(){function n(){}
n.local=function(){null===n.instance&&(n.instance=new n);return n.instance};n.prototype.execute=function(l,d,a,b){return new A(l,d,a)};return n}();C.instance=null;let A=function(){function n(l,d,a){this._inputGeometries=l;this._reverse=void 0!==d.reverse?d.reverse:!0}n.prototype.next=function(){for(var l=this._inputGeometries.next();l;){if(!this._reverse)return l;if(D.isPolyline(l))return l=t.clone(l),E.reverseMultipath(l.paths),l;l=this._inputGeometries.next()}return null};return n}();q.EffectReverse=
C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectRotate":function(){define(["exports","../../../core/lang","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils"],function(q,t,D,E,C){let A=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(d,a,b,c){return new n(d,a,b)};return l}();
A.instance=null;let n=function(){function l(a,b,c){this._inputGeometries=a;this._rotateAngle=void 0!==b.angle?b.angle*Math.PI/180:0}var d=l.prototype;d.next=function(){for(var a=this._inputGeometries.next();a;){if(0===this._rotateAngle)return a;var b=D.create();E.getBoundsXY(b,a);const c=(b[2]+b[0])/2;b=(b[3]+b[1])/2;if(C.isExtent(a))return a={rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]},this._rotateMultipath(a.rings,c,b),a;if(C.isPolygon(a))return a=
t.clone(a),this._rotateMultipath(a.rings,c,b),a;if(C.isPolyline(a))return a=t.clone(a),this._rotateMultipath(a.paths,c,b),a;if(C.isMultipoint(a))return a=t.clone(a),this._rotatePath(a.points,c,b),a;if(C.isPoint(a))return a;a=this._inputGeometries.next()}return null};d._rotateMultipath=function(a,b,c){if(a)for(const f of a)this._rotatePath(f,b,c)};d._rotatePath=function(a,b,c){if(a){const f=Math.cos(this._rotateAngle),h=Math.sin(this._rotateAngle);for(const p of a){a=p[0]-b;const k=p[1]-c;p[0]=b+a*
f-k*h;p[1]=c+a*h+k*f}}};return l}();q.EffectRotate=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectScale":function(){define(["exports","../../../core/lang","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils"],function(q,t,D,E,C){let A=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=
function(d,a,b,c){return new n(d,a,b)};return l}();A.instance=null;let n=function(){function l(a,b,c){this._inputGeometries=a;this._xFactor=void 0!==b.xScaleFactor?b.xScaleFactor:1.15;this._yFactor=void 0!==b.yScaleFactor?b.yScaleFactor:1.15}var d=l.prototype;d.next=function(){for(var a=this._inputGeometries.next();a;){if(1===this._xFactor&&1===this._yFactor)return a;var b=D.create();E.getBoundsXY(b,a);const c=(b[2]+b[0])/2;b=(b[3]+b[1])/2;if(C.isExtent(a))return a={rings:[[[a.xmin,a.ymin],[a.xmin,
a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]},this._scaleMultipath(a.rings,c,b),a;if(C.isPolygon(a))return a=t.clone(a),this._scaleMultipath(a.rings,c,b),a;if(C.isPolyline(a))return a=t.clone(a),this._scaleMultipath(a.paths,c,b),a;if(C.isMultipoint(a))return a=t.clone(a),this._scalePath(a.points,c,b),a;if(C.isPoint(a))return a;a=this._inputGeometries.next()}return null};d._scaleMultipath=function(a,b,c){if(a)for(const f of a)this._scalePath(f,b,c)};d._scalePath=function(a,b,c){if(a)for(const f of a)a=
(f[1]-c)*this._yFactor,f[0]=b+(f[0]-b)*this._xFactor,f[1]=c+a};return l}();q.EffectScale=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectWave":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums","../GeometryWalker"],function(q,t,D,E,C){let A=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(d,a,b,c){return new n(d,
a,b)};return l}();A.instance=null;let n=function(){function l(a,b,c){this._inputGeometries=a;this._height=(void 0!==b.amplitude?b.amplitude:2)*c;this._period=(void 0!==b.period?b.period:3)*c;this._style=b.waveform;0>=this._height&&(this._height=Math.abs(this._height));0>=this._period&&(this._period=Math.abs(this._period));this._pattern=new C.DashPattern;this._pattern.addValue(this._period);this._pattern.addValue(this._period);this._walker=new C.GeometryWalker;this._walker.updateTolerance(c)}var d=
l.prototype;d.next=function(){for(var a=this._inputGeometries.next();a;){if(0===this._height||0===this._period)return a;if(t.isPolyline(a)){const b=this._processGeom(a.paths);if(b.length)return{paths:b}}if(t.isPolygon(a)&&(a=this._processGeom(a.rings),a.length))return{rings:a};a=this._inputGeometries.next()}return null};d._processGeom=function(a){const b=[];for(const c of a)if(this._walker.init(c,this._pattern))switch(this._style){default:b.push(this._constructCurve(c,!1));break;case E.GeometricEffectWaveform.Square:b.push(this._constructSquare(c));
break;case E.GeometricEffectWaveform.Triangle:b.push(this._constructTriangle(c));break;case E.GeometricEffectWaveform.Random:b.push(this._constructCurve(c,!0))}else b.push(c);return b};d._constructCurve=function(a,b){const c=new D.PathHelper;var f=this._walker.calculatePathLength(a),h=Math.round(f/this._period);0===h&&(h=1);const p=this._period/16,k=1/(16*h+1);f=2*Math.PI*f/(f/h);h=2*Math.PI*Math.random();const e=2*Math.PI*Math.random(),m=2*Math.PI*Math.random(),r=.75-Math.random()/2,v=.75-Math.random()/
2,x={};this._walker.curPointAndAngle(x);c.startPath(x.pt);let g=0;for(;;)if(this._walker.nextPointAndAngle(p,x)){const u=g;g+=k;let y;if(b){const z=this._height/2*(1+.3*Math.sin(r*f*u+h));y=z*Math.sin(f*u+e);y+=z*Math.sin(v*f*u+m);y/=2}else y=.5*this._height*Math.sin(.5*f*u);c.lineTo([x.pt[0]-y*x.sa,x.pt[1]+y*x.ca])}else{c.lineTo(a[a.length-1]);break}return c.path()};d._constructSquare=function(a){const b=new D.PathHelper;a=this._walker.calculatePathLength(a);Math.round(a/this._period);for(a=!0;;){let c=
!1;if(this._walker.curPositionIsValid()){const f={};this._walker.curPointAndAngle(f);const h={};if(this._walker.nextPointAndAngle(this._period,h)){const p={};this._walker.nextPointAndAngle(this._period,p)&&(a?(b.startPath(f.pt),a=!1):b.lineTo(f.pt),b.lineTo([f.pt[0]-this._height/2*f.sa,f.pt[1]+this._height/2*f.ca]),b.lineTo([h.pt[0]-this._height/2*h.sa,h.pt[1]+this._height/2*h.ca]),b.lineTo([h.pt[0]+this._height/2*h.sa,h.pt[1]-this._height/2*h.ca]),b.lineTo([p.pt[0]+this._height/2*p.sa,p.pt[1]-this._height/
2*p.ca]),c=!0)}}if(!c){b.lineTo(this._walker.getPathEnd());break}}return b.path()};d._constructTriangle=function(a){const b=new D.PathHelper;a=this._walker.calculatePathLength(a);Math.round(a/this._period);for(a=!0;;){let c=!1;if(this._walker.curPositionIsValid()){const f={};this._walker.curPointAndAngle(f);const h={};if(this._walker.nextPointAndAngle(this._period/2,h)){const p={};this._walker.nextPointAndAngle(this._period,p)&&(this._walker.nextPosition(this._period/2)&&(a?(b.startPath(f.pt),a=!1):
b.lineTo(f.pt),b.lineTo([h.pt[0]-this._height/2*h.sa,h.pt[1]+this._height/2*h.ca]),b.lineTo([p.pt[0]+this._height/2*p.sa,p.pt[1]-this._height/2*p.ca])),c=!0)}}if(!c){b.lineTo(this._walker.getPathEnd());break}}return b.path()};return l}();q.EffectWave=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementAlongLineSameSize":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../enums",
"../GeometryWalker"],function(q,t,D,E,C){let A=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(d,a,b,c){return new n(d,a,b)};return l}();A.instance=null;let n=function(l){function d(b,c,f){var h;b=l.call(this,b,!0,!0)||this;b._geometryWalker=new C.GeometryWalker;b._geometryWalker.updateTolerance(f);b._angleToLine=null!=(h=c.angleToLine)?h:!0;b._offset=(c.offset?c.offset:0)*f;b._originalEndings=c.endings;b._offsetAtEnd=
(c.customEndingOffset?c.customEndingOffset:0)*f;b._position=-(c.offsetAlongLine?c.offsetAlongLine:0)*f;b._pattern=new C.DashPattern;b._pattern.init(c.placementTemplate,!1);b._pattern.scale(f);b._endings=b._originalEndings;return b}t._inheritsLoose(d,l);var a=d.prototype;a.processPath=function(b){if(this._pattern.isEmpty())return null;if(this.iteratePath)var c=this._pattern.nextValue();else{this._endings=this._originalEndings===E.PlacementEndings.WithFullGap&&this.isClosed?E.PlacementEndings.WithMarkers:
this._originalEndings;this._pattern.extPtGap=0;let f=!0;switch(this._endings){case E.PlacementEndings.NoConstraint:c=-this._position;c=this._adjustPosition(c);f=!1;break;default:c=-this._pattern.lastValue()/2;break;case E.PlacementEndings.WithFullGap:c=-this._pattern.lastValue();this._pattern.extPtGap=this._pattern.lastValue();break;case E.PlacementEndings.WithMarkers:c=0;break;case E.PlacementEndings.Custom:c=-this._position,c=this._adjustPosition(c),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._geometryWalker.init(b,
this._pattern,f))return null;this._pattern.reset();for(b=0;c>b;)c-=b,b=this._pattern.nextValue();c=b-=c;this.iteratePath=!0}b={};if(!this._geometryWalker.nextPointAndAngle(c,b)||this._endings===E.PlacementEndings.WithFullGap&&this._geometryWalker.isPathEnd())return this.iteratePath=!1,null;if(this._endings===E.PlacementEndings.WithMarkers&&this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed))return null;this.internalPlacement.setTranslate(b.pt[0]-this._offset*b.sa,b.pt[1]+this._offset*
b.ca);this._angleToLine&&this.internalPlacement.setRotateCS(b.ca,b.sa);return this.internalPlacement};a._adjustPosition=function(b){b/=this._pattern.length();b-=Math.floor(b);return b*this._pattern.length()};return d}(D.PathTransformationCursor);q.PlacementAlongLineSameSize=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementAtExtremities":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor",
"../CurveHelper","../enums"],function(q,t,D,E,C){let A=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(d,a,b,c){return new n(d,a,b)};return l}();A.instance=null;let n=function(l){function d(b,c,f){b=l.call(this,b,!1,!0)||this;b._curveHelper=new E.CurveHelper;b._angleToLine=void 0!==c.angleToLine?c.angleToLine:!0;b._offset=void 0!==c.offset?c.offset*f:0;b._type=c.extremityPlacement;b._position=void 0!==c.offsetAlongLine?
c.offsetAlongLine*f:0;b._beginProcessed=!1;return b}t._inheritsLoose(d,l);var a=d.prototype;a.processPath=function(b){let c;switch(this._type){default:this._beginProcessed?(c=this._atExtremities(b,this._position,!1),this.iteratePath=this._beginProcessed=!1):(c=this._atExtremities(b,this._position,!0),this.iteratePath=this._beginProcessed=!0);break;case C.ExtremityPlacement.JustBegin:c=this._atExtremities(b,this._position,!0);break;case C.ExtremityPlacement.JustEnd:c=this._atExtremities(b,this._position,
!1);case C.ExtremityPlacement.None:}return c};a._atExtremities=function(b,c,f){var h=b.length;if(2>h)return null;var p=f?1:h-2;const k=f?h:-1,e=f?1:-1;let m=0;f=f?b[0]:b[h-1];for(h=p;h!==k;h+=e){p=f;f=b[h];const r=this._curveHelper.calculateLength(p,f);if(m+r>c){b=(c-m)/r;const [v,x]=this._curveHelper.getAngleCS(p,f,b);b=D.getCoord2D(p,f,b);this.internalPlacement.setTranslate(b[0]-this._offset*x,b[1]+this._offset*v);this._angleToLine&&this.internalPlacement.setRotateCS(-v,-x);return this.internalPlacement}m+=
r}return null};return d}(D.PathTransformationCursor);q.PlacementAtExtremities=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementAtRatioPositions":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../GeometryWalker"],function(q,t,D,E){let C=function(){function n(){}n.local=function(){null===n.instance&&(n.instance=new n);return n.instance};n.prototype.execute=function(l,d,a,b){return new A(l,
d,a)};return n}();C.instance=null;let A=function(n){function l(d,a,b){d=n.call(this,d,!0,!0)||this;d._walker=new E.GeometryWalker;d._walker.updateTolerance(b);d._angleToLine=void 0!==a.angleToLine?a.angleToLine:!0;d._offset=void 0!==a.offset?a.offset*b:0;d._beginGap=void 0!==a.beginPosition?a.beginPosition*b:0;d._endGap=void 0!==a.endPosition?a.endPosition*b:0;d._flipFirst=void 0!==a.flipFirst?a.flipFirst:!0;d._pattern=new E.DashPattern;d._pattern.init(a.positionArray,!1,!1);d._subPathLen=0;d._posCount=
d._pattern.size();d._isFirst=!0;d._prevPos=0;return d}t._inheritsLoose(l,n);l.prototype.processPath=function(d){if(this._pattern.isEmpty())return null;if(this.iteratePath){d=this._pattern.nextValue()*this._subPathLen;var a=this._beginGap+d;d=a-this._prevPos;this._prevPos=a}else{this._posCount=this._pattern.size();this._isFirst=!0;this._prevPos=0;this._subPathLen=this._walker.calculatePathLength(d)-this._beginGap-this._endGap;if(0>this._subPathLen)return this.iteratePath=!1,null;if(!this._walker.init(d,
this._pattern,!1))return null;this._pattern.reset();d=this._pattern.nextValue()*this._subPathLen;a=this._beginGap+d;d=a-this._prevPos;this._prevPos=a;this.iteratePath=!0}a={};if(!this._walker.nextPointAndAngle(d,a,E.EndType.END))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(a.pt[0]-this._offset*a.sa,a.pt[1]+this._offset*a.ca);d=this._isFirst&&this._flipFirst;let b;this._angleToLine?(b=a.ca,a=a.sa):(b=1,a=0);d&&(b=-b,a=-a);this.internalPlacement.setRotateCS(b,a);this._isFirst=
!1;this._posCount--;0===this._posCount&&(this.iteratePath=!1);return this.internalPlacement};return l}(D.PathTransformationCursor);q.PlacementAtRatioPositions=C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementInsidePolygon":function(){define(["exports","../../../core/RandomLCG","../CIMPlacements","../enums"],function(q,t,D,E){let C=function(){function n(){}n.local=function(){null===n.instance&&(n.instance=new n);return n.instance};
n.prototype.execute=function(l,d,a,b){return new A(l,d,a,b)};return n}();C.instance=null;let A=function(){function n(d,a,b,c){var f,h,p;this._currentY=this._currentX=this._yMax=this._yMin=this._xMax=this._xMin=0;this._stepX=Math.abs(null!=(f=a.stepX)?f:16)*b;this._stepY=Math.abs(null!=(h=a.stepY)?h:16)*b;if(0!==this._stepX&&0!==this._stepY&&d&&void 0!==d.rings&&d.rings){this._gridType=null!=(p=a.gridType)?p:E.PlacementGridType.Fixed;if(this._gridType===E.PlacementGridType.Random){var k,e;b=null!=
(k=a.seed)?k:13;this._randomLCG=new t(1*b);this._randomness=(null!=(e=a.randomness)?e:100)/100;this._gridAngle=0;this._shiftOddRows=!1;this._cosAngle=1;this._offsetY=this._offsetX=this._sinAngle=0}else{var m,r,v,x;this._randomness=0;this._gridAngle=null!=(m=a.gridAngle)?m:0;this._shiftOddRows=null!=(r=a.shiftOddRows)?r:!1;this._offsetX=(null!=(v=a.offsetX)?v:0)*b;this._offsetY=(null!=(x=a.offsetY)?x:0)*b;this._cosAngle=Math.cos(this._gridAngle/180*Math.PI);this._sinAngle=-Math.sin(this._gridAngle/
180*Math.PI);if(this._stepX)if(0>this._offsetX)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(0>this._offsetY)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}this._graphicOriginY=this._graphicOriginX=0;this._internalPlacement=new D.Placement;this._calculateMinMax(d);this._geometry=d}}var l=n.prototype;l.next=function(){return this._geometry?
this._nextInside():null};l._calculateMinMax=function(d){this._yMax=this._yMin=this._xMax=this._xMin=0;let a,b,c,f,h;b=c=Number.MAX_VALUE;f=h=-Number.MAX_VALUE;for(const k of d.rings){const e=k?k.length:0;for(let m=0;m<e;++m){var p=k[m][0]-this._graphicOriginX-this._offsetX;a=k[m][1]-this._graphicOriginY-this._offsetY;d=this._cosAngle*p-this._sinAngle*a;p=this._sinAngle*p+this._cosAngle*a;b=Math.min(b,d);f=Math.max(f,d);c=Math.min(c,p);h=Math.max(h,p)}}b+=this._graphicOriginX;f+=this._graphicOriginX;
c+=this._graphicOriginY;h+=this._graphicOriginY;this._xMin=Math.round(b/this._stepX);this._xMax=Math.round(f/this._stepX);this._yMin=Math.round(c/this._stepY);this._yMax=Math.round(h/this._stepY);this._currentX=this._xMax+1;this._currentY=this._yMin-1};l._nextInside=function(){for(;;){if(this._currentX>this._xMax){this._currentY++;if(this._currentY>this._yMax)return null;this._currentX=this._xMin;this._shiftOddRows&&this._currentY%2&&this._currentX--}var d=this._currentX*this._stepX+this._offsetX;
this._shiftOddRows&&this._currentY%2&&(d+=.5*this._stepX);const a=this._currentY*this._stepY+this._offsetY;this._currentX++;let b;this._gridType===E.PlacementGridType.Random?(b=this._graphicOriginX+d+this._stepX*this._randomness*(.5-this._randomLCG.getFloat())*2/3,d=this._graphicOriginY+a+this._stepY*this._randomness*(.5-this._randomLCG.getFloat())*2/3):(b=this._graphicOriginX+this._cosAngle*d+this._sinAngle*a,d=this._graphicOriginY-this._sinAngle*d+this._cosAngle*a);this._internalPlacement.setTranslate(b,
d);return this._internalPlacement}};return n}();q.PlacementInsidePolygon=C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementOnLine":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../enums"],function(q,t,D,E,C){let A=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(d,a,b,c){return new n(d,
a,b)};return l}();A.instance=null;let n=function(l){function d(b,c,f){b=l.call(this,b,!0,!0)||this;b._curveHelper=new E.CurveHelper;b._angleToLine=void 0!==c.angleToLine?c.angleToLine:!0;b._offset=void 0!==c.offset?c.offset*f:0;b._relativeTo=c.relativeTo;b._position=void 0!==c.startPointOffset?c.startPointOffset*f:0;b._epsilon=.001*f;return b}t._inheritsLoose(d,l);var a=d.prototype;a.processPath=function(b){var c=this._position;if(this._relativeTo===C.PlacementOnLineRelativeTo.SegmentMidpoint){this.iteratePath||
(this._segmentCount=b.length,this._curSegment=1,this.iteratePath=!0);for(;this._curSegment<this._segmentCount;){var f=this._curSegment;this._curSegment++;c=b[f-1];f=b[f];const h=this._curveHelper.calculateLength(c,f);if(h<this._epsilon)continue;b=.5+this._position/h;const [p,k]=this._curveHelper.getAngleCS(c,f,b);b=D.getCoord2D(c,f,b);this.internalPlacement.setTranslate(b[0]-this._offset*k,b[1]+this._offset*p);this._angleToLine&&this.internalPlacement.setRotateCS(p,k);return this.internalPlacement}this.iteratePath=
!1;return null}this._relativeTo===C.PlacementOnLineRelativeTo.LineEnd&&D.reversePath(b);c=this.onLine(b,c);this._relativeTo===C.PlacementOnLineRelativeTo.LineEnd&&D.reversePath(b);return c};a.onLine=function(b,c){let f,h=!1;switch(this._relativeTo){default:f=this._curveHelper.calculatePathLength(b)/2+c;break;case C.PlacementOnLineRelativeTo.LineBeginning:f=c;break;case C.PlacementOnLineRelativeTo.LineEnd:f=c,h=!0}const p=b.length;let k=0,e=b[0];for(let m=1;m<p;++m){c=e;e=b[m];const r=this._curveHelper.calculateLength(c,
e);if(k+r>f){b=(f-k)/r;const [v,x]=this._curveHelper.getAngleCS(c,e,b);b=D.getCoord2D(c,e,b);c=h?-this._offset:this._offset;this.internalPlacement.setTranslate(b[0]-c*x,b[1]+c*v);this._angleToLine&&(h?this.internalPlacement.setRotateCS(-v,-x):this.internalPlacement.setRotateCS(v,x));return this.internalPlacement}k+=r}return null};return d}(D.PathTransformationCursor);q.PlacementOnLine=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementOnVertices":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(q,t,D,E){function C(l,d){const a=Math.PI;for(;Math.abs(d-l)>a+2E-15;)d=d-l>a?d-2*a:d+2*a;return(l+d)/2}let A=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(d,a,b,c){return new n(d,a,b)};return l}();A.instance=null;let n=function(l){function d(b,c,f){b=l.call(this,b,!0,!0)||this;b._curveHelper=new E.CurveHelper;b._angleToLine=void 0!==
c.angleToLine?c.angleToLine:!0;b._offset=void 0!==c.offset?c.offset*f:0;b._endPoints=void 0!==c.placeOnEndPoints?c.placeOnEndPoints:!0;b._controlPoints=void 0!==c.placeOnControlPoints?c.placeOnControlPoints:!0;b._regularVertices=void 0!==c.placeOnRegularVertices?c.placeOnRegularVertices:!0;b._tags=[];b._tagIterator=0;return b}t._inheritsLoose(d,l);var a=d.prototype;a.processPath=function(b){this.iteratePath||(this._preparePath(b),this.iteratePath=!0);if(this._tagIterator>=this._tags.length)return this._tagIterator=
this._tags.length=0,this.iteratePath=!1,null;b=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(b[2]);let c=b[0],f=b[1];if(0!==this._offset){const h=Math.cos(b[2]);c-=this._offset*Math.sin(b[2]);f+=this._offset*h}this.internalPlacement.setTranslate(c,f);this._tagIterator++;return this.internalPlacement};a._preparePath=function(b){this._tagIterator=this._tags.length=0;const c=D.isClosedPath(b),f=b.length-1;let h=0,p=0,k=0,e=0,m=0,r,v;for(;h<f;){h++;r=b[h-1];v=b[h];
const x=D.getId(r),g=D.getId(v);if(this._angleToLine||0!==this._offset)e=this._curveHelper.getAngle(r,v,0);1===h?c?(p=e,k=x):(this._endPoints||this._controlPoints&&1===x)&&this._tags.push([r[0],r[1],e]):1===x?this._controlPoints&&this._tags.push([r[0],r[1],C(m,e)]):this._regularVertices&&this._tags.push([r[0],r[1],C(m,e)]);if(this._angleToLine||0!==this._offset)m=this._curveHelper.getAngle(r,v,1);h===f&&(c?1===g||1===k?this._controlPoints&&this._tags.push([v[0],v[1],C(m,p)]):this._regularVertices&&
this._tags.push([v[0],v[1],C(m,p)]):(this._endPoints||this._controlPoints&&1===g)&&this._tags.push([v[0],v[1],m]))}this._tagIterator=0};return d}(D.PathTransformationCursor);q.PlacementOnVertices=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementPolygonCenter":function(){define(["exports","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../CIMPlacements","../enums"],function(q,t,D,
E,C){let A=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(d,a,b,c){return new n(d,a,b)};return l}();A.instance=null;let n=function(){function l(a,b,c){this._geometry=a;this._offsetX=void 0!==b.offsetX?b.offsetX*c:0;this._offsetY=void 0!==b.offsetY?b.offsetY*c:0;this._method=void 0!==b.method?b.method:C.PlacementPolygonCenterMethod.OnPolygon;this._internalPlacement=new E.Placement}var d=l.prototype;d.next=function(){const a=
this._geometry;this._geometry=null;return a&&void 0!==a.rings?this._polygonCenter(a):null};d._polygonCenter=function(a){switch(this._method){default:case C.PlacementPolygonCenterMethod.CenterOfMass:case C.PlacementPolygonCenterMethod.BoundingBoxCenter:{const b=t.create();D.getBoundsXY(b,a);this._internalPlacement.setTranslate((b[2]+b[0])/2+this._offsetX,(b[3]+b[1])/2+this._offsetY)}}return this._internalPlacement};return l}();q.PlacementPolygonCenter=A;Object.defineProperties(q,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/Rect":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(q){return function(){function t(D=0,E=0,C=0,A=0){this.x=D;this.y=E;this.width=C;this.height=A}t.prototype.union=function(D){this.x=Math.min(this.x,D.x);this.y=Math.min(this.y,D.y);this.width=Math.max(this.width,D.width);this.height=Math.max(this.height,D.height)};q._createClass(t,[{key:"isEmpty",get:function(){return 0>=this.width||0>=this.height}}]);return t}()})},
"esri/symbols/cim/TextRasterizer":function(){define(["../../core/screenUtils"],function(q){let t=function(){function E(){}var C=E.prototype;C.rasterizeText=function(A,n){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));var l=this._textRasterizationCanvas,d=l.getContext("2d");this._setFontProperties(d,n);this.parameters=n;this.textLines=A.split(/\r?\n/);this.lineHeight=this._computeLineHeight();A=this._computeTextWidth(d,n);const {decoration:a,weight:b}=
n.font;this.lineThroughWidthOffset=a&&"line-through"===a?.1*this.lineHeight:0;var c=this.lineHeight*this.textLines.length;l.width=A+2*this.lineThroughWidthOffset;l.height=c;this.renderedLineHeight=Math.round(this.lineHeight*n.pixelRatio);this.renderedHaloSize=n.halo.size*n.pixelRatio;this.renderedWidth=A*n.pixelRatio;this.renderedHeight=c*n.pixelRatio;this.lineThroughWidthOffset*=n.pixelRatio;l=n.color;this.fillStyle=`rgba(${l.slice(0,3).toString()},${l[3]})`;this.haloStyle=`rgb(${n.halo.color.slice(0,
3).toString()})`;l=this.renderedLineHeight;A=this.renderedHaloSize;this._setFontProperties(d,n);c=d.textAlign;var f=this.renderedWidth;c=("center"===c?.5*f:"right"===c?f:0)+A;f=this.lineThroughWidthOffset;let h=0;0<A&&this._renderHalo(d,c,A,f,h,n);h+=A;f+=c;for(var p of this.textLines)d.globalCompositeOperation="destination-out",d.fillStyle="rgb(0, 0, 0)",d.fillText(p,f,h),d.globalCompositeOperation="source-over",d.fillStyle=this.fillStyle,d.fillText(p,f,h),a&&"none"!==a&&this._renderDecoration(d,
f,h,a,b),h+=l;p=this.renderedWidth+2*this.lineThroughWidthOffset;l=this.renderedHeight;d=d.getImageData(0,0,p,l);d=new Uint8Array(d.data);if(n.premultiplyColors)for(A=0;A<d.length;A+=4)n=d[A+3]/255,d[A]*=n,d[A+1]*=n,d[A+2]*=n;return{size:[p,l],image:new Uint32Array(d.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};C._renderHalo=function(A,n,l,d,a,b){const c=this.renderedWidth,f=this.renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas"));
this._haloRasterizationCanvas.width=c;this._haloRasterizationCanvas.height=f;const h=this._haloRasterizationCanvas,p=h.getContext("2d");p.clearRect(0,0,c,f);this._setFontProperties(p,b);const {decoration:k,weight:e}=b.font;p.fillStyle=this.haloStyle;p.strokeStyle=this.haloStyle;b=3>this.renderedHaloSize;p.lineJoin=b?"miter":"round";b?this._renderHaloEmulated(p,n,l,k,e):this._renderHaloNative(p,n,l,k,e);A.globalAlpha=this.parameters.halo.color[3];A.drawImage(h,0,0,c,f,d,a,c,f);A.globalAlpha=1};C._renderHaloEmulated=
function(A,n,l,d,a){const b=this.renderedLineHeight,c=this.renderedHaloSize;for(const f of this.textLines){for(const [h,p]of D)A.fillText(f,n+c*h,l+c*p);d&&"none"!==d&&this._renderDecoration(A,n,l,d,a);l+=b}};C._renderHaloNative=function(A,n,l,d,a){const b=this.renderedLineHeight,c=this.renderedHaloSize;for(const f of this.textLines){const h=2*c;for(let p=0;5>p;p++)A.lineWidth=(.6+.1*p)*h,A.strokeText(f,n,l),d&&"none"!==d&&this._renderDecoration(A,n,l,d,a);l+=b}};C._setFontProperties=function(A,n){var l=
n.font;l=`${l.style} ${l.weight} ${q.pt2px(n.size*n.pixelRatio)}px ${l.family}, sans-serif`;A.font=l;A.textBaseline="top";switch(n.horizontalAlignment){case "left":n="left";break;case "right":n="right";break;case "center":n="center";break;default:n="left"}A.textAlign=n};C.computeTextSize=function(A,n){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const l=this._textRasterizationCanvas;var d=l.getContext("2d");this._setFontProperties(d,n);this.parameters=
n;this.textLines=A.split(/\r?\n/);this.lineHeight=this._computeLineHeight();A=this._computeTextWidth(d,n);d=this.lineHeight*this.textLines.length;l.width=A;l.height=d;return[A*n.pixelRatio,d*n.pixelRatio]};C._computeTextWidth=function(A,n){let l=0;for(const d of this.textLines)l=Math.max(l,A.measureText(d).width);n=n.font;if("italic"===n.style||"oblique"===n.style||"string"===typeof n.weight&&("bold"===n.weight||"bolder"===n.weight)||"number"===typeof n.weight&&600<n.weight)l+=.3*A.measureText("w").width;
l+=2*this.parameters.halo.size;return Math.round(l)};C._computeLineHeight=function(){let A=1.275*this.parameters.size;const n=this.parameters.font.decoration;n&&"underline"===n&&(A*=1.3);return Math.round(A+2*this.parameters.halo.size)};C._renderDecoration=function(A,n,l,d,a){const b=.9*this.lineHeight;a="bold"===a?.06:"bolder"===a?.09:.04;switch(A.textAlign){case "center":n-=this.renderedWidth/2;break;case "right":n-=this.renderedWidth}const c=A.textBaseline;if("underline"===d)switch(c){case "top":l+=
b;break;case "middle":l+=b/2}else if("line-through"===d)switch(c){case "top":l+=b/1.5;break;case "middle":l+=b/3}A.save();A.beginPath();A.strokeStyle=A.fillStyle;A.lineWidth=Math.ceil(b*a);A.moveTo(n-this.lineThroughWidthOffset,l);A.lineTo(n+this.renderedWidth+2*this.lineThroughWidthOffset,l);A.stroke();A.restore()};return E}();const D=[];for(let E=0;360>E;E+=22.5)D.push([Math.cos(Math.PI*E/180),Math.sin(Math.PI*E/180)]);return t})},"esri/views/2d/engine/webgl/mesh/templates/shapingUtils":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../alignmentUtils ../../number ../../Rect ../../collisions/BoundingBox".split(" "),
function(q,t,D,E,C,A,n,l,d,a){const b=Math.PI/180;let c=function(){function k(m,r,v,x){this._rotationT=E.create();this.minZoom=this._yBounds=this._xBounds=0;this.maxZoom=255;this._bounds=null;const g=v.rect,u=new Float32Array(8);m*=x;r*=x;const y=v.code?g.width*x:v.metrics.width,z=v.code?g.height*x:v.metrics.height;u[0]=m;u[1]=r;u[2]=m+y;u[3]=r;u[4]=m;u[5]=r+z;u[6]=m+y;u[7]=r+z;this._data=u;this._setTextureCoords(g);this._scale=x;this._mosaic=v;this.x=m;this.y=r;this.maxOffset=Math.max(m+y,r+z)}var e=
k.prototype;e.setTransform=function(m){this._T=m;this._offsets=null};e._setOffsets=function(m){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});const r=this._offsets,v=new Float32Array(8),x=D.multiply(E.create(),this._rotationT,this._T);E.transformMany(v,m,x);r.upperLeft=l.i1616to32(8*v[0],8*v[1]);r.upperRight=l.i1616to32(8*v[2],8*v[3]);r.lowerLeft=l.i1616to32(8*v[4],8*v[5]);r.lowerRight=l.i1616to32(8*v[6],8*v[7])};e._setTextureCoords=function({x:m,y:r,width:v,height:x}){this._texcoords=
{upperLeft:l.i1616to32(m,r),upperRight:l.i1616to32(m+v,r),lowerLeft:l.i1616to32(m,r+x),lowerRight:l.i1616to32(m+v,r+x)}};t._createClass(k,[{key:"width",get:function(){return this._mosaic.metrics.width*this._scale}},{key:"mosaic",get:function(){return this._mosaic}},{key:"angle",get:function(){return this._angle},set:function(m){this._angle=m;D.fromRotation(this._rotationT,-m);this._setOffsets(this._data)}},{key:"xTopLeft",get:function(){return this._data[0]}},{key:"yTopLeft",get:function(){return this._data[1]}},
{key:"xBottomRight",get:function(){return this._data[6]}},{key:"yBottomRight",get:function(){return this._data[7]}},{key:"texcoords",get:function(){return this._texcoords}},{key:"textureBinding",get:function(){return this._mosaic.textureBinding}},{key:"offsets",get:function(){this._offsets||this._setOffsets(this._data);return this._offsets}},{key:"char",get:function(){return String.fromCharCode(this._mosaic.code)}},{key:"code",get:function(){return this._mosaic.code}},{key:"bounds",get:function(){if(!this._bounds){const {height:g,
width:u}=this._mosaic.metrics;var m=u*this._scale,r=Math.abs(g)*this._scale,v=new Float32Array(8);v[0]=this.x;v[1]=this.y;v[2]=this.x+m;v[3]=this.y;v[4]=this.x;v[5]=this.y+r;v[6]=this.x+m;v[7]=this.y+r;m=D.multiply(E.create(),this._rotationT,this._T);E.transformMany(v,v,m);r=m=Infinity;let y=0;var x=0;for(let z=0;4>z;z++){const w=v[2*z],B=v[2*z+1];m=Math.min(m,w);r=Math.min(r,B);y=Math.max(y,w);x=Math.max(x,B)}v=y-m;x-=r;this._bounds=new a(m+v/2,r+x/2,v,x)}return this._bounds}}]);return k}();const f=
(k,e)=>({code:0,page:0,sdf:!0,rect:new d(0,0,11,8),textureBinding:e,metrics:{advance:0,height:4,width:k,left:0,top:0}});let h=function(){function k(m,r,v){this._rotation=0;this._decorate(m,r,v);this.glyphs=m;this.bounds=this._createBounds(m);this.isMultiline=1<r.length;this._hasRotation=0!==v.angle;this._T=this._createGlyphTransform(this.bounds,v);for(const x of m)x.setTransform(this._T)}var e=k.prototype;e.setRotation=function(m){if(0!==m||0!==this._rotation){this._rotation=m;var r=this._T;m=D.fromRotation(E.create(),
m);D.multiply(r,m,r);for(const v of this.glyphs)v.setTransform(this._T)}};e._decorate=function(m,r,v){if(v.decoration&&"none"!==v.decoration&&m.length){var x=v.scale;v="underline"===v.decoration?30:20;var g=m[0].textureBinding;for(const u of r)m.push(new c(u.startX*x,u.startY*x+v*x,f((u.width+u.glyphWidthEnd)*x,g),1))}};e._createBounds=function(m){let r=Infinity,v=Infinity,x=0;var g=0;for(const u of m)r=Math.min(r,u.xTopLeft),v=Math.min(v,u.yTopLeft),x=Math.max(x,u.xTopLeft+u.width),g=Math.max(g,
u.yBottomRight);m=x-r;g-=v;return new a(r+m/2,v+g/2,m,g)};e._createGlyphTransform=function(m,r){const v=b*r.angle,x=E.create(),g=A.create();D.translate(x,x,C.set(g,r.xOffset,-r.yOffset));r.isCIM?D.rotate(x,x,v):(D.translate(x,x,C.set(g,m.x,m.y)),D.rotate(x,x,v),D.translate(x,x,C.set(g,-m.x,-m.y)));return x};t._createClass(k,[{key:"boundsT",get:function(){var m=this.bounds;const r=C.set(A.create(),m.x,m.y);C.transformMat2d(r,r,this._T);return this._hasRotation?(m=Math.max(m.width,m.height),new a(r[0],
r[1],m,m)):new a(r[0],r[1],m.width,m.height)}}]);return k}(),p=function(k,e,m,r,v,x){this.startY=this.startX=this.glyphWidthEnd=0;this.start=Math.max(0,Math.min(e,m));this.end=Math.max(0,Math.max(e,m));this.end<k.length&&(this.glyphWidthEnd=k[this.end].metrics.width);this.width=r;this.yMin=v;this.yMax=x};q.ShapedGlyph=c;q.ShapingInfo=h;q.shapeGlyphs=function(k,e,m){const r=m.scale,v=[];{var x=[];var g=1/m.scale*m.maxLineWidth;var u=e?k.length-1:0;var y=e?-1:k.length;e=e?-1:1;var z=u,w=0,B=0;let I=
z,L=I,N=0,J=Infinity,K=0;for(;z!==y;){const {code:O,metrics:W}=k[z];var F=Math.abs(W.top);10!==O&&32!==O&&(J=Math.min(J,F),K=Math.max(K,F+W.height));10===O?(z!==u&&(x.push(new p(k,I,z-e,w,J,K)),J=Infinity,K=0),w=0,I=z+e,L=z+e,B=0):32===O?(L=z+e,B=0,N=W.advance,w+=W.advance):(w>g&&(L!==I?(F=L-2*e,w-=N,x.push(new p(k,I,F,w-B,J,K)),J=Infinity,K=0,I=L,w=B):(x.push(new p(k,I,z-e,w,J,K)),J=Infinity,K=0,L=I=z,w=0)),w+=W.advance,B+=W.advance);z+=e}g=new p(k,I,z-e,w,J,K);0<=g.start&&g.end<k.length&&x.push(g)}for(g=
0;g<x.length;g++);g=u=x[0].yMin;u=x[x.length-1].yMax+m.lineHeight*(x.length-1)+("underline"===m.decoration?4:0)-u;const {vAlign:G,hAlign:H}=m;y=G===n.VAlign.Baseline?1:0;g=(1-y)*-g+u/2*(y?0:G-1)+-26*(y?1:0);for(u=0;u<x.length;u++){const {start:I,end:L,width:N}=x[u];y=N/2*(H+1)*-1-3;e=u*m.lineHeight+g-3;x[u].startX=y;x[u].startY=e;for(z=I;z<=L;z++)w=k[z],10!==w.code&&(B=new c(y+w.metrics.left,e-w.metrics.top,w,r),y+=w.metrics.advance,v.push(B))}return new h(v,x,m)};Object.defineProperties(q,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/Rect":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],function(q){return function(){function t(D=0,E=0,C=0,A=0){this.x=D;this.y=E;this.width=C;this.height=A}t.prototype.union=function(D){this.x=Math.min(this.x,D.x);this.y=Math.min(this.y,D.y);this.width=Math.max(this.width,D.width);this.height=Math.max(this.height,D.height)};q._createClass(t,[{key:"isEmpty",get:function(){return 0>=this.width||0>=this.height}}]);
return t}()})},"esri/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/vec2f32"],function(q,t){return function(){function D(C,A,n,l){this.center=t.fromValues(C,A);this.centerT=t.create();this.halfWidth=n/2;this.halfHeight=l/2;this.width=n;this.height=l}var E=D.prototype;E.clone=function(){return new D(this.x,this.y,this.width,this.height)};E.serialize=function(C){C.writeF32(this.center[0]);C.writeF32(this.center[1]);
C.push(this.width);C.push(this.height);return C};E.findCollisionDelta=function(C,A=4){return Math.log2(Math.min((C.halfWidth+this.halfWidth+A)/Math.abs(C.centerT[0]-this.centerT[0]),(C.halfHeight+this.halfHeight+A)/Math.abs(C.centerT[1]-this.centerT[1])))};E.extend=function(C){const A=Math.min(this.xmin,C.xmin),n=Math.min(this.ymin,C.ymin),l=Math.max(this.xmax,C.xmax)-A;C=Math.max(this.ymax,C.ymax)-n;this.width=l;this.height=C;this.halfWidth=l/2;this.halfHeight=C/2;this.x=A+l/2;this.y=n+C/2};D.deserialize=
function(C){const A=C.readF32(),n=C.readF32(),l=C.readInt32();C=C.readInt32();return new D(A,n,l,C)};q._createClass(D,[{key:"x",get:function(){return this.center[0]},set:function(C){this.center[0]=C}},{key:"y",get:function(){return this.center[1]},set:function(C){this.center[1]=C}},{key:"blX",get:function(){return this.center[0]+this.halfWidth}},{key:"blY",get:function(){return this.center[1]+this.halfHeight}},{key:"trX",get:function(){return this.center[0]-this.halfWidth}},{key:"trY",get:function(){return this.center[1]-
this.halfHeight}},{key:"xmin",get:function(){return this.x-this.halfWidth}},{key:"xmax",get:function(){return this.x+this.halfWidth}},{key:"ymin",get:function(){return this.y-this.halfHeight}},{key:"ymax",get:function(){return this.y+this.halfHeight}}]);return D}()})},"esri/views/2d/engine/vectorTiles/GeometryUtils":function(){define(["exports"],function(q){function t(l,d){l%=d;return 0<=l?l:l+d}const D=Number.POSITIVE_INFINITY,E=Math.PI,C=128/E,A=256/360,n=1/Math.LN2;q.C_256_TO_RAD=E/128;q.C_2PI=
2*E;q.C_DEG_TO_256=A;q.C_DEG_TO_RAD=E/180;q.C_INFINITY=D;q.C_PI=E;q.C_PI_BY_2=E/2;q.C_RAD_TO_256=C;q.C_SQRT2=1.414213562;q.C_SQRT2_INV=1/1.414213562;q.between=function(l,d,a){return l>=d&&l<=a||l>=a&&l<=d};q.degToByte=function(l){return t(l*A,256)};q.interpolate=function(l,d,a){return l*(1-a)+d*a};q.log2=function(l){return Math.log(l)*n};q.positiveMod=t;q.radToByte=function(l){return t(l*C,256)};q.sqr=function(l){return l*l};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/symbols/cim/SDFHelper":function(){define(["exports","../../core/floatRGBA","../../geometry/support/jsonUtils","./Rect"],function(q,t,D,E){function C(n){if(!n)return null;switch(n.type){case "CIMPointSymbol":var l=n.symbolLayers;if(!l||1!==l.length)break;return C(l[0]);case "CIMVectorMarker":n=n.markerGraphics;if(!n||1!==n.length)break;var d=n[0];if(!d)break;n=d.geometry;if(!n)break;d=d.symbol;if(!d||"CIMPolygonSymbol"!==d.type&&"CIMLineSymbol"!==d.type||null!=(l=d.symbolLayers)&&l.some(a=>!!a.effects))break;
return{geom:n,asFill:"CIMPolygonSymbol"===d.type};case "sdf":return{geom:n.geom,asFill:n.asFill}}return null}function A(n){let l=Infinity,d=-Infinity,a=Infinity,b=-Infinity;for(const c of n)for(const f of c)f[0]<l&&(l=f[0]),f[0]>d&&(d=f[0]),f[1]<a&&(a=f[1]),f[1]>b&&(b=f[1]);return[l,a,d,b]}q.buildSDF=function(n){var l=n.geom;var d=l?l.rings?l.rings:l.paths?l.paths:void 0!==l.xmin&&void 0!==l.ymin&&void 0!==l.xmax&&void 0!==l.ymax?[[[l.xmin,l.ymin],[l.xmin,l.ymax],[l.xmax,l.ymax],[l.xmax,l.ymin],[l.xmin,
l.ymin]]]:null:null;l=Infinity;var a=-Infinity;var b=Infinity,c=-Infinity;for(var f of d)for(var h of f)h[0]<l&&(l=h[0]),h[0]>a&&(a=h[0]),h[1]<b&&(b=h[1]),h[1]>c&&(c=h[1]);a=new E(l,b,a-l,c-b);b=64/Math.max(a.width,a.height);f=Math.round(a.width*b)+62;h=Math.round(a.height*b)+62;l=[];for(var p of d)if(p&&1<p.length){d=[];for(var k of p){let [w,B]=k;w-=a.x;B-=a.y;w*=b;B*=b;w+=30.5;B+=30.5;n.asFill?d.push([w,B]):d.push([Math.round(w),Math.round(B)])}n.asFill&&(c=d.length-1,d[0][0]===d[c][0]&&d[0][1]===
d[c][1]||d.push(d[0]));l.push(d)}var e;p=f*h;k=Array(p);for(d=0;d<p;++d)k[d]=962;for(e of l)for(d=e.length,a=1;a<d;++a){b=e[a-1];c=e[a];var m=void 0,r=void 0;b[0]<c[0]?(m=b[0],r=c[0]):(m=c[0],r=b[0]);var v=void 0,x=void 0;b[1]<c[1]?(v=b[1],x=c[1]):(v=c[1],x=b[1]);var g=Math.floor(m)-31;r=Math.floor(r)+31;v=Math.floor(v)-31;x=Math.floor(x)+31;0>g&&(g=0);r>f&&(r=f);0>v&&(v=0);x>h&&(x=h);m=c[0]-b[0];const w=c[1]-b[1],B=m*m+w*w;for(;g<r;g++)for(let F=v;F<x;F++){var u=(g-b[0])*m+(F-b[1])*w,y=void 0;0>
u?(y=b[0],u=b[1]):u>B?(y=c[0],u=c[1]):(u/=B,y=b[0]+u*m,u=b[1]+u*w);y=(g-y)*(g-y)+(F-u)*(F-u);u=(h-F-1)*f+g;y<k[u]&&(k[u]=y)}}for(e=0;e<p;++e)k[e]=Math.sqrt(k[e]);e=k;if(n.asFill)for(var z of l)for(n=z.length,l=1;l<n;++l)for(p=z[l-1],k=z[l],p[0]<k[0]?(d=p[0],a=k[0]):(d=k[0],a=p[0]),p[1]<k[1]?(c=p[1],b=k[1]):(c=k[1],b=p[1]),d=Math.floor(d),a=Math.floor(a)+1,c=Math.floor(c),b=Math.floor(b)+1,31>d&&(d=31),a>f-31&&(a=f-31),31>c&&(c=31),b>h-31&&(b=h-31);c<b;++c)if(p[1]>c!==k[1]>c){r=(h-c-1)*f;for(v=d;v<
a;++v)v<(k[0]-p[0])*(c-p[1])/(k[1]-p[1])+p[0]&&(e[r+v]=-e[r+v]);for(v=31;v<d;++v)e[r+v]=-e[r+v]}z=e.length;n=new Uint8Array(4*z);for(l=0;l<z;++l)t.packFloatRGBA(.5-e[l]/62,n,4*l);z=n;return[z,f,h]};q.getExtent=function(n){return n?n.rings?A(n.rings):n.paths?A(n.paths):D.isExtent(n)?[n.xmin,n.ymin,n.xmax,n.ymax]:null:null};q.getSDFInfo=C;q.getSDFMetrics=function(n,l,d,a,b){const [c,f,h,p]=n;if(h<c||p<f)return[0,0,0];var k=h-c,e=p-f;n=64/Math.max(k,e);k=Math.round(k*n);e=Math.round(e*n)+62;let m=1;
l&&(m=e/n/(l.ymax-l.ymin));let r=0,v=0;a&&(b?l&&d&&0<l.ymax-l.ymin&&(r=a.x/((l.xmax-l.xmin)/(l.ymax-l.ymin)*d),v=a.y/d):(r=a.x,v=a.y));r=.5*(l.xmax+l.xmin)+r*(l.xmax-l.xmin);v=.5*(l.ymax+l.ymin)+v*(l.ymax-l.ymin);r=(r-c)*n+31;v=(v-f)*n+31;return[m,r/(k+62)-.5,-(v/e-.5)]};q.getSDFSymbol=function(n){n=n.markerGraphics;if(!n||1!==n.length)return null;n=n[0];if(!n)return null;n=n.symbol;return!n||"CIMPolygonSymbol"!==n.type&&"CIMLineSymbol"!==n.type?null:n};Object.defineProperties(q,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/fontUtils":function(){define(["exports"],function(q){function t(D){D=D.toLowerCase().split(" ").join("-");switch(D){case "serif":return"noto-serif";case "sans-serif":return"arial-unicode-ms";case "monospace":return"ubuntu-mono";case "fantasy":return"cabin-sketch";case "cursive":return"redressed";default:return D}}q.getFontDecorationTop=function(D){switch(D){case "underline":return-26;case "line-through":return-18}return NaN};q.getFontFamily=
t;q.getFullyQualifiedFontName=function(D){a:{if(D.weight)switch(D.weight.toLowerCase()){case "bold":case "bolder":var E="-bold";break a}E=""}a:{if(D.style)switch(D.style.toLowerCase()){case "italic":case "oblique":var C="-italic";break a}C=""}E+=C;return t(D.family)+(0<E.length?E:"-regular")};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/GlyphMosaic":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/promiseUtils ./Rect ./RectangleBinPack ../../../webgl/enums ../../../webgl/Texture".split(" "),
function(q,t,D,E,C,A,n){function l(a){const b=new Set;for(const c of a)b.add(Math.floor(c/256));return b}function d(a,b,c){a.has(b)||a.set(b,c().then(()=>{a.delete(b)}).catch(f=>{a.delete(b);D.throwIfNotAbortError(f)}));return a.get(b)}return function(){function a(c,f,h){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphCache={};this._textures=[];this._rangePromises=new Map;this.width=c;this.height=f;this._glyphSource=h;this._binPack=new C(c-4,f-4);this._glyphData.push(new Uint8Array(c*
f));this._dirties.push(!0);this._textures.push(null);this._initDecorationGlyph()}var b=a.prototype;b.dispose=function(){this._binPack=null;for(const c of this._textures)c&&c.dispose();this._textures.length=0;this._glyphData.length=0};b._initDecorationGlyph=function(){var c=[117,149,181,207,207,181,149,117];const f=[];for(let h=0;h<c.length;h++){const p=c[h];for(let k=0;11>k;k++)f.push(p)}c={metrics:{width:5,height:2,left:0,top:0,advance:0},bitmap:new Uint8Array(f)};this._recordGlyph(c)};b.getGlyphItems=
function(){var c=q._asyncToGenerator(function*(f,h,p){const k=this._getGlyphCache(f);yield this._fetchRanges(f,h,p);return h.map(e=>this._getMosaicItem(k,f,e))});return function(f,h,p){return c.apply(this,arguments)}}();b.bind=function(c,f,h,p){const k=this._getTexture(c,h);k.setSamplingMode(f);this._dirties[h]&&(k.setData(this._glyphData[h]),this._dirties[h]=!1);c.bindTexture(k,p)};b._getGlyphCache=function(c){this._glyphCache[c]||(this._glyphCache[c]={});return this._glyphCache[c]};b._getTexture=
function(c,f){this._textures[f]||(this._textures[f]=new n.Texture(c,{pixelFormat:A.PixelFormat.ALPHA,dataType:A.PixelType.UNSIGNED_BYTE,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));return this._textures[f]};b._invalidate=function(){this._dirties[this._currentPage]=!0};b._fetchRanges=function(){var c=q._asyncToGenerator(function*(f,h,p){const k=[];l(h).forEach(e=>{k.push(this._fetchRange(f,e,p))});yield Promise.all(k)});return function(f,h,p){return c.apply(this,arguments)}}();
b._fetchRange=function(){var c=q._asyncToGenerator(function*(f,h,p){return 256<h?null:d(this._rangePromises,f+h,()=>this._glyphSource.getRange(f,h,p))});return function(f,h,p){return c.apply(this,arguments)}}();b._getMosaicItem=function(c,f,h){if(!c[h]){f=this._glyphSource.getGlyph(f,h);if(!f||!f.metrics)return{rect:new E(0,0,0,0),page:0,metrics:{left:0,width:0,height:0,advance:0,top:0},code:h,sdf:!0};const p=this._recordGlyph(f);c[h]={rect:p,page:this._currentPage,metrics:f.metrics,code:h,sdf:!0};
this._invalidate()}return c[h]};b._recordGlyph=function(c){var f=c.metrics;if(0===f.width)f=new E(0,0,0,0);else{const h=f.width+6,p=f.height+6;f=this._binPack.allocate(h,p);f.isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(null),this._initDecorationGlyph(),this._binPack=new C(this.width-4,this.height-4),f=this._binPack.allocate(h,
p));const k=this._glyphData[this._currentPage];c=c.bitmap;let e,m;if(c)for(let r=0;r<p;r++){e=h*r;m=this.width*(f.y+r)+f.x;for(let v=0;v<h;v++)k[m+v]=c[e+v]}t("esri-glyph-debug")&&this._showDebugPage(k)}return f};b._showDebugPage=function(c){const f=document.createElement("canvas"),h=f.getContext("2d"),p=new ImageData(this.width,this.height),k=p.data;f.width=this.width;f.height=this.height;f.style.border="1px solid black";for(let e=0;e<c.length;++e)k[4*e]=c[e],k[4*e+1]=0,k[4*e+2]=0,k[4*e+3]=255;h.putImageData(p,
0,0);document.body.appendChild(f)};return a}()})},"esri/views/2d/engine/webgl/RectangleBinPack":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","./Rect"],function(q,t){return function(){function D(C,A){this._height=this._width=0;this._free=[];this._width=C;this._height=A;this._free.push(new t(0,0,C,A))}var E=D.prototype;E.allocate=function(C,A){if(C>this._width||A>this._height)return new t;let n=null,l=-1;for(let d=0;d<this._free.length;++d){const a=this._free[d];C<=a.width&&A<=
a.height&&(null===n||a.y<=n.y&&a.x<=n.x)&&(n=a,l=d)}if(null===n)return new t;this._free.splice(l,1);n.width<n.height?(n.width>C&&this._free.push(new t(n.x+C,n.y,n.width-C,A)),n.height>A&&this._free.push(new t(n.x,n.y+A,n.width,n.height-A))):(n.width>C&&this._free.push(new t(n.x+C,n.y,n.width-C,n.height)),n.height>A&&this._free.push(new t(n.x,n.y+A,C,n.height-A)));return new t(n.x,n.y,C,A)};E.release=function(C){for(let A=0;A<this._free.length;++A){const n=this._free[A];if(n.y===C.y&&n.height===C.height&&
n.x+n.width===C.x)n.width+=C.width;else if(n.x===C.x&&n.width===C.width&&n.y+n.height===C.y)n.height+=C.height;else if(C.y===n.y&&C.height===n.height&&C.x+C.width===n.x)n.x=C.x,n.width+=C.width;else if(C.x===n.x&&C.width===n.width&&C.y+C.height===n.y)n.y=C.y,n.height+=C.height;else continue;this._free.splice(A,1);this.release(C)}this._free.push(C)};q._createClass(D,[{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}]);return D}()})},"esri/views/2d/engine/webgl/GlyphSource":function(){define(["../../../../request",
"../../../../core/pbf"],function(q,t){let D=function(){function C(n){this._metrics=[];for(this._bitmaps=[];n.next();)switch(n.tag()){case 1:{const l=n.getMessage();for(;l.next();)switch(l.tag()){case 3:{const d=l.getMessage();let a,b,c,f,h,p,k;for(;d.next();)switch(d.tag()){case 1:a=d.getUInt32();break;case 2:b=d.getBytes();break;case 3:c=d.getUInt32();break;case 4:f=d.getUInt32();break;case 5:h=d.getSInt32();break;case 6:p=d.getSInt32();break;case 7:k=d.getUInt32();break;default:d.skip()}d.release();
a&&(this._metrics[a]={width:c,height:f,left:h,top:p,advance:k},this._bitmaps[a]=b);break}default:l.skip()}l.release();break}default:n.skip()}}var A=C.prototype;A.getMetrics=function(n){return this._metrics[n]};A.getBitmap=function(n){return this._bitmaps[n]};return C}(),E=function(){function C(){this._ranges=[]}var A=C.prototype;A.getRange=function(n){return this._ranges[n]};A.addRange=function(n,l){this._ranges[n]=l};return C}();return function(){function C(n){this._glyphInfo={};this._baseURL=n}
var A=C.prototype;A.getRange=function(n,l,d){const a=this._getFontStack(n);if(a.getRange(l))return Promise.resolve();const b=256*l,c=b+255;n=this._baseURL.replace("{fontstack}",n).replace("{range}",b+"-"+c);return q(n,{responseType:"array-buffer",...d}).then(f=>{a.addRange(l,new D(new t(new Uint8Array(f.data),new DataView(f.data))))})};A.getGlyph=function(n,l){if(n=this._getFontStack(n)){var d=Math.floor(l/256);if(!(256<d)&&(n=n.getRange(d)))return{metrics:n.getMetrics(l),bitmap:n.getBitmap(l)}}};
A._getFontStack=function(n){let l=this._glyphInfo[n];l||(l=this._glyphInfo[n]=new E);return l};return C}()})},"esri/views/2d/engine/webgl/SDFConverter":function(){define(["../../../../core/floatRGBA","../../../../core/promiseUtils"],function(q,t){return function(){function D(C){this.size=C;const A=document.createElement("canvas");A.width=A.height=C;this._context=A.getContext("2d");this._gridOuter=new Float64Array(C*C);this._gridInner=new Float64Array(C*C);this._f=new Float64Array(C);this._d=new Float64Array(C);
this._z=new Float64Array(C+1);this._v=new Int16Array(C)}var E=D.prototype;E.dispose=function(){this._context=this._gridOuter=this._gridInner=this._f=this._d=this._z=this._v=null;this._svg&&(document.body.removeChild(this._svg),this._svg=null)};E.draw=function(C,A,n=31){this._initSVG();const l=this.createSVGString(C);return new Promise((d,a)=>{const b=new Image;b.src="data:image/svg+xml; charset\x3dutf8, "+encodeURIComponent(l);b.onload=()=>{b.onload=null;this._context.clearRect(0,0,this.size,this.size);
this._context.drawImage(b,0,0,this.size,this.size);var f=this._context.getImageData(0,0,this.size,this.size);const h=new Uint8Array(this.size*this.size*4);for(let p=0;p<this.size*this.size;p++){const k=f.data[4*p+3]/255;this._gridOuter[p]=1===k?0:0===k?1E20:Math.max(0,.5-k)**2;this._gridInner[p]=1===k?1E20:0===k?0:Math.max(0,k-.5)**2}this._edt(this._gridOuter,this.size,this.size);this._edt(this._gridInner,this.size,this.size);for(f=0;f<this.size*this.size;f++)q.packFloatRGBA(.5-(this._gridOuter[f]-
this._gridInner[f])/(2*n),h,4*f);d(h)};const c=A&&A.signal;if(c)t.onAbort(c,()=>a(t.createAbortError()))})};E._initSVG=function(){if(!this._svg){const C=document.createElementNS("http://www.w3.org/2000/svg","svg");C.setAttribute("style","position: absolute;");C.setAttribute("width","0");C.setAttribute("height","0");C.setAttribute("aria-hidden","true");C.setAttribute("role","presentation");document.body.appendChild(C);this._svg=C}};E.createSVGString=function(C){this._initSVG();const A=document.createElementNS("http://www.w3.org/2000/svg",
"path");A.setAttribute("d",C);this._svg.appendChild(A);C=A.getBBox();var n=C.width/C.height;const l=this.size/2;let d,a,b;1<n?(a=d=l/C.width,b=this.size/4,n=l-1/n*l/2):(d=a=l/C.height,b=l-l*n/2,n=this.size/4);A.setAttribute("style",`transform: matrix(${d}, 0, 0, ${a}, ${-C.x*d+b}, ${-C.y*a+n})`);C=`<svg style="fill:red;" height="${this.size}" width="${this.size}" xmlns="http://www.w3.org/2000/svg">${this._svg.innerHTML}</svg>`;this._svg.removeChild(A);return C};E._edt=function(C,A,n){const l=this._f,
d=this._d,a=this._v,b=this._z;for(var c=0;c<A;c++){for(var f=0;f<n;f++)l[f]=C[f*A+c];this._edt1d(l,d,a,b,n);for(f=0;f<n;f++)C[f*A+c]=d[f]}for(c=0;c<n;c++){for(f=0;f<A;f++)l[f]=C[c*A+f];this._edt1d(l,d,a,b,A);for(f=0;f<A;f++)C[c*A+f]=Math.sqrt(d[f])}};E._edt1d=function(C,A,n,l,d){n[0]=0;l[0]=-1E20;l[1]=1E20;for(let a=1,b=0;a<d;a++){let c=(C[a]+a*a-(C[n[b]]+n[b]*n[b]))/(2*a-2*n[b]);for(;c<=l[b];)b--,c=(C[a]+a*a-(C[n[b]]+n[b]*n[b]))/(2*a-2*n[b]);b++;n[b]=a;l[b]=c;l[b+1]=1E20}for(let a=0,b=0;a<d;a++){for(;l[b+
1]<a;)b++;A[a]=(a-n[b])*(a-n[b])+C[n[b]]}};return D}()})},"esri/views/2d/engine/webgl/SpriteMosaic":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ./definitions ./GeometryUtils ./Rect ./RectangleBinPack ../../../webgl/enums ../../../webgl/Texture".split(" "),function(q,t,D,E,C,A,n,l){function d(a){return a&&"static"===a.type}return function(){function a(c,f,h=0){this._mosaicPages=[];this._pageHeight=this._pageWidth=this._currentPage=this._maxItemSize=0;this._mosaicRects=
new Map;this._spriteCopyQueue=[];this.pixelRatio=1;(0>=c||0>=f)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=c;this._pageHeight=f;0<h&&(this._maxItemSize=h);this.pixelRatio=window.devicePixelRatio||1;this._binPack=new A(this._pageWidth,this._pageHeight);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight))},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0})}
var b=a.prototype;b.getWidth=function(c){return c>=this._mosaicPages.length?-1:this._mosaicPages[c].size[0]};b.getHeight=function(c){return c>=this._mosaicPages.length?-1:this._mosaicPages[c].size[1]};b.getPageTexture=function(c){return c<this._mosaicPages.length?this._mosaicPages[c].texture:null};b.has=function(c){return this._mosaicRects.has(c)};b.getSpriteItem=function(c){return this._mosaicRects.get(c)};b.addSpriteItem=function(c,f,h,p,k,e){if(this._mosaicRects.has(c))return this._mosaicRects.get(c);
let m,r,v;d(h)?[m,r,v]=this._allocateImage(f[0],f[1]):(m=new C(0,0,f[0],f[1]),r=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:h,size:[f[0]+2*D.SPRITE_PADDING,f[1]+2*D.SPRITE_PADDING],dirty:!0,texture:void 0}));if(0>=m.width||0>=m.height)return null;e={rect:m,width:f[0],height:f[1],sdf:k,simplePattern:e,pixelRatio:1,page:r};this._mosaicRects.set(c,e);d(h)&&this._copy({rect:m,spriteSize:f,spriteData:h.data,page:r,pageSize:v,repeat:p,sdf:k});return e};b.hasItemsToProcess=function(){return 0!==
this._spriteCopyQueue.length};b.processNextItem=function(){const c=this._spriteCopyQueue.pop();c&&this._copy(c)};b.getSpriteItems=function(c){const f={};for(const h of c)f[h]=this.getSpriteItem(h);return f};b.getMosaicItemPosition=function(c){const f=(c=this.getSpriteItem(c))&&c.rect;if(!f)return null;f.width=c.width;f.height=c.height;const h=D.SPRITE_PADDING,p=this._mosaicPages[c.page];return{size:[c.width,c.height],tl:[(f.x+h)/p[0],(f.y+h)/p[1]],br:[(f.x+h+c.width)/p[0],(f.y+h+c.height)/p[1]],page:c.page}};
b.bind=function(c,f,h=0,p=0){h=this._mosaicPages[h];const k=h.mosaicsData;var e=h.texture;e||(e=h.size,e=d(k)?new l.Texture(c,{pixelFormat:n.PixelFormat.RGBA,dataType:n.PixelType.UNSIGNED_BYTE,width:e[0],height:e[1]},new Uint8Array(k.data.buffer)):new l.Texture(c,{pixelFormat:n.PixelFormat.RGBA,dataType:n.PixelType.UNSIGNED_BYTE,samplingMode:n.TextureSamplingMode.LINEAR,wrapMode:n.TextureWrapMode.CLAMP_TO_EDGE,width:e[0],height:e[1]},null),h.texture=e);e.setSamplingMode(f);d(k)?(c.bindTexture(e,p),
h.dirty&&(e.setData(new Uint8Array(k.data.buffer)),e.generateMipmap())):k.data.bindFrame(c,e,p);h.dirty=!1};a._copyBits=function(c,f,h,p,k,e,m,r,v,x,g){let u=p*f+h;m=r*e+m;if(g)for(m-=e,g=-1;g<=x;g++,u=((g+x)%x+p)*f+h,m+=e)for(r=-1;r<=v;r++)k[m+r]=c[u+(r+v)%v];else for(h=0;h<x;h++){for(p=0;p<v;p++)k[m+p]=c[u+p];u+=f;m+=e}};b._copy=function(c){if(!(c.page>=this._mosaicPages.length)){var f=this._mosaicPages[c.page],h=f.mosaicsData;if(!d(f.mosaicsData))throw new t("mapview-invalid-resource","unsuitable data type!");
var p=c.spriteData;(h=h.data)&&p||console.error("Source or target images are uninitialized!");a._copyBits(p,c.spriteSize[0],0,0,h,c.pageSize[0],c.rect.x+D.SPRITE_PADDING,c.rect.y+D.SPRITE_PADDING,c.spriteSize[0],c.spriteSize[1],c.repeat);f.dirty=!0}};b._allocateImage=function(c,f){c+=2*D.SPRITE_PADDING;f+=2*D.SPRITE_PADDING;var h=Math.max(c,f);if(this._maxItemSize&&this._maxItemSize<h){h=2**Math.ceil(E.log2(c));const p=2**Math.ceil(E.log2(f));c=new C(0,0,c,f);this._mosaicPages.push({mosaicsData:{type:"static",
data:new Uint32Array(h*p)},size:[h,p],dirty:!0,texture:void 0});return[c,this._mosaicPages.length-1,[h,p]]}h=this._binPack.allocate(c,f);return 0>=h.width?(h=this._mosaicPages[this._currentPage],!h.dirty&&d(h.mosaicsData)&&(h.mosaicsData.data=null),this._currentPage=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(this._pageWidth*this._pageHeight)},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0}),this._binPack=new A(this._pageWidth,
this._pageHeight),this._allocateImage(c,f)):[h,this._currentPage,[this._pageWidth,this._pageHeight]]};b.dispose=function(){this._binPack=null;for(const f of this._mosaicPages){var c=f.texture;c&&c.dispose();c=f.mosaicsData;d(c)||c.data.destroy()}this._mosaicPages=null;this._mosaicRects.clear()};q._createClass(a,[{key:"itemCount",get:function(){return this._mosaicRects.size}}]);return a}()})},"esri/views/2d/engine/webgl/animatedFormats/apng":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/_commonjsHelpers ../../../../../core/Error ../../../../../core/promiseUtils ../../../../../core/time ./BaseAnimatableTextureResource".split(" "),
function(q,t,D,E,C,A,n){function l(h,p,k){return d.apply(this,arguments)}function d(){d=t._asyncToGenerator(function*(h,p,k){h=c(h);if(h instanceof Error)throw h;yield h.createImages();C.throwIfAborted(k);const {frames:e,width:m,height:r}=h;k=document.createElement("canvas");k.width=m;k.height=r;k=k.getContext("2d");const v=[];h=[];for(const g of e){h.push(A.Milliseconds(g.delay));var x=g.imageElement;k.globalCompositeOperation=0===g.blendOp?"copy":"source-over";const u=2===g.disposeOp&&k.getImageData(g.left,
g.top,g.width,g.height);k.drawImage(x,g.left,g.top);x=k.getImageData(0,0,m,r);v.push(x);0!==g.disposeOp&&(1===g.disposeOp?k.clearRect(g.left,g.top,g.width,g.height):2===g.disposeOp&&k.putImageData(u,g.left,g.top))}return{frameDurations:h,selectFrame:g=>{p(v[g])},width:m,height:r}});return d.apply(this,arguments)}function a(h){const p=new Uint8Array(h);return!f.some((k,e)=>k!==p[e])}var b={exports:{}};(function(h,p){(function(k,e){h.exports=e()})(D.commonjsGlobal,function(){return function(k){function e(r){if(m[r])return m[r].exports;
var v=m[r]={exports:{},id:r,loaded:!1};k[r].call(v.exports,v,v.exports,e);v.loaded=!0;return v.exports}var m={};e.m=k;e.c=m;e.p="";return e(0)}([function(k,e,m){function r(G,H){var I=new DataView(G.buffer),L=8,N=void 0,J=void 0,K=void 0;do J=I.getUint32(L),N=L+4,N=Array.prototype.slice.call(G.subarray(N,N+4)),N=String.fromCharCode.apply(String,N),K=H(N,G,L,J),L+=12+J;while(!1!==K&&"IEND"!=N&&L<G.length)}function v(G){for(var H=new Uint8Array(G.length),I=0;I<G.length;I++)H[I]=G.charCodeAt(I);return H}
function x(G,H,I){var L=new Uint8Array(I);L.set(G.subarray(H,H+I));return L}Object.defineProperty(e,"__esModule",{value:!0});e.isNotPNG=function(G){return G===y};e.isNotAPNG=function(G){return G===z};e.default=function(G){var H=new Uint8Array(G);if(Array.prototype.some.call(w,function(S,M){return S!==H[M]}))return y;var I=!1;r(H,function(S){return!(I="acTL"===S)});if(!I)return z;var L=[],N=[],J=null,K=null,O=0,W=new u.APNG;r(H,function(S,M,Q,Y){var V=new DataView(M.buffer);switch(S){case "IHDR":J=
M.subarray(Q+8,Q+8+Y);W.width=V.getUint32(Q+8);W.height=V.getUint32(Q+12);break;case "acTL":W.numPlays=V.getUint32(Q+8+4);break;case "fcTL":K&&(W.frames.push(K),O++);K=new u.Frame;K.width=V.getUint32(Q+8+4);K.height=V.getUint32(Q+8+8);K.left=V.getUint32(Q+8+12);K.top=V.getUint32(Q+8+16);S=V.getUint16(Q+8+20);M=V.getUint16(Q+8+22);0===M&&(M=100);K.delay=1E3*S/M;10>=K.delay&&(K.delay=100);W.playTime+=K.delay;K.disposeOp=V.getUint8(Q+8+24);K.blendOp=V.getUint8(Q+8+25);K.dataParts=[];0===O&&2===K.disposeOp&&
(K.disposeOp=1);break;case "fdAT":K&&K.dataParts.push(M.subarray(Q+8+4,Q+8+Y));break;case "IDAT":K&&K.dataParts.push(M.subarray(Q+8,Q+8+Y));break;case "IEND":N.push(x(M,Q,12+Y));break;default:L.push(x(M,Q,12+Y))}});K&&W.frames.push(K);if(0==W.frames.length)return z;var aa=new Blob(L),ba=new Blob(N);W.frames.forEach(function(S){var M=[];M.push(w);J.set(F(S.width),0);J.set(F(S.height),4);M.push(B("IHDR",J));M.push(aa);S.dataParts.forEach(function(Q){return M.push(B("IDAT",Q))});M.push(ba);S.imageData=
new Blob(M,{type:"image/png"});delete S.dataParts;M=null});return W};var g=(k=m(1))&&k.__esModule?k:{default:k},u=m(2),y=Error("Not a PNG"),z=Error("Not an animated PNG"),w=new Uint8Array([137,80,78,71,13,10,26,10]),B=function(G,H){var I=G.length+H.length,L=new Uint8Array(I+8),N=new DataView(L.buffer);N.setUint32(0,H.length);L.set(v(G),4);L.set(H,8);G=(0,g.default)(L,4,I);N.setUint32(I+4,G);return L},F=function(G){return new Uint8Array([G>>>24&255,G>>>16&255,G>>>8&255,G&255])}},function(k,e){Object.defineProperty(e,
"__esModule",{value:!0});e.default=function(v){var x=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,g=-1,u=x;for(x+=2<arguments.length&&void 0!==arguments[2]?arguments[2]:v.length-x;u<x;u++)g=g>>>8^m[(g^v[u])&255];return g^-1};var m=new Uint32Array(256);for(k=0;256>k;k++){e=k;for(var r=0;8>r;r++)e=0!==(e&1)?3988292384^e>>>1:e>>>1;m[k]=e}},function(k,e,m){function r(g,u){if(!(g instanceof u))throw new TypeError("Cannot call a class as a function");}Object.defineProperty(e,"__esModule",{value:!0});
e.Frame=e.APNG=void 0;var v=function(){function g(u,y){for(var z=0;z<y.length;z++){var w=y[z];w.enumerable=w.enumerable||!1;w.configurable=!0;"value"in w&&(w.writable=!0);Object.defineProperty(u,w.key,w)}}return function(u,y,z){y&&g(u.prototype,y);z&&g(u,z);return u}}(),x=(k=m(3))&&k.__esModule?k:{default:k};e.APNG=function(){function g(){r(this,g);this.playTime=this.numPlays=this.height=this.width=0;this.frames=[]}v(g,[{key:"createImages",value:function(){return Promise.all(this.frames.map(function(u){return u.createImage()}))}},
{key:"getPlayer",value:function(u){var y=this,z=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1;return this.createImages().then(function(){return new x.default(y,u,z)})}}]);return g}();e.Frame=function(){function g(){r(this,g);this.blendOp=this.disposeOp=this.delay=this.height=this.width=this.top=this.left=0;this.imageElement=this.imageData=null}v(g,[{key:"createImage",value:function(){var u=this;return this.imageElement?Promise.resolve():new Promise(function(y,z){var w=URL.createObjectURL(u.imageData);
u.imageElement=document.createElement("img");u.imageElement.onload=function(){URL.revokeObjectURL(w);y()};u.imageElement.onerror=function(){URL.revokeObjectURL(w);u.imageElement=null;z(Error("Image creation error"))};u.imageElement.src=w})}}]);return g}()},function(k,e,m){function r(x,g){if("function"!==typeof g&&null!==g)throw new TypeError("Super expression must either be null or a function, not "+typeof g);x.prototype=Object.create(g&&g.prototype,{constructor:{value:x,enumerable:!1,writable:!0,
configurable:!0}});g&&(Object.setPrototypeOf?Object.setPrototypeOf(x,g):x.__proto__=g)}Object.defineProperty(e,"__esModule",{value:!0});var v=function(){function x(g,u){for(var y=0;y<u.length;y++){var z=u[y];z.enumerable=z.enumerable||!1;z.configurable=!0;"value"in z&&(z.writable=!0);Object.defineProperty(g,z.key,z)}}return function(g,u,y){u&&x(g.prototype,u);y&&x(g,y);return g}}();k=m(4);k=function(x){function g(u,y,z){if(!(this instanceof g))throw new TypeError("Cannot call a class as a function");
var w=(g.__proto__||Object.getPrototypeOf(g)).call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");w=!w||"object"!==typeof w&&"function"!==typeof w?this:w;w.playbackRate=1;w._currentFrameNumber=0;w._ended=!1;w._paused=!0;w._numPlays=0;w._apng=u;w.context=y;w.stop();z&&w.play();return w}r(g,x);v(g,[{key:"renderNextFrame",value:function(){this._currentFrameNumber=(this._currentFrameNumber+1)%this._apng.frames.length;this._currentFrameNumber===this._apng.frames.length-
1&&(this._numPlays++,0!==this._apng.numPlays&&this._numPlays>=this._apng.numPlays&&(this._paused=this._ended=!0));this._prevFrame&&1==this._prevFrame.disposeOp?this.context.clearRect(this._prevFrame.left,this._prevFrame.top,this._prevFrame.width,this._prevFrame.height):this._prevFrame&&2==this._prevFrame.disposeOp&&this.context.putImageData(this._prevFrameData,this._prevFrame.left,this._prevFrame.top);var u=this.currentFrame;this._prevFrame=u;this._prevFrameData=null;2==u.disposeOp&&(this._prevFrameData=
this.context.getImageData(u.left,u.top,u.width,u.height));0==u.blendOp&&this.context.clearRect(u.left,u.top,u.width,u.height);this.context.drawImage(u.imageElement,u.left,u.top);this.emit("frame",this._currentFrameNumber);this._ended&&this.emit("end")}},{key:"play",value:function(){var u=this;this.emit("play");this._ended&&this.stop();this._paused=!1;var y=performance.now()+this.currentFrame.delay/this.playbackRate;requestAnimationFrame(function B(w){if(!u._ended&&!u._paused){if(w>=y){for(;w-y>=u._apng.playTime/
u.playbackRate;)y+=u._apng.playTime/u.playbackRate,u._numPlays++;do u.renderNextFrame(),y+=u.currentFrame.delay/u.playbackRate;while(!u._ended&&w>y)}requestAnimationFrame(B)}})}},{key:"pause",value:function(){this._paused||(this.emit("pause"),this._paused=!0)}},{key:"stop",value:function(){this.emit("stop");this._numPlays=0;this._ended=!1;this._paused=!0;this._currentFrameNumber=-1;this.context.clearRect(0,0,this._apng.width,this._apng.height);this.renderNextFrame()}},{key:"currentFrameNumber",get:function(){return this._currentFrameNumber}},
{key:"currentFrame",get:function(){return this._apng.frames[this._currentFrameNumber]}},{key:"paused",get:function(){return this._paused}},{key:"ended",get:function(){return this._ended}}]);return g}((k&&k.__esModule?k:{default:k}).default);e.default=k},function(k,e){function m(){this._events=this._events||{};this._maxListeners=this._maxListeners||void 0}function r(x){return"function"===typeof x}function v(x){return"object"===typeof x&&null!==x}k.exports=m;m.EventEmitter=m;m.prototype._events=void 0;
m.prototype._maxListeners=void 0;m.defaultMaxListeners=10;m.prototype.setMaxListeners=function(x){if("number"!==typeof x||0>x||isNaN(x))throw TypeError("n must be a positive number");this._maxListeners=x;return this};m.prototype.emit=function(x){var g;this._events||(this._events={});if("error"===x&&(!this._events.error||v(this._events.error)&&!this._events.error.length)){var u=arguments[1];if(u instanceof Error)throw u;var y=Error('Uncaught, unspecified "error" event. ('+u+")");y.context=u;throw y;
}y=this._events[x];if(void 0===y)return!1;if(r(y))switch(arguments.length){case 1:y.call(this);break;case 2:y.call(this,arguments[1]);break;case 3:y.call(this,arguments[1],arguments[2]);break;default:u=Array.prototype.slice.call(arguments,1),y.apply(this,u)}else if(v(y)){u=Array.prototype.slice.call(arguments,1);var z=y.slice();y=z.length;for(g=0;g<y;g++)z[g].apply(this,u)}return!0};m.prototype.addListener=function(x,g){if(!r(g))throw TypeError("listener must be a function");this._events||(this._events=
{});this._events.newListener&&this.emit("newListener",x,r(g.listener)?g.listener:g);this._events[x]?v(this._events[x])?this._events[x].push(g):this._events[x]=[this._events[x],g]:this._events[x]=g;v(this._events[x])&&!this._events[x].warned&&(g=void 0!==this._maxListeners?this._maxListeners:m.defaultMaxListeners)&&0<g&&this._events[x].length>g&&(this._events[x].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",
this._events[x].length),"function"===typeof console.trace&&console.trace());return this};m.prototype.on=m.prototype.addListener;m.prototype.once=function(x,g){function u(){this.removeListener(x,u);y||(y=!0,g.apply(this,arguments))}if(!r(g))throw TypeError("listener must be a function");var y=!1;u.listener=g;this.on(x,u);return this};m.prototype.removeListener=function(x,g){if(!r(g))throw TypeError("listener must be a function");if(!this._events||!this._events[x])return this;var u=this._events[x];
var y=u.length;var z=-1;if(u===g||r(u.listener)&&u.listener===g)delete this._events[x],this._events.removeListener&&this.emit("removeListener",x,g);else if(v(u)){for(;0<y--;)if(u[y]===g||u[y].listener&&u[y].listener===g){z=y;break}if(0>z)return this;1===u.length?(u.length=0,delete this._events[x]):u.splice(z,1);this._events.removeListener&&this.emit("removeListener",x,g)}return this};m.prototype.removeAllListeners=function(x){if(!this._events)return this;if(!this._events.removeListener)return 0===
arguments.length?this._events={}:this._events[x]&&delete this._events[x],this;if(0===arguments.length){for(g in this._events)"removeListener"!==g&&this.removeAllListeners(g);this.removeAllListeners("removeListener");this._events={};return this}var g=this._events[x];if(r(g))this.removeListener(x,g);else if(g)for(;g.length;)this.removeListener(x,g[g.length-1]);delete this._events[x];return this};m.prototype.listeners=function(x){return this._events&&this._events[x]?r(this._events[x])?[this._events[x]]:
this._events[x].slice():[]};m.prototype.listenerCount=function(x){if(this._events){x=this._events[x];if(r(x))return 1;if(x)return x.length}return 0};m.listenerCount=function(x,g){return x.listenerCount(g)}}])})})(b);const c=D.getDefaultExportFromCjs(b.exports);n=function(h){function p(){return h.apply(this,arguments)||this}t._inheritsLoose(p,h);p.create=function(){var k=t._asyncToGenerator(function*(e,m,r,v,x){v=new p(v);try{yield v._load(e,m,r,x)}catch(g){if(!C.isAbortError(g))return new E("invalid-resource",
`Could not load PNG: ${g.message}`)}return v});return function(e,m,r,v,x){return k.apply(this,arguments)}}();p.prototype._loadAnimation=function(){var k=t._asyncToGenerator(function*(e,m,r){return l(e,m,r)});return function(e,m,r){return k.apply(this,arguments)}}();return p}(n.BaseAnimatableTextureResource);const f=[137,80,78,71,13,10,26,10];q.APNG=n;q.isAnimatedPNG=function(h){if(!a(h))return!1;const p=new DataView(h);h=new Uint8Array(h);let k=8,e;do{const m=p.getUint32(k);e=String.fromCharCode.apply(String,
Array.prototype.slice.call(h.subarray(k+4,k+8)));if("acTL"===e)return!0;k+=12+m}while("IEND"!==e&&k<h.length);return!1};q.isPNG=a;q.parseApng=l;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/animatedFormats/BaseAnimatableTextureResource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/maybe ../../../../../core/promiseUtils ../definitions ./utils".split(" "),
function(q,t,D,E,C,A,n){let l=function(){function d(b){this._requestRender=b;this._frameData=null}var a=d.prototype;a.destroy=function(){this._playHandle.remove()};a.bindFrame=function(b,c,f){b.bindTexture(c,f);E.isNone(this._frameData)||(c.updateData(0,A.SPRITE_PADDING,A.SPRITE_PADDING,this._frameData.width,this._frameData.height,this._frameData),this._frameData=null)};a._load=function(){var b=t._asyncToGenerator(function*(c,f,h,p){try{const k=yield this._loadAnimation(c,e=>{this._frameData=e;this._requestRender.requestRender()},
p);this.frameCount=k.frameDurations.length;this.width=k.width;this.height=k.height;this._playHandle=n.play(k,f,h)}catch(k){if(!C.isAbortError(k))return new D("invalid-resource","Could not parse animated resource.")}});return function(c,f,h,p){return b.apply(this,arguments)}}();return d}();q.BaseAnimatableTextureResource=l;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/animatedFormats/utils":function(){define(["exports","../../../../../core/time",
"../../../../../symbols/cim/enums","../grouping"],function(q,t,D,E){function C(c){return t.Milliseconds(c.frameDurations.reduce((f,h)=>f+h,0))}function A(c){const {width:f,height:h}=c;return{frameDurations:c.frameDurations.reverse(),selectFrame:p=>{c.selectFrame(c.frameDurations.length-1-p)},width:f,height:h}}function n(c,f){const {width:h,height:p,selectFrame:k}=c,e=C(c),m=f/e;return{frameDurations:c.frameDurations.map(r=>t.Milliseconds(r*m)),selectFrame:k,width:h,height:p}}function l(c,f){const {width:h,
height:p,selectFrame:k}=c;c=c.frameDurations.slice();const e=c.shift();c.unshift(t.Milliseconds(e+f));return{frameDurations:c,selectFrame:k,width:h,height:p}}function d(c,f){const {width:h,height:p,selectFrame:k}=c;c=c.frameDurations.slice();const e=c.pop();c.push(t.Milliseconds(e+f));return{frameDurations:c,selectFrame:k,width:h,height:p}}function a(c,f,h){let {repeatType:p}=f;null==p&&(p=D.AnimatedSymbolRepeatType.Loop);!0===f.reverseAnimation&&(c=A(c));null!=f.duration&&(c=n(c,t.Milliseconds(1E3*
f.duration)));if(null!=f.repeatDelay){const k=1E3*f.repeatDelay;p===D.AnimatedSymbolRepeatType.Loop?c=d(c,t.Milliseconds(k)):p===D.AnimatedSymbolRepeatType.Oscillate&&(c=l(d(c,t.Milliseconds(k/2)),t.Milliseconds(k/2)))}null!=f.startTimeOffset?f=t.Milliseconds(1E3*f.startTimeOffset):null!=f.randomizeStartTime?(h=E.getMaterialGroup(h),f=E.getRandomValue(h,null!=f.randomizeStartSeed?f.randomizeStartSeed:82749913),f=t.Milliseconds(f*C(c))):f=t.Milliseconds(0);return new b(c,f,p)}let b=function(){function c(f,
h,p){this._animation=f;this._repeatType=p;this._direction=1;this._currentFrame=0;this.timeToFrame=this._animation.frameDurations[this._currentFrame];for(f=0;h>f;)f+=this.timeToFrame,this.nextFrame();this._animation.selectFrame(this._currentFrame)}c.prototype.nextFrame=function(){this._currentFrame+=this._direction;if(0<this._direction){if(this._currentFrame===this._animation.frameDurations.length)switch(this._repeatType){case D.AnimatedSymbolRepeatType.None:this._currentFrame-=this._direction;break;
case D.AnimatedSymbolRepeatType.Loop:this._currentFrame=0;break;case D.AnimatedSymbolRepeatType.Oscillate:this._currentFrame-=this._direction,this._direction=-1}}else if(-1===this._currentFrame)switch(this._repeatType){case D.AnimatedSymbolRepeatType.None:this._currentFrame-=this._direction;break;case D.AnimatedSymbolRepeatType.Loop:this._currentFrame=this._animation.frameDurations.length-1;break;case D.AnimatedSymbolRepeatType.Oscillate:this._currentFrame-=this._direction,this._direction=1}this.timeToFrame=
this._animation.frameDurations[this._currentFrame];this._animation.selectFrame(this._currentFrame)};return c}();q.Player=b;q.adjustDuration=n;q.appendDelay=d;q.createPlayer=a;q.getDuration=C;q.play=function(c,f,h){function p(){r=k&&setTimeout(()=>{e.nextFrame();m=e.timeToFrame;p()},m)}const k=null!=f.playAnimation?f.playAnimation:!0,e=a(c,f,h);let m=e.timeToFrame,r;p();return{remove:()=>{k&&clearTimeout(r)}}};q.prependDelay=l;q.reverse=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/engine/webgl/grouping":function(){define(["exports","../../../../core/string"],function(q,t){function D(E,C){if("string"===typeof E)E=t.numericHash(E+`-seed(${C})`);else{let A=12;E^=C;do E=107*(E>>8^E)+A|0;while(0!==--A)}return(1+E/-2147483648)/2}q.getMaterialGroup=function(E){return Math.floor(10*D(E,53290320))};q.getRandomValue=D;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/animatedFormats/gif":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/promiseUtils ../../../../../core/time ../../../../../geometry/support/meshUtils/exporters/gltf/imageutils ./BaseAnimatableTextureResource".split(" "),
function(q,t,D,E,C,A,n){function l(y,z,w){return d.apply(this,arguments)}function d(){d=t._asyncToGenerator(function*(y,z,w){y=x(y);var B=r(y,!0);const {width:F,height:G}=y.lsd;y=document.createElement("canvas");y.width=F;y.height=G;y=y.getContext("2d");const H=[];w=[];for(const L of B){w.push(C.Milliseconds(L.delay));B=new ImageData(L.patch,L.dims.width,L.dims.height);var I=A.imageTypeToCanvas(B);B=3===L.disposalType&&y.getImageData(L.dims.left,L.dims.top,L.dims.width,L.dims.height);y.drawImage(I,
L.dims.left,L.dims.top);I=y.getImageData(0,0,F,G);H.push(I);1!==L.disposalType&&(2===L.disposalType?y.clearRect(L.dims.left,L.dims.top,L.dims.width,L.dims.height):3===L.disposalType&&y.putImageData(B,L.dims.left,L.dims.top))}return{frameDurations:w,selectFrame:L=>{z(H[L])},width:F,height:G}});return d.apply(this,arguments)}function a(y){const z=new Uint8Array(y);return!u.some((w,B)=>w!==z[B])}var b={},c={},f={};Object.defineProperty(f,"__esModule",{value:!0});f.loop=f.conditional=f.parse=void 0;f.parse=
function B(z,w){var F=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},G=3<arguments.length&&void 0!==arguments[3]?arguments[3]:F;if(Array.isArray(w))w.forEach(function(I){return B(z,I,F,G)});else if("function"===typeof w)w(z,F,G,B);else{var H=Object.keys(w)[0];Array.isArray(w[H])?(G[H]={},B(z,w[H],F,G[H])):G[H]=w[H](z,F,G,B)}return F};f.conditional=function(z,w){return function(B,F,G,H){w(B,F,G)&&H(B,z,F,G)}};f.loop=function(z,w){return function(B,F,G,H){for(var I=[],L=B.pos;w(B,F,G);){var N=
{};H(B,z,F,N);if(B.pos===L)break;L=B.pos;I.push(N)}return I}};var h={};Object.defineProperty(h,"__esModule",{value:!0});h.readBits=h.readArray=h.readUnsigned=h.readString=h.peekBytes=h.readBytes=h.peekByte=h.readByte=h.buildStream=void 0;h.buildStream=function(z){return{data:z,pos:0}};var p=function(){return function(z){return z.data[z.pos++]}};h.readByte=p;h.peekByte=function(){var z=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return function(w){return w.data[w.pos+z]}};var k=function(z){return function(w){return w.data.subarray(w.pos,
w.pos+=z)}};h.readBytes=k;h.peekBytes=function(z){return function(w){return w.data.subarray(w.pos,w.pos+z)}};h.readString=function(z){return function(w){return Array.from(k(z)(w)).map(function(B){return String.fromCharCode(B)}).join("")}};h.readUnsigned=function(z){return function(w){w=k(2)(w);return z?(w[1]<<8)+w[0]:(w[0]<<8)+w[1]}};h.readArray=function(z,w){return function(B,F,G){F="function"===typeof w?w(B,F,G):w;G=k(z);for(var H=Array(F),I=0;I<F;I++)H[I]=G(B);return H}};h.readBits=function(z){return function(w){w=
p()(w);for(var B=Array(8),F=0;8>F;F++)B[7-F]=!!(w&1<<F);return Object.keys(z).reduce(function(G,H){var I=z[H];if(I.length){for(var L=I.length,N=0,J=0;J<L;J++)N+=B[I.index+J]&&Math.pow(2,L-J-1);G[H]=N}else G[H]=B[I.index];return G},{})}};(function(z){Object.defineProperty(z,"__esModule",{value:!0});z["default"]=void 0;var w={blocks:function(I){for(var L=[],N=I.data.length,J=0,K=(0,h.readByte)()(I);0!==K&&K;K=(0,h.readByte)()(I)){if(I.pos+K>=N){N-=I.pos;L.push((0,h.readBytes)(N)(I));J+=N;break}L.push((0,
h.readBytes)(K)(I));J+=K}I=new Uint8Array(J);for(N=J=0;N<L.length;N++)I.set(L[N],J),J+=L[N].length;return I}},B=(0,f.conditional)({gce:[{codes:(0,h.readBytes)(2)},{byteSize:(0,h.readByte)()},{extras:(0,h.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,h.readUnsigned)(!0)},{transparentColorIndex:(0,h.readByte)()},{terminator:(0,h.readByte)()}]},function(I){I=(0,h.peekBytes)(2)(I);return 33===I[0]&&249===I[1]}),F=(0,f.conditional)({image:[{code:(0,
h.readByte)()},{descriptor:[{left:(0,h.readUnsigned)(!0)},{top:(0,h.readUnsigned)(!0)},{width:(0,h.readUnsigned)(!0)},{height:(0,h.readUnsigned)(!0)},{lct:(0,h.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,f.conditional)({lct:(0,h.readArray)(3,function(I,L,N){return Math.pow(2,N.descriptor.lct.size+1)})},function(I,L,N){return N.descriptor.lct.exists}),{data:[{minCodeSize:(0,h.readByte)()},w]}]},function(I){return 44===(0,
h.peekByte)()(I)}),G=(0,f.conditional)({text:[{codes:(0,h.readBytes)(2)},{blockSize:(0,h.readByte)()},{preData:function(I,L,N){return(0,h.readBytes)(N.text.blockSize)(I)}},w]},function(I){I=(0,h.peekBytes)(2)(I);return 33===I[0]&&1===I[1]}),H=(0,f.conditional)({application:[{codes:(0,h.readBytes)(2)},{blockSize:(0,h.readByte)()},{id:function(I,L,N){return(0,h.readString)(N.blockSize)(I)}},w]},function(I){I=(0,h.peekBytes)(2)(I);return 33===I[0]&&255===I[1]});w=(0,f.conditional)({comment:[{codes:(0,
h.readBytes)(2)},w]},function(I){I=(0,h.peekBytes)(2)(I);return 33===I[0]&&254===I[1]});B=[{header:[{signature:(0,h.readString)(3)},{version:(0,h.readString)(3)}]},{lsd:[{width:(0,h.readUnsigned)(!0)},{height:(0,h.readUnsigned)(!0)},{gct:(0,h.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,h.readByte)()},{pixelAspectRatio:(0,h.readByte)()}]},(0,f.conditional)({gct:(0,h.readArray)(3,function(I,L){return Math.pow(2,L.lsd.gct.size+
1)})},function(I,L){return L.lsd.gct.exists}),{frames:(0,f.loop)([B,H,w,F,G],function(I){I=(0,h.peekByte)()(I);return 33===I||44===I})}];z["default"]=B})(c);var e={};Object.defineProperty(e,"__esModule",{value:!0});e.deinterlace=void 0;e.deinterlace=function(z,w){for(var B=Array(z.length),F=z.length/w,G=[0,4,2,1],H=[8,8,4,2],I=0,L=0;4>L;L++)for(var N=G[L];N<F;N+=H[L]){var J=N,K=z.slice(I*w,(I+1)*w);B.splice.apply(B,[J*w,w].concat(K));I++}return B};var m={};Object.defineProperty(m,"__esModule",{value:!0});
m.lzw=void 0;m.lzw=function(z,w,B){var F,G,H,I,L,N,J,K,O=Array(B),W=Array(4096),aa=Array(4096),ba=Array(4097);var S=1<<z;var M=S+1;var Q=S+2;var Y=-1;var V=z+1;var P=(1<<V)-1;for(G=0;G<S;G++)W[G]=0,aa[G]=G;for(H=I=F=L=N=K=J=0;H<B;){if(0===N){if(F<V){I+=w[J]<<F;F+=8;J++;continue}G=I&P;I>>=V;F-=V;if(G>Q||G==M)break;if(G==S){V=z+1;P=(1<<V)-1;Q=S+2;Y=-1;continue}if(-1==Y){ba[N++]=aa[G];L=Y=G;continue}var X=G;G==Q&&(ba[N++]=L,G=Y);for(;G>S;)ba[N++]=aa[G],G=W[G];L=aa[G]&255;ba[N++]=L;4096>Q&&(W[Q]=Y,aa[Q]=
L,Q++,0===(Q&P)&&4096>Q&&(V++,P+=Q));Y=X}N--;O[K++]=ba[N];H++}for(H=K;H<B;H++)O[H]=0;return O};Object.defineProperty(b,"__esModule",{value:!0});var r=b.decompressFrames=b.decompressFrame=x=b.parseGIF=void 0,v=c&&c.__esModule?c:{default:c},x=b.parseGIF=function(z){z=new Uint8Array(z);return(0,f.parse)((0,h.buildStream)(z),v["default"])},g=function(z,w,B){if(z.image){var F=z.image,G=F.descriptor.width*F.descriptor.height;G=(0,m.lzw)(F.data.minCodeSize,F.data.blocks,G);F.descriptor.lct.interlaced&&(G=
(0,e.deinterlace)(G,F.descriptor.width));G={pixels:G,dims:{top:z.image.descriptor.top,left:z.image.descriptor.left,width:z.image.descriptor.width,height:z.image.descriptor.height}};G.colorTable=F.descriptor.lct&&F.descriptor.lct.exists?F.lct:w;z.gce&&(G.delay=10*(z.gce.delay||10),G.disposalType=z.gce.extras.disposal,z.gce.extras.transparentColorGiven&&(G.transparentIndex=z.gce.transparentColorIndex));if(B){z=G.pixels.length;w=new Uint8ClampedArray(4*z);for(B=0;B<z;B++){F=4*B;var H=G.pixels[B],I=G.colorTable[H]||
[0,0,0];w[F]=I[0];w[F+1]=I[1];w[F+2]=I[2];w[F+3]=H!==G.transparentIndex?255:0}G.patch=w}return G}console.warn("gif frame does not have associated image.")};b.decompressFrame=g;r=b.decompressFrames=function(z,w){return z.frames.filter(function(B){return B.image}).map(function(B){return g(B,z.gct,w)})};n=function(z){function w(){return z.apply(this,arguments)||this}t._inheritsLoose(w,z);w.create=function(){var B=t._asyncToGenerator(function*(F,G,H,I,L){I=new w(I);try{yield I._load(F,G,H,L)}catch(N){if(!E.isAbortError(N))return new D("invalid-resource",
`Could not load GIF: ${N.message}`)}return I});return function(F,G,H,I,L){return B.apply(this,arguments)}}();w.prototype._loadAnimation=function(){var B=t._asyncToGenerator(function*(F,G,H){return l(F,G,H)});return function(F,G,H){return B.apply(this,arguments)}}();return w}(n.BaseAnimatableTextureResource);const u=[71,73,70];q.GIF=n;q.isAnimatedGIF=function(z){function w(){H++;G+=8;const L=F.getUint8(G++);G+=L&128?3*2**((L&7)+1):0;G++;B()}function B(){let L;for(;L=F.getUint8(G++);)G+=L}if(!a(z))return!1;
const F=new DataView(z);z=F.getUint8(10);let G=13+(z&128?3*2**((z&7)+1):0),H=0;for(z=!1;!z;){switch(F.getUint8(G++)){case 33:a:{switch(F.getUint8(G++)){case 249:G++;G+=4;B();break;case 1:H++;G++;G+=12;B();break;case 254:B();break;case 255:G++;G+=8;G+=3;B();break;default:var I=!1;break a}I=!0}if(!I)return!1;break;case 44:w();break;case 59:z=!0;break;default:return!1}if(1<H)return!0}return!1};q.isGIF=a;q.parseGif=l;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/geometry/support/meshUtils/exporters/gltf/imageutils":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../../core/Error ../../../../../core/maybe ../../../../../core/urlUtils".split(" "),function(q,t,D,E,C,A){function n(){n=t._asyncToGenerator(function*(b){const c=a(b);if(C.isNone(c))throw new E("imageToArrayBuffer","Unsupported image type");const f=yield l(b);b=yield new Promise(h=>c.toBlob(h,f));if(!b)throw new E("imageToArrayBuffer",
"Failed to encode image");return{data:yield b.arrayBuffer(),type:f}});return n.apply(this,arguments)}function l(b){return d.apply(this,arguments)}function d(){d=t._asyncToGenerator(function*(b){if(!(b instanceof HTMLImageElement))return"image/png";b=b.src;return A.isDataProtocol(b)?({mediaType:b}=A.dataComponents(b),"image/jpeg"===b?b:"image/png"):/\.png$/i.test(b)?"image/png":/\.(jpg|jpeg)$/i.test(b)?"image/jpeg":"image/png"});return d.apply(this,arguments)}function a(b){if(b instanceof HTMLCanvasElement)return b;
if(b instanceof HTMLVideoElement)return null;const c=document.createElement("canvas");c.width=b.width;c.height=b.height;const f=c.getContext("2d");b instanceof HTMLImageElement?f.drawImage(b,0,0,b.width,b.height):b instanceof ImageData&&f.putImageData(b,0,0);return c}q.encodeBase64DataUri=function(b){const c=[];b=new Uint8Array(b);for(let f=0;f<b.length;f++)c.push(String.fromCharCode(b[f]));return"data:application/octet-stream;base64,"+btoa(c.join(""))};q.imageToArrayBuffer=function(b){return n.apply(this,
arguments)};q.imageToDataURI=function(b){b=a(b);return C.isSome(b)?b.toDataURL():""};q.imageTypeToCanvas=a;q.isArrayBufferPNG=function(b){if(8>b.byteLength)return!1;b=new Uint8Array(b);return 137===b[0]&&80===b[1]&&78===b[2]&&71===b[3]&&13===b[4]&&10===b[5]&&26===b[6]&&10===b[7]};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/util/Result":function(){define(["exports","../../../../../core/Error"],function(q,t){q.ok=function(D,
E){return D&&"name"in D?(E&&E.error(new t(D.name,D.message,D.details)),!1):!0};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/util/symbolUtils":function(){define(["exports"],function(q){q.keyFromSymbol=function(t){switch(t.type){case "esriSMS":return`${t.style}.${t.path}`;case "esriSLS":return`${t.style}.${t.cap}`;case "esriSFS":return`${t.style}`;case "esriPFS":case "esriPMS":return t.imageData?`${t.imageData}${t.width}${t.height}`:
`${t.url}${t.width}${t.height}`;default:return"mosaicHash"in t?t.mosaicHash:JSON.stringify(t)}};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/WorldExtentClipRenderer":function(){define("exports ../../../../core/maybe ../../../../chunks/common ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../../../../chunks/vec2f64 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ./VertexStream ./shaders/StencilPrograms ../../../webgl/enums ../../../webgl/ProgramTemplate".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c){const f=A.fromValues(-.5,-.5);A=function(){function h(){this._centerNdc=l.create();this._pxToNdc=l.create();this._worldDimensionsPx=l.create();this._mat3=C.create();this._initialized=!1}var p=h.prototype;p.dispose=function(){this._program=t.disposeMaybe(this._program);this._quad=t.disposeMaybe(this._quad)};p.render=function(k,e){const {context:m}=k;if(!this._updateGeometry(k,e))return!1;this._initialized||this._initialize(m);m.setDepthWriteEnabled(!1);m.setDepthTestEnabled(!1);
m.setColorMask(!1,!1,!1,!1);m.setBlendingEnabled(!1);m.setStencilOp(b.StencilOperation.KEEP,b.StencilOperation.KEEP,b.StencilOperation.REPLACE);m.setStencilFunction(b.CompareFunction.ALWAYS,1,255);m.setStencilTestEnabled(!0);m.useProgram(this._program);this._program.setUniformMatrix3fv("u_worldExtent",this._mat3);this._quad.draw();this._quad.unbind();return!0};p._initialize=function(k){if(!this._initialized){var e=c.createProgram(k,a.stencil);e&&(this._program=e,this._quad=new d(k,[0,0,1,0,0,1,1,
1]),this._initialized=!0)}};p._updateGeometry=function(k,e){const {state:m,pixelRatio:r}=k,{size:v,rotation:x}=m,g=Math.round(v[0]*r),u=Math.round(v[1]*r);if(!m.spatialReference.isWrappable)return!1;k=D.toRadian(x);const y=Math.abs(Math.cos(k)),z=Math.abs(Math.sin(k)),w=Math.round(m.worldScreenWidth);if(Math.round(g*y+u*z)<=w)return!1;const B=(e.left-e.right)*r/g;e=(e.bottom-e.top)*r/u;n.set(this._worldDimensionsPx,w*r,g*z+u*y,1);n.set(this._pxToNdc,2/g,-2/u,1);n.set(this._centerNdc,B,e,1);e=this._mat3;
E.fromTranslation(e,this._centerNdc);E.scale(e,e,this._pxToNdc);0!==x&&E.rotate(e,e,k);E.scale(e,e,this._worldDimensionsPx);E.translate(e,e,f);return!0};return h}();q.WorldExtentClipRenderer=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/shaders/StencilPrograms":function(){define(["exports","./sources/resolver"],function(q,t){t={shaders:{vertexShader:t.resolveIncludes("stencil/stencil.vert"),fragmentShader:t.resolveIncludes("stencil/stencil.frag")},
attributes:new Map([["a_pos",0]])};q.stencil=t;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/AnimationEffect":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../VertexStream ./Effect".split(" "),function(q,t,D,E,C,A){A=function(n){function l(){var a=n.apply(this,arguments)||this;a.defines=[];a._desc={vsPath:"fx/integrate",fsPath:"fx/integrate",attributes:new Map([["a_position",
0]])};return a}t._inheritsLoose(l,n);var d=l.prototype;d.dispose=function(){this._quad&&this._quad.dispose()};d.bind=function(){};d.unbind=function(){};d.draw=function(a,b){if(b.size){var {context:c,renderingOptions:f}=a;this._quad||(this._quad=new C(c,[0,0,1,0,0,1,1,1]));var h=c.getBoundFramebufferObject(),{x:p,y:k,width:e,height:m}=c.getViewport();b.bindTextures(c);var r=b.getBlock(E.ATTRIBUTE_DATA_ANIMATION);if(!D.isNone(r)){var v=r.getFBO(c);r=r.getFBO(c,1);c.setViewport(0,0,b.size,b.size);this._computeDelta(a,
r,f.labelsAnimationTime);this._updateAnimationState(a,r,v);c.bindFramebuffer(h);c.setViewport(p,k,e,m)}}};d._computeDelta=function(a,b,c){const {context:f,painter:h,displayLevel:p}=a,k=h.materialManager.getProgram(this._desc,["delta"]);f.bindFramebuffer(b);f.setClearColor(0,0,0,0);f.clear(f.gl.COLOR_BUFFER_BIT);f.useProgram(k);k.setUniform1i("u_maskTexture",E.TEXTURE_BINDING_ATTRIBUTE_DATA_0);k.setUniform1i("u_sourceTexture",E.TEXTURE_BINDING_ATTRIBUTE_DATA_1);k.setUniform1f("u_timeDelta",a.deltaTime);
k.setUniform1f("u_animationTime",c);k.setUniform1f("u_zoomLevel",Math.round(10*p));this._quad.draw()};d._updateAnimationState=function(a,b,c){const {context:f,painter:h}=a;a=h.materialManager.getProgram(this._desc,["update"]);f.bindTexture(b.colorTexture,1);f.useProgram(a);a.setUniform1i("u_sourceTexture",1);f.bindFramebuffer(c);f.setClearColor(0,0,0,0);f.clear(f.gl.COLOR_BUFFER_BIT);this._quad.draw()};return l}(A.Effect);q.AnimationEffect=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/engine/webgl/effects/Effect":function(){define(["exports"],function(q){let t=function(){function D(){this.name=this.constructor.name}D.prototype.createOptions=function(E,C){return null};return D}();q.Effect=t;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/BlendEffect":function(){define("exports ../../../../../core/Error ../../../../../core/Logger ../../../../../core/maybe ../enums ../VertexStream ../shaders/BlendPrograms ../../../../webgl/enums ../../../../webgl/Texture".split(" "),
function(q,t,D,E,C,A,n,l,d){const a=D.getLogger("esri.views.2d.engine.webgl.effects.blendEffects.BlendEffect");D=function(){function b(){this._size=[0,0]}var c=b.prototype;c.dispose=function(f){this._backBufferTexture=E.disposeMaybe(this._backBufferTexture);this._quad=E.disposeMaybe(this._quad)};c.draw=function(f,h,p,k,e){const {context:m,drawPhase:r}=f;this._setupShader(m);k&&"normal"!==k&&r!==C.WGLDrawPhase.LABEL?this._drawBlended(f,h,p,k,e):(f=n.createProgramTemplate("normal"),(f=m.programCache.acquire(f.shaders.vertexShader,
f.shaders.fragmentShader,f.attributes))?(m.useProgram(f),h.setSamplingMode(p),m.bindTexture(h,0),f.setUniform1i("u_layerTexture",0),f.setUniform1f("u_opacity",e),m.setBlendingEnabled(!0),m.setBlendFunction(l.BlendFactor.ONE,l.BlendFactor.ONE_MINUS_SRC_ALPHA),h=this._quad,h.draw(),h.unbind(),f.dispose()):a.error(new t("mapview-BlendEffect",'Error creating shader program for blend mode "normal"')))};c._drawBlended=function(f,h,p,k,e){const {context:m,state:r,pixelRatio:v,inFadeTransition:x}=f;var {size:g}=
r,u=m.getBoundFramebufferObject();let y;E.isSome(u)?(g=u.descriptor,y=g.width,g=g.height):(y=Math.round(v*g[0]),g=Math.round(v*g[1]));this._createOrResizeTexture(f,y,g);f=this._backBufferTexture;u.copyToTexture(0,0,y,g,0,0,f);m.setStencilTestEnabled(!1);m.setStencilWriteMask(0);m.setBlendingEnabled(!0);m.setDepthTestEnabled(!1);m.setDepthWriteEnabled(!1);u=n.createProgramTemplate(k);(u=m.programCache.acquire(u.shaders.vertexShader,u.shaders.fragmentShader,u.attributes))?(m.useProgram(u),f.setSamplingMode(p),
m.bindTexture(f,0),u.setUniform1i("u_backbufferTexture",0),h.setSamplingMode(p),m.bindTexture(h,1),u.setUniform1i("u_layerTexture",1),u.setUniform1f("u_opacity",e),u.setUniform1f("u_inFadeOpacity",x?1:0),m.setBlendFunction(l.BlendFactor.ONE,l.BlendFactor.ZERO),h=this._quad,h.draw(),h.unbind(),u.dispose(),m.setBlendFunction(l.BlendFactor.ONE,l.BlendFactor.ONE_MINUS_SRC_ALPHA)):a.error(new t("mapview-BlendEffect",`Error creating shader program for blend mode ${k}`))};c._setupShader=function(f){this._quad||
(this._quad=new A(f,[-1,-1,1,-1,-1,1,1,1]))};c._createOrResizeTexture=function(f,h,p){({context:f}=f);if(null===this._backBufferTexture||h!==this._size[0]||p!==this._size[1])this._backBufferTexture?this._backBufferTexture.resize(h,p):this._backBufferTexture=new d.Texture(f,{target:l.TextureType.TEXTURE_2D,pixelFormat:l.PixelFormat.RGBA,internalFormat:l.PixelFormat.RGBA,dataType:l.PixelType.UNSIGNED_BYTE,wrapMode:l.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:l.TextureSamplingMode.LINEAR,flipped:!1,
width:h,height:p}),this._size[0]=h,this._size[1]=p};return b}();q.BlendEffect=D;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/shaders/BlendPrograms":function(){define(["exports","./sources/resolver"],function(q,t){q.createProgramTemplate=function(D){return{attributes:new Map([["a_pos",0],["a_tex",1]]),shaders:{vertexShader:`#define ${D.replace("-","_").toUpperCase()}\n`+t.resolveIncludes("blend/blend.vert"),fragmentShader:`#define ${D.replace("-",
"_").toUpperCase()}\n`+t.resolveIncludes("blend/blend.frag")}}};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/FeatureEffect":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./Effect","../../../../webgl/enums"],function(q,t,D,E){D=function(C){function A(l){var d=C.call(this)||this;d.name=d.constructor.name;d.defines=[l];return d}t._inheritsLoose(A,C);var n=A.prototype;n.dispose=function(){};
n.bind=function({context:l,painter:d}){this._prev=l.getBoundFramebufferObject();const {width:a,height:b}=l.getViewport();d=d.getFbos(a,b).effect0;l.bindFramebuffer(d);l.setColorMask(!0,!0,!0,!0);l.setClearColor(0,0,0,0);l.clear(l.gl.COLOR_BUFFER_BIT)};n.unbind=function(){};n.draw=function(l,d){const {context:a,painter:b}=l;d=b.getPostProcessingEffects(d);const c=a.getBoundFramebufferObject();for(const {postProcessingEffect:f,effect:h}of d)f.draw(l,c,h);a.bindFramebuffer(this._prev);a.setStencilTestEnabled(!1);
b.blitTexture(a,c.colorTexture,E.TextureSamplingMode.NEAREST);a.setStencilTestEnabled(!0)};return A}(D.Effect);q.FeatureEffect=D;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/HighlightEffect":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../BitBlitRenderer ./Effect ./highlight/HighlightGradient ./highlight/HighlightRenderer ./highlight/HighlightSurfaces ../../../../webgl/enums".split(" "),
function(q,t,D,E,C,A,n,l){return function(d){function a(){var c=d.apply(this,arguments)||this;c.defines=["highlight"];c._hlRenderer=new A;c._hlGradient=new C;c._width=void 0;c._height=void 0;c._hlSurfaces=new n;c._adjustedWidth=void 0;c._adjustedHeight=void 0;c._blitRenderer=new D.BitBlitRenderer;return c}q._inheritsLoose(a,d);var b=a.prototype;b.dispose=function(){this._hlSurfaces&&this._hlSurfaces.dispose();this._hlRenderer&&this._hlRenderer.dispose();this._hlGradient&&this._hlGradient.destroy();
this._boundFBO=null};b.bind=function(c){const {context:f,painter:h}=c,{width:p,height:k}=f.getViewport(),e=h.getFbos(p,k).effect0;this.setup(c,p,k);f.bindFramebuffer(e);f.setColorMask(!0,!0,!0,!0);f.setClearColor(0,0,0,0);f.clear(f.gl.COLOR_BUFFER_BIT)};b.unbind=function(){};b.setup=function({context:c},f,h){this._width=f;this._height=h;const p=f%4,k=h%4;f+=2>p?-p:4-p;h+=2>k?-k:4-k;this._adjustedWidth=f;this._adjustedHeight=h;this._boundFBO=c.getBoundFramebufferObject();f=Math.round(1*f);h=Math.round(1*
h);this._hlRenderer.setup(c,f,h);this._hlSurfaces.setup(c,f,h)};b.draw=function({context:c}){const f=c.getBoundFramebufferObject();c.setViewport(0,0,1*this._adjustedWidth,1*this._adjustedHeight);c.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);c.setStencilTestEnabled(!1);c.setClearColor(0,0,0,0);c.clear(c.gl.COLOR_BUFFER_BIT);this._blitRenderer.render(c,f.colorTexture,l.TextureSamplingMode.NEAREST,1);c.setStencilTestEnabled(!1);c.setBlendingEnabled(!1);c.setColorMask(!1,!1,!1,!0);c.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo);
c.setClearColor(0,0,0,0);c.clear(c.gl.COLOR_BUFFER_BIT);this._hlRenderer.preBlur(c,this._hlSurfaces.sharedBlur1Tex);c.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);c.setClearColor(0,0,0,0);c.clear(c.gl.COLOR_BUFFER_BIT);this._hlRenderer.finalBlur(c,this._hlSurfaces.sharedBlur2Tex);c.bindFramebuffer(this._boundFBO);c.setBlendingEnabled(!0);c.setColorMask(!0,!0,!0,!0);c.setViewport(0,0,this._width,this._height);this._hlRenderer.renderHighlight(c,this._hlSurfaces.sharedBlur1Tex,this._hlGradient);
this._boundFBO=null};b.setHighlightOptions=function(c){this._hlGradient.setHighlightOptions(c)};return a}(E.Effect)})},"esri/views/2d/engine/webgl/effects/highlight/HighlightGradient":function(){define(["../../../../../../core/Logger","../../definitions","./parameters","../../../../../webgl/enums","../../../../../webgl/Texture"],function(q,t,D,E,C){function A(d,a){a.fillColor[0]=d.color.r/255;a.fillColor[1]=d.color.g/255;a.fillColor[2]=d.color.b/255;a.fillColor[3]=d.color.a;d.haloColor?(a.outlineColor[0]=
d.haloColor.r/255,a.outlineColor[1]=d.haloColor.g/255,a.outlineColor[2]=d.haloColor.b/255,a.outlineColor[3]=d.haloColor.a):(a.outlineColor[0]=a.fillColor[0],a.outlineColor[1]=a.fillColor[1],a.outlineColor[2]=a.fillColor[2],a.outlineColor[3]=a.fillColor[3]);a.fillColor[3]*=d.fillOpacity;a.outlineColor[3]*=d.haloOpacity;a.fillColor[0]*=a.fillColor[3];a.fillColor[1]*=a.fillColor[3];a.fillColor[2]*=a.fillColor[3];a.outlineColor[0]*=a.outlineColor[3];a.outlineColor[1]*=a.outlineColor[3];a.outlineColor[2]*=
a.outlineColor[3];a.outlineWidth=D.HIGHLIGHT_SIZING.outlineWidth;a.outerHaloWidth=D.HIGHLIGHT_SIZING.outerHaloWidth;a.innerHaloWidth=D.HIGHLIGHT_SIZING.innerHaloWidth;a.outlinePosition=D.HIGHLIGHT_SIZING.outlinePosition}const n=q.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient"),l=[0,0,0,0];return function(){function d(){this._convertedHighlightOptions={fillColor:[.2*.75,.6*.75,.675,.75],outlineColor:[.2*.9,.54,.81,.9],outlinePosition:D.HIGHLIGHT_SIZING.outlinePosition,outlineWidth:D.HIGHLIGHT_SIZING.outlineWidth,
innerHaloWidth:D.HIGHLIGHT_SIZING.innerHaloWidth,outerHaloWidth:D.HIGHLIGHT_SIZING.outerHaloWidth};this.shadeTexChanged=!0;this.texelData=new Uint8Array(4*D.SHADE_TEXTURE_SIZE);this.minMaxDistance=[0,0]}var a=d.prototype;a.setHighlightOptions=function(b){function c(v,x,g){r[0]=(1-g)*v[0]+g*x[0];r[1]=(1-g)*v[1]+g*x[1];r[2]=(1-g)*v[2]+g*x[2];r[3]=(1-g)*v[3]+g*x[3]}const f=this._convertedHighlightOptions;A(b,f);b=f.outlinePosition-f.outlineWidth/2-f.outerHaloWidth;const h=f.outlinePosition-f.outlineWidth/
2,p=f.outlinePosition+f.outlineWidth/2,k=f.outlinePosition+f.outlineWidth/2+f.innerHaloWidth;var e=Math.sqrt(Math.PI/2)*D.SIGMA,m=Math.abs(b)>e?Math.round(10*(Math.abs(b)-e))/10:0;e=Math.abs(k)>e?Math.round(10*(Math.abs(k)-e))/10:0;m&&!e?n.error("The outer rim of the highlight is "+m+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!m&&e?n.error("The inner rim of the highlight is "+e+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):
m&&e&&n.error("The highlight is "+Math.max(m,e)+"px away from the edge of the feature; consider reducing some width values.");const r=[void 0,void 0,void 0,void 0];({texelData:e}=this);for(let v=0;v<D.SHADE_TEXTURE_SIZE;++v)m=b+v/(D.SHADE_TEXTURE_SIZE-1)*(k-b),m<b?(r[4*v]=0,r[4*v+1]=0,r[4*v+2]=0,r[4*v+3]=0):m<h?c(l,f.outlineColor,(m-b)/(h-b)):m<p?[r[0],r[1],r[2],r[3]]=f.outlineColor:m<k?c(f.outlineColor,f.fillColor,(m-p)/(k-p)):[r[4*v],r[4*v+1],r[4*v+2],r[4*v+3]]=f.fillColor,e[4*v]=255*r[0],e[4*v+
1]=255*r[1],e[4*v+2]=255*r[2],e[4*v+3]=255*r[3];this.minMaxDistance[0]=b;this.minMaxDistance[1]=k;this.shadeTexChanged=!0};a.applyHighlightOptions=function(b,c){this.shadeTex||(this.shadeTex=new C.Texture(b,{target:E.TextureType.TEXTURE_2D,pixelFormat:E.PixelFormat.RGBA,dataType:E.PixelType.UNSIGNED_BYTE,wrapMode:E.TextureWrapMode.CLAMP_TO_EDGE,width:D.SHADE_TEXTURE_SIZE,height:1,samplingMode:E.TextureSamplingMode.LINEAR}));this.shadeTexChanged&&(this.shadeTex.updateData(0,0,0,D.SHADE_TEXTURE_SIZE,
1,this.texelData),this.shadeTexChanged=!1);b.bindTexture(this.shadeTex,t.TEXTURE_BINDING_HIGHLIGHT_1);c.setUniform2fv("u_minMaxDistance",this.minMaxDistance)};a.destroy=function(){this.shadeTex&&(this.shadeTex.dispose(),this.shadeTex=null)};return d}()})},"esri/views/2d/engine/webgl/effects/highlight/parameters":function(){define(["exports"],function(q){q.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1];q.HIGHLIGHT_SIZING={outlineWidth:1.3,outerHaloWidth:.4,innerHaloWidth:.4,
outlinePosition:0};q.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];q.SHADE_TEXTURE_SIZE=256;q.SIGMA=1;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/highlight/HighlightRenderer":function(){define("../../definitions ./parameters ../../shaders/HighlightPrograms ../../../../../webgl/BufferObject ../../../../../webgl/enums ../../../../../webgl/ProgramTemplate ../../../../../webgl/VertexArrayObject ../../../../../webgl/VertexElementDescriptor".split(" "),
function(q,t,D,E,C,A,n,l){return function(){function d(){this._height=this._width=void 0;this._resources=null}var a=d.prototype;a.dispose=function(){this._resources&&(this._resources.quadGeometry.dispose(),this._resources.quadVAO.dispose(),this._resources.highlightProgram.dispose(),this._resources.blurProgram.dispose(),this._resources=null)};a.preBlur=function(b,c){b.bindTexture(c,q.TEXTURE_BINDING_HIGHLIGHT_0);b.useProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",
[1,0,1/this._width,0]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",t.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);b.bindVAO(this._resources.quadVAO);b.drawArrays(C.PrimitiveType.TRIANGLE_STRIP,0,4);b.bindVAO()};a.finalBlur=function(b,c){b.bindTexture(c,q.TEXTURE_BINDING_HIGHLIGHT_0);b.useProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",t.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);
b.bindVAO(this._resources.quadVAO);b.drawArrays(C.PrimitiveType.TRIANGLE_STRIP,0,4);b.bindVAO()};a.renderHighlight=function(b,c,f){b.bindTexture(c,q.TEXTURE_BINDING_HIGHLIGHT_0);b.useProgram(this._resources.highlightProgram);f.applyHighlightOptions(b,this._resources.highlightProgram);b.bindVAO(this._resources.quadVAO);b.setBlendingEnabled(!0);b.setBlendFunction(C.BlendFactor.ONE,C.BlendFactor.ONE_MINUS_SRC_ALPHA);b.drawArrays(C.PrimitiveType.TRIANGLE_STRIP,0,4);b.bindVAO()};a._initialize=function(b,
c,f){this._width=c;this._height=f;c=E.BufferObject.createVertex(b,C.Usage.STATIC_DRAW,(new Int8Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1])).buffer);f=new n.VertexArrayObject(b,new Map([["a_position",0],["a_texcoord",1]]),{geometry:[new l.VertexElementDescriptor("a_position",2,C.DataType.BYTE,0,4),new l.VertexElementDescriptor("a_texcoord",2,C.DataType.UNSIGNED_BYTE,2,4)]},{geometry:c});const h=A.createProgram(b,D.highlight),p=A.createProgram(b,D.blur);b.useProgram(h);h.setUniform1i("u_texture",q.TEXTURE_BINDING_HIGHLIGHT_0);
h.setUniform1i("u_shade",q.TEXTURE_BINDING_HIGHLIGHT_1);h.setUniform1f("u_sigma",t.SIGMA);b.useProgram(p);p.setUniform1i("u_texture",q.TEXTURE_BINDING_HIGHLIGHT_0);p.setUniform1f("u_sigma",t.SIGMA);this._resources={quadGeometry:c,quadVAO:f,highlightProgram:h,blurProgram:p}};a.setup=function(b,c,f){this._resources?(this._width=c,this._height=f):this._initialize(b,c,f)};return d}()})},"esri/views/2d/engine/webgl/shaders/HighlightPrograms":function(){define(["exports","./sources/resolver"],function(q,
t){const D={shaders:{vertexShader:t.resolveIncludes("highlight/textured.vert"),fragmentShader:t.resolveIncludes("highlight/highlight.frag")},attributes:new Map([["a_position",0],["a_texcoord",1]])};t={shaders:{vertexShader:t.resolveIncludes("highlight/textured.vert"),fragmentShader:t.resolveIncludes("highlight/blur.frag")},attributes:new Map([["a_position",0],["a_texcoord",1]])};q.blur=t;q.highlight=D;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/highlight/HighlightSurfaces":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../webgl/enums","../../../../../webgl/FramebufferObject","../../../../../webgl/Texture"],function(q,t,D,E){function C(A,n,l){n=new E.Texture(A,{target:t.TextureType.TEXTURE_2D,pixelFormat:t.PixelFormat.RGBA,dataType:t.PixelType.UNSIGNED_BYTE,wrapMode:t.TextureWrapMode.CLAMP_TO_EDGE,width:n,height:l,samplingMode:t.TextureSamplingMode.LINEAR});A=new D.FramebufferObject(A,{colorTarget:t.TargetType.TEXTURE,depthStencilTarget:t.DepthStencilTargetType.STENCIL_RENDER_BUFFER},n);return[n,A]}
return function(){function A(){this._height=this._width=void 0;this._resources=null}var n=A.prototype;n.dispose=function(){this._resources&&(this._resources.sharedBlur1Tex.dispose(),this._resources.sharedBlur1Fbo.dispose(),this._resources.sharedBlur2Tex.dispose(),this._resources.sharedBlur2Fbo.dispose(),this._resources=null)};n._initialize=function(l,d,a){this._width=d;this._height=a;const [b,c]=C(l,d,a),[f,h]=C(l,d,a);this._resources={sharedBlur1Tex:b,sharedBlur1Fbo:c,sharedBlur2Tex:f,sharedBlur2Fbo:h}};
n.setup=function(l,d,a){!this._resources||this._width===d&&this._height===a||this.dispose();this._resources||this._initialize(l,d,a)};q._createClass(A,[{key:"sharedBlur1Tex",get:function(){return this._resources.sharedBlur1Tex}},{key:"sharedBlur1Fbo",get:function(){return this._resources.sharedBlur1Fbo}},{key:"sharedBlur2Tex",get:function(){return this._resources.sharedBlur2Tex}},{key:"sharedBlur2Fbo",get:function(){return this._resources.sharedBlur2Fbo}}]);return A}()})},"esri/views/2d/engine/webgl/effects/HittestEffect":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ./Effect ../../../../webgl/enums".split(" "),
function(q,t,D,E,C,A){C=function(n){function l(){var a=n.apply(this,arguments)||this;a.name=a.constructor.name;a.defines=["hittest"];return a}t._inheritsLoose(l,n);var d=l.prototype;d.dispose=function(){D.isSome(this._fbo)&&this._fbo.dispose()};d.createOptions=function({pixelRatio:a},b,c=E.HITTEST_RADIUS){if(!b.length)return null;b=b.shift();const f=b.point.x,h=b.point.y;this._outstanding=b;return{type:"hittest",distance:c*a,position:[f,h]}};d.bind=function(a){const {context:b,attributeView:c}=a;
c.size&&(a=c.getBlock(E.ATTRIBUTE_DATA_GPGPU),D.isNone(a)||(a=a.getFBO(b),b.setViewport(0,0,c.size,c.size),b.bindFramebuffer(a),b.setColorMask(!0,!0,!0,!0),b.setClearColor(0,0,0,0),b.clear(b.gl.COLOR_BUFFER_BIT|b.gl.DEPTH_BUFFER_BIT)))};d.unbind=function(a){};d.draw=function(a){const {context:b,attributeView:c}=a;var f=c.getBlock(E.ATTRIBUTE_DATA_GPGPU);if(!D.isNone(this._outstanding))if(a=this._outstanding.resolver,D.isNone(f))a.resolve([]),this._outstanding=null;else{var h=f.getFBO(b);f=new Uint8Array(h.width*
h.height*4);h.readPixels(0,0,h.width,h.height,A.PixelFormat.RGBA,A.PixelType.UNSIGNED_BYTE,f);h=[];for(let p=0;p<f.length;p+=4){const k=f[p+3];f[p]&&h.push({id:p/4,directHits:k})}this._outstanding=null;h.sort((p,k)=>k.directHits===p.directHits?k.id-p.id:k.directHits-p.directHits);a.resolve(h.map(p=>p.id))}};return l}(C.Effect);q.HittestEffect=C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/HittestEffectVTL":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ./Effect ../../../../webgl/enums".split(" "),
function(q,t,D,E,C,A){C=function(n){function l(){var a=n.apply(this,arguments)||this;a.name=a.constructor.name;a.defines=["id"];a._lastSize=0;return a}t._inheritsLoose(l,n);var d=l.prototype;d.dispose=function(){D.isSome(this._fbo)&&this._fbo.dispose()};d.bind=function({context:a,painter:b}){const {width:c,height:f}=a.getViewport();this._boundFBO=a.getBoundFramebufferObject();b=b.getFbos(c,f).effect0;a.bindFramebuffer(b);a.setColorMask(!0,!0,!0,!0);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT)};
d.unbind=function({context:a}){a.bindFramebuffer(this._boundFBO);this._boundFBO=null};d.draw=function({context:a,state:b,pixelRatio:c},f,h=2*E.HITTEST_RADIUS){const p=a.getBoundFramebufferObject(),k=b.size[1]*c,e=Math.round(h*c),m=e/2,r=e/2;this._ensureBuffer(e);f.forEach((v,x)=>{var g=new Map;p.readPixels(Math.floor(x.x*c-e/2),Math.floor(k-x.y*c-e/2),e,e,A.PixelFormat.RGBA,A.PixelType.UNSIGNED_BYTE,this._buf);for(let z=0;z<this._buf32.length;z++){const w=this._buf32[z];if(4294967295!==w&&0!==w){var u=
z%e,y=e-Math.floor(z/e);u=(m-u)*(m-u)+(r-y)*(r-y);y=g.has(w)?g.get(w):4294967295;g.set(w,Math.min(u,y))}}g=Array.from(g).sort((z,w)=>z[1]-w[1]).map(z=>z[0]);v.resolve(g);f.delete(x)})};d._ensureBuffer=function(a){this._lastSize!==a&&(this._lastSize=a,this._buf=new Uint8Array(4*a*a),this._buf32=new Uint32Array(this._buf.buffer))};return l}(C.Effect);q.HittestEffectVTL=C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/post-processing/EffectManager":function(){define("exports ./Bloom ./Blur ./Colorize ./DropShadow ./Opacity".split(" "),
function(q,t,D,E,C,A){const n={colorize:()=>new E.Colorize,blur:()=>new D.Blur,bloom:()=>new t.Bloom,opacity:()=>new A.Opacity,"drop-shadow":()=>new C.DropShadow};let l=function(){function d(){this._effectMap=new Map}var a=d.prototype;a.dispose=function(){this._effectMap.forEach(b=>b.dispose());this._effectMap.clear()};a.getPostProcessingEffects=function(b){if(!b||0===b.length)return[];const c=[];for(const f of b){a:switch(b=f.type,b){case "bloom":case "blur":case "opacity":case "drop-shadow":break a;
default:b="colorize"}let h=this._effectMap.get(b);h||(h=n[b](),this._effectMap.set(b,h));c.push({postProcessingEffect:h,effect:f})}return c};return d}();q.EffectManager=l;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/post-processing/Bloom":function(){define(["exports","../../VertexStream","../../../../../webgl/enums","../../../../../webgl/FramebufferObject"],function(q,t,D,E){const C=[1,0],A=[0,1],n=[1,.8,.6,.4,.2],
l=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];let d=function(){function a(){this._compositeFBO=this._intensityFBO=null;this._mipsFBOs=Array(5);this._nMips=5;this._kernelSizeArray=[3,5,7,9,11];this._size=[0,0];this._programDesc={luminosityHighPass:{vsPath:"post-processing/pp",fsPath:"post-processing/bloom/luminosityHighPass",attributes:new Map([["a_position",0]])},gaussianBlur:{vsPath:"post-processing/pp",fsPath:"post-processing/bloom/gaussianBlur",attributes:new Map([["a_position",0]])},composite:{vsPath:"post-processing/pp",
fsPath:"post-processing/bloom/composite",attributes:new Map([["a_position",0]])},blit:{vsPath:"post-processing/pp",fsPath:"post-processing/blit",attributes:new Map([["a_position",0]])}}}var b=a.prototype;b.dispose=function(){this._quad&&(this._quad.dispose(),this._quad=null);this._intensityFBO&&(this._intensityFBO.dispose(),this._intensityFBO=null);this._compositeFBO&&(this._compositeFBO.dispose(),this._compositeFBO=null);if(this._mipsFBOs){for(let c=0;c<this._nMips;c++)this._mipsFBOs[c]&&(this._mipsFBOs[c].horizontal.dispose(),
this._mipsFBOs[c].vertical.dispose());this._mipsFBOs=null}};b.draw=function(c,f,h){const {width:p,height:k}=f,{context:e,painter:m}=c,{materialManager:r}=m;var v=e.gl;const x=this._programDesc,{strength:g,radius:u,threshold:y}=h;this._quad||(this._quad=new t(e,[-1,-1,1,-1,-1,1,1,1]));this._createOrResizeResources(c,p,k);e.setStencilTestEnabled(!1);e.setBlendingEnabled(!0);e.setBlendFunction(D.BlendFactor.ONE,D.BlendFactor.ONE_MINUS_SRC_ALPHA);e.setStencilWriteMask(0);c=this._quad;c.bind();e.bindFramebuffer(this._intensityFBO);
h=r.getProgram(x.luminosityHighPass);e.useProgram(h);e.bindTexture(f.colorTexture,0);h.setUniform1i("u_texture",0);h.setUniform3fv("u_defaultColor",[0,0,0]);h.setUniform1f("u_defaultOpacity",0);h.setUniform1f("u_luminosityThreshold",y);h.setUniform1f("u_smoothWidth",.01);h=[Math.round(p/2),Math.round(k/2)];e.setViewport(0,0,h[0],h[1]);e.setClearColor(0,0,0,0);e.clear(v.COLOR_BUFFER_BIT);c.draw();e.setBlendingEnabled(!1);v=this._intensityFBO.colorTexture;for(let z=0;z<this._nMips;z++){const w=r.getProgram(x.gaussianBlur,
[{name:"radius",value:this._kernelSizeArray[z]}]);e.useProgram(w);e.bindTexture(v,z+1);w.setUniform1i("u_colorTexture",z+1);w.setUniform2fv("u_texSize",h);w.setUniform2fv("u_direction",C);e.setViewport(0,0,h[0],h[1]);const B=this._mipsFBOs[z];e.bindFramebuffer(B.horizontal);c.draw();v=B.horizontal.colorTexture;e.bindFramebuffer(B.vertical);e.bindTexture(v,z+1);w.setUniform2fv("u_direction",A);c.draw();v=B.vertical.colorTexture;h[0]=Math.round(h[0]/2);h[1]=Math.round(h[1]/2)}e.setViewport(0,0,p,k);
h=r.getProgram(x.composite,[{name:"nummips",value:5}]);e.bindFramebuffer(this._compositeFBO);e.useProgram(h);h.setUniform1f("u_bloomStrength",g);h.setUniform1f("u_bloomRadius",u);h.setUniform1fv("u_bloomFactors",n);h.setUniform3fv("u_bloomTintColors",l);e.bindTexture(this._mipsFBOs[0].vertical.colorTexture,1);h.setUniform1i("u_blurTexture1",1);e.bindTexture(this._mipsFBOs[1].vertical.colorTexture,2);h.setUniform1i("u_blurTexture2",2);e.bindTexture(this._mipsFBOs[2].vertical.colorTexture,3);h.setUniform1i("u_blurTexture3",
3);e.bindTexture(this._mipsFBOs[3].vertical.colorTexture,4);h.setUniform1i("u_blurTexture4",4);e.bindTexture(this._mipsFBOs[4].vertical.colorTexture,5);h.setUniform1i("u_blurTexture5",5);c.draw();e.bindFramebuffer(f);e.setBlendingEnabled(!0);f=r.getProgram(x.blit);e.useProgram(f);e.bindTexture(this._compositeFBO.colorTexture,6);f.setUniform1i("u_texture",6);e.setBlendFunction(D.BlendFactor.ONE,D.BlendFactor.ONE);c.draw();c.unbind();e.setBlendFunction(D.BlendFactor.ONE,D.BlendFactor.ONE_MINUS_SRC_ALPHA);
e.setStencilTestEnabled(!0)};b._createOrResizeResources=function(c,f,h){({context:c}=c);if(!this._compositeFBO||this._size[0]!==f||this._size[1]!==h){this._size[0]=f;this._size[1]=h;var p=[Math.round(f/2),Math.round(h/2)];this._compositeFBO?this._compositeFBO.resize(f,h):this._compositeFBO=new E.FramebufferObject(c,{colorTarget:D.TargetType.TEXTURE,depthStencilTarget:D.DepthStencilTargetType.NONE,width:f,height:h});this._intensityFBO?this._intensityFBO.resize(p[0],p[1]):this._intensityFBO=new E.FramebufferObject(c,
{colorTarget:D.TargetType.TEXTURE,depthStencilTarget:D.DepthStencilTargetType.NONE,width:p[0],height:p[1]},{target:D.TextureType.TEXTURE_2D,pixelFormat:D.PixelFormat.RGBA,internalFormat:D.PixelFormat.RGBA,dataType:D.PixelType.UNSIGNED_BYTE,wrapMode:D.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:D.TextureSamplingMode.LINEAR,flipped:!1,width:p[0],height:p[1]});for(f=0;f<this._nMips;f++)this._mipsFBOs[f]?(this._mipsFBOs[f].horizontal.resize(p[0],p[1]),this._mipsFBOs[f].vertical.resize(p[0],p[1])):this._mipsFBOs[f]=
{horizontal:new E.FramebufferObject(c,{colorTarget:D.TargetType.TEXTURE,depthStencilTarget:D.DepthStencilTargetType.NONE,width:p[0],height:p[1]},{target:D.TextureType.TEXTURE_2D,pixelFormat:D.PixelFormat.RGBA,internalFormat:D.PixelFormat.RGBA,dataType:D.PixelType.UNSIGNED_BYTE,wrapMode:D.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:D.TextureSamplingMode.LINEAR,flipped:!1,width:p[0],height:p[1]}),vertical:new E.FramebufferObject(c,{colorTarget:D.TargetType.TEXTURE,depthStencilTarget:D.DepthStencilTargetType.NONE,
width:p[0],height:p[1]},{target:D.TextureType.TEXTURE_2D,pixelFormat:D.PixelFormat.RGBA,internalFormat:D.PixelFormat.RGBA,dataType:D.PixelType.UNSIGNED_BYTE,wrapMode:D.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:D.TextureSamplingMode.LINEAR,flipped:!1,width:p[0],height:p[1]})},p[0]=Math.round(p[0]/2),p[1]=Math.round(p[1]/2)}};return a}();q.Bloom=d;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/post-processing/Blur":function(){define(["exports",
"../../VertexStream","../../../../../webgl/enums","../../../../../webgl/FramebufferObject"],function(q,t,D,E){const C=[1,0],A=[0,1];let n=function(){function l(){this._blurFBO=null;this._size=[0,0];this._programDesc={gaussianBlur:{vsPath:"post-processing/pp",fsPath:"post-processing/blur/gaussianBlur",attributes:new Map([["a_position",0]])},radialBlur:{vsPath:"post-processing/pp",fsPath:"post-processing/blur/radial-blur",attributes:new Map([["a_position",0]])},blit:{vsPath:"post-processing/pp",fsPath:"post-processing/blit",
attributes:new Map([["a_position",0]])}}}var d=l.prototype;d.dispose=function(){this._blurFBO&&(this._blurFBO.dispose(),this._blurFBO=null)};d.draw=function(a,b,c){const {context:f}=a,{type:h,radius:p}=c;0!==p&&(this._createOrResizeResources(a),this._quad||(this._quad=new t(f,[-1,-1,1,-1,-1,1,1,1])),c=this._quad,c.bind(),"blur"===h?this._gaussianBlur(a,b,p):this._radialBlur(a,b),c.unbind())};d._gaussianBlur=function(a,b,c){const {context:f,state:h,painter:p,pixelRatio:k}=a;var {size:e}=h,{materialManager:m}=
p;a=this._quad;e=[Math.round(k*e[0]),Math.round(k*e[1])];const r=this._blurFBO;m=m.getProgram(this._programDesc.gaussianBlur,[{name:"radius",value:Math.ceil(c)}]);f.useProgram(m);f.setBlendingEnabled(!1);f.bindFramebuffer(r);f.bindTexture(b.colorTexture,4);m.setUniform1i("u_colorTexture",4);m.setUniform2fv("u_texSize",e);m.setUniform2fv("u_direction",C);m.setUniform1f("u_sigma",c);a.draw();f.bindFramebuffer(b);f.setStencilWriteMask(0);f.setStencilTestEnabled(!1);f.setDepthWriteEnabled(!1);f.setDepthTestEnabled(!1);
f.bindTexture(r.colorTexture,5);m.setUniform1i("u_colorTexture",5);m.setUniform2fv("u_direction",A);a.draw();f.setBlendingEnabled(!0);f.setBlendFunction(D.BlendFactor.ONE,D.BlendFactor.ONE_MINUS_SRC_ALPHA);f.setStencilTestEnabled(!0)};d._radialBlur=function(a,b){const {context:c,painter:f}=a,{materialManager:h}=f,p=this._programDesc;a=this._quad;const k=this._blurFBO;c.bindFramebuffer(k);const e=h.getProgram(p.radialBlur);c.useProgram(e);c.setBlendingEnabled(!1);c.bindTexture(b.colorTexture,4);e.setUniform1i("u_colorTexture",
4);a.draw();c.bindFramebuffer(b);c.setStencilWriteMask(0);c.setStencilTestEnabled(!1);c.setDepthWriteEnabled(!1);c.setDepthTestEnabled(!1);c.setBlendingEnabled(!0);b=h.getProgram(p.blit);c.useProgram(b);c.bindTexture(k.colorTexture,5);b.setUniform1i("u_texture",5);c.setBlendFunction(D.BlendFactor.ONE,D.BlendFactor.ONE_MINUS_SRC_ALPHA);a.draw()};d._createOrResizeResources=function(a){const {context:b,state:c,pixelRatio:f}=a;var {size:h}=c;a=Math.round(f*h[0]);h=Math.round(f*h[1]);this._blurFBO&&this._size[0]===
a&&this._size[1]===h||(this._size[0]=a,this._size[1]=h,this._blurFBO?this._blurFBO.resize(a,h):this._blurFBO=new E.FramebufferObject(b,{colorTarget:D.TargetType.TEXTURE,depthStencilTarget:D.DepthStencilTargetType.NONE,width:a,height:h},{target:D.TextureType.TEXTURE_2D,pixelFormat:D.PixelFormat.RGBA,internalFormat:D.PixelFormat.RGBA,dataType:D.PixelType.UNSIGNED_BYTE,wrapMode:D.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:D.TextureSamplingMode.LINEAR,flipped:!1,width:a,height:h}))};return l}();q.Blur=
n;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/post-processing/Colorize":function(){define(["exports","../../VertexStream","../../../../../webgl/enums","../../../../../webgl/Texture"],function(q,t,D,E){let C=function(){function A(){this._size=[0,0];this._programDesc={vsPath:"post-processing/pp",fsPath:"post-processing/filterEffect",attributes:new Map([["a_position",0]])}}var n=A.prototype;n.dispose=function(){this._layerFBOTexture&&
(this._layerFBOTexture.dispose(),this._layerFBOTexture=null)};n.draw=function(l,d,a){const {width:b,height:c}=d;this._createOrResizeResources(l,b,c);const {context:f,painter:h}=l,{materialManager:p}=h,k=this._programDesc;l=this._quad;a=a.colorMatrix;l.bind();const e=this._layerFBOTexture;f.bindFramebuffer(d);d.copyToTexture(0,0,b,c,0,0,e);f.setBlendingEnabled(!1);f.setStencilTestEnabled(!1);d=p.getProgram(k);f.useProgram(d);f.bindTexture(e,2);d.setUniformMatrix4fv("u_coefficients",a);d.setUniform1i("u_colorTexture",
2);l.draw();f.setBlendingEnabled(!0);f.setBlendFunction(D.BlendFactor.ONE,D.BlendFactor.ONE_MINUS_SRC_ALPHA);f.setStencilTestEnabled(!0);l.unbind()};n._createOrResizeResources=function(l,d,a){({context:l}=l);this._layerFBOTexture&&this._size[0]===d&&this._size[1]===a||(this._size[0]=d,this._size[1]=a,this._layerFBOTexture?this._layerFBOTexture.resize(d,a):this._layerFBOTexture=new E.Texture(l,{target:D.TextureType.TEXTURE_2D,pixelFormat:D.PixelFormat.RGBA,internalFormat:D.PixelFormat.RGBA,dataType:D.PixelType.UNSIGNED_BYTE,
wrapMode:D.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:D.TextureSamplingMode.LINEAR,flipped:!1,width:d,height:a}),this._quad||(this._quad=new t(l,[-1,-1,1,-1,-1,1,1,1])))};return A}();q.Colorize=C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/post-processing/DropShadow":function(){define("exports ../../../../../../core/screenUtils ../../VertexStream ../../../../../webgl/enums ../../../../../webgl/FramebufferObject ../../../../../webgl/Texture".split(" "),
function(q,t,D,E,C,A){const n=[1,0],l=[0,1];let d=function(){function a(){this._verticalBlurFBO=this._horizontalBlurFBO=null;this._size=[0,0];this._programDesc={blur:{vsPath:"post-processing/pp",fsPath:"post-processing/blur/gaussianBlur",attributes:new Map([["a_position",0]])},composite:{vsPath:"post-processing/pp",fsPath:"post-processing/drop-shadow/composite",attributes:new Map([["a_position",0]])},blit:{vsPath:"post-processing/pp",fsPath:"post-processing/blit",attributes:new Map([["a_position",
0]])}}}var b=a.prototype;b.dispose=function(){this._layerFBOTexture&&(this._layerFBOTexture.dispose(),this._layerFBOTexture=null);this._horizontalBlurFBO&&(this._horizontalBlurFBO.dispose(),this._horizontalBlurFBO=null);this._verticalBlurFBO&&(this._verticalBlurFBO.dispose(),this._verticalBlurFBO=null)};b.draw=function(c,f,h){const {context:p,state:k,painter:e}=c,{materialManager:m}=e,r=this._programDesc,v=f.width,x=f.height,g=[Math.round(v/2),Math.round(x/2)],{blurRadius:u,offsetX:y,offsetY:z,color:w}=
h;h=[t.pt2px(y/2),t.pt2px(z/2)];this._createOrResizeResources(c,v,x,g);const B=this._horizontalBlurFBO;c=this._verticalBlurFBO;p.setStencilWriteMask(0);p.setStencilTestEnabled(!1);p.setDepthWriteEnabled(!1);p.setDepthTestEnabled(!1);const F=this._layerFBOTexture;f.copyToTexture(0,0,v,x,0,0,F);this._quad||(this._quad=new D(p,[-1,-1,1,-1,-1,1,1,1]));p.setViewport(0,0,g[0],g[1]);const G=this._quad;G.bind();p.setBlendingEnabled(!1);const H=m.getProgram(r.blur,[{name:"radius",value:Math.ceil(u)}]);p.useProgram(H);
p.bindFramebuffer(B);p.bindTexture(f.colorTexture,4);H.setUniform1i("u_colorTexture",4);H.setUniform2fv("u_texSize",g);H.setUniform2fv("u_direction",n);H.setUniform1f("u_sigma",u);G.draw();p.bindFramebuffer(c);p.bindTexture(B.colorTexture,5);H.setUniform1i("u_colorTexture",5);H.setUniform2fv("u_direction",l);G.draw();p.bindFramebuffer(f);p.setViewport(0,0,v,x);f=m.getProgram(r.composite);p.useProgram(f);p.bindTexture(c.colorTexture,2);f.setUniform1i("u_blurTexture",2);p.bindTexture(F,3);f.setUniform1i("u_layerFBOTexture",
3);f.setUniform4fv("u_shadowColor",[w[0]/255*w[3],w[1]/255*w[3],w[2]/255*w[3],w[3]]);f.setUniformMatrix3fv("u_displayViewMat3",k.displayMat3);f.setUniform2fv("u_shadowOffset",h);G.draw();p.setBlendingEnabled(!0);p.setStencilTestEnabled(!0);p.setBlendFunction(E.BlendFactor.ONE,E.BlendFactor.ONE_MINUS_SRC_ALPHA);G.unbind()};b._createOrResizeResources=function(c,f,h,p){({context:c}=c);this._horizontalBlurFBO&&this._size[0]===f&&this._size[1]===h||(this._size[0]=f,this._size[1]=h,this._horizontalBlurFBO?
this._horizontalBlurFBO.resize(p[0],p[1]):this._horizontalBlurFBO=new C.FramebufferObject(c,{colorTarget:E.TargetType.TEXTURE,depthStencilTarget:E.DepthStencilTargetType.NONE,width:p[0],height:p[1]},{target:E.TextureType.TEXTURE_2D,pixelFormat:E.PixelFormat.RGBA,internalFormat:E.PixelFormat.RGBA,dataType:E.PixelType.UNSIGNED_BYTE,wrapMode:E.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:E.TextureSamplingMode.LINEAR,flipped:!1,width:p[0],height:p[1]}),this._verticalBlurFBO?this._verticalBlurFBO.resize(p[0],
p[1]):this._verticalBlurFBO=new C.FramebufferObject(c,{colorTarget:E.TargetType.TEXTURE,depthStencilTarget:E.DepthStencilTargetType.NONE,width:p[0],height:p[1]},{target:E.TextureType.TEXTURE_2D,pixelFormat:E.PixelFormat.RGBA,internalFormat:E.PixelFormat.RGBA,dataType:E.PixelType.UNSIGNED_BYTE,wrapMode:E.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:E.TextureSamplingMode.LINEAR,flipped:!1,width:p[0],height:p[1]}),this._layerFBOTexture?this._layerFBOTexture.resize(f,h):this._layerFBOTexture=new A.Texture(c,
{target:E.TextureType.TEXTURE_2D,pixelFormat:E.PixelFormat.RGBA,internalFormat:E.PixelFormat.RGBA,dataType:E.PixelType.UNSIGNED_BYTE,wrapMode:E.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:E.TextureSamplingMode.LINEAR,flipped:!1,width:f,height:h}))};return a}();q.DropShadow=d;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/post-processing/Opacity":function(){define(["exports","../../../../../webgl/enums","../../../../../webgl/Texture"],
function(q,t,D){let E=function(){function C(){this._size=[0,0]}var A=C.prototype;A.dispose=function(){this._layerFBOTexture&&(this._layerFBOTexture.dispose(),this._layerFBOTexture=null)};A.draw=function(n,l,d){const {width:a,height:b}=l;this._createOrResizeResources(n,a,b);const {context:c,painter:f}=n;({amount:n}=d);d=c.gl;const h=this._layerFBOTexture;c.bindFramebuffer(l);l.copyToTexture(0,0,a,b,0,0,h);c.setBlendingEnabled(!0);c.setStencilTestEnabled(!1);c.setDepthTestEnabled(!1);c.setClearColor(0,
0,0,0);c.clear(d.COLOR_BUFFER_BIT);f.blitTexture(c,h,t.TextureSamplingMode.NEAREST,n)};A._createOrResizeResources=function(n,l,d){({context:n}=n);this._layerFBOTexture&&this._size[0]===l&&this._size[1]===d||(this._size[0]=l,this._size[1]=d,this._layerFBOTexture?this._layerFBOTexture.resize(l,d):this._layerFBOTexture=new D.Texture(n,{target:t.TextureType.TEXTURE_2D,pixelFormat:t.PixelFormat.RGBA,internalFormat:t.PixelFormat.RGBA,dataType:t.PixelType.UNSIGNED_BYTE,wrapMode:t.TextureWrapMode.CLAMP_TO_EDGE,
samplingMode:t.TextureSamplingMode.NEAREST,flipped:!1,width:l,height:d}))};return C}();q.Opacity=E;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/painter/RenderPass":function(){define(["../../../../../core/arrayUtils","../../../../../core/maybe","../enums"],function(q,t,D){return function(){function E(A,n){var l;this.brushes=A;this.name=n.name;this.drawPhase=n.drawPhase||D.WGLDrawPhase.MAP;this._targetFn=n.target;this.effects=
n.effects||[];this.enableDefaultDraw=null!=(l=n.enableDefaultDraw)?l:()=>!0}var C=E.prototype;C.render=function(A){const {context:n,profiler:l}=A,d=this._targetFn();var a=this.drawPhase&A.drawPhase;l.recordPassStart(this.name);if(a){this.enableDefaultDraw()&&this._doRender(A,d);l.recordPassEnd();for(const b of this.effects){if(!b.enable())continue;a=b.apply;l.recordPassStart(this.name+"."+a.name);l.recordBrushStart(a.name);const c=b.args&&b.args(),{x:f,y:h,width:p,height:k}=n.getViewport(),e=n.getBoundFramebufferObject();
a.bind(A,c);const m=a.createOptions(A,c),r=A.passOptions;A.passOptions=m;this._doRender(A,d,a.defines);A.passOptions=r;a.draw(A,c);a.unbind(A,c);n.bindFramebuffer(e);n.setViewport(f,h,p,k);l.recordBrushEnd();l.recordPassEnd()}}};C._doRender=function(A,n,l){if(!t.isNone(n))if(q.isArrayLike(n))for(const d of n){if(d.visible)for(const a of this.brushes)A.profiler.recordBrushStart(a.name),a.prepareState(A,d,l),a.draw(A,d,l),A.profiler.recordBrushEnd()}else for(const d of this.brushes)A.profiler.recordBrushStart(d.name),
d.prepareState(A,n,l),d.draw(A,n,l),A.profiler.recordBrushEnd()};return E}()})},"esri/views/2d/engine/webgl/Profiler":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/CircularArray ../../../../core/Evented ../../../../core/has ../../../../core/maybe ../../../webgl/capabilities/DisjointTimerQuery".split(" "),function(q,t,D,E,C,A,n){const l=C("esri-2d-profiler");C=function(){function d(b,c){this._events=new E;this._entries=new Map;this._timings=new D(10);if(l){this._ext=
n.createDisjointTimerQuery(b.gl,{});this._debugOutput=c;var f=b.gl;if(this.enableCommandLogging)for(const h in f)if("function"===typeof f[h]){const p=f[h],k=h.includes("draw");f[h]=(...e)=>{this._events.emit("command",{container:this._currentContainer,pass:this._currentPass,brush:this._currentBrush,method:h,args:e,isDrawCommand:k});this._currentSummary&&(this._currentSummary.commands++,k&&this._currentSummary.drawCommands++);return p.apply(f,e)}}}}var a=d.prototype;a.recordContainerStart=function(b){l&&
(this._currentContainer=b)};a.recordContainerEnd=function(){l&&(this._currentContainer=null)};a.recordPassStart=function(b){l&&(this._currentPass=b,this._initSummary())};a.recordPassEnd=function(){l&&(this._currentPass=null,this._emitSummary())};a.recordBrushStart=function(b){l&&(this._currentBrush=b)};a.recordBrushEnd=function(){l&&(this._currentBrush=null)};a.recordStart=function(b){if(l&&A.isSome(this._ext)){if(this._entries.has(b)){const k=this._entries.get(b);var c=this._ext.resultAvailable(k.query),
f=this._ext.disjoint();if(c&&!f){c=this._ext.getResult(k.query)/1E6;f=0;if(A.isSome(this._timings.enqueue(c))){f=this._timings.entries;const e=f.length;let m=0;for(var h of f)m+=h;f=m/e}h=c.toFixed(2);c=f?f.toFixed(2):"--";this.enableCommandLogging?(console.groupCollapsed(`Frame report for ${b}, ${h} ms (${c} last 10 avg)\n${k.commandsLen} Commands (${k.drawCommands} draw)`),console.log("RenderPass breakdown: "),console.table(k.summaries),console.log("Commands: ",k.commands),console.groupEnd()):console.log(`Frame report for ${b}, ${h} ms (${c} last 10 avg)`);
this._debugOutput.innerHTML=`${h} (${c})`}for(const e of k.handles)e.remove();this._entries.delete(b)}const p={name:b,query:this._ext.createQuery(),commands:[],commandsLen:0,drawCommands:0,summaries:[],handles:[]};this.enableCommandLogging&&(p.handles.push(this._events.on("command",k=>{p.commandsLen++;p.commands.push(k);k.isDrawCommand&&p.drawCommands++})),p.handles.push(this._events.on("summary",k=>{p.summaries.push(k)})));this._ext.beginTimeElapsed(p.query);this._entries.set(b,p)}};a.recordEnd=
function(b){l&&A.isSome(this._ext)&&this._entries.has(b)&&this._ext.endTimeElapsed()};a._initSummary=function(){this.enableCommandLogging&&(this._currentSummary={container:this._currentContainer,pass:this._currentPass,drawCommands:0,commands:0})};a._emitSummary=function(){this.enableCommandLogging&&this._events.emit("summary",this._currentSummary)};t._createClass(d,[{key:"enableCommandLogging",get:function(){return!("object"===typeof l&&l.disableCommands)}}]);return d}();q.Profiler=C;Object.defineProperties(q,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/CircularArray":function(){define(["../chunks/_rollupPluginBabelHelpers","./maybe"],function(q,t){return function(){function D(C){this._start=this.size=0;this.maxSize=C;this._buffer=Array(C)}var E=D.prototype;E.enqueue=function(C){if(this.size===this.maxSize){const A=this._buffer[this._start];this._buffer[this._start]=C;this._start=(this._start+1)%this.maxSize;return A}this._buffer[(this._start+this.size++)%this.maxSize]=
C;return null};E.dequeue=function(){if(0===this.size)return null;const C=this._buffer[this._start];this._buffer[this._start]=null;this.size--;this._start=(this._start+1)%this.maxSize;return C};E.peek=function(){return 0===this.size?null:this._buffer[this._start]};E.find=function(C){if(0===this.size)return null;for(const A of this._buffer)if(t.isSome(A)&&C(A))return A;return null};E.clear=function(C){let A=this.dequeue();for(;t.isSome(A);)C&&C(A),A=this.dequeue()};q._createClass(D,[{key:"entries",
get:function(){return this._buffer}}]);return D}()})},"esri/views/webgl/capabilities/DisjointTimerQuery":function(){define(["exports","./isWebGL2Context"],function(q,t){let D=function(E,C,A,n,l,d,a,b){this.createQuery=E;this.resultAvailable=C;this.getResult=A;this.disjoint=n;this.beginTimeElapsed=l;this.endTimeElapsed=d;this.createTimestamp=a;this.timestampBits=b};q.DisjointTimerQuery=D;q.createDisjointTimerQuery=function(E,C){if(C.disjointTimerQuery)return null;let A=E.getExtension("EXT_disjoint_timer_query_webgl2");
return A&&t(E)?new D(()=>E.createQuery(),n=>E.getQueryParameter(n,E.QUERY_RESULT_AVAILABLE),n=>E.getQueryParameter(n,E.QUERY_RESULT),()=>E.getParameter(A.GPU_DISJOINT_EXT),n=>E.beginQuery(A.TIME_ELAPSED_EXT,n),()=>E.endQuery(A.TIME_ELAPSED_EXT),n=>A.queryCounterEXT(n,A.TIMESTAMP_EXT),()=>E.getQuery(A.TIMESTAMP_EXT,A.QUERY_COUNTER_BITS_EXT)):(A=E.getExtension("EXT_disjoint_timer_query"))?new D(()=>A.createQueryEXT(),n=>A.getQueryObjectEXT(n,A.QUERY_RESULT_AVAILABLE_EXT),n=>A.getQueryObjectEXT(n,A.QUERY_RESULT_EXT),
()=>E.getParameter(A.GPU_DISJOINT_EXT),n=>A.beginQueryEXT(A.TIME_ELAPSED_EXT,n),()=>A.endQueryEXT(A.TIME_ELAPSED_EXT),n=>A.queryCounterEXT(n,A.TIMESTAMP_EXT),()=>A.getQueryEXT(A.TIMESTAMP_EXT,A.QUERY_COUNTER_BITS_EXT)):null};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/RenderingContext":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/maybe ../../core/promiseUtils ../../core/time ./checkWebGLError ./context-util ./ContextState ./enums ./InstanceCounter ./ProgramCache ./renderState ./Texture ./Util ./WebGLDriverTest ./capabilities/Capabilities ./capabilities/isWebGL2Context".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c,f,h,p,k,e){function m(x,g,u,y){g?y!==g&&x.bindBuffer(u,g.glName):x.bindBuffer(u,null);return g}function r(x,g){switch(x){case d.PrimitiveType.POINTS:return 2*g;case d.PrimitiveType.TRIANGLES:return g/3;case d.PrimitiveType.TRIANGLE_STRIP:return g-2;case d.PrimitiveType.TRIANGLE_FAN:return g-2;default:return 0}}let v=function(){function x(u,y){this.gl=u;this.instanceCounter=new a.InstanceCounter;this.programCache=new b.ProgramCache(this);this._state=new l.ContextState;
this._numOfTriangles=this._numOfDrawCalls=0;this.type=e(u)?n.ContextType.WEBGL2:n.ContextType.WEBGL1;this._loadExtensions();this.configure(y)}var g=x.prototype;g.configure=function(u){this._capabilities=new k.Capabilities(this.gl,u);this._parameters=this._loadParameters(u);u=this.gl.getParameter(this.gl.VIEWPORT);this._state=new l.ContextState;this._state.viewport={x:u[0],y:u[1],width:u[2],height:u[3]};this._stateTracker=new c.StateTracker({setBlending:y=>{y?(this.setBlendingEnabled(!0),this.setBlendEquationSeparate(y.opRgb,
y.opAlpha),this.setBlendFunctionSeparate(y.srcRgb,y.dstRgb,y.srcAlpha,y.dstAlpha),y=y.color,this.setBlendColor(y.r,y.g,y.b,y.a)):this.setBlendingEnabled(!1)},setCulling:y=>{y?(this.setFaceCullingEnabled(!0),this.setCullFace(y.face),this.setFrontFace(y.mode)):this.setFaceCullingEnabled(!1)},setPolygonOffset:y=>{y?(this.setPolygonOffsetFillEnabled(!0),this.setPolygonOffset(y.factor,y.units)):this.setPolygonOffsetFillEnabled(!1)},setDepthTest:y=>{y?(this.setDepthTestEnabled(!0),this.setDepthFunction(y.func)):
this.setDepthTestEnabled(!1)},setStencilTest:y=>{if(y){this.setStencilTestEnabled(!0);const z=y.function;this.setStencilFunction(z.func,z.ref,z.mask);y=y.operation;this.setStencilOp(y.fail,y.zFail,y.zPass)}else this.setStencilTestEnabled(!1)},setDepthWrite:y=>{y?(this.setDepthWriteEnabled(!0),this.setDepthRange(y.zNear,y.zFar)):this.setDepthWriteEnabled(!1)},setColorWrite:y=>{y?this.setColorMask(y.r,y.g,y.b,y.a):this.setColorMask(!1,!1,!1,!1)},setStencilWrite:y=>{y?this.setStencilWriteMask(y.mask):
this.setStencilWriteMask(0)}});this.enforceState();this._driverTest=new p.WebGLDriverTest(this)};g.dispose=function(){this.programCache.dispose();this.bindVAO(null);this.unbindBuffer(d.BufferType.ARRAY_BUFFER);this.unbindBuffer(d.BufferType.ELEMENT_ARRAY_BUFFER);e(this.gl)&&(this.unbindBuffer(d.BufferType.UNIFORM_BUFFER),this._state.uniformBufferBindingPoints.length=0,this.unbindBuffer(d.BufferType.PIXEL_PACK_BUFFER),this.unbindBuffer(d.BufferType.PIXEL_UNPACK_BUFFER),this.unbindBuffer(d.BufferType.COPY_READ_BUFFER),
this.unbindBuffer(d.BufferType.COPY_WRITE_BUFFER));this._state.textureUnitMap.length=0;A.webglDebugEnabled()&&this.instanceCounter.printResourceCount()};g.setPipelineState=function(u){this._stateTracker.setPipeline(u)};g.setBlendingEnabled=function(u){this._state.blend!==u&&(!0===u?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._state.blend=u,this._stateTracker.invalidateBlending())};g.externalProgramUpdate=function(){var u;null==(u=this._state.program)?void 0:u.stop();this._state.program=
null};g.externalTextureUnitUpdate=function(u,y){for(let z=0;z<u.length;++z)this._state.textureUnitMap[u[z]]=null;0<=y&&(this._state.activeTexture=y)};g.externalVertexArrayObjectUpdate=function(){const u=this.capabilities.vao;u&&(u.bindVertexArray(null),this._state.vertexArrayObject=null);this._state.vertexBuffer=null;this._state.indexBuffer=null};g.externalVertexBufferUpdate=function(){this._state.vertexBuffer=null};g.externalIndexBufferUpdate=function(){this._state.indexBuffer=null};g.setBlendColor=
function(u,y,z,w){if(u!==this._state.blendColor.r||y!==this._state.blendColor.g||z!==this._state.blendColor.b||w!==this._state.blendColor.a)this.gl.blendColor(u,y,z,w),this._state.blendColor.r=u,this._state.blendColor.g=y,this._state.blendColor.b=z,this._state.blendColor.a=w,this._stateTracker.invalidateBlending()};g.setBlendFunction=function(u,y){if(u!==this._state.blendFunction.srcRGB||y!==this._state.blendFunction.dstRGB)this.gl.blendFunc(u,y),this._state.blendFunction.srcRGB=u,this._state.blendFunction.srcAlpha=
u,this._state.blendFunction.dstRGB=y,this._state.blendFunction.dstAlpha=y,this._stateTracker.invalidateBlending()};g.setBlendFunctionSeparate=function(u,y,z,w){if(this._state.blendFunction.srcRGB!==u||this._state.blendFunction.srcAlpha!==z||this._state.blendFunction.dstRGB!==y||this._state.blendFunction.dstAlpha!==w)this.gl.blendFuncSeparate(u,y,z,w),this._state.blendFunction.srcRGB=u,this._state.blendFunction.srcAlpha=z,this._state.blendFunction.dstRGB=y,this._state.blendFunction.dstAlpha=w,this._stateTracker.invalidateBlending()};
g.setBlendEquation=function(u){this._state.blendEquation.mode!==u&&(this.gl.blendEquation(u),this._state.blendEquation.mode=u,this._state.blendEquation.modeAlpha=u,this._stateTracker.invalidateBlending())};g.setBlendEquationSeparate=function(u,y){if(this._state.blendEquation.mode!==u||this._state.blendEquation.modeAlpha!==y)this.gl.blendEquationSeparate(u,y),this._state.blendEquation.mode=u,this._state.blendEquation.modeAlpha=y,this._stateTracker.invalidateBlending()};g.setColorMask=function(u,y,
z,w){if(this._state.colorMask.r!==u||this._state.colorMask.g!==y||this._state.colorMask.b!==z||this._state.colorMask.a!==w)this.gl.colorMask(u,y,z,w),this._state.colorMask.r=u,this._state.colorMask.g=y,this._state.colorMask.b=z,this._state.colorMask.a=w,this._stateTracker.invalidateColorWrite()};g.setClearColor=function(u,y,z,w){if(this._state.clearColor.r!==u||this._state.clearColor.g!==y||this._state.clearColor.b!==z||this._state.clearColor.a!==w)this.gl.clearColor(u,y,z,w),this._state.clearColor.r=
u,this._state.clearColor.g=y,this._state.clearColor.b=z,this._state.clearColor.a=w};g.setFaceCullingEnabled=function(u){this._state.faceCulling!==u&&(!0===u?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._state.faceCulling=u,this._stateTracker.invalidateCulling())};g.setPolygonOffsetFillEnabled=function(u){this._state.polygonOffsetFill!==u&&(!0===u?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._state.polygonOffsetFill=u,this._stateTracker.invalidatePolygonOffset())};
g.setPolygonOffset=function(u,y){if(this._state.polygonOffset[0]!==u||this._state.polygonOffset[1]!==y)this._state.polygonOffset[0]=u,this._state.polygonOffset[1]=y,this.gl.polygonOffset(u,y),this._stateTracker.invalidatePolygonOffset()};g.setCullFace=function(u){this._state.cullFace!==u&&(this.gl.cullFace(u),this._state.cullFace=u,this._stateTracker.invalidateCulling())};g.setFrontFace=function(u){this._state.frontFace!==u&&(this.gl.frontFace(u),this._state.frontFace=u,this._stateTracker.invalidateCulling())};
g.setScissorTestEnabled=function(u){this._state.scissorTest!==u&&(!0===u?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this._state.scissorTest=u)};g.setScissorRect=function(u,y,z,w){if(this._state.scissorRect.x!==u||this._state.scissorRect.y!==y||this._state.scissorRect.width!==z||this._state.scissorRect.height!==w)this.gl.scissor(u,y,z,w),this._state.scissorRect.x=u,this._state.scissorRect.y=y,this._state.scissorRect.width=z,this._state.scissorRect.height=w};g.setDepthTestEnabled=
function(u){this._state.depthTest!==u&&(!0===u?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this._state.depthTest=u,this._stateTracker.invalidateDepthTest())};g.setClearDepth=function(u){this._state.clearDepth!==u&&(this.gl.clearDepth(u),this._state.clearDepth=u)};g.setDepthFunction=function(u){this._state.depthFunction!==u&&(this.gl.depthFunc(u),this._state.depthFunction=u,this._stateTracker.invalidateDepthTest())};g.setDepthWriteEnabled=function(u){this._state.depthWrite!==
u&&(this.gl.depthMask(u),this._state.depthWrite=u,this._stateTracker.invalidateDepthWrite())};g.setDepthRange=function(u,y){if(this._state.depthRange.zNear!==u||this._state.depthRange.zFar!==y)this.gl.depthRange(u,y),this._state.depthRange.zNear=u,this._state.depthRange.zFar=y,this._stateTracker.invalidateDepthWrite()};g.setStencilTestEnabled=function(u){this._state.stencilTest!==u&&(!0===u?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),this._state.stencilTest=u,this._stateTracker.invalidateStencilTest())};
g.setClearStencil=function(u){u!==this._state.clearStencil&&(this.gl.clearStencil(u),this._state.clearStencil=u)};g.setStencilFunction=function(u,y,z){if(this._state.stencilFunction.func!==u||this._state.stencilFunction.ref!==y||this._state.stencilFunction.mask!==z)this.gl.stencilFunc(u,y,z),this._state.stencilFunction.face=d.Face.FRONT_AND_BACK,this._state.stencilFunction.func=u,this._state.stencilFunction.ref=y,this._state.stencilFunction.mask=z,this._stateTracker.invalidateStencilTest()};g.setStencilFunctionSeparate=
function(u,y,z,w){if(this._state.stencilFunction.face!==u||this._state.stencilFunction.func!==y||this._state.stencilFunction.ref!==z||this._state.stencilFunction.mask!==w)this.gl.stencilFuncSeparate(u,y,z,w),this._state.stencilFunction.face=u,this._state.stencilFunction.func=y,this._state.stencilFunction.ref=z,this._state.stencilFunction.mask=w,this._stateTracker.invalidateStencilTest()};g.setStencilWriteMask=function(u){this._state.stencilWriteMask!==u&&(this.gl.stencilMask(u),this._state.stencilWriteMask=
u,this._stateTracker.invalidateStencilWrite())};g.setStencilOp=function(u,y,z){if(this._state.stencilOperation.face!==d.Face.FRONT_AND_BACK||this._state.stencilOperation.fail!==u||this._state.stencilOperation.zFail!==y||this._state.stencilOperation.zPass!==z)this.gl.stencilOp(u,y,z),this._state.stencilOperation.face=d.Face.FRONT_AND_BACK,this._state.stencilOperation.fail=u,this._state.stencilOperation.zFail=y,this._state.stencilOperation.zPass=z,this._stateTracker.invalidateStencilTest()};g.setStencilOpSeparate=
function(u,y,z,w){if(this._state.stencilOperation.face!==u||this._state.stencilOperation.fail!==y||this._state.stencilOperation.zFail!==z||this._state.stencilOperation.zPass!==w)this.gl.stencilOpSeparate(u,y,z,w),this._state.stencilOperation.face=u,this._state.stencilOperation.fail=y,this._state.stencilOperation.zFail=z,this._state.stencilOperation.zPass=w,this._stateTracker.invalidateStencilTest()};g.setActiveTexture=function(u,y=!1){const z=this._state.activeTexture;0<=u&&(y||u!==this._state.activeTexture)&&
(this.gl.activeTexture(d.BASE_TEXTURE_UNIT+u),this._state.activeTexture=u);return z};g.clear=function(u){u&&this.gl.clear(u)};g.clearSafe=function(u,y=255){u&&(u&d.ClearBufferBit.COLOR_BUFFER_BIT&&this.setColorMask(!0,!0,!0,!0),u&d.ClearBufferBit.DEPTH_BUFFER_BIT&&this.setDepthWriteEnabled(!0),u&d.ClearBufferBit.STENCIL_BUFFER_BIT&&this.setStencilWriteMask(y),this.gl.clear(u))};g.drawArrays=function(u,y,z){A.webglDebugEnabled()&&(this._numOfDrawCalls++,this._numOfTriangles+=r(u,z));this.gl.drawArrays(u,
y,z);A.webglDebugEnabled()&&(u=h.getErrorString(this))&&console.error("drawArrays:",u)};g.drawElements=function(u,y,z,w){A.webglDebugEnabled()&&(this._numOfDrawCalls++,this._numOfTriangles+=r(u,y));this.gl.drawElements(u,y,z,w);if(A.webglDebugEnabled()){const H=h.getErrorString(this);if(H){var B,F=this.getBoundVAO(),G=null==F?void 0:F.indexBuffer;F={indexBuffer:G,vertexBuffers:null==F?void 0:F.vertexBuffers};u={mode:u,count:y,type:z,offset:w};G=null!=(B=D.applySome(G,I=>I.size))?B:0;y=w+y;console.error(`drawElements: ${H}${G<
y?`. Buffer is too small. Attempted to draw index ${y} of ${G}`:""}`,{args:u,vao:F})}}};g.logInfo=function(){A.webglDebugEnabled()&&console.log(`DrawCalls: ${this._numOfDrawCalls}, Triangles: ${this._numOfTriangles}`)};g.resetInfo=function(){A.webglDebugEnabled()&&(this._numOfTriangles=this._numOfDrawCalls=0)};g.setViewport=function(u,y,z,w){z=Math.max(Math.round(z),1);w=Math.max(Math.round(w),1);const B=this._state.viewport;if(B.x!==u||B.y!==y||B.width!==z||B.height!==w)B.x=u,B.y=y,B.width=z,B.height=
w,this.gl.viewport(u,y,z,w)};g.getViewport=function(){return{x:this._state.viewport.x,y:this._state.viewport.y,width:this._state.viewport.width,height:this._state.viewport.height}};g.useProgram=function(u){var y,z;this._state.program!==u&&(null==(y=this._state.program)?void 0:y.stop(),this._state.program=u,this.gl.useProgram(null!=(z=null==u?void 0:u.glName)?z:null))};g.bindTexture=function(u,y,z=!1){(y>=this.parameters.maxTextureImageUnits||0>y)&&console.error("Input texture unit is out of range of available units!");
const w=this._state.textureUnitMap[y];if(D.isNone(u)||null==u.glName)return D.isSome(w)&&(this.setActiveTexture(y,z),this.gl.bindTexture(w.descriptor.target,null)),this._state.textureUnitMap[y]=null,w;if(!z&&w===u)return u.isDirty&&(this.setActiveTexture(y,z),u.applyChanges()),w;this.setActiveTexture(y,z);this.gl.bindTexture(u.descriptor.target,u.glName);u.applyChanges();this._state.textureUnitMap[y]=u;return w};g.unbindTexture=function(u){if(!D.isNone(u))for(let y=0;y<this.parameters.maxTextureImageUnits;y++)this._state.textureUnitMap[y]===
u&&(this.bindTexture(null,y),this._state.textureUnitMap[y]=null)};g.bindFramebuffer=function(u,y=!1){if(y||this._state.readFramebuffer!==u||this._state.drawFramebuffer!==u)D.isNone(u)?(this.gl.bindFramebuffer(d.FramebufferTarget.FRAMEBUFFER,null),this._state.readFramebuffer=null,this._state.drawFramebuffer=null):(u.initializeAndBind(d.FramebufferTarget.FRAMEBUFFER),this._state.readFramebuffer=u,this._state.drawFramebuffer=u)};g.bindFramebufferSeparate=function(u,y,z=!1){const w=y===d.FramebufferTarget.READ_FRAMEBUFFER,
B=w?this._state.readFramebuffer:this._state.drawFramebuffer;if(z||B!==u)D.isNone(u)?this.gl.bindFramebuffer(y,null):u.initializeAndBind(y),w?this._state.readFramebuffer=D.unwrapOr(u,null):this._state.drawFramebuffer=D.unwrapOr(u,null)};g.blitFramebuffer=function(u,y,z=0,w=0,B=u.width,F=u.height,G=0,H=0,I=y.width,L=y.height,N=d.ClearBufferBit.COLOR_BUFFER_BIT,J=d.TextureSamplingMode.NEAREST){this.bindFramebufferSeparate(u,d.FramebufferTarget.READ_FRAMEBUFFER);this.bindFramebufferSeparate(y,d.FramebufferTarget.DRAW_FRAMEBUFFER);
this.gl.blitFramebuffer(z,w,B,F,G,H,I,L,N,J)};g.bindBuffer=function(u,y){if(u){var z;null!=(z=y)?z:y=u.bufferType;switch(y){case d.BufferType.ARRAY_BUFFER:this._state.vertexBuffer=m(this.gl,u,y,this._state.vertexBuffer);break;case d.BufferType.ELEMENT_ARRAY_BUFFER:this._state.indexBuffer=m(this.gl,u,y,this._state.indexBuffer);break;case d.BufferType.UNIFORM_BUFFER:this._state.uniformBuffer=m(this.gl,u,y,this._state.uniformBuffer);break;case d.BufferType.PIXEL_PACK_BUFFER:this._state.pixelPackBuffer=
m(this.gl,u,y,this._state.pixelPackBuffer);break;case d.BufferType.PIXEL_UNPACK_BUFFER:this._state.pixelUnpackBuffer=m(this.gl,u,y,this._state.pixelUnpackBuffer);break;case d.BufferType.COPY_READ_BUFFER:this._state.copyReadBuffer=m(this.gl,u,y,this._state.copyReadBuffer);break;case d.BufferType.COPY_WRITE_BUFFER:this._state.copyWriteBuffer=m(this.gl,u,y,this._state.copyWriteBuffer)}}};g.bindRenderbuffer=function(u){const y=this.gl;u||(y.bindRenderbuffer(y.RENDERBUFFER,null),this._state.renderbuffer=
null);this._state.renderbuffer!==u&&(y.bindRenderbuffer(y.RENDERBUFFER,u.glName),this._state.renderbuffer=u)};g._getBufferBinding=function(u,y){if(y>=this.parameters.maxUniformBufferBindings||0>y)return console.error("Uniform buffer binding point is out of range!"),null;u=this._state.uniformBufferBindingPoints;let z=u[y];D.isNone(z)&&(z={buffer:null,offset:0,size:0},u[y]=z);return z};g.bindBufferBase=function(u,y,z){const w=this._getBufferBinding(u,y);D.isNone(w)||w.buffer===z&&0===w.offset&&0===
w.size||(this.gl.bindBufferBase(u,y,z?z.glName:null),w.buffer=z,w.offset=0,w.size=0)};g.bindBufferRange=function(u,y,z,w,B){const F=this._getBufferBinding(u,y);D.isNone(F)||F.buffer===z&&F.offset===w&&F.size===B||(0!==w%this._parameters.uniformBufferOffsetAlignment?console.error("Uniform buffer binding offset is not a multiple of the context offset alignment"):(this.gl.bindBufferRange(u,y,z.glName,w,B),F.buffer=z,F.offset=w,F.size=B))};g.bindUBO=function(u,y,z,w){D.isNone(y)?this.bindBufferBase(d.BufferType.UNIFORM_BUFFER,
u,null):(A.webglDebugEnabled()&&(null!=w?w:y.byteLength)>this._parameters.maxUniformBlockSize&&console.error("Attempting to bind more data than the maximum uniform block size"),y.initialize(),void 0!==z&&void 0!==w?this.bindBufferRange(d.BufferType.UNIFORM_BUFFER,u,y.buffer,z,w):this.bindBufferBase(d.BufferType.UNIFORM_BUFFER,u,y.buffer))};g.unbindUBO=function(u){for(let y=0,z=this._state.uniformBufferBindingPoints.length;y<z;y++){const w=this._state.uniformBufferBindingPoints[y];D.isSome(w)&&w.buffer===
u.buffer&&this.bindBufferBase(d.BufferType.UNIFORM_BUFFER,y,null)}};g.unbindBuffer=function(u){switch(u){case d.BufferType.ARRAY_BUFFER:this._state.vertexBuffer=m(this.gl,null,u,this._state.vertexBuffer);break;case d.BufferType.ELEMENT_ARRAY_BUFFER:this._state.indexBuffer=m(this.gl,null,u,this._state.indexBuffer);break;case d.BufferType.UNIFORM_BUFFER:this._state.uniformBuffer=m(this.gl,null,u,this._state.uniformBuffer);break;case d.BufferType.PIXEL_PACK_BUFFER:this._state.pixelPackBuffer=m(this.gl,
null,u,this._state.pixelPackBuffer);break;case d.BufferType.PIXEL_UNPACK_BUFFER:this._state.pixelUnpackBuffer=m(this.gl,null,u,this._state.pixelUnpackBuffer);break;case d.BufferType.COPY_READ_BUFFER:this._state.copyReadBuffer=m(this.gl,null,u,this._state.copyReadBuffer);break;case d.BufferType.COPY_WRITE_BUFFER:this._state.copyWriteBuffer=m(this.gl,null,u,this._state.copyWriteBuffer)}};g.bindVAO=function(u=null){D.isNone(u)?this._state.vertexArrayObject&&(this._state.vertexArrayObject.unbind(),this._state.vertexArrayObject=
null):this._state.vertexArrayObject!==u&&(u.bind(),this._state.vertexArrayObject=u)};g.clientWaitAsync=function(){var u=t._asyncToGenerator(function*(y=C.Milliseconds(10)){const z=this.gl,w=z.fenceSync(d.SyncCondition.SYNC_GPU_COMMANDS_COMPLETE,0);this.instanceCounter.increment(d.ResourceType.Sync,w);z.flush();let B;do yield E.after(y),B=z.clientWaitSync(w,0,0);while(B===d.ClientWaitSyncStatus.TIMEOUT_EXPIRED);this.instanceCounter.decrement(d.ResourceType.Sync,w);z.deleteSync(w);if(B===d.ClientWaitSyncStatus.WAIT_FAILED)throw Error("Client wait failed");
});return function(){return u.apply(this,arguments)}}();g.getBoundFramebufferObject=function(u=d.FramebufferTarget.FRAMEBUFFER){return u===d.FramebufferTarget.READ_FRAMEBUFFER?this._state.readFramebuffer:this._state.drawFramebuffer};g.getBoundVAO=function(){return this._state.vertexArrayObject};g.resetState=function(){this.useProgram(null);this.bindVAO(null);this.bindFramebuffer(null,!0);this.unbindBuffer(d.BufferType.ARRAY_BUFFER);this.unbindBuffer(d.BufferType.ELEMENT_ARRAY_BUFFER);e(this.gl)&&
(this.unbindBuffer(d.BufferType.UNIFORM_BUFFER),this._state.uniformBufferBindingPoints.length=0,this.unbindBuffer(d.BufferType.PIXEL_PACK_BUFFER),this.unbindBuffer(d.BufferType.PIXEL_UNPACK_BUFFER),this.unbindBuffer(d.BufferType.COPY_READ_BUFFER),this.unbindBuffer(d.BufferType.COPY_WRITE_BUFFER));for(let u=0;u<this.parameters.maxTextureImageUnits;++u)this.bindTexture(null,u);this.setBlendingEnabled(!1);this.setBlendFunction(d.BlendFactor.ONE,d.BlendFactor.ZERO);this.setBlendEquation(d.BlendOperation.ADD);
this.setBlendColor(0,0,0,0);this.setFaceCullingEnabled(!1);this.setCullFace(d.Face.BACK);this.setFrontFace(d.CullMode.CCW);this.setPolygonOffsetFillEnabled(!1);this.setPolygonOffset(0,0);this.setScissorTestEnabled(!1);this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height);this.setDepthTestEnabled(!1);this.setDepthFunction(d.CompareFunction.LESS);this.setDepthRange(0,1);this.setStencilTestEnabled(!1);this.setStencilFunction(d.CompareFunction.ALWAYS,0,0);this.setStencilOp(d.StencilOperation.KEEP,
d.StencilOperation.KEEP,d.StencilOperation.KEEP);this.setClearColor(0,0,0,0);this.setClearDepth(1);this.setClearStencil(0);this.setColorMask(!0,!0,!0,!0);this.setStencilWriteMask(4294967295);this.setDepthWriteEnabled(!0);this.setViewport(0,0,this.gl.canvas.width,this.gl.canvas.height)};g.enforceState=function(){var u,y;const z=this.gl;var w=this.capabilities.vao;w&&w.bindVertexArray(null);for(let I=0;I<this.parameters.maxVertexAttributes;I++)z.disableVertexAttribArray(I);this._state.vertexBuffer?
z.bindBuffer(this._state.vertexBuffer.bufferType,this._state.vertexBuffer.glName):z.bindBuffer(d.BufferType.ARRAY_BUFFER,null);this._state.indexBuffer?z.bindBuffer(this._state.indexBuffer.bufferType,this._state.indexBuffer.glName):z.bindBuffer(d.BufferType.ELEMENT_ARRAY_BUFFER,null);if(e(z)){var B,F;this._state.uniformBuffer?z.bindBuffer(this._state.uniformBuffer.bufferType,this._state.uniformBuffer.glName):z.bindBuffer(d.BufferType.UNIFORM_BUFFER,null);for(var G=0;G<this._parameters.maxUniformBufferBindings;G++){var H=
this._state.uniformBufferBindingPoints[G];if(D.isSome(H)){const {buffer:I,offset:L,size:N}=H;null!==I?0===L&&0===N?z.bindBufferBase(d.BufferType.UNIFORM_BUFFER,G,I.glName):z.bindBufferRange(d.BufferType.UNIFORM_BUFFER,G,I.glName,L,N):z.bindBufferBase(d.BufferType.UNIFORM_BUFFER,G,null)}}this._state.pixelPackBuffer?z.bindBuffer(this._state.pixelPackBuffer.bufferType,this._state.pixelPackBuffer.glName):z.bindBuffer(d.BufferType.PIXEL_PACK_BUFFER,null);this._state.pixelUnpackBuffer?z.bindBuffer(this._state.pixelUnpackBuffer.bufferType,
this._state.pixelUnpackBuffer.glName):z.bindBuffer(d.BufferType.PIXEL_UNPACK_BUFFER,null);this._state.copyReadBuffer?z.bindBuffer(this._state.copyReadBuffer.bufferType,this._state.copyReadBuffer.glName):z.bindBuffer(d.BufferType.COPY_READ_BUFFER,null);this._state.copyWriteBuffer?z.bindBuffer(this._state.copyWriteBuffer.bufferType,this._state.copyWriteBuffer.glName):z.bindBuffer(d.BufferType.COPY_WRITE_BUFFER,null);z.bindFramebuffer(d.FramebufferTarget.READ_FRAMEBUFFER,null);z.readBuffer(z.BACK);this._state.readFramebuffer&&
(z.bindFramebuffer(d.FramebufferTarget.READ_FRAMEBUFFER,this._state.readFramebuffer.glName),z.readBuffer(d.ColorAttachment.COLOR_ATTACHMENT0));z.bindFramebuffer(d.FramebufferTarget.DRAW_FRAMEBUFFER,null!=(B=null==(F=this._state.drawFramebuffer)?void 0:F.glName)?B:null)}else this._state.readFramebuffer=this._state.drawFramebuffer,z.bindFramebuffer(d.FramebufferTarget.FRAMEBUFFER,null!=(G=null==(H=this._state.drawFramebuffer)?void 0:H.glName)?G:null);if(w&&this._state.vertexArrayObject){if(w=this._state.vertexArrayObject)this._state.vertexArrayObject.unbind(),
this._state.vertexArrayObject=null;this.bindVAO(w)}z.useProgram(null!=(u=null==(y=this._state.program)?void 0:y.glName)?u:null);z.blendColor(this._state.blendColor.r,this._state.blendColor.g,this._state.blendColor.b,this._state.blendColor.a);z.bindRenderbuffer(z.RENDERBUFFER,this._state.renderbuffer?this._state.renderbuffer.glName:null);!0===this._state.blend?z.enable(this.gl.BLEND):z.disable(this.gl.BLEND);z.blendEquationSeparate(this._state.blendEquation.mode,this._state.blendEquation.modeAlpha);
z.blendFuncSeparate(this._state.blendFunction.srcRGB,this._state.blendFunction.dstRGB,this._state.blendFunction.srcAlpha,this._state.blendFunction.dstAlpha);z.clearColor(this._state.clearColor.r,this._state.clearColor.g,this._state.clearColor.b,this._state.clearColor.a);z.clearDepth(this._state.clearDepth);z.clearStencil(this._state.clearStencil);z.colorMask(this._state.colorMask.r,this._state.colorMask.g,this._state.colorMask.b,this._state.colorMask.a);z.cullFace(this._state.cullFace);z.depthFunc(this._state.depthFunction);
z.depthRange(this._state.depthRange.zNear,this._state.depthRange.zFar);!0===this._state.depthTest?z.enable(z.DEPTH_TEST):z.disable(z.DEPTH_TEST);z.depthMask(this._state.depthWrite);z.frontFace(this._state.frontFace);z.lineWidth(1);!0===this._state.faceCulling?z.enable(z.CULL_FACE):z.disable(z.CULL_FACE);z.polygonOffset(this._state.polygonOffset[0],this._state.polygonOffset[1]);!0===this._state.polygonOffsetFill?z.enable(z.POLYGON_OFFSET_FILL):z.disable(z.POLYGON_OFFSET_FILL);z.scissor(this._state.scissorRect.x,
this._state.scissorRect.y,this._state.scissorRect.width,this._state.scissorRect.height);!0===this._state.scissorTest?z.enable(z.SCISSOR_TEST):z.disable(z.SCISSOR_TEST);z.stencilFunc(this._state.stencilFunction.func,this._state.stencilFunction.ref,this._state.stencilFunction.mask);z.stencilOpSeparate(this._state.stencilOperation.face,this._state.stencilOperation.fail,this._state.stencilOperation.zFail,this._state.stencilOperation.zPass);!0===this._state.stencilTest?z.enable(z.STENCIL_TEST):z.disable(z.STENCIL_TEST);
z.stencilMask(this._state.stencilWriteMask);for(u=0;u<this.parameters.maxTextureImageUnits;u++)z.activeTexture(d.BASE_TEXTURE_UNIT+u),z.bindTexture(d.TextureType.TEXTURE_2D,null),z.bindTexture(d.TextureType.TEXTURE_CUBE_MAP,null),e(z)&&(z.bindTexture(d.TextureType.TEXTURE_3D,null),z.bindTexture(d.TextureType.TEXTURE_2D_ARRAY,null)),y=this._state.textureUnitMap[u],D.isSome(y)&&z.bindTexture(y.descriptor.target,y.glName);z.activeTexture(d.BASE_TEXTURE_UNIT+this._state.activeTexture);z.viewport(this._state.viewport.x,
this._state.viewport.y,this._state.viewport.width,this._state.viewport.height);this.resetInfo()};g._loadExtensions=function(){this.type===n.ContextType.WEBGL1&&this.gl.getExtension("OES_element_index_uint");this.gl.getExtension("KHR_parallel_shader_compile")};g._loadParameters=function(u){var y,z=this.capabilities.textureFilterAnisotropic;u=null!=(y=u.maxAnisotropy)?y:Infinity;y=e(this.gl);const w=this.gl;z={versionString:this.gl.getParameter(this.gl.VERSION),maxVertexTextureImageUnits:this.gl.getParameter(this.gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),
maxVertexAttributes:this.gl.getParameter(this.gl.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:z?Math.min(this.gl.getParameter(z.MAX_TEXTURE_MAX_ANISOTROPY),u):1,maxTextureImageUnits:this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),maxTextureSize:this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE),maxUniformBufferBindings:y?w.getParameter(w.MAX_UNIFORM_BUFFER_BINDINGS):0,maxVertexUniformBlocks:y?w.getParameter(w.MAX_VERTEX_UNIFORM_BLOCKS):0,maxFragmentUniformBlocks:y?w.getParameter(w.MAX_FRAGMENT_UNIFORM_BLOCKS):
0,maxUniformBlockSize:y?w.getParameter(w.MAX_UNIFORM_BLOCK_SIZE):0,uniformBufferOffsetAlignment:y?w.getParameter(w.UNIFORM_BUFFER_OFFSET_ALIGNMENT):1,maxArrayTextureLayers:y?w.getParameter(w.MAX_ARRAY_TEXTURE_LAYERS):1,maxSamples:y?w.getParameter(w.MAX_SAMPLES):1};f.Texture.TEXTURE_UNIT_FOR_UPDATES=z.maxTextureImageUnits-1;return z};t._createClass(x,[{key:"driverTest",get:function(){return this._driverTest}},{key:"contextAttributes",get:function(){return this.gl.getContextAttributes()}},{key:"parameters",
get:function(){return this._parameters}},{key:"capabilities",get:function(){return this._capabilities}}]);return x}();q.RenderingContext=v;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/ContextState":function(){define(["exports","./enums"],function(q,t){q.ContextState=function(){this.blend=!1;this.blendColor={r:0,g:0,b:0,a:0};this.blendFunction={srcRGB:t.BlendFactor.ONE,dstRGB:t.BlendFactor.ZERO,srcAlpha:t.BlendFactor.ONE,dstAlpha:t.BlendFactor.ZERO};
this.blendEquation={mode:t.BlendOperation.ADD,modeAlpha:t.BlendOperation.ADD};this.colorMask={r:!0,g:!0,b:!0,a:!0};this.faceCulling=!1;this.cullFace=t.Face.BACK;this.frontFace=t.CullMode.CCW;this.scissorTest=!1;this.scissorRect={x:0,y:0,width:0,height:0};this.depthTest=!1;this.depthFunction=t.CompareFunction.LESS;this.clearDepth=1;this.depthWrite=!0;this.depthRange={zNear:0,zFar:1};this.viewport=null;this.polygonOffsetFill=this.stencilTest=!1;this.polygonOffset=[0,0];this.stencilFunction={face:t.Face.FRONT_AND_BACK,
func:t.CompareFunction.ALWAYS,ref:0,mask:1};this.clearStencil=0;this.stencilWriteMask=1;this.stencilOperation={face:t.Face.FRONT_AND_BACK,fail:t.StencilOperation.KEEP,zFail:t.StencilOperation.KEEP,zPass:t.StencilOperation.KEEP};this.clearColor={r:0,g:0,b:0,a:0};this.copyWriteBuffer=this.copyReadBuffer=this.pixelUnpackBuffer=this.pixelPackBuffer=this.uniformBuffer=this.indexBuffer=this.vertexBuffer=this.program=null;this.uniformBufferBindingPoints=[];this.renderbuffer=this.drawFramebuffer=this.readFramebuffer=
null;this.activeTexture=0;this.textureUnitMap=[]};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/InstanceCounter":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../support/AllocationTracer","./enums"],function(q,t,D,E){const C={RECORD_ALLOCATIONS:!1};let A=function(){function n(){this._current=[];this._max=[];for(this._allocations=new D.AllocationTracer(C.RECORD_ALLOCATIONS);this._current.length<E.ResourceType.COUNT;)this._current.push(0),
this._max.push(0)}var l=n.prototype;l.resetMax=function(){for(this._max.length=0;this._max.length<this._current.length;)this._max.push(0)};l.increment=function(d,a){const b=++this._current[d];this._max[d]=Math.max(b,this._max[d]);this._allocations.add(a)};l.decrement=function(d,a){--this._current[d];this._allocations.remove(a)};l.printResourceCount=function(){if(0<this.total){console.log("Live objects:");for(let d=0;d<E.ResourceType.COUNT;++d){const a=this._current[d];0<a&&console.log(`${E.ResourceType[d]}: ${a}`)}}this._allocations.print()};
t._createClass(n,[{key:"max",get:function(){return this._max}},{key:"current",get:function(){return this._current}},{key:"total",get:function(){return this.current.reduce((d,a)=>d+a,0)}}]);return n}();q.InstanceCounter=A;q.test=C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/support/AllocationTracer":function(){define(["exports"],function(q){let t=function(){function D(C){this._allocations=new Map;C?Error.stackTraceLimit=Infinity:(this.add=
()=>{},this.remove=()=>{})}var E=D.prototype;E.add=function(C){this._allocations.set(C,Error().stack)};E.remove=function(C){this._allocations.delete(C)};E.print=function(){if(0<this._allocations.size){console.log(`${this._allocations.size} live object allocations:`);const C=new Map;this._allocations.forEach(A=>{var n;C.set(A,(null!=(n=C.get(A))?n:0)+1)});C.forEach((A,n)=>{n=n.split("\n");n.shift();n.shift();console.log(`${A}: ${n.shift()}`);n.forEach(l=>console.log("   ",l))})}};return D}();q.AllocationTracer=
t;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/renderState":function(){define(["exports","../3d/webgl-engine/lib/basicInterfaces","./enums"],function(q,t,D){function E(N){return y.intern(N)}function C(N){return z.intern(N)}function A(N){return w.intern(N)}function n(N){return B.intern(N)}function l(N){return F.intern(N)}function d(N){return G.intern(N)}function a(N){return H.intern(N)}function b(N){return I.intern(N)}function c(N){return"["+
N.join(",")+"]"}function f(N){return N?c([N.srcRgb,N.srcAlpha,N.dstRgb,N.dstAlpha,N.opRgb,N.opAlpha,N.color.r,N.color.g,N.color.b,N.color.a]):null}function h(N){return N?c([N.face,N.mode]):null}function p(N){return N?c([N.factor,N.units]):null}function k(N){return N?c([N.func]):null}function e(N){return N?c([N.function.func,N.function.ref,N.function.mask,N.operation.fail,N.operation.zFail,N.operation.zPass]):null}function m(N){return N?c([N.zNear,N.zFar]):null}function r(N){return N?c([N.r,N.g,N.b,
N.a]):null}function v(N){return N?c([N.mask]):null}const x={face:D.Face.BACK,mode:D.CullMode.CCW},g={face:D.Face.FRONT,mode:D.CullMode.CCW};var u=function(){function N(J,K){this.makeKey=J;this.makeRef=K;this.interns=new Map}N.prototype.intern=function(J){if(!J)return null;const K=this.makeKey(J),O=this.interns;O.has(K)||O.set(K,this.makeRef(J));return O.get(K)};return N}();const y=new u(f,N=>({__tag:"Blending",...N})),z=new u(h,N=>({__tag:"Culling",...N})),w=new u(p,N=>({__tag:"PolygonOffset",...N})),
B=new u(k,N=>({__tag:"DepthTest",...N})),F=new u(e,N=>({__tag:"StencilTest",...N})),G=new u(m,N=>({__tag:"DepthWrite",...N})),H=new u(r,N=>({__tag:"ColorWrite",...N})),I=new u(v,N=>({__tag:"StencilWrite",...N})),L=new u(function(N){return N?c([f(N.blending),h(N.culling),p(N.polygonOffset),k(N.depthTest),e(N.stencilTest),m(N.depthWrite),r(N.colorWrite),v(N.stencilWrite)]):null},N=>({blending:E(N.blending),culling:C(N.culling),polygonOffset:A(N.polygonOffset),depthTest:n(N.depthTest),stencilTest:l(N.stencilTest),
depthWrite:d(N.depthWrite),colorWrite:a(N.colorWrite),stencilWrite:b(N.stencilWrite)}));u=function(){function N(K){this._stencilWriteInvalid=this._colorWriteInvalid=this._depthWriteInvalid=this._stencilTestInvalid=this._depthTestInvalid=this._polygonOffsetInvalid=this._cullingInvalid=this._blendingInvalid=this._pipelineInvalid=!0;this._stateSetters=K}var J=N.prototype;J.setPipeline=function(K){if(this._pipelineInvalid||K!==this._pipeline)this._setBlending(K.blending),this._setCulling(K.culling),this._setPolygonOffset(K.polygonOffset),
this._setDepthTest(K.depthTest),this._setStencilTest(K.stencilTest),this._setDepthWrite(K.depthWrite),this._setColorWrite(K.colorWrite),this._setStencilWrite(K.stencilWrite),this._pipeline=K;this._pipelineInvalid=!1};J.invalidateBlending=function(){this._pipelineInvalid=this._blendingInvalid=!0};J.invalidateCulling=function(){this._pipelineInvalid=this._cullingInvalid=!0};J.invalidatePolygonOffset=function(){this._pipelineInvalid=this._polygonOffsetInvalid=!0};J.invalidateDepthTest=function(){this._pipelineInvalid=
this._depthTestInvalid=!0};J.invalidateStencilTest=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};J.invalidateDepthWrite=function(){this._pipelineInvalid=this._depthWriteInvalid=!0};J.invalidateColorWrite=function(){this._pipelineInvalid=this._colorWriteInvalid=!0};J.invalidateStencilWrite=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};J._setBlending=function(K){this._blending=this._setSubState(K,this._blending,this._blendingInvalid,this._stateSetters.setBlending);this._blendingInvalid=
!1};J._setCulling=function(K){this._culling=this._setSubState(K,this._culling,this._cullingInvalid,this._stateSetters.setCulling);this._cullingInvalid=!1};J._setPolygonOffset=function(K){this._polygonOffset=this._setSubState(K,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset);this._polygonOffsetInvalid=!1};J._setDepthTest=function(K){this._depthTest=this._setSubState(K,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest);this._depthTestInvalid=
!1};J._setStencilTest=function(K){this._stencilTest=this._setSubState(K,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest);this._stencilTestInvalid=!1};J._setDepthWrite=function(K){this._depthWrite=this._setSubState(K,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite);this._depthWriteInvalid=!1};J._setColorWrite=function(K){this._colorWrite=this._setSubState(K,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite);this._colorWriteInvalid=
!1};J._setStencilWrite=function(K){this._stencilWrite=this._setSubState(K,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite);this._stencilTestInvalid=!1};J._setSubState=function(K,O,W,aa){if(W||K!==O)aa(K),this._pipelineInvalid=!0;return K};return N}();q.StateTracker=u;q.backFaceCullingParams=x;q.cullingParams=N=>N===t.CullFaceOptions.Back?x:N===t.CullFaceOptions.Front?g:null;q.defaultColorWriteParams={r:!0,g:!0,b:!0,a:!0};q.defaultDepthWriteParams={zNear:0,zFar:1};q.frontFaceCullingParams=
g;q.makeBlending=E;q.makeColorWrite=a;q.makeCulling=C;q.makeDepthTest=n;q.makeDepthWrite=d;q.makePipelineState=function(N){return L.intern(N)};q.makePolygonOffset=A;q.makeStencilTest=l;q.makeStencilWrite=b;q.separateBlendingParams=function(N,J,K,O,W=D.BlendOperation.ADD,aa=D.BlendOperation.ADD,ba=[0,0,0,0]){return{srcRgb:N,srcAlpha:J,dstRgb:K,dstAlpha:O,opRgb:W,opAlpha:aa,color:{r:ba[0],g:ba[1],b:ba[2],a:ba[3]}}};q.simpleBlendingParams=function(N,J,K=D.BlendOperation.ADD,O=[0,0,0,0]){return{srcRgb:N,
srcAlpha:N,dstRgb:J,dstAlpha:J,opRgb:K,opAlpha:K,color:{r:O[0],g:O[1],b:O[2],a:O[3]}}};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/webgl-engine/lib/basicInterfaces":function(){define(["exports"],function(q){q.CullFaceOptions=void 0;(function(t){t[t.None=0]="None";t[t.Front=1]="Front";t[t.Back=2]="Back";t[t.COUNT=3]="COUNT"})(q.CullFaceOptions||(q.CullFaceOptions={}));q.DepthTestFunction=void 0;(function(t){t[t.Less=0]="Less";t[t.Lequal=
1]="Lequal";t[t.COUNT=2]="COUNT"})(q.DepthTestFunction||(q.DepthTestFunction={}));q.AntiAliasingMode=void 0;(function(t){t[t.NONE=0]="NONE";t[t.SMAA=1]="SMAA"})(q.AntiAliasingMode||(q.AntiAliasingMode={}));q.TransparencyPassType=void 0;(function(t){t[t.Color=0]="Color";t[t.Alpha=1]="Alpha";t[t.FrontFace=2]="FrontFace";t[t.NONE=3]="NONE";t[t.COUNT=4]="COUNT"})(q.TransparencyPassType||(q.TransparencyPassType={}));q.RenderRequestType=void 0;(function(t){t[t.BACKGROUND=0]="BACKGROUND";t[t.UPDATE=1]="UPDATE"})(q.RenderRequestType||
(q.RenderRequestType={}));q.ResourceState=void 0;(function(t){t[t.NOT_LOADED=0]="NOT_LOADED";t[t.LOADING=1]="LOADING";t[t.LOADED=2]="LOADED"})(q.ResourceState||(q.ResourceState={}));q.StencilBits=void 0;(function(t){t[t.IntegratedMeshMaskExcluded=1]="IntegratedMeshMaskExcluded";t[t.OutlineVisualElementMask=2]="OutlineVisualElementMask"})(q.StencilBits||(q.StencilBits={}));q.UpdatePolicy=void 0;(function(t){t[t.ASYNC=0]="ASYNC";t[t.SYNC=1]="SYNC"})(q.UpdatePolicy||(q.UpdatePolicy={}));q.Object3DState=
void 0;(function(t){t[t.Highlight=0]="Highlight";t[t.MaskOccludee=1]="MaskOccludee";t[t.COUNT=2]="COUNT"})(q.Object3DState||(q.Object3DState={}));q.PrimitiveType=void 0;(function(t){t[t.Triangle=0]="Triangle";t[t.Point=1]="Point";t[t.Line=2]="Line"})(q.PrimitiveType||(q.PrimitiveType={}));q.PowerOfTwoResizeMode=void 0;(function(t){t[t.STRETCH=1]="STRETCH";t[t.PAD=2]="PAD"})(q.PowerOfTwoResizeMode||(q.PowerOfTwoResizeMode={}));q.ValidationState=void 0;(function(t){t[t.CHANGED=0]="CHANGED";t[t.UNCHANGED=
1]="UNCHANGED"})(q.ValidationState||(q.ValidationState={}));q.AlphaDiscardMode=void 0;(function(t){t[t.Blend=0]="Blend";t[t.Opaque=1]="Opaque";t[t.Mask=2]="Mask";t[t.MaskBlend=3]="MaskBlend";t[t.COUNT=4]="COUNT"})(q.AlphaDiscardMode||(q.AlphaDiscardMode={}));q.Decorations=void 0;(function(t){t[t.OFF=0]="OFF";t[t.ON=1]="ON"})(q.Decorations||(q.Decorations={}));Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/WebGLDriverTest":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/maybe ./testDoublePrecisionArithmetic ./testFloatBufferBlend ./testSamplerPrecision ./testSVGPremultipliedAlpha".split(" "),
function(q,t,D,E,C,A,n){let l=function(){function d(a){this.context=a;this._floatBufferBlendWorking=C.testFloatBufferBlend(a);n.testSVGPremultipliedAlpha(a).then(b=>this._svgAlwaysPremultipliesAlpha=!b)}t._createClass(d,[{key:"floatBufferBlendWorking",get:function(){if(D.isNone(this._floatBufferBlendWorking))throw Error("floatBufferBlendWorking test not yet available");return this._floatBufferBlendWorking}},{key:"svgAlwaysPremultipliesAlpha",get:function(){if(D.isNone(this._svgAlwaysPremultipliesAlpha))throw Error("svgAlwaysPremultipliesAlpha test not yet available");
return this._svgAlwaysPremultipliesAlpha}},{key:"doublePrecisionRequiresObfuscation",get:function(){if(D.isNone(this._doublePrecisionRequiresObfuscation)){const a=E.testDoublePrecisionArithmetic(this.context,!1),b=E.testDoublePrecisionArithmetic(this.context,!0);this._doublePrecisionRequiresObfuscation=0!==a&&(0===b||5<a/b)}return this._doublePrecisionRequiresObfuscation}},{key:"ignoresSamplerPrecision",get:function(){D.isNone(this._ignoresSamplerPrecision)&&(this._ignoresSamplerPrecision=A.testSamplerPrecision(this.context));
return this._ignoresSamplerPrecision}}]);return d}();q.WebGLDriverTest=l;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/testDoublePrecisionArithmetic":function(){define("exports ../../core/floatRGBA ../../chunks/vec3f64 ./BufferObject ./doublePrecisionUtils ./enums ./FramebufferObject ./VertexArrayObject ./VertexElementDescriptor".split(" "),function(q,t,D,E,C,A,n,l,d){q.testDoublePrecisionArithmetic=function(a,b){var c=new n.FramebufferObject(a,
{colorTarget:A.TargetType.TEXTURE,depthStencilTarget:A.DepthStencilTargetType.NONE},{target:A.TextureType.TEXTURE_2D,wrapMode:A.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:A.PixelFormat.RGBA,dataType:A.PixelType.UNSIGNED_BYTE,samplingMode:A.TextureSamplingMode.NEAREST,width:1,height:1});const f=E.BufferObject.createVertex(a,A.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),h=new l.VertexArrayObject(a,new Map([["position",0]]),{geometry:[new d.VertexElementDescriptor("position",2,A.DataType.UNSIGNED_SHORT,
0,4)]},{geometry:f}),p=D.fromValues(5633261.287538229,2626832.878767164,1434988.0495278358),k=D.fromValues(5633271.46742708,2626873.6381334523,1434963.231608387);b=a.programCache.acquire(`\n\n  precision highp float;\n\n  attribute vec2 position;\n\n  uniform vec3 u_highA;\n  uniform vec3 u_lowA;\n  uniform vec3 u_highB;\n  uniform vec3 u_lowB;\n\n  varying vec4 v_color;\n\n  ${b?"#define DOUBLE_PRECISION_REQUIRES_OBFUSCATION":""}\n\n  #ifdef DOUBLE_PRECISION_REQUIRES_OBFUSCATION\n\n  vec3 dpPlusFrc(vec3 a, vec3 b) {\n    return mix(a, a + b, vec3(notEqual(b, vec3(0))));\n  }\n\n  vec3 dpMinusFrc(vec3 a, vec3 b) {\n    return mix(vec3(0), a - b, vec3(notEqual(a, b)));\n  }\n\n  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n    vec3 t1 = dpPlusFrc(hiA, hiB);\n    vec3 e = dpMinusFrc(t1, hiA);\n    vec3 t2 = dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;\n    return t1 + t2;\n  }\n\n  #else\n\n  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n    vec3 t1 = hiA + hiB;\n    vec3 e = t1 - hiA;\n    vec3 t2 = ((hiB - e) + (hiA - (t1 - e))) + loA + loB;\n    return t1 + t2;\n  }\n\n  #endif\n\n  const float MAX_RGBA_FLOAT =\n    255.0 / 256.0 +\n    255.0 / 256.0 / 256.0 +\n    255.0 / 256.0 / 256.0 / 256.0 +\n    255.0 / 256.0 / 256.0 / 256.0 / 256.0;\n\n  const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\n\n  vec4 float2rgba(const float value) {\n    // Make sure value is in the domain we can represent\n    float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);\n\n    // Decompose value in 32bit fixed point parts represented as\n    // uint8 rgba components. Decomposition uses the fractional part after multiplying\n    // by a power of 256 (this removes the bits that are represented in the previous\n    // component) and then converts the fractional part to 8bits.\n    vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);\n\n    // Convert uint8 values (from 0 to 255) to floating point representation for\n    // the shader\n    const float toU8AsFloat = 1.0 / 255.0;\n\n    return fixedPointU8 * toU8AsFloat;\n  }\n\n  void main() {\n    vec3 val = dpAdd(u_highA, u_lowA, -u_highB, -u_lowB);\n\n    v_color = float2rgba(val.z / 25.0);\n\n    gl_Position = vec4(position * 2.0 - 1.0, 0.0, 1.0);\n  }\n  `,
"\n  precision highp float;\n\n  varying vec4 v_color;\n\n  void main() {\n    gl_FragColor \x3d v_color;\n  }\n  ",new Map([["position",0]]));var e=new Float32Array(6);C.encodeDoubleArray(p,e,3);var m=new Float32Array(6);C.encodeDoubleArray(k,m,3);a.useProgram(b);b.setUniform3f("u_highA",e[0],e[2],e[4]);b.setUniform3f("u_lowA",e[1],e[3],e[5]);b.setUniform3f("u_highB",m[0],m[2],m[4]);b.setUniform3f("u_lowB",m[1],m[3],m[5]);e=b;m=a.getBoundFramebufferObject();const {x:r,y:v,width:x,height:g}=a.getViewport();
a.bindFramebuffer(c);a.setViewport(0,0,1,1);a.bindVAO(h);a.drawArrays(A.PrimitiveType.TRIANGLE_STRIP,0,4);b=new Uint8Array(4);c.readPixels(0,0,1,1,A.PixelFormat.RGBA,A.PixelType.UNSIGNED_BYTE,b);e.dispose();h.dispose(!1);f.dispose();c.dispose();a.setViewport(r,v,x,g);a.bindFramebuffer(m);a=(p[2]-k[2])/25;c=t.unpackFloatRGBA(b);return Math.abs(a-c)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/doublePrecisionUtils":function(){define(["exports"],
function(q){const t=new Float32Array(2);q.decodeDoubleArray=function(D,E,C){for(let A=0;A<C;++A)E[A]=D[2*A]+D[2*A+1]};q.encodeDoubleArray=function(D,E,C){for(let A=0;A<C;++A)E[2*A]=D[A],E[2*A+1]=D[A]-E[2*A]};q.encodeDoubleHi=function(D,E){const C=D.length;for(let A=0;A<C;++A)t[0]=D[A],E[A]=t[0];return E};q.encodeDoubleLo=function(D,E){const C=D.length;for(let A=0;A<C;++A)t[0]=D[A],t[1]=D[A]-t[0],E[A]=t[1];return E};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/webgl/testFloatBufferBlend":function(){define("exports ../3d/webgl-engine/lib/OrderIndependentTransparency ./BufferObject ./context-util ./enums ./FramebufferObject ./renderState ./VertexArrayObject ./VertexElementDescriptor".split(" "),function(q,t,D,E,C,A,n,l,d){var a={exports:{}};(function(b){(function(c){c=c();void 0!==c&&(b.exports=c)})(function(){function c(g){if(null==v){v={};x={};for(var u in g)"number"==typeof g[u]&&(v[g[u]]=u,x[u]=g[u])}}function f(){if(null==v)throw"WebGLDebugUtils.init(ctx) not called";
}function h(g){f();var u=v[g];return void 0!==u?"gl."+u:"/*UNKNOWN WebGL ENUM*/ 0x"+g.toString(16)}function p(g,u,y,z){g=r[g];if(void 0!==g&&(g=g[u],void 0!==g&&g[y])){if("object"===typeof g[y]&&void 0!==g[y].enumBitwiseOr){u=g[y].enumBitwiseOr;y=0;g=[];for(var w=0;w<u.length;++w){var B=x[u[w]];0!==(z&B)&&(y|=B,g.push(h(B)))}return y===z?g.join(" | "):h(z)}return h(z)}return null===z?"null":void 0===z?"undefined":z.toString()}function k(g,u,y){g.__defineGetter__(y,function(){return u[y]});g.__defineSetter__(y,
function(z){u[y]=z})}function e(g,u,y,z){function w(I,L){return function(){y&&y(L,arguments);var N=I[L].apply(I,arguments),J=z.getError();0!=J&&(B[J]=!0,u(J,L,arguments));return N}}z=z||g;c(g);u=u||function(I,L,N){for(var J="",K=N.length,O=0;O<K;++O)J+=(0==O?"":", ")+p(L,K,O,N[O]);I="WebGL error "+h(I)+" in "+L+"("+J+")";window.console&&window.console.error?window.console.error(I):window.console&&window.console.log&&window.console.log(I)};var B={},F={},G;for(G in g)if("function"==typeof g[G])if("getExtension"!=
G)F[G]=w(g,G);else{var H=w(g,G);F[G]=function(){var I=H.apply(g,arguments);return e(I,u,y,z)}}else k(F,g,G);F.getError=function(){for(var I in B)if(B.hasOwnProperty(I)&&B[I])return B[I]=!1,I;return g.NO_ERROR};return F}function m(g){var u=g.getParameter(g.MAX_VERTEX_ATTRIBS),y=g.createBuffer();g.bindBuffer(g.ARRAY_BUFFER,y);for(var z=0;z<u;++z)g.disableVertexAttribArray(z),g.vertexAttribPointer(z,4,g.FLOAT,!1,0,0),g.vertexAttrib1f(z,0);g.deleteBuffer(y);u=g.getParameter(g.MAX_TEXTURE_IMAGE_UNITS);
for(z=0;z<u;++z)g.activeTexture(g.TEXTURE0+z),g.bindTexture(g.TEXTURE_CUBE_MAP,null),g.bindTexture(g.TEXTURE_2D,null);g.activeTexture(g.TEXTURE0);g.useProgram(null);g.bindBuffer(g.ARRAY_BUFFER,null);g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,null);g.bindFramebuffer(g.FRAMEBUFFER,null);g.bindRenderbuffer(g.RENDERBUFFER,null);g.disable(g.BLEND);g.disable(g.CULL_FACE);g.disable(g.DEPTH_TEST);g.disable(g.DITHER);g.disable(g.SCISSOR_TEST);g.blendColor(0,0,0,0);g.blendEquation(g.FUNC_ADD);g.blendFunc(g.ONE,g.ZERO);
g.clearColor(0,0,0,0);g.clearDepth(1);g.clearStencil(-1);g.colorMask(!0,!0,!0,!0);g.cullFace(g.BACK);g.depthFunc(g.LESS);g.depthMask(!0);g.depthRange(0,1);g.frontFace(g.CCW);g.hint(g.GENERATE_MIPMAP_HINT,g.DONT_CARE);g.lineWidth(1);g.pixelStorei(g.PACK_ALIGNMENT,4);g.pixelStorei(g.UNPACK_ALIGNMENT,4);g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,!1);g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);g.UNPACK_COLORSPACE_CONVERSION_WEBGL&&g.pixelStorei(g.UNPACK_COLORSPACE_CONVERSION_WEBGL,g.BROWSER_DEFAULT_WEBGL);
g.polygonOffset(0,0);g.sampleCoverage(1,!1);g.scissor(0,0,g.canvas.width,g.canvas.height);g.stencilFunc(g.ALWAYS,0,4294967295);g.stencilMask(4294967295);g.stencilOp(g.KEEP,g.KEEP,g.KEEP);g.viewport(0,0,g.canvas.width,g.canvas.height);for(g.clear(g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT|g.STENCIL_BUFFER_BIT);g.getError(););}var r={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},
getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},texParameteri:{3:{0:!0,1:!0,2:!0}},texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,
6:!0}},bindBuffer:{2:{0:!0}},bufferData:{3:{0:!0,2:!0}},bufferSubData:{3:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},readPixels:{7:{4:!0,5:!0}},bindRenderbuffer:{2:{0:!0}},bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT",
"DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}}},
v=null,x=null;return{init:c,mightBeEnum:function(g){f();return void 0!==v[g]},glEnumToString:h,glFunctionArgToString:p,glFunctionArgsToString:function(g,u){for(var y="",z=u.length,w=0;w<z;++w)y+=(0==w?"":", ")+p(g,z,w,u[w]);return y},makeDebugContext:e,makeLostContextSimulatingCanvas:function(g){function u(M){return"function"==typeof M?M:function(Q){M.handleEvent(Q)}}function y(){for(var M=Object.keys(S),Q=0;Q<M.length;++Q)delete S[M]}function z(){++W;J||O==W&&g.loseContext()}function w(M,Q){var Y=
M[Q];return function(){z();if(!J)return Y.apply(M,arguments)}}function B(M){return{statusMessage:M,preventDefault:function(){aa=!0}}}function F(M){for(var Q in M)"function"==typeof M[Q]?L[Q]=w(M,Q):k(L,M,Q);L.getError=function(){z();if(!J)for(var P;P=G.getError();)S[P]=!0;for(P in S)if(S[P])return delete S[P],P;return L.NO_ERROR};var Y="createBuffer createFramebuffer createProgram createRenderbuffer createShader createTexture".split(" ");for(Q=0;Q<Y.length;++Q){var V=Y[Q];L[V]=function(P){return function(){z();
if(J)return null;var X=P.apply(M,arguments);X.__webglDebugContextLostId__=N;K.push(X);return X}}(M[V])}Y="getActiveAttrib getActiveUniform getBufferParameter getContextAttributes getAttachedShaders getFramebufferAttachmentParameter getParameter getProgramParameter getProgramInfoLog getRenderbufferParameter getShaderParameter getShaderInfoLog getShaderSource getTexParameter getUniform getUniformLocation getVertexAttrib".split(" ");for(Q=0;Q<Y.length;++Q)V=Y[Q],L[V]=function(P){return function(){z();
return J?null:P.apply(M,arguments)}}(L[V]);Y="isBuffer isEnabled isFramebuffer isProgram isRenderbuffer isShader isTexture".split(" ");for(Q=0;Q<Y.length;++Q)V=Y[Q],L[V]=function(P){return function(){z();return J?!1:P.apply(M,arguments)}}(L[V]);L.checkFramebufferStatus=function(P){return function(){z();return J?L.FRAMEBUFFER_UNSUPPORTED:P.apply(M,arguments)}}(L.checkFramebufferStatus);L.getAttribLocation=function(P){return function(){z();return J?-1:P.apply(M,arguments)}}(L.getAttribLocation);L.getVertexAttribOffset=
function(P){return function(){z();return J?0:P.apply(M,arguments)}}(L.getVertexAttribOffset);L.isContextLost=function(){return J};return L}var G,H=[],I=[];var L={};var N=1,J=!1,K=[],O=0,W=0,aa=!1,ba=0,S={};g.getContext=function(M){return function(){var Q=M.apply(g,arguments);if(Q instanceof WebGLRenderingContext){if(Q!=G){if(G)throw"got different context";G=Q;L=F(G)}return L}return Q}}(g.getContext);(function(M){var Q=M.addEventListener;M.addEventListener=function(Y,V,P){switch(Y){case "webglcontextlost":H.push(u(V));
break;case "webglcontextrestored":I.push(u(V));break;default:Q.apply(M,arguments)}}})(g);g.loseContext=function(){if(!J){J=!0;O=0;for(++N;G.getError(););y();S[G.CONTEXT_LOST_WEBGL]=!0;var M=B("context lost"),Q=H.slice();setTimeout(function(){for(var Y=0;Y<Q.length;++Y)Q[Y](M);0<=ba&&setTimeout(function(){g.restoreContext()},ba)},0)}};g.restoreContext=function(){J&&I.length&&setTimeout(function(){if(!aa)throw"can not restore. webglcontestlost listener did not call event.preventDefault";for(var M=0;M<
K.length;++M){var Q=K[M];Q instanceof WebGLBuffer?G.deleteBuffer(Q):Q instanceof WebGLFramebuffer?G.deleteFramebuffer(Q):Q instanceof WebGLProgram?G.deleteProgram(Q):Q instanceof WebGLRenderbuffer?G.deleteRenderbuffer(Q):Q instanceof WebGLShader?G.deleteShader(Q):Q instanceof WebGLTexture&&G.deleteTexture(Q)}m(G);J=!1;W=0;aa=!1;M=I.slice();Q=B("context restored");for(var Y=0;Y<M.length;++Y)M[Y](Q)},0)};g.loseContextInNCalls=function(M){if(J)throw"You can not ask a lost contet to be lost";O=W+M};g.getNumCalls=
function(){return W};g.setRestoreTimeout=function(M){ba=M};return g},resetToInitialState:m}})})(a);q.testFloatBufferBlend=function(b){var c,f,h;if(!b.gl)return!1;if(b.type===E.ContextType.WEBGL1){var p,k;return!(null==(p=b.capabilities.textureFloat)||!p.textureFloat||null==(k=b.capabilities.colorBufferFloat)||!k.textureFloat)}if(!((null==(c=b.capabilities.textureFloat)?0:c.textureFloat)&&(null==(f=b.capabilities.colorBufferFloat)?0:f.textureFloat)&&(null==(h=b.capabilities.colorBufferFloat)?0:h.floatBlend)))return!1;
c=new A.FramebufferObject(b,{colorTarget:C.TargetType.TEXTURE,depthStencilTarget:C.DepthStencilTargetType.NONE},{target:C.TextureType.TEXTURE_2D,wrapMode:C.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:C.PixelFormat.RGBA,dataType:C.PixelType.FLOAT,internalFormat:C.SizedPixelFormat.RGBA32F,samplingMode:C.TextureSamplingMode.NEAREST,width:1,height:1});f=D.BufferObject.createVertex(b,C.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1]));h=new l.VertexArrayObject(b,new Map([["a_pos",0]]),{geometry:[new d.VertexElementDescriptor("a_pos",
2,C.DataType.UNSIGNED_SHORT,0,4)]},{geometry:f});p=b.programCache.acquire("\n  precision highp float;\n  attribute vec2 a_pos;\n\n  void main() {\n    gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n  }\n  ","\n   precision highp float;\n\n   void main() {\n    gl_FragColor \x3d vec4(0.5, 0.5, 0.5, 0.5);\n   }\n  ",new Map([["a_pos",0]]));b.useProgram(p);k=b.getBoundFramebufferObject();const {x:e,y:m,width:r,height:v}=b.getViewport();b.bindFramebuffer(c);b.setViewport(0,0,1,1);b.bindVAO(h);b.drawArrays(C.PrimitiveType.TRIANGLE_STRIP,
0,4);var x=n.makePipelineState({blending:t.blendingAlpha});b.setPipelineState(x);b.drawArrays(C.PrimitiveType.TRIANGLE_STRIP,0,4);a.exports.init(b);x=b.gl.getError();b.setViewport(e,m,r,v);b.bindFramebuffer(k);p.dispose();h.dispose(!1);f.dispose();c.dispose();return 1282===x?(console.warn("Device claims support for WebGL extension EXT_float_blend but does not support it. Using fall back."),!1):!0};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/webgl-engine/lib/OrderIndependentTransparency":function(){define(["exports",
"./basicInterfaces","../../../webgl/enums","../../../webgl/renderState"],function(q,t,D,E){const C=E.separateBlendingParams(D.BlendFactor.SRC_ALPHA,D.BlendFactor.ONE,D.BlendFactor.ONE_MINUS_SRC_ALPHA,D.BlendFactor.ONE_MINUS_SRC_ALPHA),A=E.simpleBlendingParams(D.BlendFactor.ONE,D.BlendFactor.ONE),n=E.simpleBlendingParams(D.BlendFactor.ZERO,D.BlendFactor.ONE_MINUS_SRC_ALPHA),l={factor:-1,units:-2};q.OITPolygonOffset=l;q.OITPolygonOffsetLimit=5E5;q.blendingAlpha=n;q.blendingColor=A;q.blendingDefault=
C;q.getOITPolygonOffset=function(d){return d?l:null};q.oitBlending=function(d){return d===t.TransparencyPassType.FrontFace?null:d===t.TransparencyPassType.Alpha?n:A};q.oitDepthTest=function(d,a=D.CompareFunction.LESS){return d===t.TransparencyPassType.NONE||d===t.TransparencyPassType.FrontFace?a:D.CompareFunction.LEQUAL};q.oitDepthWrite=function(d){return d===t.TransparencyPassType.FrontFace?E.defaultDepthWriteParams:null};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/webgl/testSamplerPrecision":function(){define("exports ../../core/Logger ./BufferObject ./enums ./FramebufferObject ./Texture ./VertexArrayObject ./VertexElementDescriptor".split(" "),function(q,t,D,E,C,A,n,l){const d=t.getLogger("esri.views.WebGLDriverTest");q.testSamplerPrecision=function(a){var b=new C.FramebufferObject(a,{colorTarget:E.TargetType.TEXTURE,depthStencilTarget:E.DepthStencilTargetType.NONE},{target:E.TextureType.TEXTURE_2D,wrapMode:E.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:E.PixelFormat.RGBA,
dataType:E.PixelType.UNSIGNED_BYTE,samplingMode:E.TextureSamplingMode.NEAREST,width:1,height:1});const c=new Uint8Array(4),f=D.BufferObject.createVertex(a,E.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),h=new n.VertexArrayObject(a,new Map([["a_position",0]]),{geometry:[new l.VertexElementDescriptor("a_position",2,E.DataType.SHORT,0,4)]},{geometry:f}),p=a.programCache.acquire("\nprecision highp float;\nattribute vec2 a_pos;\nuniform highp sampler2D u_texture;\nvarying vec4 v_color;\n\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n  return mod(floor(bitset / offset), 2.0);\n}\n\nvoid main() {\n  vec4 value \x3d texture2D(u_texture, vec2(0.0));\n  float bit \x3d getBit(value.x * 255.0, 1);\n\n  v_color \x3d bit * vec4(1.0);\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}\n",
"\nprecision highp float;\nvarying vec4 v_color;\n\nvoid main() {\n  gl_FragColor \x3d v_color;\n}\n",new Map([["a_pos",0]]));a.useProgram(p);var k=new A.Texture(a,{target:E.TextureType.TEXTURE_2D,wrapMode:E.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:E.PixelFormat.RGBA,dataType:E.PixelType.UNSIGNED_BYTE,samplingMode:E.TextureSamplingMode.NEAREST,width:1,height:1},new Uint8Array([2,255,0,0]));p.setUniform1i("u_texture",0);a.bindTexture(k,0);k=a.getBoundFramebufferObject();a.bindFramebuffer(b);a.useProgram(p);
const {x:e,y:m,width:r,height:v}=a.getViewport();a.setViewport(0,0,1,1);a.bindVAO(h);a.drawArrays(E.PrimitiveType.TRIANGLE_STRIP,0,4);a.setViewport(e,m,r,v);b.readPixels(0,0,1,1,E.PixelFormat.RGBA,E.PixelType.UNSIGNED_BYTE,c);p.dispose();h.dispose(!1);f.dispose();b.dispose();(b=255!==c[0]||255!==c[1]||255!==c[2]||255!==c[3])&&d.warn(`A problem was detected with your graphics driver. Your driver does not appear to honor sampler precision specifiers, which may result in rendering issues due to numerical instability. We recommend ensuring that your drivers have been updated to the latest version. Applying lowp sampler workaround. [${c[0]}.${c[1]}.${c[2]}.${c[3]}]`);
a.bindFramebuffer(k);return b};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/testSVGPremultipliedAlpha":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../2d/engine/webgl/DefaultVertexAttributeLayouts ./BufferObject ./enums ./FramebufferObject ./Texture ./VertexArrayObject".split(" "),function(q,t,D,E,C,A,n,l){function d(){d=t._asyncToGenerator(function*(a){const b=new Image;b.src="data:image/svg+xml,%3C%3Fxml version\x3d'1.0' encoding\x3d'UTF-8'%3F%3E%3Csvg width\x3d'5' height\x3d'5' version\x3d'1.1' viewBox\x3d'0 0 5 5' xmlns\x3d'http://www.w3.org/2000/svg'%3E%3Crect width\x3d'5' height\x3d'5' fill\x3d'%23f00' fill-opacity\x3d'.5'/%3E%3C/svg%3E%0A";
b.width=5;b.height=5;yield b.decode();if(!a.gl)return!0;const c=new A.FramebufferObject(a,{colorTarget:C.TargetType.TEXTURE,depthStencilTarget:C.DepthStencilTargetType.NONE},{target:C.TextureType.TEXTURE_2D,wrapMode:C.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:C.PixelFormat.RGBA,dataType:C.PixelType.UNSIGNED_BYTE,samplingMode:C.TextureSamplingMode.NEAREST,width:1,height:1}),f=E.BufferObject.createVertex(a,C.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),h=new l.VertexArrayObject(a,new Map([["a_pos",
0]]),D.Pos2us,{geometry:f}),p=a.programCache.acquire("\n  precision highp float;\n\n  attribute vec2 a_pos;\n  varying vec2 v_uv;\n\n  void main() {\n    v_uv \x3d a_pos;\n    gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n  }\n  ","\n  precision highp float;\n\n  varying vec2 v_uv;\n  uniform sampler2D u_texture;\n\n  void main() {\n    gl_FragColor \x3d texture2D(u_texture, v_uv);\n  }\n  ",new Map([["a_pos",0]]));a.useProgram(p);const k=new n.Texture(a,{dataType:C.PixelType.UNSIGNED_BYTE,
pixelFormat:C.PixelFormat.RGBA,preMultiplyAlpha:!1,wrapMode:C.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:C.TextureSamplingMode.LINEAR},b);a.bindTexture(k,0);p.setUniform1i("u_texture",0);const e=a.getBoundFramebufferObject(),{x:m,y:r,width:v,height:x}=a.getViewport();a.bindFramebuffer(c);a.setViewport(0,0,1,1);a.setClearColor(0,0,0,0);a.setBlendingEnabled(!1);a.clearSafe(C.ClearBufferBit.COLOR_BUFFER_BIT);a.bindVAO(h);a.drawArrays(C.PrimitiveType.TRIANGLE_STRIP,0,4);const g=new Uint8Array(4);c.readPixels(0,
0,1,1,C.PixelFormat.RGBA,C.PixelType.UNSIGNED_BYTE,g);p.dispose();h.dispose(!1);f.dispose();c.dispose();k.dispose();a.setViewport(m,r,v,x);a.bindFramebuffer(e);b.src="";return 255===g[0]});return d.apply(this,arguments)}q.testSVGPremultipliedAlpha=function(a){return d.apply(this,arguments)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/capabilities/Capabilities":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ./DisjointTimerQuery ./DrawBuffers ./Instancing ./load ./LoseContext ./VertexArrayObjects".split(" "),
function(q,t,D,E,C,A,n,l){let d=function(){function a(b,c){this.gl=b;this._textureFloatLinear=this._fragDepth=this._shaderTextureLOD=this._standardDerivatives=this._depthTexture=null;this._disabledExtensions=c.disabledExtensions||{};this._debugWebGLExtensions=c.debugWebGLExtensions||{}}a.prototype.enable=function(b){return this[b]};t._createClass(a,[{key:"drawBuffers",get:function(){this._drawBuffers||(this._drawBuffers=E.load(this.gl,this._disabledExtensions));return this._drawBuffers}},{key:"instancing",
get:function(){this._instancing||(this._instancing=C.load(this.gl));return this._instancing}},{key:"vao",get:function(){this._vertexArrayObject||(this._vertexArrayObject=l.load(this.gl,this._disabledExtensions));return this._vertexArrayObject}},{key:"compressedTextureETC",get:function(){this._compressedTextureETC||(this._compressedTextureETC=A.loadCompressedTextureETC(this.gl,this._disabledExtensions));return this._compressedTextureETC}},{key:"compressedTextureS3TC",get:function(){this._compressedTextureS3TC||
(this._compressedTextureS3TC=A.loadCompressedTextureS3TC(this.gl,this._disabledExtensions));return this._compressedTextureS3TC}},{key:"textureFilterAnisotropic",get:function(){this._textureFilterAnisotropic||(this._textureFilterAnisotropic=A.loadTextureFilterAnisotropicCapability(this.gl,this._disabledExtensions));return this._textureFilterAnisotropic}},{key:"disjointTimerQuery",get:function(){this._disjointTimerQuery||(this._disjointTimerQuery=D.createDisjointTimerQuery(this.gl,this._disabledExtensions));
return this._disjointTimerQuery}},{key:"textureFloat",get:function(){this._textureFloat||(this._textureFloat=A.loadTextureFloat(this.gl,this._disabledExtensions));return this._textureFloat}},{key:"colorBufferFloat",get:function(){this._colorBufferFloat||(this._colorBufferFloat=A.loadColorBufferFloat(this.gl,this._disabledExtensions));return this._colorBufferFloat}},{key:"blendMinMax",get:function(){this._minMaxBlending||(this._minMaxBlending=A.loadMinMaxBlending(this.gl,this._disabledExtensions));
return this._minMaxBlending}},{key:"depthTexture",get:function(){null===this._depthTexture&&(this._depthTexture=A.loadBooleanExtension(this.gl,this._disabledExtensions,"depthTexture",!0,["WEBGL_depth_texture","MOZ_WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]));return this._depthTexture}},{key:"standardDerivatives",get:function(){null===this._standardDerivatives&&(this._standardDerivatives=A.loadBooleanExtension(this.gl,this._disabledExtensions,"standardDerivatives",!0,["OES_standard_derivatives"]));
return this._standardDerivatives}},{key:"shaderTextureLOD",get:function(){null===this._shaderTextureLOD&&(this._shaderTextureLOD=A.loadBooleanExtension(this.gl,this._disabledExtensions,"shaderTextureLOD",!0,["EXT_shader_texture_lod"]));return this._shaderTextureLOD}},{key:"fragDepth",get:function(){null===this._fragDepth&&(this._fragDepth=A.loadBooleanExtension(this.gl,this._disabledExtensions,"fragDepth",!0,["EXT_frag_depth"]));return this._fragDepth}},{key:"loseContext",get:function(){this._loseContext||
(this._loseContext=n.load(this.gl,this._debugWebGLExtensions));return this._loseContext}},{key:"textureNorm16",get:function(){this._textureNorm16||(this._textureNorm16=A.loadTextureNorm16(this.gl,this._disabledExtensions));return this._textureNorm16}},{key:"textureFloatLinear",get:function(){null===this._textureFloatLinear&&(this._textureFloatLinear=A.loadBooleanExtension(this.gl,this._disabledExtensions,"textureFloatLinear",!1,["OES_texture_float_linear"]));return this._textureFloatLinear}}]);return a}();
q.Capabilities=d;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/capabilities/DrawBuffers":function(){define(["exports","./isWebGL2Context"],function(q,t){q.load=function(D,E){return E.disjointTimerQuery?null:t(D)?{drawBuffers:D.drawBuffers.bind(D),MAX_DRAW_BUFFERS:D.MAX_DRAW_BUFFERS,MAX_COLOR_ATTACHMENTS:D.MAX_COLOR_ATTACHMENTS}:E.drawBuffers?null:(D=D.getExtension("WEBGL_draw_buffers"))?{drawBuffers:D.drawBuffersWEBGL.bind(D),MAX_DRAW_BUFFERS:D.MAX_DRAW_BUFFERS_WEBGL,
MAX_COLOR_ATTACHMENTS:D.MAX_COLOR_ATTACHMENTS_WEBGL}:null};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/capabilities/Instancing":function(){define(["exports","./isWebGL2Context"],function(q,t){q.load=function(D){return t(D)?{drawArraysInstanced:D.drawArraysInstanced.bind(D),drawElementsInstanced:D.drawElementsInstanced.bind(D),vertexAttribDivisor:D.vertexAttribDivisor.bind(D)}:(D=D.getExtension("ANGLE_instanced_arrays"))?{drawArraysInstanced:D.drawArraysInstancedANGLE.bind(D),
drawElementsInstanced:D.drawElementsInstancedANGLE.bind(D),vertexAttribDivisor:D.vertexAttribDivisorANGLE.bind(D)}:null};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/capabilities/load":function(){define(["exports","./isWebGL2Context"],function(q,t){q.loadBooleanExtension=function(D,E,C,A,n){if(A&&t(D))return!0;if(E[C])return!1;for(const l of n)if(D.getExtension(l))return!0;return!1};q.loadColorBufferFloat=function(D,E){if(t(D)){var C=
!E.colorBufferHalfFloat&&D.getExtension("EXT_color_buffer_half_float")||!E.colorBufferFloat&&D.getExtension("EXT_color_buffer_float"),A=!E.colorBufferFloat&&D.getExtension("EXT_color_buffer_float");E=!E.floatBlend&&!E.colorBufferFloat&&D.getExtension("EXT_float_blend");return C||A||E?{textureFloat:!!A,textureHalfFloat:!!C,floatBlend:!!E,R16F:D.R16F,RG16F:D.RG16F,RGBA16F:D.RGBA16F,R32F:D.R32F,RG32F:D.RG32F,RGBA32F:D.RGBA32F,R11F_G11F_B10F:D.R11F_G11F_B10F,RGB16F:D.RGB16F}:null}return D instanceof WebGLRenderingContext?
(C=!E.colorBufferHalfFloat&&D.getExtension("EXT_color_buffer_half_float"),A=!E.colorBufferFloat&&D.getExtension("WEBGL_color_buffer_float"),D=!E.floatBlend&&!E.colorBufferFloat&&D.getExtension("EXT_float_blend"),C||A||D?{textureFloat:!!A,textureHalfFloat:!!C,floatBlend:!!D,RGBA16F:C?C.RGBA16F_EXT:void 0,RGB16F:C?C.RGB16F_EXT:void 0,RGBA32F:A?A.RGBA32F_EXT:void 0}:null):null};q.loadCompressedTextureETC=function(D,E){return E.compressedTextureETC?null:(D=D.getExtension("WEBGL_compressed_texture_etc"))?
{COMPRESSED_R11_EAC:D.COMPRESSED_R11_EAC,COMPRESSED_SIGNED_R11_EAC:D.COMPRESSED_SIGNED_R11_EAC,COMPRESSED_RG11_EAC:D.COMPRESSED_RG11_EAC,COMPRESSED_SIGNED_RG11_EAC:D.COMPRESSED_SIGNED_RG11_EAC,COMPRESSED_RGB8_ETC2:D.COMPRESSED_RGB8_ETC2,COMPRESSED_SRGB8_ETC2:D.COMPRESSED_SRGB8_ETC2,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:D.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:D.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2,COMPRESSED_RGBA8_ETC2_EAC:D.COMPRESSED_RGBA8_ETC2_EAC,
COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:D.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC}:null};q.loadCompressedTextureS3TC=function(D,E){return E.compressedTextureS3TC?null:(D=D.getExtension("WEBGL_compressed_texture_s3tc"))?{COMPRESSED_RGB_S3TC_DXT1:D.COMPRESSED_RGB_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT1:D.COMPRESSED_RGBA_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT3:D.COMPRESSED_RGBA_S3TC_DXT3_EXT,COMPRESSED_RGBA_S3TC_DXT5:D.COMPRESSED_RGBA_S3TC_DXT5_EXT}:null};q.loadMinMaxBlending=function(D,E){return t(D)?{MIN:D.MIN,
MAX:D.MAX}:E.blendMinMax?null:(D=D.getExtension("EXT_blend_minmax"))?{MIN:D.MIN_EXT,MAX:D.MAX_EXT}:null};q.loadTextureFilterAnisotropicCapability=function(D,E){return E.textureFilterAnisotropic?null:(D=D.getExtension("EXT_texture_filter_anisotropic")||D.getExtension("MOZ_EXT_texture_filter_anisotropic")||D.getExtension("WEBKIT_EXT_texture_filter_anisotropic"))?{MAX_TEXTURE_MAX_ANISOTROPY:D.MAX_TEXTURE_MAX_ANISOTROPY_EXT,TEXTURE_MAX_ANISOTROPY:D.TEXTURE_MAX_ANISOTROPY_EXT}:null};q.loadTextureFloat=
function(D,E){if(t(D))return{textureFloat:!0,textureFloatLinear:!E.textureFloatLinear&&!!D.getExtension("OES_texture_float_linear"),textureHalfFloat:!0,textureHalfFloatLinear:!0,HALF_FLOAT:D.HALF_FLOAT,R16F:D.R16F,RG16F:D.RG16F,RGBA16F:D.RGBA16F,R32F:D.R32F,RG32F:D.RG32F,RGBA32F:D.RGBA32F,R11F_G11F_B10F:D.R11F_G11F_B10F,RGB16F:D.RGB16F};if(D instanceof WebGLRenderingContext){const C=!E.textureHalfFloat&&D.getExtension("OES_texture_half_float");return{textureFloat:!E.textureFloat&&!!D.getExtension("OES_texture_float"),
textureFloatLinear:!E.textureFloatLinear&&!!D.getExtension("OES_texture_float_linear"),textureHalfFloat:!!C,textureHalfFloatLinear:!E.textureHalfFloatLinear&&!!D.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:C?C.HALF_FLOAT_OES:void 0}}return null};q.loadTextureNorm16=function(D,E){return!t(D)||E.textureNorm16?null:(D=D.getExtension("EXT_texture_norm16"))?{R16:D.R16_EXT,RG16:D.RG16_EXT,RGB16:D.RGB16_EXT,RGBA16:D.RGBA16_EXT,R16_SNORM:D.R16_SNORM_EXT,RG16_SNORM:D.RG16_SNORM_EXT,RGB16_SNORM:D.RGB16_SNORM_EXT,
RGBA16_SNORM:D.RGBA16_SNORM_EXT}:null};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/capabilities/LoseContext":function(){define(["exports"],function(q){q.load=function(t,D){const E=D.loseContext&&t.getExtension("WEBGL_lose_context");return E?{loseRenderingContext:()=>E.loseContext()}:null};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/capabilities/VertexArrayObjects":function(){define(["exports",
"./isWebGL2Context"],function(q,t){q.load=function(D,E){return t(D)?{createVertexArray:D.createVertexArray.bind(D),deleteVertexArray:D.deleteVertexArray.bind(D),bindVertexArray:D.bindVertexArray.bind(D)}:E.vao?null:(D=D.getExtension("OES_vertex_array_object")||D.getExtension("MOZ_OES_vertex_array_object")||D.getExtension("WEBKIT_OES_vertex_array_object"))?{createVertexArray:D.createVertexArrayOES.bind(D),deleteVertexArray:D.deleteVertexArrayOES.bind(D),bindVertexArray:D.bindVertexArrayOES.bind(D)}:
null};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/LabelManager":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Error ../../core/HandleOwner ../../core/has ../../core/Logger ../../core/throttle ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./engine/webgl/collisions/CollisionEngine".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c,f){n.getLogger("esri.views.2d.layers.labels.LabelManager");D=function(h){function p(e){e=h.call(this,e)||this;e._applyVisibilityPassThrottled=l.throttle(e._applyVisibilityPass,32,q._assertThisInitialized(e));e.lastUpdateId=-1;e.updateRequested=!1;e.view=null;return e}q._inheritsLoose(p,h);var k=p.prototype;k.initialize=function(){this.collisionEngine=new f.CollisionEngine};k.destroy=function(){this.collisionEngine=null;this._applyVisibilityPassThrottled.remove();this._applyVisibilityPassThrottled=
null};k.update=function(e){this._applyVisibilityPassThrottled(e)};k.viewChange=function(){this.requestUpdate()};k.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate())};k.processUpdate=function(e){this._set("updateParameters",e);this.updateRequested&&(this.updateRequested=!1,this.update(e))};k._applyVisibilityPass=function(e){try{const m=this.view.featuresTilingScheme.getClosestInfoForScale(e.state.scale).level;this.collisionEngine.run(this.view.allLayerViews.items,
e,m)}catch(m){}};q._createClass(p,[{key:"updating",get:function(){return this.updateRequested}}]);return p}(C.HandleOwnerMixin(D));t.__decorate([d.property()],D.prototype,"updateRequested",void 0);t.__decorate([d.property({readOnly:!0})],D.prototype,"updateParameters",void 0);t.__decorate([d.property()],D.prototype,"updating",null);t.__decorate([d.property()],D.prototype,"view",void 0);return D=t.__decorate([c.subclass("esri.views.2d.layers.labels.LabelManager")],D)})},"esri/views/2d/engine/webgl/collisions/CollisionEngine":function(){define("exports ../../../../../core/maybe ../../../../../core/screenUtils ../definitions ./CollisionGrid ./visualVariableSimpleUtils".split(" "),
function(q,t,D,E,C,A){function n(b,c){const f=[];b.forEachTile(h=>f.push(h));f.sort((h,p)=>h.instanceId-p.instanceId);f.forEach(h=>{t.isSome(h.labelMetrics)&&h.isReady&&c(h,h.labelMetrics.getCursor())})}function l(b){return c=>D.pt2px(A.getSizeForValueSimple(c,b))}function d(b){for(const c of b)if(b="featureReduction"in c&&c.featureReduction&&"labelingInfo"in c.featureReduction&&c.featureReduction,b=(null==b?void 0:b.labelingInfo)||[],b=[...c.labelingInfo||[],...b],c.labelsVisible&&b.length&&b.some(f=>
"none"===f.deconflictionStrategy))return!0;return!1}let a=function(){function b(){}var c=b.prototype;c.run=function(f,h,p){const k=[];for(let v=f.length-1;0<=v;v--)a:{var e=void 0,m=k,r=f[v];if(!r.layer||"feature"!==r.layer.type&&"csv"!==r.layer.type&&"geojson"!==r.layer.type&&"ogc-feature"!==r.layer.type&&"stream"!==r.layer.type&&"subtype-group"!==r.layer.type&&"wfs"!==r.layer.type)break a;const x=r.layer.geometryType,g=!d("subtype-group"===r.layer.type?r.layer.sublayers.items:[r.layer]),u={};if("subtype-group"!==
r.layer.type){if("heatmap"===(null==(e=r.tileRenderer)?void 0:e.type))break a;b:{e=r.layer.renderer;if(e="visualVariables"in e&&e.visualVariables)for(const y of e)if("size"===y.type){e=l(y);break b}e=null}u[0]=e}e=r.tileRenderer;t.isNone(e)||m.push({tileRenderer:e,vvEvaluators:u,deconflictionEnabled:g,geometryType:x,visible:r.layer.visible&&!r.suspended})}this._transformMetrics(k,h);this._runCollision(k,h,p)};c._runCollision=function(f,h,p){const [k,e]=h.state.size;h=new C.CollisionBitsetGrid(k*h.pixelRatio,
e*h.pixelRatio);for(const {tileRenderer:m,deconflictionEnabled:r,visible:v}of f){const x=m.featuresView.attributeView;r?v?(this._prepare(m),this._collideVisible(h,m,p),this._collideInvisible(h,m)):n(m,(g,u)=>{for(;u.nextId();)x.setLabelMinZoom(u.id,255)}):n(m,(g,u)=>{for(;u.nextId();)x.setLabelMinZoom(u.id,0)})}};c._isFiltered=function(f,h,p){h=h.getFilterFlags(f);f=!p.hasFilter||!!(h&E.FILTER_FLAG_0);p=t.isNone(p.featureEffect)||p.featureEffect.excludedLabelsVisible||!!(h&E.EFFECT_FLAG_0);return!(f&&
p)};c._prepare=function(f){const h=f.featuresView.attributeView,p=new Set;n(f,(k,e)=>{for(;e.nextId();)p.has(e.id)||(p.add(e.id),this._isFiltered(e.id,h,f.layerView)?h.setLabelMinZoom(e.id,254):0!==h.getLabelMinZoom(e.id)?h.setLabelMinZoom(e.id,255):h.setLabelMinZoom(e.id,0))})};c._collideVisible=function(f,h,p){const k=h.featuresView.attributeView,e=new Set;n(h,(m,r)=>{for(;r.nextId();)if(!e.has(r.id))if(m.key.level!==p)k.setLabelMinZoom(r.id,254);else if(0===k.getLabelMinZoom(r.id))switch(f.insertMetrics(r)){case C.HAS_COLLISION:k.setLabelMinZoom(r.id,
254);e.add(r.id);break;case C.NONE:k.setLabelMinZoom(r.id,0),e.add(r.id)}})};c._collideInvisible=function(f,h){const p=h.featuresView.attributeView,k=new Set;n(h,(e,m)=>{for(;m.nextId();)if(!k.has(m.id)&&255===p.getLabelMinZoom(m.id))switch(f.insertMetrics(m)){case C.HAS_COLLISION:p.setLabelMinZoom(m.id,255);k.add(m.id);break;case C.NONE:p.setLabelMinZoom(m.id,0),k.add(m.id)}})};c._transformMetrics=function(f,h){for(const {tileRenderer:p,geometryType:k,vvEvaluators:e}of f)n(p,(m,r)=>{const v=p.featuresView.attributeView;
m=m.transforms.labelMat2d;m[4]=Math.round(m[4]);m[5]=Math.round(m[5]);const x=m[4],g=m[5],u="polyline"===k;for(;r.next();){const G=r.boundsCount,H=r.anchorX,I=r.anchorY;var y=r.size,z=e[0];if(t.isSome(z)){var w=v.getVVSize(r.id);z=z(w);y=isNaN(z)||null==z||Infinity===z?y:z}z=y/2*r.directionX;y=y/2*r.directionY;for(w=0;w<G;w++){var B=H,F=r.anchorY;u?(B=B+r.boundsX(w)+z,F=F+r.boundsY(w)+y,h.state.rotation?(B=m[0]*B+m[2]*F+m[4],F=m[1]*B+m[3]*F+m[5]):(B+=x,F+=g),r.setBoundsComputedAnchorX(w,Math.floor(B)),
r.setBoundsComputedAnchorY(w,Math.floor(F))):(h.state.rotation?(B=m[0]*H+m[2]*I+m[4],F=m[1]*H+m[3]*I+m[5]):(B+=x,F+=g),B=B+r.boundsX(w)+z,F=F+r.boundsY(w)+y,r.setBoundsComputedAnchorX(w,B),r.setBoundsComputedAnchorY(w,F))}}})};return b}();q.CollisionEngine=a;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/collisions/CollisionGrid":function(){define(["exports","../../../../../core/mathUtils","../definitions","../../../layers/features/support/StaticBitSet"],
function(q,t,D,E){let C=function(){function n(d,a){this.width=d;this.height=a;d=Math.ceil(d/1);a=Math.ceil(a/1);this._cols=d;this._rows=a;this._cells=E.StaticBitSet.create(d*a)}var l=n.prototype;l.insertMetrics=function(d){const a=this._hasCollision(d);0===a&&this._markMetrics(d);return a};l.getCellId=function(d,a){return d+a*this._cols};l.has=function(d){return this._cells.has(d)};l.hasRange=function(d,a){return this._cells.hasRange(d,a)};l.set=function(d){this._cells.set(d)};l.setRange=function(d,
a){this._cells.setRange(d,a)};l._hasCollision=function(d){const a=d.id;let b=0,c=0;d.save();do{const f=d.boundsCount;b+=f;for(let h=0;h<f;h++){const p=d.boundsComputedAnchorX(h),k=d.boundsComputedAnchorY(h),e=d.boundsWidth(h)+2,m=d.boundsHeight(h)+2;switch(this._collide(p,k,e,m)){case 2:return 2;case 1:c++}}}while(d.peekId()===a&&d.next());d.restore();return b===c?1:0};l._collide=function(d,a,b,c){d-=b/2;a-=c/2;b=d+b;var f=a+c;if(0>b||0>f||d>this.width||a>this.height)return 1;c=t.clamp(Math.floor(d/
1),0,this._cols);var h=t.clamp(Math.floor(a/1),0,this._rows);d=t.clamp(Math.ceil(b/1),0,this._cols);a=t.clamp(Math.ceil(f/1),0,this._rows);for(b=h;b<=a;b++)for(f=c;f<=d;f++)if(h=this.getCellId(f,b),this.has(h))return 2;return 0};l._mark=function(d,a,b,c){d-=b/2;a-=c/2;b=d+b;var f=a+c;c=t.clamp(Math.floor(d/1),0,this._cols);var h=t.clamp(Math.floor(a/1),0,this._rows);d=t.clamp(Math.ceil(b/1),0,this._cols);a=t.clamp(Math.ceil(f/1),0,this._rows);for(b=h;b<=a;b++)for(f=c;f<=d;f++)h=this.getCellId(f,b),
this.set(h);return!1};l._markMetrics=function(d){const a=d.id;do{const b=d.boundsCount;for(let c=0;c<b;c++){const f=d.boundsComputedAnchorX(c),h=d.boundsComputedAnchorY(c),p=d.boundsWidth(c)+2,k=d.boundsHeight(c)+2;this._mark(f,h,p,k)}}while(d.peekId()===a&&d.next())};return n}(),A=function(){function n(d,a=2){this._bucketSize=d;this._rowsLength=D.TILE_SIZE/d;this._colsLength=D.TILE_SIZE/d;this._elementsPerBucket=a;this._grid=this._initGrid()}var l=n.prototype;l.checkOverlap=function(d,a){d=Math.floor(d/
this._bucketSize);a=Math.floor(a/this._bucketSize);return 0>d||d>=this._rowsLength||0>a||a>=this._colsLength?!0:this._grid[a*this._colsLength+d]>=this._elementsPerBucket};l.markUsed=function(d,a){this._grid[Math.floor(a/this._bucketSize)*this._colsLength+Math.floor(d/this._bucketSize)]+=1};l.reset=function(){this._grid=this._initGrid()};l._initGrid=function(){return new Uint8Array(this._rowsLength*this._colsLength)};return n}();q.CollisionBitsetGrid=C;q.CollisionGrid=A;q.HAS_COLLISION=2;q.NONE=0;
q.OUTSIDE_EXTENT=1;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/StaticBitSet":function(){define(["exports"],function(q){let t=function(){function D(C,A){this._mask=0;this._buf=C;this._mask=A}D.fromBuffer=function(C,A){return new D(C,A)};D.create=function(C,A=4294967295){C=new Uint32Array(Math.ceil(C/32));return new D(C,A)};var E=D.prototype;E._getIndex=function(C){return Math.floor(C/32)};E.has=function(C){C&=this._mask;
return!!(this._buf[this._getIndex(C)]&1<<C%32)};E.hasRange=function(C,A){for(;C%32&&C!==A;){if(this.has(C))return!0;C++}for(;A%32&&C!==A;){if(this.has(C))return!0;A--}if(C===A)return!1;for(C/=32;C!==A/32;C++)if(this._buf[C])return!0;return!1};E.set=function(C){C&=this._mask;const A=this._getIndex(C);this._buf[A]|=1<<C%32};E.setRange=function(C,A){for(;C%32&&C!==A;)this.set(C++);for(;A%32&&C!==A;)this.set(A--);if(C!==A)for(C/=32;C!==A/32;C++)this._buf[C]=4294967295};E.unset=function(C){C&=this._mask;
const A=this._getIndex(C);this._buf[A]&=4294967295^1<<C%32};E.resize=function(C){const A=this._buf;C=new Uint32Array(Math.ceil(C/32));C.set(A);this._buf=C};E.or=function(C){for(let A=0;A<this._buf.length;A++)this._buf[A]|=C._buf[A];return this};E.and=function(C){for(let A=0;A<this._buf.length;A++)this._buf[A]&=C._buf[A];return this};E.xor=function(C){for(let A=0;A<this._buf.length;A++)this._buf[A]^=C._buf[A];return this};E.ior=function(C){for(let A=0;A<this._buf.length;A++)this._buf[A]|=~C._buf[A];
return this};E.iand=function(C){for(let A=0;A<this._buf.length;A++)this._buf[A]&=~C._buf[A];return this};E.ixor=function(C){for(let A=0;A<this._buf.length;A++)this._buf[A]^=~C._buf[A];return this};E.any=function(){for(let C=0;C<this._buf.length;C++)if(this._buf[C])return!0;return!1};E.copy=function(C){for(let A=0;A<this._buf.length;A++)this._buf[A]=C._buf[A];return this};E.clone=function(){return new D(this._buf.slice(),this._mask)};E.clear=function(){for(let C=0;C<this._buf.length;C++)this._buf[C]=
0};E.forEachSet=function(C){for(let A=0;A<this._buf.length;A++){let n=this._buf[A],l=32*A;if(n)for(;n;)n&1&&C(l),n>>>=1,l++}};E.countSet=function(){let C=0;this.forEachSet(A=>{C++});return C};return D}();q.StaticBitSet=t;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/collisions/visualVariableSimpleUtils":function(){define(["exports","../../../../../core/mathUtils","../../../../../renderers/support/lengthUtils","../../../../../renderers/visualVariables/support/sizeVariableUtils"],
function(q,t,D,E){function C(d,a){switch(a.transformationType){case E.TransformationType.Additive:var b=A(a.minSize,d);return d+=b||a.minDataValue;case E.TransformationType.Constant:return b=(b=a.stops)&&b.length&&b[0].size,null==b&&(b=a.minSize),d=A(b,d);case E.TransformationType.ClampedLinear:b=(d-a.minDataValue)/(a.maxDataValue-a.minDataValue);var c=A(a.minSize,d),f=A(a.maxSize,d);d=d<=a.minDataValue?c:d>=a.maxDataValue?f:c+b*(f-c);return d;case E.TransformationType.Proportional:return b=d/a.minDataValue,
c=A(a.minSize,d),d=A(a.maxSize,d),d=t.clamp(b*c,c,d);case E.TransformationType.Stops:{const [h,p,k]=n(d,a.cache.ipData);h===p?d=A(a.stops[h].size,d):(b=A(a.stops[h].size,d),d=A(a.stops[p].size,d),d=b+(d-b)*k)}return d;case E.TransformationType.RealWorldSize:{b=D.meterIn[a.valueUnit];c=A(a.minSize,d);f=A(a.maxSize,d);({valueRepresentation:a}=a);let h=null;h="area"===a?2*Math.sqrt(d/l)/b:"radius"===a||"distance"===a?2*d/b:d/b;d=t.clamp(h,c,f)}return d;case E.TransformationType.Identity:return d;case E.TransformationType.Unknown:return null}}
function A(d,a){return"number"===typeof d?d:C(a,d)}function n(d,a){if(a){var b=0,c=a.length-1;a.some((f,h)=>{if(d<f)return c=h,!0;b=h;return!1});return[b,c,(d-a[b])/(a[c]-a[b])]}}const l=Math.PI;q.getSizeForValueSimple=C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/graphics/GraphicsView2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/BidiText ../../../../core/HandleOwner ../../../../core/has ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/reactiveUtils ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/SpatialReference ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/coordsUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/normalizeUtilsSync ../../../../geometry/support/spatialReferenceUtils ../../../../layers/graphics/data/projectionSupport ../../../../symbols/cim/CIMSymbolHelper ../../../../symbols/support/defaults ../../engine/webgl/definitions ../../engine/webgl/enums ../../engine/webgl/GraphicTile ../../engine/webgl/TileData ../../engine/webgl/WGLDisplayObject ../../engine/webgl/mesh/MeshData ../../engine/webgl/mesh/factories/WGLMeshFactory ../../engine/webgl/mesh/templates/WGLTemplateStore ../../engine/webgl/util/Matcher ../features/schemaUtils ../features/support/AttributeStore ../features/support/ComputedAttributeStorage ../features/support/GraphicsReader ./GraphicStore ./graphicsUtils ../support/cimSymbolUtils ../../../layers/GraphicsView ../../../webgl/capabilities ../features/createSymbolSchema".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c,f,h,p,k,e,m,r,v,x,g,u,y,z,w,B,F,G,H,I,L,N,J,K,O,W,aa,ba,S,M){function Q(V,P,X){if(X.has(V))return X.get(V);P={tile:P,addedOrModified:[],removed:[]};X.set(V,P);return P}const Y=A("esri-2d-graphic-debug");D=function(V){function P(R){R=V.call(this,R)||this;R._storage=new J.ComputedAttributeStorage;R._displayIds=new Map;R._controller=new AbortController;R._tiles=new Map;R._graphicStoreUpdate=!1;R._graphicsSet=new Set;R._matcher=Promise.resolve(null);R._tileUpdateSet=new Set;
R._tilesToUpdate=new Map;R._graphicIdToAbortController=new Map;R._attached=!1;R._updatingGraphicsTimer=null;R._hashToExpandedSymbol=new Map;R._hashToExpandedSymbolPromise=new Map;R._hashToCIMSymbolPromise=new Map;R._hashToCIM=new Map;R._processing=!1;R._needsProcessing=!1;R._pendingUpdate={added:new Set,updated:new Set,removed:new Set};R.lastUpdateId=-1;R.updateRequested=!1;R.graphicUpdateHandler=R.graphicUpdateHandler.bind(q._assertThisInitialized(R));return R}q._inheritsLoose(P,V);var X=P.prototype;
X.destroy=function(){this._updatingGraphicsTimer&&(clearTimeout(this._updatingGraphicsTimer),this._updatingGraphicsTimer=null,this.notifyChange("updating"));this._controller.abort();this.container.destroy();this._set("graphics",null);this._graphicStore.clear();this._attributeStore=null;this._hashToExpandedSymbol.clear();this.renderer=this.view=null;this._hashToCIM.clear();this._hashToCIMSymbolPromise.clear();this._hashToExpandedSymbolPromise.clear()};X._createMatcher=function(R,T,Z){R&&(R=L.createMatcherSchema({indexCount:0,
fields:{}},"feature",R),this._matcher=I.createMatcher(R,T,null,Z))};X._createDisplayId=function(R){this._displayIds.has(R)||this._displayIds.set(R,this._storage.createDisplayId());return this._displayIds.get(R)};X.initialize=function(){this._attributeStore=new N({type:"local",initialize:T=>Promise.resolve(this.container.attributeView.initialize(T)),update:T=>this.container.attributeView.requestUpdate(T),render:()=>this.container.requestRender()},S.getWebGLCapabilities("2d"),()=>this.notifyChange("updating"));
this.container.hasHighlight=()=>this._attributeStore.hasHighlight;const R=new H.WGLTemplateStore(this.container.getMaterialItems.bind(this.container),this.view.featuresTilingScheme.tileInfo);this._graphicStore=new O(this.view.featuresTilingScheme,this.view.state.scale,this.uid,this.graphics,T=>{this._createDisplayId(T.uid);this._setFilterState(T.uid,T.visible)},T=>{const Z=this._displayIds.get(T.uid);this._displayIds.delete(T.uid);this._storage.releaseDisplayId(Z)},this._hashToCIM);this._meshFactory=
new G.WGLMeshFactory(null,this.uid,R);this._templateStore=R;this.handles.add([d.watch(()=>this.renderer,T=>{this._createMatcher(T,R,this.container.stage.resourceManager);for(const Z of this.graphics)this._pendingUpdate.updated.add(Z);this.requestUpdate()}),this.view.graphicsTileStore.on("update",T=>this._onTileUpdate(T)),this.container.on("attach",()=>{Y&&this.container.enableRenderingBounds(()=>this._graphicStore.getAllBounds());0<this.graphics.items.length&&this._graphicsChangeHandler({target:this.graphics,
added:this.graphics.items,removed:[],moved:[]});this.handles.add(this.graphics.on("change",Z=>this._graphicsChangeHandler(Z)),"graphics");const T=this.container.stage.resourceManager;this._createMatcher(this.renderer,R,T);this._graphicStore.setResourceManager(T);this._attached=!0;this.notifyChange("updating")})]);this._onTileUpdate({added:this.view.graphicsTileStore.tiles,removed:[]})};X.hitTest=function(R){if(!this.view||!this.view.position)return[];const {resolution:T,rotation:Z}=this.view.state;
return this._graphicStore.hitTest(R.x,R.y,2,T,Z)};X.update=function(R){l.throwIfAborted(this._controller.signal);({resolution:R}=R.state);this._graphicStore.updateLevel(R);this._graphicStoreUpdate=!0;this.updateRequested=!1;0<this._pendingUpdate.updated.size&&(this._processing?this._needsProcessing=!0:this._updateGraphics())};X.viewChange=function(){this.requestUpdate()};X.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.requestUpdateCallback())};X.processUpdate=function(R){this.updateRequested&&
(this.updateRequested=!1,this.update(R))};X.graphicUpdateHandler=function(R){const {graphic:T,property:Z,newValue:ca}=R;switch(Z){case "attributes":case "geometry":case "symbol":this._pendingUpdate.updated.add(T);this.requestUpdate();break;case "visible":this._setFilterState(T.uid,ca),this._attributeStore.sendUpdates()}};X.setHighlight=function(R){const T=R.map(Z=>this._displayIds.get(Z));this._attributeStore.setHighlight(R,T)};X._getIntersectingTiles=function(R){R=this._graphicStore.getBounds(R);
if(!R||0===p.width(R)||0===p.height(R))return[];const T=W.intersectingInternationalDateline(R,this.view.spatialReference);return n.isSome(T)?[...new Set([...this.view.graphicsTileStore.boundsIntersections(T[0]),...this.view.graphicsTileStore.boundsIntersections(T[1])])]:this.view.graphicsTileStore.boundsIntersections(R)};X._updateTile=function(){var R=q._asyncToGenerator(function*(T){l.throwIfAborted(this._controller.signal);const Z=T.tile;var ca=this._getGraphicsData(this._templateStore,Z,T.addedOrModified);
ca=yield this._processGraphics(Z,ca);l.throwIfAborted(this._controller.signal);this._patchTile(Z.key,{type:"update",addOrUpdate:ca,remove:T.removed,end:!0,clear:!1,sort:!1});return ca});return function(T){return R.apply(this,arguments)}}();X._patchTile=function(R,T){this._tiles.has(R)&&(R=this._tiles.get(R),this.container.onTileData(R,T),this.container.requestRender())};X._graphicsChangeHandler=function(R){const T=this._pendingUpdate;for(const Z of R.added)T.added.add(Z);for(const Z of R.moved)T.updated.add(Z);
for(const Z of R.removed)this._pendingUpdate.added.has(Z)?T.added.delete(Z):T.removed.add(Z);this._processing?this._needsProcessing=!0:this._updateGraphics()};X._getGraphicsToUpdate=function(){const R={added:[],removed:[],updated:[]};if(!this.graphics)return R;const T=this._pendingUpdate;for(const Z of this.graphics.items)T.added.has(Z)?R.added.push(Z):T.updated.has(Z)&&R.updated.push(Z);for(const Z of T.removed)this._graphicStore.has(Z)&&R.removed.push(Z);T.added.clear();T.removed.clear();T.updated.clear();
return R};X._updateGraphics=function(){var R=q._asyncToGenerator(function*(){this._processing=!0;const {added:T,removed:Z,updated:ca}=this._getGraphicsToUpdate(),ja=this._tilesToUpdate;try{if(!this._graphicStoreUpdate){var {resolution:U}=this.view.state;this._graphicStore.updateLevel(U)}U=[];const ea=Array(T.length+Z.length);for(let ka=0;ka<ca.length;ka++){var da=ca[ka];const la=this._getIntersectingTiles(da);for(const ma of la){var fa=ma.id;Q(fa,ma,ja).removed.push(this._displayIds.get(da.uid))}U.push(this._updateGraphic(da,
null));ea[ka]=da}var ia=ca.length;for(da=0;da<T.length;da++){const ka=T[da];ea[ia+da]=ka;this._graphicsSet.add(ka);U.push(this._addGraphic(ka))}for(const ka of Z){this._abortProcessingGraphic(ka.uid);const la=this._getIntersectingTiles(ka);for(const ma of la)fa=ma.id,Q(fa,ma,ja).removed.push(this._displayIds.get(ka.uid));this._graphicsSet.delete(ka);this._graphicStore.remove(ka)}this._flipUpdatingGraphics();yield Promise.all(U);let ha;for(ia=0;ia<ea.length;ia++){ha=ea[ia];const ka=this._getIntersectingTiles(ha);
for(const la of ka)fa=la.id,Q(fa,la,ja).addedOrModified.push(ha)}this._graphicStore.updateZ();fa=[];for(const [,ka]of ja)fa.push(this._updateTile(ka));yield Promise.all(fa)}catch(ea){l.isAbortError(ea)}for(const ea of Z)try{const ha=yield this._getSymbolForGraphic(ea,null);if(ha){const ka=ha.hash();this._hashToExpandedSymbol.delete(ka)}}catch(ha){l.isAbortError(ha)}ja.clear();this.notifyChange("updating");this._processing=!1;this._needsProcessing&&(this._needsProcessing=!1,this._updateGraphics())});
return function(){return R.apply(this,arguments)}}();X._getArcadeInfo=function(R){const T=(R.attributes?Object.keys(R.attributes):[]).map(Z=>({name:Z,alias:Z,type:"string"===typeof R.attributes[Z]?"esriFieldTypeString":"esriFieldTypeDouble"}));return n.isNone(R.geometry)?null:{geometryType:e.getJsonType(R.geometry),spatialReference:h.fromJSON(R.geometry.spatialReference),fields:T}};X._getSymbolForGraphic=function(R,T){l.throwIfAborted(this._controller.signal);return n.isSome(R.symbol)?Promise.resolve(R.symbol):
n.isSome(this.renderer)?this.renderer.getSymbolAsync(R,{scale:this.view.scale,signal:n.isSome(T)?T.signal:null}):Promise.resolve(this._getNullSymbol(R))};X._getCIMSymbol=function(R,T,Z){var ca=this._hashToCIM.get(T);if(ca)return Promise.resolve(ca);R=x.symbolToCIM(R);if(n.isSome(R)){if("CIMSymbolReference"===R.type)return ca=R,this._hashToCIM.set(T,ca),Promise.resolve(ca);if(ca=this._hashToCIMSymbolPromise.get(T))return ca;ca=R.fetchCIMSymbol(Z).then(ja=>{this._hashToCIM.set(T,ja.data);this._hashToCIMSymbolPromise.delete(T);
return ja}).catch(ja=>{this._hashToCIMSymbolPromise.delete(T);l.throwIfAbortError(ja);return null});this._hashToCIMSymbolPromise.set(T,ca);return ca}return Promise.resolve(null)};X._expandCIMSymbol=function(R,T,Z,ca){var ja=this._hashToExpandedSymbol.get(Z);if(ja)return Promise.resolve(ja);if(ja=this._hashToExpandedSymbolPromise.get(Z))return ja;ja=this.container.stage;T=this._getArcadeInfo(T);const U=L.createSymbolSchemaOptions(null);R=M.createSymbolSchema(R,U);ja=aa.expandSymbol(R,T,ja.resourceManager,
ca);this._hashToExpandedSymbolPromise.set(Z,ja);ja.then(da=>{this._hashToExpandedSymbol.set(Z,da);this._hashToExpandedSymbolPromise.delete(Z);return da});return ja};X._getSymbolResources=function(){var R=q._asyncToGenerator(function*(T,Z){l.throwIfAborted(this._controller.signal);return this.container.stage?this._getSymbolForGraphic(T,Z).then(ca=>{const ja=ca.hash();return this._getCIMSymbol(ca,ja,Z).then(U=>n.isNone(U)?null:this._expandCIMSymbol(U,T,ja,Z).then(da=>{const fa=da.layers.filter(ia=>
"text"===ia.type&&"string"===typeof ia.text);if(fa&&0<fa.length){const ia=Array(fa.length);for(let ha=0;ha<fa.length;ha++){const ka=fa[ha],la=[],[ma]=E.bidiText(ka.text);ka.text=ma;for(let oa=0;oa<ma.length;oa++)la.push(ma.charCodeAt(oa));ia[ha]={symbol:ka,id:ha,glyphIds:la}}const ea=new Map;return this.container.getMaterialItems(ia).then(ha=>{for(let ka=0;ka<fa.length;ka++){const la=fa[ka];ea.set(la.cim,{text:la.text,mosaicItem:ha[ka].mosaicItem})}return{symbol:da,textInfo:ea,hash:ja}})}return{symbol:da,
hash:ja}}))}).catch(ca=>{l.throwIfAbortError(ca);return null}):null});return function(T,Z){return R.apply(this,arguments)}}();X._projectAndNormalizeGeometry=function(){var R=q._asyncToGenerator(function*(T,Z){l.throwIfAborted(this._controller.signal);if(n.isNone(T.geometry)||"mesh"===T.geometry.type)return null;var ca=T.geometry;e.isPolygon(ca)?ca.rings=ca.rings:e.isPolyline(ca)?ca.paths=ca.paths:e.isExtent(ca)&&(T=yield this._getSymbolForGraphic(T,Z),l.throwIfAborted(this._controller.signal),ca=
W.isMarkerSymbol(T.type)||W.isTextSymbol(T.type)?ca.center:W.polygonFromExtent(ca));yield v.checkProjectionSupport(ca.spatialReference,this.view.spatialReference);T=m.normalizeCentralMeridianForDisplay(ca);ca=v.project(T,ca.spatialReference,this.view.spatialReference);k.closeRingsAndFixWinding(ca);return ca});return function(T,Z){return R.apply(this,arguments)}}();X._onTileUpdate=function(R){const T=r.getInfo(this.view.spatialReference);if(R.added&&0<R.added.length)for(const Z of R.added)this._addNewTile(Z,
T);if(R.removed&&0<R.removed.length)for(const Z of R.removed)this._removeTile(Z.key)};X._addGraphic=function(){var R=q._asyncToGenerator(function*(T){this._abortProcessingGraphic(T.uid);l.throwIfAborted(this._controller.signal);var Z=new AbortController;this._graphicIdToAbortController.set(T.uid,Z);Z={signal:Z.signal};try{yield this._addOrUpdateGraphic(T,Z),l.throwIfAborted(this._controller.signal),this._graphicIdToAbortController.delete(T.uid)}catch(ca){if(this._graphicIdToAbortController.delete(T.uid),
!l.isAbortError(ca))throw ca;}});return function(T){return R.apply(this,arguments)}}();X._updateGraphic=function(R,T){l.throwIfAborted(this._controller.signal);const Z=this._projectAndNormalizeGeometry(R,T);T=this._getSymbolResources(R,T);return Promise.all([Z,T]).then(([ca,ja])=>{l.throwIfAborted(this._controller.signal);this._graphicStore.addOrModify(R,ja,ca)})};X._addOrUpdateGraphic=function(R,T){l.throwIfAborted(this._controller.signal);const Z=this._projectAndNormalizeGeometry(R,T);T=this._getSymbolResources(R,
T);return Promise.all([Z,T]).then(([ca,ja])=>{l.throwIfAborted(this._controller.signal);this._graphicsSet.has(R)&&this._graphicStore.addOrModify(R,ja,ca)})};X._addTile=function(R){var T=this.view.featuresTilingScheme.getTileBounds(p.create(),R);T=new z.GraphicTile(R,T[0],T[3]);this._tiles.set(R,T);this.container.addChild(T);return T};X._addNewTile=function(){var R=q._asyncToGenerator(function*(T,Z){const ca=this._addTile(T.key),ja=this._graphicStore.queryTileData(this._templateStore,T);if(0!==ja.length){if(Z){Z=
Math.round((Z.valid[1]-Z.valid[0])/T.resolution);for(var U of ja)U.geometry&&(e.isPoint(U.geometry)||e.isMultipoint(U.geometry))&&this._wrapPoints(U,Z)}U=T.key;this._tileUpdateSet.add(T.key);this.notifyChange("updating");try{const da={type:"update",clear:!1,addOrUpdate:yield this._processGraphics(T,ja),remove:[],end:!0,sort:!1};ca.patch(da);this._tileUpdateSet.delete(U);this.notifyChange("updating")}catch(da){if(this._tileUpdateSet.delete(U),this.notifyChange("updating"),!l.isAbortError(da))throw da;
}}});return function(T,Z){return R.apply(this,arguments)}}();X._removeTile=function(R){if(this._tiles.has(R)){var T=this._tiles.get(R);this.container.removeChild(T);T.destroy();this._tiles.delete(R)}};X._setFilterState=function(R,T){const Z=this._displayIds.get(R);R=this._attributeStore.getHighlightFlag(R);this._attributeStore.setData(Z,0,0,R|(T?u.FILTER_FLAG_0:0))};X._getGraphicsData=function(R,T,Z){const ca=r.getInfo(this.view.spatialReference);R=this._graphicStore.getGraphicsData(R,T,Z);if(ca){T=
Math.round((ca.valid[1]-ca.valid[0])/T.resolution);for(const ja of R)ja.geometry&&(e.isPoint(ja.geometry)||e.isMultipoint(ja.geometry))&&this._wrapPoints(ja,T)}return R};X._wrapPoints=function(R,T){const Z=R.geometry;e.isMultipoint(Z)?this._wrapMultipoint(Z,T):this._wrapPoint(R,T)};X._wrapMultipoint=function(R,T){var Z=R.points;const ca=[];let ja=0,U=0;for(const [da,fa]of Z)ca.push([da+ja,fa]),ja=0,T===W.TILE_SIZE?(Z=5*W.PIXEL_BUFFER,da+U<Z?(ca.push([T,0]),ja=-T):da+U>W.TILE_SIZE-Z&&(ca.push([-T,
0]),ja=T)):da+U<-W.PIXEL_BUFFER?(ca.push([T,0]),ja=-T):da+U>W.TILE_SIZE+W.PIXEL_BUFFER&&(ca.push([-T,0]),ja=T),U+=da;R.points=ca};X._wrapPoint=function(R,T){const Z=R.geometry;if(T===W.TILE_SIZE){const ca=5*W.PIXEL_BUFFER;Z.x<ca?R.geometry={points:[[Z.x,Z.y],[T,0]]}:Z.x>W.TILE_SIZE-ca&&(R.geometry={points:[[Z.x,Z.y],[-T,0]]})}else Z.x<-W.PIXEL_BUFFER?R.geometry={points:[[Z.x,Z.y],[T,0]]}:Z.x>W.TILE_SIZE+W.PIXEL_BUFFER&&(R.geometry={points:[[Z.x,Z.y],[-T,0]]})};X._processGraphics=function(R,T,Z){if(!T||
!T.length||!this._meshFactory)return null;const ca=K.GraphicsReader.from(T,this.uid),ja=this._meshFactory;return this._matcher.then(U=>ja.analyzeGraphics(ca,this.container.stage.resourceManager,U,null,null,Z).then(()=>{this._attributeStore.sendUpdates();return this._processAnalyzedGraphics(R,ca)}))};X._processAnalyzedGraphics=function(R,T){const Z=this._meshFactory;var ca=T.getSize();T=T.getCursor();const ja=new F.MeshData(R.key.id,{features:ca,records:ca,metrics:0},y.WGLSymbologyType.DEFAULT,!1,
!1);for(ca=[];T.next();){const U=T.readGraphic();U.insertAfter=-1===U.insertAfter?-1:this._displayIds.get(U.insertAfter);U.displayId=this._displayIds.get(U.attributes[this.uid]);const da=new B(U.displayId);da.insertAfter=U.insertAfter;ca.push(da);Z.writeGraphic(ja,T,R.level,this.container.stage.resourceManager)}R=ja.serialize(R.tileInfoView.tileInfo.isWrappable);return 1!==R.length?new w.TileData:w.TileData.fromVertexData(R[0].message,ca)};X._abortProcessingGraphic=function(R){this._graphicIdToAbortController.has(R)&&
this._graphicIdToAbortController.get(R).abort()};X._getNullSymbol=function(R){R=R.geometry;return e.isPolyline(R)?g.errorPolylineSymbol2D:e.isPolygon(R)||e.isExtent(R)?g.errorPolygonSymbol2D:g.errorPointSymbol2D};X._flipUpdatingGraphics=function(){this._updatingGraphicsTimer&&clearTimeout(this._updatingGraphicsTimer);this._updatingGraphicsTimer=setTimeout(()=>{this._updatingGraphicsTimer=null;this.notifyChange("updating")},160);this.notifyChange("updating")};q._createClass(P,[{key:"updating",get:function(){return!this._attached||
null!==this._updatingGraphicsTimer||0<this._tileUpdateSet.size||0<this._tilesToUpdate.size||this._attributeStore.isUpdating()}}]);return P}(ba.GraphicsView(C.HandleOwnerMixin(D)));t.__decorate([a.property({constructOnly:!0})],D.prototype,"requestUpdateCallback",void 0);t.__decorate([a.property()],D.prototype,"container",void 0);t.__decorate([a.property({constructOnly:!0})],D.prototype,"graphics",void 0);t.__decorate([a.property()],D.prototype,"updating",null);t.__decorate([a.property()],D.prototype,
"view",void 0);t.__decorate([a.property()],D.prototype,"updateRequested",void 0);return D=t.__decorate([f.subclass("esri.views.2d.layers.support.GraphicsView2D")],D)})},"esri/geometry/support/normalizeUtilsSync":function(){define("exports ../../core/maybe ./aaBoundingRect ./boundsUtils ./coordsUtils ./jsonUtils ./normalizeUtilsCommon ./spatialReferenceUtils".split(" "),function(q,t,D,E,C,A,n,l){function d(v,x){if(t.isNone(v))return null;var g=v.spatialReference,u=l.getInfo(g);v="toJSON"in v?v.toJSON():
v;if(!u)return v;g=l.isWebMercator(g)?102100:4326;const y=n.cutParams[g].maxX,z=n.cutParams[g].minX;if(A.isPoint(v))return b(v,y,z);if(A.isMultipoint(v))v.points=v.points.map(w=>b(w,y,z));else{if(A.isExtent(v))return a(v,u);if(A.isPolygon(v)||A.isPolyline(v)){g=E.getBoundsXY(m,v);u=g[0];g=g[2];const w=2*n.offsetMagnitude(u,z)*y;v=0===w?v:n.updatePolyGeometry(v,w);u+=w;g+=w;return g>y?k(v,y,x):u<z?k(v,z,x):v}}return v}function a(v,x){if(!x)return v;const g=c(v,x).map(u=>u.extent);return 2>g.length?
g[0]||v:2<g.length?(v.xmin=x.valid[0],v.xmax=x.valid[1],v):{rings:g.map(u=>[[u.xmin,u.ymin],[u.xmin,u.ymax],[u.xmax,u.ymax],[u.xmax,u.ymin],[u.xmin,u.ymin]])}}function b(v,x,g){if(Array.isArray(v)){var u=v[0];u>x?(g=n.offsetMagnitude(u,x),v[0]=u+-2*g*x):u<g&&(x=n.offsetMagnitude(u,g),v[0]=u+-2*x*g)}else u=v.x,u>x?(g=n.offsetMagnitude(u,x),v.x+=-2*g*x):u<g&&(x=n.offsetMagnitude(u,g),v.x+=-2*x*g);return v}function c(v,x){const g=[],{ymin:u,ymax:y,xmin:z,xmax:w}=v;var B=v.xmax-v.xmin;const [F,G]=x.valid,
{x:H,frameId:I}=f(v.xmin,x),{x:L,frameId:N}=f(v.xmax,x);v=H===L&&0<B;if(B>2*G){B={xmin:z<w?H:L,ymin:u,xmax:G,ymax:y};v={xmin:F,ymin:u,xmax:z<w?L:H,ymax:y};x={xmin:0,ymin:u,xmax:G,ymax:y};const J={xmin:F,ymin:u,xmax:0,ymax:y},K=[],O=[];h(B,x)&&K.push(I);h(B,J)&&O.push(I);h(v,x)&&K.push(N);h(v,J)&&O.push(N);for(let W=I+1;W<N;W++)K.push(W),O.push(W);g.push(new e(B,[I]),new e(v,[N]),new e(x,K),new e(J,O))}else H>L||v?g.push(new e({xmin:H,ymin:u,xmax:G,ymax:y},[I]),new e({xmin:F,ymin:u,xmax:L,ymax:y},
[N])):g.push(new e({xmin:H,ymin:u,xmax:L,ymax:y},[I]));return g}function f(v,x){const [g,u]=x.valid;x=2*u;var y=0;v>u?(y=Math.ceil(Math.abs(v-u)/x),v-=y*x):v<g&&(y=Math.ceil(Math.abs(v-g)/x),v+=y*x,y=-y);return{x:v,frameId:y}}function h(v,x){const {xmin:g,ymin:u,xmax:y,ymax:z}=x;return p(v,g,u)&&p(v,g,z)&&p(v,y,z)&&p(v,y,u)}function p(v,x,g){return x>=v.xmin&&x<=v.xmax&&g>=v.ymin&&g<=v.ymax?!0:!1}function k(v,x,g=!0){const u=!A.isPolyline(v);u&&C.closeRings(v);if(g)return(new r).cut(v,x);g=u?v.rings:
v.paths;const y=u?4:2,z=g.length;x*=-2;for(let w=0;w<z;w++){const B=g[w];if(B&&B.length>=y){const F=[];for(const G of B)F.push([G[0]+x,G[1]]);g.push(F)}}u?v.rings=g:v.paths=g;return v}let e=function(v,x){this.extent=v;this.frameIds=x};const m=D.create();let r=function(){function v(){this.linesIn=[];this.linesOut=[]}var x=v.prototype;x.cut=function(g,u){this.xCut=u;if(g.rings)this.closed=!0,u=g.rings,this.minPts=4;else if(g.paths)this.closed=!1,u=g.paths,this.minPts=2;else return null;for(var y of u)if(y&&
!(y.length<this.minPts)){u=!0;for(const z of y)u?(this.moveTo(z),u=!1):this.lineTo(z);this.closed&&this.close()}this._pushLineIn();this._pushLineOut();u=[];for(const z of this.linesIn)z&&z.length>=this.minPts&&u.push(z);y=-2*this.xCut;for(const z of this.linesOut)if(z&&z.length>=this.minPts){for(const w of z)w[0]+=y;u.push(z)}this.closed?g.rings=u:g.paths=u;return g};x.moveTo=function(g){this._pushLineIn();this._pushLineOut();this._prevSide=this._side(g[0]);this._moveTo(g[0],g[1],this._prevSide);
this._firstPt=this._prevPt=g};x.lineTo=function(g){const u=this._side(g[0]);if(-1===u*this._prevSide){const y=this._intersect(this._prevPt,g);this._lineTo(this.xCut,y,0);this._prevSide=0}this._lineTo(g[0],g[1],u);this._prevSide=u;this._prevPt=g};x.close=function(){const g=this._firstPt,u=this._prevPt;g[0]===u[0]&&g[1]===u[1]||this.lineTo(g);this._checkClosingPt(this.lineIn);this._checkClosingPt(this.lineOut)};x._moveTo=function(g,u,y){this.closed?(this.lineIn.push([0>=y?g:this.xCut,u]),this.lineOut.push([0<=
y?g:this.xCut,u])):(0>=y&&this.lineIn.push([g,u]),0<=y&&this.lineOut.push([g,u]))};x._lineTo=function(g,u,y){this.closed?(this._addPolyVertex(this.lineIn,0>=y?g:this.xCut,u),this._addPolyVertex(this.lineOut,0<=y?g:this.xCut,u)):0>y?(0===this._prevSide&&this._pushLineOut(),this.lineIn.push([g,u])):0<y?(0===this._prevSide&&this._pushLineIn(),this.lineOut.push([g,u])):0>this._prevSide?(this.lineIn.push([g,u]),this.lineOut.push([g,u])):0<this._prevSide&&(this.lineOut.push([g,u]),this.lineIn.push([g,u]))};
x._addPolyVertex=function(g,u,y){const z=g.length;1<z&&g[z-1][0]===u&&g[z-2][0]===u?g[z-1][1]=y:g.push([u,y])};x._checkClosingPt=function(g){const u=g.length;3<u&&g[0][0]===this.xCut&&g[u-2][0]===this.xCut&&g[1][0]===this.xCut&&(g[0][1]=g[u-2][1],g.pop())};x._side=function(g){return g<this.xCut?-1:g>this.xCut?1:0};x._intersect=function(g,u){return g[1]+(this.xCut-g[0])/(u[0]-g[0])*(u[1]-g[1])};x._pushLineIn=function(){this.lineIn&&this.lineIn.length>=this.minPts&&this.linesIn.push(this.lineIn);this.lineIn=
[]};x._pushLineOut=function(){this.lineOut&&this.lineOut.length>=this.minPts&&this.linesOut.push(this.lineOut);this.lineOut=[]};return v}();q.CutVertical=r;q.normalizeCentralMeridianForDisplay=function(v){return d(v,!1)};q.normalizeCentralMeridianSync=function(v){return d(v,!0)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(q,t,D,E,C,A,n){function l(k,e){if(!e)return null;if("x"in e){var m={x:0,y:0};[m.x,m.y]=k(e.x,e.y,c);null!=e.z&&(m.z=e.z);null!=e.m&&(m.m=e.m);return m}if("xmin"in e)return m={xmin:0,ymin:0,xmax:0,ymax:0},[m.xmin,m.ymin]=k(e.xmin,e.ymin,c),[m.xmax,m.ymax]=k(e.xmax,e.ymax,c),e.hasZ&&(m.zmin=e.zmin,m.zmax=e.zmax,m.hasZ=!0),e.hasM&&(m.mmin=e.mmin,m.mmax=e.mmax,m.hasM=!0),m;if("rings"in e)return{rings:d(e.rings,k),hasM:e.hasM,hasZ:e.hasZ};if("paths"in e)return{paths:d(e.paths,k),hasM:e.hasM,hasZ:e.hasZ};
if("points"in e)return{points:a(e.points,k),hasM:e.hasM,hasZ:e.hasZ}}function d(k,e){const m=[];for(const r of k)m.push(a(r,e));return m}function a(k,e){const m=[];for(const r of k)k=e(r[0],r[1],[0,0]),m.push(k),2<r.length&&k.push(r[2]),3<r.length&&k.push(r[3]);return m}function b(){b=t._asyncToGenerator(function*(k,e){e&&(k=Array.isArray(k)?k.map(m=>D.isSome(m.geometry)&&m.geometry.spatialReference):[k],yield E.initializeProjection(k.map(m=>({source:m,dest:e}))))});return b.apply(this,arguments)}
const c=[0,0],f=l.bind(null,n.lngLatToXY),h=l.bind(null,n.xyToLngLat),p=new (function(){function k(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}var e=k.prototype;e.push=function(){var m=t._asyncToGenerator(function*(r,v,x){if(!(r&&r.length&&v&&x)||A.equals(v,x))return r;const g={geometries:r,inSpatialReference:v,outSpatialReference:x,resolve:null};this._jobs.push(g);return new Promise(u=>{g.resolve=u;null===this._timer&&(this._timer=setTimeout(this._process,10))})});return function(r,
v,x){return m.apply(this,arguments)}}();e._process=function(){this._timer=null;const m=this._jobs.shift();if(m){var {geometries:r,inSpatialReference:v,outSpatialReference:x,resolve:g}=m;n.canProject(v,x)?A.isWebMercator(x)?g(r.map(f)):g(r.map(h)):g(E.projectMany(C.jsonAdapter,r,v,x,null,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return k}());q.checkProjectionSupport=function(k,e){return b.apply(this,arguments)};q.project=function(k,e,m,r){if(!k)return k;m||(m=e,e=k.spatialReference);
return A.isValid(e)&&A.isValid(m)&&!A.equals(e,m)?n.canProject(e,m)?(k=A.isWebMercator(m)?f(k):h(k),k.spatialReference=m,k):E.projectMany(C.jsonAdapter,[k],e,m,null,r)[0]:k};q.projectMany=function(k,e,m){return p.push(k,e,m)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],function(q){let t=function(n,l,d){this.x=n;this.y=l;this.spatialReference=d;this.m=this.z=void 0},D=function(n,l,d,
a){this.rings=n;this.spatialReference=l;this.hasM=this.hasZ=void 0;d&&(this.hasZ=d);a&&(this.hasM=a)},E=function(n,l,d,a){this.paths=n;this.spatialReference=l;this.hasM=this.hasZ=void 0;d&&(this.hasZ=d);a&&(this.hasM=a)},C=function(n,l,d,a){this.points=n;this.spatialReference=l;this.hasM=this.hasZ=void 0;d&&(this.hasZ=d);a&&(this.hasM=a)},A=function(n,l,d,a,b){this.xmin=n;this.ymin=l;this.xmax=d;this.ymax=a;this.spatialReference=b;this.mmax=this.mmin=this.zmax=this.zmin=void 0};q.jsonAdapter={convertToGEGeometry:function(n,
l){return null==l?null:n.convertJSONToGeometry(l)},exportPoint:function(n,l,d){d=new t(n.getPointX(l),n.getPointY(l),d);const a=n.hasZ(l),b=n.hasM(l);a&&(d.z=n.getPointZ(l));b&&(d.m=n.getPointM(l));return d},exportPolygon:function(n,l,d){return new D(n.exportPaths(l),d,n.hasZ(l),n.hasM(l))},exportPolyline:function(n,l,d){return new E(n.exportPaths(l),d,n.hasZ(l),n.hasM(l))},exportMultipoint:function(n,l,d){return new C(n.exportPoints(l),d,n.hasZ(l),n.hasM(l))},exportExtent:function(n,l,d){var a=n.hasZ(l);
const b=n.hasM(l);d=new A(n.getXMin(l),n.getYMin(l),n.getXMax(l),n.getYMax(l),d);a&&(a=n.getZExtent(l),d.zmin=a.vmin,d.zmax=a.vmax);b&&(n=n.getMExtent(l),d.mmin=n.vmin,d.mmax=n.vmax);return d}};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/GraphicTile":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ./DirtyMap ./DisplayRecordStore ./WGLBuffers ./WGLTile".split(" "),function(q,t,D,E,C,A){A=function(n){function l(){var a=
n.apply(this,arguments)||this;a._data=null;a._displayList=null;a._lastCommitTime=0;a._hasData=!1;a._invalidated=!1;a._wglBuffers=null;a._dirtyMap=new D;return a}t._inheritsLoose(l,n);var d=l.prototype;d.destroy=function(){n.prototype.destroy.call(this);this.clear()};d.getGeometry=function(a){return this._wglBuffers&&this._wglBuffers.has(a)?this._wglBuffers.get(a):null};d.getDisplayList=function(){return this._displayList};d.patch=function(a){if(!0===a.clear)this.clear(),this._hasData=!1;else{var b=
a.addOrUpdate,c=a.remove;!this._data&&b&&b.tileDisplayData.displayObjects.length?(b.tileDisplayData.computeDisplayList(),this._dirtyMap=new D,this._dispRecStore=E.fromTileData(b,this._dirtyMap),this._data=b,this._dirtyMap.markAllDirty(),this._hasData=!0,a.end&&this.ready()):this._data?b&&b.tileDisplayData.displayObjects.length||c.length?this._doPatchData(a):a.end&&this.ready():a.end&&this.ready();a.end&&!this._data&&this.clear();this.requestRender();this.emit("change")}};d.commit=function(a){if(!a.time||
a.time!==this._lastCommitTime)if(this._lastCommitTime=a.time,this.visible&&this._data&&(this._wglBuffers||(this._wglBuffers=new C(a.context)),this._dirtyMap.hasDirty()||this._invalidated))this._invalidated=!1,this._wglBuffers.upload(this._data.tileBufferData,this._dirtyMap),this._displayList=this._data.tileDisplayData.displayList.clone(),this._displayObjects=this._data.tileDisplayData.displayObjects.slice(),this._dirtyMap.markAllClean()};d.clear=function(){this._dispRecStore=this._displayList=this._data=
null;this._wglBuffers&&(this._wglBuffers.dispose(),this._wglBuffers=null)};d._doPatchData=function(a){this._invalidated=!0;this._patchData(a)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=E.fromTileData(this._data,this._dirtyMap));this.requestRender()};d._patchData=function(a){let b=!0;var c=a.addOrUpdate&&a.addOrUpdate.tileDisplayData&&a.addOrUpdate.tileDisplayData.displayObjects||[],f=(a.remove||[]).slice();for(var h of c)null!=h.insertAfter&&f.push(h.id);for(var p of f)if(f=
this._data.tileDisplayData.displayObjectRegistry.get(p)){this._data.tileDisplayData.displayList.removeFromList(f.displayRecords);for(var k of f.displayRecords)this._dispRecStore.delete(k);this._data.tileDisplayData.displayObjectRegistry.delete(p);f=this._data.tileDisplayData.displayObjects.indexOf(f);this._data.tileDisplayData.displayObjects.splice(f,1)}for(const v of c){c=this._data.tileDisplayData.displayObjectRegistry.get(v.id);let x;if(c){p=c.displayRecords;c.set(v);c.displayRecords=p;p=c.displayRecords.length;
for(k=0;k<p;++k)if(f=c.displayRecords[k],h=v.displayRecords[k],k>=v.displayRecords.length||f.geometryType!==h.geometryType||f.symbolLevel!==h.symbolLevel||f.zOrder!==h.zOrder||f.materialKey!==h.materialKey)this._dispRecStore.delete(c.displayRecords[k]),k<v.displayRecords.length&&(c.displayRecords[k]=void 0);c.displayRecords.length=v.displayRecords.length}else if(c=v.copy(),c.displayRecords=[],this._data.tileDisplayData.displayObjectRegistry.set(v.id,c),p=this._data.tileDisplayData.displayObjects,
null!=c.insertAfter?(x={},0<=c.insertAfter?(k=this._data.tileDisplayData.displayObjectRegistry.get(c.insertAfter))?(h=p.indexOf(k)+1,h<p.length?p.splice(h,0,c):(p.push(c),h=p.length)):(p.push(c),h=p.length):(p.unshift(c),h=0)):(p.push(c),h=p.length),x)for(k=0<v.displayRecords.length?1:0,f=0,--h;0<=h&&f<k;--h)for(var e=p[h].displayRecords.length-1;0<=e&&f<k;--e){var m=p[h].displayRecords[e],r=this._data.tileDisplayData.displayList.getDPInfoType();x[r]||(x[r]=m,++f)}p=v.displayRecords.length;for(k=
0;k<p;++k){f=v.displayRecords[k];(h=c.displayRecords[k])?(h.meshData=f.meshData,h.materialKey=f.materialKey):(h=f.copy(),h.vertexFrom=void 0,h.indexFrom=void 0,c.displayRecords[k]=h);m=f.geometryType;e=this._data.tileDisplayData.displayList.getDPInfoType();r=a.addOrUpdate.tileBufferData.geometries[m];m=r.vertexBuffer;r=r.indexBuffer;let g=void 0;x&&(g=x[e]?this._data.tileDisplayData.displayList.splitAfter(x[e]):-1);b=this._dispRecStore.setMeshData(h,f,m,r,g)&&b;x&&null!=h.indexFrom&&null!=h.indexFrom&&
(x[e]=h)}}return b};t._createClass(l,[{key:"hasData",get:function(){return!!this._hasData}},{key:"displayObjects",get:function(){var a;return null!=(a=this._displayObjects)?a:[]}}]);return l}(A.WGLTile);q.GraphicTile=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/DirtyMap":function(){define(function(){return function(){function q(){this._dirties=[{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,
vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1}]}var t=q.prototype;t.hasDirty=function(){return this._dirties.some(D=>-1!==D.indexCount||D.allDirty)};t.markAllClean=function(){for(const D of this._dirties)D.indexFrom=-1,D.indexCount=-1,D.vertexFrom=-1,D.vertexCount=-1,D.allDirty=!1};
t.markAllDirty=function(){for(const D of this._dirties)D.allDirty=!0};t.forEach=function(D){for(let E=0;E<this._dirties.length;++E){const {indexCount:C,indexFrom:A,vertexCount:n,vertexFrom:l,allDirty:d}=this._dirties[E],a={};let b=void 0,c=!1;if(d||-1!==l&&0<n)a.geometry={count:n,from:l,allDirty:d},c=!0;if(d||-1!==A&&0<C)b={count:C,from:A,allDirty:d},c=!0;c&&D({indices:b,vertices:a},E)}};t.markDirtyIndices=function(D,E,C){D=this._dirties[D];if(!D.allDirty)if(-1!==D.indexCount){const A=Math.min(D.indexFrom,
E);E=Math.max(D.indexFrom+D.indexCount,E+C)-A;D.indexFrom=A;D.indexCount=E}else D.indexFrom=E,D.indexCount=C};t.markDirtyVertices=function(D,E,C,A){D=this._dirties[D];D.allDirty||(-1!==D.vertexCount?(E=Math.min(D.vertexFrom,C),C=Math.max(D.vertexFrom+D.vertexCount,C+A)-E,D.vertexFrom=E,D.vertexCount=C):(D.vertexFrom=C,D.vertexCount=A))};return q}()})},"esri/views/2d/engine/webgl/DisplayRecordStore":function(){define(["../../../../core/has","./FreeList","./Utils"],function(q,t,D){const E=["FILL","LINE",
"MARKER","TEXT","LABEL"];return function(){function C(n,l,d,a){this._strides=n;this._displayList=l;this._freeListsAndStorage={};this._dirtyMap=null;this._dirtyMap=d;for(const b in n){this._freeListsAndStorage[b]={vtxFreeList:a?new t.FreeList(a):null,idxFreeList:a?new t.FreeList(a):null,vertexBuffers:{},indexBuffer:a?new Uint32Array(a):null};for(const c in n[b])this._freeListsAndStorage[b].vertexBuffers[c]={data:a?D.allocateTypedArrayBuffer(a,n[b][c]):null,stride:n[b][c]}}}C.fromTileData=function(n,
l){var d,a=n.getStrides(),b={};for(d=0;d<a.length;d++)b[E[d]]=a[d];d=b;a=[0,0,0,0,0];b=[0,0,0,0,0];var c=n.tileDisplayData.displayObjects;for(var f of c)for(var h of f.displayRecords)a[h.geometryType]=Math.max(a[h.geometryType],h.vertexFrom+h.vertexCount),b[h.geometryType]=Math.max(b[h.geometryType],h.indexFrom+h.indexCount);l=new C(d,n.tileDisplayData.displayList,l,null);for(f=0;f<n.tileBufferData.geometries.length;++f){h=a[f];c=b[f];var p=n.tileBufferData.geometries[f];d=l._storageFor(E[f]);const k=
n.tileBufferData.geometries[f].indexBuffer;d.indexBuffer=k;d.idxFreeList=new t.FreeList(k.length);d.idxFreeList.allocate(c);let e;for(const m in p.vertexBuffer)c=n.tileBufferData.geometries[f].vertexBuffer[m],d.vertexBuffers[m].data=c.data,d.vertexBuffers[m].stride=c.stride,p=D.strideToPackingFactor(c.stride),c=c.data.length*p/c.stride,e||(e=c);d.vtxFreeList=new t.FreeList(e);d.vtxFreeList.allocate(h)}return l};var A=C.prototype;A.delete=function(n){const l=E[n.geometryType];this._freeVertices(l,
n.vertexFrom,n.vertexCount);this._freeIndices(l,n.indexFrom,n.indexCount);this._displayList.removeFromList(n);n.vertexFrom=void 0;n.indexFrom=void 0};A.setMeshData=function(n,l,d,a,b){const c=E[n.geometryType];n.meshData=null;let f=void 0,h=void 0;void 0===n.vertexFrom?(h=l.vertexCount,f=this._allocateVertices(c,h)):l.vertexCount>n.vertexCount?(this._freeVertices(c,n.vertexFrom,n.vertexCount),h=l.vertexCount,f=this._allocateVertices(c,h)):l.vertexCount===n.vertexCount?(f=n.vertexFrom,h=n.vertexCount):
(this._freeVertices(c,n.vertexFrom+l.vertexCount,n.vertexCount-l.vertexCount),f=n.vertexFrom,h=l.vertexCount);let p=!0,k=void 0,e=void 0,m=void 0;void 0===n.indexFrom?(k=b,m=l.indexCount,e=this._allocateIndices(c,m)):l.indexCount>n.indexCount?(k=this._displayList.removeFromList(n),this._freeIndices(c,n.indexFrom,n.indexCount),m=l.indexCount,e=this._allocateIndices(c,m)):l.indexCount===n.indexCount?(p=!1,e=n.indexFrom,m=n.indexCount):(k=this._displayList.removeFromList(n),this._freeIndices(c,n.indexFrom+
l.indexCount,n.indexCount-l.indexCount),e=n.indexFrom,m=l.indexCount);if(-1!==f&&-1!==e){b=this._storageFor(c);D.copyMeshData(f,e,b.vertexBuffers,b.indexBuffer,l,d,a);n.vertexFrom=f;n.indexFrom=e;n.vertexCount=l.vertexCount;n.indexCount=l.indexCount;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(n.geometryType,n.indexFrom,n.indexCount);for(const r in d)this._dirtyMap.markDirtyVertices(n.geometryType,r,n.vertexFrom,n.vertexCount)}p&&this._displayList.addToList(n,k);return!0}-1!==f&&this._freeVertices(c,
f,h);-1!==e&&this._freeIndices(c,e,m);n.setMeshDataFromBuffers(l,d,a);n.vertexFrom=void 0;n.vertexCount=0;n.indexFrom=void 0;n.indexCount=0;return!1};A.tryAddMeshData=function(n,l){const d=l.vertexBuffer;l=l.indexBuffer;var a=E[n.geometryType];const b=this._allocateVertices(a,n.vertexCount);if(-1===b)return this._freeVertices(a,b,n.vertexCount),!1;const c=this._allocateIndices(a,n.indexCount);if(-1===c)return this._freeVertices(a,b,n.vertexCount),this._freeIndices(a,c,n.indexCount),!1;a=this._storageFor(a);
D.copyMeshData(b,c,a.vertexBuffers,a.indexBuffer,n,d,l);n.vertexFrom=b;n.indexFrom=c;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(n.geometryType,n.indexFrom,n.indexCount);for(const f in d)this._dirtyMap.markDirtyVertices(n.geometryType,f,b,n.vertexCount)}this._displayList.addToList(n);return!0};A._allocateVertices=function(n,l){n=this._storageFor(n);l=n.vtxFreeList.allocate(l);return-1===l||.5<n.vtxFreeList.fragmentation?-1:l};A._freeVertices=function(n,l,d){this._storageFor(n).vtxFreeList.free(l,
d)};A._freeIndices=function(n,l,d){this._storageFor(n).idxFreeList.free(l,d)};A._allocateIndices=function(n,l){n=this._storageFor(n);l=n.idxFreeList.allocate(l);return-1===l||.5<n.idxFreeList.fragmentation?-1:l};A._storageFor=function(n){return this._freeListsAndStorage[n]};A._stridesFor=function(n,l){return this._strides[n][l]};return C}()})},"esri/views/2d/engine/webgl/FreeList":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],function(q,t){let D=function(){function C(n){this._largestRange=
null;this._parent=n;this._updateLargestRange()}var A=C.prototype;A.rangeCreated=function(n){if(!this._largestRange||n.count>this._largestRange.count)this._largestRange=n};A.rangeResized=function(n,l){if(n===this._largestRange)n.count<l&&this._updateLargestRange();else if(!this._largestRange||n.count>this._largestRange.count)this._largestRange=n};A.findBestRange=function(n){let l=this._parent._freeHead,d=null;for(;null!==l;)l.count>=n&&(!d||l.count-n<d.count-n)&&(d=l),l=l.next;return d};A.findAdjacentRanges=
function(n,l){let d=!0,a=!1,b=null,c=this._parent._freeHead;for(;d&&!a;){const f=null!==c?c.from:this._parent._size;n>=(null!==b?b.from+b.count:0)&&n+l<=f?(d=!1,a=!0):null!==c?(b=c,c=c.next):d=!1}return[b,c]};A._updateLargestRange=function(){let n=null,l=this._parent._freeHead;for(;null!==l;){if(!n||l.count>n.count)n=l;l=l.next}this._largestRange=n};t._createClass(C,[{key:"largestRange",get:function(){return this._largestRange}}]);return C}(),E=function(){function C(n,l){this._allocated=0;this._size=
n;this._freeHead=0<n?{from:0,count:n,prev:null,next:null}:null;this._bookKeeper=l||new D(this);this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}var A=C.prototype;A.allocate=function(n){const l=this._bookKeeper.findBestRange(n);if(null===l)return-1;const d=l.from,a=l.count;l.from+=n;l.count-=n;this._bookKeeper.rangeResized(l,d,a);this._allocated+=n;0===l.count&&(n=null!==l.prev?this._freeHead:l.next,C._removeRange(l),this._freeHead=n);return d};A.free=function(n,l){const [d,a]=this._bookKeeper.findAdjacentRanges(n,
l);n={from:n,count:l,prev:d,next:a};null!==d&&(d.next=n);null!==a&&(a.prev=n);this._bookKeeper.rangeCreated(n);this._allocated-=l;if(null!==a&&n.from+n.count===a.from){l=n.from;var b=n.count;C._fuse(n,a);C._removeRange(a);this._bookKeeper.rangeResized(n,l,b);this._bookKeeper.rangeResized(a,void 0,0)}null!==d&&d.from+d.count===n.from&&(l=d.from,b=d.count,C._fuse(d,n),C._removeRange(n),this._bookKeeper.rangeResized(d,l,b),this._bookKeeper.rangeResized(n,void 0,0));this._freeHead=null!==n.prev?this._freeHead:
n};C._removeRange=function(n){null!==n.prev?null!==n.next?(n.prev.next=n.next,n.next.prev=n.prev):n.prev.next=null:null!==n.next&&(n.next.prev=null)};C._fuse=function(n,l){n.count+=l.count;n.next=l.next;l.from+=l.count;l.count=0;null!==l.next&&(l.next.prev=n)};t._createClass(C,[{key:"fragmentation",get:function(){const n=this._size-this._allocated;return 0===n?0:1-this._bookKeeper.largestRange.count/n}}]);return C}();q.FreeList=E;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/engine/webgl/WGLBuffers":function(){define(["./Utils","../../../webgl/BufferObject","../../../webgl/enums","../../../webgl/VertexArrayObject"],function(q,t,D,E){return function(){function C(n){this.geometryMap=q.createGeometryData(()=>({indexBuffer:t.BufferObject.createIndex(n,D.Usage.STATIC_DRAW),vao:null}),(l,d)=>({vertexBuffer:t.BufferObject.createVertex(n,q.C_VBO_INFO[d])}))}var A=C.prototype;A.dispose=function(){for(let n=0;5>n;n++){const l=this.geometryMap[n];if(l){l.data.vao&&
l.data.vao.dispose(!1);l.data.indexBuffer&&l.data.indexBuffer.dispose();for(const d in l.buffers)l.buffers[d]&&l.buffers[d].data.vertexBuffer.dispose()}}};A.get=function(n){const l=this.geometryMap[n];return{getVAO(d,a,b){if(!l.data.vao){const c={};for(const f in l.buffers)c[f]=l.buffers[f].data.vertexBuffer;l.data.vao=new E.VertexArrayObject(d,b,a,c,l.data.indexBuffer)}return l.data.vao}}};A.has=function(n){return null!=this.geometryMap[n]};A.upload=function(n,l){l.forEach((d,a)=>{this._upload(d,
a,n)})};A._upload=function(n,l,d){n.indices&&(n.indices.allDirty?this._uploadIndices(d,l):null!=n.indices.from&&null!=n.indices.count&&this._uploadIndices(d,l,n.indices.from,n.indices.count));if(n.vertices){n=n.vertices;for(const a in n){const b=n[a];b.allDirty?this._uploadVertices(d,l,a):null!=b.from&&null!=b.count&&this._uploadVertices(d,l,a,b.from,b.count)}}};A._uploadVertices=function(n,l,d,a,b){const c=this.geometryMap[l];c&&(l=n.geometries[l].vertexBuffer[d])&&(n=l.stride,l=l.data.buffer,c.buffers[d]&&
0<l.byteLength&&(null!=a&&null!=b?c.buffers[d].data.vertexBuffer.setSubData(l,a*n,a*n,(a+b)*n):c.buffers[d].data.vertexBuffer.setData(l)))};A._uploadIndices=function(n,l,d,a){const b=this.geometryMap[l];b&&(n=n.geometries[l].indexBuffer.buffer,b.data.indexBuffer&&0<n.byteLength&&(null!=d&&null!=a?b.data.indexBuffer.setSubData(n,4*d,4*d,4*(d+a)):b.data.indexBuffer.setData(n)))};return C}()})},"esri/views/2d/engine/webgl/WGLTile":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/mat2d ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../../../../chunks/vec2 ../../../../chunks/vec2f32 ./definitions ./TiledDisplayObject".split(" "),
function(q,t,D,E,C,A,n,l,d){let a=function(){function b(){}var c=b.prototype;c.acquire=function(f){return{refCount:1,version:-1,labelMat2d:C.create(),tileMat3:C.create(),dvs:C.create()}};c.release=function(f){};return b}();d=function(b){function c(h,p,k){return b.call(this,h,p,k,l.TILE_SIZE,l.TILE_SIZE)||this}t._inheritsLoose(c,b);var f=c.prototype;f.destroy=function(){b.prototype.destroy.call(this);this._transforms&&c.TransformCache.release(this.key.hash)};f.setTransform=function(h,p){var k=p/(h.resolution*
h.pixelRatio),e=this.transforms.tileMat3;const [m,r]=h.toScreenNoRotation([0,0],[this.x,this.y]);E.set(e,this.width/this.rangeX*k,0,0,0,this.height/this.rangeY*k,0,m,r,1);E.multiply(this.transforms.dvs,h.displayViewMat3,e);k=this.transforms.labelMat2d;p=h.getScreenTransform(k,p);e=n.create();A.transformMat2d(e,[this.x,this.y],p);D.fromTranslation(k,e);D.multiply(k,h.viewMat2d,k)};f._createTransforms=function(){return c.TransformCache.acquire(this.key.hash)};return c}(d.TiledDisplayObject);d.TransformCache=
new a;q.WGLTile=d;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/TiledDisplayObject":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/mat3","../DisplayObject","../../tiling/TileKey"],function(q,t,D,E,C){E=function(A){function n(d,a,b,c,f,h=c,p=f){var k=A.call(this)||this;k.triangleCountReportedInDebug=0;k.triangleCount=0;k.texture=null;k.key=new C(d);k.x=a;k.y=b;k.width=c;k.height=
f;k.rangeX=h;k.rangeY=p;return k}t._inheritsLoose(n,A);var l=n.prototype;l.destroy=function(){this.texture&&(this.texture.dispose(),this.texture=null)};l.setTransform=function(d,a){a/=d.resolution*d.pixelRatio;const b=this.transforms.tileMat3,[c,f]=d.toScreenNoRotation([0,0],[this.x,this.y]);D.set(b,this.width/this.rangeX*a,0,0,0,this.height/this.rangeY*a,0,c,f,1);D.multiply(this.transforms.dvs,d.displayViewMat3,b)};return n}(E.DisplayObject);q.TiledDisplayObject=E;Object.defineProperties(q,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/TileData":function(){define("exports ../../../../core/maybe ./enums ./MemoryRequirements ./TileBufferData ./TileDisplayData ./Utils ./WGLDisplayRecord ./cpuMapped/DisplayRecordReader ./mesh/VertexBuffer ./mesh/VertexVector ./util/Writer".split(" "),function(q,t,D,E,C,A,n,l,d,a,b,c){const f=new E,h=new E;E=function(){function p(){this.tileBufferData=this.tileDisplayData=null}var k=p.prototype;k.reshuffle=function(){f.reset();var e=
[[],[],[],[],[]];var m=this.tileDisplayData.displayObjects;for(var r of m)for(var v of r.displayRecords)e[v.geometryType].push(v);for(var x of e)for(var g of x)g&&f.needMore(g.geometryType,g.meshData?g.meshData.vertexCount:g.vertexCount,g.meshData?g.meshData.indexData.length:g.indexCount);x=e.length;g=new C;for(m=0;m<x;++m){g.geometries[m].indexBuffer=new Uint32Array(Math.round(1.5*f.indicesFor(m)));r=[];for(var u in this.tileBufferData.geometries[m].vertexBuffer)r.push(this.tileBufferData.geometries[m].vertexBuffer[u].stride);
r=p._computeVertexAlignment(r);v=Math.round(1.5*f.verticesFor(m));r=p._align(v,r);for(var y in this.tileBufferData.geometries[m].vertexBuffer)v=this.tileBufferData.geometries[m].vertexBuffer[y].stride,g.geometries[m].vertexBuffer[y]={stride:v,data:n.allocateTypedArrayBuffer(r,v)}}h.reset();this.tileDisplayData.displayList.clear();for(u=0;u<x;++u){y=e[u];for(const z of y){if(z.meshData)z.writeMeshDataToBuffers(h.verticesFor(u),g.geometries[u].vertexBuffer,h.indicesFor(u),g.geometries[u].indexBuffer),
z.meshData=null;else{y=this.tileBufferData.geometries[u].vertexBuffer;m=this.tileBufferData.geometries[u].indexBuffer;r=g.geometries[u].vertexBuffer;v=g.geometries[u].indexBuffer;const w=h.verticesFor(u),B=h.indicesFor(u);n.copyMeshData(w,B,r,v,z,y,m);z.vertexFrom=w;z.indexFrom=B}h.needMore(u,z.vertexCount,z.indexCount)}}for(const z of this.tileDisplayData.displayObjects)this.tileDisplayData.displayList.addToList(z.displayRecords);this.tileBufferData=g};k.getStrides=function(){const e=[];for(let m=
0;m<this.tileBufferData.geometries.length;++m){const r=this.tileBufferData.geometries[m];e[m]={};for(const v in r.vertexBuffer)e[m][v]=r.vertexBuffer[v].stride}return e};k.clone=function(){const e=new p;e.tileBufferData=this.tileBufferData.clone();e.tileDisplayData=this.tileDisplayData.clone();return e};k._guessSize=function(){const {displayObjects:e}=this.tileDisplayData,m=Math.min(e.length,4);let r=0;for(let v=0;v<m;v++)r=Math.max(r,e[v].displayRecords.length);return 2*(12*e.length+e.length*r*40)};
k.serialize=function(){const e=this.tileBufferData.serialize(),m=this.tileBufferData.getBuffers(),r=this.tileDisplayData.serialize(new c(Int32Array,this._guessSize())).buffer();m.push(r);return{result:{displayData:r,bufferData:e},transferList:m}};p.fromVertexData=function(e,m){const r={},v=new Map;for(const x of m)v.set(x.id,x);n.forEachGeometryType(x=>{const g=e.data[x];if(t.isSome(g)){const y=d.DisplayRecordReader.from(g.records).getCursor();for(;y.next();){var u=y.id;const z=y.materialKey,w=y.indexFrom,
B=y.indexCount,F=y.vertexFrom,G=y.vertexCount,H=v.get(u);u=new l(u,x,z);u.indexFrom=w;u.indexCount=B;u.vertexFrom=F;u.vertexCount=G;H.displayRecords.push(u)}r[x]=a.VertexBuffers.fromVertexData(g,x)}else r[x]=(new b.VertexVectors(x,0,D.WGLSymbologyType.DEFAULT)).intoBuffers()});return p.fromMeshData({displayObjects:m,vertexBuffersMap:r})};p.fromMeshData=function(e){const m=new p,r=new A,v=new C;r.displayObjects=e.displayObjects;for(const x in e.vertexBuffersMap){const g=e.vertexBuffersMap[x];v.geometries[x].indexBuffer=
g.indexBuffer;v.geometries[x].vertexBuffer=g.namedBuffers}m.tileDisplayData=r;m.tileBufferData=v;return m};p.bind=function(e,m){const r=new p;r.tileDisplayData=e;r.tileBufferData=m;return r};p.create=function(e,m){const r=new p;r.tileDisplayData=new A;r.tileDisplayData.displayObjects=e;const v=[0,0,0,0,0],x=[0,0,0,0,0],g=[[],[],[],[],[]];for(var u of e)for(var y of u.displayRecords)g[y.geometryType].push(y),v[y.geometryType]+=y.meshData.vertexCount,x[y.geometryType]+=y.meshData.indexData.length;e=
new C;m=[m.fill||{},m.line||{},m.icon||{},m.text||{},m.label||{}];for(u=0;5>u;u++){y=new Uint32Array(x[u]);{var z=m[u];var w=v[u];const B={};for(const F in z){const G={data:n.allocateTypedArrayBuffer(w,z[F]),stride:z[F]};B[F]=G}z=B}l.writeAllMeshDataToBuffers(g[u],z,y);e.geometries[u]={indexBuffer:y,vertexBuffer:z}}r.tileBufferData=e;return r};p._align=function(e,m){const r=e%m;return 0===r?e:e+(m-r)};p._computeVertexAlignment=function(e){let m=!1,r=!1;for(const v of e)2===v%4?m=!0:0!==v%4&&(r=!0);
return r?4:m?2:1};return p}();q.TileData=E;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/MemoryRequirements":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],function(q){return function(){function t(){this._byGeometryType=null}var D=t.prototype;D.reset=function(){this._byGeometryType=null};D.verticesFor=function(E){return this._byGeometryType?this._byGeometryType[E].vertices:0};D.indicesFor=function(E){return this._byGeometryType?
this._byGeometryType[E].indices:0};D.needMore=function(E,C,A){if(C||A)this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]),E=this._byGeometryType[E],E.vertices+=C,E.indices+=A};q._createClass(t,[{key:"satisfied",get:function(){return!this._byGeometryType}}]);return t}()})},"esri/views/2d/engine/webgl/TileBufferData":function(){define(["./Utils"],function(q){return function(){function t(){this.geometries=
[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}var D=t.prototype;D.clone=function(){const E=new t;for(let C=0;C<this.geometries.length;C++){const A=this.geometries[C],n=E.geometries[C];n.indexBuffer=A.indexBuffer.slice();n.vertexBuffer={};for(const l in A.vertexBuffer){const {data:d,stride:a}=A.vertexBuffer[l];n.vertexBuffer[l]={data:d.slice(),stride:a}}}return E};
t.deserialize=function(E){const C=new t;for(let A=0;5>A;++A){C.geometries[A].indexBuffer=new Uint32Array(E.geometries[A].indexBuffer);C.geometries[A].vertexBuffer={};for(const n in E.geometries[A].vertexBuffer)C.geometries[A].vertexBuffer[n]={data:q.allocateTypedArrayBufferwithData(E.geometries[A].vertexBuffer[n].data,E.geometries[A].vertexBuffer[n].stride),stride:E.geometries[A].vertexBuffer[n].stride}}return C};D.serialize=function(){const E={geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,
vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]};for(let C=0;5>C;++C)for(const A in this.geometries[C].vertexBuffer)E.geometries[C].vertexBuffer[A]={data:this.geometries[C].vertexBuffer[A].data.buffer,stride:this.geometries[C].vertexBuffer[A].stride};return E};
D.getBuffers=function(){const E=[];for(let C=0;5>C;++C){E.push(this.geometries[C].indexBuffer.buffer);for(const A in this.geometries[C].vertexBuffer)E.push(this.geometries[C].vertexBuffer[A].data.buffer)}return E};return t}()})},"esri/views/2d/engine/webgl/TileDisplayData":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","./GraphicDisplayList","./WGLDisplayObject","./util/serializationUtils"],function(q,t,D,E){return function(){function C(){}var A=C.prototype;A.computeDisplayList=
function(){this._displayList=new t;for(const n of this.displayObjects)for(const l of n.displayRecords)this._displayList.addToList(l)};A.clone=function(){const n=new C;this.displayObjects&&(n.displayObjects=this.displayObjects.map(l=>l.clone()));return n};A.serialize=function(n){E.serializeList(n,this.displayObjects);return n};A._deserializeObjects=function(n){var l=n.readInt32();l=Array(l);const d=new Map;for(let a=0;a<l.length;++a){const b=D.deserialize(n);l[a]=b;d.set(b.id,b)}this.displayObjects=
l;this._displayList=null;this._displayObjectRegistry=d};C.deserialize=function(n){const l=new C;l._deserializeObjects(n);return l};q._createClass(C,[{key:"displayObjectRegistry",get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;for(const n of this.displayObjects)this._displayObjectRegistry.set(n.id,n)}return this._displayObjectRegistry}},{key:"displayList",get:function(){return this._displayList}}]);return C}()})},"esri/views/2d/engine/webgl/GraphicDisplayList":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"./materialKey/MaterialKey"],function(q,t){function D(d,a,b,...c){a<d.length?d.splice(a,b,...c):d.push(...c)}let E=function(){function d(){this.symbolLevels=[]}var a=d.prototype;a.replay=function(b,c,f){for(const k of this.symbolLevels)for(const e of k.zLevels){var h=e.geometryDPInfo.unified;if(h)for(const m of h){const {geometryType:r,materialKey:v,indexFrom:x,indexCount:g}=m;h=t.MaterialKeyBase.load(v).symbologyType;h=b.painter.getBrush(r,h);var p=c.getGeometry(r);p={geometryType:r,materialKey:v,
indexFrom:x,indexCount:g,target:p};h.prepareState(b,c);h.drawGeometry(b,c,p,f)}}};a.clear=function(){this.symbolLevels.length=0};a.addToList=function(b,c){if(Array.isArray(b))for(const f of b)this._addToList(f,c);else this._addToList(b,c)};a.removeFromList=function(b){Array.isArray(b)||(b=[b]);let c=null;for(const f of b)c=this._removeFromList(f);return c};a.clone=function(){const b=new d;for(const c of this.symbolLevels)b.symbolLevels.push(c.clone());return b};a.splitAfter=function(b){const c=this._getDisplayList(b.symbolLevel,
b.zOrder),f=c.length,h=b.indexFrom+b.indexCount;for(let p=0;p<f;++p){const k=c[p];if(k.geometryType===b.geometryType&&h>k.indexFrom&&h<=k.indexFrom+k.indexCount)return h<k.indexFrom+k.indexCount&&(b=new C,b.geometryType=k.geometryType,b.materialKey=k.materialKey,b.indexFrom=h,b.indexCount=k.indexFrom+k.indexCount-h,c.splice(p+1,0,b),k.indexCount=h-k.indexFrom),p}};a._addToList=function(b,c){const f=this._getDisplayList(b.symbolLevel,b.zOrder);c=null!=c?c:f.length-1;var h=0<=c&&c<f.length?f[c]:null;
null!==h&&h.materialKey===b.materialKey&&h.indexFrom+h.indexCount===b.indexFrom&&h.geometryType===b.geometryType?h.indexCount+=b.indexCount:(h=new C,h.indexFrom=b.indexFrom,h.indexCount=b.indexCount,h.materialKey=b.materialKey,h.geometryType=b.geometryType,D(f,c+1,0,h))};a._removeFromList=function(b){const c=this._getDisplayList(b.symbolLevel,b.zOrder);var f=c.length;let h=void 0;for(var p=0;p<f;++p){var k=c[p];if(b.indexFrom+b.indexCount>k.indexFrom&&b.indexFrom<k.indexFrom+k.indexCount&&k.geometryType===
b.geometryType){h=p;break}}if(void 0!==h){f=c[h];if(b.indexFrom===f.indexFrom)return f.indexCount-=b.indexCount,f.indexFrom+=b.indexCount,0===f.indexCount&&D(c,h,1),h-1;if(b.indexFrom+b.indexCount===f.indexFrom+f.indexCount)return f.indexCount-=b.indexCount,0===f.indexCount?(D(c,h,1),h-1):h;{p=f.indexFrom;k=b.indexFrom-f.indexFrom;const e=b.indexCount;b=f.indexFrom+f.indexCount-(b.indexFrom+b.indexCount);f.indexCount=k;const m=new C;m.geometryType=f.geometryType;m.materialKey=f.materialKey;m.indexFrom=
p+k+e;m.indexCount=b;D(c,h+1,0,m);return h}}return null};a._getDisplayList=function(b,c){let f;var h=this.symbolLevels.length;for(let k=0;k<h;k++)if(this.symbolLevels[k].symbolLevel===b){f=this.symbolLevels[k];break}f||(f=new l,f.symbolLevel=b,this.symbolLevels.push(f));let p;b=f.zLevels.length;for(h=0;h<b;h++)if(f.zLevels[h].zLevel===c){p=f.zLevels[h];break}p||(p=new n,p.geometryDPInfo=new A,p.zLevel=c,f.zLevels.push(p));p.geometryDPInfo.unified||(p.geometryDPInfo.unified=[]);return p.geometryDPInfo.unified};
a.getDPInfoType=function(){return"unified"};q._createClass(d,[{key:"empty",get:function(){return!this.symbolLevels||0===this.symbolLevels.length}}]);return d}(),C=function(){function d(){this.materialKey=null;this.indexCount=this.indexFrom=0}d.prototype.clone=function(){const a=new d;a.geometryType=this.geometryType;a.materialKey=this.materialKey;a.indexFrom=this.indexFrom;a.indexCount=this.indexCount;return a};return d}(),A=function(){function d(){this.unified=this.label=this.text=this.marker=this.line=
this.fill=null}d.prototype.clone=function(){const a=new d;a.fill=this.fill&&this.fill.map(b=>b.clone());a.line=this.line&&this.line.map(b=>b.clone());a.marker=this.marker&&this.marker.map(b=>b.clone());a.text=this.text&&this.text.map(b=>b.clone());a.label=this.label&&this.label.map(b=>b.clone());a.unified=this.unified&&this.unified.map(b=>b.clone());return a};return d}(),n=function(){function d(){this.geometryDPInfo=new A}d.prototype.clone=function(){const a=new d;a.zLevel=this.zLevel;a.geometryDPInfo=
this.geometryDPInfo.clone();return a};return d}(),l=function(){function d(){this.zLevels=[]}d.prototype.clone=function(){const a=new d;a.symbolLevel=this.symbolLevel;for(const b of this.zLevels)a.zLevels.push(b.clone());return a};return d}();return E})},"esri/views/2d/engine/webgl/WGLDisplayObject":function(){define(["./WGLDisplayRecord","./util/serializationUtils"],function(q,t){return function(){function D(C){this.insertAfter=null;this.id=C;this.displayRecords=[]}var E=D.prototype;E.copy=function(){const C=
new D(this.id);C.set(this);return C};E.clone=function(){const C=new D(this.id);C.displayRecords=this.displayRecords.map(A=>A.clone());C.insertAfter=this.insertAfter;return C};E.set=function(C){this.id=C.id;this.displayRecords=C.displayRecords;this.insertAfter=C.insertAfter};E.serialize=function(C){C.push(this.id);t.serializeList(C,this.displayRecords);return C};D.deserialize=function(C){const A=C.readInt32(),n=new D(A);n.displayRecords=t.deserializeList(C,q,{id:A});return n};return D}()})},"esri/views/2d/engine/webgl/WGLDisplayRecord":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"./MeshData","./Utils"],function(q,t,D){return function(){function E(A,n,l,d=0,a=0){this.id=A;this.geometryType=n;this.materialKey=l;this.minZoom=d;this.maxZoom=a;this.meshData=null;this.indexCount=this.indexFrom=this.vertexCount=this.vertexFrom=this.zOrder=this.symbolLevel=0}var C=E.prototype;C.clone=function(){return this.copy()};C.copy=function(){const A=new E(this.id,this.geometryType,this.materialKey);A.vertexFrom=this.vertexFrom;A.vertexCount=this.vertexCount;A.indexFrom=this.indexFrom;A.indexCount=
this.indexCount;A.zOrder=this.zOrder;A.symbolLevel=this.symbolLevel;A.meshData=this.meshData;A.minZoom=this.minZoom;A.maxZoom=this.maxZoom;return A};C.setMeshDataFromBuffers=function(A,n,l){const d=new t;for(const a in n){const b=n[a].stride,c=n[a].data,f=[],h=D.strideToPackingFactor(b);for(let p=0;p<b*A.vertexCount/h;++p)f[p]=c[p+b*A.vertexFrom/h];d.vertexData.set(a,f)}d.indexData.length=0;for(n=0;n<A.indexCount;++n)d.indexData[n]=l[n+A.indexFrom]-A.vertexFrom;d.vertexCount=A.vertexCount;this.meshData=
d};C.readMeshDataFromBuffers=function(A,n){this.meshData?this.meshData.clear():this.meshData=new t;for(const l in A){const d=A[l].stride,a=A[l].data,b=[],c=D.strideToPackingFactor(d);for(let f=0;f<d*this.vertexCount/c;++f)b[f]=a[f+d*this.vertexFrom/c];this.meshData.vertexData.set(l,b)}this.meshData.indexData.length=0;for(A=0;A<this.indexCount;++A)this.meshData.indexData[A]=n[A+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=this.vertexCount};C.writeMeshDataToBuffers=function(A,n,l,d){for(const a in n){const b=
n[a].stride,c=this.meshData.vertexData.get(a),f=n[a].data,h=D.strideToPackingFactor(b);for(let p=0;p<b*this.meshData.vertexCount/h;++p)f[p+b*A/h]=c[p]}for(n=0;n<this.meshData.indexData.length;++n)d[n+l]=this.meshData.indexData[n]+A;this.vertexFrom=A;this.vertexCount=this.meshData.vertexCount;this.indexFrom=l;this.indexCount=this.meshData.indexData.length};E.writeAllMeshDataToBuffers=function(A,n,l){let d=0,a=0;for(const b of A)b.writeMeshDataToBuffers(d,n,a,l),d+=b.vertexCount,a+=b.indexCount};C._computeSortKey=
function(){this._sortKey=(this.symbolLevel&31)<<12|(this.zOrder&127)<<4|this.geometryType&7};C.serialize=function(A){A.push(this.geometryType);A.push(this.materialKey);A.push(this.vertexFrom);A.push(this.vertexCount);A.push(this.indexFrom);A.push(this.indexCount);A.push(this.minZoom);A.push(this.maxZoom);return A};E.deserialize=function(A,n){const l=A.readInt32(),d=A.readInt32();n=new E(n.id,l,d);n.vertexFrom=A.readInt32();n.vertexCount=A.readInt32();n.indexFrom=A.readInt32();n.indexCount=A.readInt32();
n.minZoom=A.readInt32();n.maxZoom=A.readInt32();return n};q._createClass(E,[{key:"sortKey",get:function(){void 0===this._sortKey&&this._computeSortKey();return this._sortKey}}]);return E}()})},"esri/views/2d/engine/webgl/MeshData":function(){define(function(){return function(){function q(){this.vertexData=new Map;this.vertexCount=0;this.indexData=[]}var t=q.prototype;t.clear=function(){this.vertexData.clear();this.vertexCount=0;this.indexData=[]};t.update=function(D,E,C){for(const A in D)this.vertexData.set(A,
D[A]);for(const A in this.vertexData)null===D[A]&&this.vertexData.delete(A);this.vertexCount=E;this.indexData=C};return q}()})},"esri/views/2d/engine/webgl/util/serializationUtils":function(){define(["exports"],function(q){q.deserializeList=function(t,D,E){var C=t.readInt32();C=Array(C);for(let A=0;A<C.length;A++)C[A]=D.deserialize(t,E);return C};q.serializeList=function(t,D){if(null===D)t.push(0);else{t.push(D.length);for(const E of D)E.serialize(t);return t}};Object.defineProperties(q,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/cpuMapped/DisplayRecordReader":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","../definitions"],function(q,t,D,E){let C=function(){function n(d){this._cursor=this._head=d}n.from=function(d,a=0,b=d.byteLength/A.BYTES_PER_RECORD-a){d=new A(new Int32Array(d,a*A.BYTES_PER_RECORD,b*A.ELEMENTS_PER_RECORD));return new n(d)};var l=n.prototype;l.size=function(){let d=this._cursor,
a=0;for(;d;)a+=d.size(),d=d._link;return a};l.seekIndex=function(d){for(this._cursor=this._head;this._cursor;){const a=this._cursor.size();if(d<a)return this._cursor._index=d,!0;d-=a;this._cursor=this._cursor._link}return!1};l.forEach=function(d){const a=this.getCursor();for(;a.next();)d(a)};l.link=function(d){if(this._head){for(var a=this._head;a._link;)a=a._link;a._link=d._head;a._link._indexStart=a._indexStart+a.size()}else this._head=d._head};l.getCursor=function(){return this.copy()};l.lookup=
function(d){for(this._cursor=this._head;this._cursor&&!this._cursor.lookup(d);){if(!this._cursor._link)return!1;this._cursor=this._cursor._link}return!!this._cursor};l.copy=function(){var d;const a=new n(null==(d=this._head)?void 0:d.copy());if(!a._head)return a;d=a._head;let b=a._head._link;for(;b;)d._link=b.copy(),d=b,b=d._link;return a};l.next=function(){if(!this._cursor)return!1;if(!this._cursor.next()){if(!this._cursor._link)return!1;this._cursor=this._cursor._link;return this.next()}return!0};
l.peekId=function(){var d;return null!=(d=this._cursor.peekId())?d:this._cursor._link.peekId()};l.delete=function(d){let a=this._head,b=null;for(;a;){if(a.delete(d))return a.isEmpty()&&(D.isSome(b)&&(b._link=a._link),a===this._head&&(this._head=a._link),a===this._cursor&&(this._cursor=a._link)),!0;b=a;a=a._link}return!1};t._createClass(n,[{key:"id",get:function(){return this._cursor.id},set:function(d){this._cursor.id=d}},{key:"materialKey",get:function(){return this._cursor.materialKey},set:function(d){this._cursor.materialKey=
d}},{key:"insertAfter",get:function(){return this._cursor.insertAfter}},{key:"indexFrom",get:function(){return this._cursor.indexFrom},set:function(d){this._cursor.indexFrom=d}},{key:"indexCount",get:function(){return this._cursor.indexCount},set:function(d){this._cursor.indexCount=d}},{key:"vertexFrom",get:function(){return this._cursor.vertexFrom},set:function(d){this._cursor.vertexFrom=d}},{key:"vertexCount",get:function(){return this._cursor.vertexCount},set:function(d){this._cursor.vertexCount=
d}},{key:"sortKey",get:function(){return this._cursor.sortKey},set:function(d){this._cursor.sortKey=d}},{key:"index",get:function(){return this._cursor._indexStart+this._cursor._index}}]);return n}();C.ELEMENTS_PER_RECORD=E.DISPLAY_RECORD_INT_PER_ELEMENT;C.BYTES_PER_RECORD=C.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT;let A=function(){function n(d){this._link=null;this._index=-1;this._deletedCount=this._indexStart=0;this._offsets={instance:null};this._packedRecords=d}n.from=function(d,a=0,b=
d.byteLength/this.BYTES_PER_RECORD-a){return new n(new Int32Array(d,a*this.BYTES_PER_RECORD,b*this.ELEMENTS_PER_RECORD))};var l=n.prototype;l.delete=function(d){const a=this._index,b=this.lookup(d);if(b)for(this.id=2147483647,++this._deletedCount;this.next()&&this.id===d;)this.id=2147483647,++this._deletedCount;this._index=a;return b};l.isEmpty=function(){return this._deletedCount===this.size()};l.link=function(d){this._link?this._link.link(d):this._link=d};l.lookup=function(d){if(D.isNone(this._offsets.instance)){this._offsets.instance=
new Map;var a=this.copy();a._index=-1;let b=0;for(;a.next();)a.id!==b&&(this._offsets.instance.set(a.id,a._index),b=a.id)}if(!this._offsets.instance.has(d))return!1;a=this._index;this._index=this._offsets.instance.get(d);return 2147483647===this.id?(this._index=a,!1):!0};l.size=function(){return this._packedRecords.length/n.ELEMENTS_PER_RECORD};l.next=function(){for(;++this._index<this.size()&&2147483647===this.id;);return this._index<this.size()};l.peekId=function(){const d=(this._index+1)*n.ELEMENTS_PER_RECORD;
return d>=this._packedRecords.length?0:this._packedRecords[d]};l.getCursor=function(){return this.copy()};l.copy=function(){const d=new n(this._packedRecords);d._indexStart=this._indexStart;d._link=this._link;d._index=this._index;d._offsets=this._offsets;d._deletedCount=this._deletedCount;return d};t._createClass(n,[{key:"id",get:function(){return this._packedRecords[this._index*n.ELEMENTS_PER_RECORD]},set:function(d){this._packedRecords[this._index*n.ELEMENTS_PER_RECORD]=d}},{key:"materialKey",get:function(){return this._packedRecords[this._index*
n.ELEMENTS_PER_RECORD+1]},set:function(d){this._packedRecords[this._index*n.ELEMENTS_PER_RECORD+1]=d}},{key:"insertAfter",get:function(){return this._packedRecords[this._index*n.ELEMENTS_PER_RECORD+2]}},{key:"indexFrom",get:function(){return this._packedRecords[this._index*n.ELEMENTS_PER_RECORD+3]},set:function(d){this._packedRecords[this._index*n.ELEMENTS_PER_RECORD+3]=d}},{key:"indexCount",get:function(){return this._packedRecords[this._index*n.ELEMENTS_PER_RECORD+4]},set:function(d){this._packedRecords[this._index*
n.ELEMENTS_PER_RECORD+4]=d}},{key:"vertexFrom",get:function(){return this._packedRecords[this._index*n.ELEMENTS_PER_RECORD+5]},set:function(d){this._packedRecords[this._index*n.ELEMENTS_PER_RECORD+5]=d}},{key:"vertexCount",get:function(){return this._packedRecords[this._index*n.ELEMENTS_PER_RECORD+6]},set:function(d){this._packedRecords[this._index*n.ELEMENTS_PER_RECORD+6]=d}},{key:"sortKey",get:function(){this._packedRecordsF32||(this._packedRecordsF32=new Float32Array(this._packedRecords.buffer));
return this._packedRecordsF32[this._index*n.ELEMENTS_PER_RECORD+7]},set:function(d){this._packedRecordsF32||(this._packedRecordsF32=new Float32Array(this._packedRecords.buffer));this._packedRecordsF32[this._index*n.ELEMENTS_PER_RECORD+7]=d}},{key:"index",get:function(){return this._index}}]);return n}();A.ELEMENTS_PER_RECORD=E.DISPLAY_RECORD_INT_PER_ELEMENT;A.BYTES_PER_RECORD=A.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT;q.DisplayRecordReader=C;Object.defineProperties(q,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/VertexBuffer":function(){define(["exports","../Utils"],function(q,t){let D=function(){function C(A,n){this.data=A;this.stride=n}C.decode=function(A){const n=t.allocateTypedArrayBufferwithData(A.data,A.stride);return new C(n,A.stride)};C.fromVertexVector=function(A){const n=t.allocateTypedArrayBufferwithData(A.data.buffer(),A.stride);return new C(n,A.stride)};return C}(),E=function(){function C(A,n,l){this.geometryType=A;this.indexBuffer=
new Uint32Array(n);this.namedBuffers=l}C.decode=function(A){const n=A.geometryType,l=A.indexBuffer,d={};for(const a in A.namedBuffers)d[a]=D.decode(A.namedBuffers[a]);return new C(n,l,d)};C.fromVertexData=function(A,n){const l=A.indices,d=t.allocateTypedArrayBufferwithData(A.vertices,A.stride);A={geometry:new D(d,A.stride)};return new C(n,l,A)};C.fromVertexVectors=function(A){const n=A.geometryType,l=A.indexVector.buffer(),d={};for(const a in A.namedVectors)d[a]=D.fromVertexVector(A.namedVectors[a]);
return new C(n,l,d)};return C}();q.VertexBuffers=E;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/VertexVector":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../Utils","./VertexBuffer","../util/Writer"],function(q,t,D,E,C){let A=function(){function l(d,a){this.data=d;this.stride=a}l.prototype.transfer=function(d,a){const b=this.data.buffer();d.vertexCount=this.vertexCount;d.data=b;d.stride=
this.stride;a.push(b)};t._createClass(l,[{key:"vertexCount",get:function(){const d=this.data.length/(this.stride/4);d!==(d|0)&&console.debug("Corrupted stride");return d}}]);return l}(),n=function(){function l(a,b,c){this.geometryType=a;this.indexVector=new C(Uint32Array,6*b);this.namedVectors={};a=D.getStrides(a,c);for(const f in a){c=a[f];let h;switch(c%4){case 0:case 2:h=new C(Uint32Array,c*b);break;case 1:case 3:h=new C(Uint8Array,c*b)}this.namedVectors[f]=new A(h,c)}}var d=l.prototype;d.get=
function(a){return this.namedVectors[a].data};d.getVector=function(a){return this.namedVectors[a]};d.transfer=function(a,b){const c=this.indexVector.buffer(),f={};b.push(c);for(const h in this.namedVectors){const p=this.namedVectors[h];f[h]={};p.transfer(f[h],b)}a.geometryType=this.geometryType;a.indexBuffer=c;a.namedBuffers=f;this.destroy()};d.intoBuffers=function(){const a=E.VertexBuffers.fromVertexVectors(this);this.destroy();return a};d.destroy=function(){this.namedVectors=this.indexVector=null};
return l}();q.VertexVector=A;q.VertexVectors=n;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/util/Writer":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers"],function(q){return function(){function t(E,C){this._pos=0;C=C?this._roundToNearest(C,E.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(C);this._buffer=new E(this._array);this._ctor=E;this._i16View=new Int16Array(this._array)}var D=t.prototype;D._roundToNearest=
function(E,C){E=Math.round(E);return E+(C-E%C)};D._ensureSize=function(E){if(this._pos+E>=this._buffer.length){E=this._roundToNearest(1.25*(this._array.byteLength+E*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT);E=new ArrayBuffer(E);const C=new this._ctor(E);C.set(this._buffer,0);this._array=E;this._buffer=C;this._i16View=new Int16Array(this._array)}};D.ensureSize=function(E){this._ensureSize(E)};D.writeF32=function(E){this._ensureSize(1);const C=this._pos;(new Float32Array(this._array,
4*this._pos,1))[0]=E;this._pos++;return C};D.push=function(E){this._ensureSize(1);const C=this._pos;this._buffer[this._pos++]=E;return C};D.writeFixed=function(E){this._buffer[this._pos++]=E};D.setValue=function(E,C){this._buffer[E]=C};D.i1616Add=function(E,C,A){this._i16View[2*E]+=C;this._i16View[2*E+1]+=A};D.getValue=function(E){return this._buffer[E]};D.incr=function(E){if(this._buffer.length<E)throw Error("Increment index overflows the target buffer");this._buffer[E]++};D.decr=function(E){this._buffer[E]--};
D.writeRegion=function(E){this._ensureSize(E.length);const C=this._pos;this._buffer.set(E,this._pos);this._pos+=E.length;return C};D.writeManyFrom=function(E,C,A){for(this._ensureSize(A-C);C!==A;C++)this.writeFixed(E._buffer[C])};D.buffer=function(){const E=this._array.slice(0,4*this._pos);this.destroy();return E};D.toArray=function(){const E=this._array,C=[];for(let A=0;A<E.byteLength/4;A++)C.push(E[A]);return C};D.seek=function(E){this._pos=E};D.destroy=function(){this._buffer=this._array=null};
q._createClass(t,[{key:"length",get:function(){return this._pos}}]);return t}()})},"esri/views/2d/engine/webgl/mesh/MeshData":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../tiling/PagedTileQueue ../../../tiling/TileInfoView ../../../tiling/TileKey ../../../tiling/TileQueue ../../../tiling/TileStrategy ../definitions ../DisplayId ../enums ../Utils ./VertexDataWriter ../../../layers/features/support/tileUtils".split(" "),function(q,t,D,E,C,A,n,l,d,a,b,c,f){function h(k){switch(k){case 1:case 8:case 32:return-1;
case 2:case 64:return 0;case 4:case 16:case 128:return 1}}function p(k){switch(k){case 1:case 2:case 4:return-1;case 8:case 16:return 0;case 32:case 64:case 128:return 1}}D=function(){function k(m,r,v,x,g,u=0){this.hasRecords=this._hasAggregate=!1;this._data={self:new Map,neighbors:[]};this._version=0;this._current={geometryType:0,writer:null,overlaps:0,start:0,insertAfter:0,sortKey:0,id:0,materialKey:0,indexStart:0,vertStart:0,isDotDensity:!1,bufferingEnabled:!1,metricBoxLenPointer:0};this.hint=
r;this.tileKey=m;this._hasAggregate=x;this._pixelBufferEnabled=g;this._version=u;this._symbologyType=v}var e=k.prototype;e.serialize=function(m){const r=[];r.push(this._serializeTileVertexData(this.tileKey,this.tileKey,this._data.self));this._data.neighbors.forEach((v,x)=>{var g=1<<x;x=h(g);g=p(g);x=f.getPow2NeighborKey(new C(this.tileKey),x,g,m);x=this._serializeTileVertexData(this.tileKey,x.id,v.vertexData);x.message.bufferIds=v.displayIds;r.push(x)});return r};e._serializeTileVertexData=function(m,
r,v){var x,g,u,y,z;const w=[];v={[a.WGLGeometryType.MARKER]:null==(x=v.get(a.WGLGeometryType.MARKER))?void 0:x.serialize(w),[a.WGLGeometryType.FILL]:null==(g=v.get(a.WGLGeometryType.FILL))?void 0:g.serialize(w),[a.WGLGeometryType.LINE]:null==(u=v.get(a.WGLGeometryType.LINE))?void 0:u.serialize(w),[a.WGLGeometryType.TEXT]:null==(y=v.get(a.WGLGeometryType.TEXT))?void 0:y.serialize(w),[a.WGLGeometryType.LABEL]:null==(z=v.get(a.WGLGeometryType.LABEL))?void 0:z.serialize(w)};return{message:{tileKeyOrigin:m,
tileKey:r,data:v,version:this._version},transferList:w}};e.featureStart=function(m,r){this._current.insertAfter=m;this._current.sortKey=r};e.featureEnd=function(){};e.recordStart=function(m,r,v,x){this._current.writer=this._getVertexWriter(v);this._current.overlaps=0;this._current.indexStart=this._current.writer.indexCount;this._current.vertStart=this._current.writer.vertexCount;this._current.bufferingEnabled=x;this._current.id=m;this._current.materialKey=r;this._current.geometryType=v;this._current.isDotDensity=
!1;this._current.writer.recordStart()};e.recordCount=function(){return this._current.writer.recordCount};e.vertexCount=function(){return this._current.writer.vertexCount};e.indexCount=function(){return this._current.writer.indexCount};e.vertexEnsureSize=function(m){this._current.writer.vertexEnsureSize(m)};e.indexEnsureSize=function(m){this._current.writer.indexEnsureSize(m)};e.vertexBounds=function(m,r,v,x){this._current.bufferingEnabled&&this._addOverlap(m,r,v,x)};e.vertexWrite=function(m){this._current.writer.writeVertex(m)};
e.vertexWriteF32=function(m){this._current.writer.writeVertexF32(m)};e.vertexEnd=function(){};e.vertexWriter=function(){return this._current.writer.vertexWriter};e.indexWrite=function(m){this._current.writer.writeIndex(m)};e.indexWriter=function(){return this._current.writer.indexWriter};e.metricWriter=function(){return this._current.writer.metricWriter};e.metricStart=function(m,r,v,x,g,u,y,z){this._current.writer=this._getVertexWriter(a.WGLGeometryType.LABEL);const w=this._current.writer.metricWriter;
w.push(d.getDisplayIdTexel(m));w.push(r);w.push(v);w.push(x);w.push(g);w.push(u);w.push(y);w.push(z);w.push(255);this._current.metricBoxLenPointer=w.push(0)};e.metricEnd=function(){const m=this._current.writer.metricWriter;0===m.getValue(this._current.metricBoxLenPointer)&&m.seek(m.length-10)};e.metricBoxWrite=function(m,r,v,x){const g=this._current.writer.metricWriter;g.incr(this._current.metricBoxLenPointer);g.push(0);g.push(0);g.push(m);g.push(r);g.push(v);g.push(x)};e.recordEnd=function(){var m=
this._current.vertStart,r=this._current.writer.vertexCount-m;if(!r)return!1;this.hasRecords=!0;var v=this._current.indexStart;this._current.writer.recordEnd(this._current.id,this._current.materialKey,this._current.insertAfter,v,this._current.writer.indexCount-v,m,r,this._current.sortKey);if(!this._pixelBufferEnabled||this._hasAggregate||0===this._current.overlaps||this._current.geometryType===a.WGLGeometryType.LABEL)return!0;m=this._current.writer;for(r=0;8>r;r++){var x=1<<r;if(this._current.overlaps&
x){this._data.neighbors[r]||(this._data.neighbors[r]={vertexData:new Map,displayIds:new Set});v=this._data.neighbors[r];var g=this._current.geometryType;if(!v.vertexData.has(g)){var u=b.getStrides(g,this._symbologyType).geometry;u=new c.VertexDataWriter(g,u,l.PATCH_PIXEL_BUFFER_ALLOC_SIZE);v.vertexData.set(g,u)}g=v.vertexData.get(this._current.geometryType);u=4096*-h(x);x=4096*-p(x);g.copyLastFrom(m,u,x);v.displayIds.add(this._current.id)}}return!0};e._addOverlap=function(m,r,v,x){this._current.overlaps|=
255^((m<0+v?148:m>=l.TILE_SIZE-v?41:189)|(r<0+x?224:r>=l.TILE_SIZE-x?7:231))};e._getVertexWriter=function(m){if(!this._data.self.has(m)){const r=this._data.self,v=b.getStrides(m,this._symbologyType).geometry;r.set(m,new c.VertexDataWriter(m,v,this.hint.records))}return this._data.self.get(m)};t._createClass(k,[{key:"hasAggregates",get:function(){return this._hasAggregate}},{key:"hasPixelBufferEnabled",get:function(){return this._pixelBufferEnabled}}]);return k}();q.MeshData=D;Object.defineProperties(q,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/DisplayId":function(){define(["exports"],function(q){q.AGGREGATE_VALID_FILTERS_MASK=254;q.DISPLAY_ID_TEXEL_MASK=8388607;q.DISPLAY_ID_TYPE_AGGREGATE=1;q.DISPLAY_ID_TYPE_FEATURE=0;q.DISPLAY_ID_TYPE_MASK=8388608;q.NONAGGREGATE_VALID_FILTERS_MASK=255;q.createDisplayId=function(t,D){return((D?8388608:0)|t)>>>0};q.getDisplayIdFilterMask=t=>1===(t&8388608)>>>23?254:255;q.getDisplayIdTexel=t=>t&8388607;q.getDisplayIdType=
t=>(t&8388608)>>>23;q.isAggregateId=function(t){return 1===(t&8388608)>>>23};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/VertexDataWriter":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../definitions","./heuristics","../util/Writer"],function(q,t,D,E,C){let A=function(){function n(d,a,b){this._start={index:0,vertex:0};b=E.getMeshSizeHint(d,a,b);a/=4;this.geometryType=d;this._records=
new C(Int32Array,b.recordBytes);this._indices=new C(Uint32Array,b.indexBytes);this._vertices=new C(Uint32Array,b.vertexBytes);this._metrics=new C(Float32Array,0);this._strideInt=a}var l=n.prototype;l.serialize=function(d){const a=this._records.buffer(),b=this._indices.buffer(),c=this._vertices.buffer(),f=this._metrics.length?this._metrics.buffer():null,h=4*this._strideInt;d.push(a,b,c);return{stride:h,records:a,indices:b,vertices:c,metrics:f}};l.vertexEnsureSize=function(d){this._vertices.ensureSize(d)};
l.indexEnsureSize=function(d){this._indices.ensureSize(d)};l.recordStart=function(){this._start.index=this._indices.length;this._start.vertex=this._vertices.length};l.recordEnd=function(d,a,b,c,f,h,p,k){this._records.push(d);this._records.push(a);this._records.push(b);this._records.push(c);this._records.push(f);this._records.push(h);this._records.push(p);this._records.writeF32(k)};l.writeIndex=function(d){this._indices.push(d)};l.writeVertex=function(d){this._vertices.push(d)};l.writeVertexF32=function(d){this._vertices.writeF32(d)};
l.copyLastFrom=function(d,a,b){var c=d._records.length-D.DISPLAY_RECORD_INT_PER_ELEMENT;const f=d._records.getValue(c),h=d._records.getValue(c+1),p=d._records.getValue(c+2),k=d._records.getValue(c+4),e=d._records.getValue(c+6);c=d._records.getValue(c+7);const m=this._vertices.length;var r=(d._start.vertex-this._vertices.length)/this._strideInt;const v=this._indices.length,x=this.vertexCount;for(var g=d._start.index;g!==d._indices.length;g++){const u=d._indices.getValue(g);this._indices.push(u-r)}for(r=
d._start.vertex;r!==d._vertices.length;r++)g=d._vertices.getValue(r),this._vertices.push(g);for(d=m;d<=this._vertices.length;d+=this._strideInt)this._vertices.i1616Add(d,a,b);this._records.push(f);this._records.push(h);this._records.push(p);this._records.push(v);this._records.push(k);this._records.push(x);this._records.push(e);this._records.push(c)};t._createClass(n,[{key:"strideInt",get:function(){return this._strideInt}},{key:"recordCount",get:function(){return this._records.length/D.DISPLAY_RECORD_INT_PER_ELEMENT}},
{key:"vertexCount",get:function(){return this._vertices.length/this._strideInt}},{key:"indexCount",get:function(){return this._indices.length}},{key:"indexWriter",get:function(){return this._indices}},{key:"vertexWriter",get:function(){return this._vertices}},{key:"metricWriter",get:function(){return this._metrics}}]);return n}();q.VertexDataWriter=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/heuristics":function(){define(["exports",
"../definitions","../enums"],function(q,t,D){const E=new Map;E.set(D.WGLGeometryType.MARKER,{multiplier:1,indicesPerRecord:6,verticesPerRecord:4});E.set(D.WGLGeometryType.LINE,{multiplier:1,indicesPerRecord:24,verticesPerRecord:8});E.set(D.WGLGeometryType.FILL,{multiplier:1,indicesPerRecord:10,verticesPerRecord:10});E.set(D.WGLGeometryType.TEXT,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});E.set(D.WGLGeometryType.LABEL,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});q.getMeshHeuristic=
function(C){return E.get(C)};q.getMeshSizeHint=function(C,A,n){const {indicesPerRecord:l,multiplier:d,verticesPerRecord:a}=E.get(C);return{recordBytes:n*t.DISPLAY_RECORD_INT_PER_ELEMENT*Uint32Array.BYTES_PER_ELEMENT,indexBytes:d*l*n*Uint32Array.BYTES_PER_ELEMENT,vertexBytes:d*a*n*A}};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/tileUtils":function(){define(["exports","./Tile"],function(q,t){function D(E,C,A,n){E=
E.clone();const l=1<<E.level;C=E.col+C;A=E.row+A;n&&0>C?(E.col=C+l,--E.world):C>=l?(E.col=C-l,E.world+=1):E.col=C;E.row=A;return E}q.getPow2NeighborKey=D;q.getPow2NeighborTile=function(E,C,A){C=D(E.key,C,A,E.tileInfoView.tileInfo.isWrappable);return new t.Tile(E.tileInfoView,C)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../../core/maybe ../../../../../../core/promiseUtils ../../../../../../geometry/libtess ../../DisplayId ../templates/WGLLabelTemplate ../templates/WGLMarkerTemplate ../templates/WGLTemplateStore".split(" "),
function(q,t,D,E,C,A,n,l,d,a){D=function(){function b(f,h,p){this._loadPromise=A.loadLibtess();this._geometryType=f;this._idField=h;this._templateStore=p}var c=b.prototype;c.update=function(f,h){E.isSome(f.mesh.labels)&&(this._labelTemplates=this._createLabelTemplates(f.mesh.labels,h));this._schema=f};c._createLabelTemplates=function(f,h){const p=new Map;if("simple"===f.type){for(var k of f.classes)f=l.fromLabelClass(k,h),p.set(k.index,f);return p}for(const e in f.classes){k=f.classes[e];for(const m of k)k=
l.fromLabelClass(m,h),p.set(m.index,k)}return p};c.analyze=function(){var f=t._asyncToGenerator(function*(h,p,k,e,m,r,v){if(!C.isAborted(v)){var x;"dictionary"===k.type&&(x=yield k.analyze(this._idField,h.copy(),p,m,r,v));for(p=0;h.next();){var g=void 0;g=x?x[p++]:E.isSome(e)&&n.isAggregateId(h.getDisplayId())&&1!==h.readAttribute("cluster_count")?e.match(this._idField,h,this._geometryType,m,r):k.match(this._idField,h,this._geometryType,m,r);h.setGroupId(g);if(a.isDynamicId(g)){g=this._templateStore.getDynamicTemplateGroup(g);
for(const u of g)u&&u.analyze&&u.analyze(this._templateStore,h,m,r)}}yield this._loadPromise;return this._templateStore.finalize(v)}});return function(h,p,k,e,m,r,v){return f.apply(this,arguments)}}();c.analyzeGraphics=function(){var f=t._asyncToGenerator(function*(h,p,k,e,m,r){if(!C.isAborted(r)){h=h.getCursor();for(k&&(yield k.analyze(this._idField,h.copy(),p,e,m,r));h.next();){p=h.getGroupId();if(null==p||-1===p)p=k.match(this._idField,h,h.geometryType,e,m),h.setGroupId(p);if(a.isDynamicId(p)){const v=
this._templateStore.getDynamicTemplateGroup(p);for(const x of v)x&&x.analyze&&x.analyze(this._templateStore,h,e,m)}h.setGroupId(p)}yield this._loadPromise;return this._templateStore.finalize(r)}});return function(h,p,k,e,m,r){return f.apply(this,arguments)}}();c.writeGraphic=function(f,h,p,k){const e=h.getGroupId(),m=h.getDisplayId(),r=this._templateStore.getTemplateGroup(e);f.featureStart(h.insertAfter,0);if(null!=m){if(a.isDynamicId(e))for(const v of r)v&&v.bindFeature(h,null,null);if(r){for(const v of r)v&&
v.write(f,h,p,k);f.featureEnd()}}};c.writeCursor=function(f,h,p,k,e,m,r){const v=h.getGroupId(),x=h.getDisplayId(),g=this._templateStore.getTemplateGroup(v),u=this._schema.mesh.sortKey;let y=0;E.isSome(u)&&(y=null!=u.fieldIndex?h.getComputedNumericAtIndex(u.fieldIndex):null!=u.field?h.readAttribute(u.field):h.readAttribute(this._idField),y*="asc"===u.order?1:-1);f.featureStart(0,null==y||isNaN(y)?0:y);if(null!=x&&g){if(a.isDynamicId(v))for(const z of g)z.bindFeature(h,p,k);for(const z of g)z.write(f,
h,e,r);E.isSome(m)&&f.hasRecords&&(p=m&&this._findLabelRef(g),this._writeLabels(f,h,m,p,e,r));f.featureEnd()}};c._findLabelRef=function(f){for(const h of f)if(h instanceof d)return h;return null};c._writeLabels=function(f,h,p,k,e,m){for(const r of p)if(E.isSome(r)&&r){const {glyphs:v,rtl:x,index:g}=r;p=this._labelTemplates.get(g);p.setZoomLevel(e);p.bindReferenceTemplate(k);p.bindTextInfo(v,x);p.write(f,h,null,m)}};t._createClass(b,[{key:"templates",get:function(){return this._templateStore}}]);return b}();
q.WGLMeshFactory=D;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/libtess":function(){define(["require","exports","../chunks/_rollupPluginBabelHelpers","../assets","../core/has"],function(q,t,D,E,C){function A(){A=D._asyncToGenerator(function*(){d||(d=n());return d});return A.apply(this,arguments)}function n(){return l.apply(this,arguments)}function l(){l=D._asyncToGenerator(function*(){a=yield(C("esri-csp-restrictions")?yield(new Promise((b,
c)=>q(["../chunks/libtess-asm"],b,c))).then(b=>b.libtessAsm):yield(new Promise((b,c)=>q(["../chunks/libtess"],b,c))).then(b=>b.libtess)).load({locateFile:b=>E.getAssetUrl(`esri/core/libs/libtess/${b}`)})});return l.apply(this,arguments)}let d=null,a=null;t.loadLibtess=function(){return A.apply(this,arguments)};t.triangulate=function(b,c){return a.triangulate(b,c,Math.max(b.length,128E3))};Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./segmentUtils ./WGLTextTemplate".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c,f,h,p){const k=D.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),e=(r,v="mapview-labeling")=>k.error(new t(v,r)),m=function(r){const v=new Map;return x=>{v.has(x)||v.set(x,r(x));return v.get(x)}}(r=>{let v=0;if(0===r)return Infinity;for(;!(r%2);)v++,r/=2;return v});return function(r){function v(g,u,y,z){var w,B,F;var G=r.call(this,g,y.font.size,y.haloSize||0,y.font.size,y.color&&d.premultiplyAlphaRGBAArray(y.color)||0,y.haloColor&&d.premultiplyAlphaRGBAArray(y.haloColor)||
0,y.horizontalAlignment,y.verticalAlignment,l.isMapAligned(u.labelPlacement)?n.Alignment.MAP:n.Alignment.SCREEN,y.font.decoration,!1,y.angle||0,y.xoffset,y.yoffset,y.lineWidth,y.lineHeight,null,null,null,null,null)||this;G._outLineLabelAngle=0;G._refPlacementPadding=0;G._refPlacementDirX=0;G._refPlacementDirY=0;G._refOffsetX=0;G._refOffsetY=0;G._zoomLevel=0;G.geometryType=b.WGLGeometryType.LABEL;G._allowOverrun=null!=(w=u.allowOverrun)?w:!1;G._repeatLabel=null!=(B=u.repeatLabel)?B:!0;G._labelPosition=
null!=(F=u.labelPosition)?F:"curved";w=!!u.minScale&&z.scaleToZoom(u.minScale)||0;w=E.clamp(w,0,25.5);z=!!u.maxScale&&z.scaleToZoom(u.maxScale)||255;z=E.clamp(z,0,25.5);const [H,I]=l.getAlignmentFromPlacement(u.labelPlacement);G._xAlignD=H;G._yAlignD=I;G._minZoom=w;G._maxZoom=z;G._refPlacementPadding=A.pt2px(y.haloSize)+a.TEXT_PLACEMENT_PADDING;G._repeatLabelDistance=u.repeatLabelDistance?A.pt2px(u.repeatLabelDistance):128;g=f.LabelMaterialKey.load(g);g.sdf=!0;G._materialKey=g.data;return G}q._inheritsLoose(v,
r);v.fromLabelClass=function(g,u){if("esriServerLinePlacementCenterAlong"===g.labelPlacement){const y=g.symbol;y.xoffset=0;y.yoffset=0;y.angle=0;y.font.decoration="none"}return new v(g.materialKey,g,g.symbol,u)};var x=v.prototype;x.setZoomLevel=function(g){this._zoomLevel=g};x.bindReferenceTemplate=function(g){let u=l.getXDirection(this._xAlignD),y=l.getYDirection(this._yAlignD);this._refOffsetY=this._refOffsetX=0;if(C.isNone(g))this._refSymbolAndPlacementOffset=c.i8888to32(0,0,Math.floor(127*u+127),
Math.floor(127*y+127));else{if("circle"===g.boundsType&&(u||y)){var z=Math.sqrt(u*u+y*y);u/=z;y/=z}z=Math.max(g.height,g.width);this._refSymbolAndPlacementOffset=c.i8888to32(4*this._refPlacementPadding,z,Math.floor(127*u+127),Math.floor(127*y+127));this._referenceSize=z;this._refPlacementDirX=u;this._refPlacementDirY=y;this._refOffsetX=g.xOffset;this._refOffsetY=g.yOffset}};x._write=function(g,u){if(!C.isNone(this._shapingInfo)){var y=this._shapingInfo,z=u.getDisplayId(),w="esriGeometryPolygon"===
u.geometryType?u.readLegacyCentroid():u.readLegacyGeometry();if(w)switch(this.current={out:g,inId:z,inShaping:y,zoomLevel:this._zoomLevel},u.geometryType){case "esriGeometryPolyline":this._placeLineLabels(w);break;case "esriGeometryPoint":case "esriGeometryPolygon":this._placePointLabels(w);break;default:e("mapview-labeling",`Geometry of type ${u.geometryType} is not supported`)}}};x._isVisible=function(g,u){const y=Math.floor(10*this.current.zoomLevel);return Math.floor(10*g)<=y&&y<=Math.floor(10*
u)};x._placePointLabels=function(g){const {out:u,inId:y,inShaping:z}=this.current;this._writeGlyphs(u,y,g,z)};x._placeLineLabels=function(g){g=h.smoothPaths(g.paths,this.current.inShaping.bounds.width);const u=this._placeSubdivGlyphs.bind(this),y=(this._shapedBox.width+this._repeatLabelDistance)/2;for(const z of g)h.pathDivide(z,y,u,this._repeatLabel)};x._placeSubdivGlyphs=function(g,u,y,z){var w=m(u),B=this._shapedBox.width/2,F=Math.sqrt(this._repeatLabelDistance)/2;y=Math.min(y,z-y);B=this.current.inShaping.isMultiline?
25:Math.log2(y/(F+B/2));w=Math.max(this._minZoom,this.current.zoomLevel+1-(0===u?B:Math.min(w,B)));B=this.current.zoomLevel-w;F=this._shapedBox.width/2*2**B;this.current.inShaping.isMultiline?0===u&&this._placeStraight(g,w):this._allowOverrun&&0>B?this._placeStraightAlong(g,this._minZoom):"parallel"===this._labelPosition?this._placeStraightAlong(g,w):"curved"===this._labelPosition&&this._placeCurved(g,w,F)};x._placeStraight=function(g,u){const {out:y,inId:z,inShaping:w}=this.current,B=Math.ceil((180/
Math.PI*g.angle+180)%360);this._outLineLabelAngle=Math.round(254/360*Math.ceil(180/Math.PI*g.angle%360));this._writeGlyphs(y,z,g,w,u);this._outLineLabelAngle=Math.round(254/360*B);this._writeGlyphs(y,z,g,w,u)};x._placeCurved=function(g,u,y){const {out:z,inId:w}=this.current;z.metricStart(w,u,g.x,g.y,0,0,0,0);const B=g.clone(),F=(180/Math.PI*g.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*g.angle%360*(254/360));this._placeFirst(B,u,1);this._placeBack(g,B,u,y,1);this._placeForward(g,
B,u,y,1);this._outLineLabelAngle=Math.round(254/360*F);this._placeFirst(B,u,0);this._placeBack(g,B,u,y,0);this._placeForward(g,B,u,y,0);z.metricEnd()};x._placeStraightAlong=function(g,u){const {out:y,inId:z}=this.current;y.metricStart(z,u,g.x,g.y,0,0,0,0);const w=g.clone(),B=(180/Math.PI*g.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*g.angle%360*(254/360));this._placeFirst(w,u,1,!0);this._outLineLabelAngle=Math.round(254/360*B);this._placeFirst(w,u,0,!0);y.metricEnd()};x._placeBack=
function(g,u,y,z,w){const B=g.clone();for(g=g.backwardLength+0;B.prev()&&!(g>=z);)this._placeOnSegment(B,u,g,y,-1,w),g+=B.length+0};x._placeForward=function(g,u,y,z,w){const B=g.clone();for(g=g.remainingLength+0;B.next()&&!(g>=z);)this._placeOnSegment(B,u,g,y,1,w),g+=B.length+0};x._placeFirst=function(g,u,y,z=!1){const w=this.current.inShaping;var B=w.glyphs;const F=this.current.zoomLevel,{out:G,inId:H}=this.current;for(const I of B)B=I.x>w.bounds.x?y:1-y,B=Math.max(0,F+Math.log2(Math.abs(I.x+I.width/
2-w.bounds.x)/(B*g.remainingLength+(1-B)*g.backwardLength))),B=Math.max(u,z?0:B),I.maxZoom=25,I.angle=g.angle+(1-y)*Math.PI,I.minZoom=B,this._writeGlyph(G,H,g.x,g.y,I),y&&this._isVisible(I.minZoom,I.maxZoom)&&(B=I.bounds,G.metricBoxWrite(B.center[0],B.center[1],B.width,B.height))};x._placeOnSegment=function(g,u,y,z,w,B){var F=this.current.inShaping.glyphs;const {out:G,inId:H}=this.current,I=this.current.inShaping,L=this.current.zoomLevel;var N=g.x+g.dx/g.length*-w*y,J=g.y+g.dy/g.length*-w*y;for(const O of F)if((F=
O.x>I.bounds.x?B:1-B)&&1===w||!F&&-1===w){var K=Math.abs(O.x+O.width/2-I.bounds.x);F=Math.max(0,L+Math.log2(K/y)-.1);K=Math.max(z,L+Math.log2(K/(y+g.length+0)));0!==F&&(O.angle=g.angle+(1-B)*Math.PI,O.minZoom=K,O.maxZoom=F,this._writeGlyph(G,H,N,J,O),B&&this._isVisible(O.minZoom,O.maxZoom)&&(F=O.bounds,G.metricBoxWrite(F.center[0]+(g.x-u.x),F.center[1]+(g.y-u.y),F.width,F.height)))}};x._writeGlyphs=function(g,u,y,z,w=this._minZoom){if(!(0>y.x||512<=y.x||0>y.y||512<=y.y)){var B=y.x+this._refOffsetX;
y=y.y-this._refOffsetY;for(const F of z.glyphs)F.minZoom=w,F.maxZoom=this._maxZoom,this._writeGlyph(g,u,B,y,F);z=z.boundsT;g.metricStart(u,w,B,y,this._refPlacementDirX,this._refPlacementDirY,this._referenceSize,this._materialKey);g.metricBoxWrite(z.center[0],z.center[1],z.width,z.height);g.metricEnd()}};x._writeVertexCommon=function(g,u,y,z){const w=this._color,B=this._haloColor,F=c.i8888to32(0,0,this._size,this._haloSize);z=c.i8888to32(Math.floor(10*Math.max(z.minZoom,this._minZoom)),Math.floor(10*
Math.min(z.maxZoom,this._maxZoom)),this._outLineLabelAngle,0);g.vertexWrite(y);g.vertexWrite(u);g.vertexWrite(w);g.vertexWrite(B);g.vertexWrite(F);g.vertexWrite(this._refSymbolAndPlacementOffset);g.vertexWrite(z)};q._createClass(v,[{key:"_shapedBox",get:function(){return C.unwrap(this._shapingInfo).bounds}}]);return v}(p)})},"esri/views/2d/engine/webgl/mesh/templates/segmentUtils":function(){define(["exports","../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/maybe","./util"],
function(q,t,D,E){function C(a){return a.length-1}function A(a){let b=0;for(let c=0;c<C(a);c++)b+=n(a,c);return b}function n(a,b,c=1){const [f,h]=a[b+1];return Math.sqrt(f*f+h*h)*c}function l(a,b,c,f,h){if(!(c<b)){var p=f.clone().seek(c/2);D.isNone(p)||(a(p.clone(),c,h),c=(c-b)/2,p=D.unwrap(p.seek(b/2)),l(a,b,c,f,h+1),l(a,b,c,p,h+1))}}let d=function(){function a(c,f,h,p,k){this._segments=c;this._index=f;this._distance=h;this._xStart=p;this._yStart=k;this._done=!1}a.create=function(c){return new a(c,
0,0,c[0][0],c[0][1])};var b=a.prototype;b.clone=function(){return new a(this._segments,this._index,this._distance,this.xStart,this.yStart)};b.equals=function(c){return this._index===c._index||c._index===this._index-1&&(0===this._distance||1===c._distance)||c._index===this._index+1&&(1===this._distance||0===c._distance)};b.leq=function(c){return this._index<c._index||this._index===c._index&&this._distance<=c._distance};b.geq=function(c){return this._index>c._index||this._index===c._index&&this._distance>=
c._distance};b.hasPrev=function(){return 0<=this._index-1};b.hasNext=function(){return this._index+1<C(this._segments)};b.next=function(){if(!this.hasNext())return null;this._xStart+=this.dx;this._yStart+=this.dy;this._distance=0;this._index+=1;return this};b.prev=function(){if(!this.hasPrev())return this._done=!0,null;--this._index;this._xStart-=this.dx;this._yStart-=this.dy;this._distance=1;return this};b._seekBackwards=function(c,f){var h=this.backwardLength;if(c<=h)return this._distance=(h-c)/
this.length,this;for(h=this.backwardLength;this.prev();){if(h+this.length>c)return this._seekBackwards(c-h);h+=this.length}this._distance=0;return f?this:null};b.seek=function(c,f=!1){if(0>c)return this._seekBackwards(Math.abs(c),f);if(c<=this.remainingLength)return this._distance=(this.backwardLength+c)/this.length,this;let h=this.remainingLength;for(;this.next();){if(h+this.length>c)return this.seek(c-h,f);h+=this.length}this._distance=1;return f?this:null};t._createClass(a,[{key:"_segment",get:function(){return this._segments[this._index+
1]}},{key:"angle",get:function(){const c=this.dy;let f=Math.acos((0*c+-1*-this.dx)/(1*this.length));0<c&&(f=2*Math.PI-f);return f}},{key:"xStart",get:function(){return this._xStart}},{key:"yStart",get:function(){return this._yStart}},{key:"x",get:function(){return this.xStart+this.distance*this.dx}},{key:"y",get:function(){return this.yStart+this.distance*this.dy}},{key:"dx",get:function(){return this._segment[0]}},{key:"dy",get:function(){return this._segment[1]}},{key:"xMidpoint",get:function(){return this.xStart+
.5*this.dx}},{key:"yMidpoint",get:function(){return this.yStart+.5*this.dy}},{key:"xEnd",get:function(){return this.xStart+this.dx}},{key:"yEnd",get:function(){return this.yStart+this.dy}},{key:"length",get:function(){const {dx:c,dy:f}=this;return Math.sqrt(c*c+f*f)}},{key:"remainingLength",get:function(){return this.length*(1-this._distance)}},{key:"backwardLength",get:function(){return this.length*this._distance}},{key:"distance",get:function(){return this._distance}},{key:"done",get:function(){return this._done}}]);
return a}();q.SegmentCursor=d;q.pathDivide=function(a,b,c,f=!0){const h=A(a);a=d.create(a);const p=h/2;if(f){f=Math.floor(Math.max((h-b)/2,0)/b);a.seek(p-f*b);for(let k=-f;k<=f;k++)512>a.x&&0<=a.x&&512>a.y&&0<=a.y&&c(a.clone(),k,p+k*b,h),a.seek(b)}else a.seek(p),c(a.clone(),0,p+0*b,h)};q.pathLength=A;q.pathSubdivide=function(a,b,c){l(c,b,A(a),d.create(a),0)};q.segmentAt=function(a,b){return a[b+1]};q.segmentCount=C;q.segmentLength=n;q.smoothPaths=function(a,b){for(let B=0;B<a.length;B++){var c=a[B];
const F=[];F.push(c[0]);for(var f=1;f<c.length;f++){let [G,H]=F[f-1];G+=c[f][0];H+=c[f][1];F.push([G,H])}a:{c=F;f=b;if(0>=f)break a;const G=c.length;if(3>G)break a;const H=[];var h=0;H.push(0);for(var p=1;p<G;p++)h+=E.dist(c[p],c[p-1]),H.push(h);f=Math.min(f,.2*h);h=[];h.push(c[0][0]);h.push(c[0][1]);p=c[G-1][0];const I=c[G-1][1];var k=E.sub([0,0],c[0],c[1]);E.normalize(k);c[0][0]+=f*k[0];c[0][1]+=f*k[1];E.sub(k,c[G-1],c[G-2]);E.normalize(k);c[G-1][0]+=f*k[0];c[G-1][1]+=f*k[1];for(k=1;k<G;k++)H[k]+=
f;H[G-1]+=f;k=.5*f;for(let L=1;L<G-1;L++){let N=0,J=0,K=0;for(var e=L-1;0<=e&&!(H[e+1]<H[L]-k);e--){var m=k+H[e+1]-H[L],r=H[e+1]-H[e],v=H[L]-H[e]<k?1:m/r;if(1E-6>Math.abs(v))break;var x=v*v,g=v*m-.5*x*r,u=v*r/f,y=c[e+1],z=c[e][0]-y[0],w=c[e][1]-y[1];N+=u/g*(y[0]*v*m+.5*x*(m*z-r*y[0])-x*v*r*z/3);J+=u/g*(y[1]*v*m+.5*x*(m*w-r*y[1])-x*v*r*w/3);K+=u}for(e=L+1;e<G&&!(H[e-1]>H[L]+k);e++){m=k-H[e-1]+H[L];r=H[e]-H[e-1];v=H[e]-H[L]<k?1:m/r;if(1E-6>Math.abs(v))break;x=v*v;g=v*m-.5*x*r;u=v*r/f;y=c[e-1];z=c[e][0]-
y[0];w=c[e][1]-y[1];N+=u/g*(y[0]*v*m+.5*x*(m*z-r*y[0])-x*v*r*z/3);J+=u/g*(y[1]*v*m+.5*x*(m*w-r*y[1])-x*v*r*w/3);K+=u}h.push(N/K);h.push(J/K)}h.push(p);h.push(I);for(let L=0,N=0;L<G;L++)c[L][0]=h[N++],c[L][1]=h[N++]}c=[];c.push(F[0]);for(f=1;f<F.length;f++){const [G,H]=F[f-1],[I,L]=F[f];c.push([Math.round(I-G),Math.round(L-H)])}a[B]=c}return a};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/util":function(){define(["exports"],
function(q){function t(D,E){return Math.sqrt(D*D+E*E)}q.DEFAULT_MAX_ZOOM=100;q.DEFAULT_MIN_ZOOM=0;q.dist=function(D,E){return t(D[0]-E[0],D[1]-E[1])};q.getLimitCosine=function(D=2){return 1/Math.max(D,1)};q.getMinMaxZoom=function(D,E){const C=!!D.minScale&&E.scaleToZoom(D.minScale)||0;D=!!D.maxScale&&E.scaleToZoom(D.maxScale)||100;return[C,D]};q.isExtent=function(D){return void 0!==D.xmin&&void 0!==D.ymin&&void 0!==D.xmax&&void 0!==D.ymax};q.isFunction=function(D){return"function"===typeof D};q.isMultipoint=
function(D){return void 0!==D.points};q.isPoint=function(D){return void 0!==D.x&&void 0!==D.y};q.isPolygon=function(D){return void 0!==D.rings};q.isPolyline=function(D){return void 0!==D.paths};q.len=t;q.normalize=function(D){const E=t(D[0],D[1]);D[0]/=E;D[1]/=E};q.sub=function(D,E,C){D[0]=E[0]-C[0];D[1]=E[1]-C[1];return D};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/BidiText ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLMeshTemplate".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c){return function(f){function h(p,k,e,m,r,v,x,g,u,y,z,w,B,F,G,H,I,L,N=!1,J,K){var O=f.call(this)||this;O._xOffset=D.pt2px(B);O._yOffset=D.pt2px(F);O._decoration=y||"none";O._color=r;O._haloColor=v;O._haloSize=Math.min(Math.floor(5*D.pt2px(D.toPt(e))),127);O._size=Math.min(Math.round(D.pt2px(k)),127);k=Math.min(Math.round(D.pt2px(m||k)),127);O._referenceSize=Math.round(Math.sqrt(256*k));O._scale=O._size/n.GLYPH_SIZE;O._angle=w;O._justify=C.getJustification(x||"center");
O._xAlignD=C.getXAnchorDirection(x||"center");O._yAlignD=C.getYAnchorDirection(g||"baseline");O._baseline="baseline"===(g||"baseline");O._bitset=(u===E.Alignment.MAP?1:0)|(z?1:0)<<1;p=d.MaterialKeyBase.load(p);p.sdf=!0;O._materialKey=p.data;O._lineWidth=D.pt2px(G)||512;O._lineHeight=H||1;O._textPlacement=I;O._effects=L;O._isCIM=N;O._minMaxZoom=l.i1616to32(Math.round(J*n.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(K*n.MIN_MAX_ZOOM_PRECISION_FACTOR));return O}q._inheritsLoose(h,f);h.fromText=function(p,
k){const e=new h(p.materialKey,p.font.size,p.haloSize||0,p.font.size,p.color&&A.premultiplyAlphaRGBAArray(p.color)||0,p.haloColor&&A.premultiplyAlphaRGBAArray(p.haloColor)||0,p.horizontalAlignment,p.verticalAlignment,E.Alignment.SCREEN,p.font.decoration,!1,p.angle||0,p.xoffset,p.yoffset,p.lineWidth,p.lineHeight,null,null,!1,a.DEFAULT_MIN_ZOOM,a.DEFAULT_MAX_ZOOM),[,m]=t.bidiText(p.text);e.bindTextInfo(k,m);e._vertexBoundsScale=p.maxVVSize?p.maxVVSize/p.font.size:1;return e};h.fromCIMText=function(p,
k,e){var m=p.scaleFactor||1;const r=p.size*p.sizeRatio*m,[v,x]=a.getMinMaxZoom(p.scaleInfo,e);e=new h(p.materialKey,r,p.outlineSize*p.sizeRatio,p.referenceSize,A.premultiplyAlphaRGBA(p.color),A.premultiplyAlphaRGBA(p.outlineColor),p.horizontalAlignment,p.verticalAlignment,p.alignment,p.decoration,p.colorLocked,p.angle,p.offsetX*p.sizeRatio*m,p.offsetY*p.sizeRatio*m,512,1,p.markerPlacement,p.effects,!0,v,x);[,m]=t.bidiText(p.text);e.bindTextInfo(k,m);e._vertexBoundsScale=p.maxVVSize?p.maxVVSize/r:
1;return e};return h}(b(c))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./shapingUtils".split(" "),function(q,t,D,E,C,A,n,l,d,a){return b=>function(c){function f(...p){p=
c.call(this,...p)||this;p._isCIM=!1;p._vertexBoundsScale=1;p.geometryType=n.WGLGeometryType.TEXT;p._aux=l.i8888to32(0,0,p._referenceSize,p._bitset);return p}q._inheritsLoose(f,c);var h=f.prototype;h.bindTextInfo=function(p,k){this._shapingInfo=p&&p.length?t.applySome(p,e=>a.shapeGlyphs(e,k,{scale:this._scale,angle:this._angle,xOffset:this._xOffset,yOffset:this._yOffset,hAlign:this._xAlignD,vAlign:this._yAlignD,maxLineWidth:Math.max(32,Math.min(this._lineWidth,512)),lineHeight:A.MAGIC_LABEL_LINE_HEIGHT*
Math.max(.25,Math.min(this._lineHeight,4)),decoration:this._decoration,isCIM:this._isCIM})):null};h._write=function(p,k,e,m){const r=k.getDisplayId();this._writeGeometry(p,k,r,e,m)};h._writeGeometry=function(p,k,e,m,r){const v=this._shapingInfo;if(!t.isNone(v)){if(t.isSome(this._textPlacement))return k=null!=r?r:k.readLegacyGeometryForDisplay(),this._writePlacedText(p,e,k,v,m);m=r?E.deltaDecodeGeometry(E.convertFromGeometry(r),2):"esriGeometryPolygon"===k.geometryType?k.readCentroid():k.readGeometryForDisplay();
if(!t.isNone(m)){if(m.isPoint){const [x,g]=m.coords;return!p.hasAggregates&&p.hasPixelBufferEnabled&&(0>x||512<=x||0>g||512<=g)?void 0:this._writeGlyphs(p,e,{x,y:g},v)}m.forEachVertex((x,g)=>this._writeGlyphs(p,e,{x,y:g},v))}}};h._writePlacedText=function(p,k,e,m,r){var v=t.unwrap(this._textPlacement);if(e=C.CIMMarkerPlacementHelper.getPlacement(e,v,D.pt2px(1),r.geometryEngine))for(var x=e.next();null!=x;)r=-x.getAngle(),m.setRotation(r),v=x.tx,x=-x.ty,0>v||512<=v||0>x||512<=x||(this._writeGlyphs(p,
k,{x:v,y:x},m),m.setRotation(-r)),x=e.next()};h._writeGlyphs=function(p,k,e,m){const r=d.MaterialKeyBase.load(this._materialKey),v=l.i1616to32(Math.round(8*e.x),Math.round(8*e.y)),x=this._vertexBoundsScale,g=m.bounds,u=2*Math.max(g.width,g.height);for(const y of m.glyphs)r.textureBinding=y.textureBinding,p.recordStart(k,r.data,this.geometryType,!0),p.vertexBounds(e.x+g.x+this._xOffset,e.y+g.y-this._yOffset,u*x,u*x),this._writeVertices(p,k,v,y),p.recordEnd()};h._writeGlyph=function(p,k,e,m,r){var v=
d.MaterialKeyBase.load(this._materialKey);const x=l.i1616to32(Math.round(8*e),Math.round(8*m));v.textureBinding=r.textureBinding;p.recordStart(k,v.data,this.geometryType,!0);v=r.bounds;const g=this._vertexBoundsScale;p.vertexBounds(e+v.x*g,m+v.y*g,v.width*g,v.height*g);this._writeVertices(p,k,x,r);p.recordEnd()};h._writeVertices=function(p,k,e,m){const r=p.vertexCount();this._writeVertexCommon(p,k,e,m);p.vertexWrite(m.offsets.upperLeft);p.vertexWrite(m.texcoords.upperLeft);p.vertexEnd();this._writeVertexCommon(p,
k,e,m);p.vertexWrite(m.offsets.upperRight);p.vertexWrite(m.texcoords.upperRight);p.vertexEnd();this._writeVertexCommon(p,k,e,m);p.vertexWrite(m.offsets.lowerLeft);p.vertexWrite(m.texcoords.lowerLeft);p.vertexEnd();this._writeVertexCommon(p,k,e,m);p.vertexWrite(m.offsets.lowerRight);p.vertexWrite(m.texcoords.lowerRight);p.vertexEnd();p.indexWrite(r+0);p.indexWrite(r+1);p.indexWrite(r+2);p.indexWrite(r+1);p.indexWrite(r+3);p.indexWrite(r+2)};h._writeVertexCommon=function(p,k,e,m){m=this._color;const r=
this._haloColor,v=l.i8888to32(0,0,this._referenceSize,this._bitset),x=l.i8888to32(0,0,this._size,this._haloSize);p.vertexWrite(e);p.vertexWrite(k);p.vertexWrite(m);p.vertexWrite(r);p.vertexWrite(x);p.vertexWrite(v);p.vertexWrite(this._minMaxZoom)};return f}(b)})},"esri/symbols/cim/placements/CIMMarkerPlacementHelper":function(){define(["exports","../CIMCursor","../CIMOperators"],function(q,t,D){let E=function(){function C(){}C.getPlacement=function(A,n,l,d){const a=D.getPlacementOperator(n);if(!a)return null;
A=t.cloneAndDecodeGeometry(A);return a.execute(A,n,l,d)};return C}();q.CIMMarkerPlacementHelper=E;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define(["../../../../../../core/maybe","../../../../../../symbols/cim/effects/CIMEffectHelper"],function(q,t){return function(){function D(){}var E=D.prototype;E.bindFeature=function(C,A,n){};E.write=function(C,A,n,l){var d;if(q.isNone(this._effects)||
0===(null==(d=this._effects)?void 0:d.length))return this._write(C,A,l);n=t.CIMEffectHelper.executeEffects(this._effects,A.readLegacyGeometryForDisplay(),l.geometryEngine);for(d=t.CIMEffectHelper.next(n);d;)this._write(C,A,l,d),d=t.CIMEffectHelper.next(n)};E._write=function(C,A,n,l){};return D}()})},"esri/symbols/cim/effects/CIMEffectHelper":function(){define(["exports","../../../geometry/support/jsonUtils","../CIMCursor","../CIMEffects","../CIMOperators"],function(q,t,D,E,C){const A=96/72;let n=
function(){function l(){}l.executeEffects=function(d,a,b){a=D.cloneAndDecodeGeometry(a);a=new E.SimpleGeometryCursor(a);for(const c of d)(d=C.getEffectOperator(c))&&(a=d.execute(a,c,A,b));return a};l.next=function(d){d=d.next();D.deltaEncodeGeometry(d);return d};l.applyEffects=function(d,a,b){if(!d)return a;a=new E.SimpleGeometryCursor(a);for(var c of d)(d=C.getEffectOperator(c))&&(a=d.execute(a,c,1,b));for(b=null;c=a.next();)b?t.isPolyline(b)?t.isPolyline(c)&&b.paths.push(...c.paths):t.isPolygon(b)&&
t.isPolygon(c)&&b.rings.push(...c.rings):b=c;return b};return l}();q.CIMEffectHelper=n;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c,f,h){return function(p){function k(e,m,r,v,x,g,u,y,z,w,B,F,G,H,I,L,N,J,K,O,W,aa,ba){var S=p.call(this)||this;S.angle=v;S.height=u;S.width=g;S.xOffset=m*K;S.yOffset=r*K;S._markerPlacement=O;S._effects=W;S._anchorX=.5-(.5+L)*I.width/I.width;S._anchorY=.5-(.5+N)*I.height/I.height;S._minMaxZoom=a.i1616to32(Math.round(aa*l.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(ba*l.MIN_MAX_ZOOM_PRECISION_FACTOR));m=(H===A.Alignment.MAP?l.BITSET_MARKER_ALIGNMENT_MAP:l.BITSET_MARKER_ALIGNMENT_SCREEN)|
(B?l.BITSET_GENERIC_LOCK_COLOR:0)|(G?l.BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE:0)|(F?l.BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY:0);r=I&&I.sdf;e=b.MarkerMaterialKey.load(e);e.sdf=r;e.pattern=!0;e.textureBinding=I.textureBinding;S._materialKey=e.data;S._fillColor=x;S._outlineColor=z;S._sizeOutlineWidth=a.i8888to32(Math.round(Math.min(Math.sqrt(128*g),255)),Math.round(Math.min(Math.sqrt(128*u),255)),Math.round(Math.min(Math.sqrt(128*w),255)),Math.round(Math.min(Math.sqrt(128*y),255)));x=I.rect.x+
l.SPRITE_PADDING;y=I.rect.y+l.SPRITE_PADDING;z=x+I.width;I=y+I.height;S._offsets.xUpperLeft=x;S._offsets.yUpperLeft=y;S._offsets.xUpperRight=z;S._offsets.yUpperRight=y;S._offsets.xBottomLeft=x;S._offsets.yBottomLeft=I;S._offsets.xBottomRight=z;S._offsets.yBottomRight=I;e.symbologyType===d.WGLSymbologyType.PIE_CHART?(S._texUpperLeft=a.i1616to32(0,1),S._texUpperRight=a.i1616to32(1,1),S._texBottomLeft=a.i1616to32(0,0),S._texBottomRight=a.i1616to32(1,0)):(S._texUpperLeft=a.i1616to32(x,y),S._texUpperRight=
a.i1616to32(z,y),S._texBottomLeft=a.i1616to32(x,I),S._texBottomRight=a.i1616to32(z,I));g=g*J*K;u=u*J*K;S._bitestAndDistRatio=a.i1616to32(m,Math.round(64*J));S._computedWidth=g;S._computedHeight=u;g=C.create();u=E.create();S._applyTransformation(u,g);return S}q._inheritsLoose(k,p);k.fromCIMMarker=function(e,m,r){const v=e.size,x=(m&&m.width||1)/(m&&m.height||1)*e.scaleX;var g=e.scaleSymbolsProportionally&&e.frameHeight?v/e.frameHeight:1;let u=n.premultiplyAlphaRGBA(e.color);const y=n.premultiplyAlphaRGBA(e.outlineColor),
z=D.pt2px(v),w=z*x,B=D.pt2px(e.offsetX||0),F=D.pt2px(e.offsetY||0);g*=D.pt2px(e.outlineWidth||0);const G=e.alignment||A.Alignment.SCREEN,H=D.pt2px(e.referenceSize),[I,L]=c.getMinMaxZoom(e.scaleInfo,r);m.sdf||0!==u||(u=-1);r=e.rotation||0;e.rotateClockwise||(r=-r);let N=0,J=0;const K=e.anchorPoint;K&&(e.isAbsoluteAnchorPoint?v&&(N=-K.x/(v*x),J=K.y/v):(N=K.x,J=K.y));m=new k(e.materialKey,B,F,r,u,w,z,H,y,g,e.colorLocked,e.scaleSymbolsProportionally,!1,G,m,N,J,e.sizeRatio,t.unwrapOr(e.scaleFactor,1),
e.markerPlacement,e.effects,I,L);m._vertexBoundsScaleX=e.maxVVSize?e.maxVVSize/w:1;m._vertexBoundsScaleY=e.maxVVSize?e.maxVVSize/z:1;return m};k.fromPictureMarker=function(e,m){const r=Math.round(D.pt2px(e.width)),v=Math.round(D.pt2px(e.height)),x=l.PICTURE_FILL_COLOR,g=Math.round(D.pt2px(e.xoffset||0)),u=Math.round(D.pt2px(e.yoffset||0));m=new k(e.materialKey,g,u,e.angle,x,r,v,v,0,0,!1,!1,!1,A.Alignment.SCREEN,m,0,0,1,1,null,null,c.DEFAULT_MIN_ZOOM,c.DEFAULT_MAX_ZOOM);m._vertexBoundsScaleX=e.maxVVSize?
e.maxVVSize/e.width:1;m._vertexBoundsScaleY=e.maxVVSize?e.maxVVSize/e.height:1;return m};k.fromSimpleMarker=function(e,m){const r=n.premultiplyAlphaRGBAArray(e.color),v=Math.round(D.pt2px(e.size)),x=Math.round(D.pt2px(e.xoffset||0)),g=Math.round(D.pt2px(e.yoffset||0)),u=e.style;var y=e.outline;const z=(y&&y.color&&n.premultiplyAlphaRGBAArray(y.color))|0;y=(y&&y.width&&Math.round(D.pt2px(y.width)))|0;m=new k(e.materialKey,x,g,e.angle,r,v,v,v,z,y,!1,!1,"esriSMSCross"===u||"esriSMSX"===u,A.Alignment.SCREEN,
m,0,0,1.96875,1,null,null,c.DEFAULT_MIN_ZOOM,c.DEFAULT_MAX_ZOOM);m.boundsType="esriSMSCircle"===u?"circle":"square";m._vertexBoundsScaleX=e.maxVVSize?e.maxVVSize/e.size:1;m._vertexBoundsScaleY=e.maxVVSize?e.maxVVSize/e.size:1;return m};k.fromLineSymbolMarker=function(e,m){const r=n.premultiplyAlphaRGBAArray(e.color),v=Math.round(D.pt2px(6*e.lineWidth)),x="cross"===e.style||"x"===e.style;switch(e.placement){case "begin-end":var g=A.ExtremityPlacement.Both;break;case "begin":g=A.ExtremityPlacement.JustBegin;
break;case "end":g=A.ExtremityPlacement.JustEnd;break;default:g=A.ExtremityPlacement.None}g={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:g,offsetAlongLine:0};m=new k(e.materialKey,0,0,0,r,v,v,v/6,r,x?Math.round(D.pt2px(e.lineWidth)):0,!1,!1,x,A.Alignment.MAP,m,0,0,1.96875,1,g,null,c.DEFAULT_MIN_ZOOM,c.DEFAULT_MAX_ZOOM);m.boundsType="circle"===e.style?"circle":"square";return m};return k}(f(h))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../definitions ../../enums ../../number ../../materialKey/MaterialKey".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c,f){const h=3.14159265359/180;return p=>function(k){function e(...r){r=k.call(this,...r)||this;r.angle=0;r.xOffset=0;r.yOffset=0;r.width=0;r.height=0;r.boundsType="square";r._anchorX=0;r._anchorY=0;r._computedWidth=0;r._computedHeight=0;r._vertexBoundsScaleX=1;r._vertexBoundsScaleY=1;r._offsets={xUpperLeft:0,yUpperLeft:0,xUpperRight:0,yUpperRight:0,xBottomLeft:0,yBottomLeft:0,xBottomRight:0,yBottomRight:0};r.geometryType=b.WGLGeometryType.MARKER;return r}q._inheritsLoose(e,
k);var m=e.prototype;m._write=function(r,v,x,g){const u=v.getDisplayId();r.recordStart(u,this._materialKey,this.geometryType,!0);this._writeGeometry(r,v,u,x,g);r.recordEnd()};m._writeGeometry=function(r,v,x,g,u){if(t.isSome(this._markerPlacement))return this._writePlacedMarkers(r,v,g,u);if(!u&&"esriGeometryPoint"===v.geometryType)return g=v.getX(),v=v.getY(),!r.hasAggregates&&r.hasPixelBufferEnabled&&(0>g||513<=g||0>v||513<=v)?void 0:this._writeVertices(r,x,this._getPos(g,v),g,v);v=u?l.deltaDecodeGeometry(l.convertFromGeometry(u),
2):"esriGeometryPolygon"===v.geometryType?v.readCentroid():v.readGeometryForDisplay();if(!t.isNone(v)){if(v.isPoint){const [y,z]=v.coords;return!r.hasAggregates&&r.hasPixelBufferEnabled&&(0>y||512<=y||0>z||512<=z)?void 0:this._writeVertices(r,x,this._getPos(y,z),y,z)}v.forEachVertex((y,z)=>{const w=2*a.TILE_SIZE;y<-w||y>=w||z<-w||z>=w||this._writeVertices(r,x,this._getPos(y,z),y,z)})}};m._writePlacedMarkers=function(r,v,x,g){g=null!=g?g:v.readLegacyGeometryForDisplay();if(x=d.CIMMarkerPlacementHelper.getPlacement(g,
t.unwrap(this._markerPlacement),D.pt2px(1),x.geometryEngine)){v=v.getDisplayId();g=n.create();for(var u=C.create(),y=x.next();null!=y;){const z=y.tx,w=-y.ty;-128<=z&&640>=z&&-128<=w&&640>=w&&(this._applyTransformation(u,g,-y.getAngle()/h),this._writeVertices(r,v,this._getPos(z,w),z,w));y=x.next()}}};m._writeVertices=function(r,v,x,g,u){const y=f.MarkerMaterialKey.load(this._materialKey);switch(y.symbologyType){case b.WGLSymbologyType.HEATMAP:return this._writeHeatmapVertices(r,v,x,g,u);default:return this._writeMarkerVertices(r,
v,y,x,g,u)}};m._writeMarkerVertices=function(r,v,x,g,u,y){var z=x.vvRotation;x=r.vertexCount();let w=this._computedWidth*this._vertexBoundsScaleX;var B=this._computedHeight*this._vertexBoundsScaleY;this.angle&&(w=B=Math.max(w,B));z&&(z=Math.max(this.xOffset,this.yOffset),w+=z,B+=z);r.vertexBounds(u+this.xOffset,y-this.yOffset,w,B);r.vertexWrite(g);r.vertexWrite(this._offsetUpperLeft);r.vertexWrite(this._texUpperLeft);r.vertexWrite(this._bitestAndDistRatio);r.vertexWrite(v);r.vertexWrite(this._fillColor);
r.vertexWrite(this._outlineColor);r.vertexWrite(this._sizeOutlineWidth);r.vertexWrite(this._minMaxZoom);r.vertexEnd();r.vertexWrite(g);r.vertexWrite(this._offsetUpperRight);r.vertexWrite(this._texUpperRight);r.vertexWrite(this._bitestAndDistRatio);r.vertexWrite(v);r.vertexWrite(this._fillColor);r.vertexWrite(this._outlineColor);r.vertexWrite(this._sizeOutlineWidth);r.vertexWrite(this._minMaxZoom);r.vertexEnd();r.vertexWrite(g);r.vertexWrite(this._offsetBottomLeft);r.vertexWrite(this._texBottomLeft);
r.vertexWrite(this._bitestAndDistRatio);r.vertexWrite(v);r.vertexWrite(this._fillColor);r.vertexWrite(this._outlineColor);r.vertexWrite(this._sizeOutlineWidth);r.vertexWrite(this._minMaxZoom);r.vertexEnd();r.vertexWrite(g);r.vertexWrite(this._offsetBottomRight);r.vertexWrite(this._texBottomRight);r.vertexWrite(this._bitestAndDistRatio);r.vertexWrite(v);r.vertexWrite(this._fillColor);r.vertexWrite(this._outlineColor);r.vertexWrite(this._sizeOutlineWidth);r.vertexWrite(this._minMaxZoom);r.vertexEnd();
this._writeIndices(r,x)};m._writeHeatmapVertices=function(r,v,x,g,u){const y=r.vertexCount();r.vertexBounds(g+this.xOffset,u-this.yOffset,this.width,this.height);r.vertexWrite(x);r.vertexWrite(this._offsetUpperLeft);r.vertexWrite(v);r.vertexEnd();r.vertexWrite(x);r.vertexWrite(this._offsetUpperRight);r.vertexWrite(v);r.vertexEnd();r.vertexWrite(x);r.vertexWrite(this._offsetBottomLeft);r.vertexWrite(v);r.vertexEnd();r.vertexWrite(x);r.vertexWrite(this._offsetBottomRight);r.vertexWrite(v);r.vertexEnd();
this._writeIndices(r,y)};m._writeIndices=function(r,v){r.indexWrite(v+0);r.indexWrite(v+1);r.indexWrite(v+2);r.indexWrite(v+1);r.indexWrite(v+3);r.indexWrite(v+2)};m._applyTransformation=function(r,v,x=0){E.fromTranslation(r,n.fromValues(this.xOffset,-this.yOffset));0!==this.angle+x&&E.rotate(r,r,h*(this.angle+x));x=this._computedWidth;const g=this._computedHeight,u=(this._anchorX-.5)*x,y=(this._anchorY-.5)*g;A.set(v,u,y);A.transformMat2d(v,v,r);this._offsetUpperLeft=c.i1616to32(16*v[0],16*v[1]);
this._offsets.xUpperLeft=v[0];this._offsets.yUpperLeft=v[1];A.set(v,u+x,y);A.transformMat2d(v,v,r);this._offsetUpperRight=c.i1616to32(16*v[0],16*v[1]);this._offsets.xUpperRight=v[0];this._offsets.yUpperRight=v[1];A.set(v,u,y+g);A.transformMat2d(v,v,r);this._offsetBottomLeft=c.i1616to32(16*v[0],16*v[1]);this._offsets.xBottomLeft=v[0];this._offsets.yBottomLeft=v[1];A.set(v,u+x,y+g);A.transformMat2d(v,v,r);this._offsetBottomRight=c.i1616to32(16*v[0],16*v[1]);this._offsets.xBottomRight=v[0];this._offsets.yBottomRight=
v[1]};m._getPos=function(r,v){return c.i1616to32(Math.round(8*r),Math.round(8*v))};return e}(p)})},"esri/views/2d/engine/webgl/mesh/templates/WGLTemplateStore":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/support/defaultsJSON ../../enums ../../materialKey/MaterialKey ./WGLDynamicFillTemplate ./WGLDynamicLineTemplate ./WGLDynamicMarkerTemplate ./WGLDynamicTextTemplate ./WGLFillTemplate ./WGLLineTemplate ./WGLMarkerTemplate ./WGLTextTemplate ../../util/Lock ../../util/Result ../../../../layers/features/textUtils ../../../../layers/support/cimSymbolUtils".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c,f,h,p,k,e,m,r,v){function x(G,H){const I=G.length;G.push(null);H.then(L=>G[I]=L);return G}function g(G){return!!(G&1)}const u=E.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),y=[];E={isOutline:!1,placement:null,symbologyType:n.WGLSymbologyType.DEFAULT,vvFlags:0};const z={...A.errorPointSymbolJSON,hash:JSON.stringify(A.errorPointSymbolJSON),materialKey:l.createMaterialKey(n.WGLGeometryType.MARKER,E)},w={...A.errorPolylineSymbolJSON,hash:JSON.stringify(A.errorPolylineSymbolJSON),
materialKey:l.createMaterialKey(n.WGLGeometryType.LINE,E)},B={...A.errorPolygonSymbolJSON,hash:JSON.stringify(A.errorPolygonSymbolJSON),materialKey:l.createMaterialKey(n.WGLGeometryType.FILL,E)};A=function(){function G(I,L){this._templateIdCounter=this._idCounter=1;this._idToTemplateGroup=new Map;this._symbolToTemplate=new Map;this._fetchQueue=[];this._idToResolver=new Map;this._cimTemplateCache=new Map;this._cimAnalyses=[];this._lock=new e.Lock;this._fetchResource=I;this._tileInfo=L}var H=G.prototype;
H.createTemplateGroup=function(I,L){this._initErrorTemplates();const N=I.hash;if(this._symbolToTemplate.has(N))return this._symbolToTemplate.get(N);const J=[];L&&this._createMeshTemplates(J,L,!0);this._createMeshTemplates(J,I,!1);I=this._createGroupId("expanded-cim"===I.type&&F(I));this._idToTemplateGroup.set(I,J);this._symbolToTemplate.set(N,I);return I};H.getTemplateGroup=function(I){return this._idToTemplateGroup.has(I)?this._idToTemplateGroup.get(I):y};H.getDynamicTemplateGroup=function(I){if(!this._idToTemplateGroup.has(I))return y;
g(I)||u.error("mapview-template-store",`Id ${I} does not refer to a dynamic template`);return this._idToTemplateGroup.get(I)};H.getMosaicItem=function(I,L){const N=this._createTemplateId(),J=new Promise(K=>this._idToResolver.set(N,K));this._fetchQueue.push({symbol:I,id:N,glyphIds:L});return J};H.finalize=function(I){return this._fetchQueue.length||this._lock.isHeld()?e.withLock(this._lock,this._fetchAllQueuedResources.bind(this),I):Promise.resolve()};H._initErrorTemplates=function(){this._errorTemplates||
(this._errorTemplates={fill:this._createMeshTemplates([],B,!1),marker:this._createMeshTemplates([],z,!1),line:this._createMeshTemplates([],w,!1)})};H._fetchAllQueuedResources=function(I){if(!this._fetchQueue.length)return Promise.resolve();const L=this._fetchQueue,N=this._cimAnalyses;this._fetchQueue=[];this._cimAnalyses=[];return Promise.all(N).then(()=>this._fetchResource(L,I).then(J=>{for(const {id:K,mosaicItem:O}of J)this._idToResolver.get(K)(O),this._idToResolver.delete(K)})).catch(J=>{C.isAbortError(J)?
this._fetchQueue=this._fetchQueue.concat(L):"worker:port-closed"!==J.name&&u.error(new D("mapview-template-store","Unable to fetch requested texture resources",J))})};H._createGroupId=function(I){return this._idCounter++<<1|(I?1:0)};H._createTemplateId=function(){return this._templateIdCounter++};H._createSMS=function(){var I=t._asyncToGenerator(function*(L){const {spriteMosaicItem:N}=yield this.getMosaicItem(L);return m.ok(N,u)?p.fromSimpleMarker(L,N):this._markerError});return function(L){return I.apply(this,
arguments)}}();H._createPMS=function(){var I=t._asyncToGenerator(function*(L){const {spriteMosaicItem:N}=yield this.getMosaicItem(L);return m.ok(N,u)?p.fromPictureMarker(L,N):this._markerError});return function(L){return I.apply(this,arguments)}}();H._createSFS=function(){var I=t._asyncToGenerator(function*(L,N){const {spriteMosaicItem:J}=yield this.getMosaicItem(L);return m.ok(J,u)?f.fromSimpleFill(L,J,N):this._fillError});return function(L,N){return I.apply(this,arguments)}}();H._createPFS=function(){var I=
t._asyncToGenerator(function*(L,N){const {spriteMosaicItem:J}=yield this.getMosaicItem(L);return m.ok(J,u)?f.fromPictureFill(L,J,N):this._fillError});return function(L,N){return I.apply(this,arguments)}}();H._createSLS=function(){var I=t._asyncToGenerator(function*(L,N){({spriteMosaicItem:N}=yield this.getMosaicItem(L));return m.ok(N,u)?h.fromSimpleLine(L,N):this._lineError});return function(L,N){return I.apply(this,arguments)}}();H._createLMS=function(){var I=t._asyncToGenerator(function*(L){const {spriteMosaicItem:N}=
yield this.getMosaicItem(L);return m.ok(N,u)?p.fromLineSymbolMarker(L,N):this._markerError});return function(L){return I.apply(this,arguments)}}();H._createTS=function(){var I=t._asyncToGenerator(function*(L){const {glyphMosaicItems:N}=yield this.getMosaicItem(L);return k.fromText(L,N)});return function(L){return I.apply(this,arguments)}}();H._createCIMText=function(){var I=t._asyncToGenerator(function*(L){const {glyphMosaicItems:N}=yield this.getMosaicItem(v.cimLayerToRasterizationInfo(L),r.codepoints(L.text));
return m.ok(N,u)?k.fromCIMText(L,N,this._tileInfo):this._textError});return function(L){return I.apply(this,arguments)}}();H._createCIMFill=function(){var I=t._asyncToGenerator(function*(L){const {spriteMosaicItem:N}=yield this.getMosaicItem(v.cimLayerToRasterizationInfo(L));return m.ok(N,u)?f.fromCIMFill(L,N,this._tileInfo):this._fillError});return function(L){return I.apply(this,arguments)}}();H._createCIMLine=function(){var I=t._asyncToGenerator(function*(L){const {spriteMosaicItem:N}=yield this.getMosaicItem(v.cimLayerToRasterizationInfo(L));
return m.ok(N,u)?h.fromCIMLine(L,N,this._tileInfo):this._lineError});return function(L){return I.apply(this,arguments)}}();H._createCIMMarker=function(){var I=t._asyncToGenerator(function*(L){const {spriteMosaicItem:N}=yield this.getMosaicItem(v.cimLayerToRasterizationInfo(L));return m.ok(N,u)?p.fromCIMMarker(L,N,this._tileInfo):this._markerError});return function(L){return I.apply(this,arguments)}}();H._createCIM=function(){var I=t._asyncToGenerator(function*(L){const N=L.templateHash;if(this._cimTemplateCache.has(N))return this._cimTemplateCache.get(N);
let J;switch(L.type){case "marker":J=yield this._createCIMMarker(L);break;case "line":J=yield this._createCIMLine(L);break;case "fill":J=yield this._createCIMFill(L);break;case "text":J=yield this._createCIMText(L)}this._cimTemplateCache.set(N,J);return J});return function(L){return I.apply(this,arguments)}}();H._createDynamicCIM=function(){var I=t._asyncToGenerator(function*(L){const N=L.templateHash;if(this._cimTemplateCache.has(N))return this._cimTemplateCache.get(N);let J;switch(L.type){case "marker":J=
b.fromCIMMarker(L,this._tileInfo);break;case "line":J=a.fromCIMLine(L,this._tileInfo);break;case "fill":J=d.fromCIMFill(L,this._tileInfo);break;case "text":J=c.fromCIMText(L,this._tileInfo)}this._cimTemplateCache.set(N,J);return J});return function(L){return I.apply(this,arguments)}}();H._createPrimitiveMeshTemplates=function(I,L,N){switch(L.type){case "esriSMS":return x(I,this._createSMS(L));case "esriPMS":return x(I,this._createPMS(L));case "esriSFS":return x(I,this._createSFS(L,N));case "line-marker":return x(I,
this._createLMS(L));case "esriPFS":return x(I,this._createPFS(L,N));case "esriSLS":return x(I,this._createSLS(L,!1));case "esriTS":return x(I,this._createTS(L));default:return u.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),I}};H._createMeshTemplates=function(I,L,N){if(L.type.includes("3d"))return u.error("3D symbols are not supported with MapView"),I;if("expanded-cim"===L.type){for(const J of L.layers)"function"===typeof J.materialHash?x(I,this._createDynamicCIM(J)):
x(I,this._createCIM(J));return I}if("composite-symbol"===L.type){for(const J of L.layers)this._createPrimitiveMeshTemplates(I,J,N);return I}return"cim"===L.type||"label"===L.type||"web-style"===L.type?I:this._createPrimitiveMeshTemplates(I,L,N)};t._createClass(G,[{key:"_markerError",get:function(){return this._errorTemplates.marker[0]}},{key:"_fillError",get:function(){return this._errorTemplates.fill[0]}},{key:"_lineError",get:function(){return this._errorTemplates.line[0]}},{key:"_textError",get:function(){return this._errorTemplates.line[0]}}]);
return G}();const F=G=>{if(!G.layers)return!1;for(const H of G.layers)if("function"===typeof H.materialHash)return!0;return!1};q.WGLTemplateStore=A;q.errorPointSchema2D=z;q.errorPolygonSchema2D=B;q.errorPolylineSchema2D=w;q.isDynamicId=g;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c){return function(f){function h(p,k,e){var m;var r=f.call(this,p)||this;r._minMaxZoom=n.i1616to32(Math.round(k*C.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(e*C.MIN_MAX_ZOOM_PRECISION_FACTOR));d.isFunction(p.color)?r._dynamicPropertyMap.set("fillColor",(z,w,B)=>(z=p.color(z,w,B))&&E.premultiplyAlphaRGBA(z)||0):(k=p.color,r.fillColor=k&&E.premultiplyAlphaRGBA(k)||0);const v="CIMMarkerPlacementInsidePolygon"===(null==(m=p.cim.placement)?void 0:m.type)&&p.cim.placement.shiftOddRows?
2:1,x=p.height;d.isFunction(x)?r._dynamicPropertyMap.set("_height",(z,w,B)=>x(z,w,B)*v):r._height=(x||0)*v;const g=p.offsetX;d.isFunction(g)?r._dynamicPropertyMap.set("_offsetX",(z,w,B)=>D.pt2px(g(z,w,B))):r._offsetX=D.pt2px(g||0);const u=p.offsetY;d.isFunction(u)?r._dynamicPropertyMap.set("_offsetY",(z,w,B)=>D.pt2px(-u(z,w,B))):r._offsetY=D.pt2px(-u||0);m=p.scaleX;d.isFunction(m)?r._dynamicPropertyMap.set("_scaleX",m):r._scaleX=m||1;const y=p.angle;d.isFunction(y)?r._dynamicPropertyMap.set("_angle",
(z,w,B)=>A.radToByte(y(z,w,B))):r._angle=A.radToByte(y)||0;t.isSome(p.effects)&&(m=p.effects,d.isFunction(m)?r._dynamicPropertyMap.set("_effects",m):r._effects=m);r._cimFillLayer=p;r._bitset=(p.colorLocked?C.BITSET_GENERIC_LOCK_COLOR:0)|(p.applyRandomOffset?C.BITSET_FILL_RANDOM_PATTERN_OFFSET:0)|(p.sampleAlphaOnly?C.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);r._fillMaterialKey=l.FillMaterialKey.load(p.materialKey);return r}q._inheritsLoose(h,f);h.fromCIMFill=function(p,k){const [e,m]=d.getMinMaxZoom(p.scaleInfo,
k);return new h(p,e,m)};h.prototype.bindFeature=function(p,k,e){const m=p.readLegacyFeature();this._dynamicPropertyMap.forEach((x,g)=>{this[g]=x(m,k,e)});p=this._fillMaterialKey;var r=this._materialCache,v=this._cimFillLayer.materialHash;v=v(m,k,e);v=r.get(v);r=null;v&&c.ok(v.spriteMosaicItem)&&(r=v.spriteMosaicItem);if(r){const {rect:x,width:g,height:u}=r;v=x.x+C.SPRITE_PADDING;const y=x.y+C.SPRITE_PADDING,z=v+g,w=y+u;let B=Math.round(D.pt2px(this._height));0>=B&&(B=w-y);let F=Math.round(D.pt2px(this._height/
u*g||0));0>=F&&(F=z-v);const G=this._scaleX;this.tl=n.i1616to32(v,y);this.br=n.i1616to32(z,w);this.aux2_1=n.i1616to32(F,B);this.aux2_2=n.i1616to32(this._offsetX,this._offsetY);this.aux3=n.i8888to32(G,1,this._angle,0);p.sdf=r.sdf;p.pattern=!0;p.textureBinding=r.textureBinding}else this.aux3=this.aux2_2=this.aux2_1=this.br=this.tl=0,p.sdf=!1,p.pattern=!1,p.textureBinding=0;this._materialKey=p.data};return h}(a(b))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../layers/graphics/featureConversionUtils ../../enums ../../number ../../Utils ../../materialKey/MaterialKey ./templateUtils ./WGLLineTemplate".split(" "),
function(q,t,D,E,C,A,n,l,d){return a=>function(b){function c(...h){h=b.call(this,...h)||this;h.forceLibtess=!1;h._bitset=0;h._lineTemplate=null;h.geometryType=E.WGLGeometryType.FILL;return h}q._inheritsLoose(c,b);var f=c.prototype;f._maybeAddLineTemplate=function(h){this._lineTemplate=d.fromFillOutline(h)};f._write=function(h,p,k,e){k="esriGeometryPoint"===p.geometryType;const m=n.FillMaterialKey.load(this._materialKey);h.recordStart(p.getDisplayId(),this._materialKey,this.geometryType,k);this._writeGeometry(h,
p,m,e,k);n.hasOutlineFillSymbology(m)&&t.isSome(this._lineTemplate)&&this._lineTemplate.writeGeometry(h,p,e,k);h.recordEnd()};f._writeGeometry=function(h,p,k,e,m){e=this._getGeometry(p,e,m);t.isNone(e)||(m=[],100<e.maxLength||this.forceLibtess||!l.triangulate(m,e)?(e=l.triangulateLibtess(e),this._writeVertices(h,p,e,[e.length/2],k)):m.length&&this._writeVertices(h,p,e.coords,e.lengths,k,m))};f._writeVertex=function(h,p,k,e,m,r){const v=C.i1616to32(1*e,1*m);h.vertexBounds(e,m,0,0);h.vertexWrite(v);
h.vertexWrite(p);k.symbologyType===E.WGLSymbologyType.DOT_DENSITY?h.vertexWriteF32(1/Math.abs(r.readGeometryArea())):(h.vertexWrite(this.fillColor),p=n.hasSimpleSymbology(k),p||(h.vertexWrite(this.tl),h.vertexWrite(this.br)),h.vertexWrite(this.aux2_1),h.vertexWrite(this.aux2_2),h.vertexWrite(this.aux3),p||h.vertexWrite(this._minMaxZoom))};f._writeVertices=function(h,p,k,e,m,r){var v=p.getDisplayId();v|=this._bitset<<24;var x=e.reduce((u,y)=>u+y);const g=A.getStrides(m.geometryType,m.symbologyType).geometry/
4;e=h.vertexCount();h.vertexEnsureSize(g*x);x=0;if(r)for(const u of r)this._writeVertex(h,v,m,k[2*u],k[2*u+1],p),x++;else for(r=0;r<k.length;r+=2)this._writeVertex(h,v,m,Math.round(k[r]),Math.round(k[r+1]),p),x++;h.indexEnsureSize(x);for(p=0;p<x;p++)h.indexWrite(p+e)};f._getGeometry=function(h,p,k){return(h=p?D.deltaDecodeGeometry(D.convertFromGeometry(p),2):h.readGeometryForDisplay())?l.clipMarshall(h,k?256:8):null};return c}(a)})},"esri/views/2d/engine/webgl/mesh/templates/templateUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../chunks/earcut ../../../../../../geometry/libtess ../../../../../../layers/graphics/OptimizedGeometry ../../definitions ../../Geometry ../../TileClipper ../bufcut".split(" "),
function(q,t,D,E,C,A,n,l,d){function a(h,p,k){let e=0;for(let m=1;m<k;m++)e+=(h[2*(p+m)]-h[2*(p+m-1)])*(h[2*(p+m)+1]+h[2*(p+m-1)+1]);return e}function b(h,p,k,e,m){let r=0;for(;k<e;k+=3){const v=2*(h[k]-m),x=2*(h[k+1]-m),g=2*(h[k+2]-m);r+=Math.abs((p[v]-p[g])*(p[x+1]-p[v+1])-(p[v]-p[x])*(p[g+1]-p[v+1]))}return r}const c=new l.TileClipper(0,0,0,1,0),f=new l.TileClipper(0,0,0,1,0);c.setExtent(A.TILE_SIZE);f.setExtent(A.TILE_SIZE);q.area=a;q.clipLinesMarshall=function(h,p){f.setPixelMargin(p);const k=
-p;p=A.TILE_SIZE+p;let e=[];var m=!1;let r=0;for(;r<h.length;){const v=[],x=h[r];if(!x)return null;f.reset(n.GeometryType.LineString);let [g,u]=x[0];if(m)f.moveTo(g,u);else{if(g<k||g>p||u<k||u>p){m=!0;continue}v.push({x:g,y:u})}let y=!1;const z=x.length;for(let w=1;w<z;++w)if(g+=x[w][0],u+=x[w][1],m)f.lineTo(g,u);else{if(g<k||g>p||u<k||u>p){y=!0;break}v.push({x:g,y:u})}if(y)m=!0;else{if(m){if(m=f.resultWithStarts())for(const w of m)e.push(w)}else e.push({line:v,start:0});r++;m=!1}}e=e.filter(v=>1<
v.line.length);return 0===e.length?null:e};q.clipMarshall=function(h,p){if(t.isNone(h))return null;a:{var k=A.TILE_SIZE+128;var e=0;for(var m=0;m<h.lengths.length;m++){var r=h.lengths[m];for(var v=0;v<r;v++){const x=h.coords[2*(v+e)],g=h.coords[2*(v+e)+1];if(-128>x||x>k||-128>g||g>k){k=!0;break a}}e+=r}k=!1}if(!k)return h;c.setPixelMargin(p);c.reset(n.GeometryType.Polygon);p=0;for(k=0;k<h.lengths.length;k++){e=h.lengths[k];m=h.coords[2*(0+p)];r=h.coords[2*(0+p)+1];c.moveTo(m,r);for(v=1;v<e;v++)m=
h.coords[2*(v+p)],r=h.coords[2*(v+p)+1],c.lineTo(m,r);c.close();p+=e}k=c.result(!1);if(!k)return null;h=[];p=[];for(const x of k){k=0;for(const g of x)p.push(g.x),p.push(g.y),k++;h.push(k)}return new C(h,p)};q.triangleArea=function(h,p,k,e,m){let r=0;for(;k<e;k+=3){const v=2*(h.getValue(k)-m),x=2*(h.getValue(k+1)-m),g=2*(h.getValue(k+2)-m);r+=Math.abs((p[v]-p[g])*(p[x+1]-p[v+1])-(p[v]-p[x])*(p[g+1]-p[v+1]))}return r};q.triangleAreaArray=b;q.triangulate=function(h,p){const {coords:k,lengths:e,hasIndeterminateRingOrder:m}=
p;if(m)return!1;p=0;for(var r=0;r<e.length;){let g=r,u=e[r];r=a(k,p,u);for(var v=[];++g<e.length;){var x=e[g];const y=a(k,p+u,x);if(!(0<y))break;r+=y;v.push(p+u);u+=x}x=h.length;d.bufcut(h,k,p,p+u,v,2,0);v=b(h,k,x,h.length,0);r=Math.abs(r);if(1E-5<Math.abs((v-r)/Math.max(1E-7,r)))return h.length=0,!1;r=g;p+=u}return!0};q.triangulateEarcut=function(h,p,k){const {coords:e,lengths:m,hasIndeterminateRingOrder:r}=p;if(r)return!1;let v=0;for(var x=0;x<m.length;){let u=x,y=m[x];for(x=[];++u<m.length;){var g=
m[u];if(!(0<a(e,v+y,g)))break;x.push(v+y-v);y+=g}g=p.coords.slice(2*v,2*(v+y));x=D.earcut(g,x,2);for(const z of x)h.push(z+k+v);x=u;v+=y}return!0};q.triangulateLibtess=function(h){const {coords:p,lengths:k}=h;({buffer:h}=E.triangulate(p,k));return h};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/chunks/earcut":function(){define(["exports"],function(q){var t={exports:{}};(function(D){(function(E){E=E();void 0!==E&&(D.exports=E)})(function(){function E(w,
B,F){F=F||2;var G=B&&B.length,H=G?B[0]*F:w.length,I=C(w,0,H,F,!0),L=[];if(!I||I.next===I.prev)return L;var N;if(G){var J=I;var K=F;I=[];var O;G=0;for(O=B.length;G<O;G++){var W=B[G]*K;var aa=G<O-1?B[G+1]*K:w.length;W=C(w,W,aa,K,!1);W===W.next&&(W.steiner=!0);I.push(f(W))}I.sort(d);for(G=0;G<I.length;G++)K=I[G],B=J,(J=b(K,B))?(O=x(J,K),K=A(J,J.next),O=a(O),A(O,O.next),K=a(K),J=a(B===J?K:B)):J=B,J=A(J,J.next);I=J}if(w.length>80*F){var ba=N=w[0];var S=G=w[1];for(K=F;K<H;K+=F)B=w[K],J=w[K+1],B<ba&&(ba=
B),J<S&&(S=J),B>N&&(N=B),J>G&&(G=J);N=Math.max(N-ba,G-S);N=0!==N?1/N:0}n(I,L,F,ba,S,N);return L}function C(w,B,F,G,H){if(H===0<z(w,B,F,G))for(H=B;H<F;H+=G)var I=g(H,w[H],w[H+1],I);else for(H=F-G;H>=B;H-=G)I=g(H,w[H],w[H+1],I);I&&k(I,I.next)&&(w=I.next,u(I),I=w);return I}function A(w,B){if(!w)return w;B||(B=w);do{var F=!1;if(w.steiner||!k(w,w.next)&&0!==p(w.prev,w,w.next))w=w.next;else{B=w.prev;u(w);w=B;if(w===w.next)break;F=!0}}while(F||w!==B);return B}function n(w,B,F,G,H,I,L){if(w){if(!L&&I){var N=
w,J=N;do null===J.z&&(J.z=c(J.x,J.y,G,H,I)),J.prevZ=J.prev,J=J.nextZ=J.next;while(J!==N);J.prevZ.nextZ=null;J.prevZ=null;N=J;var K,O,W,aa,ba=1;do{J=N;var S=N=null;for(O=0;J;){O++;var M=J;for(K=W=0;K<ba&&(W++,M=M.nextZ,M);K++);for(aa=ba;0<W||0<aa&&M;)0!==W&&(0===aa||!M||J.z<=M.z)?(K=J,J=J.nextZ,W--):(K=M,M=M.nextZ,aa--),S?S.nextZ=K:N=K,K.prevZ=S,S=K;J=M}S.nextZ=null;ba*=2}while(1<O)}for(N=w;w.prev!==w.next;){J=w.prev;M=w.next;if(I)S=l(w,G,H,I);else a:if(S=w,O=S.prev,W=S,ba=S.next,0<=p(O,W,ba))S=!1;
else{for(K=S.next.next;K!==S.prev;){if(h(O.x,O.y,W.x,W.y,ba.x,ba.y,K.x,K.y)&&0<=p(K.prev,K,K.next)){S=!1;break a}K=K.next}S=!0}if(S)B.push(J.i/F),B.push(w.i/F),B.push(M.i/F),u(w),N=w=M.next;else if(w=M,w===N){if(!L)n(A(w),B,F,G,H,I,1);else if(1===L){w=A(w);L=B;N=F;J=w;do M=J.prev,S=J.next.next,!k(M,S)&&e(M,J,J.next,S)&&v(M,S)&&v(S,M)&&(L.push(M.i/N),L.push(J.i/N),L.push(S.i/N),u(J),u(J.next),J=w=S),J=J.next;while(J!==w);w=A(J);n(w,B,F,G,H,I,2)}else if(2===L)a:{L=w;do{for(N=L.next.next;N!==L.prev;){if(J=
L.i!==N.i){S=S=S=S=void 0;J=L;M=N;if(S=J.next.i!==M.i&&J.prev.i!==M.i){b:{S=J;do{if(S.i!==J.i&&S.next.i!==J.i&&S.i!==M.i&&S.next.i!==M.i&&e(S,S.next,J,M)){S=!0;break b}S=S.next}while(S!==J);S=!1}S=!S}if(S){if(S=v(J,M)&&v(M,J)){S=J;O=!1;W=(J.x+M.x)/2;ba=(J.y+M.y)/2;do S.y>ba!==S.next.y>ba&&S.next.y!==S.y&&W<(S.next.x-S.x)*(ba-S.y)/(S.next.y-S.y)+S.x&&(O=!O),S=S.next;while(S!==J);S=O}S=S&&(p(J.prev,J,M.prev)||p(J,M.prev,M))||k(J,M)&&0<p(J.prev,J,J.next)&&0<p(M.prev,M,M.next)}J=S}if(J){w=x(L,N);L=A(L,
L.next);w=A(w,w.next);n(L,B,F,G,H,I);n(w,B,F,G,H,I);break a}N=N.next}L=L.next}while(L!==w)}break}}}}function l(w,B,F,G){var H=w.prev,I=w.next;if(0<=p(H,w,I))return!1;var L=H.x>w.x?H.x>I.x?H.x:I.x:w.x>I.x?w.x:I.x,N=H.y>w.y?H.y>I.y?H.y:I.y:w.y>I.y?w.y:I.y,J=c(H.x<w.x?H.x<I.x?H.x:I.x:w.x<I.x?w.x:I.x,H.y<w.y?H.y<I.y?H.y:I.y:w.y<I.y?w.y:I.y,B,F,G);B=c(L,N,B,F,G);F=w.prevZ;for(G=w.nextZ;F&&F.z>=J&&G&&G.z<=B;){if(F!==w.prev&&F!==w.next&&h(H.x,H.y,w.x,w.y,I.x,I.y,F.x,F.y)&&0<=p(F.prev,F,F.next))return!1;
F=F.prevZ;if(G!==w.prev&&G!==w.next&&h(H.x,H.y,w.x,w.y,I.x,I.y,G.x,G.y)&&0<=p(G.prev,G,G.next))return!1;G=G.nextZ}for(;F&&F.z>=J;){if(F!==w.prev&&F!==w.next&&h(H.x,H.y,w.x,w.y,I.x,I.y,F.x,F.y)&&0<=p(F.prev,F,F.next))return!1;F=F.prevZ}for(;G&&G.z<=B;){if(G!==w.prev&&G!==w.next&&h(H.x,H.y,w.x,w.y,I.x,I.y,G.x,G.y)&&0<=p(G.prev,G,G.next))return!1;G=G.nextZ}return!0}function d(w,B){return w.x-B.x}function a(w){if(w.next.prev===w)return w;let B=w;do{const F=B.next;if(F.prev===B||F===B||F===w)break;B=F}while(1);
return B}function b(w,B){var F=B,G=w.x,H=w.y,I=-Infinity;do{if(H<=F.y&&H>=F.next.y&&F.next.y!==F.y){var L=F.x+(H-F.y)*(F.next.x-F.x)/(F.next.y-F.y);if(L<=G&&L>I){I=L;if(L===G){if(H===F.y)return F;if(H===F.next.y)return F.next}var N=F.x<F.next.x?F:F.next}}F=F.next}while(F!==B);if(!N)return null;if(G===I)return N;B=N;L=N.x;var J=N.y,K=Infinity;F=N;do{if(G>=F.x&&F.x>=L&&G!==F.x&&h(H<J?G:I,H,L,J,H<J?I:G,H,F.x,F.y)){var O=Math.abs(H-F.y)/(G-F.x);var W;if((W=v(F,w))&&!(W=O<K)&&(W=O===K)&&!(W=F.x>N.x)&&
(W=F.x===N.x)){W=N;var aa=F;W=0>p(W.prev,W,aa.prev)&&0>p(aa.next,W,W.next)}W&&(N=F,K=O)}F=F.next}while(F!==B);return N}function c(w,B,F,G,H){w=32767*(w-F)*H;B=32767*(B-G)*H;w=(w|w<<8)&16711935;w=(w|w<<4)&252645135;w=(w|w<<2)&858993459;B=(B|B<<8)&16711935;B=(B|B<<4)&252645135;B=(B|B<<2)&858993459;return(w|w<<1)&1431655765|((B|B<<1)&1431655765)<<1}function f(w){var B=w,F=w;do{if(B.x<F.x||B.x===F.x&&B.y<F.y)F=B;B=B.next}while(B!==w);return F}function h(w,B,F,G,H,I,L,N){return 0<=(H-L)*(B-N)-(w-L)*(I-
N)&&0<=(w-L)*(G-N)-(F-L)*(B-N)&&0<=(F-L)*(I-N)-(H-L)*(G-N)}function p(w,B,F){return(B.y-w.y)*(F.x-B.x)-(B.x-w.x)*(F.y-B.y)}function k(w,B){return w.x===B.x&&w.y===B.y}function e(w,B,F,G){var H=r(p(w,B,F)),I=r(p(w,B,G)),L=r(p(F,G,w)),N=r(p(F,G,B));return H!==I&&L!==N||0===H&&m(w,F,B)||0===I&&m(w,G,B)||0===L&&m(F,w,G)||0===N&&m(F,B,G)?!0:!1}function m(w,B,F){return B.x<=Math.max(w.x,F.x)&&B.x>=Math.min(w.x,F.x)&&B.y<=Math.max(w.y,F.y)&&B.y>=Math.min(w.y,F.y)}function r(w){return 0<w?1:0>w?-1:0}function v(w,
B){return 0>p(w.prev,w,w.next)?0<=p(w,B,w.next)&&0<=p(w,w.prev,B):0>p(w,B,w.prev)||0>p(w,w.next,B)}function x(w,B){var F=new y(w.i,w.x,w.y),G=new y(B.i,B.x,B.y),H=w.next,I=B.prev;w.next=B;B.prev=w;F.next=H;H.prev=F;G.next=F;F.prev=G;I.next=G;G.prev=I;return G}function g(w,B,F,G){w=new y(w,B,F);G?(w.next=G.next,w.prev=G,G.next.prev=w,G.next=w):(w.prev=w,w.next=w);return w}function u(w){w.next.prev=w.prev;w.prev.next=w.next;w.prevZ&&(w.prevZ.nextZ=w.nextZ);w.nextZ&&(w.nextZ.prevZ=w.prevZ)}function y(w,
B,F){this.i=w;this.x=B;this.y=F;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function z(w,B,F,G){for(var H=0,I=F-G;B<F;B+=G)H+=(w[I]-w[B])*(w[B+1]+w[I+1]),I=B;return H}E.deviation=function(w,B,F,G){var H=B&&B.length,I=Math.abs(z(w,0,H?B[0]*F:w.length,F));if(H){H=0;for(var L=B.length;H<L;H++)I-=Math.abs(z(w,B[H]*F,H<L-1?B[H+1]*F:w.length,F))}for(H=B=0;H<G.length;H+=3){L=G[H]*F;var N=G[H+1]*F,J=G[H+2]*F;B+=Math.abs((w[L]-w[J])*(w[N+1]-w[L+1])-(w[L]-w[N])*(w[J+1]-w[L+1]))}return 0===
I&&0===B?0:Math.abs((B-I)/I)};E.flatten=function(w){for(var B=w[0][0].length,F={vertices:[],holes:[],dimensions:B},G=0,H=0;H<w.length;H++){for(var I=0;I<w[H].length;I++)for(var L=0;L<B;L++)F.vertices.push(w[H][I][L]);0<H&&(G+=w[H-1].length,F.holes.push(G))}return F};return E})})(t);q.earcut=t.exports})},"esri/views/2d/engine/webgl/Geometry":function(){define(["exports"],function(q){let t=function(){function D(C,A){this.x=C;this.y=A}var E=D.prototype;E.clone=function(){return new D(this.x,this.y)};
E.equals=function(C,A){return C===this.x&&A===this.y};E.isEqual=function(C){return C.x===this.x&&C.y===this.y};E.setCoords=function(C,A){this.x=C;this.y=A};E.normalize=function(){var C=this.x;const A=this.y;C=Math.sqrt(C*C+A*A);this.x/=C;this.y/=C};E.rightPerpendicular=function(){const C=this.x;this.x=this.y;this.y=-C};E.move=function(C,A){this.x+=C;this.y+=A};E.assign=function(C){this.x=C.x;this.y=C.y};E.assignAdd=function(C,A){this.x=C.x+A.x;this.y=C.y+A.y};E.assignSub=function(C,A){this.x=C.x-
A.x;this.y=C.y-A.y};E.rotate=function(C,A){const n=this.x,l=this.y;this.x=n*C-l*A;this.y=n*A+l*C};E.scale=function(C){this.x*=C;this.y*=C};E.length=function(){const C=this.x,A=this.y;return Math.sqrt(C*C+A*A)};D.distance=function(C,A){const n=A.x-C.x;C=A.y-C.y;return Math.sqrt(n*n+C*C)};D.add=function(C,A){return new D(C.x+A.x,C.y+A.y)};D.sub=function(C,A){return new D(C.x-A.x,C.y-A.y)};return D}();q.GeometryType=void 0;(function(D){D[D.Unknown=0]="Unknown";D[D.Point=1]="Point";D[D.LineString=2]=
"LineString";D[D.Polygon=3]="Polygon"})(q.GeometryType||(q.GeometryType={}));q.Point=t;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/TileClipper":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","./definitions","./Geometry","./GeometryUtils"],function(q,t,D,E,C){let A=function(b,c,f){this.ratio=b;this.x=c;this.y=f},n=function(){function b(f,h,p,k=8,e=8){this.lines=[];this.starts=[];this.validateTessellation=
!0;this.pixelRatio=k;this.pixelMargin=e;this.tileSize=D.TILE_SIZE*k;this.dz=f;this.yPos=h;this.xPos=p}var c=b.prototype;c.setPixelMargin=function(f){f!==this.pixelMargin&&(this.pixelMargin=f,this.setExtent(this._extent))};c.setExtent=function(f){this._extent=f;this.finalRatio=this.tileSize/f*(1<<this.dz);let h=this.pixelRatio*this.pixelMargin;h/=this.finalRatio;f>>=this.dz;h>f&&(h=f);this.margin=h;this.xmin=f*this.xPos-h;this.ymin=f*this.yPos-h;this.xmax=this.xmin+f+2*h;this.ymax=this.ymin+f+2*h};
c.reset=function(f){this.type=f;this.lines=[];this.starts=[];this.line=null;this.start=0};c.moveTo=function(f,h){this._pushLine();this._prevIsIn=this._isIn(f,h);this._moveTo(f,h,this._prevIsIn);this._prevPt=new E.Point(f,h);this._firstPt=new E.Point(f,h);this._dist=0};c.lineTo=function(f,h){const p=this._isIn(f,h),k=new E.Point(f,h),e=E.Point.distance(this._prevPt,k);if(p)if(this._prevIsIn)this._lineTo(f,h,!0);else{var m=this._prevPt;var r=k;f=this._intersect(r,m);this.start=this._dist+e*(1-this._r);
this._lineTo(f.x,f.y,!0);this._lineTo(r.x,r.y,!0)}else if(this._prevIsIn)r=this._prevPt,m=k,f=this._intersect(r,m),this._lineTo(f.x,f.y,!0),this._lineTo(m.x,m.y,!1);else{const x=this._prevPt;if(!(x.x<=this.xmin&&k.x<=this.xmin||x.x>=this.xmax&&k.x>=this.xmax||x.y<=this.ymin&&k.y<=this.ymin||x.y>=this.ymax&&k.y>=this.ymax)){f=[];if(x.x<this.xmin&&k.x>this.xmin||x.x>this.xmin&&k.x<this.xmin){h=(this.xmin-x.x)/(k.x-x.x);var v=x.y+h*(k.y-x.y);v<=this.ymin?r=!1:v>=this.ymax?r=!0:f.push(new A(h,this.xmin,
v))}if(x.x<this.xmax&&k.x>this.xmax||x.x>this.xmax&&k.x<this.xmax)h=(this.xmax-x.x)/(k.x-x.x),v=x.y+h*(k.y-x.y),v<=this.ymin?r=!1:v>=this.ymax?r=!0:f.push(new A(h,this.xmax,v));if(x.y<this.ymin&&k.y>this.ymin||x.y>this.ymin&&k.y<this.ymin)h=(this.ymin-x.y)/(k.y-x.y),v=x.x+h*(k.x-x.x),v<=this.xmin?m=!1:v>=this.xmax?m=!0:f.push(new A(h,v,this.ymin));if(x.y<this.ymax&&k.y>this.ymax||x.y>this.ymax&&k.y<this.ymax)h=(this.ymax-x.y)/(k.y-x.y),v=x.x+h*(k.x-x.x),v<=this.xmin?m=!1:v>=this.xmax?m=!0:f.push(new A(h,
v,this.ymax));if(0===f.length)m?r?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):r?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(1<f.length&&f[0].ratio>f[1].ratio)this.start=this._dist+e*f[1].ratio,this._lineTo(f[1].x,f[1].y,!0),this._lineTo(f[0].x,f[0].y,!0);else for(this.start=this._dist+e*f[0].ratio,m=0;m<f.length;m++)this._lineTo(f[m].x,f[m].y,!0)}this._lineTo(k.x,k.y,!1)}this._dist+=e;this._prevIsIn=p;this._prevPt=k};c.close=function(){if(2<
this.line.length){var f=this._firstPt,h=this._prevPt;f.x===h.x&&f.y===h.y||this.lineTo(f.x,f.y);f=this.line;for(h=f.length;4<=h;)if(f[0].x===f[1].x&&f[0].x===f[h-2].x||f[0].y===f[1].y&&f[0].y===f[h-2].y)f.pop(),f[0].x=f[h-2].x,f[0].y=f[h-2].y,--h;else break}};c.result=function(f=!0){this._pushLine();if(0===this.lines.length)return null;this.type===E.GeometryType.Polygon&&f&&a.simplify(this.tileSize,this.margin*this.finalRatio,this.lines);return this.lines};c.resultWithStarts=function(){if(this.type!==
E.GeometryType.LineString)throw Error("Only valid for lines");this._pushLine();const f=this.lines,h=f.length;if(0===h)return null;const p=[];for(let k=0;k<h;k++)p.push({line:f[k],start:this.starts[k]||0});return p};c._isIn=function(f,h){return f>=this.xmin&&f<=this.xmax&&h>=this.ymin&&h<=this.ymax};c._intersect=function(f,h){let p,k,e;if(h.x>=this.xmin&&h.x<=this.xmax)k=h.y<=this.ymin?this.ymin:this.ymax,e=(k-f.y)/(h.y-f.y),p=f.x+e*(h.x-f.x);else if(h.y>=this.ymin&&h.y<=this.ymax)p=h.x<=this.xmin?
this.xmin:this.xmax,e=(p-f.x)/(h.x-f.x),k=f.y+e*(h.y-f.y);else{k=h.y<=this.ymin?this.ymin:this.ymax;p=h.x<=this.xmin?this.xmin:this.xmax;const m=(p-f.x)/(h.x-f.x),r=(k-f.y)/(h.y-f.y);m<r?(e=m,k=f.y+m*(h.y-f.y)):(e=r,p=f.x+r*(h.x-f.x))}this._r=e;return new E.Point(p,k)};c._pushLine=function(){this.line&&(this.type===E.GeometryType.Point?0<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):this.type===E.GeometryType.LineString?1<this.line.length&&(this.lines.push(this.line),
this.starts.push(this.start)):this.type===E.GeometryType.Polygon&&3<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)));this.line=[];this.start=0};c._moveTo=function(f,h,p){this.type!==E.GeometryType.Polygon?p&&(f=Math.round((f-(this.xmin+this.margin))*this.finalRatio),h=Math.round((h-(this.ymin+this.margin))*this.finalRatio),this.line.push(new E.Point(f,h))):(p||(f<this.xmin&&(f=this.xmin),f>this.xmax&&(f=this.xmax),h<this.ymin&&(h=this.ymin),h>this.ymax&&(h=this.ymax)),
f=Math.round((f-(this.xmin+this.margin))*this.finalRatio),h=Math.round((h-(this.ymin+this.margin))*this.finalRatio),this.line.push(new E.Point(f,h)),this._is_v=this._is_h=!1)};c._lineTo=function(f,h,p){if(this.type!==E.GeometryType.Polygon)if(p){f=Math.round((f-(this.xmin+this.margin))*this.finalRatio);h=Math.round((h-(this.ymin+this.margin))*this.finalRatio);if(0<this.line.length&&(p=this.line[this.line.length-1],p.equals(f,h)))return;this.line.push(new E.Point(f,h))}else this.line&&0<this.line.length&&
this._pushLine();else if(p||(f<this.xmin&&(f=this.xmin),f>this.xmax&&(f=this.xmax),h<this.ymin&&(h=this.ymin),h>this.ymax&&(h=this.ymax)),f=Math.round((f-(this.xmin+this.margin))*this.finalRatio),h=Math.round((h-(this.ymin+this.margin))*this.finalRatio),this.line&&0<this.line.length){p=this.line[this.line.length-1];const k=p.x===f,e=p.y===h;k&&e||(this._is_h&&k?(p.x=f,p.y=h,p=this.line[this.line.length-2],p.x===f&&p.y===h?(this.line.pop(),1>=this.line.length?this._is_v=this._is_h=!1:(p=this.line[this.line.length-
2],this._is_h=p.x===f,this._is_v=p.y===h)):(this._is_h=p.x===f,this._is_v=p.y===h)):this._is_v&&e?(p.x=f,p.y=h,p=this.line[this.line.length-2],p.x===f&&p.y===h?(this.line.pop(),1>=this.line.length?this._is_v=this._is_h=!1:(p=this.line[this.line.length-2],this._is_h=p.x===f,this._is_v=p.y===h)):(this._is_h=p.x===f,this._is_v=p.y===h)):(this.line.push(new E.Point(f,h)),this._is_h=k,this._is_v=e))}else this.line.push(new E.Point(f,h))};return b}(),l=function(){function b(){}var c=b.prototype;c.setExtent=
function(f){this._ratio=4096===f?1:4096/f};c.reset=function(f){this.lines=[];this.line=null};c.moveTo=function(f,h){this.line&&this.lines.push(this.line);this.line=[];const p=this._ratio;this.line.push(new E.Point(f*p,h*p))};c.lineTo=function(f,h){const p=this._ratio;this.line.push(new E.Point(f*p,h*p))};c.close=function(){const f=this.line;f&&!f[0].isEqual(f[f.length-1])&&f.push(f[0])};c.result=function(){this.line&&this.lines.push(this.line);return 0===this.lines.length?null:this.lines};t._createClass(b,
[{key:"validateTessellation",get:function(){return 1>this._ratio}}]);return b}();var d;(function(b){b[b.sideLeft=0]="sideLeft";b[b.sideRight=1]="sideRight";b[b.sideTop=2]="sideTop";b[b.sideBottom=3]="sideBottom"})(d||(d={}));let a=function(){function b(){}b.simplify=function(c,f,h){if(h){var p=-f,k=c+f,e=-f,m=c+f;c=[];f=[];var r=h.length;for(let v=0;v<r;++v){const x=h[v];if(!x||2>x.length)continue;let g=x[0],u;const y=x.length;for(let z=1;z<y;++z)u=x[z],g.x===u.x&&(g.x<=p&&(g.y>u.y?(c.push(v),c.push(z),
c.push(d.sideLeft),c.push(-1)):(f.push(v),f.push(z),f.push(d.sideLeft),f.push(-1))),g.x>=k&&(g.y<u.y?(c.push(v),c.push(z),c.push(d.sideRight),c.push(-1)):(f.push(v),f.push(z),f.push(d.sideRight),f.push(-1)))),g.y===u.y&&(g.y<=e&&(g.x<u.x?(c.push(v),c.push(z),c.push(d.sideTop),c.push(-1)):(f.push(v),f.push(z),f.push(d.sideTop),f.push(-1))),g.y>=m&&(g.x>u.x?(c.push(v),c.push(z),c.push(d.sideBottom),c.push(-1)):(f.push(v),f.push(z),f.push(d.sideBottom),f.push(-1)))),g=u}0!==c.length&&0!==f.length&&(b.fillParent(h,
f,c),b.fillParent(h,c,f),p=[],b.calcDeltas(p,f,c),b.calcDeltas(p,c,f),b.addDeltas(p,h))}};b.fillParent=function(c,f,h){const p=h.length,k=f.length;for(let x=0;x<k;x+=4){var e=f[x],m=f[x+1];const g=f[x+2],u=c[e][m-1];e=c[e][m];m=8092;let y=-1;for(let z=0;z<p;z+=4){if(h[z+2]!==g)continue;var r=h[z];const w=h[z+1];var v=c[r][w-1];r=c[r][w];switch(g){case d.sideLeft:case d.sideRight:C.between(u.y,v.y,r.y)&&C.between(e.y,v.y,r.y)&&(v=Math.abs(r.y-v.y),v<m&&(m=v,y=z));break;case d.sideTop:case d.sideBottom:C.between(u.x,
v.x,r.x)&&C.between(e.x,v.x,r.x)&&(v=Math.abs(r.x-v.x),v<m&&(m=v,y=z))}}f[x+3]=y}};b.calcDeltas=function(c,f,h){const p=f.length;for(let k=0;k<p;k+=4){const e=b.calcDelta(k,f,h,[]);c.push(f[k]);c.push(f[k+1]);c.push(f[k+2]);c.push(e)}};b.calcDelta=function(c,f,h,p){c=f[c+3];if(-1===c)return 0;const k=p.length;if(1<k&&p[k-2]===c)return 0;p.push(c);return b.calcDelta(c,h,f,p)+1};b.addDeltas=function(c,f){const h=c.length;let p=0;for(var k=0;k<h;k+=4){var e=c[k+3];e>p&&(p=e)}for(k=0;k<h;k+=4){e=f[c[k]];
const m=c[k+1],r=p-c[k+3];switch(c[k+2]){case d.sideLeft:e[m-1].x-=r;e[m].x-=r;1===m&&(e[e.length-1].x-=r);m===e.length-1&&(e[0].x-=r);break;case d.sideRight:e[m-1].x+=r;e[m].x+=r;1===m&&(e[e.length-1].x+=r);m===e.length-1&&(e[0].x+=r);break;case d.sideTop:e[m-1].y-=r;e[m].y-=r;1===m&&(e[e.length-1].y-=r);m===e.length-1&&(e[0].y-=r);break;case d.sideBottom:e[m-1].y+=r,e[m].y+=r,1===m&&(e[e.length-1].y+=r),m===e.length-1&&(e[0].y+=r)}}};return b}();q.SimpleBuilder=l;q.TileClipper=n;Object.defineProperties(q,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/bufcut":function(){define(["exports"],function(q){function t(g,u,y,z,w,B,F){let G;y=0;for(let H=z,I=w-B;H<w;H+=B)y+=(g[I+u*B]-g[H+u*B])*(g[H+1+u*B]+g[I+1+u*B]),I=H;if(F===0<y)for(;z<w;z+=B)G=A(z+u*B,g[z+u*B],g[z+1+u*B],G);else for(w-=B;w>=z;w-=B)G=A(w+u*B,g[w+u*B],g[w+1+u*B],G);G&&k(G,G.next)&&(n(G),G=G.next);return G}function D(g,u=g){if(!g)return g;let y;do if(y=!1,g.steiner||!k(g,g.next)&&0!==b(g.prev,
g,g.next))g=g.next;else{n(g);g=u=g.prev;if(g===g.next)break;y=!0}while(y||g!==u);return u}function E(g,u,y,z,w,B,F,G){if(g){!G&&B&&(g=a(g,z,w,B));for(var H=g;g.prev!==g.next;){var I=g.prev,L=g.next;if(B)var N=C(g,z,w,B);else a:{N=g;var J=N.prev,K=N;const O=N.next;if(0<=b(J,K,O)){N=!1;break a}let W=N.next.next;const aa=W;let ba=0;for(;W!==N.prev&&(0===ba||W!==aa);){ba++;if(f(J.x,J.y,K.x,K.y,O.x,O.y,W.x,W.y)&&0<=b(W.prev,W,W.next)){N=!1;break a}W=W.next}N=!0}if(N)u.push(I.index/y+F),u.push(g.index/
y+F),u.push(L.index/y+F),n(g),H=g=L.next;else if(g=L,g===H){if(!G)E(D(g),u,y,z,w,B,F,1);else if(1===G){G=u;H=y;I=F;L=g;do N=L.prev,J=L.next.next,!k(N,J)&&c(N,L,L.next,J)&&h(N,J)&&h(J,N)&&(G.push(N.index/H+I),G.push(L.index/H+I),G.push(J.index/H+I),n(L),n(L.next),L=g=J),L=L.next;while(L!==g);g=L;E(g,u,y,z,w,B,F,2)}else if(2===G)a:{G=g;do{for(H=G.next.next;H!==G.prev;){if(I=G.index!==H.index){N=N=N=void 0;I=G;L=H;if(N=I.next.index!==L.index&&I.prev.index!==L.index){b:{N=I;do{if(N.index!==I.index&&N.next.index!==
I.index&&N.index!==L.index&&N.next.index!==L.index&&c(N,N.next,I,L)){N=!0;break b}N=N.next}while(N!==I);N=!1}N=!N}if(N=N&&h(I,L)&&h(L,I)){N=I;J=!1;K=(I.x+L.x)/2;L=(I.y+L.y)/2;do N.y>L!==N.next.y>L&&N.next.y!==N.y&&K<(N.next.x-N.x)*(L-N.y)/(N.next.y-N.y)+N.x&&(J=!J),N=N.next;while(N!==I);N=J}I=N}if(I){g=m(G,H);G=D(G,G.next);g=D(g,g.next);E(G,u,y,z,w,B,F,0);E(g,u,y,z,w,B,F,0);break a}H=H.next}G=G.next}while(G!==g)}break}}}}function C(g,u,y,z){const w=g.prev,B=g.next;if(0<=b(w,g,B))return!1;const F=
w.x>g.x?w.x>B.x?w.x:B.x:g.x>B.x?g.x:B.x,G=w.y>g.y?w.y>B.y?w.y:B.y:g.y>B.y?g.y:B.y,H=p(w.x<g.x?w.x<B.x?w.x:B.x:g.x<B.x?g.x:B.x,w.y<g.y?w.y<B.y?w.y:B.y:g.y<B.y?g.y:B.y,u,y,z);u=p(F,G,u,y,z);y=g.prevZ;for(z=g.nextZ;y&&y.z>=H&&z&&z.z<=u;){if(y!==g.prev&&y!==g.next&&f(w.x,w.y,g.x,g.y,B.x,B.y,y.x,y.y)&&0<=b(y.prev,y,y.next))return!1;y=y.prevZ;if(z!==g.prev&&z!==g.next&&f(w.x,w.y,g.x,g.y,B.x,B.y,z.x,z.y)&&0<=b(z.prev,z,z.next))return!1;z=z.nextZ}for(;y&&y.z>=H;){if(y!==g.prev&&y!==g.next&&f(w.x,w.y,g.x,
g.y,B.x,B.y,y.x,y.y)&&0<=b(y.prev,y,y.next))return!1;y=y.prevZ}for(;z&&z.z<=u;){if(z!==g.prev&&z!==g.next&&f(w.x,w.y,g.x,g.y,B.x,B.y,z.x,z.y)&&0<=b(z.prev,z,z.next))return!1;z=z.nextZ}return!0}function A(g,u,y,z){g=r.create(g,u,y);z?(g.next=z.next,g.prev=z,z.next.prev=g,z.next=g):(g.prev=g,g.next=g);return g}function n(g){g.next.prev=g.prev;g.prev.next=g.next;g.prevZ&&(g.prevZ.nextZ=g.nextZ);g.nextZ&&(g.nextZ.prevZ=g.prevZ)}function l(g){let u=g,y=g;do{if(u.x<y.x||u.x===y.x&&u.y<y.y)y=u;u=u.next}while(u!==
g);return y}function d(g,u){let y=u;const z=g.x,w=g.y;let B=-Infinity,F;do{if(w<=y.y&&w>=y.next.y&&y.next.y!==y.y){var G=y.x+(w-y.y)*(y.next.x-y.x)/(y.next.y-y.y);if(G<=z&&G>B){B=G;if(G===z){if(w===y.y)return y;if(w===y.next.y)return y.next}F=y.x<y.next.x?y:y.next}}y=y.next}while(y!==u);if(!F)return null;if(z===B)return F.prev;u=F;G=F.x;const H=F.y;let I=Infinity,L;for(y=F.next;y!==u;)z>=y.x&&y.x>=G&&z!==y.x&&f(w<H?z:B,w,G,H,w<H?B:z,w,y.x,y.y)&&(L=Math.abs(w-y.y)/(z-y.x),(L<I||L===I&&y.x>F.x)&&h(y,
g)&&(F=y,I=L)),y=y.next;return F}function a(g,u,y,z){for(var w;w!==g;w=w.next){w=w||g;null===w.z&&(w.z=p(w.x,w.y,u,y,z));if(w.prev.next!==w||w.next.prev!==w)return w.prev.next=w,w.next.prev=w,a(g,u,y,z);w.prevZ=w.prev;w.nextZ=w.next}g.prevZ.nextZ=null;g.prevZ=null;a:for(y=1;;){z=g;u=g=null;let B=0;for(;z;){B++;w=z;let F=0;for(;F<y&&w;F++)w=w.nextZ;let G=y;for(;0<F||0<G&&w;){let H;0===F?(H=w,w=w.nextZ,G--):0!==G&&w?z.z<=w.z?(H=z,z=z.nextZ,F--):(H=w,w=w.nextZ,G--):(H=z,z=z.nextZ,F--);u?u.nextZ=H:g=
H;H.prevZ=u;u=H}z=w}u.nextZ=null;y*=2;if(2>B)break a}return g}function b(g,u,y){return(u.y-g.y)*(y.x-u.x)-(u.x-g.x)*(y.y-u.y)}function c(g,u,y,z){return k(g,u)&&k(y,z)||k(g,z)&&k(y,u)?!0:0<b(g,u,y)!==0<b(g,u,z)&&0<b(y,z,g)!==0<b(y,z,u)}function f(g,u,y,z,w,B,F,G){return 0<=(w-F)*(u-G)-(g-F)*(B-G)&&0<=(g-F)*(z-G)-(y-F)*(u-G)&&0<=(y-F)*(B-G)-(w-F)*(z-G)}function h(g,u){return 0>b(g.prev,g,g.next)?0<=b(g,u,g.next)&&0<=b(g,g.prev,u):0>b(g,u,g.prev)||0>b(g,g.next,u)}function p(g,u,y,z,w){g=32767*(g-y)*
w;u=32767*(u-z)*w;g=(g|g<<8)&16711935;g=(g|g<<4)&252645135;g=(g|g<<2)&858993459;u=(u|u<<8)&16711935;u=(u|u<<4)&252645135;u=(u|u<<2)&858993459;return(g|g<<1)&1431655765|((u|u<<1)&1431655765)<<1}function k(g,u){return g.x===u.x&&g.y===u.y}function e(g,u){return g.x-u.x}function m(g,u){const y=r.create(g.index,g.x,g.y),z=r.create(u.index,u.x,u.y),w=g.next,B=u.prev;g.next=u;u.prev=g;y.next=w;w.prev=y;z.next=y;y.prev=z;B.next=z;z.prev=B;return z}let r=function(){function g(){this.y=this.x=this.index=0;
this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}g.create=function(u,y,z){const w=x<v.length?v[x++]:new g;w.index=u;w.x=y;w.y=z;w.prev=null;w.next=null;w.z=null;w.prevZ=null;w.nextZ=null;w.steiner=!1;return w};return g}();const v=[];let x=0;for(let g=0;8096>g;g++)v.push(new r);q.bufcut=function(g,u,y,z,w,B,F){x=0;var G=(z-y)*B,H=w&&w.length;const I=H?(w[0]-y)*B:G;var L=t(u,y,z,0,I,B,!0);if(L&&L.next!==L.prev){var N;if(H){H=[];for(let W=0,aa=w.length;W<aa;W++){const ba=t(u,y,z,
w[W]*B,W<aa-1?w[W+1]*B:z*B,B,!1);ba===ba.next&&(ba.steiner=!0);H.push(l(ba))}H.sort(e);for(var J of H){z=J;w=L;if(w=d(z,w))z=m(w,z),D(z,z.next);L=D(L,L.next)}}if(G>80*B){var K=G=u[y*B];var O=N=u[1+y*B];for(J=B;J<I;J+=B)z=u[J+y*B],w=u[J+1+y*B],K=Math.min(K,z),O=Math.min(O,w),G=Math.max(G,z),N=Math.max(N,w);N=Math.max(G-K,N-O);N=0!==N?1/N:0}E(L,g,B,K,O,N,F,0)}};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Logger ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../Utils ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLMeshTemplate".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c){const f=t.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate");return function(h){function p(k,e,m,r,v,x,g,u,y,z,w,B,F,G,H,I,L,N,J,K){var O=h.call(this)||this;k=d.LineMaterialKey.load(k);e&&(k.sdf=e.sdf,k.pattern=!0,k.textureBinding=e.textureBinding);O._capType=r;O._joinType=v;O._miterLimitCosine=a.getLimitCosine(x);O.tessellationProperties._fillColor=g;O.tessellationProperties._tl=u;O.tessellationProperties._br=y;O._hasPattern=z;O._isDashed=w;O._zOrder=L;O._effects=
N;O._minMaxZoom=n.i1616to32(Math.round(J*A.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(K*A.MIN_MAX_ZOOM_PRECISION_FACTOR));O._materialKey=k.data;O.tessellationProperties._bitset=(F?A.BITSET_GENERIC_LOCK_COLOR:0)|(G?A.BITSET_TYPE_FILL_OUTLINE:0)|(B?A.BITSET_LINE_SCALE_DASH:0)|(H?A.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);O.tessellationProperties._halfWidth=.5*m;O.tessellationProperties._halfReferenceWidth=.5*I;O.tessellationProperties.offset=0;O._initializeTessellator(!1);return O}q._inheritsLoose(p,h);
p.fromCIMLine=function(k,e,m){var r=k.color,v=k.scaleFactor||1;const x=!!k.dashTemplate;let g=k.cap;x&&g===E.CapType.ROUND&&(g=E.CapType.SQUARE);const u=k.join;v*=D.pt2px(k.width);const y=D.pt2px(k.referenceWidth),z=D.pt2px(k.miterLimit);r=r&&C.premultiplyAlphaRGBA(r)||0;const [w,B]=a.getMinMaxZoom(k.scaleInfo,m);if(!e)return new p(k.materialKey,e,v,g,u,z,r,0,0,!1,x,k.scaleDash,k.colorLocked,!1,k.sampleAlphaOnly,y,k.zOrder,k.effects,w,B);const {rect:F,width:G,height:H}=e;var I=F.x+A.SPRITE_PADDING;
const L=F.y+A.SPRITE_PADDING;m=I+G;const N=L+H;I=n.i1616to32(I,L);m=n.i1616to32(m,N);return new p(k.materialKey,e,v,g,u,z,r,I,m,!0,x,k.scaleDash,k.colorLocked,!1,k.sampleAlphaOnly,y,k.zOrder,k.effects,w,B)};p.fromFillOutline=function(k){var e;const m=d.FillMaterialKey.load(k.materialKey);return d.hasOutlineFillSymbology(m)&&k.outline&&"esriSLSSolid"===(null==(e=k.outline)?void 0:e.style)?p.fromSimpleLine({hash:"",materialKey:k.materialKey,...k.outline},null,!0):null};p.fromSimpleLine=function(k,e,
m=!1){var {color:r}=k;const v="esriSLSSolid"!==k.style&&"esriSLSNull"!==k.style,x=l.getCapType(k.cap||"round"),g=l.getJoinType(k.join||"round");r=r&&"esriSLSNull"!==k.style&&C.premultiplyAlphaRGBAArray(r)||0;"esriSLSNull"===k.style&&(r=0);const u=D.pt2px(k.width),y=k.miterLimit;if(!e)return new p(k.materialKey,e,u,x,g,y,r,0,0,!1,v,!0,!1,m,!1,u,0,null,a.DEFAULT_MIN_ZOOM,a.DEFAULT_MAX_ZOOM);const {rect:z,width:w,height:B}=e;var F=z.x+A.SPRITE_PADDING;const G=z.y+A.SPRITE_PADDING;var H=F+w;const I=G+
B;F=n.i1616to32(F,G);H=n.i1616to32(H,I);return new p(k.materialKey,e,u,x,g,y,r,F,H,!0,v,!0,!1,m,!1,u,0,null,a.DEFAULT_MIN_ZOOM,a.DEFAULT_MAX_ZOOM)};p.fromPictureLineSymbol=function(k,e,m,r){f.error("PictureLineSymbol support does not exist!");return null};return p}(b(c))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../definitions ../../enums ../../number ../../TurboLine ../../materialKey/MaterialKey ./templateUtils".split(" "),
function(q,t,D,E,C,A,n,l){const d=(c,f,h)=>(p,k,e,m,r,v,x,g,u,y,z)=>{e=C.i1616to32(z,Math.ceil(16*c._halfWidth));x=C.i8888to32(Math.round(16*x),Math.round(16*g),Math.round(16*u),Math.round(16*y));r=C.i8888to32(16*r,16*v,0,c._bitset);v=c.out;v.vertexBounds(p,k,f,h);v.vertexWrite(C.i1616to32(8*p,8*k));v.vertexWrite(c.id);v.vertexWrite(c._fillColor);v.vertexWrite(x);v.vertexWrite(e);v.vertexWrite(c._tl);v.vertexWrite(c._br);v.vertexWrite(r);v.vertexWrite(C.i1616to32(Math.ceil(16*c._halfReferenceWidth),
0));v.vertexWrite(c.minMaxZoom);v.vertexEnd();return c.offset+c.vertexCount++},a=(c,f,h)=>(p,k,e,m,r,v,x,g,u,y,z)=>{e=C.i1616to32(16*c._halfWidth,16*c._halfReferenceWidth);x=C.i8888to32(16*x+128,16*g+128,16*u+128,16*y+128);g=c.out;u=c._bitset<<24|c.id;g.vertexBounds(p,k,f,h);g.vertexWrite(C.i1616to32(8*p,8*k));g.vertexWrite(u);g.vertexWrite(c._fillColor);p=n.hasSimpleSymbology(c.key);p||(g.vertexWrite(0),g.vertexWrite(0));g.vertexWrite(0);g.vertexWrite(e);g.vertexWrite(x);p||g.vertexWrite(c.minMaxZoom);
g.vertexEnd();return c.offset+c.vertexCount++},b=c=>(f,h,p)=>{const k=c.out;k.indexWrite(f);k.indexWrite(h);k.indexWrite(p);c.indexCount+=3};return c=>function(f){function h(...k){k=f.call(this,...k)||this;k.tessellationProperties={};k._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0};k.geometryType=E.WGLGeometryType.LINE;return k}q._inheritsLoose(h,f);var p=h.prototype;p.writeGeometry=function(k,e,m,r){this._writeGeometry(k,e,m,r)};p._initializeTessellator=function(k){var e=n.LineMaterialKey.load(this._materialKey),
m=n.FillMaterialKey.load(this._materialKey),r=this._tessellationOptions;e=e.vvSizeFieldStops||e.vvSizeMinMaxValue||e.vvSizeScaleStops||e.vvSizeUnitValue;k=this.tessellationProperties._halfWidth<D.THIN_LINE_HALF_WIDTH_THRESHOLD&&!k&&!e;this.tessellationProperties.minMaxZoom=this._minMaxZoom;r.wrapDistance=65535;r.textured=this._isDashed||this._hasPattern;r.offset=this.tessellationProperties.offset;r.halfWidth=this.tessellationProperties._halfWidth;r=k?0:1;m=n.hasOutlineFillSymbology(m)?a:d;this._lineTessellator=
new A.LineTessellation(m(this.tessellationProperties,r,r),b(this.tessellationProperties),k)};p._write=function(k,e,m,r){m="esriGeometryPoint"===e.geometryType;k.recordStart(e.getDisplayId(),this._materialKey,this.geometryType,m);this._writeGeometry(k,e,r,m);k.recordEnd()};p._writeGeometry=function(k,e,m,r){m=null!=m?m:e.readLegacyGeometryForDisplay();r=this._getLines(m,r);t.isNone(r)||this._writeVertices(k,e,r)};p._getLines=function(k,e){if(t.isNone(k))return null;k=k.paths||k.rings;return t.isNone(k)?
null:l.clipLinesMarshall(k,e?256:16)};p._writeVertices=function(k,e,m){const r=e.getDisplayId(),v=k.vertexCount(),x=this.tessellationProperties;e=this._tessellationOptions;x.out=k;x.id=r;x.indexCount=0;x.vertexCount=0;x.offset=v;e.capType=this._capType;e.joinType=this._joinType;k=n.FillMaterialKey.load(this._materialKey);this.tessellationProperties.key=n.hasOutlineFillSymbology(k)?k:n.LineMaterialKey.load(this._materialKey);for(const {line:g,start:u}of m)e.initialDistance=u%65535,this._lineTessellator.tessellate(g,
e)};return h}(c)})},"esri/views/2d/engine/webgl/TurboLine":function(){define(["exports","../../../../symbols/cim/enums","./definitions"],function(q,t,D){function E(c,f){return c.x===f.x&&c.y===f.y}function C(c,f){c.x=f.y;c.y=-f.x;return c}function A(c,f){c.x=-f.y;c.y=f.x;return c}function n(c,f){c.x=f.x;c.y=f.y;return c}function l(c,f){c.x=-f.x;c.y=-f.y;return c}function d(c){return Math.sqrt(c.x*c.x+c.y*c.y)}function a(c,f,h,p){c.x=f.x*h+f.y*p;c.y=f.x*p-f.y*h;return c}let b=function(){function c(h,
p,k){this.writeVertex=h;this.writeTriangle=p;this.canUseThinTessellation=k;this.prevNormal={x:void 0,y:void 0};this.nextNormal={x:void 0,y:void 0};this.textureNormalLeft={x:0,y:1};this.textureNormalRight={x:0,y:-1};this.textureNormal={x:void 0,y:void 0};this.joinNormal={x:void 0,y:void 0};this.inner={x:void 0,y:void 0};this.outer={x:void 0,y:void 0};this.roundStart={x:void 0,y:void 0};this.roundEnd={x:void 0,y:void 0};this.startBreak={x:void 0,y:void 0};this.endBreak={x:void 0,y:void 0};this.innerPrev=
{x:void 0,y:void 0};this.innerNext={x:void 0,y:void 0};this.bevelStart={x:void 0,y:void 0};this.bevelEnd={x:void 0,y:void 0};this.bevelMiddle={x:void 0,y:void 0}}var f=c.prototype;f.tessellate=function(h,p){if(h){var k=h.length;if(!(1>=k)){var e=0;for(let m=1;m<k;m++)E(h[m],h[e])||++e===m||(h[e]=h[m]);h.length=e+1}}this.canUseThinTessellation&&p.halfWidth<D.THIN_LINE_HALF_WIDTH_THRESHOLD&&!p.offset?this._tessellateThin(h,p):this._tessellate(h,p)};f._tessellateThin=function(h,p){if(!(2>h.length)){var k=
p.wrapDistance||65535;p=p.initialDistance||0;var e=!1,m=h[0].x,r=h[0].y,v=h.length;for(let y=1;y<v;++y){e&&(e=!1,p=0);let z=h[y].x,w=h[y].y;var x=z-m;let B=w-r;var g=Math.sqrt(x*x+B*B);x/=g;B/=g;if(p+g>k){e=!0;var u=(k-p)/g;g=k-p;z=(1-u)*m+u*z;w=(1-u)*r+u*w;--y}u=this.writeVertex(m,r,0,0,x,B,B,-x,0,-1,p);m=this.writeVertex(m,r,0,0,x,B,-B,x,0,1,p);p+=g;g=this.writeVertex(z,w,0,0,x,B,B,-x,0,-1,p);x=this.writeVertex(z,w,0,0,x,B,-B,x,0,1,p);this.writeTriangle(u,m,g);this.writeTriangle(m,g,x);m=z;r=w}}};
f._tessellate=function(h,p){var k=h[h.length-1];const e=E(h[0],k);if(!(h.length<(e?3:2))){var m=p.pixelCoordRatio,r=null!=p.capType?p.capType:t.CapType.BUTT,v=null!=p.joinType?p.joinType:t.JoinType.MITER,x=null!=p.miterLimit?Math.min(p.miterLimit,4):2,g=null!=p.roundLimit?Math.min(p.roundLimit,1.05):1.05,u=null!=p.halfWidth?p.halfWidth:2,y=!!p.textured,z=null,w=null,B=this.prevNormal,F=this.nextNormal,G=-1,H=-1,I=this.joinNormal,L=this.textureNormalLeft,N=this.textureNormalRight,J=this.textureNormal,
K=-1,O=-1,W=p.wrapDistance||65535,aa=p.initialDistance||0,ba=this.writeVertex,S=this.writeTriangle;p=(ea,ha,ka,la,ma,oa)=>{ea=ba(M,Q,P,X,ka,la,ea,ha,ma,oa,aa);0<=K&&0<=O&&0<=ea&&S(K,O,ea);K=O;return O=ea};e&&(z=h[h.length-2],F.x=k.x-z.x,F.y=k.y-z.y,H=d(F),F.x/=H,F.y/=H);k=!1;for(let ea=0;ea<h.length;++ea){k&&(k=!1,aa=0);z&&(B.x=-F.x,B.y=-F.y,G=H,aa+G>W&&(k=!0));k?(w=(W-aa)/G,G=W-aa,z={x:(1-w)*z.x+w*h[ea].x,y:(1-w)*z.y+w*h[ea].y},--ea):z=h[ea];var M=z.x;var Q=z.y;var Y=0>=ea&&!k,V=ea===h.length-1;
Y||(aa+=G);(w=V?e?h[1]:null:h[ea+1])?(F.x=w.x-M,F.y=w.y-Q,H=d(F),F.x/=H,F.y/=H):(F.x=void 0,F.y=void 0);if(!e){if(Y){A(I,F);var P=I.x;var X=I.y;r===t.CapType.SQUARE&&(p(-F.y-F.x,F.x-F.y,F.x,F.y,0,-1),p(F.y-F.x,-F.x-F.y,F.x,F.y,0,1));r===t.CapType.ROUND&&(p(-F.y-F.x,F.x-F.y,F.x,F.y,-1,-1),p(F.y-F.x,-F.x-F.y,F.x,F.y,-1,1));if(r===t.CapType.ROUND||r===t.CapType.BUTT)p(-F.y,F.x,F.x,F.y,0,-1),p(F.y,-F.x,F.x,F.y,0,1);continue}if(V){C(I,B);P=I.x;X=I.y;if(r===t.CapType.ROUND||r===t.CapType.BUTT)p(B.y,-B.x,
-B.x,-B.y,0,-1),p(-B.y,B.x,-B.x,-B.y,0,1);r===t.CapType.SQUARE&&(p(B.y-B.x,-B.x-B.y,-B.x,-B.y,0,-1),p(-B.y-B.x,B.x-B.y,-B.x,-B.y,0,1));r===t.CapType.ROUND&&(p(B.y-B.x,-B.x-B.y,-B.x,-B.y,1,-1),p(-B.y-B.x,B.x-B.y,-B.x,-B.y,1,1));continue}}var R=void 0;Y=-(B.x*F.y-B.y*F.x);.01>Math.abs(Y)?0<B.x*F.x+B.y*F.y?(I.x=B.x,I.y=B.y,Y=1,R=Number.MAX_VALUE,w=!0):(A(I,F),R=Y=1,w=!1):(I.x=(B.x+F.x)/Y,I.y=(B.y+F.y)/Y,R=d(I),w=(R-1)*u*m,w=4<R||w>G&&w>H);P=I.x;X=I.y;var T=v;switch(v){case t.JoinType.BEVEL:1.05>R&&(T=
t.JoinType.MITER);break;case t.JoinType.ROUND:R<g&&(T=t.JoinType.MITER);break;case t.JoinType.MITER:R>x&&(T=t.JoinType.BEVEL)}switch(T){case t.JoinType.MITER:p(I.x,I.y,-B.x,-B.y,0,-1);p(-I.x,-I.y,-B.x,-B.y,0,1);if(V)break;y&&(w=k?0:aa,K=this.writeVertex(M,Q,P,X,F.x,F.y,I.x,I.y,0,-1,w),O=this.writeVertex(M,Q,P,X,F.x,F.y,-I.x,-I.y,0,1,w));break;case t.JoinType.BEVEL:Y=0>Y;var Z=void 0;Y?(T=K,K=O,O=T,Z=L,T=N):(Z=N,T=L);var ca=void 0,ja=void 0;w?(ca=Y?A(this.innerPrev,B):C(this.innerPrev,B),ja=Y?C(this.innerNext,
F):A(this.innerNext,F)):ca=ja=Y?l(this.inner,I):n(this.inner,I);R=Y?C(this.bevelStart,B):A(this.bevelStart,B);p(ca.x,ca.y,-B.x,-B.y,Z.x,Z.y);ca=p(R.x,R.y,-B.x,-B.y,T.x,T.y);if(V)break;V=Y?A(this.bevelEnd,F):C(this.bevelEnd,F);w?(w=this.writeVertex(M,Q,P,X,-B.x,-B.y,0,0,0,0,aa),K=this.writeVertex(M,Q,P,X,F.x,F.y,ja.x,ja.y,Z.x,Z.y,aa),O=this.writeVertex(M,Q,P,X,F.x,F.y,V.x,V.y,T.x,T.y,aa),this.writeTriangle(ca,w,O)):(y?(w=this.bevelMiddle,w.x=(R.x+V.x)/2,w.y=(R.y+V.y)/2,a(J,w,-B.x,-B.y),p(w.x,w.y,-B.x,
-B.y,J.x,J.y),a(J,w,F.x,F.y),K=this.writeVertex(M,Q,P,X,F.x,F.y,w.x,w.y,J.x,J.y,aa),O=this.writeVertex(M,Q,P,X,F.x,F.y,ja.x,ja.y,Z.x,Z.y,aa)):(w=K,K=O,O=w),p(V.x,V.y,F.x,F.y,T.x,T.y));Y&&(w=K,K=O,O=w);break;case t.JoinType.ROUND:{Y=0>Y;var U=void 0;Y?(T=K,K=O,O=T,T=L,U=N):(T=N,U=L);var da=Y?l(this.inner,I):n(this.inner,I);w?(ja=Y?A(this.innerPrev,B):C(this.innerPrev,B),Z=Y?C(this.innerNext,F):A(this.innerNext,F)):Z=ja=da;ca=Y?C(this.roundStart,B):A(this.roundStart,B);var fa=Y?A(this.roundEnd,F):C(this.roundEnd,
F);ja=p(ja.x,ja.y,-B.x,-B.y,T.x,T.y);ca=p(ca.x,ca.y,-B.x,-B.y,U.x,U.y);if(V)break;V=this.writeVertex(M,Q,P,X,-B.x,-B.y,0,0,0,0,aa);w||this.writeTriangle(K,O,V);da=l(this.outer,da);U=this.writeVertex(M,Q,P,X,F.x,F.y,fa.x,fa.y,U.x,U.y,aa);let ha,ka;if(fa=2<R){var ia=void 0;R!==Number.MAX_VALUE?(da.x/=R,da.y/=R,ia=B.x*da.x+B.y*da.y,ia=(R*(ia*ia-1)+1)/ia):ia=-1;ha=Y?C(this.startBreak,B):A(this.startBreak,B);ha.x+=B.x*ia;ha.y+=B.y*ia;ka=Y?A(this.endBreak,F):C(this.endBreak,F);ka.x+=F.x*ia;ka.y+=F.y*ia}a(J,
da,-B.x,-B.y);R=this.writeVertex(M,Q,P,X,-B.x,-B.y,da.x,da.y,J.x,J.y,aa);a(J,da,F.x,F.y);da=y?this.writeVertex(M,Q,P,X,F.x,F.y,da.x,da.y,J.x,J.y,aa):R;ia=V;const la=y?this.writeVertex(M,Q,P,X,F.x,F.y,0,0,0,0,aa):V;let ma=-1,oa=-1;fa&&(a(J,ha,-B.x,-B.y),ma=this.writeVertex(M,Q,P,X,-B.x,-B.y,ha.x,ha.y,J.x,J.y,aa),a(J,ka,F.x,F.y),oa=this.writeVertex(M,Q,P,X,F.x,F.y,ka.x,ka.y,J.x,J.y,aa));y?fa?(this.writeTriangle(ia,ca,ma),this.writeTriangle(ia,ma,R),this.writeTriangle(la,da,oa),this.writeTriangle(la,
oa,U)):(this.writeTriangle(ia,ca,R),this.writeTriangle(la,da,U)):fa?(this.writeTriangle(V,ca,ma),this.writeTriangle(V,ma,oa),this.writeTriangle(V,oa,U)):(this.writeTriangle(V,ca,R),this.writeTriangle(V,da,U));w?K=this.writeVertex(M,Q,P,X,F.x,F.y,Z.x,Z.y,T.x,T.y,aa):(K=y?this.writeVertex(M,Q,P,X,F.x,F.y,Z.x,Z.y,T.x,T.y,aa):ja,this.writeTriangle(K,la,U));O=U;Y&&(w=K,K=O,O=w)}}}}};return c}();q.LineTessellation=b;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/Logger","../../../../../../symbols/cim/cimAnalyzer","../../../../../../symbols/cim/utils","./WGLMeshTemplate"],function(q,t,D,E,C){const A=t.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");return function(n){function l(d){var a=n.call(this)||this;a._ongoingMaterialRequestMap=new Map;a._materialCache=new Map;a._dynamicPropertyMap=
new Map;a._cimLayer=d;return a}q._inheritsLoose(l,n);l.prototype.analyze=function(d,a,b,c,f){if(f&&0===f.length)return null;const h=f&&0<f.length,p=a.readLegacyFeature();a=a.getObjectId();const k=this._materialCache;var e=this._cimLayer.materialHash;if(!e)return A.error("A Dynamic mesh template must have a material hash value or function!"),Promise.reject(null);const m="function"===typeof e?e(p,b,c,a):e;if(k.has(m))return d=k.get(m),Promise.resolve(d);if(e=this._ongoingMaterialRequestMap.get(m))return e;
e=this._cimLayer;const r=D.analyzeCIMResource(e.cim,this._cimLayer.materialOverrides);r.mosaicHash=m;const {type:v,url:x}=e;a={cim:r,type:v,mosaicHash:m,url:x,size:null,dashTemplate:null,text:null,fontName:null,objectId:a,animatedSymbolProperties:null};switch(v){case "marker":a.size=E.evaluateValueOrFunction(e.size,p,b,c);a.animatedSymbolProperties=E.evaluateValueOrFunction(e.animatedSymbolProperties,p,b,c);break;case "line":a.dashTemplate=e.dashTemplate;break;case "text":a.text=E.evaluateValueOrFunction(e.text,
p,b,c),a.fontName=E.evaluateValueOrFunction(e.fontName,p,b,c)}d=d.getMosaicItem(a,f).then(g=>{h||(this._ongoingMaterialRequestMap.delete(m),k.set(m,g));return g}).catch(g=>{this._ongoingMaterialRequestMap.delete(m);A.error(".analyze()",g.message);return null});h||this._ongoingMaterialRequestMap.set(m,d);return d};return l}(C)})},"esri/symbols/cim/cimAnalyzer":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../core/lang ../../core/Logger ../../core/maybe ../../core/screenUtils ../../core/string ../../support/arcadeOnDemand ./CIMSymbolHelper ./enums ./SDFHelper ./utils ./effects/CIMEffectHelper ../../views/2d/arcade/callExpressionWithFeature ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/fontUtils ../../views/2d/engine/webgl/grouping".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c,f,h,p,k,e,m){function r(U){switch(U){case "Butt":return b.CapType.BUTT;case "Square":return b.CapType.SQUARE;default:return b.CapType.ROUND}}function v(U){switch(U){case "Bevel":return b.JoinType.BEVEL;case "Miter":return b.JoinType.MITER;default:return b.JoinType.ROUND}}function x(U){switch(U){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return ca.warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),
"center"}}function g(U){switch(U){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}}function u(U){let da="",fa="";U&&(U=U.toLowerCase(),U.includes("italic")?da="italic":U.includes("oblique")&&(da="oblique"),U.includes("bold")?fa="bold":U.includes("light")&&(fa="lighter"));return{style:da,weight:fa}}function y(U,da,fa,ia){let ea;U[da]?ea=U[da]:(ea={},U[da]=ea);ea[fa]=ia}function z(U){return(U=U.markerPlacement)&&U.angleToLine?b.Alignment.MAP:
b.Alignment.SCREEN}function w(){w=t._asyncToGenerator(function*(U,da,fa,ia,ea){ia=null!=ia?ia:[];if(!U)return ia;let ha;const ka={};if("CIMSymbolReference"===U.type){if(ha=U.symbol,U=U.primitiveOverrides){var la=[];for(const oa of U){var ma=oa.valueExpressionInfo;ma&&da?(ma=d.createRendererExpression(ma.expression,da.spatialReference,da.fields).then(pa=>{pa&&y(ka,oa.primitiveName,oa.propertyName,pa)}),la.push(ma)):null!=oa.value&&y(ka,oa.primitiveName,oa.propertyName,oa.value)}0<la.length&&(yield Promise.all(la))}}else return ca.error("Expect cim type to be 'CIMSymbolReference'"),
ia;la=[];T(ha,fa,la);0<la.length&&(yield Promise.all(la));switch(ha.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":B(ha,U,ka,da,ia,fa,ea)}return ia});return w.apply(this,arguments)}function B(U,da,fa,ia,ea,ha,ka){if(U){var la=U.symbolLayers;if(la){var ma=U.effects,oa=a.CIMSymbolHelper.getSize(U);if("CIMPointSymbol"===U.type&&"Map"===U.angleAlignment)var pa=b.Alignment.MAP;for(var ua=la.length;ua--;){var na=la[ua];if(!na||!1===na.enable)continue;let xa;ma&&ma.length&&(xa=
[...ma]);var ra=na.effects;ra&&ra.length&&(ma?xa.push(...ra):xa=[...ra]);ra=[];a.OverrideHelper.findEffectOverrides(xa,da,ra);ra=0<ra.length?Y(xa,ra,fa,ia):xa;var ta=[];a.OverrideHelper.findApplicableOverrides(na,da,ta);switch(na.type){case "CIMSolidFill":F(na,ra,fa,ta,ia,ea);break;case "CIMPictureFill":G(na,ra,fa,ta,ia,ha,ea);break;case "CIMHatchFill":H(na,ra,fa,ta,ia,ea);break;case "CIMGradientFill":{var sa=fa,qa=ia,wa=ea;const [Ca,Ha]=R(ta,na.primitiveName,ra,null,null);var va=l.numericHash(JSON.stringify(na)+
Ha).toString();wa.push({type:"fill",templateHash:va,materialHash:Ca?X(va,sa,ta,qa):va,cim:na,materialOverrides:null,colorLocked:na.colorLocked,effects:ra,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,applyRandomOffset:!1,sampleAlphaOnly:!1})}break;case "CIMSolidStroke":I(na,ra,fa,ta,ia,ea,"CIMPolygonSymbol"===U.type,oa);break;case "CIMPictureStroke":L(na,ra,fa,ta,ia,ea,"CIMPolygonSymbol"===U.type,oa);break;case "CIMGradientStroke":{sa=fa;qa=ia;wa=ea;va="CIMPolygonSymbol"===
U.type;var za=oa,ya=na.primitiveName,Ea=void 0!==na.width?na.width:4,Ba=r(na.capStyle),Aa=v(na.joinStyle),Da=na.miterLimit;const [Ca,Ha]=R(ta,ya,ra,null,null),Ga=l.numericHash(JSON.stringify(na)+Ha).toString();wa.push({type:"line",templateHash:Ga,materialHash:Ca?X(Ga,sa,ta,qa):Ga,cim:na,materialOverrides:null,isOutline:va,colorLocked:na.colorLocked,effects:ra,color:{r:128,g:128,b:128,a:1},width:M(ya,sa,"Width",qa,Ea),cap:M(ya,sa,"CapStyle",qa,Ba),join:M(ya,sa,"JoinStyle",qa,Aa),miterLimit:M(ya,sa,
"MiterLimit",qa,Da),referenceWidth:za,zOrder:ba(na.name),dashTemplate:null,scaleDash:!1,sampleAlphaOnly:!1})}break;case "CIMCharacterMarker":N(na,ra,fa,ta,ia,ea);break;case "CIMPictureMarker":if(N(na,ra,fa,ta,ia,ea))break;"CIMLineSymbol"===U.type&&(pa=z(na));J(na,ra,fa,ta,ia,ha,ea,pa,oa);break;case "CIMVectorMarker":if(N(na,ra,fa,ta,ia,ea))break;"CIMLineSymbol"===U.type&&(pa=z(na));sa=fa;qa=ia;wa=ea;va=ha;za=pa;ya=oa;Ea=ka;if(Aa=na.markerGraphics){Ba=0;na.scaleSymbolsProportionally&&(Da=na.frame)&&
(Ba=Da.ymax-Da.ymin);Da=V(na.markerPlacement,ta,sa,qa);for(const Ca of Aa)if(Ca&&(Aa=Ca.symbol))switch(Aa.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":O(na,ra,Da,null,Ca,ta,sa,qa,wa,va,za,ya,Ba,Ea);break;case "CIMTextSymbol":K(na,ra,Da,Ca,sa,ta,qa,wa,za,ya,Ba)}}break;default:ca.error("Cannot analyze CIM layer",na.type)}}}}}function F(U,da,fa,ia,ea,ha){const ka=U.primitiveName,la=f.fromCIMColor(U.color),[ma,oa]=R(ia,ka,da,null,null),pa=l.numericHash(JSON.stringify(U)+oa).toString();
ha.push({type:"fill",templateHash:pa,materialHash:ma?()=>pa:pa,cim:U,materialOverrides:null,colorLocked:U.colorLocked,color:M(ka,fa,"Color",ea,la,S),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:da,applyRandomOffset:!1,sampleAlphaOnly:!0})}function G(U,da,fa,ia,ea,ha,ka){const la=U.primitiveName,ma=U.tintColor?f.fromCIMColor(U.tintColor):{r:255,g:255,b:255,a:1},[oa,pa]=R(ia,la,da,null,null);ia=l.numericHash(JSON.stringify(U)+pa).toString();const ua=l.numericHash(`${U.url}${JSON.stringify(U.colorSubstitutions)}`).toString();
let na=f.getValue(U.scaleX);if("width"in U){const ra=U.width;let ta=1;ha=ha.getResource(U.url);A.isSome(ha)&&(ta=ha.width/ha.height);na/=U.height/ra*ta}ka.push({type:"fill",templateHash:ia,materialHash:oa?()=>ua:ua,cim:U,materialOverrides:null,colorLocked:U.colorLocked,effects:da,color:M(la,fa,"TintColor",ea,ma,S),height:M(la,fa,"Height",ea,U.height),scaleX:M(la,fa,"ScaleX",ea,na),angle:M(la,fa,"Rotation",ea,f.getValue(U.rotation)),offsetX:M(la,fa,"OffsetX",ea,f.getValue(U.offsetX)),offsetY:M(la,
fa,"OffsetY",ea,f.getValue(U.offsetY)),url:U.url,applyRandomOffset:!1,sampleAlphaOnly:!1})}function H(U,da,fa,ia,ea,ha){const ka=["Rotation","OffsetX","OffsetY"],la=ia.filter(ta=>ta.primitiveName!==U.primitiveName&&!ka.includes(ta.propertyName)),ma=U.primitiveName,[oa,pa]=R(ia,ma,da,null,null);ia=l.numericHash(JSON.stringify(U)+pa).toString();const ua=l.numericHash(`${U.separation}${JSON.stringify(U.lineSymbol)}`).toString();let na={r:255,g:255,b:255,a:1};if(U.lineSymbol){var ra;const ta=null==(ra=
U.lineSymbol)?void 0:ra.symbolLayers.find(sa=>"CIMSolidStroke"===sa.type);ta&&(na=f.fromCIMColor(ta.color))}ha.push({type:"fill",templateHash:ia,materialHash:oa?X(ua,fa,la,ea):ua,cim:U,materialOverrides:la,colorLocked:U.colorLocked,effects:da,color:na,height:M(ma,fa,"Separation",ea,U.separation),scaleX:1,angle:M(ma,fa,"Rotation",ea,f.getValue(U.rotation)),offsetX:M(ma,fa,"OffsetX",ea,f.getValue(U.offsetX)),offsetY:M(ma,fa,"OffsetY",ea,f.getValue(U.offsetY)),applyRandomOffset:!1,sampleAlphaOnly:!0})}
function I(U,da,fa,ia,ea,ha,ka,la){const ma=U.primitiveName,oa=f.fromCIMColor(U.color),pa=void 0!==U.width?U.width:4,ua=r(U.capStyle),na=v(U.joinStyle),ra=U.miterLimit,[ta,sa]=R(ia,ma,da,null,null),qa=l.numericHash(JSON.stringify(U)+sa).toString();let wa;if(da&&da instanceof Array&&0<da.length&&(ia=da[da.length-1],"CIMGeometricEffectDashes"===ia.type&&"NoConstraint"===ia.lineDashEnding&&null===ia.offsetAlongLine)){da=[...da];var va=da.pop();wa=va.dashTemplate;va=va.scaleDash}ha.push({type:"line",
templateHash:qa,materialHash:ta?()=>qa:qa,cim:U,materialOverrides:null,isOutline:ka,colorLocked:U.colorLocked,effects:da,color:M(ma,fa,"Color",ea,oa,S),width:M(ma,fa,"Width",ea,pa),cap:M(ma,fa,"CapStyle",ea,ua),join:M(ma,fa,"JoinStyle",ea,na),miterLimit:M(ma,fa,"MiterLimit",ea,ra),referenceWidth:la,zOrder:ba(U.name),dashTemplate:wa,scaleDash:va,sampleAlphaOnly:!0})}function L(U,da,fa,ia,ea,ha,ka,la){const ma=l.numericHash(`${U.url}${JSON.stringify(U.colorSubstitutions)}`).toString(),oa=U.primitiveName,
pa=f.fromCIMColor(U.tintColor),ua=void 0!==U.width?U.width:4,na=r(U.capStyle),ra=v(U.joinStyle),ta=U.miterLimit,[sa,qa]=R(ia,oa,da,null,null);ia=l.numericHash(JSON.stringify(U)+qa).toString();ha.push({type:"line",templateHash:ia,materialHash:sa?()=>ma:ma,cim:U,materialOverrides:null,isOutline:ka,colorLocked:U.colorLocked,effects:da,color:M(oa,fa,"TintColor",ea,pa,S),width:M(oa,fa,"Width",ea,ua),cap:M(oa,fa,"CapStyle",ea,na),join:M(oa,fa,"JoinStyle",ea,ra),miterLimit:M(oa,fa,"MiterLimit",ea,ta),referenceWidth:la,
zOrder:ba(U.name),dashTemplate:null,scaleDash:!1,url:U.url,sampleAlphaOnly:!1})}function N(U,da,fa,ia,ea,ha){const ka=U.markerPlacement;if(!ka||"CIMMarkerPlacementInsidePolygon"!==ka.type)return!1;var la=Math.abs(ka.stepX),ma=Math.abs(ka.stepY);if(0===la||0===ma)return!0;const oa=["Rotation","OffsetX","OffsetY"],pa=ia.filter(qa=>qa.primitiveName!==U.primitiveName&&!oa.includes(qa.propertyName)),ua="url"in U?U.url:null,[na,ra]=R(ia,ka.primitiveName,da,null,null);ia=l.numericHash(JSON.stringify(U)+
ra).toString();let ta=null;if("Random"===ka.gridType){var sa=n.px2pt(k.RANDOM_INSIDE_POLYGON_TEXTURE_SIZE);const qa=Math.max(Math.floor(sa/la),1),wa=Math.max(Math.floor(sa/ma),1);sa=ma*wa;ta=va=>va?va*wa:0;la=qa*la/sa}else ka.shiftOddRows?(sa=2*ma,ta=qa=>qa?2*qa:0,la=la/ma*.5):(sa=ma,ta=null,la/=ma);ma={r:255,g:255,b:255,a:1};"tintColor"in U&&(ma=f.fromCIMColor(U.tintColor));ha.push({type:"fill",templateHash:ia,materialHash:na?X(ia,fa,pa,ea):ia,cim:U,materialOverrides:pa,colorLocked:U.colorLocked,
effects:da,color:M(ka.primitiveName,fa,"TintColor",ea,ma,S),height:M(ka.primitiveName,fa,"StepY",ea,sa,ta),scaleX:la,angle:M(ka.primitiveName,fa,"GridAngle",ea,ka.gridAngle),offsetX:M(ka.primitiveName,fa,"OffsetX",ea,f.getValue(ka.offsetX)),offsetY:M(ka.primitiveName,fa,"OffsetY",ea,f.getValue(ka.offsetY)),url:ua,applyRandomOffset:"Random"===ka.gridType,sampleAlphaOnly:!ua});return!0}function J(U,da,fa,ia,ea,ha,ka,la,ma){var oa;const pa=U.primitiveName,ua=f.getValue(U.size);let na=f.getValue(U.scaleX);
const ra=f.getValue(U.rotation),ta=f.getValue(U.offsetX),sa=f.getValue(U.offsetY),qa=U.tintColor?f.fromCIMColor(U.tintColor):{r:255,g:255,b:255,a:1},wa=l.numericHash(`${U.url}${JSON.stringify(U.colorSubstitutions)}${JSON.stringify(U.animatedSymbolProperties)}`).toString(),va=V(U.markerPlacement,ia,fa,ea),za=P(U.animatedSymbolProperties,ia,fa,ea),[ya,Ea]=R(ia,pa,da,va,za);ia=l.numericHash(JSON.stringify(U)+Ea).toString();const Ba=null!=(oa=U.anchorPoint)?oa:{x:0,y:0};if("width"in U){oa=U.width;let Aa=
1;ha=ha.getResource(U.url);A.isSome(ha)&&(Aa=ha.width/ha.height);na/=ua/oa*Aa}ka.push({type:"marker",templateHash:ia,materialHash:U.animatedSymbolProperties&&!0===U.animatedSymbolProperties.randomizeStartTime?(Aa,Da,xa,Ca)=>{xa=m.getMaterialGroup(Ca);Aa=f.evaluateValueOrFunction(za,Aa,Da);return wa+`-MATERIALGROUP(${xa})`+`-ASP(${JSON.stringify(Aa)})`}:ya?(Aa,Da)=>{Aa=f.evaluateValueOrFunction(za,Aa,Da);return wa+`-ASP(${JSON.stringify(Aa)})`}:wa,cim:U,materialOverrides:null,colorLocked:U.colorLocked,
effects:da,scaleSymbolsProportionally:!1,alignment:la,size:M(pa,fa,"Size",ea,ua),scaleX:M(pa,fa,"ScaleX",ea,na),rotation:M(pa,fa,"Rotation",ea,ra),offsetX:M(pa,fa,"OffsetX",ea,ta),offsetY:M(pa,fa,"OffsetY",ea,sa),color:M(pa,fa,"TintColor",ea,qa,S),anchorPoint:{x:Ba.x,y:-Ba.y},isAbsoluteAnchorPoint:"Relative"!==U.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:U.rotateClockwise,referenceSize:ma,sizeRatio:1,markerPlacement:va,url:U.url,animatedSymbolProperties:za})}
function K(U,da,fa,ia,ea,ha,ka,la,ma,oa,pa){a.OverrideHelper.findApplicableOverrides(ia,ha,[]);var ua=ia.geometry;if("x"in ua&&"y"in ua){var na=ia.symbol;var ra=na.underline?"underline":na.strikethrough?"line-through":"none";var ta=u(na.fontStyleName),sa=e.getFontFamily(na.fontFamilyName);na.font={family:sa,decoration:ra,...ta};var qa=U.frame,wa=ua.x-.5*(qa.xmin+qa.xmax),va=ua.y-.5*(qa.ymin+qa.ymax),za=U.size/pa;pa=U.primitiveName;ua=f.getValue(na.height)*za;qa=f.getValue(na.angle);wa=f.getValue(U.offsetX)+
(f.getValue(na.offsetX)+wa)*za;va=f.getValue(U.offsetY)+(f.getValue(na.offsetY)+va)*za;var ya=f.fromCIMColor(a.CIMSymbolHelper.getFillColor(na)),Ea=f.fromCIMColor(a.CIMSymbolHelper.getStrokeColor(na)),Ba=a.CIMSymbolHelper.getStrokeWidth(na);Ba||(Ea=f.fromCIMColor(a.CIMSymbolHelper.getFillColor(na.haloSymbol)),Ba=na.haloSize*za);var [Aa,Da]=R(ha,pa,da,fa,null);ha=JSON.stringify(U.effects)+Number(U.colorLocked)+JSON.stringify(U.anchorPoint)+U.anchorPointUnits+JSON.stringify(U.markerPlacement);ha=l.numericHash(JSON.stringify(ia)+
ha+Da).toString();var xa=M(ia.primitiveName,ea,"TextString",ka,ia.textString,f._adjustTextCase,na.textCase);if(null!=xa){({fontStyleName:ia}=na);var Ca=sa+(ia?"-"+ia.toLowerCase():"-regular");"string"===typeof xa&&xa.includes("[")&&na.fieldMap&&(xa=f.createLabelOverrideFunction(na.fieldMap,xa,na.textCase));la.push({type:"text",templateHash:ha,materialHash:Aa||"function"===typeof xa||xa.match(/\[(.*?)\]/)?(Ha,Ga,Ia)=>Ca+"-"+f.evaluateValueOrFunction(xa,Ha,Ga,Ia):Ca+"-"+l.numericHash(xa),cim:na,materialOverrides:null,
colorLocked:U.colorLocked,effects:da,alignment:ma,anchorPoint:{x:U.anchorPoint?U.anchorPoint.x:0,y:U.anchorPoint?U.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==U.anchorPointUnits,fontName:Ca,decoration:ra,weight:M(pa,ea,"Weight",ka,ta.weight),style:M(pa,ea,"Size",ka,ta.style),size:M(pa,ea,"Size",ka,ua),angle:M(pa,ea,"Rotation",ka,qa),offsetX:M(pa,ea,"OffsetX",ka,wa),offsetY:M(pa,ea,"OffsetY",ka,va),horizontalAlignment:x(na.horizontalAlignment),verticalAlignment:g(na.verticalAlignment),text:xa,
color:ya,outlineColor:Ea,outlineSize:Ba,referenceSize:oa,sizeRatio:1,markerPlacement:fa})}}}function O(U,da,fa,ia,ea,ha,ka,la,ma,oa,pa,ua,na,ra){var ta=ea.symbol;const sa=ta.symbolLayers;if(sa)if(ra)aa(U,da,fa,ia,ea,ka,ha,la,ma,oa,pa,ua,na);else if(ra=sa.length,sa&&2===sa.length&&sa[0].enable&&sa[1].enable&&"CIMSolidStroke"===sa[0].type&&"CIMSolidFill"===sa[1].type&&!sa[0].effects&&!sa[1].effects)W(U,da,fa,ia,ea,sa,ha,ka,la,ma,pa,ua,na);else if(ta=h.CIMEffectHelper.applyEffects(ta.effects,ea.geometry,
oa.geometryEngine))for(;ra--;){var qa=sa[ra];if(qa&&!1!==qa.enable)switch(qa.type){case "CIMSolidFill":case "CIMSolidStroke":{var wa,va=h.CIMEffectHelper.applyEffects(qa.effects,ta,oa.geometryEngine),za=c.getExtent(va);if(!za)continue;const [Ba,Aa,Da]=c.getSDFMetrics(za,U.frame,U.size,U.anchorPoint,"Relative"!==U.anchorPointUnits);var ya="CIMSolidFill"===qa.type;va={type:"sdf",geom:va,asFill:ya};var Ea=U.primitiveName;za=null!=(wa=f.getValue(U.size))?wa:10;const xa=f.getValue(U.rotation),Ca=f.getValue(U.offsetX),
Ha=f.getValue(U.offsetY),Ga=qa.path,Ia=qa.primitiveName,Ka=ya?f.fromCIMColor(a.CIMSymbolHelper.getFillColor(qa)):f.fromCIMColor(a.CIMSymbolHelper.getStrokeColor(qa)),La=ya?{r:0,g:0,b:0,a:0}:f.fromCIMColor(a.CIMSymbolHelper.getStrokeColor(qa)),Fa=a.CIMSymbolHelper.getStrokeWidth(qa);if(!ya&&!Fa)break;ya=!1;let Ma="";for(const Ja of ha)if(Ja.primitiveName===Ia||Ja.primitiveName===Ea)void 0!==Ja.value?Ma+=`-${Ja.primitiveName}-${Ja.propertyName}-${JSON.stringify(Ja.value)}`:Ja.valueExpressionInfo&&(ya=
!0);A.isSome(da)&&"function"===typeof da&&(ya=!0);Ea=JSON.stringify({...U,markerGraphics:null});const Na=l.numericHash(JSON.stringify(va)+Ga).toString();qa={type:"marker",templateHash:l.numericHash(JSON.stringify(ea)+JSON.stringify(qa)+Ea+Ma).toString(),materialHash:ya?()=>Na:Na,cim:va,materialOverrides:null,colorLocked:U.colorLocked,effects:da,scaleSymbolsProportionally:U.scaleSymbolsProportionally,alignment:pa,anchorPoint:{x:Aa,y:Da},isAbsoluteAnchorPoint:!1,size:M(U.primitiveName,ka,"Size",la,
za),rotation:M(U.primitiveName,ka,"Rotation",la,xa),offsetX:M(U.primitiveName,ka,"OffsetX",la,Ca),offsetY:M(U.primitiveName,ka,"OffsetY",la,Ha),scaleX:1,frameHeight:na,rotateClockwise:U.rotateClockwise,referenceSize:ua,sizeRatio:Ba,color:M(Ia,ka,"Color",la,Ka,S),outlineColor:M(Ia,ka,"Color",la,La,S),outlineWidth:M(Ia,ka,"Width",la,Fa),markerPlacement:fa,animatedSymbolProperties:ia,path:Ga};ma.push(qa);break}default:aa(U,da,fa,ia,ea,ka,ha,la,ma,oa,pa,ua,na)}}}function W(U,da,fa,ia,ea,ha,ka,la,ma,oa,
pa,ua,na){var ra=ea.geometry;const ta=ha[0];ha=ha[1];var sa=c.getExtent(ra);if(sa){var [qa,wa,va]=c.getSDFMetrics(sa,U.frame,U.size,U.anchorPoint,"Relative"!==U.anchorPointUnits);ra={type:"sdf",geom:ra,asFill:!0};var za=U.primitiveName;sa=f.getValue(U.size);var ya=f.getValue(U.rotation),Ea=f.getValue(U.offsetX),Ba=f.getValue(U.offsetY),Aa=ha.path,Da=ha.primitiveName,xa=ta.primitiveName,Ca=f.fromCIMColor(a.CIMSymbolHelper.getFillColor(ha)),Ha=f.fromCIMColor(a.CIMSymbolHelper.getStrokeColor(ta)),Ga=
a.CIMSymbolHelper.getStrokeWidth(ta),Ia=!1,Ka="";for(const Fa of ka)if(Fa.primitiveName===Da||Fa.primitiveName===xa||Fa.primitiveName===za)void 0!==Fa.value?Ka+=`-${Fa.primitiveName}-${Fa.propertyName}-${JSON.stringify(Fa.value)}`:Fa.valueExpressionInfo&&(Ia=!0);ka=JSON.stringify({...U,markerGraphics:null});var La=l.numericHash(JSON.stringify(ra)+Aa).toString();U={type:"marker",templateHash:l.numericHash(JSON.stringify(ea)+JSON.stringify(ha)+JSON.stringify(ta)+ka+Ka).toString(),materialHash:Ia?()=>
La:La,cim:ra,materialOverrides:null,colorLocked:U.colorLocked,effects:da,scaleSymbolsProportionally:U.scaleSymbolsProportionally,alignment:pa,anchorPoint:{x:wa,y:va},isAbsoluteAnchorPoint:!1,size:M(U.primitiveName,la,"Size",ma,sa),rotation:M(U.primitiveName,la,"Rotation",ma,ya),offsetX:M(U.primitiveName,la,"OffsetX",ma,Ea),offsetY:M(U.primitiveName,la,"OffsetY",ma,Ba),scaleX:1,frameHeight:na,rotateClockwise:U.rotateClockwise,referenceSize:ua,sizeRatio:qa,color:M(Da,la,"Color",ma,Ca,S),outlineColor:M(xa,
la,"Color",ma,Ha,S),outlineWidth:M(xa,la,"Width",ma,Ga),markerPlacement:fa,path:Aa,animatedSymbolProperties:ia};oa.push(U)}}function aa(U,da,fa,ia,ea,ha,ka,la,ma,oa,pa,ua,na){ea={type:U.type,enable:!0,name:U.name,colorLocked:U.colorLocked,primitiveName:U.primitiveName,anchorPoint:U.anchorPoint,anchorPointUnits:U.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:U.rotateClockwise,rotation:0,size:U.size,billboardMode3D:U.billboardMode3D,depth3D:U.depth3D,frame:U.frame,markerGraphics:[ea],scaleSymbolsProportionally:U.scaleSymbolsProportionally,
respectFrame:U.respectFrame,clippingPath:U.clippingPath};let ra=[];const ta=["Rotation","OffsetX","OffsetY"];ra=ka.filter(Ba=>Ba.primitiveName!==U.primitiveName||!ta.includes(Ba.propertyName));var sa="";for(var qa of ka)void 0!==qa.value&&(sa+=`-${qa.primitiveName}-${qa.propertyName}-${JSON.stringify(qa.value)}`);const [wa,va,za]=a.CIMSymbolHelper.getTextureAnchor(ea,oa);ka=U.primitiveName;oa=f.getValue(U.rotation);qa=f.getValue(U.offsetX);const ya=f.getValue(U.offsetY);sa=l.numericHash(JSON.stringify(ea)+
sa).toString();const Ea=0<ra.length||A.isSome(da)&&"function"===typeof da;da={type:"marker",templateHash:sa,materialHash:Ea?X(sa,ha,ra,la):sa,cim:ea,materialOverrides:ra,colorLocked:U.colorLocked,effects:da,scaleSymbolsProportionally:U.scaleSymbolsProportionally,alignment:pa,anchorPoint:{x:wa,y:va},isAbsoluteAnchorPoint:!1,size:U.size,rotation:M(ka,ha,"Rotation",la,oa),offsetX:M(ka,ha,"OffsetX",la,qa),offsetY:M(ka,ha,"OffsetY",la,ya),color:{r:255,g:255,b:255,a:1},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,
scaleX:1,frameHeight:na,rotateClockwise:U.rotateClockwise,referenceSize:ua,sizeRatio:za/n.pt2px(U.size),markerPlacement:fa,animatedSymbolProperties:ia};ma.push(da)}function ba(U){return U&&0===U.indexOf("Level_")&&(U=parseInt(U.substr(6),10),!isNaN(U))?U:0}function S(U){if(!U||0===U.length)return null;U=(new D(U)).toRgba();return{r:U[0],g:U[1],b:U[2],a:U[3]}}function M(U,da,fa,ia,ea,ha,ka){if(U=da[U]){const la=U[fa];if("string"===typeof la||"number"===typeof la||la instanceof Array)return ha?ha.call(null,
la,ka):la;if(null!=la&&la instanceof d.ArcadeExpression)return(ma,oa,pa)=>{ma=p(la,ma,{$view:pa},ia.geometryType,oa);null!==ma&&ha&&(ma=ha.call(null,ma,ka));return null!==ma?ma:ea}}return ea}function Q(U){return U?U.charAt(0).toLowerCase()+U.substr(1):U}function Y(U,da,fa,ia){for(const ea of da)if(ea.valueExpressionInfo){const ha=fa[ea.primitiveName]&&fa[ea.primitiveName][ea.propertyName];ha instanceof d.ArcadeExpression&&(ea.fn=(ka,la,ma)=>p(ha,ka,{$view:ma},ia.geometryType,la))}return(ea,ha,ka)=>
{for(var la of da)la.fn&&(la.value=la.fn(ea,ha,ka));ea=[];for(let oa of U){var ma;if(ha=null==(ma=oa)?void 0:ma.primitiveName){ka=!1;for(const pa of da)pa.primitiveName===ha&&(la=Q(pa.propertyName),null!=pa.value&&pa.value!==oa[la]&&(ka||(oa=E.clone(oa),ka=!0),oa[la]=pa.value))}ea.push(oa)}return ea}}function V(U,da,fa,ia){const ea=[];a.OverrideHelper.findApplicableOverrides(U,da,ea);if(0===ea.length)return U;for(const ha of ea)if(ha.valueExpressionInfo){const ka=fa[ha.primitiveName]&&fa[ha.primitiveName][ha.propertyName];
ka instanceof d.ArcadeExpression&&(ha.fn=(la,ma,oa)=>p(ka,la,{$view:oa},ia.geometryType,ma))}return(ha,ka,la)=>{for(const ma of ea)ma.fn&&(ma.value=ma.fn(ha,ka,la));ha=E.clone(U);ka=U.primitiveName;for(const ma of ea)ma.primitiveName===ka&&(la=Q(ma.propertyName),null!=ma.value&&ma.value!==ha[la]&&(ha[la]=ma.value));return ha}}function P(U,da,fa,ia){const ea=[];a.OverrideHelper.findApplicableOverrides(U,da,ea);if(0===ea.length)return U;for(const ha of ea)if(ha.valueExpressionInfo){const ka=fa[ha.primitiveName]&&
fa[ha.primitiveName][ha.propertyName];ka instanceof d.ArcadeExpression&&(ha.fn=(la,ma,oa)=>p(ka,la,{$view:oa},ia.geometryType,ma))}return(ha,ka,la)=>{for(const ma of ea)ma.fn&&(ma.value=ma.fn(ha,ka,la));ha=E.clone(U);ka=U.primitiveName;for(const ma of ea)ma.primitiveName===ka&&(la=Q(ma.propertyName),null!=ma.value&&ma.value!==ha[la]&&(ha[la]=ma.value));return ha}}function X(U,da,fa,ia){for(const ea of fa)if(ea.valueExpressionInfo){const ha=da[ea.primitiveName]&&da[ea.primitiveName][ea.propertyName];
ha instanceof d.ArcadeExpression&&(ea.fn=(ka,la,ma)=>p(ha,ka,{$view:ma},ia.geometryType,la))}return(ea,ha,ka)=>{for(const la of fa)la.fn&&(la.value=la.fn(ea,ha,ka));return l.numericHash(U+a.OverrideHelper.buildOverrideKey(fa)).toString()}}function R(U,da,fa,ia,ea){let ha=!1,ka="";for(const la of U)la.primitiveName===da&&(void 0!==la.value?ka+=`-${la.primitiveName}-${la.propertyName}-${JSON.stringify(la.value)}`:la.valueExpressionInfo&&(ha=!0));A.isSome(fa)&&"function"===typeof fa&&(ha=!0);A.isSome(ia)&&
"function"===typeof ia&&(ha=!0);A.isSome(ea)&&"function"===typeof ea&&(ha=!0);return[ha,ka]}function T(U,da,fa){if(U&&da)switch(U.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(U=U.symbolLayers)for(const ia of U)switch(Z(ia,da,fa),ia.type){case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMCharacterMarker":case "CIMPictureMarker":"url"in ia&&ia.url&&fa.push(da.fetchResource(ia.url,null));break;case "CIMVectorMarker":if(U=
ia.markerGraphics)for(const ea of U)ea&&(U=ea.symbol)&&T(U,da,fa)}}}function Z(U,da,fa){U.effects&&!A.isSome(da.geometryEngine)&&(ja?fa.push(ja):f.isGeometryEngineRequired(U.effects)&&(ja=f.importGeometryEngine(),fa.push(ja),ja.then(ia=>da.geometryEngine=ia)))}const ca=C.getLogger("esri.symbols.cim.cimAnalyzer");let ja;q.analyzeCIMResource=function(U,da){if(!da||0===da.length)return U;U=JSON.parse(JSON.stringify(U));a.OverrideHelper.applyOverrides(U,da);return U};q.analyzeCIMSymbol=function(U,da,
fa,ia,ea){return w.apply(this,arguments)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/arcade/callExpressionWithFeature":function(){define(["../../../core/Error","../../../core/Logger","../../../geometry/support/quantizationUtils"],function(q,t,D){function E(A){const n={};switch(A){case "esriGeometryPoint":return(l,d,a,b)=>D.unquantizePoint(d,n,l,a,b);case "esriGeometryPolygon":return(l,d,a,b)=>D.unquantizePolygon(d,n,l,a,b);case "esriGeometryPolyline":return(l,
d,a,b)=>D.unquantizePolyline(d,n,l,a,b);case "esriGeometryMultipoint":return(l,d,a,b)=>D.unquantizeMultipoint(d,n,l,a,b);default:return t.getLogger("esri.views.2d.support.arcadeOnDemand").error(new q("mapview-arcade",`Unable to handle geometryType: ${A}`)),l=>l}}const C=new Map;return function(A,n,l,d,a){if(A.referencesGeometry()&&a){{const {transform:b,hasZ:c,hasM:f}=a;C.has(d)||C.set(d,E(d));d=C.get(d)(n.geometry,b,c,f);n={...n,geometry:d}}}n=A.repurposeFeature(n);try{return A.evaluate({...l,$feature:n})}catch(b){return t.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",
b),null}}})},"esri/geometry/support/quantizationUtils":function(){define(["exports","../../core/maybe","./jsonUtils"],function(q,t,D){function E({scale:B,translate:F},G){return Math.round((G-F[0])/B[0])}function C({scale:B,translate:F},G){return Math.round((F[1]-G)/B[1])}function A(B,F,G){const H=[];let I,L,N,J;for(let K=0;K<G.length;K++){const O=G[K];if(0<K){if(N=E(B,O[0]),J=C(B,O[1]),N!==I||J!==L)H.push(F(O,N-I,J-L)),I=N,L=J}else I=E(B,O[0]),L=C(B,O[1]),H.push(F(O,I,L))}return 0<H.length?H:null}
function n(B,F,G,H){return A(B,G?H?w:z:H?z:y,F)}function l(B,F,G,H){const I=[];G=G?H?w:z:H?z:y;for(H=0;H<F.length;H++){const L=A(B,G,F[H]);L&&3<=L.length&&I.push(L)}return I.length?I:null}function d(B,F,G,H){const I=[];G=G?H?w:z:H?z:y;for(H=0;H<F.length;H++){const L=A(B,G,F[H]);L&&2<=L.length&&I.push(L)}return I.length?I:null}function a({scale:B,translate:F},G){return G*B[0]+F[0]}function b({scale:B,translate:F},G){return F[1]-G*B[1]}function c(B,F,G){const H=Array(G.length);if(!G.length)return H;
const [I,L]=B.scale;let N=a(B,G[0][0]);B=b(B,G[0][1]);H[0]=F(G[0],N,B);for(let J=1;J<G.length;J++){const K=G[J];N+=K[0]*I;B-=K[1]*L;H[J]=F(K,N,B)}return H}function f(B,F,G){const H=Array(G.length);for(let I=0;I<G.length;I++)H[I]=c(B,F,G[I]);return H}function h(B,F,G,H){return c(B,G?H?w:z:H?z:y,F)}function p(B,F,G,H){return f(B,G?H?w:z:H?z:y,F)}function k(B,F,G,H){return f(B,G?H?w:z:H?z:y,F)}function e(B,F,G){let [H,I]=G[0],L=Math.min(H,F[0]),N=Math.min(I,F[1]),J=Math.max(H,F[2]);F=Math.max(I,F[3]);
for(let K=1;K<G.length;K++){const [O,W]=G[K];H+=O;I+=W;0>O&&(L=Math.min(L,H));0<O&&(J=Math.max(J,H));0>W?N=Math.min(N,I):0<W&&(F=Math.max(F,I))}B[0]=L;B[1]=N;B[2]=J;B[3]=F;return B}function m(B,F){if(!F.length)return null;B[0]=B[1]=Number.POSITIVE_INFINITY;B[2]=B[3]=Number.NEGATIVE_INFINITY;for(let G=0;G<F.length;G++)e(B,B,F[G]);return B}function r(B,F,G,H,I){F.xmin=E(B,G.xmin);F.ymin=C(B,G.ymin);F.xmax=E(B,G.xmax);F.ymax=C(B,G.ymax);F!==G&&(H&&(F.zmin=G.zmin,F.zmax=G.zmax),I&&(F.mmin=G.mmin,F.mmax=
G.mmax));return F}function v(B,F,G,H,I){F.points=n(B,G.points,H,I);return F}function x(B,F,G,H,I){F.x=E(B,G.x);F.y=C(B,G.y);F!==G&&(H&&(F.z=G.z),I&&(F.m=G.m));return F}function g(B,F,G,H,I){B=l(B,G.rings,H,I);if(!B)return null;F.rings=B;return F}function u(B,F,G,H,I){B=d(B,G.paths,H,I);if(!B)return null;F.paths=B;return F}const y=(B,F,G)=>[F,G],z=(B,F,G)=>[F,G,B[2]],w=(B,F,G)=>[F,G,B[2],B[3]];q.equals=function(B,F){if(B===F||null==B&&null==F)return!0;if(null==B||null==F)return!1;let G,H,I,L;B&&"upperLeft"===
B.originPosition?(G=B.translate[0],H=B.translate[1],B=B.scale[0]):(G=t.isSome(B.extent)?B.extent.xmin:0,H=t.isSome(B.extent)?B.extent.ymax:0,B=B.tolerance);F&&"upperLeft"===F.originPosition?(I=F.translate[0],L=F.translate[1],F=F.scale[0]):(I=t.isSome(F.extent)?F.extent.xmin:0,L=t.isSome(F.extent)?F.extent.ymax:0,F=F.tolerance);return G===I&&H===L&&B===F};q.getQuantizedBoundsCoordsArray=e;q.getQuantizedBoundsCoordsArrayArray=m;q.getQuantizedBoundsPaths=function(B){return m([0,0,0,0],B)};q.getQuantizedBoundsPoints=
function(B){const F=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return e(F,F,B)};q.getQuantizedBoundsRings=function(B){return m([0,0,0,0],B)};q.quantizeBounds=function(B,F,G){F[0]=E(B,G[0]);F[3]=C(B,G[1]);F[2]=E(B,G[2]);F[1]=C(B,G[3]);return F};q.quantizeExtent=r;q.quantizeGeometry=function(B,F){return B&&F?D.isPoint(F)?x(B,{},F,!1,!1):D.isPolyline(F)?u(B,{},F,!1,!1):D.isPolygon(F)?g(B,{},F,!1,!1):D.isMultipoint(F)?v(B,{},F,!1,!1):D.isExtent(F)?
r(B,{},F,!1,!1):null:null};q.quantizeMultipoint=v;q.quantizePaths=d;q.quantizePoint=x;q.quantizePoints=n;q.quantizePolygon=g;q.quantizePolyline=u;q.quantizeRings=l;q.quantizeX=E;q.quantizeY=C;q.toQuantizationTransform=function(B){return B?{originPosition:"upper-left"===B.originPosition?"upperLeft":"lower-left"===B.originPosition?"lowerLeft":B.originPosition,scale:B.tolerance?[B.tolerance,B.tolerance]:[1,1],translate:t.isSome(B.extent)?[B.extent.xmin,B.extent.ymax]:[0,0]}:null};q.unquantizeBounds=
function(B,F,G){return G?(F[0]=a(B,G[0]),F[1]=b(B,G[3]),F[2]=a(B,G[2]),F[3]=b(B,G[1]),F):[a(B,F[0]),b(B,F[3]),a(B,F[2]),b(B,F[1])]};q.unquantizeCoordsArray=c;q.unquantizeCoordsArrayArray=f;q.unquantizeExtent=function(B,F,G,H,I){F.xmin=a(B,G.xmin);F.ymin=b(B,G.ymin);F.xmax=a(B,G.xmax);F.ymax=b(B,G.ymax);F!==G&&(H&&(F.zmin=G.zmin,F.zmax=G.zmax),I&&(F.mmin=G.mmin,F.mmax=G.mmax));return F};q.unquantizeMultipoint=function(B,F,G,H,I){t.isSome(G)&&(F.points=h(B,G.points,H,I));return F};q.unquantizePaths=
p;q.unquantizePoint=function(B,F,G,H,I){if(t.isNone(G))return F;F.x=a(B,G.x);F.y=b(B,G.y);F!==G&&(H&&(F.z=G.z),I&&(F.m=G.m));return F};q.unquantizePoints=h;q.unquantizePolygon=function(B,F,G,H,I){t.isSome(G)&&(F.rings=k(B,G.rings,H,I));return F};q.unquantizePolyline=function(B,F,G,H,I){t.isSome(G)&&(F.paths=p(B,G.paths,H,I));return F};q.unquantizeRings=k;q.unquantizeX=a;q.unquantizeY=b;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b){return function(c){function f(h,p,k){var e=c.call(this,h)||this;e._minMaxZoom=A.i1616to32(Math.round(p*C.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(k*C.MIN_MAX_ZOOM_PRECISION_FACTOR));e._cimLineLayer=h;let m=0;l.isFunction(h.width)||(m=.5*D.pt2px(h.width));e._dynamicPropertyMap.set("_halfWidth",(x,g,u)=>l.isFunction(h.width)?.5*D.pt2px(h.width(x,g,u)):m);l.isFunction(h.cap)?e._dynamicPropertyMap.set("_capType",h.cap):e._capType=h.cap;l.isFunction(h.join)?e._dynamicPropertyMap.set("_joinType",
h.join):e._joinType=h.join;const r=h.color;l.isFunction(r)?e._dynamicPropertyMap.set("_fillColor",(x,g,u)=>E.premultiplyAlphaRGBA(r(x,g,u))):e._fillColor=r&&E.premultiplyAlphaRGBA(r)||0;const v=h.miterLimit;l.isFunction(v)?e._dynamicPropertyMap.set("_miterLimitCosine",(x,g,u)=>l.getLimitCosine(v(x,g,u))):e._miterLimitCosine=l.getLimitCosine(v);t.isSome(h.effects)&&(p=h.effects,l.isFunction(p)?e._dynamicPropertyMap.set("_effects",p):e._effects=p);e._scaleFactor=h.scaleFactor||1;e._isDashed=null!=h.dashTemplate;
e.tessellationProperties._bitset=(h.colorLocked?C.BITSET_GENERIC_LOCK_COLOR:0)|(h.scaleDash?C.BITSET_LINE_SCALE_DASH:0)|(h.sampleAlphaOnly?C.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);e._materialKey=h.materialKey;e._initializeTessellator(!0);return e}q._inheritsLoose(f,c);f.fromCIMLine=function(h,p){const [k,e]=l.getMinMaxZoom(h.scaleInfo,p);return new f(h,k,e)};f.prototype.bindFeature=function(h,p,k){const e=h.readLegacyFeature();this._dynamicPropertyMap.forEach((r,v)=>{this[v]=r(e,p,k)});this._halfWidth*=
this._scaleFactor;h=this._materialCache;var m=this._cimLineLayer.materialHash;m=m(e,p,k);m=h.get(m);h=null;m&&b.ok(m.spriteMosaicItem)&&(h=m.spriteMosaicItem);if(h){this._hasPattern=!0;const {rect:r,width:v,height:x}=h;m=r.x+C.SPRITE_PADDING;const g=r.y+C.SPRITE_PADDING,u=m+v,y=g+x;this.tessellationProperties._tl=A.i1616to32(m,g);this.tessellationProperties._br=A.i1616to32(u,y)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=
this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties.offset=0;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;m=n.LineMaterialKey.load(this._materialKey);h&&(m.sdf=h.sdf,m.pattern=!0,m.textureBinding=h.textureBinding);this._materialKey=m.data};return f}(d(a))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c,f,h,p,k){const e=n.create(),m=A.create(),r=D.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate");return function(v){function x(g,u,y){var z=v.call(this,g)||this;z._cimMarkerLayer=g;z._minMaxZoom=b.i1616to32(Math.round(u*a.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(y*a.MIN_MAX_ZOOM_PRECISION_FACTOR));const w=g.color;f.isFunction(w)?z._dynamicPropertyMap.set("_fillColor",(L,N,J)=>d.premultiplyAlphaRGBA(w(L,N,J))):z._fillColor=d.premultiplyAlphaRGBA(w);const B=
g.outlineColor;f.isFunction(B)?z._dynamicPropertyMap.set("_outlineColor",(L,N,J)=>d.premultiplyAlphaRGBA(B(L,N,J))):z._outlineColor=d.premultiplyAlphaRGBA(B);const F=g.size;f.isFunction(F)?z._dynamicPropertyMap.set("_size",(L,N,J)=>C.pt2px(F(L,N,J))):z._size=C.pt2px(F)||0;u=g.scaleX;f.isFunction(u)?z._dynamicPropertyMap.set("_scaleX",u):z._scaleX=u||1;const G=g.offsetX;f.isFunction(G)?z._dynamicPropertyMap.set("xOffset",(L,N,J)=>C.pt2px(G(L,N,J))):z.xOffset=C.pt2px(G)||0;const H=g.offsetY;f.isFunction(H)?
z._dynamicPropertyMap.set("yOffset",(L,N,J)=>C.pt2px(H(L,N,J))):z.yOffset=C.pt2px(H)||0;const I=g.outlineWidth;f.isFunction(I)?z._dynamicPropertyMap.set("_outlineWidth",(L,N,J)=>C.pt2px(I(L,N,J))):z._outlineWidth=C.pt2px(I)||0;u=g.rotation;f.isFunction(u)?z._dynamicPropertyMap.set("_angle",u):z._angle=u||0;E.isSome(g.effects)&&(u=g.effects,f.isFunction(u)?z._dynamicPropertyMap.set("_effects",u):z._effects=u);E.isSome(g.markerPlacement)&&(u=g.markerPlacement,f.isFunction(u)?z._dynamicPropertyMap.set("_markerPlacement",
u):z._markerPlacement=u);z._scaleFactor=E.unwrapOr(g.scaleFactor,1);z._bitSet=(g.alignment===l.Alignment.MAP?1:0)|(g.colorLocked?1:0)<<1|(g.scaleSymbolsProportionally?1:0)<<3;z._materialKey=g.materialKey;return z}q._inheritsLoose(x,v);x.fromCIMMarker=function(g,u){const [y,z]=f.getMinMaxZoom(g.scaleInfo,u);return new x(g,y,z)};x.prototype.bindFeature=function(g,u,y){const z=g.readLegacyFeature();g=g.getObjectId();this._dynamicPropertyMap.forEach((aa,ba)=>{this[ba]=aa(z,u,y)});var w=this._cimMarkerLayer.materialHash;
g="function"===typeof w?w(z,u,y,g):w;if((g=this._materialCache.get(g))&&k.ok(g.spriteMosaicItem)&&g.spriteMosaicItem){g=g.spriteMosaicItem;w=this._cimMarkerLayer.sizeRatio;var B=g.width/g.height*this._scaleX,F=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,G=this._size,H=G*B,I=this.xOffset,L=this.yOffset;this.xOffset*=this._scaleFactor;this.yOffset*=this._scaleFactor;var N=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/C.pt2px(this._cimMarkerLayer.frameHeight):
1,J=this._outlineWidth*N,K=C.pt2px(this._cimMarkerLayer.referenceSize),O=N=0,W=this._cimMarkerLayer.anchorPoint;W&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(N=-W.x/(this._size*B),O=W.y/this._size):(N=W.x,O=W.y));this._sizeOutlineWidth=b.i8888to32(Math.round(Math.min(Math.sqrt(128*H),255)),Math.round(Math.min(Math.sqrt(128*G),255)),Math.round(Math.min(Math.sqrt(128*J),255)),Math.round(Math.min(Math.sqrt(128*K),255)));this.angle=F;this._bitestAndDistRatio=b.i1616to32(this._bitSet,Math.round(64*
w));B=g.rect.x+a.SPRITE_PADDING;F=g.rect.y+a.SPRITE_PADDING;J=B+g.width;K=F+g.height;this._texUpperLeft=b.i1616to32(B,F);this._texUpperRight=b.i1616to32(J,F);this._texBottomLeft=b.i1616to32(B,K);this._texBottomRight=b.i1616to32(J,K);B=c.MarkerMaterialKey.load(this._materialKey);B.sdf=g.sdf;B.pattern=!0;B.textureBinding=g.textureBinding;this._materialKey=B.data;this._anchorX=.5-(.5+N)*g.width/g.width;this._anchorY=.5-(.5+O)*g.height/g.height;H=H*w*this._scaleFactor;G=G*w*this._scaleFactor;H*=g.rect.width/
g.width;G*=g.rect.height/g.height;this._computedWidth=H;this._computedHeight=G;this._applyTransformation(m,e);this.xOffset=I;this.yOffset=L}else r.error(new t("mapview-cim","Encountered an error when binding feature"))};return x}(h(p))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLDynamicMeshTemplate ../../../../layers/features/textUtils".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c,f){return function(h){function p(e,m,r){var v=h.call(this,e)||this;v._horizontalAlignment="center";v._verticalAlignment="middle";v._textToGlyphs=new Map;v._minMaxZoom=l.i1616to32(Math.round(m*n.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(r*n.MIN_MAX_ZOOM_PRECISION_FACTOR));m=e.scaleFactor||1;v._cimTextLayer=e;const x=e.color;a.isFunction(x)?v._dynamicPropertyMap.set("_color",(w,B,F)=>A.premultiplyAlphaRGBA(x(w,B,F))):v._color=A.premultiplyAlphaRGBA(x);const g=e.outlineColor;
a.isFunction(g)?v._dynamicPropertyMap.set("_haloColor",(w,B,F)=>A.premultiplyAlphaRGBA(g(w,B,F))):v._haloColor=A.premultiplyAlphaRGBA(g);let u;a.isFunction(e.size)||(u=Math.min(Math.round(D.pt2px(e.size*e.sizeRatio)),127));v._dynamicPropertyMap.set("_size",(w,B,F)=>a.isFunction(e.size)?Math.min(Math.round(D.pt2px(e.size(w,B,F)*e.sizeRatio)),127):u);a.isFunction(e.outlineSize)?v._dynamicPropertyMap.set("_haloSize",(w,B,F)=>Math.min(Math.floor(5*D.pt2px(e.outlineSize(w,B,F)*e.sizeRatio)),127)):v._haloSize=
Math.min(Math.floor(5*D.pt2px(e.outlineSize*e.sizeRatio)),127);let y;a.isFunction(e.offsetX)||(y=Math.round(D.pt2px(e.offsetX*e.sizeRatio)));v._dynamicPropertyMap.set("_xOffset",(w,B,F)=>a.isFunction(e.offsetX)?Math.round(D.pt2px(e.offsetX(w,B,F)*e.sizeRatio)):y);let z;a.isFunction(e.offsetY)||(z=Math.round(D.pt2px(e.offsetY*e.sizeRatio)));v._dynamicPropertyMap.set("_yOffset",(w,B,F)=>a.isFunction(e.offsetY)?Math.round(D.pt2px(e.offsetY(w,B,F)*e.sizeRatio)):z);a.isFunction(e.angle)?v._dynamicPropertyMap.set("_angle",
e.angle):v._angle=e.angle;a.isFunction(e.horizontalAlignment)?v._dynamicPropertyMap.set("_horizontalAlignment",e.horizontalAlignment):v._horizontalAlignment=e.horizontalAlignment;a.isFunction(e.verticalAlignment)?v._dynamicPropertyMap.set("_verticalAlignment",e.verticalAlignment):v._verticalAlignment=e.verticalAlignment;t.isSome(e.effects)&&(r=e.effects,a.isFunction(r)?v._dynamicPropertyMap.set("_effects",r):v._effects=r);t.isSome(e.markerPlacement)&&(r=e.markerPlacement,a.isFunction(r)?v._dynamicPropertyMap.set("_markerPlacement",
r):v._textPlacement=r);a.isFunction(e.text)?v._dynamicPropertyMap.set("_text",e.text):v._text=e.text;v._scaleFactor=m;m=Math.min(Math.round(D.pt2px(e.referenceSize*e.sizeRatio)),127);v._referenceSize=Math.round(Math.sqrt(256*m));v._materialKey=e.materialKey;m=d.TextMaterialKey.load(v._materialKey);m.sdf=!0;v._bitset=(e.alignment===E.Alignment.MAP?1:0)|(e.colorLocked?1:0)<<1;v._materialKey=m.data;v._decoration="none";v._lineHeight=1;v._lineWidth=512;v._isCIM=!0;return v}q._inheritsLoose(p,h);p.fromCIMText=
function(e,m){const [r,v]=a.getMinMaxZoom(e.scaleInfo,m);return new p(e,r,v)};var k=p.prototype;k.analyze=function(){var e=q._asyncToGenerator(function*(m,r,v,x){var g=r.readLegacyFeature();var u=this._cimTextLayer;g="string"===typeof u.text?u.text:"function"===typeof u.text?u.text(g,v,x):"";(m=yield h.prototype.analyze.call(this,m,r,v,x,f.codepoints(g)))&&m.glyphMosaicItems&&this._textToGlyphs.set(g,m.glyphMosaicItems);return m});return function(m,r,v,x){return e.apply(this,arguments)}}();k.bindFeature=
function(e,m,r){const v=e.readLegacyFeature();this._dynamicPropertyMap.forEach((x,g)=>{this[g]=x(v,m,r)});this._text&&0!==this._text.length?(this._size*=this._scaleFactor,this._scale=this._size/n.GLYPH_SIZE,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=C.getXAnchorDirection(t.unwrapOr(this._horizontalAlignment,"center")),this._yAlignD=C.getYAnchorDirection(t.unwrapOr(this._verticalAlignment,"baseline")),e=this._textToGlyphs.get(this._text),this.bindTextInfo(e,!1)):
this._shapingInfo=null};return p}(b(c))})},"esri/views/2d/layers/features/textUtils":function(){define(["exports"],function(q){q.codepoints=function(t){const D=Array(t.length);for(let E=0;E<t.length;E++)D[E]=t.charCodeAt(E);return D};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLMeshTemplate".split(" "),
function(q,t,D,E,C,A,n,l,d,a){return function(b){function c(f,h,p,k,e,m,r,v,x,g,u,y,z,w,B,F){var G=b.call(this)||this;G._effects=w;f=n.FillMaterialKey.load(f);h&&(f.sdf=h.sdf,f.pattern=!0,f.textureBinding=h.textureBinding);G.fillColor=p;G.tl=k;G.br=e;G.aux2_1=A.i1616to32(m,r);G.aux2_2=A.i1616to32(v,x);G.aux3=A.i8888to32(g,u,y,0);G._bitset=z;G._minMaxZoom=A.i1616to32(Math.round(B*E.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(F*E.MIN_MAX_ZOOM_PRECISION_FACTOR));G._materialKey=f.data;return G}q._inheritsLoose(c,
b);c.fromCIMFill=function(f,h,p){var k=f.color;k=k&&D.premultiplyAlphaRGBA(k)||0;const e=f.materialKey,[m,r]=l.getMinMaxZoom(f.scaleInfo,p);p=(f.colorLocked?E.BITSET_GENERIC_LOCK_COLOR:0)|(f.applyRandomOffset?E.BITSET_FILL_RANDOM_PATTERN_OFFSET:0)|(f.sampleAlphaOnly?E.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);if(!h)return new c(e,null,k,0,0,0,0,0,0,0,0,0,p,f.effects,m,r);const {rect:v,width:x,height:g}=h;var u=f.scaleX||1,y=v.x+E.SPRITE_PADDING;const z=v.y+E.SPRITE_PADDING;var w=y+x;const B=z+g;var F=
f.height;let G=Math.round(F);0>=G&&(G=B-z);u=Math.round(u*F);0>=u&&(u=w-y);F=t.pt2px(f.offsetX||0);const H=t.pt2px(-f.offsetY||0);y=A.i1616to32(y,z);w=A.i1616to32(w,B);return new c(e,h,k,y,w,u,G,F,H,128,128,C.degToByte(f.angle),p,f.effects,m,r)};c.fromSimpleFill=function(f,h,p=!1){var {color:k}=f;k=k&&"esriSFSNull"!==f.style&&D.premultiplyAlphaRGBAArray(k)||0;p=p?E.BITSET_GENERIC_LOCK_COLOR:0;const e=f.materialKey;if(h){const {rect:v,width:x,height:g}=h;var m=v.x+E.SPRITE_PADDING;const u=v.y+E.SPRITE_PADDING;
var r=m+x;const y=u+g;m=A.i1616to32(m,u);r=A.i1616to32(r,y);h=new c(e,h,k,m,r,x,g,0,0,128,128,0,p,null,l.DEFAULT_MIN_ZOOM,l.DEFAULT_MAX_ZOOM)}else h=new c(e,null,k,0,0,0,0,0,0,0,0,0,p,null,l.DEFAULT_MIN_ZOOM,l.DEFAULT_MAX_ZOOM);h._maybeAddLineTemplate(f);return h};c.fromPictureFill=function(f,h,p=!1){const k=E.PICTURE_FILL_COLOR,{rect:e,width:m,height:r}=h;var v=e.x+E.SPRITE_PADDING,x=e.y+E.SPRITE_PADDING,g=v+m,u=x+r;v=A.i1616to32(v,x);g=A.i1616to32(g,u);u=Math.round(t.pt2px(f.width));x=Math.round(t.pt2px(f.height));
const y=t.pt2px(f.xoffset),z=t.pt2px(-f.yoffset);h=new c(f.materialKey,h,k,v,g,u,x,y,z,128*f.xscale,128*f.yscale,0,p?E.BITSET_GENERIC_LOCK_COLOR:0,null,l.DEFAULT_MIN_ZOOM,l.DEFAULT_MAX_ZOOM);h._maybeAddLineTemplate(f);return h};return c}(d(a))})},"esri/views/2d/engine/webgl/util/Lock":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/promiseUtils"],function(q,t,D){function E(){E=t._asyncToGenerator(function*(A,n,l){try{yield A.acquire(),yield n(l),
A.release()}catch(d){throw A.release(),d;}});return E.apply(this,arguments)}let C=function(){function A(){this._resolver=null}var n=A.prototype;n.isHeld=function(){return!!this._resolver};n.acquire=function(){var l=t._asyncToGenerator(function*(){this._resolver?(yield this._resolver.promise,yield this.acquire()):this._resolver=D.createResolver()});return function(){return l.apply(this,arguments)}}();n.release=function(){const l=this._resolver;this._resolver=null;l.resolve()};return A}();q.Lock=C;
q.withLock=function(A,n,l){return E.apply(this,arguments)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/support/cimSymbolUtils":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../symbols/cim/cimAnalyzer","../../../../symbols/cim/ExpandedCIM","./webStyleUtils"],function(q,t,D,E,C){const A=function(){var d=t._asyncToGenerator(function*(a,b,c,f){return Promise.all(a.map(h=>l(h,b,c,f)))});return function(a,
b,c,f){return d.apply(this,arguments)}}(),n=function(){var d=t._asyncToGenerator(function*(a,b,c){return new E.ExpandedCIM(yield D.analyzeCIMSymbol(a.data,b,c),a.data,a.rendererKey,a.maxVVSize)});return function(a,b,c){return d.apply(this,arguments)}}(),l=function(){var d=t._asyncToGenerator(function*(a,b,c,f){return a?"cim"===a.type?n(a,b,c):"web-style"===a.type?(a={type:"cim",data:yield C.fetchCIMSymbolReference(a,null,f),rendererKey:a.rendererKey,maxVVSize:a.maxVVSize},n(a,b,c)):a:null});return function(a,
b,c,f){return d.apply(this,arguments)}}();q.cimLayerToRasterizationInfo=function(d){if(!d)return null;const {type:a,cim:b,url:c,materialHash:f}=d,h={cim:b,type:a,mosaicHash:f,url:c,size:null,dashTemplate:null,path:null,text:null,fontName:null,animatedSymbolProperties:null};switch(a){case "marker":h.size=d.size;h.path=d.path;h.animatedSymbolProperties=d.animatedSymbolProperties;break;case "line":h.dashTemplate=d.dashTemplate;break;case "text":h.text=d.text,h.fontName=d.fontName}return h};q.expandSymbol=
l;q.expandSymbols=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/ExpandedCIM":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../views/2d/engine/webgl/enums","../../views/2d/engine/webgl/materialKey/MaterialKey"],function(q,t,D,E){const C={marker:D.WGLGeometryType.MARKER,fill:D.WGLGeometryType.FILL,line:D.WGLGeometryType.LINE,text:D.WGLGeometryType.TEXT};let A=function(){function n(l,d,a,b){const c={minScale:null==
d?void 0:d.minScale,maxScale:null==d?void 0:d.maxScale};var f=c.minScale||c.maxScale?c.minScale+"-"+c.maxScale:"";this.layers=l;this.data=d;this.hash=this._createHash()+f;this.rendererKey=a;d={isOutline:!1,placement:null,symbologyType:D.WGLSymbologyType.DEFAULT,vvFlags:a};for(const h of l)l=C[h.type],d.isOutline="line"===h.type&&h.isOutline,h.materialKey=E.createMaterialKey(l,d),h.maxVVSize=b,h.scaleInfo=c,h.templateHash+=f}n.prototype._createHash=function(){let l="";for(const d of this.layers)l+=
d.templateHash;return l};t._createClass(n,[{key:"type",get:function(){return"expanded-cim"}}]);return n}();q.ExpandedCIM=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/support/webStyleUtils":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/devEnvironmentUtils ../../../../core/Error ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../portal/Portal ../../../../chunks/persistableUrlUtils ../../../../symbols/support/styleUtils".split(" "),
function(q,t,D,E,C,A,n,l,d,a){function b(){b=t._asyncToGenerator(function*(k,e,m){if(!k.name)throw new E("style-symbol-reference-name-missing","Missing name in style symbol reference");if(k.styleName&&"Esri2DPointSymbolsStyle"===k.styleName)return c(k,m);try{const r=yield a.fetchStyle(k,e,m);return h(r,k.name,e,m)}catch(r){return A.throwIfAborted(r),null}});return b.apply(this,arguments)}function c(k,e){return f.apply(this,arguments)}function f(){f=t._asyncToGenerator(function*(k,e){k=a.Style2DUrlTemplate.replace(/\{SymbolName\}/gi,
k.name);try{const m=yield a.requestJSON(k,e);return a.makeCIMSymbolRef(m.data)}catch(m){return A.throwIfAborted(m),null}});return f.apply(this,arguments)}function h(k,e,m,r){return p.apply(this,arguments)}function p(){p=t._asyncToGenerator(function*(k,e,m,r){var v=k.data;k={portal:m&&C.isSome(m.portal)?m.portal:l.getDefault(),url:n.urlToObject(k.baseUrl),origin:"portal-item"};v=v.items.find(x=>x.name===e);if(!v)throw new E("symbolstyleutils:symbol-name-not-found",`The symbol name '${e}' could not be found`,
{symbolName:e});v=d.fromJSON(a.symbolUrlFromStyleItem(v,"cimRef"),k);D.isDevEnvironment()&&(v=D.adjustStaticAGOUrl(v));try{const x=yield a.requestJSON(v,r);return a.makeCIMSymbolRef(x.data)}catch(x){return A.throwIfAborted(x),null}});return p.apply(this,arguments)}q.fetchCIMSymbolReference=function(k,e,m){return b.apply(this,arguments)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(q){const t=
/^devext.arcgis.com$/,D=/^qaext.arcgis.com$/,E=/^[\w-]*\.mapsdevext.arcgis.com$/,C=/^[\w-]*\.mapsqa.arcgis.com$/,A=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,t,D,/^jsapps.esri.com$/,E,C];q.adjustStaticAGOUrl=function(n,l){return n?(l=l||globalThis.location.hostname)?null!=l.match(t)||null!=l.match(E)?n.replace("static.arcgis.com","staticdev.arcgis.com"):null!=l.match(D)||null!=l.match(C)?n.replace("static.arcgis.com","staticqa.arcgis.com"):n:n:n};q.isDevEnvironment=function(n){n=n||globalThis.location.hostname;
return A.some(l=>{var d;return null!=(null==(d=n)?void 0:d.match(l))})};q.isTelemetryDevEnvironment=function(n){n=n||globalThis.location.hostname;return[/^zrh-.+?\.esri\.com$/].concat(A).some(l=>{var d;return null!=(null==(d=n)?void 0:d.match(l))})};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/util/Matcher":function(){define("require exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/LRUCache ../../../../../support/arcadeOnDemand ../../../arcade/callExpressionWithFeature ../../../layers/support/cimSymbolUtils".split(" "),
function(q,t,D,E,C,A,n,l,d){function a(u,y,z,w){return b.apply(this,arguments)}function b(){b=D._asyncToGenerator(function*(u,y,z,w){switch(u.type){case "simple":case "heatmap":return e.fromBasicRenderer(u,y,z,w);case "map":return v.fromUVRenderer(u,y,z,w);case "interval":return r.fromCBRenderer(u,y,z,w);case "dictionary":return g.fromDictionaryRenderer(u,y,z,w);case "pie-chart":return m.fromPieChartRenderer(u,y,z,w);case "subtype":return m.fromSubtypes(u,y,z,w)}});return b.apply(this,arguments)}
function c(u,y){return f.apply(this,arguments)}function f(){f=D._asyncToGenerator(function*(u,y){const z=u||1;if("number"===typeof z)return(B,F,G)=>z;const w=yield n.createRendererExpression(z,y.spatialReference,y.fields);return(B,F,G)=>l(w,B,{$view:G},y.geometryType,F)||1});return f.apply(this,arguments)}function h(){return p.apply(this,arguments)}function p(){p=D._asyncToGenerator(function*(){x||(x=new Promise((u,y)=>q(["../../../layers/features/createSymbolSchema"],u,y)));return x});return p.apply(this,
arguments)}const k=C.getLogger("esri/views/2d/engine/webgl/util/Matcher");let e=function(){function u(){this.type="feature";this._defaultResult=null}u.fromBasicRenderer=function(){var z=D._asyncToGenerator(function*(w,B,F,G){const H=new u;w.symbol&&(w=yield d.expandSymbol(w.symbol,F,G),B=B.createTemplateGroup(w,null),H.setDefault(B));return H});return function(w,B,F,G){return z.apply(this,arguments)}}();u.fromPieChartRenderer=function(){var z=D._asyncToGenerator(function*(w,B,F,G){const H=new u;if(w.markerSymbol){const I=
yield d.expandSymbol(w.markerSymbol,F,G);let L;w.fillSymbol&&(L=yield d.expandSymbol(w.fillSymbol,F,G));w=B.createTemplateGroup(I,L);H.setDefault(w)}return H});return function(w,B,F,G){return z.apply(this,arguments)}}();var y=u.prototype;y.size=function(){return 1};y.getDefault=function(){return this._defaultResult};y.setDefault=function(z){this._defaultResult=z};y.match=function(z,w,B,F,G){return this.getDefault()};y.analyze=function(){var z=D._asyncToGenerator(function*(w,B,F,G,H,I){return null});
return function(w,B,F,G,H,I){return z.apply(this,arguments)}}();return u}(),m=function(u){function y(z,w){var B=u.call(this)||this;B._subMatchers=z;B._subtypeField=w;return B}D._inheritsLoose(y,u);y.fromSubtypes=function(){var z=D._asyncToGenerator(function*(w,B,F,G){const H=new Map,I=[];for(const L in w.renderers){const N=parseInt(L,10),J=a(w.renderers[L],B,F,G).then(K=>H.set(N,K));I.push(J)}yield Promise.all(I);return new y(H,w.subtypeField)});return function(w,B,F,G){return z.apply(this,arguments)}}();
y.prototype.match=function(z,w,B,F,G){var H=w.readAttribute(this._subtypeField);return(H=this._subMatchers.get(H))?H.match(z,w,B,F,G):null};return y}(e),r=function(u){function y(w,B,F,G){var H=u.call(this)||this;H.type="interval";H._intervals=[];H._isMaxInclusive=B;H._fieldIndex=G;H._field=w;H._normalizationInfo=F;return H}D._inheritsLoose(y,u);y.fromCBRenderer=function(){var w=D._asyncToGenerator(function*(B,F,G,H){const {isMaxInclusive:I,normalizationField:L,normalizationTotal:N,normalizationType:J}=
B,K=new y(B.field,I,{normalizationField:L,normalizationTotal:N,normalizationType:J},B.fieldIndex),O=yield d.expandSymbol(B.backgroundFillSymbol,G,H);yield Promise.all(B.intervals.map(function(){var W=D._asyncToGenerator(function*(aa){var ba=yield d.expandSymbol(aa.symbol,G,H);ba=yield F.createTemplateGroup(ba,O);K.add({min:aa.min,max:aa.max},ba)});return function(aa){return W.apply(this,arguments)}}()));if(B=yield d.expandSymbol(B.defaultSymbol,G,H))B=yield F.createTemplateGroup(B,O),K.setDefault(B);
return K});return function(B,F,G,H){return w.apply(this,arguments)}}();var z=y.prototype;z.add=function(w,B){this._intervals.push({interval:w,result:B});this._intervals.sort((F,G)=>F.interval.min-G.interval.min)};z.size=function(){return u.prototype.size.call(this)+this._intervals.length};z.match=function(w,B,F,G,H){if(null==this._fieldIndex&&!this._field)return this.getDefault();w=null!=this._fieldIndex?B.getComputedNumericAtIndex(this._fieldIndex):this._getValueFromField(B);if(!w&&(null===w||void 0===
w||isNaN(w)))return this.getDefault();for(B=0;B<this._intervals.length;B++){const {interval:I,result:L}=this._intervals[B];F=this._isMaxInclusive?w<=I.max:w<I.max;if(w>=I.min&&F)return L}return this.getDefault()};z._needsNormalization=function(){const w=this._normalizationInfo;return w&&(w.normalizationField||w.normalizationTotal||w.normalizationType)};z._getValueFromField=function(w){const B=w.readAttribute(this._field);if(!this._needsNormalization()||null==B)return B;const {normalizationField:F,
normalizationTotal:G,normalizationType:H}=this._normalizationInfo;w=!!F&&w.readAttribute(F);if(H)switch(H){case "esriNormalizeByField":return(w||void 0)&&B/w;case "esriNormalizeByLog":return Math.log(B)*Math.LOG10E;case "esriNormalizeByPercentOfTotal":return B/G*100;default:k.error(`Found unknown normalization type: ${H}`)}else k.error("Normalization is required, but no type was set!")};return y}(e),v=function(u){function y(w,B,F){var G=u.call(this)||this;G.type="map";G._nullResult=null;G._resultsMap=
new Map;G._fieldsIndex=F;G._fields=w;G._seperator=B||"";return G}D._inheritsLoose(y,u);y.fromUVRenderer=function(){var w=D._asyncToGenerator(function*(B,F,G,H){const I=B.fieldDelimiter,L=[B.field];B.field2&&L.push(B.field2);B.field3&&L.push(B.field3);const N=yield d.expandSymbol(B.backgroundFillSymbol,G,H),J=new y(L,I,B.fieldIndex);yield Promise.all(B.map.map(function(){var K=D._asyncToGenerator(function*(O){var W=yield d.expandSymbol(O.symbol,G,H);W=yield F.createTemplateGroup(W,N);"\x3cNull\x3e"===
O.value?J.setNullResult(W):J.add(O.value,W)});return function(O){return K.apply(this,arguments)}}()));if(B=yield d.expandSymbol(B.defaultSymbol,G,H))B=yield F.createTemplateGroup(B,N),J.setDefault(B);return J});return function(B,F,G,H){return w.apply(this,arguments)}}();var z=y.prototype;z.setNullResult=function(w){this._nullResult=w};z.add=function(w,B){this._resultsMap.set(w.toString(),B)};z.size=function(){return u.prototype.size.call(this)+this._resultsMap.size};z.match=function(w,B,F,G,H){if(null==
this._fieldsIndex&&!this._fields)return this.getDefault();w=null!=this._fieldsIndex?B.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(B);if(null!==this._nullResult&&(null==w||""===w||"\x3cNull\x3e"===w))return this._nullResult;if(!w&&null==w)return this.getDefault();w=w.toString();return this._resultsMap.has(w)?this._resultsMap.get(w):this.getDefault()};z._getValueFromFields=function(w){const B=[];for(const F of this._fields){const G=w.readAttribute(F);null==G||""===G?B.push("\x3cNull\x3e"):
B.push(G)}return B.join(this._seperator)};return y}(e),x,g=function(u){function y(w,B,F,G,H,I){var L=u.call(this)||this;L.type="dictionary";L._groupIdCache=new A(100);L._loader=w;L._fieldMap=w.fieldMap;L._symbolFields=w.getSymbolFields();L._templates=B;L._info=F;L._scaleFn=G;L._schemaUtilsModule=H;L._symbolOptions=I;return L}D._inheritsLoose(y,u);y.fromDictionaryRenderer=function(){var w=D._asyncToGenerator(function*(B,F,G,H){const [{DictionaryLoader:I},L]=yield Promise.all([new Promise((J,K)=>q(["../../../../../renderers/support/DictionaryLoader"],
J,K)),h()]);H=new I(B.url,B.config,B.fieldMap);yield H.fetchResources({spatialReference:G.spatialReference,fields:G.fields});const N=yield c(B.scaleExpression,G);return new y(H,F,G,N,L,B.symbolOptions)});return function(B,F,G,H){return w.apply(this,arguments)}}();var z=y.prototype;z._analyzeFeature=function(){var w=D._asyncToGenerator(function*(B,F,G,H,I){B=B.readLegacyFeature();const L=this._scaleFn(B,G,H);G=this._attributeHash(B)+"-"+L;const N=this._groupIdCache.get(G);if(N)return N;H=yield this._loader.getSymbolAsync(B,
{...H,spatialReference:this._info.spatialReference,abortOptions:I,fields:this._info.fields});H=this._schemaUtilsModule.createSymbolSchema(H,this._symbolOptions);F=d.expandSymbol(H,this._info,F,I).then(J=>{if("expanded-cim"!==J.type)return k.error(new E("mapview-bad-type",`Found unexpected type ${J.type} in dictionary response`)),null;J.hash+="-"+L;for(const K of J.layers)K.scaleFactor=L,K.templateHash+="-"+L;return this._templates.createTemplateGroup(J,null)});this._groupIdCache.put(G,F,1);return F});
return function(B,F,G,H,I){return w.apply(this,arguments)}}();z.analyze=function(){var w=D._asyncToGenerator(function*(B,F,G,H,I,L){B=F.getCursor();for(F=[];B.next();)F.push(this._analyzeFeature(B,G,H,I,L));return Promise.all(F)});return function(B,F,G,H,I,L){return w.apply(this,arguments)}}();z.match=function(w,B,F,G,H){return null};z._attributeHash=function(w){let B="";for(const F of this._symbolFields){const G=this._fieldMap[F];G&&(B+=w.attributes[G]+"-")}return B};return y}(e);t.DictionaryMatcher=
g;t.FeatureMatcher=e;t.IntervalMatcher=r;t.MapMatcher=v;t.SubtypeMatcher=m;t.createMatcher=a;Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/schemaUtils":function(){define("exports ../../../../core/Error ../../../../core/has ../../../../core/lang ../../../../core/Logger ../../../../core/maybe ../../../../core/screenUtils ../../../../core/sql ../../engine/webgl/enums ../../engine/webgl/Utils ../../engine/webgl/techniques/utils ../../engine/webgl/util/vvFlagUtils ./createSymbolSchema ./support/pixelBuffering ./support/rendererUtils ../support/clusterUtils ../support/util".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c,f,h,p,k,e){function m(V){let P=0,X=0,R=d.WGLSymbologyType.DEFAULT;if(A.isSome(V)){X=h.getPtMaxVVSize(V);"visualVariables"in V&&(P=c.getVVFlags(V.visualVariables||[]),"dot-density"===V.type&&(R=d.WGLSymbologyType.DOT_DENSITY));"heatmap"===V.type&&(R=d.WGLSymbologyType.HEATMAP);if("dictionary"===V.type)return{maxVVSize:X,vvFlags:P,symbologyType:d.WGLSymbologyType.DEFAULT};if("pie-chart"===V.type)return{maxVVSize:X,vvFlags:P,symbologyType:d.WGLSymbologyType.PIE_CHART};
if(R!==d.WGLSymbologyType.DOT_DENSITY&&R!==d.WGLSymbologyType.HEATMAP){var T=V.getSymbols();"backgroundFillSymbol"in V&&V.backgroundFillSymbol&&T.push(V.backgroundFillSymbol);let ca=V=!0;for(const ja of T)if("cim"===ja.type&&(ca=!1),"simple-fill"===ja.type||"picture-fill"===ja.type){T=(T=ja.outline)&&"none"!==T.style&&"solid"!==T.style;var Z="simple-fill"===ja.type&&"none"!==ja.style&&"solid"!==ja.style;Z="picture-fill"===ja.type||Z||T;T&&(V=!1);Z&&(ca=!1)}V?R=ca?d.WGLSymbologyType.OUTLINE_FILL_SIMPLE:
d.WGLSymbologyType.OUTLINE_FILL:ca&&(R=d.WGLSymbologyType.SIMPLE)}}return{vvFlags:P,maxVVSize:X,symbologyType:R}}function r(V,P){V=E.clone(V);return V.some(X=>{{const T=X.labelPlacement;var R=Y[P];X.symbol?R?(R.includes(T)||(R=R[0],T&&Q.warn(`Found invalid label placement type ${T} for ${P}. Defaulting to ${R}`),X.labelPlacement=R),X=!1):(Q.error(new t("mapview-labeling:unsupported-geometry-type",`Unable to create labels for Feature Layer, ${P} is not supported`)),X=!0):(Q.warn("No ILabelClass symbol specified."),
X=!0)}return X})?[]:V}function v(V,P=!1){try{var X,R;const T=w(V,P),Z=H(V),ca={};T.map(U=>{a:{switch(U.target){case "feature":u(ca,g(V),U);U=void 0;break a;case "aggregate":if(!("featureReduction"in V)){U=void 0;break a}var da=V.featureReduction;switch(da.type){case "selection":throw new t("ValidationError","Mapview does not support `selection` reduction type",da);case "binning":u(ca,g(V),U);ca.aggregate||(ca.aggregate={name:"aggregate",type:"bin",filters:null,input:"feature",params:{fixedBinLevel:da.fixedBinLevel},
attributes:{}});x(ca.aggregate,U.attributes.fields);U=void 0;break a;case "cluster":u(ca,g(V),U);ca.aggregate||(ca.aggregate={name:"aggregate",type:"cluster",input:"feature",filters:null,attributes:{},params:{clusterRadius:n.pt2px(da.clusterRadius/2),clusterPixelBuffer:64*Math.ceil(n.pt2px(da.clusterMaxSize)/64),fields:U.aggregateFields}});x(ca.aggregate,U.attributes.fields);U=void 0;break a}}U=void 0}return U});const ja=A.isSome(V.subtypeCode)?`${V.subtypeField} = ${V.subtypeCode}`:null;return{source:{definitionExpression:l.sqlAnd(V.definitionExpression,
ja),fields:V.fields.map(U=>U.toJSON()),gdbVersion:V.gdbVersion,historicMoment:null==(X=V.historicMoment)?void 0:X.getTime(),outFields:V.availableFields,pixelBuffer:V.pixelBuffer,spatialReference:V.spatialReference.toJSON(),timeExtent:null==(R=V.timeExtent)?void 0:R.toJSON(),customParameters:V.customParameters},attributes:{fields:{},indexCount:0},processors:T,tileRenderer:Z,targets:ca}}catch(T){if("ValidationError"===T.fieldName)return Q.error(T),null;throw T;}}function x(V,P){for(const X in P){const R=
P[X];if(R.target!==V.name)continue;const T=V.attributes[X];T?(T.context.mesh=T.context.mesh||R.context.mesh,T.context.storage=T.context.storage||R.context.storage):V.attributes[X]=R}return V}function g(V){var P,X,R,T,Z;return[null!=(P=null==(X=A.unwrap(V.filter))?void 0:X.toJSON())?P:null,null!=(R=null==(T=A.unwrap(null==(Z=A.unwrap(V.featureEffect))?void 0:Z.filter))?void 0:T.toJSON())?R:null]}function u(V,P,X){V.feature||(V.feature={name:"feature",input:"source",filters:P,attributes:{}});x(V.feature,
X.attributes.fields);return V}function y(V,P){return P.field?z(V,{...P,type:"field",field:P.field}):P.valueExpression?z(V,{...P,type:"expression",valueExpression:P.valueExpression}):{field:null,fieldIndex:null}}function z(V,P){switch(P.type){case "expression":var X=P.valueExpression;if(!V.fields[X]){var R=V.indexCount++;V.fields[X]={...P,name:X,fieldIndex:R}}return{fieldIndex:V.fields[X].fieldIndex};case "label-expression":return X=JSON.stringify(P.label),V.fields[X]||(R=V.indexCount++,V.fields[X]=
{...P,name:X,fieldIndex:R}),{fieldIndex:V.fields[X].fieldIndex};case "field":X=P.field;if("aggregate"===P.target&&V.fields[X])return{field:X};V.fields[X]={...P,name:X};return{field:X};case "statistic":return V.fields[P.name]={...P},{field:P.name}}}function w(V,P=!1){const X=[];let R=0;X.push(G(V,R++,P));return X}function B(V,P,X,R,T,Z=!1){P=z(P,{type:"label-expression",target:R,context:{mesh:!0},resultType:"string",label:{labelExpression:X.labelExpression,labelExpressionInfo:X.labelExpressionInfo?
{expression:X.labelExpressionInfo.expression}:null,symbol:!!X.symbol,where:X.where}});({fieldIndex:P}=P);V=m(V);return{...f.createSymbolSchema(X,V,Z),fieldIndex:P,target:R,index:T}}function F(V,P,X){const R="featureReduction"in P&&P.featureReduction;if(!R)return{fields:[],labels:[],matcher:null,rendererOverride:null};const T=[];let Z=null,ca=e.toJSONGeometryType(P.geometryType),ja=[],U=null;if(R)switch(R.type){case "selection":throw new t("ValidationError","Mapview does not support `selection` reduction type",
R);case "cluster":case "binning":if("cluster"===R.type?ca="esriGeometryPoint":"binning"===R.type&&(ca="esriGeometryPolygon"),R.renderer){for(const da of R.fields)k.convertAggregateFieldFromPublic(T,da);U=R.renderer;Z=O(null,"aggregate",R.renderer,X);ja=R&&R.labelsVisible&&R.labelingInfo||[]}else"cluster"===R.type&&(U=k.createClusterRenderer(T,P.renderer,R,null),R.symbol&&(P=m(U),Z={type:"simple",symbol:f.createSymbolSchema(R.symbol,P,X),symbologyType:P.symbologyType}),ja=R&&R.labelsVisible&&R.labelingInfo||
[])}L(V,T);return{labels:r(ja,"binning"===R.type?"esriGeometryPolygon":ca),matcher:Z,fields:T,rendererOverride:U}}function G(V,P,X=!1){const R={indexCount:0,fields:{}};P="featureReduction"in V&&V.featureReduction?"aggregate":"feature";if("sublayers"in V){var T={type:"subtype",subtypeField:V.subtypeField,renderers:{},symbologyType:d.WGLSymbologyType.DEFAULT},Z={type:"subtype",mapping:{},target:"feature"};var ca={type:"subtype",classes:{}};var ja={type:"symbol",target:"feature",aggregateFields:[],attributes:R,
storage:Z,mesh:{matcher:T,aggregateMatcher:null,labels:ca,sortKey:null}},U=new Set;let ia=0;for(const {renderer:ea,subtypeCode:ha,labelingInfo:ka,labelsVisible:la}of V.sublayers){V=O(R,P,ea,X);const ma=N(R,P,ea),oa=la&&ka;if("visualVariables"in ea&&ea.visualVariables&&ea.visualVariables.length)throw new t("ValidationError","Visual variables are currently not supported for subtype layers");if("dictionary"===V.type)throw new t("ValidationError","Dictionary renderer is not supported in subtype layers");
if("subtype"===V.type)throw new t("ValidationError","Nested subtype renderers is not supported");if(A.isSome(ma)&&"subtype"===ma.type)throw new t("ValidationError","Nested subtype storage is not supported");if(A.isSome(ma)&&A.isSome(ma.attributeMapping))throw new t("ValidationError","Non-visual-variable attributes are not supported in subtype layers");if("heatmap"===V.type)throw new t("ValidationError","Heatmaps are not supported in subtype layers");if("pie-chart"===V.type)throw new t("ValidationError",
"Pie-charts are not supported in subtype layers");if(U.has(ha))throw new t("ValidationError","Subtype codes for sublayers must be unique");U.add(ha);T.renderers[ha]=V;Z.mapping[ha]=ma;oa&&(ca.classes[ha]=oa.map(pa=>B(ea,R,pa,"feature",ia++,X)))}return ja}if("heatmap"===V.renderer.type&&"raster"===p.getSupportedHeatmapRenderer()){const {radius:ia,fieldOffset:ea,field:ha}=V.renderer;return{type:"heatmap",aggregateFields:[],attributes:R,target:P,storage:null,mesh:{radius:ia,fieldOffset:ea,field:y(R,
{target:P,field:ha,resultType:"numeric"}).field}}}T=F(R,V,X);Z=e.toJSONGeometryType(V.geometryType);const da=null!=(ca=T.rendererOverride)?ca:V.renderer;ca=O(R,P,da,X);ja=N(R,P,da);U=I(R,V.orderBy);let fa=0;V=[...r(V.labelsVisible&&V.labelingInfo||[],Z).map(ia=>B(da,R,ia,"feature",fa++,X)),...T.labels.map(ia=>B(da,R,ia,"aggregate",fa++,X))];return{type:"symbol",target:P,attributes:R,aggregateFields:T.fields,storage:ja,mesh:{matcher:ca,labels:{type:"simple",classes:V},aggregateMatcher:T.matcher,sortKey:U}}}
function H(V){var P;return"heatmap"===(null==(P=V.renderer)?void 0:P.type)&&"raster"===p.getSupportedHeatmapRenderer()?{type:"heatmap"}:{type:"symbol"}}function I(V,P){if(A.isNone(P)||!P.length)return null;1<P.length&&Q.warn(`Layer rendering currently only supports ordering by 1 orderByInfo, but found ${P.length}. All but the first will be discarded`);P=P[0];const X="ascending"===P.order?"asc":"desc";if(P.field)return{field:P.field,order:X};if(P.valueExpression)return{fieldIndex:z(V,{type:"expression",
target:"feature",valueExpression:P.valueExpression,resultType:"numeric"}).fieldIndex,order:X};Q.error(new t("ValidationError","Expected to find a field or valueExpression for OrderByInfo",P));return null}function L(V,P){const X={mesh:!0,storage:!0};for(const R of P){const {name:T,outStatistic:Z}=R,{statisticType:ca,onStatisticField:ja}=Z;let U=P=null,da=null;"onStatisticValueExpression"in Z?U=z(V,{type:"expression",target:"feature",valueExpression:Z.onStatisticValueExpression,resultType:"numeric"}).fieldIndex:
"onStatisticNormalizationField"in Z?(P=z(V,{type:"field",target:"feature",field:ja,resultType:"numeric"}).field,da=Z.onStatisticNormalizationField):P=z(V,{type:"field",target:"feature",field:ja,resultType:"numeric"}).field;z(V,{type:"statistic",target:"aggregate",name:T,context:X,inField:P,inNormalizationField:da,inFieldIndex:U,statisticType:ca})}}function N(V,P,X){let R;switch(X.type){case "simple":case "class-breaks":case "unique-value":case "dictionary":R={visualVariables:!0,attributes:null};break;
default:R=b.getTechniqueFromRenderer(X).getStorageSpec(X)}return J(V,P,R,X)}function J(V,P,X,R){if(A.isNone(X))return null;const {visualVariables:T,attributes:Z}=X;X=null;T&&"visualVariables"in R&&(X=K(V,P,R.visualVariables));const ca=A.isSome(X)?4:0;R=null;A.isSome(Z)&&(R=Z.map((ja,U)=>{const {field:da,fieldIndex:fa}=y(V,{valueExpression:ja.valueExpression,field:ja.field,resultType:"numeric",target:P});return{binding:U+ca,field:da,fieldIndex:fa}}));return{type:"simple",target:P,attributeMapping:R,
vvMapping:X}}function K(V,P,X){if(!X||!X.length)return[];const R={storage:!0};return p.simplifyVisualVariables(X).map(T=>{var Z;const ca=a.getVVType(T.type),{field:ja,fieldIndex:U}=y(V,{target:P,valueExpression:T.valueExpression,field:T.field,context:R,resultType:"numeric"});switch(T.type){case "size":return"$view.scale"===T.valueExpression?null:{type:"size",binding:ca,field:ja,fieldIndex:U,normalizationField:y(V,{target:P,field:T.normalizationField,context:R,resultType:"numeric"}).field,valueRepresentation:null!=
(Z=T.valueRepresentation)?Z:null};case "color":return{type:"color",binding:ca,field:ja,fieldIndex:U,normalizationField:y(V,{target:P,field:T.normalizationField,context:R,resultType:"numeric"}).field};case "opacity":return{type:"opacity",binding:ca,field:ja,fieldIndex:U,normalizationField:y(V,{target:P,field:T.normalizationField,context:R,resultType:"numeric"}).field};case "rotation":return{type:"rotation",binding:ca,field:ja,fieldIndex:U}}}).filter(T=>T)}function O(V,P,X,R=!1){V=A.unwrapOr(V,{indexCount:0,
fields:{}});switch(X.type){case "simple":case "dot-density":return W(V,X,R);case "class-breaks":return ba(V,P,X,R);case "unique-value":return S(V,P,X,R);case "dictionary":return P=m(X),X={type:"dictionary",config:X.config,fieldMap:X.fieldMap,scaleExpression:X.scaleExpression,url:X.url,symbolOptions:P,symbologyType:P.symbologyType};case "heatmap":return M(V,X,R);case "pie-chart":return aa(V,X,R)}}function W(V,P,X=!1){V=P.getSymbols();V=V.length?V[0]:null;P=m(P);return{type:"simple",symbol:f.createSymbolSchema(V,
P,X),symbologyType:P.symbologyType}}function aa(V,P,X=!1){var R=P.getSymbols();V=R[0];R=1<R.length?R[1]:null;P=m(P);return{type:"pie-chart",markerSymbol:f.createSymbolSchema(V,P,X),fillSymbol:f.createSymbolSchema(R,P,X),symbologyType:P.symbologyType}}function ba(V,P,X,R=!1){const T=X.backgroundFillSymbol,{field:Z,fieldIndex:ca}=y(V,{target:P,field:X.field,valueExpression:X.valueExpression,resultType:"numeric",context:{mesh:!0,use:"renderer.field"}});P=X.normalizationType;P="log"===P?"esriNormalizeByLog":
"percent-of-total"===P?"esriNormalizeByPercentOfTotal":"field"===P?"esriNormalizeByField":null;const ja=m(X),U=X.classBreakInfos.map(da=>({symbol:f.createSymbolSchema(da.symbol,ja,R),min:da.minValue,max:da.maxValue})).sort((da,fa)=>da.min-fa.min);return{type:"interval",attributes:V.fields,field:Z,fieldIndex:ca,backgroundFillSymbol:f.createSymbolSchema(T,ja,R),defaultSymbol:f.createSymbolSchema(X.defaultSymbol,ja,R),intervals:U,normalizationField:X.normalizationField,normalizationTotal:X.normalizationTotal,
normalizationType:P,isMaxInclusive:X.isMaxInclusive,symbologyType:ja.symbologyType}}function S(V,P,X,R=!1){const T=[],Z=X.backgroundFillSymbol;P={target:P,context:{mesh:!0},resultType:"string"};if(X.field&&"string"!==typeof X.field)throw new t("ValidationError","Expected renderer.field to be a string",X);const {field:ca,fieldIndex:ja}=y(V,{...P,field:X.field,valueExpression:X.valueExpression}),U=m(X);for(const da of X.uniqueValueInfos)T.push({value:""+da.value,symbol:f.createSymbolSchema(da.symbol,
U,R)});return{type:"map",attributes:V.fields,field:ca,fieldIndex:ja,field2:y(V,{...P,field:X.field2}).field,field3:y(V,{...P,field:X.field3}).field,fieldDelimiter:X.fieldDelimiter,backgroundFillSymbol:f.createSymbolSchema(Z,U),defaultSymbol:f.createSymbolSchema(X.defaultSymbol,U),map:T,symbologyType:U.symbologyType}}function M(V,P,X=!1){V=P.getSymbols();V=V.length?V[0]:null;P=m(P);return{type:"heatmap",symbol:f.createSymbolSchema(V,P,X),symbologyType:P.symbologyType}}const Q=C.getLogger("esri.views.2d.layers.features.schemaUtils"),
Y={esriGeometryPoint:"above-right above-center above-left center-center center-left center-right below-center below-left below-right".split(" "),esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null};q.createSymbolSchema=f.createSymbolSchema;q.addAggregateFields=L;q.createMatcherSchema=O;q.createRendererAttributeSchema=y;q.createSchema=function(V){D("esri-2d-update-debug")&&console.debug("Created new schema",v(V,!0));return v(V)};q.createSymbolSchemaOptions=
m;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/util/vvFlagUtils":function(){define(["exports","../enums","../visualVariablesUtils"],function(q,t,D){q.getVVFlags=function(E){if(!E)return t.WGLVVFlag.NONE;let C=0;for(const A of E)"size"===A.type?(E=D.getTypeOfSizeVisualVariable(A),C|=E,"outline"===A.target&&(C|=E<<4)):"color"===A.type?C|=t.WGLVVFlag.COLOR:"opacity"===A.type?C|=t.WGLVVFlag.OPACITY:"rotation"===A.type&&(C|=t.WGLVVFlag.ROTATION);
return C};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define(["exports","../../../../core/Error","../../../../core/Logger","./enums","./Utils"],function(q,t,D,E,C){const A=D.getLogger("esri.views.2d.engine.webgl");q.getTypeOfSizeVisualVariable=function(n){if(C.isNumber(n.minDataValue)&&C.isNumber(n.maxDataValue)&&null!=n.minSize&&null!=n.maxSize)return E.WGLVVFlag.SIZE_MINMAX_VALUE;if((n.expression&&
"view.scale"===n.expression||n.valueExpression&&"$view.scale"===n.valueExpression)&&Array.isArray(n.stops))return E.WGLVVFlag.SIZE_SCALE_STOPS;if((null!=n.field||n.expression&&"view.scale"!==n.expression||n.valueExpression&&"$view.scale"!==n.valueExpression)&&(Array.isArray(n.stops)||"levels"in n&&n.levels))return E.WGLVVFlag.SIZE_FIELD_STOPS;if((null!=n.field||n.expression&&"view.scale"!==n.expression||n.valueExpression&&"$view.scale"!==n.valueExpression)&&null!=n.valueUnit)return E.WGLVVFlag.SIZE_UNIT_VALUE;
A.error(new t("mapview-bad-type","Found invalid size VisualVariable",n));return E.WGLVVFlag.NONE};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/createSymbolSchema":function(){define(["exports","../../engine/webgl/enums","../../engine/webgl/materialKey/MaterialKey"],function(q,t,D){function E(n){switch(n.type){case "line-marker":var l;return{type:"line-marker",color:null==(l=n.color)?void 0:l.toJSON(),placement:n.placement,
style:n.style};default:return n.constructor.fromJSON(n.toJSON()).toJSON()}}function C(n,l,d){var a=D.createMaterialKey(t.WGLGeometryType.FILL,l);a=d?D.hydrateMaterialKey(a):a;var b=n.clone();n=b.outline;const c=D.isOutlineFillSymbology(l.symbologyType);c||(b.outline=null);b={materialKey:a,hash:b.hash(),...E(b)};if(c)return b;a=[];a.push(b);n&&(l=D.createMaterialKey(t.WGLGeometryType.LINE,{...l,isOutline:!0}),d={materialKey:d?D.hydrateMaterialKey(l):l,hash:n.hash(),...E(n)},a.push(d));return{type:"composite-symbol",
layers:a,hash:a.reduce((f,h)=>h.hash+f,"")}}function A(n,l,d){var a=D.isOutlineFillSymbology(l.symbologyType)?t.WGLSymbologyType.DEFAULT:l.symbologyType;a=D.createMaterialKey(t.WGLGeometryType.LINE,{...l,symbologyType:a});const b=d?D.hydrateMaterialKey(a):a;n=n.clone();a=n.marker;n.marker=null;const c=[];c.push({materialKey:b,hash:n.hash(),...E(n)});if(a){var f;l=D.createMaterialKey(t.WGLGeometryType.MARKER,l);d=d?D.hydrateMaterialKey(l):l;a.color=null!=(f=a.color)?f:n.color;c.push({materialKey:d,
hash:a.hash(),lineWidth:n.width,...E(a)})}return{type:"composite-symbol",layers:c,hash:c.reduce((h,p)=>p.hash+h,"")}}q.createSymbolSchema=function(n,l,d){if(!n)return null;switch(n.type){case "simple-fill":case "picture-fill":return C(n,l,d);case "simple-marker":case "picture-marker":var a=D.createMaterialKey(t.WGLGeometryType.MARKER,l);d=d?D.hydrateMaterialKey(a):a;a=E(n);return n={materialKey:d,hash:n.hash(),...a,angle:n.angle,maxVVSize:l.maxVVSize};case "simple-line":return A(n,l,d);case "text":return a=
D.createMaterialKey(t.WGLGeometryType.TEXT,l),d=d?D.hydrateMaterialKey(a):a,a=E(n),n={materialKey:d,hash:n.hash(),...a,angle:n.angle,maxVVSize:l.maxVVSize};case "label":return a=n.toJSON(),l=D.createMaterialKey(t.WGLGeometryType.LABEL,{...l,placement:a.labelPlacement}),n={materialKey:d?D.hydrateMaterialKey(l):l,hash:n.hash(),...a,labelPlacement:a.labelPlacement};case "cim":return{type:"cim",rendererKey:l.vvFlags,data:n.data,maxVVSize:l.maxVVSize};case "CIMSymbolReference":return{type:"cim",rendererKey:l.vvFlags,
data:n,maxVVSize:l.maxVVSize};case "web-style":return{...E(n),type:"web-style",hash:n.hash(),rendererKey:l.vvFlags,maxVVSize:l.maxVVSize};default:throw Error(`symbol not supported ${n.type}`);}};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/pixelBuffering":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/screenUtils ../../../../../symbols/cim/CIMSymbolHelper ../../../../../symbols/cim/Rect ../../../engine/webgl/definitions ../../graphics/graphicsUtils ../../support/cimSymbolUtils".split(" "),
function(q,t,D,E,C,A,n,l){function d(x){if(!("visualVariables"in x&&x.hasVisualVariables("size")))return 0;x=x.getVisualVariablesForType("size");if(!x[0])return 0;x=x[0];if("outline"===x.target)return 0;if("stops"===x.transformationType)return x.stops.map(g=>g.size).reduce(e,0);if("clamped-linear"===x.transformationType){let g=-Infinity,u=-Infinity;g="number"===typeof x.maxSize?x.maxSize:x.maxSize.stops.map(y=>y.size).reduce(e,0);u="number"===typeof x.minSize?x.minSize:x.minSize.stops.map(y=>y.size).reduce(e,
0);return Math.max(g,u)}if("real-world-size"===x.transformationType)return 30}function a(){a=t._asyncToGenerator(function*(x,g,u,y,z,w){if(!x||w&&"cluster"===w.type)return 0;if("heatmap"===x.type)return Math.round(D.pt2px(x.radius));if("dot-density"===x.type)return 0;if("dictionary"===x.type)return"esriGeometryPoint"===g||"esriGeometryMultipoint"===g?100:200;w=x.getSymbols();x=d(x);const B=[];for(const F of w)B.push(h(F,x,u,g,y,z));g=yield Promise.all(B);return D.pt2px(g.reduce(e,0))});return a.apply(this,
arguments)}function b(x,g){return null==x?g:x}function c(x,g,u,y,z,w){return f.apply(this,arguments)}function f(){f=t._asyncToGenerator(function*(x,g,u,y,z,w){if("simple-marker"===x.type)return g=Math.max(b(x.size,12),g),k(x)+.707*g;if("picture-marker"===x.type)return u=Math.max(b(x.height,12),g),g=b(x.width,12)*(u/b(x.height,12))/2,u/=2,k(x)+Math.sqrt(g*g+u*u);if("text"===x.type){if(u=x.text&&x.text.length){g=[];for(y=0;y<u;y++)g.push({...v,code:x.text.charCodeAt(y)});g={glyphMosaicItems:g}}else g=
{glyphMosaicItems:[v]};n.getTextSymbolSize(r,x.toJSON(),g);return Math.max(Math.abs(r[0]),Math.abs(r[1]))+Math.max(r[2],r[3])}return"simple-line"===x.type?(u=Math.max(b(x.width,.75),g)/2,x.marker?Math.max(6*x.width,2*g):u):"simple-fill"===x.type||"picture-fill"===x.type?Math.max(null==x.outline?0:b(x.outline.width,0),g)/2:"cim"===x.type?(yield l.expandSymbol({type:"cim",rendererKey:0,data:x.data,maxVVSize:g},{geometryType:y,fields:z,spatialReference:w},u),(x=E.CIMSymbolHelper.getEnvelope(x.data,u))?
Math.sqrt(x.width*x.width+x.height*x.height):0):"web-style"===x.type?c(yield x.fetchCIMSymbol(),g,u,y,z,w):0});return f.apply(this,arguments)}function h(x,g,u,y,z,w){return p.apply(this,arguments)}function p(){p=t._asyncToGenerator(function*(x,g,u,y,z,w){return x.type in m?Math.min(yield c(x,g,u,y,z,w),75):0});return p.apply(this,arguments)}function k(x){const g=b(x.xoffset,0);x=b(x.yoffset,0);return Math.sqrt(g*g+x*x)}function e(x,g){return Math.max(x,g)}const m={"simple-marker":1,"picture-marker":1,
text:0,"simple-line":0,"simple-fill":0,"picture-fill":0,cim:1,"web-style":1},r=[0,0,0,0],v={sdf:!0,code:99,metrics:A.AVERAGE_GLYPH_MOSAIC_ITEM.metrics,rect:new C(0,0,24,24),page:0,textureBinding:2};q.computePxBuffer=function(x,g,u,y,z,w){return a.apply(this,arguments)};q.getPtMaxVVSize=d;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/graphics/graphicsUtils":function(){define("exports ../../../../core/BidiText ../../../../core/maybe ../../../../core/screenUtils ../../../../geometry/Polygon ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/spatialReferenceUtils ../../engine/webgl/alignmentUtils ../../engine/webgl/definitions ../../engine/webgl/mesh/templates/shapingUtils".split(" "),
function(q,t,D,E,C,A,n,l,d,a){q.PIXEL_BUFFER=50;q.TILE_SIZE=512;q.getTextSymbolSize=function(b,c,f){var h,p,k;if(!f||0===f.glyphMosaicItems.length)return b;const e=t.bidiText(c.text)[1];c=a.shapeGlyphs(f.glyphMosaicItems,e,{scale:E.pt2px(c.font.size)/d.GLYPH_SIZE,angle:null!=(h=c.angle)?h:0,xOffset:null!=(p=c.xoffset)?p:0,yOffset:null!=(k=c.yoffset)?k:0,hAlign:l.getXAnchorDirection(c.horizontalAlignment||"center"),vAlign:l.getYAnchorDirection(c.verticalAlignment||"baseline"),maxLineWidth:Math.max(32,
Math.min(c.lineWidth||512,512)),lineHeight:d.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(c.lineHeight||1,4)),decoration:c.font.decoration||"none",isCIM:!1}).bounds;b[0]=E.pt2px(c.x-c.halfWidth);b[1]=E.pt2px(c.y-c.halfHeight);b[2]=E.pt2px(c.width);b[3]=E.pt2px(c.height);return b};q.graphicGeometryToNumber=function(b){switch(D.unwrap(b.geometry).type){case "polyline":return 1;case "polygon":case "extent":return 2}return 0};q.intersectingInternationalDateline=function(b,c){c=n.getInfo(c);if(!c)return null;
const [f,h]=c.valid;return b[2]>h?[A.create([b[0],b[1],h,b[3]]),A.create([f,b[1],f+b[2]-h,b[3]])]:b[0]<f?[A.create([f,b[1],b[2],b[3]]),A.create([h-(f-b[0]),b[1],h,b[3]])]:null};q.isMarkerSymbol=function(b){return"simple-marker"===b||"picture-marker"===b||"esriSMS"===b||"esriPMS"===b};q.isTextSymbol=function(b){return"text"===b||"esriTS"===b};q.polygonFromExtent=function(b){if(!b)return null;const {xmin:c,ymin:f,xmax:h,ymax:p,spatialReference:k}=b;return new C({rings:[[[c,f],[c,p],[h,p],[h,f],[c,f]]],
spatialReference:k})};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/rendererUtils":function(){define("exports ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/screenUtils ../../../../webgl/capabilities".split(" "),function(q,t,D,E,C,A){function n(b){return("size"===b.type||"color"===b.type||"opacity"===b.type)&&null!=b.stops}function l(b){var c=b.type;var f=b.stops;
if(8>=f.length)c=f;else if(a.warn(`Found ${f.length} Visual Variable stops, but MapView only supports ${8}. Displayed stops will be simplified.`),16<f.length){{const [g,...u]=f;var h=u.pop(),p=u[0].value,k=u[u.length-1].value,e=(k-p)/6;const y=[];for(;p<k;p+=e){for(var m=0;p>=u[m].value;)m++;var r=u[m],v=f[m-1],x=p-v.value;r=r.value===v.value?1:x/(r.value-v.value);"color"===c?(v=u[m],m=f[m-1],x=v.color.clone(),x.r=(1-r)*m.color.r+r*x.r,x.g=(1-r)*m.color.g+r*x.g,x.b=(1-r)*m.color.b+r*x.b,x.a=(1-r)*
m.color.a+r*x.a,y.push({value:p,color:x,label:v.label})):"size"===c?(v=u[m],x=f[m-1],m=C.toPt(v.size),x=C.toPt(x.size),y.push({value:p,size:(1-r)*x+r*m,label:v.label})):(v=u[m],y.push({value:p,opacity:(1-r)*f[m-1].opacity+r*v.opacity,label:v.label}))}c=[g,...y,h]}}else{{const [g,...u]=f;for(c=u.pop();6<u.length;){h=f=0;for(k=1;k<u.length;k++)e=Math.abs(u[k].value-u[k-1].value),e>h&&(h=e,f=k);u.splice(f,1)}c=[g,...u,c]}}b.stops=c;return b}function d(){if(D("heatmap-force-raster"))return"raster";const {supportsTextureFloat:b,
supportsTextureHalfFloat:c,supportsColorBufferFloat:f,supportsColorBufferFloatBlend:h,supportsColorBufferHalfFloat:p}=A.getWebGLCapabilities("2d");return b&&f&&h||c&&p?"symbol":D("heatmap-allow-raster-fallback")?"raster":"none"}const a=E.getLogger("esri.views.2d.layers.features.support.rendererUtils");q.getSupportedHeatmapRenderer=d;q.isRendererSupported=function(b){if(!b)return!0;switch(b.type){case "dot-density":if(!A.getWebGLCapabilities("2d").supportsTextureFloat)return a.error(new t("webgl-missing-extension",
"Missing WebGL extension OES_Texture_Float which is required for DotDensity")),!1;break;case "heatmap":if(b=d(),"none"===b||"raster"===b&&!D("heatmap-force-raster")){const c=A.getWebGLCapabilities("2d"),f=["supportsTextureFloat","supportsTextureHalfFloat","supportsColorBufferFloat","supportsColorBufferFloatBlend","supportsColorBufferHalfFloat"].filter(h=>!c[h]).join(", ");if("none"===b)return a.errorOnce(new t("webgl-missing-extension",`Missing WebGL${c.type} requirements for Heatmap: ${f}`)),!1;
"raster"===b&&a.warnOnce(`Missing WebGL${c.type} requirements for accelerated Heatmap: ${f}. Feature support may be limited.`)}}return!0};q.simplifyVVRenderer=b=>{if(!("visualVariables"in b&&b.visualVariables&&b.visualVariables.length))return b;b=b.clone();const c=b.visualVariables.map(f=>n(f)?l(f):f);b.visualVariables=c;return b};q.simplifyVisualVariables=function(b){return b.map(c=>n(c)?l(c.clone()):c)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/layers/support/clusterUtils":function(){define("exports ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/MD5 ../../../../renderers/visualVariables/SizeVariable ../../../../renderers/visualVariables/support/SizeStop ../../engine/LevelDependentSizeVariable".split(" "),function(q,t,D,E,C,A,n,l,d){function a(v,x,g){switch(v){case "avg":case "avg_angle":return`cluster_avg_${x}`;case "mode":return`cluster_type_${x}`;case "norm":return v=
x.toLowerCase()+",norm:field,"+g.toLowerCase(),"cluster_avg_"+A.createMD5Hash(v)}}function b(v,x){const {name:g,outStatistic:u}=x,{onStatisticField:y,onStatisticValueExpression:z,statisticType:w}=u;z?(x=A.createMD5Hash(z.toLowerCase()),v.push({name:g,outStatistic:{onStatisticField:x,onStatisticValueExpression:z,statisticType:w}})):y?v.push({name:g,outStatistic:{onStatisticField:y,statisticType:w}}):h.error(new t("mapview-unsupported-field","Unable to handle field",{field:x}))}function c(v,x,g){const u=
A.createMD5Hash(x),y="mode"===g?`cluster_type_${u}`:`cluster_avg_${u}`;v.some(z=>z.name===y)||v.push({name:y,outStatistic:{onStatisticField:u,onStatisticValueExpression:x,statisticType:g}});return y}function f(v,x,g,u){if("cluster_count"===x||v.some(z=>z.name===x))return x;const y=a(g,x,u);v.some(z=>z.name===y)||("norm"===g?v.push({name:y,outStatistic:{onStatisticField:x,onStatisticNormalizationField:u,statisticType:g}}):v.push({name:y,outStatistic:{onStatisticField:x,statisticType:g}}));return y}
const h=E.getLogger("esri.views.2d.layers.support.clusterUtils");D.add("esri-cluster-arcade-enabled",!0);const p=D("esri-cluster-arcade-enabled"),k=v=>{for(const x of v)if("size"===x.type)return x;return null},e=v=>{for(const x of v)if("cluster_count"===x.field)return!0;return!1},m=(v,x)=>{const g=[new l({value:0,size:0}),new l({value:1})];if(C.isNone(x))return new n({field:"cluster_count",stops:[...g,new l({value:2,size:0})]});const u=Object.keys(x).reduce((y,z)=>({...y,[z]:[...g,new l({value:Math.max(2,
x[z].minValue),size:v.clusterMinSize}),new l({value:Math.max(3,x[z].maxValue),size:v.clusterMaxSize})]}),{});return new d.LevelDependentSizeVariable({field:"cluster_count",levels:u})},r=v=>{const x=g=>h.error(new t("Unsupported-renderer",g,{renderer:v}));if("unique-value"===v.type){if(v.field2||v.field3)return x("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1}else if("class-breaks"===v.type){if(v.normalizationField){const g=v.normalizationType;if("field"!==g)return x(`FeatureReductionCluster does not support a normalizationType of ${g}`),
!1}}else if("simple"!==v.type)return x(`FeatureReductionCluster does not support renderers of type ${v.type}`),!1;if(!p){if("valueExpression"in v&&v.valueExpression)return x("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in v&&v.visualVariables||[]).some(g=>!!("valueExpression"in g&&g.valueExpression)))return x("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),
!1}return!0};q.convertAggregateFieldFromPublic=b;q.createClusterCountSizeVariable=m;q.createClusterRenderer=(v,x,g,u)=>{x=x.clone();if(!r(x))return x;if(g.fields)for(var y of g.fields)b(v,y);if("visualVariables"in x){y=(x.visualVariables||[]).filter(w=>"$view.scale"!==w.valueExpression);const z=k(y);y.forEach(w=>{"rotation"===w.type?w.field?w.field=f(v,w.field,"avg_angle"):w.valueExpression&&(w.field=c(v,w.valueExpression,"avg_angle"),w.valueExpression=null):w.normalizationField?(w.field=f(v,w.field,
"norm",w.normalizationField),w.normalizationField=null):w.field?w.field=f(v,w.field,"avg"):(w.field=c(v,w.valueExpression,"avg"),w.valueExpression=null)});C.isNone(z)&&!e(y)&&(y.push(m(g,u)),x.dynamicClusterSize=!0);x.visualVariables=y}switch(x.type){case "unique-value":x.field?x.field=f(v,x.field,"mode"):x.valueExpression&&(x.field=c(v,x.valueExpression,"mode"),x.valueExpression=null);break;case "class-breaks":x.normalizationField?(x.field=f(v,x.field,"norm",x.normalizationField),x.normalizationField=
null):x.field?x.field=f(v,x.field,"avg"):(x.field=c(v,x.valueExpression,"avg"),x.valueExpression=null)}return x};q.findSizeVV=k;q.hasClusterCountVV=e;q.isClusterCompatibleRenderer=r;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/MD5":function(){define(["exports"],function(q){function t(l,d){const a=(l&65535)+(d&65535);return(l>>16)+(d>>16)+(a>>16)<<16|a&65535}function D(l,d,a,b,c,f){l=t(t(d,l),t(b,f));return t(l<<c|l>>>32-c,a)}function E(l,d,
a,b,c,f,h){return D(d&a|~d&b,l,d,c,f,h)}function C(l,d,a,b,c,f,h){return D(d&b|a&~b,l,d,c,f,h)}function A(l,d,a,b,c,f,h){return D(a^(d|~b),l,d,c,f,h)}const n={Base64:0,Hex:1,String:2,Raw:3};q.createMD5Hash=function(l,d=n.Hex){d=d||n.Base64;var a=[];for(let c=0,f=8*l.length;c<f;c+=8)a[c>>5]|=(l.charCodeAt(c/8)&255)<<c%32;{l=8*l.length;a[l>>5]|=128<<l%32;a[(l+64>>>9<<4)+14]=l;l=1732584193;var b=-271733879;let c=-1732584194,f=271733878;for(let h=0;h<a.length;h+=16){const p=l,k=b,e=c,m=f;l=E(l,b,c,f,
a[h+0],7,-680876936);f=E(f,l,b,c,a[h+1],12,-389564586);c=E(c,f,l,b,a[h+2],17,606105819);b=E(b,c,f,l,a[h+3],22,-1044525330);l=E(l,b,c,f,a[h+4],7,-176418897);f=E(f,l,b,c,a[h+5],12,1200080426);c=E(c,f,l,b,a[h+6],17,-1473231341);b=E(b,c,f,l,a[h+7],22,-45705983);l=E(l,b,c,f,a[h+8],7,1770035416);f=E(f,l,b,c,a[h+9],12,-1958414417);c=E(c,f,l,b,a[h+10],17,-42063);b=E(b,c,f,l,a[h+11],22,-1990404162);l=E(l,b,c,f,a[h+12],7,1804603682);f=E(f,l,b,c,a[h+13],12,-40341101);c=E(c,f,l,b,a[h+14],17,-1502002290);b=E(b,
c,f,l,a[h+15],22,1236535329);l=C(l,b,c,f,a[h+1],5,-165796510);f=C(f,l,b,c,a[h+6],9,-1069501632);c=C(c,f,l,b,a[h+11],14,643717713);b=C(b,c,f,l,a[h+0],20,-373897302);l=C(l,b,c,f,a[h+5],5,-701558691);f=C(f,l,b,c,a[h+10],9,38016083);c=C(c,f,l,b,a[h+15],14,-660478335);b=C(b,c,f,l,a[h+4],20,-405537848);l=C(l,b,c,f,a[h+9],5,568446438);f=C(f,l,b,c,a[h+14],9,-1019803690);c=C(c,f,l,b,a[h+3],14,-187363961);b=C(b,c,f,l,a[h+8],20,1163531501);l=C(l,b,c,f,a[h+13],5,-1444681467);f=C(f,l,b,c,a[h+2],9,-51403784);c=
C(c,f,l,b,a[h+7],14,1735328473);b=C(b,c,f,l,a[h+12],20,-1926607734);l=D(b^c^f,l,b,a[h+5],4,-378558);f=D(l^b^c,f,l,a[h+8],11,-2022574463);c=D(f^l^b,c,f,a[h+11],16,1839030562);b=D(c^f^l,b,c,a[h+14],23,-35309556);l=D(b^c^f,l,b,a[h+1],4,-1530992060);f=D(l^b^c,f,l,a[h+4],11,1272893353);c=D(f^l^b,c,f,a[h+7],16,-155497632);b=D(c^f^l,b,c,a[h+10],23,-1094730640);l=D(b^c^f,l,b,a[h+13],4,681279174);f=D(l^b^c,f,l,a[h+0],11,-358537222);c=D(f^l^b,c,f,a[h+3],16,-722521979);b=D(c^f^l,b,c,a[h+6],23,76029189);l=D(b^
c^f,l,b,a[h+9],4,-640364487);f=D(l^b^c,f,l,a[h+12],11,-421815835);c=D(f^l^b,c,f,a[h+15],16,530742520);b=D(c^f^l,b,c,a[h+2],23,-995338651);l=A(l,b,c,f,a[h+0],6,-198630844);f=A(f,l,b,c,a[h+7],10,1126891415);c=A(c,f,l,b,a[h+14],15,-1416354905);b=A(b,c,f,l,a[h+5],21,-57434055);l=A(l,b,c,f,a[h+12],6,1700485571);f=A(f,l,b,c,a[h+3],10,-1894986606);c=A(c,f,l,b,a[h+10],15,-1051523);b=A(b,c,f,l,a[h+1],21,-2054922799);l=A(l,b,c,f,a[h+8],6,1873313359);f=A(f,l,b,c,a[h+15],10,-30611744);c=A(c,f,l,b,a[h+6],15,-1560198380);
b=A(b,c,f,l,a[h+13],21,1309151649);l=A(l,b,c,f,a[h+4],6,-145523070);f=A(f,l,b,c,a[h+11],10,-1120210379);c=A(c,f,l,b,a[h+2],15,718787259);b=A(b,c,f,l,a[h+9],21,-343485551);l=t(l,p);b=t(b,k);c=t(c,e);f=t(f,m)}a=[l,b,c,f]}switch(d){case n.Raw:return a;case n.Hex:d=[];for(let c=0,f=4*a.length;c<f;c++)d.push("0123456789abcdef".charAt(a[c>>2]>>c%4*8+4&15)+"0123456789abcdef".charAt(a[c>>2]>>c%4*8&15));return d=d.join("");case n.String:d=[];for(let c=0,f=32*a.length;c<f;c+=8)d.push(String.fromCharCode(a[c>>
5]>>>c%32&255));return d=d.join("");case n.Base64:d=[];for(let c=0,f=4*a.length;c<f;c+=3)for(l=(a[c>>2]>>c%4*8&255)<<16|(a[c+1>>2]>>(c+1)%4*8&255)<<8|a[c+2>>2]>>(c+2)%4*8&255,b=0;4>b;b++)8*c+6*b>32*a.length?d.push("\x3d"):d.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(l>>6*(3-b)&63));return d=d.join("")}};q.outputTypes=n;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/LevelDependentSizeVariable":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ../../../renderers/visualVariables/SizeVariable ../../../renderers/visualVariables/support/sizeVariableUtils".split(" "),
function(q,t,D,E,C,A,n,l,d,a){var b;q.LevelDependentSizeVariable=b=function(c){function f(){return c.apply(this,arguments)||this}t._inheritsLoose(f,c);var h=f.prototype;h.writeLevels=function(p,k,e){for(const m in p){k.stops=this.levels[m];break}};h.clone=function(){return new b({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:a.isSizeVariable(this.maxSize)?this.maxSize.clone():this.maxSize,
minDataValue:this.minDataValue,minSize:a.isSizeVariable(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(p=>p.clone()),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone(),levels:E.clone(this.levels)})};return f}(d);D.__decorate([C.property()],q.LevelDependentSizeVariable.prototype,"levels",void 0);
D.__decorate([l.writer("levels")],q.LevelDependentSizeVariable.prototype,"writeLevels",null);q.LevelDependentSizeVariable=b=D.__decorate([n.subclass("esri.views.2d.engine.LevelDependentSizeVariable")],q.LevelDependentSizeVariable);Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/support/util":function(){define(["exports","../../../../core/jsonMap"],function(q,t){const D=new t.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",
esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});q.analyzeRings=function(E,C,A){const n=[],l=[];let d=0,a=0;for(const b of E){E=a;let c=b[0][0],f=b[0][1];n[a++]=c;n[a++]=f;let h=0;for(let p=1;p<b.length;++p){const k=c,e=f;c=b[p][0];f=b[p][1];h+=f*k-c*e;n[a++]=c;n[a++]=f}C(h/2);0<h?(0<E-d&&(A(d,E,n,l),d=E),l.length=0):0>h?0<E-d?l.push(.5*(E-d)):a=E:a=E}0<a-d&&A(d,a,n,l)};q.canUseMajorityInterpolationOnDataSource=function(E){const {bandCount:C,
attributeTable:A,colormap:n,pixelType:l}=E.rasterInfo;return 1===C&&(null!=A||null!=n||"u8"===l||"s8"===l)};q.toJSONGeometryType=function(E){return D.toJSON(E)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/AttributeStore":function(){define("require ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/diffUtils ../../../../../layers/support/FieldsIndex ../../../engine/webgl/definitions ../../../engine/webgl/DisplayId ../../../engine/webgl/Utils ../../../engine/webgl/util/debug ../tileRenderers/support/visualVariablesUtils ../../../../webgl/enums".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c,f,h,p,k){function e(u,y){return z=>y(u(z))}const m=C.getLogger("esri.views.layers.2d.features.support.AttributeStore"),r=h.createDebugLogger(h.DEBUG_ATTR_UPDATES,m);var v=E("esri-shared-array-buffer"),x=E("esri-atomics");let g=function(){function u(z,w,B,F){this.size=0;this.texelSize=4;const {pixelType:G,layout:H,textureOnly:I}=F;this.textureOnly=I||!1;this.pixelType=G;this._ctype=w;this.layout=H;this._resetRange();this._shared=z;this.size=B;I||(this.data=this._initData(G,
B,z,w))}var y=u.prototype;y.unsetComponentAllTexels=function(z,w){const B=n.unwrap(this.data);for(let F=0;F<this.size*this.size;F++)B[F*this.texelSize+z]&=~w;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};y.setComponentAllTexels=function(z,w){const B=n.unwrap(this.data);for(let F=0;F<this.size*this.size;F++)B[F*this.texelSize+z]|=255&w;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};y.setComponent=function(z,w,B){const F=n.unwrap(this.data);for(const G of B)F[G*this.texelSize+z]|=w,
this.dirtyStart=Math.min(this.dirtyStart,G),this.dirtyEnd=Math.max(this.dirtyEnd,G)};y.setComponentTexel=function(z,w,B){n.unwrap(this.data)[B*this.texelSize+z]|=w;this.dirtyStart=Math.min(this.dirtyStart,B);this.dirtyEnd=Math.max(this.dirtyEnd,B)};y.unsetComponentTexel=function(z,w,B){n.unwrap(this.data)[B*this.texelSize+z]&=~w;this.dirtyStart=Math.min(this.dirtyStart,B);this.dirtyEnd=Math.max(this.dirtyEnd,B)};y.getData=function(z,w){z=c.getDisplayIdTexel(z);return n.unwrap(this.data)[z*this.texelSize+
w]};y.setData=function(z,w,B){z=c.getDisplayIdTexel(z);0===(this.layout&1<<w)?m.error("mapview-attributes-store","Tried to set a value for a texel's readonly component"):(this.data[z*this.texelSize+w]=B,this.dirtyStart=Math.min(this.dirtyStart,z),this.dirtyEnd=Math.max(this.dirtyEnd,z))};y.lock=function(){this.pixelType===k.PixelType.UNSIGNED_BYTE&&this._shared&&x&&"local"!==this._ctype&&Atomics.store(this.data,0,1)};y.unlock=function(){this.pixelType===k.PixelType.UNSIGNED_BYTE&&this._shared&&x&&
"local"!==this._ctype&&Atomics.store(this.data,0,0)};y.expand=function(z){this.size=z;if(!this.textureOnly){z=this._initData(this.pixelType,z,this._shared,this._ctype);const w=n.unwrap(this.data);z.set(w);this.data=z}};y.toMessage=function(){const z=this.dirtyStart,w=this.dirtyEnd;var B=this.texelSize;if(z>w)return null;this._resetRange();const F=!this._shared&&"local"!==this._ctype,G=this.pixelType,H=this.layout,I=n.unwrap(this.data);B=F&&I.slice(z*B,(w+1)*B)||null;return{start:z,end:w,data:B,pixelType:G,
layout:H}};y._initData=function(z,w,B,F){B=B&&"local"!==F?SharedArrayBuffer:ArrayBuffer;z=f.getPixelArrayCtor(z);w=new z(new B(w*w*4*z.BYTES_PER_ELEMENT));for(z=0;z<w.length;z+=4)w[z+1]=255;return w};y._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};t._createClass(u,[{key:"buffer",get:function(){return n.applySome(this.data,z=>z.buffer)}}]);return u}();return function(){function u(z,w,B=()=>{}){this._client=z;this.config=w;this._notifyChange=B;this._attributeComputeMap=new Map;
this._blocks=[];this._filters=Array(b.MAX_FILTERS);this._targetType=0;this._abortController=new AbortController;this._hasScaleExpr=!1;this._size=32;this._idsToHighlight=new Set;z=w.supportsTextureFloat?k.PixelType.FLOAT:k.PixelType.UNSIGNED_BYTE;r(`Creating AttributeStore ${v?"with":"without"} shared memory`);this._blockDescriptors=[{pixelType:k.PixelType.UNSIGNED_BYTE,layout:1},{pixelType:k.PixelType.UNSIGNED_BYTE,layout:15,textureOnly:!0},{pixelType:k.PixelType.UNSIGNED_BYTE,layout:15,textureOnly:!0},
{pixelType:z,layout:15},{pixelType:z,layout:15},{pixelType:z,layout:15},{pixelType:z,layout:15}];this._blocks=this._blockDescriptors.map(()=>null)}var y=u.prototype;y.destroy=function(){this._abortController.abort()};y.isUpdating=function(){return!!this._currUpdate||!!this._nextUpdate};y.update=function(z,w){this.config=w;w=w.schema.processors[0].storage;const B=d.diff(this._schema,w);if(z.targets.feature||z.targets.aggregate)z.storage.data=!0;if(B&&(E("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:",
B),z.storage.data=!0,this._schema=w,this._attributeComputeMap.clear(),!n.isNone(w))){switch(w.target){case "feature":this._targetType=c.DISPLAY_ID_TYPE_FEATURE;break;case "aggregate":this._targetType=c.DISPLAY_ID_TYPE_AGGREGATE}if("subtype"===w.type)for(const F in w.mapping){if(z=w.mapping[F],n.isSome(z)&&n.isSome(z.vvMapping))for(const G of z.vvMapping)this._bindAttribute(G)}else{if(n.isSome(w.vvMapping))for(const F of w.vvMapping)this._bindAttribute(F);if(n.isSome(w.attributeMapping))for(const F of w.attributeMapping)this._bindAttribute(F)}}};
y.onTileData=function(z,w){if(!n.isNone(w.addOrUpdate))for(z=w.addOrUpdate.getCursor();z.next();)w=z.getDisplayId(),this.setAttributeData(w,z)};y.invalidateResources=function(){this._createResourcesPromise=null;this._abortController.abort();this._abortController=new AbortController};y.setHighlight=function(){var z=t._asyncToGenerator(function*(w,B){const F=this._getBlock(0);B=B.map(G=>c.getDisplayIdTexel(G));F.lock();F.unsetComponentAllTexels(0,1);F.setComponent(0,1,B);F.unlock();this._idsToHighlight.clear();
for(const G of w)this._idsToHighlight.add(G);yield this.sendUpdates()});return function(w,B){return z.apply(this,arguments)}}();y.updateFilters=function(){var z=t._asyncToGenerator(function*(w,B,F){const {service:G,spatialReference:H}=F;({filters:B}=B);B=B.map((I,L)=>this._updateFilter(I,L,G,H));(yield Promise.all(B)).some(I=>I)&&(w.storage.filters=!0,E("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:","Filters changed"))});return function(w,B,F){return z.apply(this,arguments)}}();
y.setData=function(z,w,B,F){const G=c.getDisplayIdTexel(z);this._ensureSizeForTexel(G);this._getBlock(w).setData(z,B,F)};y.getData=function(z,w,B){return this._getBlock(w).getData(z,B)};y.getHighlightFlag=function(z){return this._idsToHighlight.has(z)?b.HIGHLIGHT_FLAG:0};y.unsetAttributeData=function(z){z=c.getDisplayIdTexel(z);this._getBlock(0).setData(z,0,0)};y.setAttributeData=function(z,w){const B=c.getDisplayIdTexel(z);this._ensureSizeForTexel(B);this._getBlock(0).setData(B,0,this.getFilterFlags(w));
if(this._targetType===c.getDisplayIdType(z)){z=this._attributeComputeMap;var F=this.config.supportsTextureFloat?1:2;z.size&&z.forEach((G,H)=>{const I=H*F%4;H=this._getBlock(Math.floor(H*F/4)+b.ATTRIBUTE_DATA_VV);G=G(w);if(this.config.supportsTextureFloat)H.setData(B,I,G);else if(G===b.NAN_MAGIC_NUMBER)H.setData(B,I,255),H.setData(B,I+1,255);else{G=A.clamp(Math.round(G),-32767,32766)+32768;const L=(G&65280)>>8;H.setData(B,I,G&255);H.setData(B,I+1,L)}})}};y.sendUpdates=function(){E("esri-2d-update-debug")&&
console.debug("AttributeStore::sendUpdate");this._notifyChange();if(this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=l.createResolver(),this._nextUpdate.promise;const z={blocks:this._blocks.map(w=>n.isSome(w)?w.toMessage():null)};return this._currUpdate=this._createResources().then(()=>{var w=()=>{this._currUpdate=null;if(this._nextUpdate){const B=this._nextUpdate;this._nextUpdate=null;this.sendUpdates().then(()=>B.resolve())}else E("esri-2d-update-debug")&&
console.debug("AttributeStore::sendUpdate::No additional updates queued");this._notifyChange()};E("esri-2d-update-debug")&&console.debug("AttributeStore::sendUpdate::client.update");w=this._client.update(z,this._signal).then(w).catch(w);this._client.render(this._signal);return w}).catch(w=>{if(l.isAbortError(w))return this._createResourcesPromise=null,this._createResources();this._notifyChange();m.error(new D("mapview-attribute-store","Encountered an error during client update",w))})};y._ensureSizeForTexel=
function(z){for(;z>=this._size*this._size&&!this._expand(););};y._bindAttribute=function(z){function w(){return z.normalizationField?G=>{const H=G.readAttribute(z.normalizationField);return H?G.readAttribute(z.field)/H:null}:G=>G.readAttribute(z.field)}function B(){z.normalizationField&&m.warn("mapview-arcade","Ignoring normalizationField specified with an arcade expression which is not supported.");return G=>G.getComputedNumericAtIndex(z.fieldIndex)}let F;if(null!=z.fieldIndex)F=B();else if(z.field)F=
w();else return;z.valueRepresentation&&(F=e(F,G=>p.getVisualVariableSizeValueRepresentationRatio(G,z.valueRepresentation)));this._attributeComputeMap.set(z.binding,e(F,G=>null===G||isNaN(G)||Infinity===G?b.NAN_MAGIC_NUMBER:G))};y._createResources=function(){if(n.isSome(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(b.ATTRIBUTE_DATA_ANIMATION);this._getBlock(b.ATTRIBUTE_DATA_GPGPU);r("Initializing AttributeStore");var z={shared:v&&"local"!==this._client.type,size:this._size,
blocks:n.mapMany(this._blocks,w=>({textureOnly:w.textureOnly,buffer:w.buffer,pixelType:w.pixelType}))};this._createResourcesPromise=z=this._client.initialize(z,this._signal).catch(w=>{l.isAbortError(w)?this._createResourcesPromise=null:m.error(new D("mapview-attribute-store","Encountered an error during client initialization",w))});z.then(()=>n.isNone(this._createResourcesPromise)?this._createResources():void 0);return z};y._getBlock=function(z){var w=this._blocks[z];if(n.isSome(w))return w;r(`Initializing AttributeBlock at index ${z}`);
w=new g(v,this._client.type,this._size,this._blockDescriptors[z]);this._blocks[z]=w;this._createResourcesPromise=null;return w};y._expand=function(){if(this._size<this.config.maxTextureSize){const z=this._size<<=1;r("Expanding block size to",z,this._blocks);n.forEachSome(this._blocks,w=>w.expand(z));this._createResourcesPromise=null;this._size=z;return 0}m.error(new D("mapview-limitations","Maximum number of onscreen features exceeded."));return-1};y._updateFilter=function(){var z=t._asyncToGenerator(function*(w,
B,F,G){const H=this._filters[B],I=n.isSome(H)&&H.hash;if(!H&&!w||I===JSON.stringify(w))return!1;if(n.isNone(w)){if(!H)return!1;w=1<<B+1;F=this._getBlock(0);this._filters[B]=null;F.setComponentAllTexels(0,w);this.sendUpdates();return!0}yield(yield this._getFilter(B,F)).update(w,G);return!0});return function(w,B,F,G){return z.apply(this,arguments)}}();y._getFilter=function(){var z=t._asyncToGenerator(function*(w,B){var F=this._filters[w];if(n.isSome(F))return F;({default:F}=yield new Promise((G,H)=>
q(["./FeatureFilter"],I=>G(Object.freeze(Object.defineProperty({__proto__:null,default:I},Symbol.toStringTag,{value:"Module"}))),H)));B=new F({geometryType:B.geometryType,hasM:!1,hasZ:!1,timeInfo:B.timeInfo,fieldsIndex:new a(B.fields)});return this._filters[w]=B});return function(w,B){return z.apply(this,arguments)}}();y.isVisible=function(z){return!!(this._getBlock(0).getData(z,0)&2)};y.getFilterFlags=function(z){let w=0;var B=c.getDisplayIdFilterMask(z.getDisplayId());for(let G=0;G<this._filters.length;G++){var F=
this._filters[G];F=!(B&1<<G)||n.isNone(F)||F.check(z);w|=(F?1:0)<<G}B=0;this._idsToHighlight.size&&(z=z.getObjectId(),B=this.getHighlightFlag(z));return w<<1|B};t._createClass(u,[{key:"hasScaleExpr",get:function(){return this._hasScaleExpr}},{key:"_signal",get:function(){return this._abortController.signal}},{key:"hasHighlight",get:function(){return 0<this._idsToHighlight.size}}]);return u}()})},"esri/views/2d/engine/webgl/util/debug":function(){define(["exports"],function(q){q.DEBUG_ATTR_UPDATES=
!1;q.createDebugLogger=(t,D)=>t&&((...E)=>D.warn("DEBUG:",...E))||(()=>null);Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../engine/webgl/color ../../../../engine/webgl/definitions ../../../../engine/webgl/enums ../../../../engine/webgl/visualVariablesUtils".split(" "),function(q,
t,D,E,C,A,n){function l(p){return{value:p.value,size:D.toPt(p.size)}}function d(p){return p.map(k=>l(k))}function a(p){return"string"===typeof p||"number"===typeof p?D.toPt(p):{type:"size",expression:p.expression,stops:d(p.stops)}}function b(p){const k={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if("string"===typeof p.field)if(p.stops){if(8<p.stops.length)return null;p=p.stops;for(var e=0;8>e;++e){const m=p[Math.min(e,p.length-1)];k.values[e]=m.value;k.opacities[e]=m.opacity}}else return null;
else if(p.stops&&0<=p.stops.length)for(p=p.stops&&0<=p.stops.length&&p.stops[0].opacity,e=0;8>e;e++)k.values[e]=Infinity,k.opacities[e]=p;else return null;return k}function c(p,k,e){p[4*k]=e.r/255;p[4*k+1]=e.g/255;p[4*k+2]=e.b/255;p[4*k+3]=e.a}function f(p){if(t.isNone(p)||p.normalizationField)return null;const k={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if("string"===typeof p.field)if(p.stops){if(8<p.stops.length)return null;k.field=
p.field;p=p.stops;for(var e=0;8>e;++e){const m=p[Math.min(e,p.length-1)];k.values[e]=m.value;c(k.colors,e,m.color)}}else return null;else if(p.stops&&0<=p.stops.length)for(p=p.stops&&0<=p.stops.length&&p.stops[0].color,e=0;8>e;e++)k.values[e]=Infinity,c(k.colors,e,p);else return null;for(p=0;32>p;p+=4)E.premultiplyAlpha(k.colors,p,!0);return k}const h=p=>{const k=[],e=[];p=d(p);const m=p.length;for(let r=0;6>r;r++){const v=p[Math.min(r,m-1)];k.push(v.value);e.push(null==v.size?C.NAN_MAGIC_NUMBER:
D.pt2px(v.size))}return{values:new Float32Array(k),sizes:new Float32Array(e)}};q.convertColorVariable=f;q.convertVisualVariables=function(p){const k=p&&0<p.length?{}:null,e=k?{}:null;if(!k)return{vvFields:k,vvRanges:e};for(const m of p)if(m.field&&(k[m.type]=m.field),"size"===m.type)switch(e.size||(e.size={}),p=m,n.getTypeOfSizeVisualVariable(p)){case A.WGLVVFlag.SIZE_MINMAX_VALUE:e.size.minMaxValue={minDataValue:p.minDataValue,maxDataValue:p.maxDataValue,minSize:a(p.minSize),maxSize:a(p.maxSize)};
break;case A.WGLVVFlag.SIZE_SCALE_STOPS:e.size.scaleStops={stops:d(p.stops)};break;case A.WGLVVFlag.SIZE_FIELD_STOPS:if(p.levels){const r={};for(const v in p.levels)r[v]=h(p.levels[v]);e.size.fieldStops={type:"level-dependent",levels:r}}else e.size.fieldStops={type:"static",...h(p.stops)};break;case A.WGLVVFlag.SIZE_UNIT_VALUE:e.size.unitValue={unit:p.valueUnit,valueRepresentation:p.valueRepresentation}}else"color"===m.type?e.color=f(m):"opacity"===m.type?e.opacity=b(m):"rotation"===m.type&&(e.rotation=
{type:m.rotationType});return{vvFields:k,vvRanges:e}};q.getVisualVariableSizeValueRepresentationRatio=function(p,k){if(!p||!k)return p;switch(k){case "radius":case "distance":return 2*p;case "area":return Math.sqrt(p)}return p};q.getVisualVariablesFields=function(p){const k=p&&0<p.length?{}:null;k&&p.forEach(e=>{const m=e.type;e.field&&(k[m]=e.field)});return k};q.normalizeSizeElement=a;q.normalizeSizeStops=d;q.stopToSizeStop=l;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/layers/features/support/ComputedAttributeStorage":function(){define(["exports","../../../engine/webgl/DisplayId","./DisplayIdGenerator","./StaticBitSet"],function(q,t,D,E){function C(n,l,d){if(!(n.length>l))for(;n.length<=l;)n.push(d)}let A=function(){function n(){this._numerics=[];this._strings=[];this._idGenerator=new D.DisplayIdGenerator;this._allocatedSize=256;this._bitsets=[];this._instanceIds=[];this._bounds=[]}var l=n.prototype;l.createBitset=function(){const d=this._bitsets.length;
this._bitsets.push(E.StaticBitSet.create(this._allocatedSize,t.DISPLAY_ID_TEXEL_MASK));return d+1};l.getBitset=function(d){return this._bitsets[d-1]};l._expand=function(){this._allocatedSize<<=1;for(const d of this._bitsets)d.resize(this._allocatedSize)};l._ensureNumeric=function(d,a){this._numerics[d]||(this._numerics[d]=[]);C(this._numerics[d],a,0)};l._ensureInstanceId=function(d){C(this._instanceIds,d,0)};l._ensureString=function(d,a){this._strings[d]||(this._strings[d]=[]);C(this._strings[d],
a,null)};l.createDisplayId=function(d=!1){const a=this._idGenerator.createId();a>this._allocatedSize&&this._expand();return t.createDisplayId(a,d)};l.releaseDisplayId=function(d){for(const a of this._bitsets)a.unset(d);return this._idGenerator.releaseId(d&t.DISPLAY_ID_TEXEL_MASK)};l.getComputedNumeric=function(d,a){return this.getComputedNumericAtIndex(d&t.DISPLAY_ID_TEXEL_MASK,0)};l.setComputedNumeric=function(d,a,b){return this.setComputedNumericAtIndex(d&t.DISPLAY_ID_TEXEL_MASK,b,0)};l.getComputedString=
function(d,a){return this.getComputedStringAtIndex(d&t.DISPLAY_ID_TEXEL_MASK,0)};l.setComputedString=function(d,a,b){return this.setComputedStringAtIndex(d&t.DISPLAY_ID_TEXEL_MASK,0,b)};l.getComputedNumericAtIndex=function(d,a){d&=t.DISPLAY_ID_TEXEL_MASK;this._ensureNumeric(a,d);return this._numerics[a][d]};l.setComputedNumericAtIndex=function(d,a,b){d&=t.DISPLAY_ID_TEXEL_MASK;this._ensureNumeric(a,d);this._numerics[a][d]=b};l.getInstanceId=function(d){d&=t.DISPLAY_ID_TEXEL_MASK;this._ensureInstanceId(d);
return this._instanceIds[d]};l.setInstanceId=function(d,a){d&=t.DISPLAY_ID_TEXEL_MASK;this._ensureInstanceId(d);this._instanceIds[d]=a};l.getComputedStringAtIndex=function(d,a){d&=t.DISPLAY_ID_TEXEL_MASK;this._ensureString(a,d);return this._strings[a][d]};l.setComputedStringAtIndex=function(d,a,b){d&=t.DISPLAY_ID_TEXEL_MASK;this._ensureString(a,d);this._strings[a][d]=b};l.getXMin=function(d){return this._bounds[4*(d&t.DISPLAY_ID_TEXEL_MASK)]};l.getYMin=function(d){return this._bounds[4*(d&t.DISPLAY_ID_TEXEL_MASK)+
1]};l.getXMax=function(d){return this._bounds[4*(d&t.DISPLAY_ID_TEXEL_MASK)+2]};l.getYMax=function(d){return this._bounds[4*(d&t.DISPLAY_ID_TEXEL_MASK)+3]};l.setBounds=function(d,a){a=a.readHydratedGeometry();if(!a||!a.coords.length)return!1;let b=Infinity,c=Infinity,f=-Infinity,h=-Infinity;a.forEachVertex((p,k)=>{b=Math.min(b,p);c=Math.min(c,k);f=Math.max(f,p);h=Math.max(h,k)});d&=t.DISPLAY_ID_TEXEL_MASK;C(this._bounds,4*d+4,0);this._bounds[4*d]=b;this._bounds[4*d+1]=c;this._bounds[4*d+2]=f;this._bounds[4*
d+3]=h;return!0};return n}();q.ComputedAttributeStorage=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/DisplayIdGenerator":function(){define(["exports","../../../engine/webgl/DisplayId"],function(q,t){let D=function(){function E(){this._freeIds=[];this._idCounter=1}var C=E.prototype;C.createId=function(A=!1){return t.createDisplayId(this._getFreeId(),A)};C.releaseId=function(A){this._freeIds.push(A)};C._getFreeId=
function(){return this._freeIds.length?this._freeIds.pop():this._idCounter++};return E}();q.DisplayIdGenerator=D;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/GraphicsReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry/support/jsonUtils ../../../../../layers/graphics/featureConversionUtils ./FeatureSetReader ./FeatureSetReaderJSON".split(" "),function(q,t,D,E,
C,A){A=function(n){function l(a,b){return n.call(this,a,b,null)||this}t._inheritsLoose(l,n);l.from=function(a,b){const c=C.FeatureSetReader.createInstance(),f=[];a=a.filter(h=>!!h.geometry);for(const h of a)a=D.getJsonType(h.geometry),E.convertFromGraphics(f,[h],a,!1,!1,b);return new l(c,f)};var d=l.prototype;d.readGraphic=function(){return this._current};d.getCursor=function(){return this.copy()};d.copy=function(){const a=new l(this.instance,this._features);this.copyInto(a);return a};t._createClass(l,
[{key:"geometryType",get:function(){const a=this._current;return a?a.geometryType:null}},{key:"insertAfter",get:function(){return this._current.insertAfter}}]);return l}(A.FeatureSetReaderJSON);q.GraphicsReader=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/FeatureSetReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry ../../../../../core/has ../../../../../core/maybe ../../../../../layers/graphics/centroid ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedGeometry ./StaticBitSet ../../../../../geometry/support/jsonUtils".split(" "),
function(q,t,D,E,C,A,n,l,d,a){var b,c,f;let h=0;D=null!=(b=E("featurelayer-simplify-thresholds"))?b:[.5,.5,.5,.5];const p=D[0],k=D[1],e=D[2],m=D[3];b=null!=(c=E("featurelayer-simplify-payload-size-factors"))?c:[1,2,4];const r=b[0],v=b[1],x=b[2],g=null!=(f=E("featurelayer-simplify-mobile-factor"))?f:2,u=E("esri-mobile");E=function(){function y(w,B){this.type="FeatureSetReader";this.arcadeDeclaredClass="esri.arcade.Feature";this.seen=!1;this._ty=this._tx=this.instance=0;this._sy=this._sx=1;this._deleted=
null;this._joined=[];this._objectIdToIndex=null;this._level=0;this.instance=w;this._layerSchema=B}y.createInstance=function(){h++;return h=65535<h?0:h};var z=y.prototype;z.getAreaSimplificationThreshold=function(w,B){let F=1;const G=u?g:1;4E6<B?F=x*G:1E6<B?F=v*G:5E5<B?F=r*G:1E5<B&&(F=G);B=0;4E3<w?B=m*F:2E3<w?B=e*F:100<w?B=k:15<w&&(B=p);w=8;4>this._level?w=1:5>this._level?w=2:6>this._level&&(w=4);return B*w};z.setArcadeSpatialReference=function(w){this._arcadeSpatialReference=w};z.attachStorage=function(w){this._storage=
w};z.getQuantizationTransform=function(){throw Error("Unable to find transform for featureSet");};z.getStorage=function(){return this._storage};z.getComputedNumeric=function(w){return this.getComputedNumericAtIndex(0)};z.setComputedNumeric=function(w,B){return this.setComputedNumericAtIndex(B,0)};z.getComputedString=function(w){return this.getComputedStringAtIndex(0)};z.setComputedString=function(w,B){return this.setComputedStringAtIndex(0,B)};z.getComputedNumericAtIndex=function(w){return this._storage.getComputedNumericAtIndex(this.getDisplayId(),
w)};z.setComputedNumericAtIndex=function(w,B){this._storage.setComputedNumericAtIndex(this.getDisplayId(),w,B)};z.getComputedStringAtIndex=function(w){return this._storage.getComputedStringAtIndex(this.getDisplayId(),w)};z.setComputedStringAtIndex=function(w,B){return this._storage.setComputedStringAtIndex(this.getDisplayId(),w,B)};z.transform=function(w,B,F,G){const H=this.copy();H._tx+=w;H._ty+=B;H._sx*=F;H._sy*=G;return H};z.readAttribute=function(w,B=!1){var F=this._readAttribute(w,B);if(void 0!==
F)return F;for(const G of this._joined)if(G.setIndex(this.getIndex()),F=G._readAttribute(w,B),void 0!==F)return F};z.readAttributes=function(){const w=this._readAttributes();for(const B of this._joined){B.setIndex(this.getIndex());const F=B._readAttributes();for(const G of Object.keys(F))w[G]=F[G]}return w};z.joinAttributes=function(w){this._joined.push(w)};z.readArcadeFeature=function(){return this};z.geometry=function(){var w=this.readHydratedGeometry();w=n.convertToGeometry(w,this.geometryType,
this.hasZ,this.hasM);if(w=a.fromJSON(w))w.spatialReference=this._arcadeSpatialReference;return w};z.field=function(w){if(this.hasField(w))return this.readAttribute(w,!0);for(const B of this._joined)if(B.setIndex(this.getIndex()),B.hasField(w))return B._readAttribute(w,!0);throw Error(`Field ${w} does not exist`);};z.setField=function(w,B){throw Error("Unable to update feature attribute values, feature is readonly");};z.keys=function(){return this.getFieldNames()};z.castToText=function(){return JSON.stringify(this.readLegacyFeature())};
z.gdbVersion=function(){return null};z.fullSchema=function(){return this._layerSchema};z.castAsJson=function(w=null){return{attributes:this._readAttributes(),geometry:!0===(null==w?void 0:w.keepGeometryType)?this.geometry():this.geometry().toJSON()}};z.castAsJsonAsync=function(w,B=null){return Promise.resolve(this.castAsJson(B))};z.removeIds=function(w){if(C.isNone(this._objectIdToIndex)){var B=new Map;const F=this.getCursor();for(;F.next();)B.set(F.getObjectId(),F.getIndex());this._objectIdToIndex=
B}B=this._objectIdToIndex;for(const F of w)B.has(F)&&this.removeAtIndex(B.get(F))};z.removeAtIndex=function(w){C.isNone(this._deleted)&&(this._deleted=d.StaticBitSet.create(this.getSize()));this._deleted.set(w)};z.readGeometryForDisplay=function(){return this.readUnquantizedGeometry(!0)};z.readLegacyGeometryForDisplay=function(){return this.readLegacyGeometry(!0)};z.features=function*(){const w=this.getCursor();for(;w.next();)yield w.readOptimizedFeature()};z._getExists=function(){return C.isNone(this._deleted)||
!this._deleted.has(this.getIndex())};z._computeCentroid=function(){if("esriGeometryPolygon"!==this.geometryType)return null;const w=this.readUnquantizedGeometry();if(!w||w.hasIndeterminateRingOrder)return null;const B=C.unwrapOr(this.getQuantizationTransform(),null);return A.getCentroidOptimizedGeometry(new l,w,this.hasM,this.hasZ,B)};z.copyInto=function(w){w.seen=this.seen;w._storage=this._storage;w._arcadeSpatialReference=this._arcadeSpatialReference;w._joined=this._joined;w._tx=this._tx;w._ty=
this._ty;w._sx=this._sx;w._sy=this._sy;w._deleted=this._deleted;w._objectIdToIndex=this._objectIdToIndex};t._createClass(y,[{key:"isEmpty",get:function(){return C.isSome(this._deleted)&&this._deleted.countSet()===this.getSize()}},{key:"level",set:function(w){this._level=w}}]);return y}();q.FeatureSetReader=E;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/centroid":function(){define(["exports","../../core/maybe"],function(q,t){function D(C,
A,n,l,d,a,b=1){a=d?a?4:3:a?3:2;let c=n,f=n+a,h=0,p=0,k=n=0,e=0;for(let m=0,r=l-1;m<r;m++,c+=a,f+=a){l=A[c];const v=A[c+1],x=A[c+2],g=A[f],u=A[f+1],y=A[f+2];let z=l*u-g*v;k+=z;h+=(l+g)*z;p+=(v+u)*z;d&&(z=l*y-g*x,n+=(x+y)*z,e+=z);l<C[0]&&(C[0]=l);l>C[1]&&(C[1]=l);v<C[2]&&(C[2]=v);v>C[3]&&(C[3]=v);d&&(x<C[4]&&(C[4]=x),x>C[5]&&(C[5]=x))}0<k*b&&(k*=-1);0<e*b&&(e*=-1);if(!k)return null;C=[h,p,.5*k];d&&(C[3]=n,C[4]=.5*e);return C}function E(C,A,n,l,d){d=l?d?4:3:d?3:2;let a=A,b=A+d,c=0,f=0,h=0,p=0;for(let r=
0,v=n-1;r<v;r++,a+=d,b+=d){var k=C[a];const x=C[a+1],g=C[a+2],u=C[b],y=C[b+1],z=C[b+2];if(l){{var e=u-k;var m=y-x;const w=z-g;e=Math.sqrt(e*e+m*m+w*w)}}else e=u-k,m=y-x,e=Math.sqrt(e*e+m*m);e&&(c+=e,l?(k=[k+.5*(u-k),x+.5*(y-x),g+.5*(z-g)],f+=e*k[0],h+=e*k[1],p+=e*k[2]):(k=[k+.5*(u-k),x+.5*(y-x)],f+=e*k[0],h+=e*k[1]))}return 0<c?l?[f/c,h/c,p/c]:[f/c,h/c]:0<n?l?[C[A],C[A+1],C[A+2]]:[C[A],C[A+1]]:null}q.getCentroidOptimizedGeometry=function(C,A,n,l,d){if(t.isNone(A)||!A.lengths.length)return null;const a=
"upperLeft"===(null==d?void 0:d.originPosition)?-1:1;C.lengths.length&&(C.lengths.length=0);C.coords.length&&(C.coords.length=0);d=C.coords;const b=[],c=n?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:f,coords:h}=A,p=n?l?4:3:l?3:2;let k=0;for(var e of f){const m=D(c,h,k,e,n,l,a);m&&b.push(m);
k+=e*p}b.sort((m,r)=>{let v=a*m[2]-a*r[2];0===v&&n&&(v=m[4]-r[4]);return v});b.length&&(e=6*b[0][2],d[0]=b[0][0]/e,d[1]=b[0][1]/e,n&&(e=6*b[0][4],d[2]=0!==e?b[0][3]/e:0),d[0]<c[0]||d[0]>c[1]||d[1]<c[2]||d[1]>c[3]||n&&(d[2]<c[4]||d[2]>c[5]))&&(d.length=0);if(!d.length)if(A=A.lengths[0]?E(h,0,f[0],n,l):null)d[0]=A[0],d[1]=A[1],n&&2<A.length&&(d[2]=A[2]);else return null;return C};q.lineCentroid=E;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/FeatureSetReaderJSON":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ./FeatureSetReader".split(" "),
function(q,t,D,E,C,A){function n({coords:d,lengths:a}){let b=0;for(const c of a){for(a=1;a<c;a++)d[2*(b+a)]+=d[2*(b+a)-2],d[2*(b+a)+1]+=d[2*(b+a)-1];b+=c}}let l=function(d){function a(c,f,h){c=d.call(this,c,h)||this;c._featureIndex=-1;c._dateFields=new Set;c._geometryType=null==h?void 0:h.geometryType;c._features=f;return c}t._inheritsLoose(a,d);a.fromFeatures=function(c,f){const {objectIdField:h,geometryType:p}=f,k=E.convertFromFeatures([],c,p,!1,!1,h);for(let e=0;e<k.length;e++)k[e].displayId=c[e].displayId;
return a.fromOptimizedFeatures(k,f)};a.fromFeatureSet=function(c,f){c=E.convertFromFeatureSet(c,f.objectIdField);return a.fromOptimizedFeatureSet(c,f)};a.fromOptimizedFeatureSet=function(c,f){const {features:h}=c;f=a.fromOptimizedFeatures(h,f);f._exceededTransferLimit=c.exceededTransferLimit;f._transform=c.transform;for(const p of c.fields)"esriFieldTypeDate"===p.type&&f._dateFields.add(p.name);return f};a.fromOptimizedFeatures=function(c,f,h){const p=A.FeatureSetReader.createInstance();c=new a(p,
c,f);c._transform=h;return c};var b=a.prototype;b.removeIds=function(c){const f=new Set(c);this._features=this._features.filter(h=>!f.has(h.objectId))};b.append=function(c){for(const f of c)this._features.push(f)};b.getSize=function(){return this._features.length};b.getCursor=function(){return this.copy()};b.getQuantizationTransform=function(){return this._transform};b.getAttributeHash=function(){let c="";for(const f in this._current.attributes)c+=this._current.attributes[f];return c};b.getIndex=
function(){return this._featureIndex};b.setIndex=function(c){this._featureIndex=c};b.getObjectId=function(){return this._current.objectId};b.getDisplayId=function(){return this._current.displayId};b.setDisplayId=function(c){this._current.displayId=c};b.getGroupId=function(){return this._current.groupId};b.setGroupId=function(c){this._current.groupId=c};b.copy=function(){const c=new a(this.instance,this._features,this.fullSchema());this.copyInto(c);return c};b.next=function(){for(;++this._featureIndex<
this._features.length&&!this._getExists(););return this._featureIndex<this._features.length};b.readLegacyFeature=function(){return E.convertToFeature(this._current,this.geometryType,this.hasZ,this.hasM)};b.readOptimizedFeature=function(){return this._current};b.readLegacyPointGeometry=function(){return this.readGeometry()?{x:this.getX(),y:this.getY()}:null};b.readLegacyGeometry=function(){const c=this.readGeometry();return E.convertToGeometry(c,this.geometryType,this.hasZ,this.hasM)};b.readLegacyCentroid=
function(){const c=this.readCentroid();return D.isNone(c)?null:{x:c.coords[0]*this._sx+this._tx,y:c.coords[1]*this._sy+this._ty}};b.readGeometryArea=function(){return C.hasGeometry(this._current)?E.getQuantizedArea(this._current.geometry,2):0};b.readUnquantizedGeometry=function(){var c=this.readGeometry();if("esriGeometryPoint"===this.geometryType||!c)return c;c=c.clone();n(c);return c};b.readHydratedGeometry=function(){var c=this._current.geometry;if(D.isNone(c))return null;c=c.clone();D.isSome(this._transform)&&
E.unquantizeOptimizedGeometry(c,c,this.hasZ,this.hasM,this._transform);return c};b.getXHydrated=function(){if(!C.hasGeometry(this._current))return 0;const c=this._current.geometry.coords[0],f=this.getQuantizationTransform();return D.isNone(f)?c:c*f.scale[0]+f.translate[0]};b.getYHydrated=function(){if(!C.hasGeometry(this._current))return 0;const c=this._current.geometry.coords[1],f=this.getQuantizationTransform();return D.isNone(f)?c:f.translate[1]-c*f.scale[1]};b.getX=function(){return C.hasGeometry(this._current)?
this._current.geometry.coords[0]*this._sx+this._tx:0};b.getY=function(){return C.hasGeometry(this._current)?this._current.geometry.coords[1]*this._sy+this._ty:0};b.readGeometry=function(){if(!C.hasGeometry(this._current))return null;const c=this._current.geometry.clone();if(c.isPoint)return c.coords[0]=c.coords[0]*this._sx+this._tx,c.coords[1]=c.coords[1]*this._sy+this._ty,c;let f=0;for(const h of c.lengths)c.coords[2*f]=c.coords[2*f]*this._sx+this._tx,c.coords[2*f+1]=c.coords[2*f+1]*this._sy+this._ty,
f+=h;return c};b.readCentroid=function(){if(!C.hasGeometry(this._current))return null;if(D.isNone(this._current.centroid)){var c=this._computeCentroid();if(D.isNone(c))return null;c.coords[0]=(c.coords[0]-this._tx)/this._sx;c.coords[1]=(c.coords[1]-this._ty)/this._sy;this._current.centroid=c}c=this._current.centroid.clone();c.coords[0]=c.coords[0]*this._sx+this._tx;c.coords[1]=c.coords[1]*this._sx+this._ty;return c};b.hasField=function(c){return c in this._current.attributes?!0:this.getFieldNames().map(f=>
f.toLowerCase()).includes(c.toLowerCase())};b.getFieldNames=function(){return Object.keys(this._current.attributes)};b._readAttribute=function(c,f){var h=this._current.attributes[c];if(void 0!==h)return null!=h&&f&&this._dateFields.has(c)?new Date(h):h;h=this.readAttributes();c=c.toLocaleLowerCase().trim();for(const p in h)if(p.toLocaleLowerCase().trim()===c)return c=this._current.attributes[p],null!=c&&f&&this._dateFields.has(p)?new Date(c):c};b.copyInto=function(c){d.prototype.copyInto.call(this,
c);c._featureIndex=this._featureIndex;c._transform=this._transform;c._dateFields=this._dateFields};b._readAttributes=function(){return this._current.attributes};t._createClass(a,[{key:"_current",get:function(){return this._features[this._featureIndex]}},{key:"geometryType",get:function(){return this._geometryType}},{key:"hasFeatures",get:function(){return!!this._features.length}},{key:"hasNext",get:function(){return this._featureIndex+1<this._features.length}},{key:"exceededTransferLimit",get:function(){return this._exceededTransferLimit}},
{key:"hasZ",get:function(){return!1}},{key:"hasM",get:function(){return!1}}]);return a}(A.FeatureSetReader);q.FeatureSetReaderJSON=l;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/graphics/GraphicStore":function(){define("../../../../core/maybe ../../../../core/screenUtils ../../../../chunks/rbush ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/boundsUtils ../../../../geometry/support/normalizeUtils ../../../../geometry/support/spatialReferenceUtils ../../../../symbols/cim/CIMSymbolDrawHelper ../../../../symbols/cim/CIMSymbolHelper ./GraphicStoreItem ./graphicsUtils".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b){function c(e,m,r,v,x){h.minX=m;h.minY=r;h.maxX=v;h.maxY=x;return e.search(h)}function f(e){return{minX:e.bounds[0],minY:e.bounds[1],maxX:e.bounds[2],maxY:e.bounds[3]}}const h={minX:0,minY:0,maxX:0,maxY:0},p=E.create(),k=(e,m)=>{const r=b.graphicGeometryToNumber(e.graphic),v=b.graphicGeometryToNumber(m.graphic);return r===v?m.zorder-e.zorder:r-v};return function(){function e(r,v,x,g,u,y,z){this._graphics=g;this._onAdd=u;this._onRemove=y;this._hashToCIM=z;this._index=
D.rbush(9,f);this._itemByGraphic=new Map;this._inflatedSizeHelper=new d.CIMSimbolInflatedSizeHelper;this._tileInfoView=r;this._uidFieldName=x;if(r=r.getClosestInfoForScale(v))this._resolution=this._tileInfoView.getTileResolution(r.level)}var m=e.prototype;m.setResourceManager=function(r){this._cimResourceManager=r;this._hittestDrawHelper=new l.HittestDrawHelper(r)};m.hitTest=function(r,v,x,g,u){r=A.normalizeMapX(r,this._tileInfoView.spatialReference);var y=.5*g*window.devicePixelRatio*x;p[0]=r-y;
p[1]=v-y;p[2]=r+y;p[3]=v+y;x=.5*g*(x+b.PIXEL_BUFFER);v=c(this._index,r-x,v-x,r+x,v+x);if(!v||0===v.length)return[];r=[];x=E.create();y=E.create();for(var z of v){const {geometry:w,symbolResource:B}=z;this._getSymbolBounds(x,B,w,y,u);y[3]=y[2]=y[1]=y[0]=0;E.intersects(x,p)&&z.graphic.visible&&r.push(z)}if(0===r.length)return[];z=this._hittestDrawHelper;v=[];for(const w of r){const {geometry:B,symbolResource:F}=w,{hash:G,textInfo:H}=F;(r=this._hashToCIM.get(G))&&z.hitTest(p,r.symbol,B,H,u,g)&&v.push(w)}v.sort(k);
return v.map(w=>w.graphic)};m.getGraphicsData=function(r,v,x){const g=this._searchForItems(v);if(0===g.length||0===x.length)return[];g.sort((G,H)=>G.zorder-H.zorder);g[0].insertAfter=-1;for(var u=1;u<g.length;u++)g[u].insertAfter=g[u-1].graphic.uid;g.sort((G,H)=>G.graphic.uid-H.graphic.uid);x.sort((G,H)=>G.uid-H.uid);let y=u=0,z;const w=v.resolution,B=[],F={originPosition:"upperLeft",scale:[w,w],translate:[v.bounds[0],v.bounds[3]]};for(const G of x){for(y=-2;u<g.length;)if(z=g[u],u++,G.uid===z.graphic.uid){y=
z.insertAfter;break}if(!z.geometry||-2===y)continue;x=z.getGeometryQuantized(F,v.bounds,this._tileInfoView.spatialReference,w);const H={...z.graphic.attributes};H[this._uidFieldName]=G.uid;null==z.groupId&&(z.groupId=r.createTemplateGroup(z.symbol,null));B.push({centroid:a.getCentroidQuantized(z,F),geometry:x,attributes:H,symbol:z.symbol,groupId:z.groupId,insertAfter:y,zorder:z.zorder})}B.sort((G,H)=>G.zorder-H.zorder);return B};m.queryTileData=function(r,v){if(0===this._graphics.length)return[];
const {bounds:x,resolution:g}=v,u=this._searchForItems(v),y=[];if(0===u.length)return y;this._createTileGraphics(y,r,u,{originPosition:"upperLeft",scale:[g,g],translate:[x[0],x[3]]},v);return y};m.has=function(r){return this._itemByGraphic.has(r)};m.getBounds=function(r){return(r=this._itemByGraphic.get(r))?r.bounds:null};m.getAllBounds=function(){return Array.from(this._itemByGraphic.values()).filter(r=>r.graphic.visible).map(r=>r.bounds)};m.addOrModify=function(r,v,x){if(r&&!q.isNone(v)){this.has(r)&&
this.remove(r);this._onAdd(r);var g=[0,0,0,0],u=this._getSymbolBounds(null,v,x,g,0);v=a.acquire(r,v,x,q.isSome(u)?u:null,g);this._itemByGraphic.set(r,v);x&&this._index.insert(v);return v.bounds}};m.remove=function(r){if(this._itemByGraphic.has(r)){this._onRemove(r);var v=this._itemByGraphic.get(r);v.bounds&&this._index.remove(v);this._itemByGraphic.delete(r)}};m.updateZ=function(){const r=this._graphics.items;for(let x=0;x<r.length;x++){var v=r[x];if(v=this._itemByGraphic.get(v))v.zorder=x}};m.update=
function(r,v,x){const g=this._itemByGraphic.get(r);g.groupId=null;const u=E.clone(g.bounds);this._index.remove(g);const y=this._getSymbolBounds(g.bounds,v,x,g.size,0);q.isSome(y)&&g.set(r,v,x,y,g.size);x&&this._index.insert(g);return{oldBounds:u,newBounds:g.bounds}};m.updateLevel=function(r){if(this._resolution!==r){this._resolution=r;this._index.clear();var v=this._itemByGraphic;r=[];for(const [,x]of v)v=this._getSymbolBounds(x.bounds,x.symbolResource,x.geometry,x.size,0),x.geometry&&q.isSome(v)&&
(x.bounds=v,r.push(x));this._index.load(r)}};m.clear=function(){this._itemByGraphic.clear();this._index.clear()};m._createTileGraphics=function(r,v,x,g,u){const y=this._uidFieldName,z=this._tileInfoView.spatialReference,{bounds:w,resolution:B}=u;x.sort((I,L)=>I.zorder-L.zorder);let F,G,H;for(let I=0;I<x.length;I++){G=x[I];u=G.graphic;F=G.getGeometryQuantized(g,w,z,B);H=0===I?-1:x[I-1].graphic.uid;const L={...G.graphic.attributes};L[y]=u.uid;null==G.groupId&&(G.groupId=v.createTemplateGroup(G.symbol,
null));r.push({centroid:a.getCentroidQuantized(G,g),geometry:F,attributes:L,symbol:G.symbol,groupId:G.groupId,insertAfter:H,zorder:G.zorder})}};m._searchForItems=function(r){var v=this._tileInfoView.spatialReference,x=r.bounds;if(v.isWrappable){const [g,u]=n.getInfo(v).valid;v=1E-5>Math.abs(x[2]-u);const y=1E-5>Math.abs(x[0]-g);if(!(v&&y||!v&&!y))return r=r.resolution,r=v?E.create([g,x[1],g+r*b.PIXEL_BUFFER,x[3]]):E.create([u-r*b.PIXEL_BUFFER,x[1],u,x[3]]),x=c(this._index,x[0],x[1],x[2],x[3]),r=c(this._index,
r[0],r[1],r[2],r[3]),[...new Set([...x,...r])]}return c(this._index,x[0],x[1],x[2],x[3])};m._getSymbolBounds=function(r,v,x,g,u){if(!v||!v.symbol||!x)return null;r||(r=E.create());C.getBoundsXY(r,x);if(!g||0===g[0]&&0===g[1]&&0===g[2]&&0===g[3]){const {hash:y,textInfo:z}=v;v=this._hashToCIM.get(y);if(!v)return null;g||(g=[0,0,0,0]);u=this._inflatedSizeHelper.getSymbolInflateSize(g,v.symbol,this._cimResourceManager,u,z);g[0]=t.pt2px(u[0]);g[1]=t.pt2px(u[1]);g[2]=t.pt2px(u[2]);g[3]=t.pt2px(u[3])}u=
this._resolution;g=d.CIMSimbolInflatedSizeHelper.safeSize(g);r[0]-=g*u;r[1]-=g*u;r[2]+=g*u;r[3]+=g*u;return r};return e}()})},"esri/views/2d/layers/graphics/GraphicStoreItem":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/centroid ../../../../geometry/support/jsonUtils ../../../../geometry/support/quantizationUtils ../../../../geometry/support/spatialReferenceUtils ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry".split(" "),
function(q,t,D,E,C,A,n,l,d){function a(f){f.coords.length=0;f.lengths.length=0}const b=new d,c=new d;d=function(){function f(){this.bounds=D.create();this.graphic=null}f.acquire=function(p=null,k,e,m,r){let v;0===f._pool.length?v=new f:(v=f._pool.pop(),this._set.delete(v));v.acquire(p,k,e,m,r);return v};f.release=function(p){p&&!this._set.has(p)&&(p.release(),this._pool.push(p),this._set.add(p))};f.getCentroidQuantized=function(p,k){if(C.isPolygon(p.geometry)){const e=p.symbol;if(t.isNone(e))return null;
if(0<(null==e?void 0:e.layers.length)&&e.layers.some(m=>"text"===m.type||"marker"===m.type))return p=E.polygonCentroid(p.geometry),null!==p?A.quantizePoint(k,{},{x:p[0],y:p[1]},!1,!1):null}return null};var h=f.prototype;h.acquire=function(p=null,k,e,m,r){p&&this.set(p,k,e,m,r)};h.release=function(){this.geometry=this.symbolResource=this.graphic=null};h.set=function(p,k,e,m,r){this.graphic=p;this.geometry=e;this.symbolResource=k;this.bounds=m;r&&(this.size=r)};h.getGeometryQuantized=function(p,k,e,
m){var r=this.geometry;if(C.isPolygon(r)){if(r=r.rings,1===r.length&&2===r[0].length)return A.quantizeGeometry(p,{paths:[[r[0][0],r[0][1]]]})}else{if(C.isPolyline(r))return a(b),a(c),l.convertFromPolyline(b,r),l.generalizeOptimizedGeometry(c,b,r.hasZ,r.hasM,"esriGeometryPolyline",p.scale[0]),l.quantizeOptimizedGeometry(b,c,r.hasZ,r.hasM,"esriGeometryPolyline",p),l.convertToPolyline(b,r.hasZ,r.hasM);if(C.isMultipoint(r)){const v=.5*m*Math.max(Math.abs(this.size[0])+this.size[2]-this.size[0],Math.abs(this.size[1])+
this.size[3]-this.size[1]);e=n.getInfo(e);r=r.points;if(e){const [x,g]=e.valid,u=g-x;r=r.filter(y=>{if(y[0]+v>g||y[0]-v<x){const z=[...y];z[0]=y[0]+v>g?z[0]-u:z[0]+u;return D.containsPointWithMargin(k,y,v)||D.containsPointWithMargin(k,z,v)}return D.containsPointWithMargin(k,y,v)})}return 0===r.length?{points:r}:A.quantizeGeometry(p,{points:r})}}return A.quantizeGeometry(p,this.geometry)};q._createClass(f,[{key:"symbol",get:function(){return this.symbolResource.symbol}}]);return f}();d._pool=[];d._set=
new Set;return d})},"esri/views/layers/GraphicsView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Identifiable ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(q,t,D,E,C,A,n,l,d){q.GraphicsView=a=>{a=function(b){function c(){var f=b.apply(this,arguments)||this;f.graphics=null;f.renderer=null;return f}t._inheritsLoose(c,
b);return c}(E.IdentifiableMixin(a));D.__decorate([C.property()],a.prototype,"graphics",void 0);D.__decorate([C.property()],a.prototype,"renderer",void 0);D.__decorate([C.property()],a.prototype,"updating",void 0);D.__decorate([C.property()],a.prototype,"view",void 0);return a=D.__decorate([d.subclass("esri.views.layers.GraphicsView")],a)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/graphics/GraphicContainer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"../../engine/webgl/enums","./BaseGraphicContainer"],function(q,t,D){return function(E){function C(){return E.apply(this,arguments)||this}q._inheritsLoose(C,E);var A=C.prototype;A.renderChildren=function(n){this.attributeView.bindTextures(n.context,!1);this.children.some(l=>l.hasData)&&(E.prototype.renderChildren.call(this,n),n.drawPhase===t.WGLDrawPhase.MAP&&this._renderChildren(n),this.hasHighlight()&&n.drawPhase===t.WGLDrawPhase.HIGHLIGHT&&this._renderHighlight(n),this._boundsRenderer&&this._boundsRenderer.doRender(n))};
A._renderHighlight=function(n){var {painter:l}=n;l=l.effects.highlight;l.bind(n);this._renderChildren(n,l.defines);l.draw(n);l.unbind()};return C}(D)})},"esri/views/2d/layers/graphics/BaseGraphicContainer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../engine/FeatureContainer","./GraphicBoundsRenderer","../../../webgl/enums"],function(q,t,D,E){return function(C){function A(l){l=C.call(this,l)||this;l.hasHighlight=()=>!0;return l}q._inheritsLoose(A,C);var n=A.prototype;n.destroy=
function(){C.prototype.destroy.call(this);this._boundsRenderer&&(this._boundsRenderer.destroy(),this._boundsRenderer=null)};n.enableRenderingBounds=function(l){this._boundsRenderer=new D(l);this.requestRender()};n.onTileData=function(l,d){l.patch(d);this.contains(l)||this.addChild(l);this.requestRender()};n.onTileError=function(l){l.clear();this.contains(l)||this.addChild(l)};n._renderChildren=function(l,d){for(const a of this.children)a.isReady&&a.hasData&&(a.commit(l),l.context.setStencilFunction(E.CompareFunction.EQUAL,
a.stencilRef,255),a._displayList.replay(l,a,d))};q._createClass(A,[{key:"hasLabels",get:function(){return!1}}]);return A}(t.FeatureContainer)})},"esri/views/2d/engine/FeatureContainer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/promiseUtils ../../../core/Queue ./webgl/AttributeStoreView ./webgl/TileContainer ./webgl/WGLRendererInfo".split(" "),function(q,t,D,E,C,A,n){A=function(l){function d(b){var c=l.call(this,b)||this;c._rendererInfo=new n.WGLRendererInfo;
c._materialItemsRequestQueue=new E;c.attributeView=new C.AttributeStoreView(()=>c.onAttributeStoreUpdate());return c}t._inheritsLoose(d,l);var a=d.prototype;a.destroy=function(){this.removeAllChildren();this.children.forEach(b=>b.destroy());this.attributeView.destroy();this._materialItemsRequestQueue.clear()};a.setRendererInfo=function(b,c,f){this._rendererInfo.setInfo(b,c,f);this.requestRender()};a.getMaterialItems=function(){var b=t._asyncToGenerator(function*(c,f){if(!c||0===c.length)return null;
const h=D.createResolver();this._materialItemsRequestQueue.push({items:c,abortOptions:f,resolver:h});this.requestRender();return h.promise});return function(c,f){return b.apply(this,arguments)}}();a.doRender=function(b){b.context.capabilities.enable("textureFloat");b.context.capabilities.enable("vao");if(0<this._materialItemsRequestQueue.length){let c=this._materialItemsRequestQueue.pop();for(;c;)this._processMaterialItemRequest(b,c),c=this._materialItemsRequestQueue.pop()}l.prototype.doRender.call(this,
b)};a.renderChildren=function(b){for(const c of this.children)c.commit(b);this._rendererInfo.update(b.state);l.prototype.renderChildren.call(this,b)};a.createRenderParams=function(b){b=l.prototype.createRenderParams.call(this,b);b.rendererInfo=this._rendererInfo;b.attributeView=this.attributeView;return b};a.onAttributeStoreUpdate=function(){};a._processMaterialItemRequest=function(b,{items:c,abortOptions:f,resolver:h}){const {painter:p,pixelRatio:k}=b;b=c.map(e=>p.textureManager.rasterizeItem(e.symbol,
k,e.glyphIds,f));Promise.all(b).then(e=>{this.stage?(e=e.map((m,r)=>({id:c[r].id,mosaicItem:m})),h.resolve(e)):h.reject()},h.reject)};return d}(A);q.FeatureContainer=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/AttributeStoreView":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ./definitions ./DisplayId ./Utils ./util/debug ../../../webgl/enums ../../../webgl/FramebufferObject ../../../webgl/Texture".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c,f,h){const p=C.getLogger("esri.views.2d.engine.webgl.AttributeStoreView"),k=b.createDebugLogger(b.DEBUG_ATTR_UPDATES,p);let e=function(){function m(v,x,g){this._lastTexture=this._texture=null;this._fbos={};this.texelSize=4;const {buffer:u,pixelType:y,textureOnly:z}=v;v=a.getPixelArrayCtor(y);this.shared=g;this.pixelType=y;this.size=x;this.textureOnly=z;z||(this.data=new v(A.unwrap(u)));this._resetRange()}var r=m.prototype;r.destroy=function(){A.applySome(this._texture,
v=>v.dispose());for(const v in this._fbos)A.applySome(this._fbos[v],x=>{"0"===v&&x.detachColorTexture();x.dispose()}),this._fbos[v]=null;this._texture=null};r.setData=function(v,x,g){v=d.getDisplayIdTexel(v);const u=A.unwrap(this.data);x=v*this.texelSize+x;!u||x>=u.length||(u[x]=g,this.dirtyStart=Math.min(this.dirtyStart,v),this.dirtyEnd=Math.max(this.dirtyEnd,v))};r.getData=function(v,x){if(A.isNone(this.data))return null;v=d.getDisplayIdTexel(v)*this.texelSize+x;return!this.data||v>=this.data.length?
null:this.data[v]};r.getTexture=function(v){return A.unwrapOr(this._texture,()=>this._initTexture(v))};r.getFBO=function(v,x=0){if(A.isNone(this._fbos[x])){const g={colorTarget:c.TargetType.TEXTURE,depthStencilTarget:c.DepthStencilTargetType.NONE},u=0===x?this.getTexture(v):this._textureDesc;this._fbos[x]=new f.FramebufferObject(v,g,u)}return this._fbos[x]};r.updateTexture=function(v,x){if(!this.locked){try{const g=this.dirtyStart,u=this.dirtyEnd;if(!this.hasDirty)return;this._resetRange();const y=
A.unwrap(this.data).buffer,z=this.getTexture(v),w=(g-g%this.size)/this.size,B=(u-u%this.size)/this.size,F=w*this.size*4,G=4*(this.size+B*this.size)-F,H=a.getPixelArrayCtor(this.pixelType),I=new H(y,F*H.BYTES_PER_ELEMENT,G),L=this.size;v=B-w+1;if(v>this.size){p.error(new D("mapview-webgl","Out-of-bounds index when updating AttributeData"));return}z.updateData(0,0,w,L,v,I)}catch(g){}x()}};r.update=function(v){const {data:x,start:g,end:u}=v;if(A.isSome(x)){const y=this.data,z=g*this.texelSize;for(let w=
0;w<x.length;w++)v.layout&1<<w%this.texelSize&&(y[z+w]=x[w])}this.dirtyStart=Math.min(this.dirtyStart,g);this.dirtyEnd=Math.max(this.dirtyEnd,u)};r.resize=function(v,x){const g=this.size;this.size=x;this.textureOnly?g!==this.size&&(this._lastTexture=this._texture,this._texture=null):(x=a.getPixelArrayCtor(this.pixelType),this.destroy(),this.data=new x(A.unwrap(v.buffer)))};r._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};r._initTexture=function(v){const x=new h.Texture(v,this._textureDesc,
A.unwrapOr(this.data,void 0));if(A.isSome(this._lastTexture)&&this._fbos[0]){const y=this._lastTexture.descriptor.width,z=this._lastTexture.descriptor.height,w=this._lastTexture.descriptor.dataType,B=this._lastTexture.descriptor.pixelFormat,F=this.getFBO(v);var g=a.getPixelBytes(w),u=a.getPixelArrayCtor(w);g=new ArrayBuffer(y*z*g*this.texelSize);u=new u(g);g=v.getBoundFramebufferObject();const {x:G,y:H,width:I,height:L}=v.getViewport();v.bindFramebuffer(F);F.readPixels(0,0,y,z,B,w,u);x.updateData(0,
0,0,2*y,z/2,u);v.setViewport(G,H,I,L);v.bindFramebuffer(g)}this.destroy();return this._texture=x};t._createClass(m,[{key:"_textureDesc",get:function(){return{target:c.TextureType.TEXTURE_2D,wrapMode:c.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:c.PixelFormat.RGBA,dataType:this.pixelType,samplingMode:c.TextureSamplingMode.NEAREST,width:this.size,height:this.size}}},{key:"locked",get:function(){return this.pixelType===c.PixelType.UNSIGNED_BYTE&&this.shared&&!this.textureOnly&&E("esri-atomics")&&this.data?
1===Atomics.load(this.data,0):!1}},{key:"hasDirty",get:function(){return this.dirtyEnd>=this.dirtyStart}}]);return m}();C=function(){function m(v){this._onUpdate=v;this._locked=this._forceNextUpload=this._initialized=!1}var r=m.prototype;r.initialize=function(v){const {blocks:x,shared:g,size:u}=v;this.shared=g;this.size=u;k("Initializing AttributeStoreView",v);if(A.isNone(this._data))this._data=A.mapMany(x,y=>new e(y,u,g));else for(v=0;v<this._data.length;v++){const y=this._data[v],z=x[v];A.isSome(z)&&
(A.isNone(y)?this._data[v]=new e(z,u,g):y.resize(z,u))}this._initialized=!0};r.destroy=function(){A.applySome(this._data,v=>A.mapMany(v,x=>x.destroy()));A.applySome(this._defaultTexture,v=>v.dispose())};r.isEmpty=function(){return A.isNone(this._data)};r.isUpdating=function(){const v=A.isSome(this._pendingAttributeUpdate);E("esri-2d-log-updating")&&console.log(`Updating AttributeStoreView ${v}\n  -> hasPendingUpdate ${v}`);return v};r.getBlock=function(v){return A.isNone(this._data)?null:this._data[v]};
r.setLabelMinZoom=function(v,x){this.setData(v,0,1,x)};r.getLabelMinZoom=function(v){return this.getData(v,0,1,255)};r.getFilterFlags=function(v){return this.getData(v,0,0,0)};r.getVVSize=function(v){return this.getData(v,l.ATTRIBUTE_DATA_VV,0,0)};r.getData=function(v,x,g,u){if(!this._data)return 0;x=A.unwrap(this._data)[x];if(A.isNone(x))return 0;v=x.getData(v,g);return A.isSome(v)?v:u};r.setData=function(v,x,g,u){x=A.unwrap(this._data)[x];A.unwrap(x).setData(v,g,u)};r.lockTextureUpload=function(){this._locked=
!0};r.unlockTextureUpload=function(){this._locked=!1};r.forceTextureUpload=function(){this._forceNextUpload=!0};r.requestUpdate=function(){var v=t._asyncToGenerator(function*(x){if(this._pendingAttributeUpdate)p.error(new D("mapview-webgl","Tried to update attribute data with a pending update"));else{var g=n.createResolver();k("AttributeStoreView Update Requested",x);this._pendingAttributeUpdate={data:x,resolver:g};return g.promise}});return function(x){return v.apply(this,arguments)}}();r.update=
function(){if(this._initialized&&A.isSome(this._pendingAttributeUpdate)){E("esri-2d-update-debug")&&console.debug("AttributeStoreView::update");const {data:v,resolver:x}=this._pendingAttributeUpdate,g=A.unwrap(this._data);for(let u=0;u<v.blocks.length;u++){const y=v.blocks[u];A.applySome(g[u],z=>A.applySome(y,w=>{k(`Updating block ${u}`,w);z.update(w)}))}this._pendingAttributeUpdate=null;x();this._onUpdate()}};r.bindTextures=function(v,x=!0){this.update();const g=this._getDefaultTexture(v);if(this._initialized){var u=
A.unwrap(this._data);if(!this._locked||this._forceNextUpload)A.forEachSome(u,y=>y.updateTexture(v,()=>this._onUpdate())),this._forceNextUpload=!1;v.bindTexture(A.mapOr(u[l.ATTRIBUTE_DATA_FILTER_FLAGS],g,y=>y.getTexture(v)),l.TEXTURE_BINDING_ATTRIBUTE_DATA_0);x&&(v.bindTexture(A.mapOr(u[l.ATTRIBUTE_DATA_GPGPU],g,y=>y.getTexture(v)),l.TEXTURE_BINDING_GPGPU),v.bindTexture(A.mapOr(u[l.ATTRIBUTE_DATA_ANIMATION],g,y=>y.getTexture(v)),l.TEXTURE_BINDING_ATTRIBUTE_DATA_1),v.bindTexture(A.mapOr(u[l.ATTRIBUTE_DATA_VV],
g,y=>y.getTexture(v)),l.TEXTURE_BINDING_ATTRIBUTE_DATA_2),v.bindTexture(A.mapOr(u[l.ATTRIBUTE_DATA_DD1],g,y=>y.getTexture(v)),l.TEXTURE_BINDING_ATTRIBUTE_DATA_3),v.bindTexture(A.mapOr(u[l.TEXTURE_BINDING_ATTRIBUTE_DATA_4],g,y=>y.getTexture(v)),l.TEXTURE_BINDING_ATTRIBUTE_DATA_4),v.bindTexture(A.mapOr(u[l.TEXTURE_BINDING_ATTRIBUTE_DATA_5],g,y=>y.getTexture(v)),l.TEXTURE_BINDING_ATTRIBUTE_DATA_5))}else v.bindTexture(g,l.TEXTURE_BINDING_ATTRIBUTE_DATA_0),x&&(v.bindTexture(g,l.TEXTURE_BINDING_ATTRIBUTE_DATA_1),
v.bindTexture(g,l.TEXTURE_BINDING_ATTRIBUTE_DATA_2),v.bindTexture(g,l.TEXTURE_BINDING_ATTRIBUTE_DATA_3),v.bindTexture(g,l.TEXTURE_BINDING_ATTRIBUTE_DATA_4),v.bindTexture(g,l.TEXTURE_BINDING_ATTRIBUTE_DATA_5),v.bindTexture(g,l.TEXTURE_BINDING_GPGPU))};r._getDefaultTexture=function(v){A.isNone(this._defaultTexture)&&(this._defaultTexture=new h.Texture(v,{wrapMode:c.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:c.PixelFormat.RGBA,dataType:c.PixelType.UNSIGNED_BYTE,samplingMode:c.TextureSamplingMode.NEAREST,
width:1,height:1},new Uint8Array(4)));return this._defaultTexture};return m}();q.AttributeStoreView=C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/TileContainer":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ./enums ./WGLContainer ./brushes/WGLBrushInfo ./brushes/WGLBrushStencil".split(" "),function(q,t,D,E,C,A){const n=(l,d)=>0!==l.key.level-d.key.level?l.key.level-d.key.level:0!==l.key.row-
d.key.row?l.key.row-d.key.row:l.key.col-d.key.col;return function(l){function d(b){var c=l.call(this)||this;c._tileInfoView=b;return c}q._inheritsLoose(d,l);var a=d.prototype;a.renderChildren=function(b){this.sortChildren(n);this.setStencilReference(b);l.prototype.renderChildren.call(this,b)};a.createRenderParams=function(b){const {state:c}=b;b=l.prototype.createRenderParams.call(this,b);b.requiredLevel=this._tileInfoView.getClosestInfoForScale(c.scale).level;b.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(c.scale);
return b};a.prepareRenderPasses=function(b){const c=l.prototype.prepareRenderPasses.call(this,b);c.push(b.registerRenderPass({name:"stencil",brushes:[A],drawPhase:D.WGLDrawPhase.DEBUG|D.WGLDrawPhase.MAP|D.WGLDrawPhase.HIGHLIGHT,target:()=>this.getStencilTarget()}));t("esri-tiles-debug")&&c.push(b.registerRenderPass({name:"tileInfo",brushes:[C],drawPhase:D.WGLDrawPhase.DEBUG,target:()=>this.children}));return c};a.getStencilTarget=function(){return this.children};a.updateTransforms=function(b){for(const c of this.children){const f=
this._tileInfoView.getTileResolution(c.key);c.setTransform(b,f)}};a.setStencilReference=function(b){b=1;for(const c of this.children)c.stencilRef=b++};q._createClass(d,[{key:"requiresDedicatedFBO",get:function(){return!1}}]);return d}(E)})},"esri/views/2d/engine/webgl/WGLContainer":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/maybe ../../../../chunks/mat3f32 ../brushes ../Container ./ClippingInfo ./enums".split(" "),function(q,t,D,E,C,A,n,l){return function(d){function a(){var c=
d.apply(this,arguments)||this;c.name=c.constructor.name;return c}q._inheritsLoose(a,d);var b=a.prototype;b._createTransforms=function(){return{dvs:E.create()}};b.doRender=function(c){const f=this.createRenderParams(c),{painter:h,globalOpacity:p,profiler:k,drawPhase:e}=f,m=e===l.WGLDrawPhase.LABEL||e===l.WGLDrawPhase.HIGHLIGHT?1:p*this.computedOpacity;k.recordContainerStart(this.name);h.beforeRenderLayer(f,this._clippingInfos?255:0,m);this.updateTransforms(c.state);this.renderChildren(f);h.compositeLayer(f,
m);k.recordContainerEnd()};b.renderChildren=function(c){D.isNone(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(c.painter));for(const f of this.children)f.beforeRender(c);for(const f of this._renderPasses)try{f.render(c)}catch(h){}for(const f of this.children)f.afterRender(c)};b.createRenderParams=function(c){c.requireFBO=this.requiresDedicatedFBO;return c};b.prepareRenderPasses=function(c){return[c.registerRenderPass({name:"clip",brushes:[C.brushes.clip],target:()=>this._clippingInfos,
drawPhase:l.WGLDrawPhase.MAP|l.WGLDrawPhase.LABEL|l.WGLDrawPhase.LABEL_ALPHA|l.WGLDrawPhase.DEBUG|l.WGLDrawPhase.HIGHLIGHT})]};b.updateTransforms=function(c){for(const f of this.children)f.setTransform(c)};b.onAttach=function(){d.prototype.onAttach.call(this);this._updateClippingInfo()};b.onDetach=function(){d.prototype.onDetach.call(this);this._updateClippingInfo()};b._updateClippingInfo=function(){D.isSome(this._clippingInfos)&&(this._clippingInfos.forEach(f=>f.destroy()),this._clippingInfos=null);
if(this.stage){var c=this._clips;D.isSome(c)&&c.length&&(this._clippingInfos=c.items.map(f=>n.fromClipArea(this.stage,f)));this.requestRender()}};q._createClass(a,[{key:"clips",set:function(c){this._clips=c;this.children.forEach(f=>f.clips=c);this._updateClippingInfo()}}]);return a}(A.Container)})},"esri/views/2d/engine/webgl/ClippingInfo":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/reactiveUtils ../../../../chunks/mat3f32 ../DisplayObject ./Mesh2D ../../../webgl/VertexArrayObject".split(" "),
function(q,t,D,E,C,A,n,l,d){const a=D.getLogger("esri.views.2d.engine.webgl.ClippingInfo");return function(b){function c(h,p){var k=b.call(this)||this;k._clip=p;k._cache={};k.stage=h;k._handle=C.watch(()=>p.version,()=>k._invalidate());k.ready();return k}q._inheritsLoose(c,b);c.fromClipArea=function(h,p){return new c(h,p)};var f=c.prototype;f._destroyGL=function(){E.isSome(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null);E.isSome(this._cache.vao)&&(this._cache.vao.dispose(),this._cache.vao=
null)};f.destroy=function(){this._destroyGL();this._handle.remove()};f.getVAO=function(h,p,k,e){const [m,r]=p.size;if("geometry"===this._clip.type||this._lastWidth!==m||this._lastHeight!==r)this._lastWidth=m,this._lastHeight=r,this._destroyGL();if(E.isNone(this._cache.vao)){p=this._createMesh(p,this._clip);const v=p.getIndexBuffer(h),x=p.getVertexBuffers(h);this._cache.mesh=p;this._cache.vao=new d.VertexArrayObject(h,k,e,x,v)}return this._cache.vao};f._createTransforms=function(){return{dvs:A.create()}};
f._invalidate=function(){this._destroyGL();this.requestRender()};f._createScreenRect=function(h,p){const [k,e]=h.size;h="string"===typeof p.left?parseFloat(p.left)/100*k:p.left;const m="string"===typeof p.right?parseFloat(p.right)/100*k:p.right,r="string"===typeof p.top?parseFloat(p.top)/100*e:p.top;p="string"===typeof p.bottom?parseFloat(p.bottom)/100*e:p.bottom;return{x:h,y:r,width:Math.max(k-m-h,0),height:Math.max(e-p-r,0)}};f._createMesh=function(h,p){switch(p.type){case "rect":return l.fromRect(this._createScreenRect(h,
p));case "path":return l.fromPath(p);case "geometry":return l.fromGeometry(h,p);default:return a.error(new t("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),l.fromRect({x:0,y:0,width:1,height:1})}};return c}(n.DisplayObject)})},"esri/views/2d/engine/webgl/Mesh2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../chunks/earcut ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry ./number ../../../webgl/BufferObject ../../../webgl/enums".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c){const f=D.getLogger("esri.views.2d.engine.webgl.Mesh2D"),h=({coords:p,lengths:k},e)=>{const m=[];for(let x=0,g=0;x<k.length;g+=k[x],x+=1){const u=g;for(var r=[];x<k.length-1;x+=1,g+=k[x]){{var v=g+k[x];let y=0;for(let z=1;z<k[x+1];z++)y+=(p[2*(v+z)]-p[2*(v+z-1)])*(p[2*(v+z)+1]+p[2*(v+z-1)+1]);v=e?0<y:0>y}if(!v)break;r.push(g+k[x]-u)}v=p.slice(2*u,2*(g+k[x]));r=C.earcut(v,r,2);for(const y of r)m.push(y+u)}return m};return function(){function p(e,m,r,v=!1){this._cache=
{};this.vertices=e;this.indices=m;this.primitiveType=r;this.isMapSpace=v}p.fromRect=function({x:e,y:m,width:r,height:v}){return p.fromScreenExtent({xmin:e,ymin:m,xmax:e+r,ymax:m+v})};p.fromPath=function(e){var m=l.convertFromNestedArray(new d,e.path,!1,!1);e=m.coords;m=new Uint32Array(h(m,!0));const r=new Uint32Array(e.length/2);for(let v=0;v<r.length;v++)r[v]=a.i1616to32(Math.floor(e[2*v]),Math.floor(e[2*v+1]));return new p({geometry:r},m,c.PrimitiveType.TRIANGLES)};p.fromGeometry=function(e,m){const r=
m.geometry.type;switch(r){case "polygon":return p.fromPolygon(e,m.geometry);case "extent":return p.fromMapExtent(e,m.geometry);default:return f.error(new t("mapview-bad-type",`Unable to create a mesh from type ${r}`,m)),p.fromRect({x:0,y:0,width:1,height:1})}};p.fromPolygon=function(e,m){var r=l.convertFromPolygon(new d,m,!1,!1);m=r.coords;r=new Uint32Array(h(r,!1));const v=new Uint32Array(m.length/2),x=n.create(),g=n.create();for(let u=0;u<v.length;u++)A.set(x,m[2*u],m[2*u+1]),e.toScreen(g,x),v[u]=
a.i1616to32(Math.floor(g[0]),Math.floor(g[1]));return new p({geometry:v},r,c.PrimitiveType.TRIANGLES,!0)};p.fromScreenExtent=function({xmin:e,xmax:m,ymin:r,ymax:v}){e={geometry:new Uint32Array([a.i1616to32(e,r),a.i1616to32(m,r),a.i1616to32(e,v),a.i1616to32(e,v),a.i1616to32(m,r),a.i1616to32(m,v)])};m=new Uint32Array([0,1,2,3,4,5]);return new p(e,m,c.PrimitiveType.TRIANGLES)};p.fromMapExtent=function(e,m){const [r,v]=e.toScreen([0,0],[m.xmin,m.ymin]),[x,g]=e.toScreen([0,0],[m.xmax,m.ymax]);e={geometry:new Uint32Array([a.i1616to32(r,
v),a.i1616to32(x,v),a.i1616to32(r,g),a.i1616to32(r,g),a.i1616to32(x,v),a.i1616to32(x,g)])};m=new Uint32Array([0,1,2,3,4,5]);return new p(e,m,c.PrimitiveType.TRIANGLES)};var k=p.prototype;k.destroy=function(){E.isSome(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose();for(const e in this._cache.vertexBuffers)E.isSome(this._cache.vertexBuffers[e])&&this._cache.vertexBuffers[e].dispose()};k.getIndexBuffer=function(e,m=c.Usage.STATIC_DRAW){this._cache.indexBuffer||(this._cache.indexBuffer=b.BufferObject.createIndex(e,
m,this.indices));return this._cache.indexBuffer};k.getVertexBuffers=function(e,m=c.Usage.STATIC_DRAW){this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce((r,v)=>({...r,[v]:b.BufferObject.createVertex(e,m,this.vertices[v])}),{}));return this._cache.vertexBuffers};q._createClass(p,[{key:"elementType",get:function(){a:switch(this.indices.BYTES_PER_ELEMENT){case 1:var e=c.DataType.UNSIGNED_BYTE;break a;case 2:e=c.DataType.UNSIGNED_SHORT;break a;case 4:e=c.DataType.UNSIGNED_INT;
break a;default:throw new t("Cannot get DataType of array");}return e}}]);return p}()})},"esri/views/2d/engine/webgl/WGLRendererInfo":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/screenUtils ../../../../core/unitUtils ../../../../renderers/support/lengthUtils ./Utils ./techniques/Technique ./techniques/utils ../../../webgl/capabilities".split(" "),function(q,t,D,E,C,A,n,l,d,a){function b(f,h){const p=h.length;if(f<h[0].value||1===
p)return h[0].size;for(let k=1;k<p;k++)if(f<h[k].value)return h[k-1].size+(f-h[k-1].value)/(h[k].value-h[k-1].value)*(h[k].size-h[k-1].size);return h[p-1].size}let c=function(){function f(){this.symbolLevels=[];this.vvColorValues=new Float32Array(8);this.vvColors=new Float32Array(32);this.vvOpacityValues=new Float32Array(8);this.vvOpacities=new Float32Array(8);this.vvSizeMinMaxValue=new Float32Array(4);this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",
vvOpacityEnabled:!1};this._technique=l.Technique}var h=f.prototype;h.getSizeVVFieldStops=function(p){const k=this._vvSizeFieldStops;switch(k.type){case "static":return k;case "level-dependent":return D.unwrapOr(k.levels[p],()=>{var e=Infinity,m=0;for(var r in k.levels){const v=parseFloat(r),x=Math.abs(p-v);x<e&&(e=x,m=v)}if(Infinity===e)return{sizes:new Float32Array([0,0,0,0,0,0]),values:new Float32Array([0,0,0,0,0,0])};e=2**((p-m)/2);m=D.unwrap(k.levels[m]);r=new Float32Array(m.values);r[2]*=e;r[3]*=
e;return{sizes:D.unwrap(m.sizes),values:r}})}};h.update=function(p){D.isSome(this._vvInfo)&&this._updateVisualVariables(this._vvInfo.vvRanges,p)};h.setInfo=function(p,k,e){this._updateEffects(e);this._vvInfo=k;this._technique=d.getTechniqueFromRenderer(p);this.rendererSchema=this._technique.createOrUpdateRendererSchema(this.rendererSchema,p)};h.getVariation=function(){return{...this._technique.getVariation(this.rendererSchema),outsideLabelsVisible:this.outsideLabelsVisible,supportsTextureFloat:a.getWebGLCapabilities("2d").supportsTextureFloat}};
h.getVariationHash=function(){return this._technique.getVariationHash(this.rendererSchema)<<1|(this.outsideLabelsVisible?1:0)};h._updateEffects=function(p){D.isSome(p)?this.outsideLabelsVisible=p.excludedLabelsVisible:this.outsideLabelsVisible=!1};h._updateVisualVariables=function(p,k){const e=this._vvMaterialParameters;e.vvOpacityEnabled=!1;e.vvSizeEnabled=!1;e.vvColorEnabled=!1;e.vvRotationEnabled=!1;if(p){var m=p.size;if(m){e.vvSizeEnabled=!0;if(m.minMaxValue){const v=m.minMaxValue;let x;if(n.isDefined(v.minSize)&&
n.isDefined(v.maxSize))if(n.isNumber(v.minSize)&&n.isNumber(v.maxSize)){x=E.pt2px(v.minSize);var r=E.pt2px(v.maxSize)}else r=k.scale,x=E.pt2px(b(r,v.minSize.stops)),r=E.pt2px(b(r,v.maxSize.stops));this.vvSizeMinMaxValue.set([v.minDataValue,v.maxDataValue,x,r])}m.scaleStops&&(this.vvSizeScaleStopsValue=E.pt2px(b(k.scale,m.scaleStops.stops)));m.unitValue&&(this.vvSizeUnitValueToPixelsRatio=C.getMetersPerUnitForSR(k.spatialReference)/A.meterIn[m.unitValue.unit]/k.resolution);m.fieldStops&&(this._vvSizeFieldStops=
m.fieldStops)}if(k=p.color)e.vvColorEnabled=!0,this.vvColorValues.set(k.values),this.vvColors.set(k.colors);if(k=p.opacity)e.vvOpacityEnabled=!0,this.vvOpacityValues.set(k.values),this.vvOpacities.set(k.opacities);if(p=p.rotation)e.vvRotationEnabled=!0,e.vvRotationType=p.type}};t._createClass(f,[{key:"vvMaterialParameters",get:function(){return this._vvMaterialParameters}}]);return f}();q.WGLRendererInfo=c;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/layers/graphics/GraphicBoundsRenderer":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../../../../chunks/vec2f32 ../../../../chunks/vec3f32 ../../../../geometry/support/normalizeUtils ../../engine/DisplayObject ../../engine/webgl/Utils ../../../webgl/BufferObject ../../../webgl/enums ../../../webgl/VertexArrayObject".split(" "),function(q,t,D,E,C,A,n,l,d,a,b){const c=Math.PI/180,f=()=>l.createProgramDescriptor("bounds",
{geometry:[{location:0,name:"a_position",count:2,type:a.DataType.FLOAT}]});return function(h){function p(e){var m=h.call(this)||this;m._dvsMat3=D.create();m._localOrigin={x:0,y:0};m._getBounds=e;return m}q._inheritsLoose(p,h);var k=p.prototype;k.destroy=function(){this._vao&&(this._vao.dispose(!0),this._indexBuffer=this._vertexBuffer=this._vao=null);this._program&&(this._program.dispose(),this._program=null)};k.doRender=function(e){const {context:m}=e,r=this._getBounds();1>r.length||(this._createShaderProgram(m),
this._updateMatricesAndLocalOrigin(e),this._updateBufferData(m,r),m.setBlendingEnabled(!0),m.setDepthTestEnabled(!1),m.setStencilWriteMask(0),m.setStencilTestEnabled(!1),m.setBlendFunction(a.BlendFactor.ONE,a.BlendFactor.ONE_MINUS_SRC_ALPHA),m.setColorMask(!0,!0,!0,!0),e=this._program,m.bindVAO(this._vao),m.useProgram(e),e.setUniformMatrix3fv("u_dvsMat3",this._dvsMat3),m.gl.lineWidth(1),m.drawElements(a.PrimitiveType.LINES,8*r.length,a.DataType.UNSIGNED_INT,0),m.bindVAO())};k._createTransforms=function(){return{dvs:D.create()}};
k._createShaderProgram=function(e){this._program||(this._program=e.programCache.acquire("precision highp float;\n        uniform mat3 u_dvsMat3;\n\n        attribute vec2 a_position;\n\n        void main() {\n          mediump vec3 pos \x3d u_dvsMat3 * vec3(a_position, 1.0);\n          gl_Position \x3d vec4(pos.xy, 0.0, 1.0);\n        }","precision mediump float;\n      void main() {\n        gl_FragColor \x3d vec4(0.75, 0.0, 0.0, 0.75);\n      }",f().attributes))};k._updateMatricesAndLocalOrigin=
function(e){var {state:m}=e;const {displayMat3:r,size:v,resolution:x,pixelRatio:g,rotation:u,viewpoint:y}=m;e=c*u;const {x:z,y:w}=y.targetGeometry;m=A.normalizeMapX(z,m.spatialReference);this._localOrigin.x=m;this._localOrigin.y=w;m=g*v[0];const B=g*v[1],F=x*m,G=x*B,H=t.identity(this._dvsMat3);t.multiply(H,H,r);t.translate(H,H,E.fromValues(m/2,B/2));t.scale(H,H,C.fromValues(v[0]/F,-B/G,1));t.rotate(H,H,-e)};k._updateBufferData=function(e,m){const {x:r,y:v}=this._localOrigin,x=new Float32Array(8*m.length),
g=new Uint32Array(8*m.length);let u=0,y=0;for(const z of m)z&&(x[2*u]=z[0]-r,x[2*u+1]=z[1]-v,x[2*u+2]=z[0]-r,x[2*u+3]=z[3]-v,x[2*u+4]=z[2]-r,x[2*u+5]=z[3]-v,x[2*u+6]=z[2]-r,x[2*u+7]=z[1]-v,g[y+0]=u+0,g[y+1]=u+3,g[y+2]=u+3,g[y+3]=u+2,g[y+4]=u+2,g[y+5]=u+1,g[y+6]=u+1,g[y+7]=u+0,u+=4,y+=8);this._vertexBuffer?this._vertexBuffer.setData(x.buffer):this._vertexBuffer=d.BufferObject.createVertex(e,a.Usage.DYNAMIC_DRAW,x.buffer);this._indexBuffer?this._indexBuffer.setData(g):this._indexBuffer=d.BufferObject.createIndex(e,
a.Usage.DYNAMIC_DRAW,g);this._vao||(m=f(),this._vao=new b.VertexArrayObject(e,m.attributes,m.bufferLayouts,{geometry:this._vertexBuffer},this._indexBuffer))};return p}(n.DisplayObject)})},"esri/chunks/vec3f32":function(){define(["exports"],function(q){function t(){return new Float32Array(3)}function D(e){const m=new Float32Array(3);m[0]=e[0];m[1]=e[1];m[2]=e[2];return m}function E(e,m,r){const v=new Float32Array(3);v[0]=e;v[1]=m;v[2]=r;return v}function C(e,m){return new Float32Array(e,m,3)}function A(){return t()}
function n(){return E(1,1,1)}function l(){return E(1,0,0)}function d(){return E(0,1,0)}function a(){return E(0,0,1)}const b=t(),c=n(),f=l(),h=d(),p=a(),k=Object.freeze(Object.defineProperty({__proto__:null,create:t,clone:D,fromValues:E,createView:C,zeros:A,ones:n,unitX:l,unitY:d,unitZ:a,ZEROS:b,ONES:c,UNIT_X:f,UNIT_Y:h,UNIT_Z:p},Symbol.toStringTag,{value:"Module"}));q.ONES=c;q.UNIT_X=f;q.UNIT_Y=h;q.UNIT_Z=p;q.ZEROS=b;q.clone=D;q.create=t;q.createView=C;q.fromValues=E;q.ones=n;q.unitX=l;q.unitY=d;
q.unitZ=a;q.vec3f32=k;q.zeros=A})},"esri/views/2d/navigation/MapViewNavigation":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Viewpoint ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../geometry/Point ../viewpointUtils ./ZoomBox ./actions/Pan ./actions/Pinch ./actions/Rotate".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c,f,h,p){const k=new D({targetGeometry:new a}),e=[0,0];D=function(m){function r(x){x=m.call(this,x)||this;x._endTimer=null;x.animationManager=null;return x}q._inheritsLoose(r,m);var v=r.prototype;v.initialize=function(){this.pan=new f({navigation:this});this.rotate=new p({navigation:this});this.pinch=new h({navigation:this});this.zoomBox=new c({view:this.view,navigation:this})};v.destroy=function(){this.pan.destroy();this.rotate.destroy();this.pinch.destroy();this.zoomBox.destroy();
this.pan=this.rotate=this.pinch=this.zoomBox=this.animationManager=null};v.begin=function(){this._set("interacting",!0)};v.end=function(){this._lastEventTimestamp=performance.now();this._startTimer(250)};v.zoom=function(){var x=q._asyncToGenerator(function*(g,u=this._getDefaultAnchor()){this.stop();this.begin();if(this.view.constraints.snapToZoom&&this.view.constraints.effectiveLODs)return 1>g?this.zoomIn(u):this.zoomOut(u);this.setViewpoint(u,g,0,[0,0])});return function(g){return x.apply(this,arguments)}}();
v.zoomIn=function(){var x=q._asyncToGenerator(function*(g){var u=this.view;u=u.constraints.snapToNextScale(u.scale);return this._zoomToScale(u,g)});return function(g){return x.apply(this,arguments)}}();v.zoomOut=function(){var x=q._asyncToGenerator(function*(g){var u=this.view;u=u.constraints.snapToPreviousScale(u.scale);return this._zoomToScale(u,g)});return function(g){return x.apply(this,arguments)}}();v.setViewpoint=function(x,g,u,y){this.begin();this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,
x,g,u,y);this.end()};v.setViewpointImmediate=function(x,g=0,u=[0,0],y=this._getDefaultAnchor()){this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,y,x,g,u)};v.continousRotateClockwise=function(){const x=this.get("view.viewpoint");this.animationManager.animateContinous(x,g=>{b.rotateBy(g,g,-1)})};v.continousRotateCounterclockwise=function(){const x=this.get("view.viewpoint");this.animationManager.animateContinous(x,g=>{b.rotateBy(g,g,1)})};v.resetRotation=function(){this.view.rotation=
0};v.continousPanLeft=function(){this._continuousPan([-10,0])};v.continousPanRight=function(){this._continuousPan([10,0])};v.continousPanUp=function(){this._continuousPan([0,10])};v.continousPanDown=function(){this._continuousPan([0,-10])};v.stop=function(){this.pan.stopMomentumNavigation();this.animationManager.stop();this.end();null!==this._endTimer&&(clearTimeout(this._endTimer),this._endTimer=null,this._set("interacting",!1))};v._continuousPan=function(x){this.animationManager.animateContinous(this.view.viewpoint,
g=>{b.translateBy(g,g,x);this.view.constraints.constrainByGeometry(g)})};v._startTimer=function(x){return null!==this._endTimer?this._endTimer:this._endTimer=setTimeout(()=>{this._endTimer=null;const g=performance.now()-this._lastEventTimestamp;250>g?this._endTimer=this._startTimer(g):this._set("interacting",!1)},x)};v._getDefaultAnchor=function(){const {size:x,padding:{left:g,right:u,top:y,bottom:z}}=this.view;e[0]=.5*(x[0]-u+g);e[1]=.5*(x[1]-z+y);return e};v._zoomToScale=function(){var x=q._asyncToGenerator(function*(g,
u=this._getDefaultAnchor()){const {view:y}=this,{constraints:z,scale:w,viewpoint:B,size:F,padding:G}=y,H=z.canZoomInTo(g),I=z.canZoomOutTo(g);if(!(g<w&&!H||g>w&&!I))return b.padAndScaleAndRotateBy(k,B,g/w,0,u,F,G),z.constrainByGeometry(k),y.goTo(k,{animate:!0})});return function(g){return x.apply(this,arguments)}}();v._scaleRotateTranslateViewpoint=function(x,g,u,y,z){var {view:w}=this;const {size:B,padding:F,constraints:G,scale:H,viewpoint:I}=w;var L=H*u;w=G.canZoomInTo(L);L=G.canZoomOutTo(L);if(1>
u&&!w||1<u&&!L)u=1;b.translateBy(I,I,z);b.padAndScaleAndRotateBy(x,I,u,y,g,B,F);return G.constrainByGeometry(x)};return r}(E);t.__decorate([C.property()],D.prototype,"animationManager",void 0);t.__decorate([C.property({type:Boolean,readOnly:!0})],D.prototype,"interacting",void 0);t.__decorate([C.property()],D.prototype,"pan",void 0);t.__decorate([C.property()],D.prototype,"pinch",void 0);t.__decorate([C.property()],D.prototype,"rotate",void 0);t.__decorate([C.property()],D.prototype,"view",void 0);
t.__decorate([C.property()],D.prototype,"zoomBox",void 0);return D=t.__decorate([d.subclass("esri.views.2d.navigation.MapViewNavigation")],D)})},"esri/views/2d/navigation/ZoomBox":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/screenUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../input/InputManager".split(" "),
function(q,t,D,E,C,A,n,l,d,a){D=function(b){function c(h){h=b.call(this,h)||this;h._container=null;h._overlay=null;h._backgroundShape=null;h._boxShape=null;h._box={x:0,y:0,width:0,height:0};h._redraw=h._redraw.bind(q._assertThisInitialized(h));return h}q._inheritsLoose(c,b);var f=c.prototype;f.destroy=function(){this.view=null};f._start=function(){this._createContainer();this._createOverlay();this.navigation.begin()};f._update=function(h,p,k,e){this._box.x=h;this._box.y=p;this._box.width=k;this._box.height=
e;this._rafId||(this._rafId=requestAnimationFrame(this._redraw))};f._end=function(h,p,k,e,m){const r=this.view;h=r.toMap(E.createScreenPoint(h+.5*k,p+.5*e));k=Math.max(k/r.width,e/r.height);-1===m&&(k=1/k);this._destroyOverlay();this.navigation.end();r.goTo({center:h,scale:r.scale*k})};f._updateBox=function(h,p,k,e){const m=this._boxShape;m.setAttributeNS(null,"x",""+h);m.setAttributeNS(null,"y",""+p);m.setAttributeNS(null,"width",""+k);m.setAttributeNS(null,"height",""+e);m.setAttributeNS(null,"class",
"esri-zoom-box__outline")};f._updateBackground=function(h,p,k,e){this._backgroundShape.setAttributeNS(null,"d",this._toSVGPath(h,p,k,e,this.view.width,this.view.height))};f._createContainer=function(){const h=document.createElement("div");h.className="esri-zoom-box__container";this.view.root.appendChild(h);this._container=h};f._createOverlay=function(){var h=this.view.width,p=this.view.height;const k=document.createElementNS("http://www.w3.org/2000/svg","path");k.setAttributeNS(null,"d","M 0 0 L "+
h+" 0 L "+h+" "+p+" L 0 "+p+" Z");k.setAttributeNS(null,"class","esri-zoom-box__overlay-background");h=document.createElementNS("http://www.w3.org/2000/svg","rect");p=document.createElementNS("http://www.w3.org/2000/svg","svg");p.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");p.setAttributeNS(null,"class","esri-zoom-box__overlay");p.appendChild(k);p.appendChild(h);this._container.appendChild(p);this._backgroundShape=k;this._boxShape=h;this._overlay=p};
f._destroyOverlay=function(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container);this._container=this._backgroundShape=this._boxShape=this._overlay=null};f._toSVGPath=function(h,p,k,e,m,r){k=h+k;e=p+e;return"M 0 0 L "+m+" 0 L "+m+" "+r+" L 0 "+r+" ZM "+h+" "+p+" L "+h+" "+e+" L "+k+" "+e+" L "+k+" "+p+" Z"};f._handleDrag=function(h,p){var k=h.x,e=h.y,m=h.origin.x;const r=h.origin.y;let v;k>m?(v=m,m=k-m):(v=k,m-=k);e>r?(k=r,e-=r):(k=e,e=r-e);switch(h.action){case "start":this._start();
break;case "update":this._update(v,k,m,e);break;case "end":this._end(v,k,m,e,p)}h.stopPropagation()};f._redraw=function(){if(this._rafId&&(this._rafId=null,this._overlay)){var {x:h,y:p,width:k,height:e}=this._box;this._updateBox(h,p,k,e);this._updateBackground(h,p,k,e);this._rafId=requestAnimationFrame(this._redraw)}};q._createClass(c,[{key:"view",set:function(h){this._handles&&this._handles.forEach(p=>{p.remove()});this._handles=null;this._destroyOverlay();this._set("view",h);h&&(h.on("drag",["Shift"],
p=>this._handleDrag(p,1),a.ViewEventPriorities.INTERNAL),h.on("drag",["Shift","Ctrl"],p=>this._handleDrag(p,-1),a.ViewEventPriorities.INTERNAL))}}]);return c}(D);t.__decorate([C.property()],D.prototype,"navigation",void 0);t.__decorate([C.property()],D.prototype,"view",null);return D=t.__decorate([d.subclass("esri.views.2d.navigation.ZoomBox")],D)})},"esri/views/2d/navigation/actions/Pan":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/reactiveUtils ../../../../core/screenUtils ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../viewpointUtils ../../../navigation/PanPlanarMomentumEstimator ../../../../geometry/Point".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c,f,h,p,k,e){D=function(m){function r(x){var g=m.call(this,x)||this;g.animationTime=0;g.momentumEstimator=new k.PanPlanarMomentumEstimator(500,6,.92);g.momentum=null;g.tmpMomentum=h.create();g.momentumFinished=!1;g.viewpoint=new E({targetGeometry:new e,scale:0,rotation:0});A.when(()=>g.momentumFinished,()=>g.navigation.stop());return g}q._inheritsLoose(r,m);var v=r.prototype;v.begin=function(x,g){this.navigation.begin();this.momentumEstimator.reset();this.addToEstimator(g);
this.previousDrag=g};v.update=function(x,g){this.addToEstimator(g);let u=g.center.x,y=g.center.y;const z=this.previousDrag;u=z?z.center.x-u:-u;y=z?y-z.center.y:y;x.viewpoint=p.translateBy(this.viewpoint,x.viewpoint,[u||0,y||0]);this.previousDrag=g};v.end=function(x,g){this.addToEstimator(g);this.momentum=x.navigation.momentumEnabled?this.momentumEstimator.evaluateMomentum():null;this.animationTime=0;if(this.momentum)this.onAnimationUpdate(x);this.previousDrag=null;this.navigation.end()};v.addToEstimator=
function(x){var g=x.center.x;const u=x.center.y,y=n.createScreenPointArray(-g,u);g=h.fromValues(-g,u,0);this.momentumEstimator.add(y,g,.001*x.timestamp)};v.onAnimationUpdate=function(x){this.navigation.animationManager.animateContinous(x.viewpoint,(g,u)=>{this.momentumFinished=!this.momentum||this.momentum.isFinished(this.animationTime);u*=.001;if(!this.momentumFinished){const y=this.momentum.valueDelta(this.animationTime,u);f.scale(this.tmpMomentum,this.momentum.direction,y);p.translateBy(g,g,this.tmpMomentum);
x.constraints.constrainByGeometry(g)}this.animationTime+=u})};v.stopMomentumNavigation=function(){this.momentum&&(this.momentumEstimator.reset(),this.momentum=null,this.navigation.stop())};return r}(C);t.__decorate([l.property()],D.prototype,"momentumFinished",void 0);t.__decorate([l.property()],D.prototype,"viewpoint",void 0);t.__decorate([l.property()],D.prototype,"navigation",void 0);return D=t.__decorate([c.subclass("esri.views.2d.navigation.actions.Pan")],D)})},"esri/views/navigation/PanPlanarMomentumEstimator":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/vec3 ../../chunks/vec3f64 ./FilteredFiniteDifference ./Momentum".split(" "),
function(q,t,D,E,C,A){let n=function(l){function d(a,b,c,f,h){a=l.call(this,a,b,c)||this;a.sceneVelocity=f;a.direction=h;return a}t._inheritsLoose(d,l);d.prototype.value=function(a){return l.prototype.valueFromInitialVelocity.call(this,this.sceneVelocity,a)};return d}(A.Momentum);A=function(){function l(a=300,b=12,c=.84){this.minimumInitialVelocity=a;this.stopVelocity=b;this.friction=c;this.enabled=!0;this.time=new C.FilteredFiniteDifference(.6);this.screen=[new C.FilteredFiniteDifference(.4),new C.FilteredFiniteDifference(.4)];
this.scene=[new C.FilteredFiniteDifference(.6),new C.FilteredFiniteDifference(.6),new C.FilteredFiniteDifference(.6)];this.tmpDirection=E.create()}var d=l.prototype;d.add=function(a,b,c){!this.enabled||this.time.hasLastValue&&.015>this.time.computeDelta(c)||(this.screen[0].update(a[0]),this.screen[1].update(a[1]),this.scene[0].update(b[0]),this.scene[1].update(b[1]),this.scene[2].update(b[2]),this.time.update(c))};d.reset=function(){this.screen[0].reset();this.screen[1].reset();this.scene[0].reset();
this.scene[1].reset();this.scene[2].reset();this.time.reset()};d.evaluateMomentum=function(){if(!this.enabled||!this.screen[0].hasFilteredDelta)return null;var a=this.screen[0].filteredDelta;const b=this.screen[1].filteredDelta;a=Math.sqrt(a*a+b*b)/this.time.filteredDelta;return Math.abs(a)<this.minimumInitialVelocity?null:this.createMomentum(a,this.stopVelocity,this.friction)};d.createMomentum=function(a,b,c){D.set(this.tmpDirection,this.scene[0].filteredDelta,this.scene[1].filteredDelta,this.scene[2].filteredDelta);
const f=D.length(this.tmpDirection);0<f&&D.scale(this.tmpDirection,this.tmpDirection,1/f);return new n(a,b,c,f/this.time.filteredDelta,this.tmpDirection)};return l}();q.PanPlanarMomentum=n;q.PanPlanarMomentumEstimator=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/navigation/FilteredFiniteDifference":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(q,t){let D=function(){function E(A){this.gain=A}var C=E.prototype;
C.update=function(A){if(this.hasLastValue){const n=this.computeDelta(A);this._updateDelta(n)}this.lastValue=A};C.reset=function(){this.filteredDelta=this.lastValue=void 0};C.computeDelta=function(A){return A-this.lastValue};C._updateDelta=function(A){this.filteredDelta=this.hasFilteredDelta?(1-this.gain)*this.filteredDelta+this.gain*A:A};t._createClass(E,[{key:"hasLastValue",get:function(){return void 0!==this.lastValue}},{key:"hasFilteredDelta",get:function(){return void 0!==this.filteredDelta}}]);
return E}();q.FilteredFiniteDifference=D;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/navigation/Momentum":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(q,t){let D=function(){function E(A,n,l){this._initialVelocity=A;this._stopVelocity=n;this._friction=l;this._duration=Math.abs(Math.log(Math.abs(this._initialVelocity)/this._stopVelocity)/Math.log(1-this._friction))}var C=E.prototype;C.isFinished=function(A){return A>
this.duration};C.value=function(A){return this.valueFromInitialVelocity(this._initialVelocity,A)};C.valueDelta=function(A,n){const l=this.value(A);return this.value(A+n)-l};C.valueFromInitialVelocity=function(A,n){n=Math.min(n,this.duration);const l=1-this.friction;return A*(l**n-1)/Math.log(l)};t._createClass(E,[{key:"duration",get:function(){return this._duration}},{key:"friction",get:function(){return this._friction}}]);return E}();q.Momentum=D;Object.defineProperties(q,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/navigation/actions/Pinch":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/reactiveUtils ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../viewpointUtils ../../../navigation/RotationMomentumEstimator ../../../navigation/ZoomMomentumEstimator ../../../../geometry/Point".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c,f,h,p,k,e){D=function(m){function r(x){var g=m.call(this,x)||this;g._animationTime=0;g._momentumFinished=!1;g._rotationMomentumEstimator=new p.RotationMomentumEstimator(.6,.15,.95);g._rotationDirection=1;g._zoomDirection=1;g._zoomMomentumEstimator=new k.ZoomMomentumEstimator;g._zoomOnly=null;g.zoomMomentum=null;g.rotateMomentum=null;g.viewpoint=new E({targetGeometry:new e,scale:0,rotation:0});g.own(A.when(()=>g._momentumFinished,()=>g.navigation.stop()));return g}
q._inheritsLoose(r,m);var v=r.prototype;v.begin=function(x,g){this.navigation.begin();this._rotationMomentumEstimator.reset();this._zoomMomentumEstimator.reset();this._zoomOnly=null;this._previousAngle=this._startAngle=g.angle;this._previousRadius=this._startRadius=g.radius;this._previousCenter=g.center;this._updateTimestamp=null;x.constraints.rotationEnabled&&this.addToRotateEstimator(0,g.timestamp);this.addToZoomEstimator(g,1)};v.update=function(x,g){null===this._updateTimestamp&&(this._updateTimestamp=
g.timestamp);const u=g.angle,y=g.radius,z=g.center,w=Math.abs(180*(u-this._startAngle)/Math.PI),B=Math.abs(y-this._startRadius),F=this._startRadius/y;if(this._previousRadius){const G=y/this._previousRadius;let H=180*(u-this._previousAngle)/Math.PI;this._rotationDirection=0<=H?1:-1;this._zoomDirection=1<=G?1:-1;x.constraints.rotationEnabled?(null===this._zoomOnly&&200<g.timestamp-this._updateTimestamp&&(this._zoomOnly=0<B-w),null===this._zoomOnly||this._zoomOnly?H=0:this.addToRotateEstimator(u-this._startAngle,
g.timestamp)):H=0;this.addToZoomEstimator(g,F);this.navigation.setViewpoint([z.x,z.y],1/G,H,[this._previousCenter.x-z.x,z.y-this._previousCenter.y])}this._previousAngle=u;this._previousRadius=y;this._previousCenter=z};v.end=function(x){this.rotateMomentum=this._rotationMomentumEstimator.evaluateMomentum();this.zoomMomentum=this._zoomMomentumEstimator.evaluateMomentum();this._animationTime=0;if(this.rotateMomentum||this.zoomMomentum)this.onAnimationUpdate(x);this.navigation.end()};v.addToRotateEstimator=
function(x,g){this._rotationMomentumEstimator.add(x,.001*g)};v.addToZoomEstimator=function(x,g){this._zoomMomentumEstimator.add(g,.001*x.timestamp)};v.canZoomIn=function(x){const g=x.scale;x=x.constraints.effectiveMaxScale;return 0===x||g>x};v.canZoomOut=function(x){const g=x.scale;x=x.constraints.effectiveMinScale;return 0===x||g<x};v.onAnimationUpdate=function(x){this.navigation.animationManager.animateContinous(x.viewpoint,(g,u)=>{var y=!this.canZoomIn(x)&&1<this._zoomDirection||!this.canZoomOut(x)&&
1>this._zoomDirection,z=!this.rotateMomentum||this.rotateMomentum.isFinished(this._animationTime);y=y||!this.zoomMomentum||this.zoomMomentum.isFinished(this._animationTime);u*=.001;this._momentumFinished=z&&y;if(!this._momentumFinished){z=this.rotateMomentum?Math.abs(this.rotateMomentum.valueDelta(this._animationTime,u))*this._rotationDirection*180/Math.PI:0;y=this.zoomMomentum?Math.abs(this.zoomMomentum.valueDelta(this._animationTime,u)):1;const B=f.create();var w=f.create();if(this._previousCenter){c.set(B,
this._previousCenter.x,this._previousCenter.y);h.getPaddingScreenTranslation(w,x.size,x.padding);c.add(B,B,w);const {constraints:F,scale:G}=x;w=G*y;1>y&&!F.canZoomInTo(w)?(y=G/F.effectiveMaxScale,this.rotateMomentum=this.zoomMomentum=null):1<y&&!F.canZoomOutTo(w)&&(y=G/F.effectiveMinScale,this.rotateMomentum=this.zoomMomentum=null);h.scaleAndRotateBy(g,x.viewpoint,y,z,B,x.size);x.constraints.constrainByGeometry(g)}}this._animationTime+=u})};v.stopMomentumNavigation=function(){if(this.rotateMomentum||
this.zoomMomentum)this.rotateMomentum&&(this._rotationMomentumEstimator.reset(),this.rotateMomentum=null),this.zoomMomentum&&(this._zoomMomentumEstimator.reset(),this.zoomMomentum=null),this.navigation.stop()};return r}(C);t.__decorate([n.property()],D.prototype,"_momentumFinished",void 0);t.__decorate([n.property()],D.prototype,"viewpoint",void 0);t.__decorate([n.property()],D.prototype,"navigation",void 0);return D=t.__decorate([b.subclass("esri.views.2d.navigation.actions.Pinch")],D)})},"esri/views/navigation/RotationMomentumEstimator":function(){define(["exports",
"../../chunks/_rollupPluginBabelHelpers","./MomentumEstimator"],function(q,t,D){D=function(E){function C(A=3,n=.01,l=.95,d=12){return E.call(this,A,n,l,d)||this}t._inheritsLoose(C,E);C.prototype.add=function(A,n){if(this.value.hasLastValue){const l=this.value.lastValue;for(A-=l;A>Math.PI;)A-=2*Math.PI;for(;A<-Math.PI;)A+=2*Math.PI;A=l+A}E.prototype.add.call(this,A,n)};return C}(D.MomentumEstimator);q.RotationMomentumEstimator=D;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/navigation/MomentumEstimator":function(){define(["exports","../../core/mathUtils","./FilteredFiniteDifference","./Momentum"],function(q,t,D,E){let C=function(){function A(l=2.5,d=.01,a=.95,b=12){this.minimumInitialVelocity=l;this.stopVelocity=d;this.friction=a;this.maxVelocity=b;this.enabled=!0;this.value=new D.FilteredFiniteDifference(.8);this.time=new D.FilteredFiniteDifference(.3)}var n=A.prototype;n.add=function(l,d){if(this.enabled){if(this.time.hasLastValue){if(.01>this.time.computeDelta(d))return;
if(this.value.hasFilteredDelta){const a=this.value.computeDelta(l);0>this.value.filteredDelta*a&&this.value.reset()}}this.time.update(d);this.value.update(l)}};n.reset=function(){this.value.reset();this.time.reset()};n.evaluateMomentum=function(){if(!this.enabled||!this.value.hasFilteredDelta)return null;let l=this.value.filteredDelta/this.time.filteredDelta;l=t.clamp(l,-this.maxVelocity,this.maxVelocity);return Math.abs(l)<this.minimumInitialVelocity?null:this.createMomentum(l,this.stopVelocity,
this.friction)};n.createMomentum=function(l,d,a){return new E.Momentum(l,d,a)};return A}();q.MomentumEstimator=C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/navigation/ZoomMomentumEstimator":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./Momentum","./MomentumEstimator"],function(q,t,D,E){let C=function(A){function n(d,a,b){return A.call(this,d,a,b)||this}t._inheritsLoose(n,A);var l=n.prototype;l.value=function(d){d=
A.prototype.value.call(this,d);return Math.exp(d)};l.valueDelta=function(d,a){const b=A.prototype.value.call(this,d);d=A.prototype.value.call(this,d+a);return Math.exp(d-b)};return n}(D.Momentum);D=function(A){function n(d=2.5,a=.01,b=.95,c=12){return A.call(this,d,a,b,c)||this}t._inheritsLoose(n,A);var l=n.prototype;l.add=function(d,a){A.prototype.add.call(this,Math.log(d),a)};l.createMomentum=function(d,a,b){return new C(d,a,b)};return n}(E.MomentumEstimator);q.ZoomMomentum=C;q.ZoomMomentumEstimator=
D;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/navigation/actions/Rotate":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../viewpointUtils ../../../../geometry/Point".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c,f,h){const p=c.create(),k=c.create();D=function(e){function m(v){v=e.call(this,v)||this;v._previousCenter=c.create();v.viewpoint=new E({targetGeometry:new h,scale:0,rotation:0});return v}q._inheritsLoose(m,e);var r=m.prototype;r.begin=function(v,x){this.navigation.begin();b.set(this._previousCenter,x.center.x,x.center.y)};r.update=function(v,x){const {state:{size:g,padding:u}}=v;b.set(p,x.center.x,x.center.y);f.getAnchor(k,g,u);v.viewpoint=f.rotateBy(this.viewpoint,
v.state.paddedViewState.viewpoint,f.angleBetween(k,this._previousCenter,p));b.copy(this._previousCenter,p)};r.end=function(){this.navigation.end()};return m}(C);t.__decorate([A.property()],D.prototype,"viewpoint",void 0);t.__decorate([A.property()],D.prototype,"navigation",void 0);return D=t.__decorate([a.subclass("esri.views.2d.actions.Rotate")],D)})},"esri/views/2d/magnifier/MagnifierView2D":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../request ../../../core/Handles ../../../core/mathUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/urlUtils ../../../chunks/mat3f32 ../engine/DisplayObject ../engine/webgl/DefaultVertexAttributeLayouts ../engine/webgl/enums ../engine/webgl/shaders/MagnifierPrograms ../../magnifier/resources ../../webgl/BufferObject ../../webgl/enums ../../webgl/Texture ../../webgl/VertexArrayObject".split(" "),
function(q,t,D,E,C,A,n,l,d,a,b,c,f,h,p,k,e,m){return function(r){function v(){var g=r.call(this)||this;g._handles=new D;g._resourcePixelRatio=1;g.visible=!1;return g}q._inheritsLoose(v,r);var x=v.prototype;x.destroy=function(){this._handles.destroy();this._handles=null;this._disposeRenderResources();this._resourcesTask&&(this._resourcesTask.abort(),this._resourcesTask=null)};x._createTransforms=function(){return{dvs:d.create()}};x.doRender=function(g){const u=g.context;if(!this._resourcesTask)this._reloadResources();
else if(g.drawPhase===c.WGLDrawPhase.MAP&&this._canRender()){this._updateResources(g);var y=this._magnifier;if(!C.isNone(y.position)){var z=g.pixelRatio,w=y.size*z,B=Math.ceil(1/y.factor*w);this._readbackTexture.resize(B,B);var {size:F}=g.state;g=z*F[0];F=z*F[1];var G=.5*B,H=.5*B,I=E.clamp(z*y.position.x,G,g-G-1),L=E.clamp(F-z*y.position.y,H,F-H-1);u.setBlendingEnabled(!0);G=I-G;H=L-H;var N=this._readbackTexture;u.bindTexture(N,0);u.gl.copyTexImage2D(N.descriptor.target,0,N.descriptor.pixelFormat,
G,H,B,B,0);var J=(B=null==(J=this.background)?void 0:J.color)?[B.a*B.r/255,B.a*B.g/255,B.a*B.b/255,B.a]:[1,1,1,1];B=-1+(I+y.offset.x*z)/g*2;z=-1+(L-y.offset.y*z)/F*2;g=w/g*2;w=w/F*2;F=this._program;u.bindVAO(this._vertexArrayObject);u.bindTexture(this._overlayTexture,6);u.bindTexture(this._maskTexture,7);u.useProgram(F);F.setUniform4fv("u_background",J);F.setUniform1i("u_readbackTexture",0);F.setUniform1i("u_overlayTexture",6);F.setUniform1i("u_maskTexture",7);F.setUniform4f("u_drawPos",B,z,g,w);
F.setUniform1i("u_maskEnabled",y.maskEnabled?1:0);F.setUniform1i("u_overlayEnabled",y.overlayEnabled?1:0);u.setStencilTestEnabled(!1);u.setColorMask(!0,!0,!0,!0);u.drawArrays(k.PrimitiveType.TRIANGLE_STRIP,0,4);u.bindVAO()}}};x._canRender=function(){return this.mask&&this.overlay&&null!=this._magnifier};x._reloadResources=function(){var g=this;this._resourcesTask&&this._resourcesTask.abort();const u=C.isSome(this._magnifier)?this._magnifier.maskUrl:null,y=C.isSome(this._magnifier)?this._magnifier.overlayUrl:
null;this._resourcesTask=A.createTask(function(){var z=q._asyncToGenerator(function*(w){const B=C.isNone(u)||C.isNone(y)?h.loadMagnifierResources(w):null,F=C.isSome(u)?t(u,{responseType:"image",signal:w}).then(I=>I.data):B.then(I=>I.mask);w=C.isSome(y)?t(y,{responseType:"image",signal:w}).then(I=>I.data):B.then(I=>I.overlay);const [G,H]=yield Promise.all([F,w]);g.mask=G;g.overlay=H;g._disposeRenderResources();g.requestRender()});return function(w){return z.apply(this,arguments)}}())};x._disposeRenderResources=
function(){this._readbackTexture=C.disposeMaybe(this._readbackTexture);this._overlayTexture=C.disposeMaybe(this._overlayTexture);this._maskTexture=C.disposeMaybe(this._maskTexture);this._vertexArrayObject=C.disposeMaybe(this._vertexArrayObject);this._program=C.disposeMaybe(this._program)};x._updateResources=function(g){g.pixelRatio!==this._resourcePixelRatio&&this._disposeRenderResources();if(!this._readbackTexture){var u=g.context;this._resourcePixelRatio=g.pixelRatio;var y=Math.ceil(this._magnifier.size*
g.pixelRatio);this._program=f.createMagnifierProgram(u);var z=new Uint16Array([0,1,0,0,1,1,1,0]);this._vertexArrayObject=new m.VertexArrayObject(u,f.magnifierProgramTemplate.attributes,b.Pos2us,{geometry:p.BufferObject.createVertex(u,k.Usage.STATIC_DRAW,z)});this.overlay.width=y;this.overlay.height=y;this._overlayTexture=new e.Texture(u,{target:k.TextureType.TEXTURE_2D,pixelFormat:k.PixelFormat.RGBA,internalFormat:k.PixelFormat.RGBA,dataType:k.PixelType.UNSIGNED_BYTE,wrapMode:k.TextureWrapMode.CLAMP_TO_EDGE,
samplingMode:k.TextureSamplingMode.NEAREST,flipped:!0,preMultiplyAlpha:l.isSVG(this.overlay.src)&&g.context.driverTest.svgAlwaysPremultipliesAlpha?!1:!0},this.overlay);this.mask.width=y;this.mask.height=y;this._maskTexture=new e.Texture(u,{target:k.TextureType.TEXTURE_2D,pixelFormat:k.PixelFormat.ALPHA,internalFormat:k.PixelFormat.ALPHA,dataType:k.PixelType.UNSIGNED_BYTE,wrapMode:k.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:k.TextureSamplingMode.NEAREST,flipped:!0},this.mask);g=1/this._magnifier.factor;
this._readbackTexture=new e.Texture(u,{target:k.TextureType.TEXTURE_2D,pixelFormat:k.PixelFormat.RGBA,internalFormat:k.PixelFormat.RGBA,dataType:k.PixelType.UNSIGNED_BYTE,wrapMode:k.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:k.TextureSamplingMode.LINEAR,flipped:!1,width:Math.ceil(g*y),height:Math.ceil(g*y)})}};q._createClass(v,[{key:"background",get:function(){return this._background},set:function(g){this._background=g;this.requestRender()}},{key:"magnifier",get:function(){return this._magnifier},
set:function(g){this._magnifier=g;this._handles.removeAll();this._handles.add([n.watch(()=>g.version,()=>{this.visible=g.visible&&C.isSome(g.position)&&0<g.size;this.requestRender()},n.initial),n.watch(()=>[g.maskUrl,g.overlayUrl],()=>this._reloadResources()),n.watch(()=>g.size,()=>{this._disposeRenderResources();this.requestRender()})])}}]);return v}(a.DisplayObject)})},"esri/views/2d/engine/webgl/shaders/MagnifierPrograms":function(){define(["exports","./sources/resolver","../../../../webgl/ProgramTemplate"],
function(q,t,D){const E={shaders:{vertexShader:t.resolveIncludes("magnifier/magnifier.vert"),fragmentShader:t.resolveIncludes("magnifier/magnifier.frag")},attributes:new Map([["a_pos",0]])};q.createMagnifierProgram=function(C){return D.createProgram(C,E)};q.magnifierProgramTemplate=E;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/magnifier/resources":function(){define(["require","exports","../../chunks/_rollupPluginBabelHelpers","../../core/promiseUtils",
"../../support/requestImageUtils"],function(q,t,D,E,C){function A(){A=D._asyncToGenerator(function*(l){var d=new Promise((b,c)=>q(["./mask-svg"],f=>b(n(f)),c)),a=new Promise((b,c)=>q(["./overlay-svg"],f=>b(n(f)),c));d=C.requestImage((yield d).default,{signal:l});a=C.requestImage((yield a).default,{signal:l});a={mask:yield d,overlay:yield a};E.throwIfAborted(l);return a});return A.apply(this,arguments)}const n=l=>Object.freeze(Object.defineProperty({__proto__:null,default:l},Symbol.toStringTag,{value:"Module"}));
t.loadMagnifierResources=function(l){return A.apply(this,arguments)};Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/support/requestImageUtils":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","../request"],function(q,t,D){function E(){E=t._asyncToGenerator(function*(C,A){({data:C}=yield D(C,{responseType:"image",...A}));return C});return E.apply(this,arguments)}q.requestImage=function(C,A){return E.apply(this,arguments)};Object.defineProperties(q,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/libs/gl-matrix-2/mat4":function(){define(["exports","../../../chunks/mat4"],function(q,t){q.mat4=t.mat4;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/libs/gl-matrix-2/mat4f32":function(){define(["exports","../../../chunks/mat4f32"],function(q,t){q.mat4f32=t.mat4f32;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/libs/gl-matrix-2/vec3f32":function(){define(["exports",
"../../../chunks/vec3f32"],function(q,t){q.vec3f32=t.vec3f32;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/libs/gl-matrix-2/vec4f32":function(){define(["exports","../../../chunks/vec4f32"],function(q,t){q.vec4f32=t.vec4f32;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/Bitmap":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/mat3 ../../../chunks/mat3f32 ../../../chunks/vec2f32 ./DisplayObject ./ImageryBitmapSource ../../webgl/enums ../../webgl/Texture".split(" "),
function(q,t,D,E,C,A,n,l,d,a){function b(h){return h&&"render"in h}function c(h){const p=document.createElement("canvas");p.width=h.width;p.height=h.height;h.render(p.getContext("2d"));return p}function f(h,p,k){const e={target:d.TextureType.TEXTURE_2D,pixelFormat:d.PixelFormat.RGBA,internalFormat:d.PixelFormat.RGBA,dataType:d.PixelType.UNSIGNED_BYTE,wrapMode:d.TextureWrapMode.CLAMP_TO_EDGE};p&&k&&(e.width=p,e.height=k);return new a.Texture(h,e)}n=function(h){function p(e=null,m,r=!0){var v=h.call(this)||
this;v.requestRenderOnSourceChangedEnabled=r;v._textureInvalidated=!0;v.stencilRef=0;v.coordScale=[1,1];v._height=void 0;v.pixelRatio=1;v.resolution=0;v.rotation=0;v._source=null;v._width=void 0;v.x=0;v.y=0;v.blendFunction=m;v.source=e;v.requestRender=v.requestRender.bind(t._assertThisInitialized(v));return v}t._inheritsLoose(p,h);var k=p.prototype;k.destroy=function(){this._texture&&(this._texture.dispose(),this._texture=null)};k.beforeRender=function(e){h.prototype.beforeRender.call(this,e);this.updateTexture(e.context)};
k.invalidateTexture=function(){this._textureInvalidated||(this._textureInvalidated=!0,this.requestRenderOnSourceChangedEnabled&&this.requestRender())};k._createTransforms=function(){return{dvs:C.create()}};k.setTransform=function(e){const m=E.identity(this.transforms.dvs),[r,v]=e.toScreenNoRotation([0,0],[this.x,this.y]);var x=this.resolution/this.pixelRatio/e.resolution;const g=x*this.width;x*=this.height;const u=Math.PI*this.rotation/180;E.translate(m,m,A.fromValues(r,v));E.translate(m,m,A.fromValues(g/
2,x/2));E.rotate(m,m,-u);E.translate(m,m,A.fromValues(-g/2,-x/2));E.scaleByVec2(m,m,A.fromValues(g,x));E.multiply(this.transforms.dvs,e.displayViewMat3,m)};k.setSamplingProfile=function(e){this._texture&&(e.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(e.samplingMode))};k.bind=function(e,m){this._texture&&e.bindTexture(this._texture,m)};k.updateTexture=function(e){if(this.stage)this._textureInvalidated&&(this._textureInvalidated=!1,this._texture||
(this._texture=this.source?f(e,this.sourceWidth,this.sourceHeight):f(e)),(e=this.source)?(this._texture.resize(this.sourceWidth,this.sourceHeight),b(e)?e instanceof l?(e=e.getRenderedRasterPixels(),this._texture.setData(D.isSome(e)?e.renderedRasterPixels:null)):this._texture.setData(c(e)):!e||"render"in e||this._texture.setData(e),this.ready()):this._texture.setData(null));else{var m;null==(m=this._texture)?void 0:m.dispose();this._texture=null}};k.onAttach=function(){this.invalidateTexture()};k.onDetach=
function(){this.invalidateTexture()};t._createClass(p,[{key:"isSourceScaled",get:function(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight}},{key:"height",get:function(){return void 0!==this._height?this._height:this.sourceHeight},set:function(e){this._height=e}},{key:"source",get:function(){return this._source},set:function(e){this._source=e;this.invalidateTexture()}},{key:"sourceHeight",get:function(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:
this._source.height}},{key:"sourceWidth",get:function(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width}},{key:"width",get:function(){return void 0!==this._width?this._width:this.sourceWidth},set:function(e){this._width=e}}]);return p}(n.DisplayObject);q.Bitmap=n;q.isImageSource=b;q.rasterize=c;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/ImageryBitmapSource":function(){define(["../../../chunks/_rollupPluginBabelHelpers",
"../../../core/maybe"],function(q,t){return function(){function D(C,A,n){this.pixelBlock=C;this.extent=A;this.originalPixelBlock=n}var E=D.prototype;E.render=function(C){var A=this.pixelBlock;if(!t.isNone(A)){var n=this.filter({pixelBlock:A});t.isNone(n.pixelBlock)||(A=n.pixelBlock.getAsRGBA(),n=C.createImageData(n.pixelBlock.width,n.pixelBlock.height),n.data.set(A),C.putImageData(n,0,0))}};E.getRenderedRasterPixels=function(){const C=this.filter({pixelBlock:this.pixelBlock});return t.isNone(C.pixelBlock)?
null:{width:C.pixelBlock.width,height:C.pixelBlock.height,renderedRasterPixels:new Uint8Array(C.pixelBlock.getAsRGBA().buffer)}};q._createClass(D,[{key:"width",get:function(){return t.isSome(this.pixelBlock)?this.pixelBlock.width:0}},{key:"height",get:function(){return t.isSome(this.pixelBlock)?this.pixelBlock.height:0}}]);return D}()})},"esri/views/2d/engine/BitmapContainer":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","./brushes","./webgl/enums","./webgl/WGLContainer"],
function(q,t,D,E,C){C=function(A){function n(){return A.apply(this,arguments)||this}t._inheritsLoose(n,A);n.prototype.prepareRenderPasses=function(l){const d=l.registerRenderPass({name:"bitmap",brushes:[D.brushes.bitmap],target:()=>this.children,drawPhase:E.WGLDrawPhase.MAP});return[...A.prototype.prepareRenderPasses.call(this,l),d]};t._createClass(n,[{key:"requiresDedicatedFBO",get:function(){return this.children.some(l=>"additive"===l.blendFunction)}}]);return n}(C);q.BitmapContainer=C;Object.defineProperties(q,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/BitmapTile":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../chunks/mat3f32","./Bitmap","./webgl/TiledDisplayObject"],function(q,t,D,E,C){C=function(A){function n(d,a,b,c,f,h=null){var p=A.call(this,d,a,b,c,f)||this;p.bitmap=new E.Bitmap(h,"standard",!1);p.bitmap.coordScale=[c,f];p.bitmap.once("isReady",()=>p.ready());return p}t._inheritsLoose(n,A);var l=n.prototype;l.destroy=
function(){A.prototype.destroy.call(this);this.bitmap.destroy()};l.beforeRender=function(d){A.prototype.beforeRender.call(this,d);this.bitmap.beforeRender(d)};l.afterRender=function(d){A.prototype.afterRender.call(this,d);this.bitmap.afterRender(d)};l._createTransforms=function(){return{dvs:D.create(),tileMat3:D.create()}};l.setTransform=function(d,a){A.prototype.setTransform.call(this,d,a);this.bitmap.transforms.dvs=this.transforms.dvs};l.onAttach=function(){this.bitmap.stage=this.stage};l.onDetach=
function(){this.bitmap&&(this.bitmap.stage=null)};t._createClass(n,[{key:"stencilRef",get:function(){return this.bitmap.stencilRef},set:function(d){this.bitmap.stencilRef=d}}]);return n}(C.TiledDisplayObject);q.BitmapTile=C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/BitmapTileContainer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry/support/aaBoundingRect ./BitmapTile ./brushes ./webgl/enums ./webgl/TileContainer".split(" "),
function(q,t,D,E,C,A,n){n=function(l){function d(){return l.apply(this,arguments)||this}t._inheritsLoose(d,l);var a=d.prototype;a.createTile=function(b){const c=this._tileInfoView.getTileBounds(D.create(),b),[f,h]=this._tileInfoView.tileInfo.size;return new E.BitmapTile(b,c[0],c[3],f,h)};a.prepareRenderPasses=function(b){const c=b.registerRenderPass({name:"bitmap (tile)",brushes:[C.brushes.bitmap],target:()=>this.children.map(f=>f.bitmap),drawPhase:A.WGLDrawPhase.MAP});return[...l.prototype.prepareRenderPasses.call(this,
b),c]};a.doRender=function(b){this.visible&&b.drawPhase===A.WGLDrawPhase.MAP&&l.prototype.doRender.call(this,b)};t._createClass(d,[{key:"requiresDedicatedFBO",get:function(){return this.children.some(b=>"additive"===b.bitmap.blendFunction)}}]);return d}(n);q.BitmapTileContainer=n;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"*noref":1}});
define("exports ./engine/Stage ./LabelManager ./layers/graphics/GraphicsView2D ./layers/graphics/GraphicContainer ./navigation/MapViewNavigation ./magnifier/MagnifierView2D".split(" "),function(q,t,D,E,C,A,n){q.Stage=t.Stage;q.LabelManager=D;q.GraphicsView2D=E;q.GraphicContainer=C;q.MapViewNavigation=A;q.MagnifierView2D=n;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});