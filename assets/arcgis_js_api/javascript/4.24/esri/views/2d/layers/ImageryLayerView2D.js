// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/2d/engine/flow/FlowView2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../Graphic ../../../../core/HandleOwner ../../../../core/reactiveUtils ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ./createFlowStyle ./dataUtils ./FlowContainer ./FlowStrategy".split(" "),function(v,
A,C,E,n,x,m,I,r,J,y,M,Y,Z){E=function(T){function P(){var k=T.apply(this,arguments)||this;k._loadImagery=(w,S,N,D,F)=>M.loadImagery(k.layer,w,S,N,D,F);k._createFlowMesh=(w,S,N,D)=>k.layer.createFlowMesh({meshType:w,flowData:N,simulationSettings:S},{signal:D});k.attached=!1;k.container=null;k.layer=null;k.type="flow";k.timeExtent=null;k.redrawOrRefetch=v._asyncToGenerator(function*(){k._updateVisualization()});return k}v._inheritsLoose(P,T);var z=P.prototype;z.attach=function(){const {layer:k}=this,
w=()=>{this._loadImagery=(S,N,D,F,c)=>M.loadImagery(k,S,N,D,F,c);this._updateVisualization()};"multidimensionalDefinition"in k?this.handles.add(n.watch(()=>k.multidimensionalDefinition,w)):this.handles.add([n.watch(()=>k.mosaicRule,w),n.watch(()=>k.renderingRule,w),n.watch(()=>k.definitionExpression,w)]);this.container=new Y;this._strategy=new Z({flowContainer:this.container});this._updateVisualization()};z.detach=function(){this._strategy.destroy();this.container.removeAllChildren();this.container=
null;this.handles.removeAll()};z.update=function(k){k.stationary?this._strategy.update(k):this.layerView.requestUpdate()};z.hitTest=function(k){return new C({attributes:{},geometry:k.clone(),layer:this.layer})};z.moveEnd=function(){};z.doRefresh=function(){var k=v._asyncToGenerator(function*(){});return function(){return k.apply(this,arguments)}}();z._updateVisualization=function(){var {renderer:k}=this.layer;"flow"===k.type&&(k=y(k,{loadImagery:this._loadImagery,createFlowMesh:this._createFlowMesh,
timeExtent:this.timeExtent}),this.container.flowStyle=k,this.layerView.requestUpdate())};v._createClass(P,[{key:"updating",get:function(){return!this._strategy||this._strategy.updating}}]);return P}(E.HandleOwner);A.__decorate([x.property()],E.prototype,"_strategy",void 0);A.__decorate([x.property()],E.prototype,"attached",void 0);A.__decorate([x.property()],E.prototype,"container",void 0);A.__decorate([x.property()],E.prototype,"layer",void 0);A.__decorate([x.property()],E.prototype,"layerView",
void 0);A.__decorate([x.property()],E.prototype,"type",void 0);A.__decorate([x.property()],E.prototype,"updating",null);A.__decorate([x.property()],E.prototype,"timeExtent",void 0);return E=A.__decorate([J.subclass("esri.views.2d.engine.flow.FlowView2D")],E)})},"esri/views/2d/engine/flow/createFlowStyle":function(){define("../../../../core/maybe ./utils ./styles/Imagery ./styles/Particles ./styles/Stack ./styles/Streamlines".split(" "),function(v,A,C,E,n,x){return function(m,I){const {flowSpeed:r,
trailLength:J}=m,y=A.getFlowSimulationSettings(m);let M=null;const Y={opacity:A.getOpacity(m),size:A.getSize(m)};let Z=A.getColor(m);"none"===m.background?Y.color=Z:("constant"===Z.kind&&(Z={kind:"ramp",stops:[0,1],values:[0,0,0,1,Z.value[0],Z.value[1],Z.value[2],Z.value[3]],count:2}),M=new C.default({loadImagery:I.loadImagery,timeExtent:I.timeExtent,color:Z,opacity:{kind:"constant",value:[1]}}),Y.color=A.getForegroundColor());I={loadImagery:I.loadImagery,createFlowMesh:I.createFlowMesh,simulationSettings:y,
timeExtent:I.timeExtent,trailLength:J,flowSpeed:r,featheringSize:1,featheringOffset:.5,introFade:!0,fadeToZero:!0,decayRate:2.3,color:Y.color,opacity:Y.opacity,size:Y.size};m="butt"===m.trailCap||4>=A.getMax(A.getSize(m))?new x(I):new E.default(I);return v.isSome(M)?new n.default([M,m]):m}})},"esri/views/2d/engine/flow/utils":function(){define(["exports","../../../../core/maybe","../../../../core/screenUtils"],function(v,A,C){function E(r){return"constant"===r.kind?r.value[0]:r.values[r.values.length-
1]}function n(r){r=r.toRgba();return[r[0]/255,r[1]/255,r[2]/255,r[3]]}function x(r){if(!r.hasVisualVariables("size"))return{kind:"constant",value:[C.pt2px(r.trailWidth)]};const J=r.getVisualVariablesForType("size")[0];r=[];const y=[];if(J.stops){for(M of J.stops)r.push(M.value),y.push(C.pt2px(M.size));var M=J.stops.length}else r.push(J.minDataValue,J.maxDataValue),y.push(C.pt2px(J.minSize),C.pt2px(J.maxSize)),M=2;return{kind:"ramp",stops:r,values:y,count:M}}function m(r,J,y,M){switch(J){case "int":r.setUniform1iv(y,
M);break;case "float":r.setUniform1fv(y,M);break;case "vec2":r.setUniform2fv(y,M);break;case "vec3":r.setUniform3fv(y,M);break;case "vec4":r.setUniform4fv(y,M)}}function I(r,J){return r===J?!0:A.isSome(r)&&A.isSome(J)?r.equals(J):!1}v.areStreamlinesCompatible=function(r,J){{var y=r.simulationSettings;var M=J.simulationSettings;let Y;y=Y=(Y=(Y=(Y=(Y=(Y=(Y=(Y=(Y=(Y=(Y=y.collisions===M.collisions)&&y.density===M.density)&&y.interpolate===M.interpolate)&&y.lineCollisionWidth===M.lineCollisionWidth)&&
y.lineSpacing===M.lineSpacing)&&y.maxTurnAngle===M.maxTurnAngle)&&y.minSpeedThreshold===M.minSpeedThreshold)&&y.segmentLength===M.segmentLength)&&y.smoothing===M.smoothing)&&y.velocityScale===M.velocityScale)&&y.verticesPerLine===M.verticesPerLine}return y&&I(r.timeExtent,J.timeExtent)?y=(y=(y=(y=(y=r.loadImagery===J.loadImagery)&&r.createFlowMesh===J.createFlowMesh)&&r.color.kind===J.color.kind)&&r.opacity.kind===J.opacity.kind)&&r.size.kind===J.size.kind:!1};v.getColor=function(r){if(!r.hasVisualVariables("color"))return{kind:"constant",
value:n(r.color)};r=r.getVisualVariablesForType("color")[0];const J=[],y=[];for(const M of r.stops)J.push(M.value),Array.prototype.push.apply(y,n(M.color));return{kind:"ramp",stops:J,values:y,count:r.stops.length}};v.getFlowSimulationSettings=function(r){var J=x(r);J=E(J);const y=Math.max(J/2,5),M=Math.round(C.pt2px(r.maxPathLength)/y)+1,{density:Y}=r;return{smoothing:C.pt2px(r.smoothing),interpolate:!0,velocityScale:"flow-from"===r.flowRepresentation?1:-1,verticesPerLine:M,minSpeedThreshold:.001,
segmentLength:y,maxTurnAngle:1,collisions:!0,lineCollisionWidth:J,lineSpacing:10,density:Y}};v.getForegroundColor=function(r){return{kind:"constant",value:[.1,.1,.1,1]}};v.getMax=E;v.getOpacity=function(r){if(!r.hasVisualVariables("opacity"))return{kind:"constant",value:[1]};r=r.getVisualVariablesForType("opacity")[0];const J=[],y=[];for(const M of r.stops)J.push(M.value),y.push(M.opacity);return{kind:"ramp",stops:J,values:y,count:r.stops.length}};v.getSize=x;v.setUniform=m;v.setUniforms=function(r,
J,y,M){"constant"===M.kind?m(r,y,`u_${J}`,M.value):(m(r,"float",`u_${J}_stops`,M.stops),m(r,y,`u_${J}_values`,M.values),r.setUniform1i(`u_${J}_count`,M.count))};v.timeExtentsEqual=I;v.toRgba=n;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/flow/styles/Imagery":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/promiseUtils ../utils ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/VertexElementDescriptor".split(" "),
function(v,A,C,E,n,x,m,I,r){let J=function(){function T(z){this._params=z;this.animated=!1}var P=T.prototype;P.isCompatible=function(z){if(!(z instanceof T&&E.timeExtentsEqual(this._params.timeExtent,z._params.timeExtent)))return!1;let k;return k=(k=(k=this._params.loadImagery===z._params.loadImagery)&&this._params.color.kind===z._params.color.kind)&&this._params.opacity.kind===z._params.opacity.kind};P.load=function(){var z=A._asyncToGenerator(function*(k,w){const {extent:S,size:N}=k;C.throwIfAborted(w);
k=yield this._params.loadImagery(S,N[0],N[1],this._params.timeExtent,w);return new Z(k,{color:this._params.color,opacity:this._params.opacity})});return function(k,w){return z.apply(this,arguments)}}();P.render=function(z,k,w){({context:z}=z);const {program:S}=w;z.setFaceCullingEnabled(!1);z.setBlendingEnabled(!0);z.setBlendFunction(x.BlendFactor.ONE,x.BlendFactor.ONE_MINUS_SRC_ALPHA);z.useProgram(S);S.setUniformMatrix3fv("u_dvsMat3",k.dvsMat3);z.bindTexture(w.texture,0);S.setUniform1i("u_texture",
0);S.setUniform1f("u_Min",w.min);S.setUniform1f("u_Max",w.max);E.setUniforms(S,"color","vec4",this._params.color);E.setUniforms(S,"opacity","float",this._params.opacity);z.bindVAO(w.vertexArray);z.drawArrays(x.PrimitiveType.TRIANGLE_STRIP,0,4)};return T}();const y=new Map;y.set("a_position",0);y.set("a_texcoord",1);const M={geometry:[new r.VertexElementDescriptor("a_position",2,x.DataType.UNSIGNED_SHORT,0,8),new r.VertexElementDescriptor("a_texcoord",2,x.DataType.UNSIGNED_SHORT,4,8)]},Y={vsPath:"raster/flow/imagery",
fsPath:"raster/flow/imagery",attributes:y};let Z=function(){function T(z,k){this._flowData=z;this._values=k}var P=T.prototype;P.attach=function(z){var {context:k}=z;const {width:w,height:S}=this._flowData;var N={geometry:n.BufferObject.createVertex(k,x.Usage.STATIC_DRAW,new Uint16Array([0,0,0,1,w,0,1,1,0,S,0,0,w,S,1,0]))};N=new I.VertexArrayObject(k,y,M,N);var D=[];"ramp"===this._values.color.kind&&D.push("vvColor");"ramp"===this._values.opacity.kind&&D.push("vvOpacity");z=z.painter.materialManager.getProgram(Y,
D);D=1E6;let F=-1E6;for(var c=0;c<S;c++)for(var b=0;b<w;b++)if(0!==this._flowData.mask[c*w+b]){var e=this._flowData.data[2*(c*w+b)],h=this._flowData.data[2*(c*w+b)+1];e=Math.sqrt(e*e+h*h);D=Math.min(D,e);F=Math.max(F,e)}c=new Uint8Array(4*w*S);for(b=0;b<S;b++)for(e=0;e<w;e++)if(0!==this._flowData.mask[b*w+e]){h=this._flowData.data[2*(b*w+e)];const f=this._flowData.data[2*(b*w+e)+1];c[4*(b*w+e)]=(Math.sqrt(h*h+f*f)-D)/(F-D)*255;c[4*(b*w+e)+1]=0;c[4*(b*w+e)+2]=0;c[4*(b*w+e)+3]=255}else c[4*(b*w+e)]=
0,c[4*(b*w+e)+1]=0,c[4*(b*w+e)+2]=0,c[4*(b*w+e)+3]=0;k=new m.Texture(k,{pixelFormat:x.PixelFormat.RGBA,internalFormat:x.PixelFormat.RGBA,samplingMode:x.TextureSamplingMode.LINEAR,dataType:x.PixelType.UNSIGNED_BYTE,wrapMode:x.TextureWrapMode.CLAMP_TO_EDGE,flipped:!0,width:w,height:S},c);this.vertexArray=N;this.program=z;this.texture=k;this.min=D;this.max=F;this._flowData=null};P.detach=function(){this.vertexArray.dispose();this.texture.dispose()};A._createClass(T,[{key:"ready",get:function(){return this.program.isCompiled}}]);
return T}();v.ImageryResources=Z;v.default=J;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/flow/styles/Particles":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/promiseUtils ../utils ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/VertexArrayObject ../../../../webgl/VertexElementDescriptor".split(" "),function(v,A,C,E,n,x,m,I){let r=function(){function Z(P){this._params=
P}var T=Z.prototype;T.isCompatible=function(P){return P instanceof Z?E.areStreamlinesCompatible(this._params,P._params):!1};T.load=function(){var P=A._asyncToGenerator(function*(z,k){const {extent:w,size:S}=z;C.throwIfAborted(k);z=yield this._params.loadImagery(w,S[0],S[1],this._params.timeExtent,k);const {vertexData:N,indexData:D}=yield this._params.createFlowMesh("Particles",this._params.simulationSettings,z,k);return new Y(N,D,{color:this._params.color,opacity:this._params.opacity,size:this._params.size})});
return function(z,k){return P.apply(this,arguments)}}();T.render=function(P,z,k){({context:P}=P);const {program:w}=k;P.setFaceCullingEnabled(!1);P.setBlendingEnabled(!0);P.setBlendFunction(x.BlendFactor.ONE,x.BlendFactor.ONE_MINUS_SRC_ALPHA);P.useProgram(w);w.setUniform1f("u_time",z.time);w.setUniform1f("u_trailLength",this._params.trailLength);w.setUniform1f("u_flowSpeed",this._params.flowSpeed);w.setUniform1f("u_featheringSize",this._params.featheringSize);w.setUniform1f("u_featheringOffset",this._params.featheringOffset);
w.setUniform1f("u_introFade",this._params.introFade?1:0);w.setUniform1f("u_fadeToZero",this._params.fadeToZero?1:0);w.setUniform1f("u_decayRate",this._params.decayRate);w.setUniformMatrix3fv("u_dvsMat3",z.dvsMat3);w.setUniformMatrix3fv("u_displayViewMat3",z.displayViewMat3);E.setUniforms(w,"color","vec4",this._params.color);E.setUniforms(w,"opacity","float",this._params.opacity);E.setUniforms(w,"size","float",this._params.size);P.bindVAO(k.vertexArray);P.drawElements(x.PrimitiveType.TRIANGLES,k.indexCount,
x.DataType.UNSIGNED_INT,0)};A._createClass(Z,[{key:"animated",get:function(){return 0<this._params.flowSpeed}}]);return Z}();const J=new Map;J.set("a_xyts0",0);J.set("a_xyts1",1);J.set("a_typeIdDurationSeed",2);J.set("a_extrudeInfo",3);const y={geometry:[new I.VertexElementDescriptor("a_xyts0",4,x.DataType.FLOAT,0,64),new I.VertexElementDescriptor("a_xyts1",4,x.DataType.FLOAT,16,64),new I.VertexElementDescriptor("a_typeIdDurationSeed",4,x.DataType.FLOAT,32,64),new I.VertexElementDescriptor("a_extrudeInfo",
4,x.DataType.FLOAT,48,64)]},M={vsPath:"raster/flow/particles",fsPath:"raster/flow/particles",attributes:J};let Y=function(){function Z(P,z,k){this._vertexData=P;this._indexData=z;this._values=k}var T=Z.prototype;T.attach=function(P){var {context:z}=P,k=n.BufferObject.createVertex(z,x.Usage.STATIC_DRAW,this._vertexData);const w=n.BufferObject.createIndex(z,x.Usage.STATIC_DRAW,this._indexData);z=new m.VertexArrayObject(z,J,y,{geometry:k},w);k=[];"ramp"===this._values.color.kind&&k.push("vvColor");"ramp"===
this._values.opacity.kind&&k.push("vvOpacity");"ramp"===this._values.size.kind&&k.push("vvSize");P=P.painter.materialManager.getProgram(M,k);this.vertexArray=z;this.program=P;this.indexCount=this._indexData.length;this._indexData=this._vertexData=null};T.detach=function(){this.vertexArray.dispose()};A._createClass(Z,[{key:"ready",get:function(){return this.program.isCompiled}}]);return Z}();v.ParticlesResources=Y;v.default=r;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/engine/flow/styles/Stack":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers"],function(v,A){let C=function(){function n(m){this._styles=m}var x=n.prototype;x.isCompatible=function(m){if(!(m instanceof n)||this._styles.length!==m._styles.length)return!1;const I=this._styles.length;for(let r=0;r<I;r++)if(!this._styles[r].isCompatible(m._styles[r]))return!1;return!0};x.load=function(){var m=A._asyncToGenerator(function*(I,r){const J=yield Promise.all(this._styles.map(y=>
y.load(I,r)));return new E(J)});return function(I,r){return m.apply(this,arguments)}}();x.render=function(m,I,r){for(let J=0;J<this._styles.length;J++)this._styles[J].render(m,I,r.resources[J])};A._createClass(n,[{key:"animated",get:function(){return this._styles.reduce((m,I)=>m||I.animated,!1)}}]);return n}(),E=function(){function n(m){this.resources=m}var x=n.prototype;x.attach=function(m){for(const I of this.resources)I.attach(m)};x.detach=function(){for(const m of this.resources)m.detach()};A._createClass(n,
[{key:"ready",get:function(){return this.resources.reduce((m,I)=>m&&I.ready,!0)}}]);return n}();v.StackResources=E;v.default=C;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/flow/styles/Streamlines":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/promiseUtils ../utils ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/VertexArrayObject ../../../../webgl/VertexElementDescriptor".split(" "),
function(v,A,C,E,n,x,m){let I=function(){function Y(T){this._params=T}var Z=Y.prototype;Z.isCompatible=function(T){return T instanceof Y?C.areStreamlinesCompatible(this._params,T._params):!1};Z.load=function(){var T=v._asyncToGenerator(function*(P,z){const {extent:k,size:w}=P;A.throwIfAborted(z);P=yield this._params.loadImagery(k,w[0],w[1],this._params.timeExtent,z);const {vertexData:S,indexData:N}=yield this._params.createFlowMesh("Streamlines",this._params.simulationSettings,P,z);return new M(S,
N,{color:this._params.color,opacity:this._params.opacity,size:this._params.size})});return function(P,z){return T.apply(this,arguments)}}();Z.render=function(T,P,z){({context:T}=T);const {program:k}=z;T.setFaceCullingEnabled(!1);T.setBlendingEnabled(!0);T.setBlendFunction(n.BlendFactor.ONE,n.BlendFactor.ONE_MINUS_SRC_ALPHA);T.useProgram(k);k.setUniform1f("u_time",P.time);k.setUniform1f("u_trailLength",this._params.trailLength);k.setUniform1f("u_flowSpeed",this._params.flowSpeed);k.setUniform1f("u_featheringSize",
this._params.featheringSize);k.setUniform1f("u_featheringOffset",this._params.featheringOffset);k.setUniform1f("u_introFade",this._params.introFade?1:0);k.setUniform1f("u_fadeToZero",this._params.fadeToZero?1:0);k.setUniform1f("u_decayRate",this._params.decayRate);k.setUniformMatrix3fv("u_dvsMat3",P.dvsMat3);k.setUniformMatrix3fv("u_displayViewMat3",P.displayViewMat3);C.setUniforms(k,"color","vec4",this._params.color);C.setUniforms(k,"opacity","float",this._params.opacity);C.setUniforms(k,"size",
"float",this._params.size);T.bindVAO(z.vertexArray);T.drawElements(n.PrimitiveType.TRIANGLES,z.indexCount,n.DataType.UNSIGNED_INT,0)};v._createClass(Y,[{key:"animated",get:function(){return 0<this._params.flowSpeed}}]);return Y}();const r=new Map;r.set("a_positionAndSide",0);r.set("a_timeInfo",1);r.set("a_extrude",2);r.set("a_speed",3);const J={geometry:[new m.VertexElementDescriptor("a_positionAndSide",3,n.DataType.FLOAT,0,36),new m.VertexElementDescriptor("a_timeInfo",3,n.DataType.FLOAT,12,36),
new m.VertexElementDescriptor("a_extrude",2,n.DataType.FLOAT,24,36),new m.VertexElementDescriptor("a_speed",1,n.DataType.FLOAT,32,36)]},y={vsPath:"raster/flow/streamlines",fsPath:"raster/flow/streamlines",attributes:r};let M=function(){function Y(T,P,z){this._vertexData=T;this._indexData=P;this._values=z}var Z=Y.prototype;Z.attach=function(T){var {context:P}=T,z=E.BufferObject.createVertex(P,n.Usage.STATIC_DRAW,this._vertexData);const k=E.BufferObject.createIndex(P,n.Usage.STATIC_DRAW,this._indexData);
P=new x.VertexArrayObject(P,r,J,{geometry:z},k);z=[];"ramp"===this._values.color.kind&&z.push("vvColor");"ramp"===this._values.opacity.kind&&z.push("vvOpacity");"ramp"===this._values.size.kind&&z.push("vvSize");T=T.painter.materialManager.getProgram(y,z);this.vertexArray=P;this.program=T;this.indexCount=this._indexData.length;this._indexData=this._vertexData=null};Z.detach=function(){this.vertexArray.dispose()};v._createClass(Y,[{key:"ready",get:function(){return this.program.isCompiled}}]);return Y}();
return I})},"esri/views/2d/engine/flow/dataUtils":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../geometry ../../../../core/has ../../../../core/Logger ../../../../core/mathUtils ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/RandomLCG ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/Extent".split(" "),function(v,A,C,E,n,x,m,I,r,J,y){function M(){M=A._asyncToGenerator(function*(b,e,h,f){const l=performance.now();var G=
Y(e,h);const L=performance.now();h=T(e,G,h.width,h.height);e=performance.now();G=z(h,!0);h=performance.now();b="Streamlines"===b?k(G,10):w(G);G=performance.now();E("esri-2d-profiler")&&(c.info("I.1","_createFlowFieldFromData (ms)",Math.round(L-l)),c.info("I.2","_getStreamlines (ms)",Math.round(e-L)),c.info("I.3","createAnimatedLinesData (ms)",Math.round(h-e)),c.info("I.4","create{Streamlines|Particles}Mesh (ms)",Math.round(G-h)),c.info("I.5","createFlowMesh (ms)",Math.round(G-l)),c.info("I.6","Mesh size (bytes)",
b.vertexData.buffer.byteLength+b.indexData.buffer.byteLength));yield Promise.resolve();I.throwIfAborted(f);return b});return M.apply(this,arguments)}function Y(b,e){const h=P(e.data,e.width,e.height,b.smoothing);return b.interpolate?(f,l)=>{const G=Math.floor(f),L=Math.floor(l);if(0>G||G>=e.width||0>L||L>=e.height)return[0,0];f-=G;l-=L;const H=G<e.width-1?G+1:G,W=L<e.height-1?L+1:L;return[(h[2*(L*e.width+G)]*(1-l)+h[2*(W*e.width+G)]*l)*(1-f)+(h[2*(L*e.width+H)]*(1-l)+h[2*(W*e.width+H)]*l)*f,(h[2*
(L*e.width+G)+1]*(1-l)+h[2*(W*e.width+G)+1]*l)*(1-f)+(h[2*(L*e.width+H)+1]*(1-l)+h[2*(W*e.width+H)+1]*l)*f]}:(f,l)=>{f=Math.round(f);l=Math.round(l);return 0>f||f>=e.width||0>l||l>=e.height?[0,0]:[h[2*(l*e.width+f)],h[2*(l*e.width+f)+1]]}}function Z(b,e,h,f,l,G,L,H,W){const U=[];let O=0,[Q,X]=e(h,f);Q*=b.velocityScale;X*=b.velocityScale;U.push({x:h,y:f,t:O,speed:Math.sqrt(Q*Q+X*X)});for(let ha=0;ha<b.verticesPerLine;ha++){let [a,d]=e(h,f);a*=b.velocityScale;d*=b.velocityScale;const g=Math.sqrt(a*
a+d*d);if(g<b.minSpeedThreshold)break;const q=a/g,B=d/g;h+=q*b.segmentLength;f+=B*b.segmentLength;O+=b.segmentLength/g;if(Math.acos(q*fa+B*ca)>b.maxTurnAngle)break;if(b.collisions){var fa=Math.round(h*W);var ca=Math.round(f*W);if(0>fa||fa>L-1||0>ca||ca>H-1)break;const t=G[ca*L+fa];if(-1!==t&&t!==l)break;G[ca*L+fa]=l}U.push({x:h,y:f,t:O,speed:g});fa=q;ca=B}return U}function T(b,e,h,f){const l=[],G=new r,L=1/Math.max(b.lineCollisionWidth,1),H=Math.round(h*L),W=Math.round(f*L),U=new Int32Array(H*W);
for(var O=0;O<U.length;O++)U[O]=-1;O=[];for(let Q=0;Q<f;Q+=b.lineSpacing)for(let X=0;X<h;X+=b.lineSpacing)O.push({x:X,y:Q,sort:G.getFloat()});O.sort((Q,X)=>Q.sort-X.sort);for(const {x:Q,y:X}of O)G.getFloat()<b.density&&(h=Z(b,e,Q,X,l.length,U,H,W,L),2>h.length||l.push(h));return l}function P(b,e,h,f){if(0===f)return b;const l=Math.round(3*f),G=Array(2*l+1);var L=0;for(var H=-l;H<=l;H++){var W=Math.exp(-H*H/(f*f));G[H+l]=W;L+=W}for(f=-l;f<=l;f++)G[f+l]/=L;L=new Float32Array(b.length);for(f=0;f<h;f++)for(H=
0;H<e;H++){var U=W=0;for(var O=-l;O<=l;O++)if(!(0>H+O||H+O>=e)){var Q=G[O+l];W+=Q*b[2*(f*e+(H+O))];U+=Q*b[2*(f*e+(H+O))+1]}L[2*(f*e+H)]=W;L[2*(f*e+H)+1]=U}b=new Float32Array(b.length);for(f=0;f<e;f++)for(H=0;H<h;H++){U=W=0;for(O=-l;O<=l;O++)0>H+O||H+O>=h||(Q=G[O+l],W+=Q*L[2*((H+O)*e+f)],U+=Q*L[2*((H+O)*e+f)+1]);b[2*(H*e+f)]=W;b[2*(H*e+f)+1]=U}return b}function z(b,e){const h=new r;var f=b.reduce((H,W)=>H+W.length,0);f=new Float32Array(4*f);const l=Array(b.length);let G=0,L=0;for(const H of b){b=G;
for(const W of H)f[4*G]=W.x,f[4*G+1]=W.y,f[4*G+2]=W.t,f[4*G+3]=W.speed,G++;l[L++]={startVertex:b,numberOfVertices:H.length,totalTime:H[H.length-1].t,timeSeed:e?h.getFloat():0}}return{lineVertices:f,lineDescriptors:l}}function k(b,e){function h(fa,ca,ha,a,d,g,q,B){const t=9*W;let p=0;H[t+p++]=fa;H[t+p++]=ca;H[t+p++]=1;H[t+p++]=ha;H[t+p++]=g;H[t+p++]=q;H[t+p++]=a/2;H[t+p++]=d/2;H[t+p++]=B;W++;H[t+p++]=fa;H[t+p++]=ca;H[t+p++]=-1;H[t+p++]=ha;H[t+p++]=g;H[t+p++]=q;H[t+p++]=-a/2;H[t+p++]=-d/2;H[t+p++]=
B;W++}const {lineVertices:f,lineDescriptors:l}=b;var G=b=0;for(var L of l)b+=2*L.numberOfVertices,G+=6*(L.numberOfVertices-1);const H=new Float32Array(9*b);L=new Uint32Array(G);let W=0;b=0;for(const fa of l){const {totalTime:ca,timeSeed:ha}=fa;let a=G=null,d=null;var U=null,O=null,Q=null;for(let g=0;g<fa.numberOfVertices;g++){U=f[4*(fa.startVertex+g)];const q=f[4*(fa.startVertex+g)+1],B=f[4*(fa.startVertex+g)+2],t=f[4*(fa.startVertex+g)+3];let p=null,K=null;var X=null;let u=null;0<g&&(p=U-G,K=q-a,
X=Math.sqrt(p*p+K*K),p/=X,K/=X,1<g?(O=p+O,Q=K+Q,X=Math.sqrt(O*O+Q*Q),O/=X,Q/=X,X=Math.min(1/(O*p+Q*K),e),O*=X,Q*=X,X=-Q,u=O):(X=-K,u=p),null!==X&&null!==u&&(h(G,a,d,X,u,ca,ha,t),L[b++]=W-2,L[b++]=W,L[b++]=W-1,L[b++]=W,L[b++]=W+1,L[b++]=W-1));G=U;a=q;d=B;O=p;Q=K;U=t}h(G,a,d,-Q,O,ca,ha,U)}return{vertexData:H,indexData:L}}function w(b){function e(R,aa){var da=B+p,ba=t+K,ja=Math.sqrt(da*da+ba*ba);da/=ja;ba/=ja;var ka=B*da+t*ba,ia=p+u,ea=K+V;ja=Math.sqrt(ia*ia+ea*ea);ia/=ja;ea/=ja;var la=p*ia+K*ea;{ja=
X;var oa=fa,pa=ca,qa=ha;ba=-(ba/ka);da/=ka;ka=a;var ua=d,va=g,ra=q;ea=-(ea/la);ia/=la;la=16*O;let na=0;for(const wa of[1,2])for(const xa of[1,2,3,4])W[la+na++]=ja,W[la+na++]=oa,W[la+na++]=pa,W[la+na++]=qa,W[la+na++]=ka,W[la+na++]=ua,W[la+na++]=va,W[la+na++]=ra,W[la+na++]=wa,W[la+na++]=xa,W[la+na++]=R,W[la+na++]=aa,W[la+na++]=ba/2,W[la+na++]=da/2,W[la+na++]=ea/2,W[la+na++]=ia/2,O++}U[Q++]=O-8;U[Q++]=O-7;U[Q++]=O-6;U[Q++]=O-7;U[Q++]=O-5;U[Q++]=O-6;U[Q++]=O-4;U[Q++]=O-3;U[Q++]=O-2;U[Q++]=O-3;U[Q++]=
O-1;U[Q++]=O-2}function h(R,aa,da,ba,ja,ka){B=p;t=K;p=u;K=V;null==B&&null==t&&(B=p,t=K);if(null!=a&&null!=d){u=R-a;V=aa-d;const ia=Math.sqrt(u*u+V*V);u/=ia;V/=ia}null!=B&&null!=t&&e(ja,ka);X=a;fa=d;ca=g;ha=q;a=R;d=aa;g=da;q=ba}function f(R,aa){B=p;t=K;p=u;K=V;null==B&&null==t&&(B=p,t=K);null!=B&&null!=t&&e(R,aa)}const {lineVertices:l,lineDescriptors:G}=b;let L=b=0;for(var H of G){const R=H.numberOfVertices-1;b+=8*R;L+=12*R}const W=new Float32Array(16*b),U=new Uint32Array(L);let O=0,Q=0,X,fa,ca,ha,
a,d,g,q,B,t,p,K,u,V;for(const R of G){V=u=K=p=t=B=q=g=d=a=ha=ca=fa=X=null;const {totalTime:aa,timeSeed:da}=R;for(H=0;H<R.numberOfVertices;H++)h(l[4*(R.startVertex+H)],l[4*(R.startVertex+H)+1],l[4*(R.startVertex+H)+2],l[4*(R.startVertex+H)+3],aa,da);f(aa,da)}return{vertexData:W,indexData:U}}function S(b,e){const h=e.pixels,{width:f,height:l}=e,G=new Float32Array(f*l*2),L=e.mask||new Uint8Array(f*l*2);e.mask||L.fill(255);if("vector-uv"===b)for(b=0;b<f*l;b++)G[2*b]=h[0][b],G[2*b+1]=-h[1][b];else if("vector-magdir"===
b)for(b=0;b<f*l;b++){e=h[0][b];const H=x.deg2rad(h[1][b]),W=Math.sin(H-Math.PI/2);G[2*b]=Math.cos(H-Math.PI/2)*e;G[2*b+1]=W*e}return{data:G,mask:L,width:f,height:l}}function N(){N=A._asyncToGenerator(function*(b,e,h,f,l,G){const L=performance.now();var H=J.getInfo(e.spatialReference);if(!H)return h=yield D(b,e,h,f,l,G),E("esri-2d-profiler")&&c.info("I.7","loadImagery, early exit (ms)",Math.round(performance.now()-L)),E("esri-2d-profiler")&&c.info("I.9","Number of parts",1),h;const [W,U]=H.valid,O=
Math.ceil(e.width/(U-W)),Q=e.width/O,X=Math.round(h/O);let fa=e.xmin;const ca=[];H=performance.now();for(let ha=0;ha<O;ha++){const a=new y({xmin:fa,xmax:fa+Q,ymin:e.ymin,ymax:e.ymax,spatialReference:e.spatialReference});ca.push(D(b,a,X,f,l,G));fa+=Q}b=yield Promise.all(ca);E("esri-2d-profiler")&&c.info("I.8","All calls to _fetchPart (ms)",Math.round(performance.now()-H));E("esri-2d-profiler")&&c.info("I.9","Number of parts",b.length);f={data:new Float32Array(h*f*2),mask:new Uint8Array(h*f),width:h,
height:f};e=0;for(const ha of b){for(b=0;b<ha.height;b++)for(l=0;l<ha.width;l++)e+l>=h||(f.data[2*(b*h+e+l)]=ha.data[2*(b*ha.width+l)],f.data[2*(b*h+e+l)+1]=ha.data[2*(b*ha.width+l)+1],f.mask[b*h+e+l]=ha.mask[b*ha.width+l]);e+=ha.width}E("esri-2d-profiler")&&c.info("I.10","loadImagery, general exit (ms)",Math.round(performance.now()-L));return f});return N.apply(this,arguments)}function D(b,e,h,f,l,G){return F.apply(this,arguments)}function F(){F=A._asyncToGenerator(function*(b,e,h,f,l,G){const L=
{requestProjectedLocalDirections:!0,signal:G};m.isSome(l)&&(L.timeExtent=l);if("imagery"===b.type)return yield b.load({signal:G}),l=b.rasterInfo.dataType,b=yield b.fetchImage(e,h,f,L),!b||m.isNone(b.pixelData)||m.isNone(b.pixelData.pixelBlock)?{data:new Float32Array(h*f*2),mask:new Uint8Array(h*f),width:h,height:f}:S(l,b.pixelData.pixelBlock);yield b.load({signal:G});l=b.rasterInfo.dataType;b=yield b.fetchPixels(e,h,f,L);return!b||m.isNone(b.pixelBlock)?{data:new Float32Array(h*f*2),mask:new Uint8Array(h*
f),width:h,height:f}:S(l,b.pixelBlock)});return F.apply(this,arguments)}const c=n.getLogger("esri.views.2d.engine.flow.dataUtils");v.createAnimatedLinesData=z;v.createFlowMesh=function(b,e,h,f){return M.apply(this,arguments)};v.createParticlesMesh=w;v.createStreamlinesMesh=k;v.loadImagery=function(b,e,h,f,l,G){return N.apply(this,arguments)};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/flow/FlowContainer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"./BrushFlow","../webgl/enums","../webgl/WGLContainer"],function(v,A,C,E){return function(n){function x(){var I=n.apply(this,arguments)||this;I.flowStyle=null;return I}v._inheritsLoose(x,n);var m=x.prototype;m.doRender=function(I){n.prototype.doRender.call(this,I)};m.prepareRenderPasses=function(I){const r=I.registerRenderPass({name:"flow",brushes:[A],target:()=>this.children,drawPhase:C.WGLDrawPhase.MAP});return[...n.prototype.prepareRenderPasses.call(this,I),r]};v._createClass(x,[{key:"requiresDedicatedFBO",
get:function(){return!1}}]);return x}(E)})},"esri/views/2d/engine/flow/FlowStrategy":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../core/Accessor ../../../../core/Logger ../../../../core/mathUtils ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/Point ./FlowDisplayData ./FlowDisplayObject ../../../../geometry/Extent".split(" "),
function(v,A,C,E,n,x,m,I,r,J,y,M,Y,Z,T,P,z){function k(S,N){const D=new Z({x:(S.xmax+S.xmin)/2,y:(S.ymax+S.ymin)/2,spatialReference:S.spatialReference});var F=S.xmax-S.xmin;const c=S.ymax-S.ymin,b=Math.abs(Math.cos(x.deg2rad(N))),e=Math.abs(Math.sin(x.deg2rad(N)));N=b*F+e*c;F=e*F+b*c;S=new z({xmin:D.x-N/2,ymin:D.y-F/2,xmax:D.x+N/2,ymax:D.y+F/2,spatialReference:S.spatialReference});S.centerAt(D);return S}const w=n.getLogger("esri.views.2d.engine.flow.FlowStrategy");C=function(S){function N(F){F=S.call(this,
F)||this;F._flowDisplayObject=new P.FlowDisplayObject;F._loading=null;return F}v._inheritsLoose(N,S);var D=N.prototype;D.initialize=function(){this.flowContainer.addChild(this._flowDisplayObject)};D.destroy=function(){this._clear();this.flowContainer.removeAllChildren()};D.update=function(F){var {flowStyle:c}=this.flowContainer;if(m.isNone(c))this._clear();else{var {extent:b,rotation:e,resolution:h,pixelRatio:f}=F.state;F=k(b,e);F.expand(1.15);c=new T(c,F,[Math.round((F.xmax-F.xmin)/h),Math.round((F.ymax-
F.ymin)/h)],f);if(m.isSome(this._loading)){if(this._loading.update(c))return;this._loading.detach();this._loading=null}if(m.isNone(this._flowDisplayObject.displayData)||!this._flowDisplayObject.displayData.update(c))c.load().then(()=>{this._flowDisplayObject.clear();this._flowDisplayObject.displayData=this._loading;this._loading=null},l=>{I.isAbortError(l)||(w.error("A resource failed to load.",l),this._loading=null)}),this._loading=c}};D._clear=function(){this._flowDisplayObject.clear();m.isSome(this._loading)&&
(this._loading.detach(),this._loading=null)};v._createClass(N,[{key:"updating",get:function(){return null!=this._loading}}]);return N}(E);A.__decorate([r.property()],C.prototype,"_loading",void 0);A.__decorate([r.property()],C.prototype,"flowContainer",void 0);A.__decorate([r.property()],C.prototype,"updating",null);return C=A.__decorate([Y.subclass("esri.views.2d.engine.flow.FlowStrategy")],C)})},"esri/views/2d/engine/flow/FlowDisplayData":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"../../../../core/Logger"],function(v,A){const C=A.getLogger("esri.views.2d.engine.flow.FlowDisplayData");return function(){function E(x,m,I,r){this.state={name:"created"};this.flowStyle=x;this.extent=m;this.size=I;this.pixelRatio=r}var n=E.prototype;n.load=function(){var x=v._asyncToGenerator(function*(){const m=new AbortController;this.state={name:"loading",abortController:m};this.state={name:"loaded",resources:yield this.flowStyle.load({extent:this.extent,size:this.size,pixelRatio:this.pixelRatio},
m.signal)}});return function(){return x.apply(this,arguments)}}();n.attach=function(x){if("loaded"!==this.state.name)C.error("Only loaded resources can be attached.");else{var m=this.state.resources;m.attach(x);this.state={name:"attached",resources:m}}};n.detach=function(){"loading"===this.state.name?(this.state.abortController.abort(),this.state={name:"detached"}):"attached"===this.state.name&&(this.state.resources.detach(),this.state={name:"detached"})};n.update=function(x){if(!this.flowStyle.isCompatible(x.flowStyle)||
!this.extent.equals(x.extent)||this.size[0]!==x.size[0]||this.size[1]!==x.size[1]||this.pixelRatio!==x.pixelRatio)return!1;this.flowStyle=x.flowStyle;return!0};return E}()})},"esri/views/2d/engine/flow/FlowDisplayObject":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/mathUtils ../../../../core/maybe ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../DisplayObject".split(" "),function(v,A,C,E,n,x,m){m=function(I){function r(){var y=I.apply(this,arguments)||
this;y._displayData=null;return y}A._inheritsLoose(r,I);var J=r.prototype;J.clear=function(){E.isSome(this._displayData)&&(this._displayData.detach(),this._displayData=null,this.requestRender())};J.setTransform=function(y){var {displayData:M}=this;if(!E.isNone(M)){var Y=[0,0];y.toScreen(Y,[M.extent.xmin,M.extent.ymax]);M=(M.extent.xmax-M.extent.xmin)/M.size[0]/y.resolution;var Z=C.deg2rad(y.rotation),{dvs:T}=this.transforms;n.fromTranslation(T,[-1,1,0]);n.scale(T,T,[2/(y.size[0]*y.pixelRatio),-2/
(y.size[1]*y.pixelRatio),1]);n.translate(T,T,[Y[0],Y[1],0]);n.rotate(T,T,Z);n.scale(T,T,[M*y.pixelRatio,M*y.pixelRatio,1])}};J._createTransforms=function(){return{dvs:x.create()}};A._createClass(r,[{key:"displayData",get:function(){return this._displayData},set:function(y){this._displayData=y;this.requestRender()}}]);return r}(m.DisplayObject);v.FlowDisplayObject=m;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/LayerView2D":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Collection ../../../core/collectionUtils ../../../core/Error ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../engine/Container ../../layers/support/ClipArea ../../layers/support/ClipRect ../../layers/support/Geometry ../../layers/support/Path".split(" "),
function(v,A,C,E,n,x,m,I,r,J,y,M,Y,Z,T,P,z){const k=E.ofType({key:"type",base:Z,typeMap:{rect:T,path:z,geometry:P}});v.LayerView2DMixin=w=>{w=function(S){function N(){var F=S.apply(this,arguments)||this;F.attached=!1;F.clips=new k;F.lastUpdateId=-1;F.moving=!1;F.updateRequested=!1;return F}A._inheritsLoose(N,S);var D=N.prototype;D.initialize=function(){var F,c,b,e;const h=null!=(F=null==(c=this.view)?void 0:c.spatialReferenceLocked)?F:!0;(null==(b=this.view)?0:b.spatialReference)&&h&&!this.spatialReferenceSupported?
this.addResolvingPromise(Promise.reject(new x("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",{layer:this.layer}))):(this.container||(this.container=new Y.Container),this.container.fadeTransitionEnabled=!0,this.container.opacity=0,this.container.clips=this.clips,this.handles.add([m.watch(()=>this.suspended,f=>{this.container&&(this.container.visible=!f);this.view&&!f&&this.updateRequested&&this.view.requestUpdate()},m.syncAndInitial),
m.watch(()=>{var f,l;return null!=(f=null==(l=this.layer)?void 0:l.opacity)?f:1},f=>{this.container&&(this.container.opacity=f)},m.syncAndInitial),m.watch(()=>this.layer&&"blendMode"in this.layer?this.layer.blendMode:"normal",f=>{this.container&&(this.container.blendMode=f)},m.syncAndInitial),m.watch(()=>this.layer&&"effect"in this.layer?this.layer.effect:null,f=>{this.container&&(this.container.effect=f)},m.syncAndInitial),m.on(()=>this.clips,"change",()=>{this.container&&(this.container.clips=this.clips)})]),
null!=(e=this.view)&&e.whenLayerView?this.view.whenLayerView(this.layer).then(f=>{f===this&&this.processAttach()},()=>{}):this.when().then(()=>{this.processAttach()},()=>{}))};D.destroy=function(){this.processDetach();this.updateRequested=!1};D.processAttach=function(){this.isResolved()&&!this.attached&&!this.destroyed&&this.spatialReferenceSupported&&(this.attach(),this.attached=!0,this.requestUpdate())};D.processDetach=function(){this.attached&&(this.attached=!1,this.detach(),this.updateRequested=
!1)};D.isVisibleAtScale=function(F){const c=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;if(!c)return!0;const {minScale:b,maxScale:e}=c;return(0===b||F<=b)&&(0===e||F>=e)};D.requestUpdate=function(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())};D.processUpdate=function(F){this.isFulfilled()&&!this.isResolved()?this.updateRequested=!1:(this._set("updateParameters",F),this.updateRequested&&!this.suspended&&
(this.updateRequested=!1,this.update(F)))};D.hitTest=function(F,c){return Promise.resolve(null)};D.supportsSpatialReference=function(F){return!0};D.canResume=function(){return this.spatialReferenceSupported?S.prototype.canResume.call(this)?this.visibleAtCurrentScale:!1:!1};D.getSuspendInfo=function(){const F=S.prototype.getSuspendInfo.call(this),c=!this.spatialReferenceSupported,b=this.visibleAtCurrentScale;c&&(F.spatialReferenceNotSupported=c);b&&(F.outsideScaleRange=b);return F};A._createClass(N,
[{key:"spatialReferenceSupported",get:function(){var F;const c=null==(F=this.view)?void 0:F.spatialReference;return null==c||this.supportsSpatialReference(c)}},{key:"updating",get:function(){var F;return this.spatialReferenceSupported&&(!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())||!(null==(F=this.updatingHandles)||!F.updating))}},{key:"visibleAtCurrentScale",get:function(){return this.isVisibleAtScale(this.view.scale)}}]);return N}(w);C.__decorate([I.property()],w.prototype,
"attached",void 0);C.__decorate([I.property({type:k,set(S){S=n.referenceSetter(S,this._get("clips"),k);this._set("clips",S)}})],w.prototype,"clips",void 0);C.__decorate([I.property()],w.prototype,"container",void 0);C.__decorate([I.property()],w.prototype,"moving",void 0);C.__decorate([I.property({readOnly:!0})],w.prototype,"spatialReferenceSupported",null);C.__decorate([I.property({readOnly:!0})],w.prototype,"updateParameters",void 0);C.__decorate([I.property()],w.prototype,"updateRequested",void 0);
C.__decorate([I.property()],w.prototype,"updating",null);C.__decorate([I.property()],w.prototype,"view",void 0);C.__decorate([I.property({readOnly:!0})],w.prototype,"visibleAtCurrentScale",null);return w=C.__decorate([M.subclass("esri.views.2d.layers.LayerView2D")],w)};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/layers/support/ClipArea":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/set ../../../core/accessorSupport/decorators/subclass".split(" "),
function(v,A,C,E,n,x,m,I,r){C=function(J){function y(){return J.apply(this,arguments)||this}v._inheritsLoose(y,J);return y}(C.JSONSupport);return C=A.__decorate([r.subclass("esri.views.layers.support.ClipArea")],C)})},"esri/views/layers/support/ClipRect":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./ClipArea".split(" "),
function(v,A,C,E,n,x,m,I){var r;E=r=function(J){function y(){var M=J.apply(this,arguments)||this;M.type="rect";M.left=null;M.right=null;M.top=null;M.bottom=null;return M}v._inheritsLoose(y,J);y.prototype.clone=function(){return new r({left:this.left,right:this.right,top:this.top,bottom:this.bottom})};v._createClass(y,[{key:"version",get:function(){return(this._get("version")||0)+1}}]);return y}(I);A.__decorate([C.property({type:[Number,String],json:{write:!0}})],E.prototype,"left",void 0);A.__decorate([C.property({type:[Number,
String],json:{write:!0}})],E.prototype,"right",void 0);A.__decorate([C.property({type:[Number,String],json:{write:!0}})],E.prototype,"top",void 0);A.__decorate([C.property({type:[Number,String],json:{write:!0}})],E.prototype,"bottom",void 0);A.__decorate([C.property({readOnly:!0})],E.prototype,"version",null);return E=r=A.__decorate([m.subclass("esri.views.layers.support.ClipRect")],E)})},"esri/views/layers/support/Geometry":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../geometry/Geometry ../../../geometry/support/jsonUtils ./ClipArea ../../../geometry/Extent ../../../geometry/Polygon".split(" "),
function(v,A,C,E,n,x,m,I,r,J,y,M,Y){var Z;C={base:r,key:"type",typeMap:{extent:M,polygon:Y}};y=Z=function(T){function P(){var z=T.apply(this,arguments)||this;z.type="geometry";z.geometry=null;return z}v._inheritsLoose(P,T);P.prototype.clone=function(){return new Z({geometry:this.geometry.clone()})};v._createClass(P,[{key:"version",get:function(){return(this._get("version")||0)+1}}]);return P}(y);A.__decorate([E.property({types:C,json:{read:J.fromJSON,write:!0}})],y.prototype,"geometry",void 0);A.__decorate([E.property({readOnly:!0})],
y.prototype,"version",null);return y=Z=A.__decorate([I.subclass("esri.views.layers.support.Geometry")],y)})},"esri/views/layers/support/Path":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./ClipArea".split(" "),function(v,A,C,E,n,x,m,I){E=function(r){function J(){var y=r.apply(this,
arguments)||this;y.type="path";y.path=[];return y}v._inheritsLoose(J,r);v._createClass(J,[{key:"version",get:function(){return(this._get("version")||0)+1}}]);return J}(I);A.__decorate([C.property({type:[[[Number]]],json:{write:!0}})],E.prototype,"path",void 0);A.__decorate([C.property({readOnly:!0})],E.prototype,"version",null);return E=A.__decorate([m.subclass("esri.views.layers.support.Path")],E)})},"esri/views/2d/layers/graphics/HighlightGraphicContainer":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/set ../../../../core/accessorSupport/decorators/subclass ../../engine/webgl/enums ./BaseGraphicContainer ../../../webgl/enums".split(" "),
function(v,A,C,E,n,x,m,I,r,J,y){C=function(M){function Y(){return M.apply(this,arguments)||this}v._inheritsLoose(Y,M);var Z=Y.prototype;Z.doRender=function(T){T.drawPhase===r.WGLDrawPhase.HIGHLIGHT&&M.prototype.doRender.call(this,T)};Z.renderChildren=function(T){this.attributeView.bindTextures(T.context);if(this.children.some(z=>z.hasData)){M.prototype.renderChildren.call(this,T);var {painter:P}=T;P=P.effects.highlight;P.bind(T);T.context.setColorMask(!0,!0,!0,!0);T.context.clear(y.ClearBufferBit.COLOR_BUFFER_BIT);
this._renderChildren(T,P.defines.concat(["highlightAll"]));P.draw(T);P.unbind()}};return Y}(J);return C=A.__decorate([I.subclass("esri.views.2d.layers.support.HighlightGraphicContainer")],C)})},"esri/views/2d/layers/imagery/ImageryView2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../Graphic ../../../../core/Accessor ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../layers/support/rasterFunctions/pixelUtils ../../engine/BitmapContainer ../../engine/Container ../../engine/ImageryBitmapSource ../support/ExportStrategy".split(" "),
function(v,A,C,E,n,x,m,I,r,J,y,M,Y,Z,T,P,z){const k=n.getLogger("esri.views.2d.layers.imagery.ImageryView2D");E=function(w){function S(){var D=w.apply(this,arguments)||this;D.attached=!1;D.container=new T.Container;D.updateRequested=!1;D.type="imagery";D._bitmapView=new Z.BitmapContainer;return D}v._inheritsLoose(S,w);var N=S.prototype;N.destroy=function(){this.attached&&(this.detach(),this.attached=!1);this.updateRequested=!1};N.update=function(D){this.strategy.update(D).catch(F=>{m.isAbortError(F)||
k.error(F)})};N.hitTest=function(D){return new C({attributes:{},geometry:D.clone(),layer:this.layer})};N.attach=function(){this.container.addChild(this._bitmapView);this.strategy=new z({container:this._bitmapView,imageNormalizationSupported:10<=this.layer.version,imageMaxHeight:10.1<=this.layer.version?this.layer.imageMaxHeight:2048,imageMaxWidth:10.1<=this.layer.version?this.layer.imageMaxWidth:2048,fetchSource:this._fetchImage.bind(this),requestUpdate:()=>this.requestUpdate()})};N.detach=function(){this.strategy.destroy();
this._bitmapView.removeAllChildren();this.container.removeAllChildren();this.updateRequested=!1};N.redraw=function(){this.strategy.updateExports(D=>{D.source instanceof HTMLImageElement?D.requestRender():this.layer.applyRenderer({pixelBlock:D.source.pixelBlock}).then(F=>{const c=D.source;c.pixelBlock=F.pixelBlock;c.filter=b=>this.layer.applyFilter(b);this.container.requestRender()})})};N.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate())};N.isUpdating=
function(){return this.strategy.updating||this.updateRequested};N.getPixelData=function(){if(this.updating)return null;var D=this.strategy.bitmaps;if(1===D.length&&D[0].source)return{extent:D[0].source.extent,pixelBlock:D[0].source.originalPixelBlock};if(1<D.length){const F=this.view.extent;D=D.map(c=>c.source).filter(c=>c.extent&&c.extent.intersects(F)).map(c=>({extent:c.extent,pixelBlock:c.originalPixelBlock}));D=Y.mosaicPixelData(D,F);return x.isSome(D)?{extent:D.extent,pixelBlock:D.pixelBlock}:
null}return null};N._fetchImage=function(D,F,c,b){b=b||{};b.timeExtent=this.timeExtent;b.requestAsImageElement=!0;return this.layer.fetchImage(D,F,c,b).then(e=>e.imageElement?e.imageElement:this.layer.applyRenderer(e.pixelData,{signal:b.signal}).then(h=>{h=new P(h.pixelBlock,h.extent.clone(),e.pixelData.pixelBlock);h.filter=f=>this.layer.applyFilter(f);return h}))};v._createClass(S,[{key:"updating",get:function(){return!this.attached||this.isUpdating()}}]);return S}(E);A.__decorate([I.property()],
E.prototype,"attached",void 0);A.__decorate([I.property()],E.prototype,"container",void 0);A.__decorate([I.property()],E.prototype,"layer",void 0);A.__decorate([I.property()],E.prototype,"strategy",void 0);A.__decorate([I.property()],E.prototype,"timeExtent",void 0);A.__decorate([I.property()],E.prototype,"view",void 0);A.__decorate([I.property()],E.prototype,"updateRequested",void 0);A.__decorate([I.property()],E.prototype,"updating",null);A.__decorate([I.property()],E.prototype,"type",void 0);return E=
A.__decorate([M.subclass("esri.views.2d.layers.imagery.ImageryView2D")],E)})},"esri/views/2d/layers/support/ExportStrategy":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/promiseUtils ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/Extent ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/spatialReferenceUtils ../../../../layers/support/TileInfo ../../viewStateUtils ../../engine/Bitmap ../../tiling/TileInfoView ../../tiling/TileKey".split(" "),
function(v,A,C,E,n,x,m,I,r,J,y,M,Y,Z,T,P,z){const k=y.create(),w=[0,0],S=new z(0,0,0,0);C=function(N){function D(c){var b=N.call(this,c)||this;b._imagePromise=null;b.bitmaps=[];b.hidpi=!1;b.imageMaxWidth=2048;b.imageMaxHeight=2048;b.imageRotationSupported=!1;b.imageNormalizationSupported=!1;b.update=E.debounce(function(){var e=v._asyncToGenerator(function*(h,f){if(!h.stationary||b.destroyed)return null;const l=h.state;var G=M.getInfo(l.spatialReference);h=b.hidpi?h.pixelRatio:1;var L=b.imageNormalizationSupported&&
l.worldScreenWidth&&l.worldScreenWidth<l.size[0];L?(w[0]=l.worldScreenWidth,w[1]=l.size[1]):b.imageRotationSupported?(w[0]=l.size[0],w[1]=l.size[1]):Z.getOuterSize(w,l);G=G&&(l.extent.xmin<G.valid[0]||l.extent.xmax>G.valid[1]);G=!b.imageNormalizationSupported&&G;const H=b.imageRotationSupported?l.rotation:0;Math.floor(w[0]*h)>b.imageMaxWidth||Math.floor(w[1]*h)>b.imageMaxHeight||G?(L=Math.min(b.imageMaxWidth,b.imageMaxHeight),G&&(L=Math.min(l.worldScreenWidth,L)),b._imagePromise=b._tiledExport(l,
L,h,f)):b._imagePromise=b._singleExport(l,w,L?l.paddedViewState.center:l.center,l.resolution,H,h,f);return b._imagePromise.then(function(){var W=v._asyncToGenerator(function*(U){b._imagePromise=null;if(!b.destroyed){b.bitmaps=null!=U?U:[];for(const O of b.container.children)U.includes(O)||O.fadeOut().then(()=>{O.remove()});for(const O of U)b.container.addChild(O),O.fadeIn()}});return function(U){return W.apply(this,arguments)}}()).catch(W=>{b._imagePromise=null;throw W;})});return function(h,f){return e.apply(this,
arguments)}}(),5E3);return b}v._inheritsLoose(D,N);var F=D.prototype;F.destroy=function(){this.bitmaps=[]};F.updateExports=function(c){for(const b of this.container.children){if(!b.visible||!b.stage)break;c(b);b.invalidateTexture();b.requestRender()}};F._export=function(){var c=v._asyncToGenerator(function*(b,e,h,f,l,G){h=yield this.fetchSource(b,Math.floor(e*l),Math.floor(h*l),{rotation:f,pixelRatio:l,signal:G});h=new T.Bitmap(h,"additive");h.x=b.xmin;h.y=b.ymax;h.resolution=b.width/e;h.rotation=
f;h.pixelRatio=l;return h});return function(b,e,h,f,l,G){return c.apply(this,arguments)}}();F._singleExport=function(){var c=v._asyncToGenerator(function*(b,e,h,f,l,G,L){Z.getBBox(k,h,f,e);b=new J(k[0],k[1],k[2],k[3],b.spatialReference);return[yield this._export(b,e[0],e[1],l,G,L)]});return function(b,e,h,f,l,G,L){return c.apply(this,arguments)}}();F._tiledExport=function(c,b,e,h){var f=Y.create({size:b,spatialReference:c.spatialReference,scales:[c.scale]});const l=new P(f);f=l.getTileCoverage(c);
if(!f)return null;const G=[];f.forEach((L,H,W,U)=>{S.set(L,H,W,U);l.getTileBounds(k,S);L=new J(k[0],k[1],k[2],k[3],c.spatialReference);G.push(this._export(L,b,b,0,e,h))});return Promise.all(G)};v._createClass(D,[{key:"updating",get:function(){return!this.destroyed&&null!==this._imagePromise}}]);return D}(C);A.__decorate([n.property()],C.prototype,"_imagePromise",void 0);A.__decorate([n.property()],C.prototype,"bitmaps",void 0);A.__decorate([n.property()],C.prototype,"container",void 0);A.__decorate([n.property()],
C.prototype,"fetchSource",void 0);A.__decorate([n.property()],C.prototype,"hidpi",void 0);A.__decorate([n.property()],C.prototype,"imageMaxWidth",void 0);A.__decorate([n.property()],C.prototype,"imageMaxHeight",void 0);A.__decorate([n.property()],C.prototype,"imageRotationSupported",void 0);A.__decorate([n.property()],C.prototype,"imageNormalizationSupported",void 0);A.__decorate([n.property()],C.prototype,"requestUpdate",void 0);A.__decorate([n.property()],C.prototype,"updating",null);return C=A.__decorate([r.subclass("esri.views.2d.layers.support.ExportStrategy")],
C)})},"esri/views/2d/viewStateUtils":function(){define(["exports"],function(v){const A=Math.PI/180;v.bboxIntersects=function(C,E){const [n,x,m,I]=C,[r,J,y,M]=E;return!(n>y||m<r||x>M||I<J)};v.getBBox=function(C,E,n,x){const [m,I]=E,[r,J]=x;E=.5*n;C[0]=m-E*r;C[1]=I-E*J;C[2]=m+E*r;C[3]=I+E*J;return C};v.getOuterSize=function(C,E){var n=E.rotation*A;const x=Math.abs(Math.cos(n));n=Math.abs(Math.sin(n));const [m,I]=E.size;C[0]=Math.round(I*n+m*x);C[1]=Math.round(I*x+m*n);return C};v.snapToPixel=function(C,
E,n){const {resolution:x,size:m}=n;C[0]=x*(Math.round(E[0]/x)+m[0]%2*.5);C[1]=x*(Math.round(E[1]/x)+m[1]%2*.5);return C};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/imagery/VectorFieldView2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../Graphic ../../../../request ../../../../core/HandleOwner ../../../../core/maybe ../../../../core/reactiveUtils ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/Extent ../../../../layers/support/rasterFunctions/rasterProjectionHelper ../../../../layers/support/rasterFunctions/vectorFieldUtils ../../engine/imagery/RasterVFContainer ./ImageryVFStrategy".split(" "),
function(v,A,C,E,n,x,m,I,r,J,y,M,Y,Z,T,P,z){n=function(k){function w(){var N=k.apply(this,arguments)||this;N.attached=!1;N.container=new P.RasterVFContainer;N.type="imageryVF";N._dataParameters={exportParametersVersion:0,bbox:"",symbolTileSize:0,time:""};N._fetchpixels=function(){var D=v._asyncToGenerator(function*(F,c,b,e){const h=yield N._projectFullExtentPromise,{symbolTileSize:f}=N.layer.renderer,{extent:l,width:G,height:L}=T.snapImageToSymbolTile(F,c,b,f,h);if(x.isSome(h)&&!h.intersects(F))return{extent:l,
pixelBlock:null};F={bbox:`${l.xmin}, ${l.ymin}, ${l.xmax}, ${l.ymax}`,exportParametersVersion:N.layer.exportImageServiceParameters.version,symbolTileSize:f,time:JSON.stringify(N.timeExtent||"")};if(N._canReuseVectorFieldData(F)&&(c=N.getPixelData(),x.isSome(c)&&`${c.extent.xmin}, ${c.extent.ymin}, ${c.extent.xmax}, ${c.extent.ymax}`===F.bbox))return c;({pixelData:e}=yield N.layer.fetchImage(l,G,L,{timeExtent:N.timeExtent,requestAsImageElement:!1,signal:e}));N._dataParameters=F;if(x.isNone(e.pixelBlock))return{extent:l,
pixelBlock:null};e="vector-uv"===N.layer.rasterInfo.dataType?x.unwrap(T.convertVectorFieldData(e.pixelBlock,"vector-uv")):e.pixelBlock;return{extent:l,pixelBlock:e}});return function(F,c,b,e){return D.apply(this,arguments)}}();return N}v._inheritsLoose(w,k);var S=w.prototype;S.attach=function(){this._projectFullExtentPromise=this._getProjectedFullExtent(this.view.spatialReference);this._strategy=new z({container:this.container,fetchPixels:this._fetchpixels});this.handles.add(m.watch(()=>this.layer.renderer,
N=>this._updateSymbolizerParams(N),m.syncAndInitial),"vector-field-view-update")};S.detach=function(){this._strategy.destroy();this.container.children.forEach(N=>N.destroy());this.container.removeAllChildren();this.handles.remove("vector-field-view-update");this._strategy=this.container=this._projectFullExtentPromise=null};S.getPixelData=function(){if(this.updating||!this.container.children.length)return null;const {extent:N,pixelBlock:D}=this.container.children[0].rawPixelData;return{extent:N,pixelBlock:D}};
S.hitTest=function(N){return new C({attributes:{},geometry:N.clone(),layer:this.layer})};S.update=function(N){this._strategy.update(N,this._symbolizerParams)};S.redraw=function(){this._updateSymbolizerParams(this.layer.renderer);this._strategy.redraw(this._symbolizerParams)};S._canReuseVectorFieldData=function(N){const D=this._dataParameters.time===N.time,F=this._dataParameters.symbolTileSize===N.symbolTileSize,c=this._dataParameters.bbox===N.bbox;return this._dataParameters.exportParametersVersion===
N.exportParametersVersion&&D&&F&&c};S._getProjectedFullExtent=function(){var N=v._asyncToGenerator(function*(D){try{return yield Z.projectExtent(this.layer.fullExtent,D)}catch(F){try{const c=(yield E(this.layer.url,{query:{option:"footprints",outSR:D.wkid||JSON.stringify(D.toJSON()),f:"json"}})).data.featureCollection.layers[0].layerDefinition.extent;return c?Y.fromJSON(c):null}catch{return null}}});return function(D){return N.apply(this,arguments)}}();S._updateSymbolizerParams=function(N){"vector-field"===
N.type&&(this._symbolizerParams=this.layer.symbolizer.generateWebGLParameters({pixelBlock:null}))};v._createClass(w,[{key:"updating",get:function(){return!this.attached||this._strategy.updating}}]);return w}(n.HandleOwner);A.__decorate([I.property()],n.prototype,"attached",void 0);A.__decorate([I.property()],n.prototype,"container",void 0);A.__decorate([I.property()],n.prototype,"layer",void 0);A.__decorate([I.property()],n.prototype,"timeExtent",void 0);A.__decorate([I.property()],n.prototype,"type",
void 0);A.__decorate([I.property()],n.prototype,"view",void 0);A.__decorate([I.property()],n.prototype,"updating",null);return n=A.__decorate([M.subclass("esri.views.2d.layers.imagery.VectorFieldView2D")],n)})},"esri/layers/support/rasterFunctions/rasterProjectionHelper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/unitUtils ../../../chunks/pe ../../../geometry/projection ../../../geometry/Extent ../../../geometry/Point ../../../geometry/Polygon ../../../geometry/SpatialReference".split(" "),
function(v,A,C,E,n,x,m,I,r,J,y,M){function Y(a,d,g){return!I.canProjectWithoutEngine(a,d,g)}function Z(a,d,g){if((a=Y(a,d,g))&&!I.isLoaded())throw new E("rasterprojectionhelper-project","projection engine is not loaded");return a}function T(){T=A._asyncToGenerator(function*(){if(I.isLoaded())return null;yield I.load()});return T.apply(this,arguments)}function P(a,d,g,q=null){const B=a.spatialReference;if(B.equals(d))return a;Z(B,d,q);g=g.center;g=new r({xmin:g.x-a.x/2,xmax:g.x+a.x/2,ymin:g.y-a.y/
2,ymax:g.y+a.y/2,spatialReference:B});q=I.project(g,d,q);g=G(d);n.isNone(q)||n.isSome(g)&&q.width>=g?(d=x.getMetersPerUnitForSR(B)/x.getMetersPerUnitForSR(d),a={x:a.x*d,y:a.y*d}):a={x:q.width,y:q.height};return a}function z(a,d=.01){return x.getMetersPerUnitForSR(a)?d/x.getMetersPerUnitForSR(a):0}function k(a,d,g=null,q=!0){var B=a.spatialReference;if(B.equals(d))return a;Z(B,d,g);g=I.project(a,d,g);if(!q||!g)return g;q=L(B,!0);d=L(d,!0);(B=z(B))&&n.isSome(q)&&n.isSome(d)&&(0<g.x&&Math.abs(a.x-q[0])<
B?g.x-=d[1]-d[0]:0>g.x&&Math.abs(a.x-q[1])<B&&(g.x+=d[1]-d[0]));return g}function w(a){const {inSR:d,outSR:g,datumTransformation:q,preferPE:B}=a;if(d.equals(g))return{points:a}=c(a,null),a;if(d.isWebMercator&&g.isWGS84||d.isWGS84&&g.isWebMercator){{const {cols:V,rows:R,xres:aa,yres:da,usePixelCenter:ba,inSR:ja,outSR:ka}=a;let {xmin:ia,ymax:ea}=a;ba&&(ia+=aa/2,ea-=da/2);a=[];var t=[],p=Math.max(V,R);for(var K=0;K<p;K++){var u=I.project(new J({x:ia+aa*Math.min(V,K),y:ea-da*Math.min(R,K),spatialReference:ja}),
ka);K<=V&&a.push(u.x);K<=R&&t.push(u.y)}p=[];for(K=0;K<V;K++)for(u=0;u<R;u++)p.push([a[K],t[u]]);a=p}return a}if(Z(d,g,q)&&B){if(d.isGeographic)return N(a);t=D(d);if(n.isSome(t))return N(a)}return S(a)}function S(a){var {points:d}=c(a,null);d=d.map(g=>new J(g[0],g[1],a.inSR));return I.project(d,a.outSR,a.datumTransformation).map(g=>g?[g.x,g.y]:[NaN,NaN])}function N(a){const {inSR:d,outSR:g,datumTransformation:q}=a,B=D(d),{points:t,mask:p}=c(a,B);d.isGeographic||(a=d.wkid?m.PeFactory.coordsys(d.wkid):
m.PeFactory.fromString(d.isGeographic?m.PeDefs.PE_TYPE_GEOGCS:m.PeDefs.PE_TYPE_PROJCS,d.wkt),m.PeCSTransformations.projToGeog(a,t.length,t));n.isSome(q)&&q.steps.length&&q.steps.forEach(K=>{const u=K.wkid?m.PeFactory.geogtran(K.wkid):m.PeFactory.fromString(m.PeDefs.PE_TYPE_GEOGTRAN,K.wkt);m.PeGTTransformations.geogToGeog(u,t.length,t,null,K.isInverse?m.PeDefs.PE_TRANSFORM_2_TO_1:m.PeDefs.PE_TRANSFORM_1_TO_2)});g.isGeographic||(a=D(g,!0),a=n.isSome(a)&&a.isEnvelope?[a.bbox[1],a.bbox[3]]:[-90,90],b(t,
a),a=g.wkid?m.PeFactory.coordsys(g.wkid):m.PeFactory.fromString(g.isGeographic?m.PeDefs.PE_TYPE_GEOGCS:m.PeDefs.PE_TYPE_PROJCS,g.wkt),m.PeCSTransformations.geogToProj(a,t.length,t));a=t;if(p&&t.length!==p.length){a=[];for(let K=0,u=0;K<p.length;K++)p[K]?a.push(t[u++]):a.push([NaN,NaN])}return a}function D(a,d=!1){var g=a.wkid||a.wkt;if(!g||a.isGeographic)return null;g=String(g);if(ca.has(g))return g=ca.get(g),d?null==g?void 0:g.gcs:null==g?void 0:g.pcs;var q=a.wkid?m.PeFactory.coordsys(a.wkid):m.PeFactory.fromString(a.isGeographic?
m.PeDefs.PE_TYPE_GEOGCS:m.PeDefs.PE_TYPE_PROJCS,a.wkt);a=z(a,1E-4);a=F(q,a);q=F(q,0,!0);ca.set(g,{pcs:a,gcs:q});return d?q:a}function F(a,d=0,g=!1){var q=m.PePCSInfo.generate(a),B=g?a.horizonGcsGenerate():a.horizonPcsGenerate();if(null==B||!B.length)return null;a=!1;var t=B.find(R=>1===R.getInclusive()&&1===R.getKind());if(!t){t=B.find(R=>1===R.getInclusive()&&0===R.getKind());if(!t)return null;a=!0}g=g?0:(2===q.getNorthPoleLocation()?1:0)|(2===q.getSouthPoleLocation()?2:0);q=q.isPannableRectangle();
t=t.getCoord();if(a)return{isEnvelope:a,isPannable:q,vertices:t,coef:null,bbox:[t[0][0]-d,t[0][1]-d,t[1][0]+d,t[1][1]+d],poleLocation:g};d=0;a=[];let [p,K]=t[0],[u,V]=t[0];for(let R=0,aa=t.length;R<aa;R++){d++;d===aa&&(d=0);const [da,ba]=t[R],[ja,ka]=t[d];if(ka===ba)a.push([da,ja,ba,ka,2]);else{B=(ja-da)/(ka-ba||1E-4);const ia=da-B*ba;ba<ka?a.push([B,ia,ba,ka,0]):a.push([B,ia,ka,ba,1])}p=p<da?p:da;K=K<ba?K:ba;u=u>da?u:da;V=V>ba?V:ba}return{isEnvelope:!1,isPannable:q,vertices:t,coef:a,bbox:[p,K,u,
V],poleLocation:g}}function c(a,d){const g=[],{cols:q,rows:B,xres:t,yres:p,usePixelCenter:K}=a;let {xmin:u,ymax:V}=a;K&&(u+=t/2,V-=p/2);if(n.isNone(d)){for(a=0;a<q;a++)for(d=0;d<B;d++)g.push([u+t*a,V-p*d]);return{points:g}}a=new Uint8Array(q*B);if(d.isEnvelope){const {bbox:[ia,ea,la,oa]}=d;for(let pa=0,qa=0;pa<q;pa++){var R=u+t*pa,aa=d.isPannable||R>=ia&&R<=la;for(var da=0;da<B;da++,qa++){var ba=V-p*da;aa&&ba>=ea&&ba<=oa&&(g.push([R,ba]),a[qa]=1)}}return{points:g,mask:a}}({coef:R}=d);d=[];for(aa=
0;aa<B;aa++){var ja=V-p*aa;da=[];ba=[];for(var ka=0;ka<R.length;ka++){const [ia,ea,la,oa,pa]=R[ka];ja===la&&la===oa?(da.push(ia),da.push(ea),ba.push(2),ba.push(2)):ja>=la&&ja<=oa&&(da.push(ia*ja+ea),ba.push(pa))}ja=da;if(2<da.length){ka=2===ba[0]?0:ba[0];let ia=da[0];ja=[];for(let ea=1;ea<ba.length;ea++)if(2!==ba[ea]||ea===ba.length-1)ba[ea]!==ka&&(ja.push(0===ka?Math.min(ia,da[ea-1]):Math.max(ia,da[ea-1])),ka=ba[ea],ia=da[ea]),ea===ba.length-1&&ja.push(0===ba[ea]?Math.min(ia,da[ea]):Math.max(ia,
da[ea]));ja.sort((ea,la)=>ea-la)}else da[0]>da[1]&&(ja=[da[1],da[0]]);d.push(ja)}for(let ia=0,ea=0;ia<q;ia++)for(R=u+t*ia,aa=0;aa<B;aa++,ea++)if(da=V-p*aa,ba=d[aa],2===ba.length)R>=ba[0]&&R<=ba[1]&&(g.push([R,da]),a[ea]=1);else if(2<ba.length){ja=!1;for(ka=0;ka<ba.length;ka+=2)if(R>=ba[ka]&&R<=ba[ka+1]){ja=!0;break}ja&&(g.push([R,da]),a[ea]=1)}return{points:g,mask:a}}function b(a,d){const [g,q]=d;for(d=0;d<a.length;d++){const B=a[d][1];if(B<g||B>q)a[d]=[NaN,NaN]}}function e(a){const d=G(a[0].spatialReference);
if(2>a.length||n.isNone(d))return a[0];let {xmin:g,xmax:q,ymin:B,ymax:t}=a[0];for(let p=1;p<a.length;p++){const K=a[p];q=K.xmax+d*p;B=Math.min(B,K.ymin);t=Math.max(t,K.ymax)}return new r({xmin:g,xmax:q,ymin:B,ymax:t,spatialReference:a[0].spatialReference})}function h(a,d,g=null,q=!0){var B=a.spatialReference;if(B.equals(d))return a;var t=W(a);const p=G(B,!0);var K=G(d);if(0===t||n.isNone(p)||n.isNone(K))return t=l(a,d,g,q),n.isNone(p)&&n.isSome(K)&&Math.abs(t.width-K)<z(d)&&I.isLoaded()&&(B=D(B),
n.isSome(B)&&B.poleLocation===Q.None&&a.width<(B.bbox[2]-B.bbox[0])/2)?f(a,d)||t:t;K=a.clone().normalize();if(1===K.length&&a.xmax<p&&a.xmax-p/2>z(B)){const {xmin:u,xmax:V}=a;for(let R=0;R<=t;R++)K[R]=new r({xmin:0===R?u:-p/2,xmax:R===t?V-p*R:p/2,ymin:a.ymin,ymax:a.ymax,spatialReference:B})}a=K.map(u=>l(u,d,g,q));return e(a.filter(u=>!!u))}function f(a,d){const g=G(d);if(n.isNone(g))return null;let {xmin:q,ymin:B,xmax:t,ymax:p}=a;var K=a.spatialReference;a=new y({spatialReference:K,rings:[[[q,B],
[t,B],[t,p],[q,p],[q,B]]]});a=I.project(a,d);if(2!==a.rings.length||!a.rings[0].length||!a.rings[1].length)return null;({rings:a}=a);K=z(K);d=new r({spatialReference:d});for(let u=0;2>u;u++){q=t=a[u][0][0];B=p=a[u][0][1];for(let V=0;V<a[u].length;V++)q=q>a[u][V][0]?a[u][V][0]:q,t=t<a[u][V][0]?a[u][V][0]:t,B=B>a[u][V][1]?a[u][V][1]:B,p=p<a[u][V][1]?a[u][V][1]:p;if(0===u)d.ymin=B,d.ymax=p,d.xmin=q,d.xmax=t;else if(d.ymin=Math.min(d.ymin,B),d.ymax=Math.max(d.ymax,p),Math.abs(t-g/2)<K)d.xmin=q,d.xmax+=
g;else if(Math.abs(q+g/2)<K)d.xmax=t+g;else return null}return d}function l(a,d,g=null,q=!0,B=!0){const t=a.spatialReference;if(t.equals(d))return a;Z(t,d,g);const p=I.project(a,d,g);if(B&&d.isWebMercator&&p&&(p.ymax=Math.min(2.0037508342787E7,p.ymax),p.ymin=Math.max(-2.0037508342787E7,p.ymin),p.ymin>=p.ymax))return null;if(!q||!p)return p;var K=L(t,!0);q=L(d,!0);if(n.isNone(K)||n.isNone(q))return p;B=z(t,.001);const u=z(t,500);var V=z(d,.001);if(Math.abs(p.xmin-q[0])<V&&Math.abs(p.xmax-q[1])<V){V=
Math.abs(a.xmin-K[0]);K=Math.abs(K[1]-a.xmax);if(V<B&&K>u){p.xmin=q[0];var R=[];R.push(new J(a.xmax,a.ymin,t));R.push(new J(a.xmax,(a.ymin+a.ymax)/2,t));R.push(new J(a.xmax,a.ymax,t));R=R.map(aa=>k(aa,d,g)).filter(aa=>!isNaN(null==aa?void 0:aa.x)).map(aa=>aa.x);p.xmax=Math.max.apply(null,R)}K<B&&V>u&&(p.xmax=q[1],q=[],q.push(new J(a.xmin,a.ymin,t)),q.push(new J(a.xmin,(a.ymin+a.ymax)/2,t)),q.push(new J(a.xmin,a.ymax,t)),a=q.map(aa=>k(aa,d,g)).filter(aa=>!isNaN(null==aa?void 0:aa.x)).map(aa=>aa.x),
p.xmin=Math.min.apply(null,a))}else a=z(d,.001),Math.abs(p.xmin-q[0])<a&&(p.xmin=q[0]),Math.abs(p.xmax-q[1])<a&&(p.xmax=q[1]);return p}function G(a,d=!1){return a.isWebMercator?2*(d?2.0037508342787E7:2.0037508342788905E7):a.wkid&&a.isGeographic?360:2*fa[a.wkid]||null}function L(a,d=!1){if(a.isGeographic)return[-180,180];a=G(a,d);return n.isSome(a)?[-a/2,a/2]:null}function H(a,d,g,q){a=(a-d)/g;0!==a-Math.floor(a)?a=Math.floor(a):q&&--a;return a}function W(a,d=!1){var g=G(a.spatialReference);if(n.isNone(g))return 0;
const q=d?0:-(g/2),B=z(a.spatialReference),t=!d&&Math.abs(a.xmin+g/2)<B?-g/2:a.xmin;a=H(!d&&Math.abs(a.xmax-g/2)<B?g/2:a.xmax,q,g,!0);g=H(t,q,g,!1);return a-g}function U(a){const {projectedExtent:d,srcBufferExtent:g,pixelSize:q,datumTransformation:B,rasterTransform:t}=a;var p=d.spatialReference;const K=g.spatialReference;var u=Z(p,K);const {xmin:V,ymin:R,xmax:aa,ymax:da}=d,ba=G(K),ja=n.isSome(ba)&&(a.hasWrapAround||"gcs-shift"===(null==t?void 0:t.type));a=a.spacing||[32,32];var ka=a[0]*q.x,ia=a[1]*
q.y;const ea=1===a[0],la=Math.ceil((aa-V)/ka-.1/a[0])+(ea?0:1),oa=Math.ceil((da-R)/ia-.1/a[1])+(ea?0:1);ka=w({cols:la,rows:oa,xmin:V,ymax:da,xres:ka,yres:ia,inSR:p,outSR:K,datumTransformation:B,preferPE:4>=a[0],usePixelCenter:ea});ia=[];let pa,qa=0;const ua=ea?-1:NaN,{xmin:va,xmax:ra,ymax:na,width:wa,height:xa}=g,ya=z(K,500),za=n.isSome(ba)&&0<va&&ra>ba/2;var sa=!1;u&&(sa=D(p),sa=n.isSome(sa)&&0<sa.poleLocation);for(p=0;p<la;p++){u=[];for(let ta=0;ta<oa;ta++){var ma=ka[p*oa+ta];ja&&ma[0]>ra&&ma[0]>
ba/2-ya?ma[0]-=ba:ja&&0===p&&0>ma[0]&&za&&!t&&(ma[0]+=ba);!ma||isNaN(ma[0])||isNaN(ma[1])?(ia.push(ua),ia.push(ua),u.push(null),qa++):(t&&(ma=t.inverseTransform(new J({x:ma[0],y:ma[1],spatialReference:K})),ma=[ma.x,ma.y]),u.push(ma),0<p&&ja&&pa[ta]&&ma[0]<pa[ta][0]&&(ma[0]+=ba,sa&&ma[0]>ra&&ma[0]>ba&&(ma[0]-=ba)),ia.push((ma[0]-va)/wa),ia.push((na-ma[1])/xa))}pa=u}return{offsets:ia,error:null,coefficients:null,outofBoundPointCount:qa,spacing:a,size:ea?[la,oa]:[la-1,oa-1]}}function O(a,d,g){const {cols:q,
rows:B}=d;d=new Float32Array((q-1)*(B-1)*12);const t=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),p=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let da=0;da<q-1;da++){for(var K=0;K<B-1;K++){var u=da*B*2+2*K,V=a[u];const ba=a[u+1];var R=a[u+2],aa=a[u+3];u+=2*B;const ja=a[u],ka=a[u+1],ia=a[u+2];u=a[u+3];let ea=0,la=12*(K*(q-1)+da);for(let oa=0;3>oa;oa++)d[la++]=t[ea++]*V+t[ea++]*R+t[ea++]*ia;ea=0;for(R=0;3>R;R++)d[la++]=t[ea++]*ba+t[ea++]*aa+t[ea++]*u;ea=0;for(aa=0;3>aa;aa++)d[la++]=p[ea++]*V+p[ea++]*
ja+p[ea++]*ia;ea=0;for(V=0;3>V;V++)d[la++]=p[ea++]*ba+p[ea++]*ka+p[ea++]*u}if(g)for(K=0;K<d.length;K++)isNaN(d[K])&&(d[K]=-1)}return d}var Q;(function(a){a[a.None=0]="None";a[a.North=1]="North";a[a.South=2]="South";a[a.Both=3]="Both"})(Q||(Q={}));const X=(a,d,g,q=0)=>{if(1===g[0])return[0,0];var B=1,t=-1,p=1,K=-1;for(var u=0;u<a.length;u+=2)isNaN(a[u])||(B=B>a[u]?a[u]:B,t=t>a[u]?t:a[u],p=p>a[u+1]?a[u+1]:p,K=K>a[u+1]?K:a[u+1]);const {cols:V,rows:R}=d;d=(t-B)/V/g[0];g=(K-p)/R/g[1];q*=2;p=0;K=!1;B=[0,
0];for(t=0;t<V-3;t++){for(u=0;u<R-3;u++){var aa=t*R*2+2*u;const da=Math.abs(((a[aa]+a[aa+4]+a[aa+4*R]+a[aa+4*R+4])/4-a[aa+2*R+2])/d);aa=Math.abs(((a[aa+1]+a[aa+5]+a[aa+4*R+1]+a[aa+4*R+5])/4-a[aa+2*R+3])/g);da+aa>p&&(p=da+aa,B=[da,aa]);if(q&&p>q){K=!0;break}}if(K)break}return B},fa={3395:2.0037508342789244E7,3410:1.7334193943686873E7,3857:2.0037508342788905E7,3975:1.7367530445161372E7,4087:2.0037508342789244E7,4088:2.0015108787169147E7,6933:1.7367530445161372E7,32662:2.0037508342789244E7,53001:2.001508679602057E7,
53002:1.000754339801029E7,53003:2.001508679602057E7,53004:2.001508679602057E7,53016:1.4152803599503474E7,53017:1.7333573624304302E7,53034:2.001508679602057E7,53079:2.0015114352186374E7,53080:2.0015114352186374E7,54001:2.0037508342789244E7,54002:1.0018754171394624E7,54003:2.0037508342789244E7,54004:2.0037508342789244E7,54016:1.4168658027268292E7,54017:1.736753044516137E7,54034:2.0037508342789244E7,54079:2.0037508342789244E7,54080:2.0037508342789244E7,54100:2.0037508342789244E7,54101:2.0037508342789244E7},
ca=new Map,ha=new Map;v.computeProjectedScales=function(a,d,g=512,q=!0){const {extent:B,spatialReference:t,pixelSize:p}=a,K=P(new J({x:p.x,y:p.y,spatialReference:t}),d,B);if(null==K)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};var u=(K.x+K.y)/2,V=x.getMetersPerUnitForSR(d);u=u*V*96*39.37;const R=d.isGeographic?256/g*2.958287637958547E8:256/g*5.91657527591555E8;g="vector-magdir"===a.dataType||"vector-uv"===a.dataType;const aa=h(B,d);g||q&&(d.isGeographic||
d.isWebMercator)&&(g=0>aa.xmin*aa.xmax);q=u;if(g)q=R,a=d.isGeographic?1.341104507446289E-6:.29858214164761665,V=96*a*V*39.37,d=P(new J({x:a,y:a,spatialReference:{wkid:d.isGeographic?4326:3857}}),t,aa),d.x*=q/V,d.y*=q/V;else{d={x:p.x,y:p.y};a=Math.ceil(Math.log(Math.min(a.width,a.height)/32)/Math.LN2);for(V=0;q<.5005*R&&V<a;)V++,q*=2,d.x*=2,d.y*=2;1.001>=Math.max(q,R)/Math.min(q,R)&&(q=R)}a=[q];V=[{x:d.x,y:d.y}];for(u=Math.min(70.5310735,u)/1.001;q>=u;)q/=2,d.x/=2,d.y/=2,a.push(q),V.push({x:d.x,y:d.y});
return{projectedPixelSize:K,scales:a,srcResolutions:V,isCustomTilingScheme:!g}};v.defaultGridSpacing=32;v.defaultProjectionToleranceInPixels=4;v.getDefaultDatumTransformationForDataset=function(a,d,g){return Z(a.spatialReference,d)?g?I.getTransformation(d,a.spatialReference,a):I.getTransformation(a.spatialReference,d,a):null};v.getProjectedGridPoints=w;v.getProjectionOffsetGrid=function(a){var d=a.isAdaptive&&null==a.spacing;let g=a.spacing||[32,32],q=U(a);var B={cols:q.size[0]+1,rows:q.size[1]+1};
const t=0<q.outofBoundPointCount&&q.outofBoundPointCount<q.offsets.length/2;let p=q.outofBoundPointCount===q.offsets.length/2||d&&t?[0,0]:X(q.offsets,B,g,4);const K=(p[0]+p[1])/2;var u=a.projectedExtent.spatialReference;const V=a.srcBufferExtent.spatialReference;d&&(t||4<K)&&(Y(u,V,a.datumTransformation)&&(u.isGeographic||n.isSome(D(u))),g=[4,4],q=U({...a,spacing:g}),B={cols:q.size[0]+1,rows:q.size[1]+1},p=X(q.offsets,B,g,4));q.error=p;1<g[0]&&(q.coefficients=O(q.offsets,B,t));!a.includeGCSGrid||
u.isGeographic||u.isWebMercator||(V.isGeographic?q.gcsGrid={offsets:q.offsets,coefficients:q.coefficients,spacing:g}:(d=D(u),n.isSome(d)&&!d.isEnvelope&&(u&&!u.isGeographic&&(d=String(u.wkid||u.wkt),ha.has(d)?u=ha.get(d):(u=(u.wkid?m.PeFactory.coordsys(u.wkid):m.PeFactory.fromString(m.PeDefs.PE_TYPE_PROJCS,u.wkt)).getGeogcs().getCode(),ha.set(d,u)),u=new M({wkid:u})),u=h(a.projectedExtent,u),{offsets:a}=U({...a,srcBufferExtent:u,spacing:g}),B=O(a,B,t),q.gcsGrid={offsets:a,coefficients:B,spacing:g})));
return q};v.getRasterDatasetAlignmentInfo=function(a){const d=a.storageInfo.origin.x;var g=G(a.spatialReference,!0);if(n.isNone(g))return{originX:d,halfWorldWidth:null,pyramidsInfo:null};const q=g/2,{nativePixelSize:B,storageInfo:t,extent:p}=a,{maximumPyramidLevel:K,blockWidth:u,pyramidScalingFactor:V}=t;let R=B.x;const aa=[];a=n.isSome(a.transform)&&"gcs-shift"===a.transform.type;const da=d+(a?0:q);g=a?g-d:q-d;for(let ba=0;ba<=K;ba++){const ja=(p.xmax-d)/R/u,ka=g/R/u;aa.push({resolutionX:R,blockWidth:u,
datsetColumnCount:0===ja-Math.floor(ja)?ja:Math.ceil(ja),worldColumnCountFromOrigin:0===ka-Math.floor(ka)?ka:Math.ceil(ka),leftMargin:Math.round(da/R)%u,rightPadding:(u-Math.round(g/R)%u)%u,originColumnOffset:Math.floor(da/R/u)});R*=V}return{originX:d,halfWorldWidth:q,pyramidsInfo:aa,hasGCSSShiftTransform:a}};v.getWorldWidth=G;v.getWorldWrapCount=W;v.load=function(){return T.apply(this,arguments)};v.minimumGridSpacing=4;v.projectExtent=h;v.projectPoint=k;v.projectResolution=P;v.requirePE=Y;v.snapExtent=
function(a){a=a.clone().normalize();return 1===a.length?a[0]:e(a)};v.snapPyramid=function(a,d,g){const {storageInfo:q,pixelSize:B}=d;let t=!1;var {pyramidResolutions:p}=q;if(n.isSome(p)&&p.length){a=(a.x+a.y)/2;var K=p[p.length-1];K=(K.x+K.y)/2;var u=(B.x+B.y)/2;if(a<=u)var V=0;else if(a>=K)V=p.length,t=8<a/K;else{K=u;for(let R=1;R<=p.length;R++){u=(p[R-1].x+p[R-1].y)/2;if(a<=u){a===u?V=R:"down"===g?(V=R-1,t=8<a/K):V="up"===g?R:a-K>u-a||2<a/K?R:R-1;break}K=u}}g=0===V?B:p[V-1];t&&(p=Math.min(g.x,g.y),
a=x.getMetersPerUnitForSR(d.spatialReference),19567<p*a&&(t=!1));return{pyramidLevel:V,pyramidResolution:new J({x:g.x,y:g.y,spatialReference:d.spatialReference}),excessiveReading:t}}V=Math.log(a.x/B.x)/Math.LN2;a=Math.log(a.y/B.y)/Math.LN2;p=d.storageInfo.maximumPyramidLevel||0;V="down"===g?Math.floor(Math.min(V,a)):"up"===g?Math.ceil(Math.max(V,a)):Math.round((V+a)/2);0>V?V=0:V>p&&(t=V>p+3,V=p);g=2**V;d=new J({x:g*d.nativePixelSize.x,y:g*d.nativePixelSize.y,spatialReference:d.spatialReference});
return{pyramidLevel:V,pyramidResolution:d,excessiveReading:t}};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/rasterFunctions/vectorFieldUtils":function(){define(["exports","../../../core/jsonMap","../../../core/maybe","../PixelBlock","./pixelUtils"],function(v,A,C,E,n){function x(c,b){return P.get(c)/P.get(b)||1}function m(c,b="geographic"){const [e,h]=c;c=Math.sqrt(e*e+h*h);let f=Math.atan2(h,e)*z;f=(360+f)%360;"geographic"===b&&
(f=(450-f)%360);return[c,f]}function I(c,b="geographic"){let e=c[1];"geographic"===b&&(e=(450-e)%360);e%=360;c=c[0];return[c*Math.cos(e/z),c*Math.sin(e/z)]}function r(c,b,e="geographic",h=1){if(!n.isValidPixelBlock(c))return c;const {pixels:f,width:l,height:G}=c;var L=l*G;const H=f[0],W=f[1],U=c.pixelType.startsWith("f")?c.pixelType:"f32",O=E.createEmptyBand(U,L);L=E.createEmptyBand(U,L);let Q=0;for(let X=0;X<G;X++)for(let fa=0;fa<l;fa++)"vector-uv"===b?([O[Q],L[Q]]=m([H[Q],W[Q]],e),O[Q]*=h):([O[Q],
L[Q]]=I([H[Q],W[Q]],e),O[Q]*=h,L[Q]*=h),Q++;c=new E({pixelType:U,width:c.width,height:c.height,mask:c.mask,validPixelCount:c.validPixelCount,maskIsAlpha:c.maskIsAlpha,pixels:[O,L]});c.updateStatistics();return c}function J(c=0,b=Math.PI,e=!0){e&&(b=(2*Math.PI-b)%(2*Math.PI));var h=e?-1:1;e=5*h;const f=20*h,l=25*h;h*=2;let [G,L]=[5,0-f],[H,W]=[G+2,L],[U,O]=[H-0,W+h],[Q,X]=[-5,0-l],[fa,ca]=[Q+0,X-h];c=Math.ceil(c/5);let ha=Math.floor(c/10);c-=8*ha;const a=[],d=[];for(let R=0;R<c/2;R++,ha--){0>=ha&&
1===c%2&&R===(c-1)/2&&(Q=0,fa=Q+0,X=(X+L)/2,ca=X-h);const [aa,da]=y(Q,X,b,45);if(0<ha){const [ba,ja]=y(H,X,b,45),[ka,ia]=y(G,L,b,45);a.push(ba);a.push(ja);a.push(aa);a.push(da);a.push(ka);a.push(ia)}else{const [ba,ja]=y(H,W,b,45),[ka,ia]=y(U,O,b,45),[ea,la]=y(fa,ca,b,45);d.push(aa);d.push(da);d.push(ea);d.push(la);d.push(ka);d.push(ia);d.push(ba);d.push(ja)}X+=e;L+=e;W+=e;O+=e;ca+=e}const [g,q]=y(5,0+f,b,45),[B,t]=y(7,0+f,b,45),[p,K]=y(5,0-l,b,45),[u,V]=y(7,0-l,b,45);return{pennants:a,barbs:d,shaft:[g,
q,B,t,p,K,u,V]}}function y(c,b,e,h=1){return[Math.sqrt(c*c+b*b)/h,(2*Math.PI+(2*Math.PI+Math.atan2(b,c))%(2*Math.PI)-e)%(2*Math.PI)]}function M(c,b,e,h){e=x(h||"knots",e);for(h=1;h<b.length;h++)if(h===b.length-1){if(c<b[h]*e)break}else if(c<=b[h]*e)break;return Math.min(h-1,b.length-2)}function Y(c,b,e,h,f){let l=0;switch(b){case "beaufort_kn":l=M(c,S,"knots",e);break;case "beaufort_km":l=M(c,S,"kilometer-per-hour",e);break;case "beaufort_ft":l=M(c,S,"feet-per-second",e);break;case "beaufort_m":l=
M(c,S,"meter-per-second",e);break;case "classified_arrow":l=M(c,f,h,e);break;case "ocean_current_m":l=M(c,N,"meter-per-second",e);break;case "ocean_current_kn":l=M(c,D,"knots",e)}return l}function Z(c,b){const {style:e,inputUnit:h,outputUnit:f,breakValues:l}=b;b=k.fromJSON(h);const G=k.fromJSON(f);let L=0,H=0;const {width:W,height:U,mask:O}=c,Q=c.pixels[0];c=c.pixels[1];var X=O?O.filter(a=>0<a).length:W*U;const fa=new Float32Array(42*X);X=new Uint32Array(15*X);for(let a=0;a<U;a++)for(let d=0;d<W;d++){var ca=
a*W+d;if(!O||O[a*W+d]){var ha;const g=null!=(ha=(c[ca]+360)%360/180*Math.PI)?ha:2*Math.PI*Math.random(),q=Y(Q[ca],e,b,G,l);for(let B=0;B<w.length;B+=2)fa[L++]=(d+.5)/W,fa[L++]=(a+.5)/U,fa[L++]=w[B],fa[L++]=w[B+1]+g,fa[L++]=q,fa[L++]=Q[ca];ca=7*(L/42-1);X[H++]=ca;X[H++]=ca+1;X[H++]=ca+2;X[H++]=ca+0;X[H++]=ca+4;X[H++]=ca+3;X[H++]=ca+0;X[H++]=ca+2;X[H++]=ca+3;X[H++]=ca+2;X[H++]=ca+5;X[H++]=ca+3;X[H++]=ca+5;X[H++]=ca+6;X[H++]=ca+3}}return{vertexData:fa,indexData:X}}function T(c,b){let e=0,h=0;const {width:f,
height:l,mask:G}=c;c=c.pixels[0];const L=[],H=[];var W=k.fromJSON(b.inputUnit);W=x(W,"knots");b="wind_speed"===b.style?5:Number.MAX_VALUE;for(let O=0;O<l;O++)for(let Q=0;Q<f;Q++){var U=c[O*f+Q]*W;if((!G||G[O*f+Q])&&U<b){for(let X=0;4>X;X++)L[e++]=(Q+.5)/f,L[e++]=(O+.5)/l,L[e++]=2>X?-.5:.5,L[e++]=0===X%2?-.5:.5,L[e++]=0,L[e++]=U;U=4*(e/24-1);H[h++]=U;H[h++]=U+1;H[h++]=U+2;H[h++]=U+1;H[h++]=U+2;H[h++]=U+3}}return{vertexData:new Float32Array(L),indexData:new Uint32Array(H)}}const P=new Map;P.set("meter-per-second",
1);P.set("kilometer-per-hour",.277778);P.set("knots",.514444);P.set("feet-per-second",.3048);P.set("mile-per-hour",.44704);const z=180/Math.PI,k=new A.JSONMap({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"}),w=function(c=0,b=0,e=Math.PI,h=!0){h&&(e=(2*Math.PI-e)%(2*Math.PI));h=h?-1:1;const f=-7*h,l=-2*h,G=-16*h,[L,H]=y(0,b+13*h,e,21.75),[W,U]=y(c-5.5,b+f,e,21.75),[O,Q]=y(c+5.5,
b+f,e,21.75),[X,fa]=y(c-1.5,b+l,e,21.75),[ca,ha]=y(c+1.5,b+l,e,21.75),[a,d]=y(c-1.5,b+G,e,21.75),[g,q]=y(c+1.5,b+G,e,21.75);return[L,H,W,U,X,fa,ca,ha,O,Q,a,d,g,q]}(0,0,0),S=[0,1,3,6,10,16,21,27,33,40,47,55,63],N=[0,.5,1,1.5,2],D=[0,.25,.5,1,1.5,2,2.5,3,3.5,4],F=[];v.convertToLocalDirections=function(c,b,e,h="geographic"){if(!n.isValidPixelBlock(c)||C.isNone(e))return c;c="vector-magdir"===b?c.clone():C.unwrap(r(c,b));const f=c.pixels[1];for(let l=0;l<f.length;l++)f[l]="geographic"===h?(f[l]+e[l]+
270)%360:(f[l]+360-e[l])%360;return"vector-magdir"===b?c:r(c,"vector-magdir")};v.convertVectorFieldData=r;v.convertVectorFieldUnit=function(c,b,e=1){if(1===e||!n.isValidPixelBlock(c))return c;c=c.clone();const {pixels:h,width:f,height:l}=c,G=h[0],L=h[1];let H=0;for(let W=0;W<l;W++)for(let U=0;U<f;U++)"vector-uv"===b?(G[H]*=e,L[H]*=e):G[H]*=e,H++;c.updateStatistics();return c};v.createVFMesh=function(c,b){if("simple_scalar"===b.style)var e=T(c,b);else if("wind_speed"===b.style){{if(0===F.length)for(var h=
0;30>h;h++)F.push(J(5*h,0));b=k.fromJSON(b.inputUnit);b=x(b,"knots");const {width:L,height:H,mask:W}=c;h=c.pixels[0];c=c.pixels[1];const U=[],O=[];let Q=0,X=0;for(let fa=0;fa<H;fa++)for(let ca=0;ca<L;ca++){var f=fa*L+ca,l=h[f]*b;if((!W||W[fa*L+ca])&&5<=l){const ha=null!=(e=(c[f]+360)%360/180*Math.PI)?e:2*Math.PI*Math.random(),{pennants:a,barbs:d,shaft:g}=F[Math.min(Math.floor(l/5),29)];if(0===a.length+d.length)continue;f=U.length/6;const q=(ca+.5)/L,B=(fa+.5)/H;for(var G=0;G<a.length;G+=2)U[Q++]=
q,U[Q++]=B,U[Q++]=a[G],U[Q++]=a[G+1]+ha,U[Q++]=0,U[Q++]=l;for(G=0;G<d.length;G+=2)U[Q++]=q,U[Q++]=B,U[Q++]=d[G],U[Q++]=d[G+1]+ha,U[Q++]=0,U[Q++]=l;for(G=0;G<g.length;G+=2)U[Q++]=q,U[Q++]=B,U[Q++]=g[G],U[Q++]=g[G+1]+ha,U[Q++]=0,U[Q++]=l;for(l=0;l<a.length/6;l++)O[X++]=f,O[X++]=f+1,O[X++]=f+2,f+=3;for(l=0;l<d.length/8;l++)O[X++]=f,O[X++]=f+1,O[X++]=f+2,O[X++]=f+1,O[X++]=f+2,O[X++]=f+3,f+=4;O[X++]=f+0;O[X++]=f+1;O[X++]=f+2;O[X++]=f+1;O[X++]=f+3;O[X++]=f+2;f+=4}}e={vertexData:new Float32Array(U),indexData:new Uint32Array(O)}}}else e=
Z(c,b);return e};v.createVFMeshScalar=T;v.getUnitConversionFactor=x;v.sampleVectorField=function(c,b,e,h=[0,0],f=.5){const {width:l,height:G,mask:L}=c,[H,W]=c.pixels,[U,O]=h;c=Math.round((l-U)/e);h=Math.round((G-O)/e);var Q=c*h;const X=new Float32Array(Q),fa=new Float32Array(Q);Q=new Uint8Array(Q);b="vector-uv"===b;for(let ha=0;ha<h;ha++)for(let a=0;a<c;a++){let d=0;const g=ha*c+a,q=Math.max(0,ha*e+O),B=Math.max(0,a*e+U),t=Math.min(G,q+e),p=Math.min(l,B+e);for(let K=q;K<t;K++)for(let u=B;u<p;u++){var ca=
K*l+u;if(!L||L[ca]){d++;ca=b?[H[ca],W[ca]]:[H[ca],(360+W[ca])%360];const [V,R]=b?ca:I(ca);X[g]+=V;fa[g]+=R}}if(d>=(t-q)*(p-B)*(1-f)){Q[g]=1;const [K,u]=m([X[g]/d,fa[g]/d]);X[g]=K;fa[g]=u}else Q[g]=0,X[g]=0,fa[g]=0}e=new E({width:c,height:h,pixels:[X,fa],mask:Q});e.updateStatistics();return e};v.snapImageToSymbolTile=function(c,b,e,h,f){if(C.isNone(f)||!f.spatialReference.equals(c.spatialReference))return{extent:c,width:Math.round(b/h),height:Math.round(e/h),resolution:c.width/b};const l=f.xmin;f=
f.ymax;b=(c.xmax-c.xmin)/b*h;e=(c.ymax-c.ymin)/e*h;c.xmin=l+Math.floor((c.xmin-l)/b)*b;c.xmax=l+Math.ceil((c.xmax-l)/b)*b;c.ymin=f+Math.floor((c.ymin-f)/e)*e;c.ymax=f+Math.ceil((c.ymax-f)/e)*e;return{extent:c,width:Math.round(c.width/b),height:Math.round(c.height/e),resolution:(b+e)/2}};v.unitKebabDict=k;v.uvComponentToVector=m;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/imagery/RasterVFContainer":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers",
"./BrushVectorField","../webgl/enums","../webgl/WGLContainer"],function(v,A,C,E,n){n=function(x){function m(){var r=x.apply(this,arguments)||this;r.symbolTypes=["triangle"];return r}A._inheritsLoose(m,x);var I=m.prototype;I.prepareRenderPasses=function(r){const J=r.registerRenderPass({name:"imagery (vf)",brushes:[C],target:()=>this.children,drawPhase:E.WGLDrawPhase.MAP});return[...x.prototype.prepareRenderPasses.call(this,r),J]};I.doRender=function(r){this.visible&&r.drawPhase===E.WGLDrawPhase.MAP&&
this.symbolTypes.forEach(J=>{r.renderPass=J;x.prototype.doRender.call(this,r)})};A._createClass(m,[{key:"requiresDedicatedFBO",get:function(){return!1}}]);return m}(n);v.RasterVFContainer=n;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/imagery/ImageryVFStrategy":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/Extent ../../engine/imagery/RasterVFDisplayObject".split(" "),
function(v,A,C,E,n,x,m,I,r,J,y,M,Y){const Z=E.getLogger("esri.views.2d.layers.imagery.VectorFieldView2D");C=function(T){function P(k){var w=T.call(this,k)||this;w.update=x.debounce((S,N)=>w._update(S,N).catch(D=>{x.isAbortError(D)||Z.error(D)}));return w}v._inheritsLoose(P,T);var z=P.prototype;z.redraw=function(k){if(this.container.children.length){var w=this.container.children[0];w.symbolizerParameters=k;w.invalidateVAO();this.container.symbolTypes="wind_speed"===k.style?["scalar","triangle"]:"simple_scalar"===
k.style?["scalar"]:["triangle"];this.container.requestRender()}};z._update=function(){var k=v._asyncToGenerator(function*(w,S,N){if(w.stationary){var {extent:D,spatialReference:F}=w.state,c=new M({xmin:D.xmin,ymin:D.ymin,xmax:D.xmax,ymax:D.ymax,spatialReference:F}),[b,e]=w.state.size;this._loading=this.fetchPixels(c,b,e,N);N=yield this._loading;this._addToDisplay(N,S,w.state);this._loading=null}});return function(w,S,N){return k.apply(this,arguments)}}();z._addToDisplay=function(k,w,S){if(n.isNone(k.pixelBlock))this.container.children.forEach(c=>
c.destroy()),this.container.removeAllChildren();else{var {extent:N,pixelBlock:D}=k,F=new Y.RasterVFDisplayObject(D);F.offset=[0,0];F.symbolizerParameters=w;F.rawPixelData=k;F.invalidateVAO();F.x=N.xmin;F.y=N.ymax;F.pixelRatio=S.pixelRatio;F.rotation=S.rotation;F.resolution=S.resolution;F.width=D.width*w.symbolTileSize;F.height=D.height*w.symbolTileSize;this.container.children.forEach(c=>c.destroy());this.container.removeAllChildren();this.container.symbolTypes="wind_speed"===w.style?["scalar","triangle"]:
"simple_scalar"===w.style?["scalar"]:["triangle"];this.container.addChild(F)}};v._createClass(P,[{key:"updating",get:function(){return!!this._loading}}]);return P}(C);A.__decorate([m.property()],C.prototype,"fetchPixels",void 0);A.__decorate([m.property()],C.prototype,"container",void 0);A.__decorate([m.property()],C.prototype,"_loading",void 0);A.__decorate([m.property()],C.prototype,"updating",null);return C=A.__decorate([y.subclass("esri.views.2d.layers.imagery.ImageryVFStrategy")],C)})},"esri/views/2d/engine/imagery/RasterVFDisplayObject":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/maybe ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../../../../chunks/vec2f32 ../../../../layers/support/rasterFunctions/vectorFieldUtils ../DisplayObject ../webgl/Utils ../../../webgl/BufferObject ../../../webgl/enums ../../../webgl/VertexArrayObject".split(" "),
function(v,A,C,E,n,x,m,I,r,J,y,M,Y){C=function(Z){function T(z=null){var k=Z.call(this)||this;k._source=null;k._symbolizerParameters=null;k._vaoInvalidated=!0;k.coordScale=[1,1];k.height=null;k.stencilRef=0;k.resolution=null;k.pixelRatio=1;k.x=0;k.y=0;k.rotation=0;k.rawPixelData=null;k.width=null;k.source=z;return k}A._inheritsLoose(T,Z);var P=T.prototype;P.destroy=function(){if(E.isSome(this.vaoData)){var z,k;null==(z=this.vaoData.magdir)?void 0:z.vao.dispose();null==(k=this.vaoData.scalar)?void 0:
k.vao.dispose();this.vaoData=null}};P.invalidateVAO=function(){if(!this._vaoInvalidated&&E.isSome(this.vaoData)){var z,k;null==(z=this.vaoData.magdir)?void 0:z.vao.dispose();null==(k=this.vaoData.scalar)?void 0:k.vao.dispose();this.vaoData=null;this._vaoInvalidated=!0;this.requestRender()}};P.updateVectorFieldVAO=function(z){if(this._vaoInvalidated){this._vaoInvalidated=!1;if(E.isSome(this.source)&&E.isNone(this.vaoData)){var {style:k}=this.symbolizerParameters;switch(k){case "beaufort_ft":case "beaufort_km":case "beaufort_kn":case "beaufort_m":case "beaufort_mi":case "classified_arrow":case "ocean_current_kn":case "ocean_current_m":case "single_arrow":k=
I.createVFMesh(this.source,this.symbolizerParameters);this.vaoData={magdir:this._createVectorFieldVAO(z.context,k)};break;case "simple_scalar":k=I.createVFMeshScalar(this.source,this.symbolizerParameters);this.vaoData={scalar:this._createVectorFieldVAO(z.context,k)};break;case "wind_speed":{k=I.createVFMesh(this.source,this.symbolizerParameters);k=this._createVectorFieldVAO(z.context,k);const w=I.createVFMeshScalar(this.source,this.symbolizerParameters);z=this._createVectorFieldVAO(z.context,w);this.vaoData=
{magdir:k,scalar:z}}}}this.ready();this.requestRender()}};P._createTransforms=function(){return{dvs:x.create()}};P.setTransform=function(z){const k=n.identity(this.transforms.dvs),[w,S]=z.toScreenNoRotation([0,0],[this.x,this.y]);var N=this.resolution/this.pixelRatio/z.resolution;const D=N*this.width;N*=this.height;const F=Math.PI*this.rotation/180;n.translate(k,k,m.fromValues(w,S));n.translate(k,k,m.fromValues(D/2,N/2));n.rotate(k,k,-F);n.translate(k,k,m.fromValues(-D/2,-N/2));n.scaleByVec2(k,k,
m.fromValues(D,N));n.multiply(this.transforms.dvs,z.displayViewMat3,k)};P.onAttach=function(){this.invalidateVAO()};P.onDetach=function(){this.invalidateVAO()};P._createVectorFieldVAO=function(z,k){const {vertexData:w,indexData:S}=k;k=y.BufferObject.createVertex(z,M.Usage.STATIC_DRAW,new Float32Array(w));const N=y.BufferObject.createIndex(z,M.Usage.STATIC_DRAW,new Uint32Array(S)),D=J.createProgramDescriptor("vector-field",{geometry:[{location:0,name:"a_pos",count:2,type:M.DataType.FLOAT,normalized:!1},
{location:1,name:"a_offset",count:2,type:M.DataType.FLOAT,normalized:!1},{location:2,name:"a_vv",count:2,type:M.DataType.FLOAT,normalized:!1}]});return{vao:new Y.VertexArrayObject(z,D.attributes,D.bufferLayouts,{geometry:k},N),elementCount:S.length}};A._createClass(T,[{key:"symbolizerParameters",get:function(){return this._symbolizerParameters},set:function(z){JSON.stringify(this._symbolizerParameters)!==JSON.stringify(z)&&(this._symbolizerParameters=z,this.invalidateVAO())}},{key:"source",get:function(){return this._source},
set:function(z){this._source=z;this.invalidateVAO()}}]);return T}(r.DisplayObject);v.RasterVFDisplayObject=C;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/layers/ImageryLayerView":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Error ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/Point ../../layers/support/commonProperties ../../rest/support/Query ./support/popupUtils".split(" "),
function(v,A,C,E,n,x,m,I,r,J,y,M,Y){return Z=>{Z=function(T){function P(){var k=T.apply(this,arguments)||this;k.view=null;return k}v._inheritsLoose(P,T);var z=P.prototype;z.fetchPopupFeatures=function(){var k=v._asyncToGenerator(function*(w,S){const {layer:N}=this;if(!w)throw new C("imagerylayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:N});var {popupEnabled:D}=N;const F=Y.getFetchPopupTemplate(N,S);if(!D||E.isNone(F))throw new C("imagerylayerview:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",
{popupEnabled:D,popupTemplate:F});const c=yield F.getRequiredFields();D=new M;D.timeExtent=this.timeExtent;D.geometry=w;D.outFields=c;D.outSpatialReference=w.spatialReference;w=this.view.resolution;w="2d"===this.view.type?new J(w,w,this.view.spatialReference):new J(.5*w,.5*w,this.view.spatialReference);const {returnTopmostRaster:b,showNoDataRecords:e}=F.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1};S={returnDomainValues:!0,returnTopmostRaster:b,pixelSize:w,showNoDataRecords:e,signal:E.isSome(S)?
S.signal:null};return N.queryVisibleRasters(D,S).then(h=>h)});return function(w,S){return k.apply(this,arguments)}}();z.canResume=function(){var k;return!T.prototype.canResume.call(this)||null!=(k=this.timeExtent)&&k.isEmpty?!1:!0};return P}(Z);A.__decorate([n.property()],Z.prototype,"layer",void 0);A.__decorate([n.property()],Z.prototype,"suspended",void 0);A.__decorate([n.property(y.combinedViewLayerTimeExtentProperty)],Z.prototype,"timeExtent",void 0);A.__decorate([n.property()],Z.prototype,"view",
void 0);return Z=A.__decorate([r.subclass("esri.views.layers.ImageryLayerView")],Z)}})},"esri/views/layers/support/popupUtils":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/maybe","../../../layers/support/fieldUtils"],function(v,A,C,E){function n(){n=A._asyncToGenerator(function*(x,m=x.popupTemplate){if(C.isNone(m))return[];const I=yield m.getRequiredFields(x.fieldsIndex);({lastEditInfoEnabled:m}=m);const {objectIdField:r,typeIdField:J,globalIdField:y,relationships:M}=
x;if(I.includes("*"))return["*"];m=m?yield E.getFeatureEditFields(x):[];const Y=E.fixFields(x.fieldsIndex,[...I,...m]);J&&Y.push(J);Y&&r&&x.fieldsIndex.has(r)&&!Y.includes(r)&&Y.push(r);Y&&y&&x.fieldsIndex.has(y)&&!Y.includes(y)&&Y.push(y);M&&M.forEach(Z=>{({keyField:Z}=Z);Y&&Z&&x.fieldsIndex.has(Z)&&!Y.includes(Z)&&Y.push(Z)});return Y});return n.apply(this,arguments)}v.getFetchPopupTemplate=function(x,m){return x.popupTemplate?x.popupTemplate:C.isSome(m)&&m.defaultPopupTemplateEnabled&&C.isSome(x.defaultPopupTemplate)?
x.defaultPopupTemplate:null};v.getRequiredFields=function(x){return n.apply(this,arguments)};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/layers/RefreshableLayerView":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Logger ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(v,A,C,E,n,x,m,I,r,J){return y=>{y=function(M){function Y(){return M.apply(this,arguments)||this}v._inheritsLoose(Y,M);Y.prototype.initialize=function(){this.handles.add(n.on(()=>this.layer,"refresh",Z=>{this.doRefresh(Z.dataChanged).catch(T=>{E.isAbortError(T)||C.getLogger(this.declaredClass).error(T)})}),"RefreshableLayerView")};return Y}(y);A.__decorate([x.property()],y.prototype,"layer",void 0);return y=A.__decorate([J.subclass("esri.layers.mixins.RefreshableLayerView")],y)}})},"*noref":1}});
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Graphic ../../../core/Collection ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../support/GraphicsCollection ../engine/flow/FlowView2D ./LayerView2D ./graphics/GraphicsView2D ./graphics/HighlightGraphicContainer ./imagery/ImageryView2D ./imagery/VectorFieldView2D ../../layers/ImageryLayerView ../../layers/LayerView ../../layers/RefreshableLayerView".split(" "),
function(v,A,C,E,n,x,m,I,r,J,y,M,Y,Z,T,P,z,k,w,S){m=function(N){function D(){var c=N.apply(this,arguments)||this;c._exportImageVersion=-1;c._highlightGraphics=new y.GraphicsCollection;c.subview=null;return c}v._inheritsLoose(D,N);var F=D.prototype;F.hitTest=function(){var c=v._asyncToGenerator(function*(b,e){return this.subview?[{type:"graphic",graphic:this.subview.hitTest(b),layer:this.layer,mapPoint:b}]:null});return function(b,e){return c.apply(this,arguments)}}();F.update=function(c){var b;null==
(b=this.subview)?void 0:b.update(c)};F.attach=function(){this.layer.increaseRasterJobHandlerUsage();this._setSubView();this.view&&(this._highlightView=new Z({view:this.view,graphics:this._highlightGraphics,requestUpdateCallback:()=>this.requestUpdate(),container:new T(this.view.featuresTilingScheme)}),this.container.addChild(this._highlightView.container));this.handles.add([n.watch(()=>{var c;return null!=(c=this.layer.blendMode)?c:"normal"},c=>this.subview.container.blendMode=c,n.syncAndInitial),
n.watch(()=>{var c;return null!=(c=this.layer.effect)?c:null},c=>this.subview.container.effect=c,n.syncAndInitial),n.watch(()=>this.layer.exportImageServiceParameters.version,c=>{c&&this._exportImageVersion!==c&&(this._exportImageVersion=c,this.requestUpdate())},n.sync),n.watch(()=>this.timeExtent,c=>{this.subview.timeExtent=c;"redraw"in this.subview?this.requestUpdate():this.subview.redrawOrRefetch()},n.sync),this.layer.on("redraw",()=>{"redraw"in this.subview?this.subview.redraw():this.subview.redrawOrRefetch()}),
n.watch(()=>this.layer.renderer,()=>this._setSubView())],"imagerylayerview-update")};F.detach=function(){var c,b;this.layer.decreaseRasterJobHandlerUsage();this.container.removeAllChildren();this._detachSubview(this.subview);null==(c=this.subview)?void 0:c.destroy();this.handles.remove("imagerylayerview-update");this.subview=null;null==(b=this._highlightView)?void 0:b.destroy();this._exportImageVersion=-1};F.moveStart=function(){};F.viewChange=function(){};F.moveEnd=function(){this.requestUpdate()};
F.highlight=function(c,b){if(!((Array.isArray(c)?c[0]:E.isCollection(c)?c.getItemAt(0):c)instanceof C))return{remove:()=>{}};let e=[];Array.isArray(c)||E.isCollection(c)?e=c.map(h=>h.clone()):c instanceof C&&(e=[c.clone()]);this._highlightGraphics.addMany(e);return{remove:()=>{this._highlightGraphics.removeMany(e)}}};F.doRefresh=function(){var c=v._asyncToGenerator(function*(){this.requestUpdate()});return function(){return c.apply(this,arguments)}}();F.isUpdating=function(){return!this.subview||
this.subview.updating};F._setSubView=function(){var c;if(this.view){var b=null==(c=this.layer.renderer)?void 0:c.type;c="imagery";"vector-field"===b?c="imageryVF":"flow"===b&&(c="flow");if(this.subview){var e;if(this.subview.type===c){this._attachSubview(this.subview);"flow"===this.subview.type&&this.subview.redrawOrRefetch();return}this._detachSubview(this.subview);null==(e=this.subview)?void 0:e.destroy()}this.subview="imagery"===c?new P({layer:this.layer,view:this.view,timeExtent:this.timeExtent}):
"imageryVF"===c?new z({layer:this.layer,view:this.view,timeExtent:this.timeExtent}):new M({layer:this.layer,layerView:this});this._attachSubview(this.subview);this.requestUpdate()}};F._attachSubview=function(c){c&&!c.attached&&(c.attach(),c.attached=!0,this.container.addChildAt(c.container,0),c.container.blendMode=this.layer.blendMode,c.container.effect=this.layer.effect)};F._detachSubview=function(c){null!=c&&c.attached&&(this.container.removeChild(c.container),c.detach(),c.attached=!1)};v._createClass(D,
[{key:"pixelData",get:function(){return this.updating?null:"getPixelData"in this.subview?this.subview.getPixelData():null}},{key:"updating",get:function(){return!(this.subview&&!("updating"in this.subview&&this.subview.updating))}}]);return D}(k(S(Y.LayerView2DMixin(w))));A.__decorate([x.property()],m.prototype,"pixelData",null);A.__decorate([x.property({readOnly:!0})],m.prototype,"updating",null);A.__decorate([x.property()],m.prototype,"subview",void 0);return m=A.__decorate([J.subclass("esri.views.2d.layers.ImageryLayerView2D")],
m)});