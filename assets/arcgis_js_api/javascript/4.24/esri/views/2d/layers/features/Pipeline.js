// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
require({cache:{"esri/core/HandleOwner":function(){define("exports ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Accessor ./Handles ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass ./support/WatchUpdatingTracking".split(" "),function(r,u,E,C,v,z,x,f){const k=g=>{g=function(m){function p(){return m.apply(this,arguments)||this}u._inheritsLoose(p,m);p.prototype.destroy=function(){var t,e;this.destroyed||(null==(t=this._get("handles"))?void 0:t.destroy(),null==(e=
this._get("updatingHandles"))?void 0:e.destroy())};u._createClass(p,[{key:"handles",get:function(){return this._get("handles")||new v}},{key:"updatingHandles",get:function(){return this._get("updatingHandles")||new f.WatchUpdatingTracking}}]);return p}(g);E.__decorate([z.property({readOnly:!0})],g.prototype,"handles",null);E.__decorate([z.property({readOnly:!0})],g.prototype,"updatingHandles",null);return g=E.__decorate([x.subclass("esri.core.HandleOwner")],g)};r.HandleOwner=function(g){function m(){return g.apply(this,
arguments)||this}u._inheritsLoose(m,g);return m}(k(C));r.HandleOwner=E.__decorate([x.subclass("esri.core.HandleOwner")],r.HandleOwner);r.HandleOwnerMixin=k;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/Handles":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Accessor ./Collection ./maybe ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass".split(" "),function(r,u,E,C,v,z,x){E=function(f){function k(m){m=
f.call(this,m)||this;m._groups=new Map;return m}r._inheritsLoose(k,f);var g=k.prototype;g.destroy=function(){this.removeAll()};g.add=function(m,p){if(!this._isHandle(m)&&!Array.isArray(m)&&!C.isCollection(m))return this;const t=this._getOrCreateGroup(p);Array.isArray(m)||C.isCollection(m)?m.forEach(e=>this._isHandle(e)&&t.push(e)):t.push(m);this.notifyChange("size");return this};g.forEach=function(m,p){if("function"===typeof m)this._groups.forEach(t=>t.forEach(m));else{const t=this._getGroup(m);t&&
p&&t.forEach(p)}};g.has=function(m){return this._groups.has(this._ensureGroupKey(m))};g.remove=function(m){if(Array.isArray(m)||C.isCollection(m))return m.forEach(this.remove,this),this;if(!this.has(m))return this;const p=this._getGroup(m);for(let t=0;t<p.length;t++)p[t].remove();this._deleteGroup(m);this.notifyChange("size");return this};g.removeAll=function(){this._groups.forEach(m=>{for(let p=0;p<m.length;p++)m[p].remove()});this._groups.clear();this.notifyChange("size");return this};g._isHandle=
function(m){return m&&!!m.remove};g._getOrCreateGroup=function(m){if(this.has(m))return this._getGroup(m);const p=[];this._groups.set(this._ensureGroupKey(m),p);return p};g._getGroup=function(m){return v.assumeNonNull(this._groups.get(this._ensureGroupKey(m)))};g._deleteGroup=function(m){return this._groups.delete(this._ensureGroupKey(m))};g._ensureGroupKey=function(m){return m||"_default_"};r._createClass(k,[{key:"size",get:function(){let m=0;this._groups.forEach(p=>{m+=p.length});return m}}]);return k}(E);
u.__decorate([z.property({readOnly:!0})],E.prototype,"size",null);return E=u.__decorate([x.subclass("esri.core.Handles")],E)})},"esri/core/Collection":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./ArrayPool ./Evented ./lang ./maybe ./ObjectPool ./ObservableChangesType ./scheduling ./accessorSupport/decorators/property ./accessorSupport/ensureType ./accessorSupport/decorators/shared ./accessorSupport/decorators/subclass ./accessorSupport/tracking ./accessorSupport/tracking/SimpleObservable".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t,e,c){function a(G){return G?G instanceof F?G.toArray():G.length?Array.prototype.slice.apply(G):[]:[]}function b(G){if(G&&G.length)return G[0]}function h(G,K,J,I){K&&K.forEach((H,M,N)=>{G.push(H);h(G,J.call(I,H,M,N),J,I)})}var l;let d=function(){function G(){this.target=null;this.defaultPrevented=this.cancellable=!1;this.type=this.item=void 0}var K=G.prototype;K.preventDefault=function(){this.cancellable&&(this.defaultPrevented=!0)};K.reset=function(J){this.defaultPrevented=
!1;this.item=J};return G}();const q=new x(d,void 0,G=>{G.item=null;G.target=null;G.defaultPrevented=!1;G.cancellable=!1}),n=()=>{},B=new Set,A=new Set,w=new Set,y=new Map;let D=0,F=l=function(G,K){function J(H){H=G.call(this,H)||this;H._chgListeners=[];H._notifications=null;H._timer=null;H._observable=new c.SimpleObservable;H.length=0;H._items=[];Object.defineProperty(r._assertThisInitialized(H),"uid",{value:D++});return H}r._inheritsLoose(J,G);J.isCollection=function(H){return null!=H&&H instanceof
l};var I=J.prototype;I.normalizeCtorArgs=function(H){return H?Array.isArray(H)||H instanceof l?{items:H}:H:{}};I.destroy=function(){this.removeAll()};I[K]=function*(){yield*this.items};I.hasEventListener=function(H){return"change"===H?0<this._chgListeners.length:this._emitter.hasEventListener(H)};I.on=function(H,M){if("change"===H){const N=this._chgListeners,P={removed:!1,callback:M};N.push(P);this._notifications&&this._notifications.push({listeners:N.slice(),items:this._items.slice(),changes:[]});
return{remove(){this.remove=n;P.removed=!0;N.splice(N.indexOf(P),1)}}}return this._emitter.on(H,M)};I.once=function(H,M){const N=this.on(H,M);return{remove(){N.remove()}}};I.add=function(H,M){e.trackAccess(this._observable);if(this._emitBeforeChanges(f.ObservableChangesType.ADD))return this;M=this.getNextIndex(null!=M?M:null);this._splice(M,0,[H]);this._emitAfterChanges(f.ObservableChangesType.ADD);return this};I.addMany=function(H,M=this._items.length){e.trackAccess(this._observable);if(!H||!H.length||
this._emitBeforeChanges(f.ObservableChangesType.ADD))return this;M=this.getNextIndex(M);this._splice(M,0,a(H));this._emitAfterChanges(f.ObservableChangesType.ADD);return this};I.at=function(H){e.trackAccess(this._observable);H=Math.trunc(H)||0;0>H&&(H+=this.length);if(!(0>H||H>=this.length))return this._items[H]};I.removeAll=function(){e.trackAccess(this._observable);if(!this.length||this._emitBeforeChanges(f.ObservableChangesType.REMOVE))return[];const H=this._splice(0,this.length)||[];this._emitAfterChanges(f.ObservableChangesType.REMOVE);
return H};I.clone=function(){e.trackAccess(this._observable);return this._createNewInstance({items:this._items.map(v.clone)})};I.concat=function(...H){e.trackAccess(this._observable);H=H.map(a);return this._createNewInstance({items:this._items.concat(...H)})};I.drain=function(H,M){e.trackAccess(this._observable);if(this.length&&!this._emitBeforeChanges(f.ObservableChangesType.REMOVE)){var N=z.assumeNonNull(this._splice(0,this.length)),P=N.length;for(let ba=0;ba<P;ba++)H.call(M,N[ba],ba,N);this._emitAfterChanges(f.ObservableChangesType.REMOVE)}};
I.every=function(H,M){e.trackAccess(this._observable);return this._items.every(H,M)};I.filter=function(H,M){e.trackAccess(this._observable);let N;N=2===arguments.length?this._items.filter(H,M):this._items.filter(H);return this._createNewInstance({items:N})};I.find=function(H,M){e.trackAccess(this._observable);return this._items.find(H,M)};I.findIndex=function(H,M){e.trackAccess(this._observable);return this._items.findIndex(H,M)};I.flatten=function(H,M){e.trackAccess(this._observable);const N=[];
h(N,this,H,M);return new l(N)};I.forEach=function(H,M){e.trackAccess(this._observable);return this._items.forEach(H,M)};I.getItemAt=function(H){e.trackAccess(this._observable);return this._items[H]};I.getNextIndex=function(H){e.trackAccess(this._observable);const M=this.length;H=null==H?M:H;0>H?H=0:H>M&&(H=M);return H};I.includes=function(H,M=0){e.trackAccess(this._observable);return this._items.includes(H,M)};I.indexOf=function(H,M=0){e.trackAccess(this._observable);return this._items.indexOf(H,
M)};I.join=function(H=","){e.trackAccess(this._observable);return this._items.join(H)};I.lastIndexOf=function(H,M=this.length-1){e.trackAccess(this._observable);return this._items.lastIndexOf(H,M)};I.map=function(H,M){e.trackAccess(this._observable);H=this._items.map(H,M);return new l({items:H})};I.reorder=function(H,M=this.length-1){e.trackAccess(this._observable);const N=this.indexOf(H);if(-1!==N){0>M?M=0:M>=this.length&&(M=this.length-1);if(N!==M){if(this._emitBeforeChanges(f.ObservableChangesType.MOVE))return H;
this._splice(N,1);this._splice(M,0,[H]);this._emitAfterChanges(f.ObservableChangesType.MOVE)}return H}};I.pop=function(){e.trackAccess(this._observable);if(this.length&&!this._emitBeforeChanges(f.ObservableChangesType.REMOVE)){var H=b(this._splice(this.length-1,1));this._emitAfterChanges(f.ObservableChangesType.REMOVE);return H}};I.push=function(...H){e.trackAccess(this._observable);if(this._emitBeforeChanges(f.ObservableChangesType.ADD))return this.length;this._splice(this.length,0,H);this._emitAfterChanges(f.ObservableChangesType.ADD);
return this.length};I.reduce=function(H,M){e.trackAccess(this._observable);const N=this._items;return 2===arguments.length?N.reduce(H,M):N.reduce(H)};I.reduceRight=function(H,M){e.trackAccess(this._observable);const N=this._items;return 2===arguments.length?N.reduceRight(H,M):N.reduceRight(H)};I.remove=function(H){e.trackAccess(this._observable);return this.removeAt(this.indexOf(H))};I.removeAt=function(H){e.trackAccess(this._observable);if(!(0>H||H>=this.length||this._emitBeforeChanges(f.ObservableChangesType.REMOVE)))return H=
b(this._splice(H,1)),this._emitAfterChanges(f.ObservableChangesType.REMOVE),H};I.removeMany=function(H){e.trackAccess(this._observable);if(!H||!H.length||this._emitBeforeChanges(f.ObservableChangesType.REMOVE))return[];H=H instanceof l?H.toArray():H;const M=this._items,N=[],P=H.length;for(let W=0;W<P;W++){var ba=M.indexOf(H[W]);if(-1<ba){{var X=W+1;var S=ba+1;const R=Math.min(H.length-X,M.length-S);let Z=0;for(;Z<R&&H[X+Z]===M[S+Z];)Z++;X=Z}X=1+X;(ba=this._splice(ba,X))&&0<ba.length&&N.push.apply(N,
ba);W+=X-1}}this._emitAfterChanges(f.ObservableChangesType.REMOVE);return N};I.reverse=function(){e.trackAccess(this._observable);if(this._emitBeforeChanges(f.ObservableChangesType.MOVE))return this;const H=this._splice(0,this.length);H&&(H.reverse(),this._splice(0,0,H));this._emitAfterChanges(f.ObservableChangesType.MOVE);return this};I.shift=function(){e.trackAccess(this._observable);if(this.length&&!this._emitBeforeChanges(f.ObservableChangesType.REMOVE)){var H=b(this._splice(0,1));this._emitAfterChanges(f.ObservableChangesType.REMOVE);
return H}};I.slice=function(H=0,M=this.length){e.trackAccess(this._observable);return this._createNewInstance({items:this._items.slice(H,M)})};I.some=function(H,M){e.trackAccess(this._observable);return this._items.some(H,M)};I.sort=function(H){e.trackAccess(this._observable);if(!this.length||this._emitBeforeChanges(f.ObservableChangesType.MOVE))return this;const M=z.assumeNonNull(this._splice(0,this.length));arguments.length?M.sort(H):M.sort();this._splice(0,0,M);this._emitAfterChanges(f.ObservableChangesType.MOVE);
return this};I.splice=function(H,M,...N){e.trackAccess(this._observable);const P=(M?f.ObservableChangesType.REMOVE:0)|(N.length?f.ObservableChangesType.ADD:0);if(this._emitBeforeChanges(P))return[];H=this._splice(H,M,N)||[];this._emitAfterChanges(P);return H};I.toArray=function(){e.trackAccess(this._observable);return this._items.slice()};I.toJSON=function(){e.trackAccess(this._observable);return this.toArray()};I.toLocaleString=function(){e.trackAccess(this._observable);return this._items.toLocaleString()};
I.toString=function(){e.trackAccess(this._observable);return this._items.toString()};I.unshift=function(...H){e.trackAccess(this._observable);if(!H.length||this._emitBeforeChanges(f.ObservableChangesType.ADD))return this.length;this._splice(0,0,H);this._emitAfterChanges(f.ObservableChangesType.ADD);return this.length};I._createNewInstance=function(H){return new this.constructor(H)};I._splice=function(H,M,N){const P=this._items;var ba=this.itemType;let X=void 0;!this._notifications&&this.hasEventListener("change")&&
(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._timer=k.schedule(()=>this._dispatchChange()));if(M){X=P.splice(H,M);if(this.hasEventListener("before-remove")){var S=q.acquire();S.target=this;S.cancellable=!0;for(let Z=0,ka=X.length;Z<ka;Z++)M=X[Z],S.reset(M),this.emit("before-remove",S),S.defaultPrevented&&(X.splice(Z,1),P.splice(H,0,M),H+=1,--Z,--ka);q.release(S)}this.length=this._items.length;if(this.hasEventListener("after-remove")){M=
q.acquire();M.target=this;M.cancellable=!1;S=X.length;for(let Z=0;Z<S;Z++)M.reset(X[Z]),this.emit("after-remove",M);q.release(M)}}if(N&&N.length){if(ba){M=[];for(var W of N)N=ba.ensureType(W),null==N&&null!=W||M.push(N);N=M}ba=this.hasEventListener("before-add");W=this.hasEventListener("after-add");M=H===this.length;if(ba||W){var R=q.acquire();R.target=this;R.cancellable=!0;S=q.acquire();S.target=this;S.cancellable=!1;for(const Z of N)ba?(R.reset(Z),this.emit("before-add",R),R.defaultPrevented||(M?
P.push(Z):P.splice(H++,0,Z),this._set("length",P.length),W&&(S.reset(Z),this.emit("after-add",S)))):(M?P.push(Z):P.splice(H++,0,Z),this._set("length",P.length),S.reset(Z),this.emit("after-add",S));q.release(S);q.release(R)}else{if(M)for(R of N)P.push(R);else P.splice(H,0,...N);this._set("length",P.length)}}(N&&N.length||X&&X.length)&&this._notifyChangeEvent(N,X);return X};I._emitBeforeChanges=function(H){let M=!1;if(this.hasEventListener("before-changes")){const N=q.acquire();N.target=this;N.cancellable=
!0;N.type=H;this.emit("before-changes",N);M=N.defaultPrevented;q.release(N)}return M};I._emitAfterChanges=function(H){if(this.hasEventListener("after-changes")){const M=q.acquire();M.target=this;M.cancellable=!1;M.type=H;this.emit("after-changes",M);q.release(M)}this._observable.notify()};I._notifyChangeEvent=function(H,M){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:H,removed:M})};I._dispatchChange=function(){this._timer&&
(this._timer.remove(),this._timer=null);if(this._notifications){var H=this._notifications;this._notifications=null;for(const M of H){H=M.changes;B.clear();A.clear();w.clear();for(const {added:W,removed:R}of H){if(W)if(0===w.size&&0===A.size)for(const Z of W)B.add(Z);else for(const Z of W)A.has(Z)?(w.add(Z),A.delete(Z)):w.has(Z)||B.add(Z);if(R)if(0===w.size&&0===B.size)for(const Z of R)A.add(Z);else for(const Z of R)B.has(Z)?B.delete(Z):(w.delete(Z),A.add(Z))}const N=E.acquire();B.forEach(W=>{N.push(W)});
const P=E.acquire();A.forEach(W=>{P.push(W)});const ba=this._items,X=M.items,S=E.acquire();w.forEach(W=>{X.indexOf(W)!==ba.indexOf(W)&&S.push(W)});if(M.listeners&&(N.length||P.length||S.length)){H={target:this,added:N,removed:P,moved:S};const W=M.listeners.length;for(let R=0;R<W;R++){const Z=M.listeners[R];Z.removed||Z.callback.call(this,H)}}E.release(N);E.release(P);E.release(S)}B.clear();A.clear();w.clear()}};r._createClass(J,[{key:"items",get:function(){e.trackAccess(this._observable);return this._items},
set:function(H){this._emitBeforeChanges(f.ObservableChangesType.ADD)||(this._splice(0,this.length,a(H)),this._emitAfterChanges(f.ObservableChangesType.ADD))}}]);return J}(C.EventedAccessor,Symbol.iterator);F.ofType=G=>{if(!G)return l;if(y.has(G))return y.get(G);let K=null;if("function"===typeof G)K=G.prototype.declaredClass;else if(G.base)K=G.base.prototype.declaredClass;else for(var J in G.typeMap){const I=G.typeMap[J].prototype.declaredClass;K=K?K+` | ${I}`:I}J=function(I){function H(){return I.apply(this,
arguments)||this}r._inheritsLoose(H,I);return H}(l);u.__decorate([p.shared({Type:G,ensureType:"function"===typeof G?m.ensureType(G):m.ensureOneOfType(G)})],J.prototype,"itemType",void 0);J=u.__decorate([t.subclass(`esri.core.Collection<${K}>`)],J);y.set(G,J);return J};u.__decorate([g.property()],F.prototype,"length",void 0);u.__decorate([g.property()],F.prototype,"items",null);return F=l=u.__decorate([t.subclass("esri.core.Collection")],F)})},"esri/core/Evented":function(){define(["../chunks/_rollupPluginBabelHelpers",
"../chunks/tslib.es6","./Accessor","./handleUtils","./accessorSupport/decorators/subclass"],function(r,u,E,C,v){let z=function(){function x(){this._emitter=new x.EventEmitter(this)}var f=x.prototype;f.emit=function(k,g){return this._emitter.emit(k,g)};f.on=function(k,g){return this._emitter.on(k,g)};f.once=function(k,g){return this._emitter.once(k,g)};f.hasEventListener=function(k){return this._emitter.hasEventListener(k)};return x}();(function(x){let f=function(){function g(p=null){this.target=p;
this._listenersMap=null}var m=g.prototype;m.clear=function(){this._listenersMap&&this._listenersMap.clear();this._listenersMap=null};m.emit=function(p,t){p=this._listenersMap&&this._listenersMap.get(p);if(!p)return!1;const e=this.target||this;[...p].forEach(c=>{c.call(e,t)});return 0<p.length};m.on=function(p,t){if(Array.isArray(p)){var e=p.map(c=>this.on(c,t));return C.handlesGroup(e)}if(p.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");
this._listenersMap||(this._listenersMap=new Map);e=this._listenersMap.get(p)||[];e.push(t);this._listenersMap.set(p,e);return{remove:()=>{const c=this._listenersMap&&this._listenersMap.get(p)||[],a=c.indexOf(t);0<=a&&c.splice(a,1)}}};m.once=function(p,t){const e=this.on(p,c=>{e.remove();t.call(null,c)});return e};m.hasEventListener=function(p){p=this._listenersMap&&this._listenersMap.get(p);return null!=p&&0<p.length};return g}();x.EventEmitter=f;x.EventedMixin=g=>{g=function(m){function p(){var e=
m.apply(this,arguments)||this;e._emitter=new f;return e}r._inheritsLoose(p,m);var t=p.prototype;t.destroy=function(){this._emitter.clear()};t.emit=function(e,c){return this._emitter.emit(e,c)};t.on=function(e,c){return this._emitter.on(e,c)};t.once=function(e,c){return this._emitter.once(e,c)};t.hasEventListener=function(e){return this._emitter.hasEventListener(e)};return p}(g);return g=u.__decorate([v.subclass("esri.core.Evented")],g)};let k=function(g){function m(){var t=g.apply(this,arguments)||
this;t._emitter=new z.EventEmitter(r._assertThisInitialized(t));return t}r._inheritsLoose(m,g);var p=m.prototype;p.destroy=function(){this._emitter.clear()};p.emit=function(t,e){return this._emitter.emit(t,e)};p.on=function(t,e){return this._emitter.on(t,e)};p.once=function(t,e){return this._emitter.once(t,e)};p.hasEventListener=function(t){return this._emitter.hasEventListener(t)};return m}(E);k=u.__decorate([v.subclass("esri.core.Evented")],k);x.EventedAccessor=k})(z||(z={}));return z})},"esri/core/ObservableChangesType":function(){define(["exports"],
function(r){r.ObservableChangesType=void 0;var u=r.ObservableChangesType||(r.ObservableChangesType={});u[u.ADD=1]="ADD";u[u.REMOVE=2]="REMOVE";u[u.MOVE=4]="MOVE";Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/accessorSupport/decorators/shared":function(){define(["exports"],function(r){r.shared=function(u){return(E,C)=>{E[C]=u}};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/accessorSupport/tracking/SimpleObservable":function(){define(["exports",
"./ObservationHandle"],function(r,u){let E=function(){function C(){this._observers=[]}var v=C.prototype;v.observe=function(z){this._observers.includes(z)||this._observers.push(z);return new u.ObservationHandle(this._observers,z)};v.notify=function(){const z=this._observers.slice();for(let x=0;x<z.length;++x){const f=z[x];f.onInvalidated();f.onCommitted()}};return C}();r.SimpleObservable=E;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/support/WatchUpdatingTracking":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../Accessor ../Handles ../maybe ../reactiveUtils ../scheduling ../accessorSupport/decorators/property ../accessorSupport/decorators/subclass".split(" "),
function(r,u,E,C,v,z,x,f,k,g){r.WatchUpdatingTracking=function(m){function p(){var e=m.apply(this,arguments)||this;e.updating=!1;e.handleId=0;e.handles=new v;e.scheduleHandleId=0;e.pendingPromises=new Set;return e}u._inheritsLoose(p,m);var t=p.prototype;t.destroy=function(){this.removeAll();this.handles.destroy()};t.add=function(e,c,a={}){return this._installWatch(e,c,a,x.watch)};t.addWhen=function(e,c,a={}){return this._installWatch(e,c,a,x.when)};t.addOnCollectionChange=function(e,c,{initial:a=
!1,final:b=!1}={}){const h=++this.handleId;this.handles.add([x.on(e,"after-changes",this._createSyncUpdatingCallback(),x.sync),x.on(e,"change",c,{onListenerAdd:a?l=>c({added:l.toArray(),removed:[]}):void 0,onListenerRemove:b?l=>c({added:[],removed:l.toArray()}):void 0})],h);return{remove:()=>this.handles.remove(h)}};t.addPromise=function(e){if(z.isNone(e))return e;const c=++this.handleId;this.handles.add({remove:()=>{this.pendingPromises.delete(e)&&(0!==this.pendingPromises.size||this.handles.has(-42)||
this._set("updating",!1))}},c);this.pendingPromises.add(e);this._set("updating",!0);const a=()=>this.handles.remove(c);e.then(a,a);return e};t.removeAll=function(){this.pendingPromises.clear();this.handles.removeAll();this._set("updating",!1)};t._installWatch=function(e,c,a={},b){const h=++this.handleId;a.sync||this._installSyncUpdatingWatch(e,h);e=b(e,c,a);this.handles.add(e,h);return{remove:()=>this.handles.remove(h)}};t._installSyncUpdatingWatch=function(e,c){const a=this._createSyncUpdatingCallback();
e=x.watch(e,a,{sync:!0,equals:()=>!1});this.handles.add(e,c);return e};t._createSyncUpdatingCallback=function(){return()=>{this.handles.remove(-42);++this.scheduleHandleId;const e=this.scheduleHandleId;this._get("updating")||this._set("updating",!0);this.handles.add(f.schedule(()=>{e===this.scheduleHandleId&&(this._set("updating",0<this.pendingPromises.size),this.handles.remove(-42))}),-42)}};return p}(C);E.__decorate([k.property({readOnly:!0})],r.WatchUpdatingTracking.prototype,"updating",void 0);
r.WatchUpdatingTracking=E.__decorate([g.subclass("esri.core.support.WatchUpdatingTracking")],r.WatchUpdatingTracking);r.WatchFlags=void 0;(function(m){m[m.NONE=0]="NONE";m[m.SYNC=1]="SYNC";m[m.INIT=2]="INIT"})(r.WatchFlags||(r.WatchFlags={}));Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/reactiveUtils":function(){define("exports ./events ./handleUtils ./maybe ./promiseUtils ./accessorSupport/watch ./accessorSupport/trackingUtils".split(" "),
function(r,u,E,C,v,z,x){function f(t,e,c={}){return k(t,e,c,m)}function k(t,e,c={},a){let b=null;const h=c.once?(l,d)=>{a(l)&&(C.removeMaybe(b),e(l,d))}:(l,d)=>{a(l)&&e(l,d)};b=z.watchTracked(t,h,c.sync,c.equals);c.initial&&(t=t(),h(t,t));return b}function g(t,e,c){if(v.isAborted(c))return Promise.reject(v.createAbortError());const a=t();if(null!=e&&e(a))return Promise.resolve(a);let b=null;return new Promise((h,l)=>{b=E.handlesGroup([v.onAbort(c,()=>{b=C.removeMaybe(b);l(v.createAbortError())}),
k(t,d=>{b=C.removeMaybe(b);h(d)},{sync:!1,once:!0},null!=e?e:m)])})}function m(t){return!0}function p(t){return!!t}r.autorun=x.autorun;r.initial={initial:!0};r.on=function(t,e,c,a={}){function b(){l&&d&&(d.remove(),null==a.onListenerRemove?void 0:a.onListenerRemove(l),d=l=null)}function h(B){a.once&&a.once&&C.removeMaybe(q);c(B)}let l=null,d=null,q=null;const n=f(t,(B,A)=>{b();u.isEventTarget(B)&&(l=B,d=u.on(B,e,h),null==a.onListenerAdd?void 0:a.onListenerAdd(B))},{sync:a.sync,initial:!0});return q=
E.makeHandle(()=>{n.remove();b()})};r.once=function(t,e){return g(t,null,e)};r.pausable=function(t,e,c={}){let a=!1;const b=f(t,(h,l)=>{a||e(h,l)},c);return{remove(){b.remove()},pause(){a=!0},resume(){a=!1}}};r.sync={sync:!0};r.syncAndInitial={sync:!0,initial:!0};r.watch=f;r.when=function(t,e,c={}){return k(t,e,c,p)};r.whenOnce=function(t,e){return g(t,p,e)};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/TileInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/maybe ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t,e,c,a,b,h,l){var d;E=new E.JSONMap({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});C=d=function(q){function n(A){A=q.call(this,A)||this;A.dpi=96;A.format=null;A.origin=null;A.minScale=0;A.maxScale=0;A.size=null;A.spatialReference=null;return A}r._inheritsLoose(n,q);n.create=function(A=
{}){const {resolutionFactor:w=1,scales:y,size:D=256,spatialReference:F=c.WebMercator,numLODs:G=24}=A;if(!b.isValid(F)){A=[];if(y)for(var K=0;K<y.length;K++){var J=y[K];A.push({level:K,scale:J,resolution:J})}else for(K=5E-4,J=G-1;0<=J;J--)A.unshift({level:J,scale:K,resolution:K}),K*=2;return new d({dpi:96,lods:A,origin:new e(0,0,F),size:[D,D],spatialReference:F})}K=b.getInfo(F);A=A.origin?new e({x:A.origin.x,y:A.origin.y,spatialReference:F}):K?new e({x:K.origin[0],y:K.origin[1],spatialReference:F}):
new e({x:0,y:0,spatialReference:F});K=1/(39.37*z.getMetersPerUnitForSR(F)*96);J=[];if(y)for(var I=0;I<y.length;I++){var H=y[I];J.push({level:I,scale:H,resolution:H*K})}else{var M=b.isGeographic(F)?512/D*5.916575275917094E8:256/D*5.91657527591555E8;I=Math.ceil(G/w);J.push({level:0,scale:M,resolution:M*K});for(H=1;H<I;H++)M/=2**w,J.push({level:H,scale:M,resolution:M*K})}return new d({dpi:96,lods:J,origin:A,size:[D,D],spatialReference:F})};var B=n.prototype;B.readOrigin=function(A,w){return e.fromJSON({spatialReference:w.spatialReference,
...A})};B.readSize=function(A,w){return[w.cols,w.rows]};B.writeSize=function(A,w){w.cols=A[0];w.rows=A[1]};B.zoomToScale=function(A){const w=this.scales;if(0>=A)return w[0];if(A>=w.length-1)return w[w.length-1];{const y=Math.floor(A);return w[y]/(w[y]/w[y+1])**(A-y)}};B.scaleToZoom=function(A){const w=this.scales,y=w.length-1;let D=0;for(;D<y;D++){const F=w[D],G=w[D+1];if(F<=A)break;if(G===A)return D+1;if(F>A&&G<A)return D+Math.log(F/A)/Math.log(F/G)}return D};B.snapScale=function(A,w=.95){A=this.scaleToZoom(A);
return A%Math.floor(A)>=w?this.zoomToScale(Math.ceil(A)):this.zoomToScale(Math.floor(A))};B.tileAt=function(A,w,y,D){var F=this.lodAt(A);if(!F)return null;let G;if("number"===typeof w)G=w,w=y;else{if(b.equals(w.spatialReference,this.spatialReference))G=w.x,w=w.y;else{D=h.project(w,this.spatialReference);if(v.isNone(D))return null;G=D.x;w=D.y}D=y}y=F.resolution*this.size[0];F=F.resolution*this.size[1];D||(D={id:null,level:0,row:0,col:0,extent:a.create()});D.level=A;D.row=Math.floor((this.origin.y-
w)/F+.001);D.col=Math.floor((G-this.origin.x)/y+.001);this.updateTileInfo(D);return D};B.updateTileInfo=function(A,w=d.ExtrapolateOptions.NONE){var y=this.lodAt(A.level);y||w!==d.ExtrapolateOptions.POWER_OF_TWO||(w=this.lods[this.lods.length-1],w.level<A.level&&(y=w));if(y){var D=A.level-y.level;w=y.resolution*this.size[0]/2**D;y=y.resolution*this.size[1]/2**D;A.id=`${A.level}/${A.row}/${A.col}`;A.extent||(A.extent=a.create());A.extent[0]=this.origin.x+A.col*w;A.extent[1]=this.origin.y-(A.row+1)*
y;A.extent[2]=A.extent[0]+w;A.extent[3]=A.extent[1]+y}};B.upsampleTile=function(A){const w=this._upsampleLevels[A.level];if(!w||-1===w.parentLevel)return!1;A.level=w.parentLevel;A.row=Math.floor(A.row/w.factor+.001);A.col=Math.floor(A.col/w.factor+.001);this.updateTileInfo(A);return!0};B.getTileBounds=function(A,w){var {resolution:y}=this.lodAt(w.level);const D=y*this.size[0];y*=this.size[1];A[0]=this.origin.x+w.col*D;A[1]=this.origin.y-(w.row+1)*y;A[2]=A[0]+D;A[3]=A[1]+y;return A};B.lodAt=function(A){return this._levelToLOD&&
this._levelToLOD[A]||null};B.clone=function(){return d.fromJSON(this.write({}))};B.getOrCreateCompatible=function(A,w){if(256===this.size[0]&&256===this.size[1])return 256===A?this:null;const y=[],D=this.lods.length;for(let F=0;F<D;F++){const G=this.lods[F];y.push(new l({level:G.level,scale:G.scale,resolution:G.resolution*w}))}return new d({size:[A,A],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:y})};B._initializeUpsampleLevels=
function(){const A=this.lods;this._upsampleLevels=[];let w=null;for(let y=0;y<A.length;y++){const D=A[y];this._upsampleLevels[D.level]={parentLevel:w?w.level:-1,factor:w?w.resolution/D.resolution:0};w=D}};r._createClass(n,[{key:"isWrappable",get:function(){const {spatialReference:A,origin:w}=this;if(A&&w){const y=b.getInfo(A);return A.isWrappable&&Math.abs(y.origin[0]-w.x)<=y.dx}return!1}},{key:"lods",set:function(A){let w=0,y=0;const D=[];this._levelToLOD={};A&&(w=-Infinity,y=Infinity,A.forEach(F=>
{D.push(F.scale);w=F.scale>w?F.scale:w;y=F.scale<y?F.scale:y;this._levelToLOD[F.level]=F}));this._set("scales",D);this._set("minScale",w);this._set("maxScale",y);this._set("lods",A);this._initializeUpsampleLevels()}}]);return n}(C.JSONSupport);u.__decorate([x.property({type:Number,json:{write:!0}})],C.prototype,"compressionQuality",void 0);u.__decorate([x.property({type:Number,json:{write:!0}})],C.prototype,"dpi",void 0);u.__decorate([x.property({type:String,json:{read:E.read,write:E.write,origins:{"web-scene":{read:!1,
write:!1}}}})],C.prototype,"format",void 0);u.__decorate([x.property({readOnly:!0})],C.prototype,"isWrappable",null);u.__decorate([x.property({type:e,json:{write:!0}})],C.prototype,"origin",void 0);u.__decorate([m.reader("origin")],C.prototype,"readOrigin",null);u.__decorate([x.property({type:[l],value:null,json:{write:!0}})],C.prototype,"lods",null);u.__decorate([x.property({readOnly:!0})],C.prototype,"minScale",void 0);u.__decorate([x.property({readOnly:!0})],C.prototype,"maxScale",void 0);u.__decorate([x.property({readOnly:!0})],
C.prototype,"scales",void 0);u.__decorate([x.property({cast:q=>Array.isArray(q)?q:"number"===typeof q?[q,q]:[256,256]})],C.prototype,"size",void 0);u.__decorate([m.reader("size",["rows","cols"])],C.prototype,"readSize",null);u.__decorate([t.writer("size",{cols:{type:g.Integer},rows:{type:g.Integer}})],C.prototype,"writeSize",null);u.__decorate([x.property({type:c,json:{write:!0}})],C.prototype,"spatialReference",void 0);C=d=u.__decorate([p.subclass("esri.layers.support.TileInfo")],C);(function(q){q=
q.ExtrapolateOptions||(q.ExtrapolateOptions={});q[q.NONE=0]="NONE";q[q.POWER_OF_TWO=1]="POWER_OF_TWO"})(C||(C={}));return C})},"esri/core/unitUtils":function(){define("exports ./has ./jsonMap ./maybe ../geometry/projectionEllipsoid ../geometry/SpatialReference ../geometry/support/Ellipsoid ../geometry/support/spatialReferenceUtils ../geometry/support/WKIDUnitConversion".split(" "),function(r,u,E,C,v,z,x,f,k){function g(S){S=M[S];if(!S)throw Error("unknown type");return S}function m(S){return H[S].baseUnit}
function p(S,W=null){W=W||g(S);return H[W].baseUnit===S}function t(S,W,R){if(W===R)return S;const Z=g(W);if(Z!==g(R))throw Error("incompatible units");S=p(W,Z)?S:S*H[Z].units[W].inBaseUnits;return p(R,Z)?S:S/H[Z].units[R].inBaseUnits}function e(S,W){S=t(S,W,"meters");return 3E3>Math.abs(S)?"meters":"kilometers"}function c(S,W){S=t(S,W,"meters");return 1E5>Math.abs(S)?"meters":"kilometers"}function a(S,W){S=t(S,W,"feet");return 1E3>Math.abs(S)?"feet":"miles"}function b(S,W){S=t(S,W,"feet");return 1E5>
Math.abs(S)?"feet":"miles"}function h(S,W){S=t(S,W,"square-meters");return 3E6>Math.abs(S)?"square-meters":"square-kilometers"}function l(S,W){S=t(S,W,"square-feet");return 1E6>Math.abs(S)?"square-feet":"square-miles"}function d(S){return I.fromJSON(S.toLowerCase())||null}function q(S){const W=n(S),R=S instanceof z?v.getReferenceEllipsoid(S).metersPerDegree:1E5;return W>=R?"meters":w(S)}function n(S,W=x.earth.metersPerDegree){return C.unwrapOr(B(S,!0),W)}function B(S,W=!1){let R,Z,ka=null;null!=S&&
("object"===typeof S?(R=S.wkid,Z=S.wkt):"number"===typeof S?R=S:"string"===typeof S&&(Z=S));if(R){if(f.isWKIDFromMars(R))return x.mars.metersPerDegree;if(f.isWKIDFromMoon(R))return x.moon.metersPerDegree;ka=G.values[G[R]];!ka&&W&&J.has(R)&&(ka=D)}else Z&&(/^PROJCS/i.test(Z)?ka=A(F.exec(Z),ka):/^GEOCCS/i.test(Z)&&(ka=A(K.exec(Z),ka)));return ka}function A(S,W){return S&&S[1]?parseFloat(S[1].split(",")[1]):W}function w(S){var W=null;if(null!=S)if("object"===typeof S){var R=S.wkid;var Z=S.wkt}else"number"===
typeof S?R=S:"string"===typeof S&&(Z=S);if(R)W=G.units[G[R]];else if(Z&&(S=/^PROJCS/i.test(Z)?F:/^GEOCCS/i.test(Z)?K:null)&&(Z=S.exec(Z))&&Z[1]&&(Z=Z[1],W=(W=/[\\"\\']{1}([^\\"\\']+)/.exec(Z))&&W[1],!W||!G.units.includes(W)))for(Z=parseFloat(Z.split(",")[1]),W=null,S=G.values,R=0;R<S.length;++R)if(1E-7>Math.abs(Z-S[R])){W=G.units[R];break}return C.isSome(W)?d(W):null}function y(S){S=w(S);if(C.isNone(S))return null;switch(S){case "feet":case "us-feet":case "clarke-feet":case "clarke-yards":case "clarke-links":case "sears-yards":case "sears-feet":case "sears-chains":case "benoit-1895-b-chains":case "indian-yards":case "indian-1937-yards":case "gold-coast-feet":case "sears-1922-truncated-chains":return"imperial";
case "50-kilometers":case "150-kilometers":case "meters":return"metric"}return null}const D=x.earth.radius*Math.PI/200,F=/UNIT\[([^\]]+)\]\]$/i,G=k,K=/UNIT\[([^\]]+)\]/i,J=new Set([4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140]),I=E.strict()({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",
yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"});u={millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1E3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},
"us-feet":{inBaseUnits:1200/3937}};k={"square-millimeters":{inBaseUnits:1E-6},"square-centimeters":{inBaseUnits:1E-4},"square-decimeters":{inBaseUnits:.1*.1},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:1E6},"square-inches":{inBaseUnits:6.4516E-4},"square-feet":{inBaseUnits:.09290304},"square-yards":{inBaseUnits:.83612736},"square-miles":{inBaseUnits:2589988.110336},"square-us-feet":{inBaseUnits:(S=>S*S)(1200/3937)},acres:{inBaseUnits:4046.8564224},ares:{inBaseUnits:100},hectares:{inBaseUnits:1E4}};
const H={length:{baseUnit:"meters",units:u},area:{baseUnit:"square-meters",units:k},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1E3*1E-9},"cubic-centimeters":{inBaseUnits:.001},"cubic-decimeters":{inBaseUnits:1},"cubic-meters":{inBaseUnits:1E3},"cubic-kilometers":{inBaseUnits:1E12},"cubic-inches":{inBaseUnits:.016387064},"cubic-feet":{inBaseUnits:.09290304*304.8},"cubic-yards":{inBaseUnits:764.554857984},"cubic-miles":{inBaseUnits:4.16818182544058E12}}},
angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},M=(()=>{const S={};for(const W in H)for(const R in H[W].units)S[R]=W;return S})(),N="metric imperial inches feet yards miles nautical-miles us-feet meters kilometers".split(" "),P=new Map([["meters","square-meters"],["feet","square-feet"],["us-feet","square-us-feet"]]),ba={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",
esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},X={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",
esriYards:"yards"};u=E.strict()(ba);k=E.strict()(X);E=E.strict()({...ba,...X});r.areaUnitFromSpatialReference=function(S){S=w(S);return C.isNone(S)?null:P.get(S)};r.areaUnitsJSONMap=u;r.baseUnitForUnit=function(S){return m(g(S))};r.baseUnitForUnitType=m;r.convertUnit=t;r.getDefaultUnitForView=function(S){var W;if(C.isNone(S))return"metric";var R=S.map;if(R=R&&"portalItem"in R?null==(W=R.portalItem)?void 0:W.portal:null){var Z,ka;switch(null!=(Z=null==R?void 0:null==(ka=R.user)?void 0:ka.units)?Z:
R.units){case "metric":return"metric";case "english":return"imperial"}}return C.unwrapOr(y(S.spatialReference),"metric")};r.getDefaultUnitSystem=y;r.getMetersPerUnit=B;r.getMetersPerUnitForSR=n;r.getMetersPerVerticalUnitForSR=function(S){if(S&&"object"===typeof S&&!f.isEarth(S))return 1;S=n(S);return 1E5<S?1:S};r.getUnitString=w;r.getVerticalUnitStringForSR=q;r.inchesPerMeter=39.37;r.isBaseUnit=p;r.isMeasurementSystem=function(S){return"imperial"===S||"metric"===S};r.lengthToDegrees=function(S,W,
R){return t(S,W,"meters")/(R*Math.PI/180)};r.lengthUnitFromSpatialReference=function(S){S=w(S);return C.isNone(S)||!N.includes(S)?null:S};r.lengthUnitsJSONMap=k;r.measurementAreaUnits="metric imperial square-inches square-feet square-yards square-miles square-us-feet square-meters square-kilometers acres ares hectares".split(" ");r.measurementLengthUnits=N;r.preferredAreaUnit=function(S,W,R){switch(R){case "metric":return h(S,W);case "imperial":return l(S,W);default:return R}};r.preferredImperialAreaUnit=
l;r.preferredImperialLengthUnit=a;r.preferredImperialVerticalLengthUnit=b;r.preferredLengthUnit=function(S,W,R){switch(R){case "metric":return e(S,W);case "imperial":return a(S,W);default:return R}};r.preferredMetricAreaUnit=h;r.preferredMetricLengthUnit=e;r.preferredMetricVerticalLengthUnit=c;r.preferredVerticalLengthUnit=function(S,W,R){switch(R){case "metric":return c(S,W);case "imperial":return b(S,W);default:return R}};r.unitFromRESTJSON=d;r.unitToRESTJSON=function(S){return I.toJSON(S)||null};
r.unitType=g;r.unitsJSONMap=E;r.verticalLengthUnitFromSpatialReference=function(S){S=q(S);return C.isNone(S)||!N.includes(S)?null:S};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/projectionEllipsoid":function(){define(["exports","./SpatialReference","./support/Ellipsoid","./support/spatialReferenceUtils"],function(r,u,E,C){function v(g){return new u({wkt:`GEOCCS["Spherical geocentric",\n    DATUM["Not specified",\n      SPHEROID["Sphere",${g.radius},0]],\n    PRIMEM["Greenwich",0.0,\n      AUTHORITY["EPSG","8901"]],\n    UNIT["m",1.0],\n    AXIS["Geocentric X",OTHER],\n    AXIS["Geocentric Y",EAST],\n    AXIS["Geocentric Z",NORTH]\n  ]`})}
const z=v(E.earth),x=v(E.mars),f=v(E.moon),k=new u({wkt:`GEOCCS["WGS 84",\n  DATUM["WGS_1984",\n    SPHEROID["WGS 84",${E.earth.radius},298.257223563,\n      AUTHORITY["EPSG","7030"]],\n    AUTHORITY["EPSG","6326"]],\n  PRIMEM["Greenwich",0,\n    AUTHORITY["EPSG","8901"]],\n  UNIT["m",1.0,\n    AUTHORITY["EPSG","9001"]],\n  AXIS["Geocentric X",OTHER],\n  AXIS["Geocentric Y",OTHER],\n  AXIS["Geocentric Z",NORTH],\n  AUTHORITY["EPSG","4978"]\n]`});r.SphericalECEFSpatialReference=z;r.SphericalPCPFMars=
x;r.SphericalPCPFMoon=f;r.WGS84ECEFSpatialReference=k;r.createSphericalPCPF=v;r.getReferenceEllipsoid=function(g){return g&&(C.isMars(g)||g===x)?E.mars:g&&(C.isMoon(g)||g===f)?E.moon:E.earth};r.getReferenceEllipsoidFromWKID=function(g){return C.isWKIDFromMars(g)?E.mars:C.isWKIDFromMoon(g)?E.moon:E.earth};r.getSphericalPCPF=function(g){return g&&(C.isMars(g)||g===x)?x:g&&(C.isMoon(g)||g===f)?f:z};r.getSphericalPCPFForEllipsoid=function(g){return g&&g===E.mars?x:g&&g===E.moon?f:z};Object.defineProperties(r,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/support/aaBoundingRect":function(){define(["exports","../../core/has","../../core/mathUtils","../../core/maybe","../Extent"],function(r,u,E,C,v){function z(e=t){return[e[0],e[1],e[2],e[3]]}function x(e,c){e!==c&&(e[0]=c[0],e[1]=c[1],e[2]=c[2],e[3]=c[3]);return e}function f(e){return C.isNone(e)||e[0]>=e[2]?0:e[2]-e[0]}function k(e){return e[1]>=e[3]?0:e[3]-e[1]}function g(e,c,a){return c>=e[0]&&a>=e[1]&&c<=e[2]&&a<=e[3]}
function m(e){return null!=e&&4===e.length}const p=[Infinity,Infinity,-Infinity,-Infinity],t=[0,0,0,0];r.NEGATIVE_INFINITY=p;r.POSITIVE_INFINITY=[-Infinity,-Infinity,Infinity,Infinity];r.UNIT=[0,0,1,1];r.ZERO=t;r.allFinite=function(e){for(let c=0;4>c;c++)if(!isFinite(e[c]))return!1;return!0};r.area=function(e){return f(e)*k(e)};r.center=function(e,c=[0,0]){c[0]=(e[0]+e[2])/2;c[1]=(e[1]+e[3])/2;return c};r.clone=function(e){return[e[0],e[1],e[2],e[3]]};r.contains=function(e,c){return c[0]>=e[0]&&c[2]<=
e[2]&&c[1]>=e[1]&&c[3]<=e[3]};r.containsPoint=function(e,c){return g(e,c[0],c[1])};r.containsPointObject=function(e,c){return g(e,c.x,c.y)};r.containsPointWithMargin=function(e,c,a){return c[0]>=e[0]-a&&c[1]>=e[1]-a&&c[0]<=e[2]+a&&c[1]<=e[3]+a};r.containsXY=g;r.containsXYWithMargin=function(e,c,a,b){return c>=e[0]-b&&a>=e[1]-b&&c<=e[2]+b&&a<=e[3]+b};r.copy=x;r.create=z;r.distance=function(e,c){const a=(e[1]+e[3])/2,b=Math.max(Math.abs(c[0]-(e[0]+e[2])/2)-f(e)/2,0);e=Math.max(Math.abs(c[1]-a)-k(e)/
2,0);return Math.sqrt(b*b+e*e)};r.empty=function(e){return e?x(e,p):z(p)};r.equals=function(e,c){return m(e)&&m(c)?e[0]===c[0]&&e[1]===c[1]&&e[2]===c[2]&&e[3]===c[3]:e===c};r.expand=function(e,c,a){if(C.isNone(c))x(a,e);else if("length"in c)if(m(c))a[0]=Math.min(e[0],c[0]),a[1]=Math.min(e[1],c[1]),a[2]=Math.max(e[2],c[2]),a[3]=Math.max(e[3],c[3]);else{if(2===c.length||3===c.length)a[0]=Math.min(e[0],c[0]),a[1]=Math.min(e[1],c[1]),a[2]=Math.max(e[2],c[0]),a[3]=Math.max(e[3],c[1])}else switch(c.type){case "extent":a[0]=
Math.min(e[0],c.xmin);a[1]=Math.min(e[1],c.ymin);a[2]=Math.max(e[2],c.xmax);a[3]=Math.max(e[3],c.ymax);break;case "point":a[0]=Math.min(e[0],c.x),a[1]=Math.min(e[1],c.y),a[2]=Math.max(e[2],c.x),a[3]=Math.max(e[3],c.y)}};r.expandPointInPlace=function(e,c){c[0]<e[0]&&(e[0]=c[0]);c[0]>e[2]&&(e[2]=c[0]);c[1]<e[1]&&(e[1]=c[1]);c[1]>e[3]&&(e[3]=c[1])};r.expandWithNestedArray=function(e,c,a=e){const b=c.length;let h=e[0],l=e[1],d=e[2];e=e[3];for(let q=0;q<b;q++){const n=c[q];h=Math.min(h,n[0]);l=Math.min(l,
n[1]);d=Math.max(d,n[0]);e=Math.max(e,n[1])}a[0]=h;a[1]=l;a[2]=d;a[3]=e;return a};r.fromExtent=function(e,c=z()){c[0]=e.xmin;c[1]=e.ymin;c[2]=e.xmax;c[3]=e.ymax;return c};r.fromValues=function(e,c,a,b,h=z()){h[0]=e;h[1]=c;h[2]=a;h[3]=b;return h};r.height=k;r.intersection=function(e,c,a){if(C.isNone(c))return x(a,e);const b=c[0],h=c[1],l=c[2];c=c[3];a[0]=E.clamp(e[0],b,l);a[1]=E.clamp(e[1],h,c);a[2]=E.clamp(e[2],b,l);a[3]=E.clamp(e[3],h,c);return a};r.intersects=function(e,c){return Math.max(c[0],
e[0])<=Math.min(c[2],e[2])&&Math.max(c[1],e[1])<=Math.min(c[3],e[3])};r.intersectsSegment=function(e,c,a){const b=e[0],h=e[1],l=e[2];e=e[3];const {x:d,y:q}=c,{x:n,y:B}=a;var A=(y,D)=>0>(B-q)*y+(d-n)*D+(n*q-d*B);c=A(b,e);a=A(l,e);const w=A(l,h);A=A(b,h);return c===a&&a===w&&w===A&&A===c||d<b&&n<b||d>l&&n>l||q>e&&B>e||q<h&&B<h?!1:!0};r.intersectsSphere=function(e,c){const a=c[3];var b=Math.abs(c[0]-.5*(e[0]+e[2]));const h=.5*(e[2]-e[0]);if(b>a+h)return!1;var l=.5*(e[3]-e[1]);e=Math.abs(c[1]-.5*(e[1]+
e[3]));if(e>a+l)return!1;if(b<h||e<l)return!0;b-=h;l=e-l;return b*b+l*l<=a*a};r.is=m;r.isPoint=function(e){return(0===f(e)||!isFinite(e[0]))&&(0===k(e)||!isFinite(e[1]))};r.offset=function(e,c,a,b=e){b[0]=e[0]+c;b[1]=e[1]+a;b[2]=e[2]+c;b[3]=e[3]+a;return b};r.pad=function(e,c,a=e){a[0]=e[0]-c;a[1]=e[1]-c;a[2]=e[2]+c;a[3]=e[3]+c;return a};r.setMax=function(e,c,a=e){a[2]=c[0];a[3]=c[1];a!==e&&(a[0]=e[0],a[1]=e[1]);return e};r.setMin=function(e,c,a=e){a[0]=c[0];a[1]=c[1];a!==e&&(a[2]=e[2],a[3]=e[3]);
return a};r.size=function(e,c){c[0]=e[2]-e[0];c[1]=e[3]-e[1]};r.toExtent=function(e,c){return new v({xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:c})};r.width=f;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/LOD":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(r,u,E,C,v,z,x,f){var k;E=k=function(g){function m(p){p=g.call(this,p)||this;p.cols=null;p.level=0;p.levelValue=null;p.origin=null;p.resolution=0;p.rows=null;p.scale=0;return p}r._inheritsLoose(m,g);m.prototype.clone=function(){return new k({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})};return m}(E.JSONSupport);u.__decorate([C.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,
write:!1}}}})],E.prototype,"cols",void 0);u.__decorate([C.property({type:x.Integer,json:{write:!0}})],E.prototype,"level",void 0);u.__decorate([C.property({type:String,json:{write:!0}})],E.prototype,"levelValue",void 0);u.__decorate([C.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],E.prototype,"origin",void 0);u.__decorate([C.property({type:Number,json:{write:!0}})],E.prototype,"resolution",void 0);u.__decorate([C.property({json:{write:!0,
origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],E.prototype,"rows",void 0);u.__decorate([C.property({type:Number,json:{write:!0}})],E.prototype,"scale",void 0);return E=k=u.__decorate([f.subclass("esri.layers.support.LOD")],E)})},"esri/views/2d/layers/features/processors":function(){define(["require","exports"],function(r,u){const E=C=>Object.freeze(Object.defineProperty({__proto__:null,default:C},Symbol.toStringTag,{value:"Module"}));u.loadProcessorModule=function(C){return"heatmap"===
C?new Promise((v,z)=>r(["./processors/HeatmapProcessor"],x=>v(E(x)),z)):new Promise((v,z)=>r(["./processors/SymbolProcessor"],x=>v(E(x)),z))};Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/controllers/FeatureController2D":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/HandleOwner ../../../../../core/has ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/arrayUtils ../../../../../core/accessorSupport/ensureType ../../../../../core/accessorSupport/decorators/subclass ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/data/QueryEngine ../../../../../layers/support/FieldsIndex ../FeatureStore2D ../sources/createSource ../support/AttributeStore ../support/BinStore ../support/ClusterStore ../support/ComputedAttributeStorage ../support/FeatureSetReaderJSON ../support/UpdateToken ../../../../support/QueueProcessor".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t,e,c,a,b,h,l,d,q,n,B){function A(y){if(!z.isAbortError(y)&&"worker:port-closed"!==y.name)throw y;}function w(y){return"feature"===y.type&&"snapshot"===y.mode}E=function(y){function D(){var G=y.apply(this,arguments)||this;G._storage=new d.ComputedAttributeStorage;G._markedIdsBufId=G._storage.createBitset();G._lastCleanup=performance.now();G._cleanupNeeded=!1;G._invalidated=!1;G._tileToResolver=new Map;G._didEdit=!1;G._updateVersion=1;G.tileStore=null;G.config=null;
G.processor=null;G.remoteClient=null;G.service=null;return G}r._inheritsLoose(D,y);var F=D.prototype;F.initialize=function(){this._initStores();this._initSource();this._updateQueue=new B.QueueProcessor({concurrency:"geoevent"===this._source.type?1:4,process:(G,K)=>this._onTileMessage(G,{signal:K})});this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this)),x.when(()=>!this.updating,()=>this.onIdle())]);this._checkUpdating=setInterval(()=>this.notifyChange("updating"),300)};F._initSource=
function(){this._source=a.createSource(this.service,this.spatialReference,this.tileStore.tileScheme,(G,K)=>{this._invalidated=!0;return this._patchTile(G,K)},()=>50>this._updateQueue.length,this.featureStore);this._proxyEvents()};F._proxyEvents=function(){if("geoevent"===this._source.type){const G=this._source.events;this.handles.add([G.on("connectionStatus",K=>this.remoteClient.invoke("setProperty",{propertyName:"connectionStatus",value:K}).catch(A)),G.on("errorString",K=>this.remoteClient.invoke("setProperty",
{propertyName:"errorString",value:K}).catch(A)),G.on("feature",K=>this.remoteClient.invoke("emitEvent",{name:"data-received",event:{attributes:K.attributes,centroid:K.centroid,geometry:K.geometry}}).catch(A)),G.on("updateRate",K=>this.remoteClient.invoke("emitEvent",{name:"update-rate",event:{...K}}).catch(A))])}};F._initAttributeStore=function(G){this.attributeStore?this.attributeStore.invalidateResources():this.attributeStore=new b({type:"remote",initialize:(K,J)=>z.ignoreAbortErrors(this.remoteClient.invoke("tileRenderer.featuresView.attributeView.initialize",
K,{signal:J}).catch(A)),update:(K,J)=>z.ignoreAbortErrors(this.remoteClient.invoke("tileRenderer.featuresView.attributeView.requestUpdate",K,{signal:J}).catch(A)),render:K=>z.ignoreAbortErrors(this.remoteClient.invoke("tileRenderer.featuresView.requestRender",void 0,{signal:K}).catch(A))},G,()=>this.notifyChange("updating"))};F._initStores=function(){this.featureStore=new c.FeatureStore2D({geometryInfo:{geometryType:this.service.geometryType,hasM:!1,hasZ:!1},spatialReference:this.spatialReference,
fieldsIndex:this.fieldsIndex,fields:this.service.fields},this._storage,"snapshot"===this.service.type?"snapshot":"on-demand")};F._initQueryEngine=function(G){var K;const J=this;null==(K=this.queryEngine)?void 0:K.destroy();this.queryEngine=new t.QueryEngine({definitionExpression:G.schema.source.definitionExpression,fields:this.service.fields,geometryType:this.service.geometryType,objectIdField:this.service.objectIdField,hasM:!1,hasZ:!1,spatialReference:this.spatialReference.toJSON(),cacheSpatialQueries:!0,
featureStore:this.featureStore,aggregateAdapter:{getFeatureObjectIds(I){return v.isNone(J.aggregateStore)?[]:J.aggregateStore.getFeatureDisplayIdsForAggregate(I).map(H=>J.getObjectId(H))}},timeInfo:this.service.timeInfo})};F.destroy=function(){this._updateQueue.destroy();this._source.destroy();this.queryEngine.destroy();this.attributeStore&&this.attributeStore.destroy();for(const G of this.tileStore.tiles)this._source.unsubscribe(G);clearInterval(this._checkUpdating)};F.isUpdating=function(){const G=
this._source.updating,K=!!this._updateQueue.length,J=!this.attributeStore||this.attributeStore.isUpdating(),I=G||K||J;C("esri-2d-log-updating")&&console.log(`Updating FeatureController2D: ${I}\n  -> updatingSource ${G}\n  -> updateQueue ${K}\n  -> updatingAttributeStore ${J}\n`);return I};F.enableEvent=function(G){this._source.enableEvent(G.name,G.value)};F.pause=function(){this._updateQueue.pause();this._updateQueue.clear()};F.resume=function(){this._updateQueue.resume()};F.pauseStream=function(){"geoevent"===
this._source.type&&this._source.pauseStream()};F.resumeStream=function(){"geoevent"===this._source.type&&this._source.resumeStream()};F._initAggregateStore=function(G){var K,J;const I={geometryInfo:{geometryType:this.service.geometryType,hasM:!1,hasZ:!1},spatialReference:this.spatialReference,fieldsIndex:this.fieldsIndex,fields:this.service.fields};G=null==(K=G.schema.targets)?void 0:null==(J=K.aggregate)?void 0:J.type;if(v.applySome(this.config,H=>{var M,N;return null==(M=H.schema.targets)?void 0:
null==(N=M.aggregate)?void 0:N.type})!==G&&(v.isSome(this.aggregateStore)&&(this.handles.remove("valueRangesChanged"),this.aggregateStore.destroy(),this.aggregateStore=null),G)){switch(G){case "cluster":this.aggregateStore=new l.ClusterStore(I,this.spatialReference,this._storage,this.service);this.handles.add(this.aggregateStore.events.on("valueRangesChanged",H=>{this.remoteClient.invoke("emitEvent",{name:"valueRangesChanged",event:{valueRanges:H.valueRanges}}).catch(A)}),"valueRangesChanged");break;
case "bin":this.aggregateStore=new h.BinStore(I,this.spatialReference,this._storage,this.service)}this.aggregateStore.onTileUpdate({added:this.tileStore.tiles,removed:[]})}};F.update=function(){var G=r._asyncToGenerator(function*(K,J){this._updateVersion++;this._initQueryEngine(J);this._initAttributeStore(J);this.pause();yield Promise.all([this._source.update(K,J.schema.source),this.featureStore.updateSchema(K,J.schema.targets.feature),this.attributeStore.update(K,J),this.attributeStore.updateFilters(K,
J,this)]);this._initAggregateStore(J);v.isSome(this.aggregateStore)&&(yield this.aggregateStore.updateSchema(K,J.schema.targets.aggregate));C("esri-2d-update-debug")&&K.describe();this._set("config",J)});return function(K,J){return G.apply(this,arguments)}}();F.applyUpdate=function(){var G=r._asyncToGenerator(function*(K){K.version=this._updateVersion;C("esri-2d-update-debug")&&console.debug(`Applying update ${K.version}`);K.mesh&&this.clearTiles();this._updateQueue.resume();yield this._source.applyUpdate(K);
this.notifyChange("updating");yield x.whenOnce(()=>!this.updating);v.isSome(this.aggregateStore)&&(yield z.after(10),yield x.whenOnce(()=>!this.updating))});return function(K){return G.apply(this,arguments)}}();F.onEdits=function(){var G=r._asyncToGenerator(function*({edits:K}){C("esri-2d-update-debug")&&console.debug("Applying Edit:",K);this._didEdit=!0;try{const J=K.removed.map(H=>H.objectId&&-1!==H.objectId?H.objectId:this._lookupObjectIdByGlobalId(H.globalId)),I=K.addOrModified.map(({objectId:H})=>
H);this.featureStore.invalidate();yield this._source.edit(I,J);this.clearTiles();this.notifyChange("updating");v.isSome(this.aggregateStore)&&this.aggregateStore.clear();yield this._source.resend();yield x.whenOnce(()=>!this.updating)}catch(J){}});return function(K){return G.apply(this,arguments)}}();F.refresh=function(){var G=r._asyncToGenerator(function*(K){if(!K)return K=n.UpdateToken.empty(),K.storage.filters=!0,this.applyUpdate(K);this.featureStore.invalidate();this.clearTiles();this._source.refresh(this._updateVersion);
this._cleanupNeeded=!0;this.notifyChange("updating");yield x.whenOnce(()=>!this.updating)});return function(K){return G.apply(this,arguments)}}();F.clearTiles=function(){for(const G of this.tileStore.tiles)this.processor.onTileClear(G)};F.onTileUpdate=function(G){if(v.isSome(this.aggregateStore))this.aggregateStore.onTileUpdate(G);for(const K of G.added)this._source.subscribe(K,this._updateVersion),this._level=K.level;for(const K of G.removed)this._source.unsubscribe(K),this._cleanupNeeded=!0,this._tileToResolver.has(K.id)&&
(this._tileToResolver.get(K.id).resolve(),this._tileToResolver.delete(K.id));this.notifyChange("updating")};F.onIdle=function(){var G=r._asyncToGenerator(function*(){this._invalidated&&(this._invalidated=!1,v.isSome(this.aggregateStore)||"heatmap"===this.processor.type)&&(yield this._repushCurrentLevelTiles());this._markAndSweep()});return function(){return G.apply(this,arguments)}}();F.querySummaryStatistics=function(){var G=r._asyncToGenerator(function*({query:K,params:J}){return this.queryEngine.executeQueryForSummaryStatistics(K,
J)});return function(K){return G.apply(this,arguments)}}();F.queryUniqueValues=function(){var G=r._asyncToGenerator(function*({query:K,params:J}){return this.queryEngine.executeQueryForUniqueValues(K,J)});return function(K){return G.apply(this,arguments)}}();F.queryClassBreaks=function(){var G=r._asyncToGenerator(function*({query:K,params:J}){return this.queryEngine.executeQueryForClassBreaks(K,J)});return function(K){return G.apply(this,arguments)}}();F.queryHistogram=function(){var G=r._asyncToGenerator(function*({query:K,
params:J}){return this.queryEngine.executeQueryForHistogram(K,J)});return function(K){return G.apply(this,arguments)}}();F.queryExtent=function(G){return this.queryEngine.executeQueryForExtent(G)};F.queryFeatures=function(G){return this.queryEngine.executeQuery(G)};F.queryVisibleFeatures=function(){var G=r._asyncToGenerator(function*(K){K=yield this.queryEngine.executeQuery(K);const J=K.objectIdFieldName;K.features=K.features.filter(I=>{I=this.getDisplayId(I.attributes[J]);return v.applySome(I,H=>
this.attributeStore.isVisible(H))});return K});return function(K){return G.apply(this,arguments)}}();F.queryFeatureCount=function(G){return this.queryEngine.executeQueryForCount(G)};F.queryLatestObservations=function(G){return this.queryEngine.executeQueryForLatestObservations(G)};F.queryObjectIds=function(G){return this.queryEngine.executeQueryForIds(G)};F.queryStatistics=function(){var G=r._asyncToGenerator(function*(){return this.featureStore.storeStatistics});return function(){return G.apply(this,
arguments)}}();F.getObjectId=function(G){return this.featureStore.lookupObjectId(G,this._storage)};F.getDisplayId=function(G){if(v.isSome(this.aggregateStore)){const K=this.aggregateStore.getDisplayId(G);return v.isNone(K)?(G=this.featureStore.lookupDisplayId(G),this.aggregateStore.getDisplayIdForReferenceId(G)):K}return this.featureStore.lookupDisplayId(G)};F.getFeatures=function(G){const K=[],J=[];for(const I of G)G=v.isSome(this.aggregateStore)?this.getAggregate(I):null,v.isSome(G)?v.isSome(G.referenceId)?
(G=this.getFeature(G.referenceId),v.isSome(G)&&K.push(G)):J.push(G):(G=this.getFeature(I),v.isSome(G)&&K.push(G));return{features:K,aggregates:J}};F.getFeature=function(G){G=this.featureStore.lookupFeatureByDisplayId(G,this._storage);if(v.isNone(G))return null;var K=G.readHydratedGeometry();K=p.convertToGeometry(K,G.geometryType,G.hasZ,G.hasM);return{attributes:G.readAttributes(),geometry:K}};F.getAggregate=function(G){return v.isNone(this.aggregateStore)?null:this.aggregateStore.getAggregate(G)};
F.getAggregates=function(){return v.isNone(this.aggregateStore)?[]:this.aggregateStore.getAggregates()};F.setHighlight=function(){var G=r._asyncToGenerator(function*(K){const J=v.filterNones(K.map(I=>this.getDisplayId(I)));return this.attributeStore.setHighlight(K,J)});return function(K){return G.apply(this,arguments)}}();F._lookupObjectIdByGlobalId=function(G){const K=this.service.globalIdField;if(v.isNone(K))throw Error("Expected globalIdField to be defined");let J=null;this.featureStore.forEach(I=>
{G===I.readAttribute(K)&&(J=I.getObjectId())});if(v.isNone(J))throw Error(`Expected to find a feature with globalId ${G}`);return J};F._repushCurrentLevelTiles=function(){var G=r._asyncToGenerator(function*(){var K=this;const J=this.tileStore.tiles.filter(I=>I.level===this._level).map(function(){var I=r._asyncToGenerator(function*(H){return K._patchTile({type:"append",id:H.key.id,addOrUpdate:q.FeatureSetReaderJSON.fromOptimizedFeatures([],K.service),remove:[],end:!0,status:n.UpdateToken.empty()})});
return function(H){return I.apply(this,arguments)}}());yield Promise.all(J)});return function(){return G.apply(this,arguments)}}();F._maybeForceCleanup=function(){5E3<performance.now()-this._lastCleanup&&this._markAndSweep()};F._patchTile=function(G,K){G=this._updateQueue.push(G,K).then(()=>{this.notifyChange("updating")}).catch(J=>{this.notifyChange("updating")});this.notifyChange("updating");return G};F._onTileMessage=function(){var G=r._asyncToGenerator(function*(K,J){z.throwIfAborted(J);const I=
this.tileStore.get(K.id);if(I){if(K.clear)return this.processor.onTileClear(I);var H=K.status;this._cleanupNeeded=!0;var M=[];for(const N of K.remove){const P=this.featureStore.lookupDisplayId(N);P&&M.push(P)}K.remove=M;try{if(v.isNone(K.addOrUpdate))this.processor.onTileMessage(I,{...K,addOrUpdate:null},v.isSome(this.aggregateStore),J).catch(z.throwIfNotAbortError);else{K.addOrUpdate.setArcadeSpatialReference(this.spatialReference);this.featureStore.hasInstance(K.addOrUpdate.instance)&&H.targets.feature||
(H.targets.feature=!0,this.featureStore.onTileData(I,K));H.storage.data&&H.storage.filters||(H.storage.data=!0,H.storage.filters=!0,this.attributeStore.onTileData(I,K),"geoevent"===this._source.type||this._didEdit?(yield this.attributeStore.sendUpdates(),z.throwIfAborted(J)):this.attributeStore.sendUpdates());if(v.isSome(this.aggregateStore)&&!H.targets.aggregate){H.targets.aggregate=!0;const N=w(this._source)&&this._source.loading,P=!w(this._source)||N||K.end;this.aggregateStore.onTileData(I,K,this._storage,
this.attributeStore,P);if(!P)return;H.mesh||(this.attributeStore.onTileData(I,K),yield this.attributeStore.sendUpdates())}H.mesh||(H.mesh=!0,yield this.processor.onTileMessage(I,K,v.isSome(this.aggregateStore),J),z.throwIfAborted(J));this._maybeForceCleanup()}}catch(N){z.throwIfNotAbortError(N)}}});return function(K,J){return G.apply(this,arguments)}}();F._mark=function(G,K,J){const I=this._storage.getInstanceId(G);G&&(K.add((4294901760&I)>>>16),J.set(G))};F._markAndSweep=function(){this._lastCleanup=
performance.now();if(!("feature"===this._source.type&&"snapshot"===this._source.mode||"geoevent"!==this._source.type&&!this._cleanupNeeded)){this._cleanupNeeded=!1;var G=this._storage.getBitset(this._markedIdsBufId),K=new Set;G.clear();for(const I of this.tileStore.tiles)for(const H of this._source.readers(I.id)){const M=H.getCursor();for(;M.next();){var J=M.getDisplayId();J||(J=M.getObjectId(),J=this.featureStore.lookupDisplayId(J));this._mark(J,K,G)}}"symbol"===this.processor.type&&this.processor.forEachBufferId(I=>
{this._mark(I,K,G)});this._updateQueue.forEach(I=>{for(const H of I.remove)I=this.featureStore.lookupDisplayId(H),this._mark(I,K,G)});v.isSome(this.aggregateStore)&&(this.aggregateStore.sweepFeatures(G,this.featureStore),"sweepAggregates"in this.aggregateStore&&this.aggregateStore.sweepAggregates(this._storage,this.attributeStore,this._level));this.featureStore.sweepFeatures(G,this._storage,this.attributeStore);this.featureStore.sweepFeatureSets(K)}};r._createClass(D,[{key:"fieldsIndex",get:function(){return new e(this.service.fields)}},
{key:"spatialReference",get:function(){return this.tileStore.tileScheme.spatialReference}},{key:"updating",get:function(){return this.isUpdating()}}]);return D}(E.HandleOwner);u.__decorate([f.property({constructOnly:!0})],E.prototype,"tileStore",void 0);u.__decorate([f.property()],E.prototype,"config",void 0);u.__decorate([f.property({readOnly:!0})],E.prototype,"fieldsIndex",null);u.__decorate([f.property()],E.prototype,"processor",void 0);u.__decorate([f.property({constructOnly:!0})],E.prototype,
"remoteClient",void 0);u.__decorate([f.property({constructOnly:!0})],E.prototype,"service",void 0);u.__decorate([f.property()],E.prototype,"spatialReference",null);u.__decorate([f.property()],E.prototype,"updating",null);return E=u.__decorate([m.subclass("esri.views.2d.layers.features.controllers.FeatureController2D")],E)})},"esri/layers/graphics/featureConversionUtils":function(){define("exports ../../core/Error ../../core/Logger ../../core/maybe ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),
function(r,u,E,C,v,z,x,f){function k(U,Q){return U?Q?4:3:Q?3:2}function g(U,Q,da,ea){if(U){if(da)return Q&&ea?L:wa;if(Q&&ea)return Ba}else if(Q&&ea)return wa;return pa}function m({scale:U,translate:Q},da){return Math.round((da-Q[0])/U[0])}function p({scale:U,translate:Q},da){return Math.round((Q[1]-da)/U[1])}function t({scale:U,translate:Q},da){return da*U[0]+Q[0]}function e({scale:U,translate:Q},da){return Q[1]-da*U[1]}function c(U){U=U.coords;return{x:U[0],y:U[1]}}function a(U,Q){U.coords[0]=Q.x;
U.coords[1]=Q.y;return U}function b(U){U=U.coords;return{x:U[0],y:U[1],z:U[2]}}function h(U,Q){U.coords[0]=Q.x;U.coords[1]=Q.y;U.coords[2]=Q.z;return U}function l(U){U=U.coords;return{x:U[0],y:U[1],m:U[2]}}function d(U,Q){U.coords[0]=Q.x;U.coords[1]=Q.y;U.coords[2]=Q.m;return U}function q(U){U=U.coords;return{x:U[0],y:U[1],z:U[2],m:U[3]}}function n(U,Q){U.coords[0]=Q.x;U.coords[1]=Q.y;U.coords[2]=Q.z;U.coords[3]=Q.m;return U}function B(U,Q){return U&&Q?n:U?h:Q?d:a}function A(U,Q,da,ea,ja){da=B(da,
ea);for(const ha of Q){const {geometry:Y,attributes:ca}=ha;let ia;Y&&(ia=da(new f,Y));U.push(new z.OptimizedFeature(ia,ca,null,ca[ja]))}return U}function w(U,Q,da,ea){for(const ja of Q){const {geometry:ha,attributes:Y}=ja;let ca;ha&&(ca=y(ha,da,ea));U.push({attributes:Y,geometry:ca})}return U}function y(U,Q,da){if(C.isNone(U))return null;const ea=k(Q,da),ja=[];for(let ha=0;ha<U.coords.length;ha+=ea){const Y=[];for(let ca=0;ca<ea;ca++)Y.push(U.coords[ha+ca]);ja.push(Y)}return Q?da?{points:ja,hasZ:Q,
hasM:da}:{points:ja,hasZ:Q}:da?{points:ja,hasM:da}:{points:ja}}function D(U,Q,da,ea,ja){da=k(da,ea);for(const ha of Q){Q=ha.geometry;ea=ha.attributes;let Y;Q&&(Y=F(new f,Q,da));U.push(new z.OptimizedFeature(Y,ea,null,ea[ja]))}return U}function F(U,Q,da=k(Q.hasZ,Q.hasM)){U.lengths[0]=Q.points.length;const ea=U.coords;let ja=0;for(const ha of Q.points)for(Q=0;Q<da;Q++)ea[ja++]=ha[Q];return U}function G(U,Q,da){if(!U)return null;const ea=k(Q,da),{coords:ja,lengths:ha}=U;U=[];let Y=0;for(const ca of ha){const ia=
[];for(let ra=0;ra<ca;ra++){const ua=[];for(let za=0;za<ea;za++)ua.push(ja[Y++]);ia.push(ua)}U.push(ia)}return Q?da?{paths:U,hasZ:Q,hasM:da}:{paths:U,hasZ:Q}:da?{paths:U,hasM:da}:{paths:U}}function K(U,Q,da,ea,ja){da=k(da,ea);for(const ha of Q){Q=ha.geometry;ea=ha.attributes;let Y;Q&&(Y=J(new f,Q,da));U.push(new z.OptimizedFeature(Y,ea,null,ea[ja]))}return U}function J(U,Q,da=k(Q.hasZ,Q.hasM)){const {lengths:ea,coords:ja}=U;let ha=0;for(const Y of Q.paths){for(const ca of Y)for(Q=0;Q<da;Q++)ja[ha++]=
ca[Q];ea.push(Y.length)}return U}function I(U,Q,da){if(!U)return null;const ea=k(Q,da),{coords:ja,lengths:ha}=U;U=[];let Y=0;for(const ca of ha){const ia=[];for(let ra=0;ra<ca;ra++){const ua=[];for(let za=0;za<ea;za++)ua.push(ja[Y++]);ia.push(ua)}U.push(ia)}return Q?da?{rings:U,hasZ:Q,hasM:da}:{rings:U,hasZ:Q}:da?{rings:U,hasM:da}:{rings:U}}function H(U,Q,da,ea,ja){for(const ha of Q){Q=ha.geometry;const Y=ha.centroid,ca=ha.attributes;let ia;Q&&(ia=M(new f,Q,da,ea));C.isSome(Y)?U.push(new z.OptimizedFeature(ia,
ca,a(new f,Y),ca[ja])):U.push(new z.OptimizedFeature(ia,ca,null,ca[ja]))}return U}function M(U,Q,da=Q.hasZ,ea=Q.hasM){N(U,Q.rings,da,ea);return U}function N(U,Q,da,ea){da=k(da,ea);const {lengths:ja,coords:ha}=U;ea=0;ja.length=ha.length=0;for(const Y of Q){for(const ca of Y)for(Q=0;Q<da;Q++)ha[ea++]=ca[Q];ja.push(Y.length)}return U}function P(U,Q,da,ea,ja,ha){U.length=0;if(!da){for(const Y of Q)U.push(new z.OptimizedFeature(null,Y.attributes,null,Y.attributes[ha]));return U}switch(da){case "esriGeometryPoint":return A(U,
Q,ea,ja,ha);case "esriGeometryMultipoint":return D(U,Q,ea,ja,ha);case "esriGeometryPolyline":return K(U,Q,ea,ja,ha);case "esriGeometryPolygon":return H(U,Q,ea,ja,ha);default:ka.error("convertToFeatureSet:unknown-geometry",new u(`Unable to parse unknown geometry type '${da}'`)),U.length=0}return U}function ba(U,Q,da,ea){U=U&&("coords"in U?U:U.geometry);if(C.isNone(U))return null;switch(Q){case "esriGeometryPoint":return Q=c,da&&ea?Q=q:da?Q=b:ea&&(Q=l),Q(U);case "esriGeometryMultipoint":return y(U,
da,ea);case "esriGeometryPolyline":return G(U,da,ea);case "esriGeometryPolygon":return I(U,da,ea);default:ka.error("convertToGeometry:unknown-geometry",new u(`Unable to parse unknown geometry type '${Q}'`))}}function X(U,Q,da,ea,ja){U.length=0;if(C.isNone(da)){for(const ca of Q)U.push({attributes:ca.attributes});return U}switch(da){case "esriGeometryPoint":var ha=c;ea&&ja?ha=q:ea?ha=b:ja&&(ha=l);for(var Y of Q){const {geometry:ca,attributes:ia}=Y;ea=C.isSome(ca)?ha(ca):null;U.push({attributes:ia,
geometry:ea})}break;case "esriGeometryMultipoint":return w(U,Q,ea,ja);case "esriGeometryPolyline":for(const ca of Q){const {geometry:ia,attributes:ra}=ca;let ua;C.isSome(ia)&&(ua=G(ia,ea,ja));U.push({attributes:ra,geometry:ua})}break;case "esriGeometryPolygon":for(ha of Q){const {geometry:ca,attributes:ia,centroid:ra}=ha;let ua;C.isSome(ca)&&(ua=I(ca,ea,ja));C.isSome(ra)?(Y=c(ra),U.push({attributes:ia,centroid:Y,geometry:ua})):U.push({attributes:ia,geometry:ua})}break;default:ka.error("convertToFeatureSet:unknown-geometry",
new u(`Unable to parse unknown geometry type '${da}'`))}return U}function S(U,Q,da,ea,ja,ha,Y=da,ca=ea){U.lengths.length&&(U.lengths.length=0);U.coords.length&&(U.coords.length=0);if(C.isNone(Q)||!Q.coords.length)return null;ja=ta[ja];const {coords:ia,lengths:ra}=Q;Q=k(da,ea);const ua=k(da&&Y,ea&&ca);da=g(da,ea,Y,ca);if(!ra.length)return da(U.coords,ia,0,0,m(ha,ia[0]),p(ha,ia[1])),U.lengths.length&&(U.lengths.length=0),U.coords.length=Q,U;let za,Da=0,ya,Ga=0;for(const Ha of ra){if(Ha<ja)continue;
let Fa=0;ya=Ga;ca=ea=m(ha,ia[Da]);za=Y=p(ha,ia[Da+1]);da(U.coords,ia,ya,Da,ca,za);Fa++;Da+=Q;ya+=ua;for(let Ea=1;Ea<Ha;Ea++,Da+=Q)if(ca=m(ha,ia[Da]),za=p(ha,ia[Da+1]),ca!==ea||za!==Y)da(U.coords,ia,ya,Da,ca-ea,za-Y),ya+=ua,Fa++,ea=ca,Y=za;Fa>=ja&&(U.lengths.push(Fa),Ga=ya)}U.coords.length=Ga;return U.coords.length?U:null}function W(U,Q,da,ea,ja,ha,Y){let ca=ea,ia=0;for(let ua=ha+da;ua<Y;ua+=da){{var ra=Q[ua];const za=Q[ua+1],Da=Q[Y],ya=Q[Y+1];let Ga=Q[ha],Ha=Q[ha+1],Fa=Da-Ga,Ea=ya-Ha;if(0!==Fa||0!==
Ea){const Ka=((ra-Ga)*Fa+(za-Ha)*Ea)/(Fa*Fa+Ea*Ea);1<Ka?(Ga=Da,Ha=ya):0<Ka&&(Ga+=Fa*Ka,Ha+=Ea*Ka)}Fa=ra-Ga;Ea=za-Ha;ra=Fa*Fa+Ea*Ea}ra>ca&&(ia=ua,ca=ra)}ca>ea&&(ia-ha>da&&W(U,Q,da,ea,ja,ha,ia),ja(U,Q,U.length,ia,Q[ia],Q[ia+1]),Y-ia>da&&W(U,Q,da,ea,ja,ia,Y))}function R(U,Q,da,ea,ja){const {coords:ha,lengths:Y}=Q,ca=da?ea?L:wa:ea?wa:pa;da=k(da,ea);if(!ha.length)return U!==Q&&(U.lengths.length=0,U.coords.length=0),U;if(!Y.length)return ca(U.coords,ha,0,0,t(ja,ha[0]),e(ja,ha[1])),U!==Q&&(U.lengths.length=
0,U.coords.length=da),U;const [ia,ra]=ja.scale;ea=0;for(let ua=0;ua<Y.length;ua++){const za=Y[ua];U.lengths[ua]=za;let Da=t(ja,ha[ea]),ya=e(ja,ha[ea+1]);ca(U.coords,ha,ea,ea,Da,ya);ea+=da;for(let Ga=1;Ga<za;Ga++,ea+=da)Da+=ha[ea]*ia,ya-=ha[ea+1]*ra,ca(U.coords,ha,ea,ea,Da,ya)}U!==Q&&(U.lengths.length=Y.length,U.coords.length=ha.length);return U}function Z(U,Q,da,ea){let ja=0,ha=U[ea*Q],Y=U[ea*(Q+1)];for(let ca=1;ca<da;ca++){const ia=ha+U[ea*(Q+ca)],ra=Y+U[ea*(Q+ca)+1],ua=(ia-ha)*(ra+Y);ha=ia;Y=ra;
ja+=ua}return.5*ja}const ka=E.getLogger("esri.layers.graphics.featureConversionUtils"),ta={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},pa=(U,Q,da,ea,ja,ha)=>{U[da]=ja;U[da+1]=ha},wa=(U,Q,da,ea,ja,ha)=>{U[da]=ja;U[da+1]=ha;U[da+2]=Q[ea+2]},Ba=(U,Q,da,ea,ja,ha)=>{U[da]=ja;U[da+1]=ha;U[da+2]=Q[ea+3]},L=(U,Q,da,ea,ja,ha)=>{U[da]=ja;U[da+1]=ha;U[da+2]=Q[ea+2];U[da+3]=Q[ea+3]},T=[],la=[];r.convertFromFeature=function(U,Q,da,ea,ja){T[0]=U;[U]=P(la,T,Q,da,ea,
ja);T.length=la.length=0;return U};r.convertFromFeatureSet=function(U,Q){const da=new x,{hasM:ea,hasZ:ja,features:ha,objectIdFieldName:Y,spatialReference:ca,geometryType:ia,exceededTransferLimit:ra,transform:ua,fields:za}=U;za&&(da.fields=za);da.geometryType=ia;da.objectIdFieldName=Y||Q;da.spatialReference=ca;if(!da.objectIdFieldName)return ka.error(new u("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),da;ha&&P(da.features,ha,ia,ja,ea,da.objectIdFieldName);ra&&(da.exceededTransferLimit=
ra);ea&&(da.hasM=ea);ja&&(da.hasZ=ja);ua&&(da.transform=ua);return da};r.convertFromFeatures=P;r.convertFromGeometry=function(U,Q,da){if(C.isNone(U))return null;const ea=new f;"hasZ"in U&&null==Q&&(Q=U.hasZ);"hasM"in U&&null==da&&(da=U.hasM);if(v.isPoint(U))return B(null!=Q?Q:null!=U.z,null!=da?da:null!=U.m)(ea,U);if(v.isPolygon(U))return M(ea,U,Q,da);if(v.isPolyline(U))return J(ea,U,k(Q,da));if(v.isMultipoint(U))return F(ea,U,k(Q,da));ka.error("convertFromGeometry:unknown-geometry",new u(`Unable to parse unknown geometry type '${U}'`))};
r.convertFromGraphics=function(U,Q,da,ea,ja,ha){const Y=U.length;switch(da){case "esriGeometryPoint":A(U,Q,ea,ja,ha);break;case "esriGeometryMultipoint":D(U,Q,ea,ja,ha);break;case "esriGeometryPolyline":K(U,Q,ea,ja,ha);break;case "esriGeometryPolygon":H(U,Q,ea,ja,ha);break;default:ka.error("convertToFeatureSet:unknown-geometry",new u(`Unable to parse unknown geometry type '${da}'`))}for(ea=0;ea<Q.length;ea++)U[ea+Y].geometryType=da,U[ea+Y].insertAfter=Q[ea].insertAfter,U[ea+Y].groupId=Q[ea].groupId;
return U};r.convertFromMultipoint=F;r.convertFromMultipointFeatures=D;r.convertFromNestedArray=N;r.convertFromPoint=function(U,Q,da=B(null!=Q.z,null!=Q.m)){return da(U,Q)};r.convertFromPointFeatures=A;r.convertFromPolygon=M;r.convertFromPolyline=J;r.convertFromPolylineFeatures=K;r.convertToFeature=function(U,Q,da,ea){la[0]=U;X(T,la,Q,da,ea);U=T[0];T.length=la.length=0;return U};r.convertToFeatureSet=function(U){const {objectIdFieldName:Q,spatialReference:da,transform:ea,fields:ja,hasM:ha,hasZ:Y,features:ca,
geometryType:ia,exceededTransferLimit:ra,uniqueIdField:ua,queryGeometry:za,queryGeometryType:Da}=U;U=X([],ca,ia,Y,ha);const ya=ba(za,Da,!1,!1);U={features:U,fields:ja,geometryType:ia,objectIdFieldName:Q,spatialReference:da,uniqueIdField:ua,queryGeometry:ya};ea&&(U.transform=ea);ra&&(U.exceededTransferLimit=ra);ha&&(U.hasM=ha);Y&&(U.hasZ=Y);return U};r.convertToFeatures=X;r.convertToGeometry=ba;r.convertToMultipoint=y;r.convertToMultipointFeatures=w;r.convertToPoint=function(U,Q,da){return U?Q?da?
q(U):b(U):da?l(U):c(U):null};r.convertToPolygon=I;r.convertToPolyline=G;r.deltaDecodeGeometry=function(U,Q){if(C.isNone(U))return null;const da=U.clone(),ea=U.coords;U=U.lengths;let ja=0;for(let ca=0;ca<U.length;ca++){const ia=U[ca];var ha=ea[Q*ja],Y=ea[Q*ja+1];for(let ra=1;ra<ia;ra++)ha+=ea[Q*(ja+ra)],Y+=ea[Q*(ja+ra)+1],da.coords[Q*(ja+ra)]=ha,da.coords[Q*(ja+ra)+1]=Y;ja+=ia}return da};r.deltaEncodeGeometry=function(U,Q){const da=U.clone(),ea=U.coords;U=U.lengths;let ja=0;for(let Y=0;Y<U.length;Y++){const ca=
U[Y];let ia=ea[Q*ja];var ha=ea[Q*ja+1];for(let ra=1;ra<ca;ra++){const ua=ea[Q*(ja+ra)],za=ea[Q*(ja+ra)+1];ha=za-ha;da.coords[Q*(ja+ra)]=ua-ia;da.coords[Q*(ja+ra)+1]=ha;ia=ua;ha=za}ja+=ca}return da};r.generalizeOptimizedGeometry=function(U,Q,da,ea,ja,ha,Y=da,ca=ea){U.lengths.length&&(U.lengths.length=0);U.coords.length&&(U.coords.length=0);if(!Q||!Q.coords.length)return null;ja=ta[ja];const {coords:ia,lengths:ra}=Q;Q=k(da,ea);const ua=k(da&&Y,ea&&ca);da=g(da,ea,Y,ca);if(!ra.length)return da(U.coords,
ia,0,0,ia[0],ia[1]),U.lengths.length&&(U.lengths.length=0),U.coords.length=Q,U;ea=0;ha*=ha;for(const za of ra){if(za<ja){ea+=za*Q;continue}Y=U.coords.length/ua;ca=ea;const Da=ea+(za-1)*Q;da(U.coords,ia,U.coords.length,ca,ia[ca],ia[ca+1]);W(U.coords,ia,Q,ha,da,ca,Da);da(U.coords,ia,U.coords.length,Da,ia[Da],ia[Da+1]);ca=U.coords.length/ua-Y;ca>=ja?U.lengths.push(ca):U.coords.length=Y*ua;ea+=za*Q}return U.coords.length?U:null};r.getBoundsOptimizedGeometry=function(U,Q,da,ea){if(C.isNone(Q)||!Q.coords||
!Q.coords.length)return null;da=k(da,ea);let ja=ea=Number.POSITIVE_INFINITY,ha=Number.NEGATIVE_INFINITY,Y=Number.NEGATIVE_INFINITY;if(Q&&Q.coords){Q=Q.coords;for(let ca=0;ca<Q.length;ca+=da){const ia=Q[ca],ra=Q[ca+1];ea=Math.min(ea,ia);ha=Math.max(ha,ia);ja=Math.min(ja,ra);Y=Math.max(Y,ra)}}U[0]=ea;U[1]=ja;U[2]=ha;U[3]=Y;return U};r.getQuantizedArea=function(U,Q){const {coords:da,lengths:ea}=U;let ja=U=0;for(let ha=0;ha<ea.length;ha++)ja+=Z(da,U,ea[ha],Q),U+=ha;return Math.abs(ja)};r.getQuantizedBoundsOptimizedGeometry=
function(U,Q,da,ea){da=k(da,ea);const {lengths:ja,coords:ha}=Q;ea=Q=Number.POSITIVE_INFINITY;let Y=Number.NEGATIVE_INFINITY,ca=Number.NEGATIVE_INFINITY,ia=0;for(const ra of ja){let ua=ha[ia],za=ha[ia+1];Q=Math.min(ua,Q);ea=Math.min(za,ea);Y=Math.max(ua,Y);ca=Math.max(za,ca);ia+=da;for(let Da=1;Da<ra;Da++,ia+=da){const ya=ha[ia],Ga=ha[ia+1];ua+=ya;za+=Ga;0>ya&&(Q=Math.min(Q,ua));0<ya&&(Y=Math.max(Y,ua));0>Ga?ea=Math.min(ea,za):0<Ga&&(ca=Math.max(ca,za))}}U[0]=Q;U[1]=ea;U[2]=Y;U[3]=ca;return U};r.getSignedQuantizedRingArea=
Z;r.quantizeOptimizedFeatureSet=function(U,Q){const {geometryType:da,features:ea,hasM:ja,hasZ:ha}=Q;if(!U)return Q;for(let Y=0;Y<ea.length;Y++){const ca=ea[Y],ia=ca.weakClone();ia.geometry=new f;S(ia.geometry,ca.geometry,ja,ha,da,U);ca.centroid&&(ia.centroid=new f,S(ia.centroid,ca.centroid,ja,ha,"esriGeometryPoint",U));ea[Y]=ia}Q.transform=U;return Q};r.quantizeOptimizedGeometry=S;r.quantizeX=m;r.quantizeY=p;r.removeCollinearVectices=function(U,Q,da,ea,ja){if(!Q||!Q.coords||!Q.coords.length)return null;
da=ta[da];const {coords:ha,lengths:Y}=Q;Q=g(ea,ja,ea,ja);ea=k(ea,ja);let ca=ja=0,ia=0,ra=0;for(const Da of Y){ca=ra;Q(U.coords,ha,ca,ja,ha[ja],ha[ja+1]);ja+=ea;var ua=ha[ja];let ya=ha[ja+1],Ga=ua,Ha=ya;var za=ya/ua;ca+=ea;Q(U.coords,ha,ca,ja,Ga,Ha);ja+=ea;for(let Fa=2;Fa<Da;Fa++){ua=ha[ja];ya=ha[ja+1];const Ea=ya/ua,Ka=za===Ea||!isFinite(za)&&!isFinite(Ea);za=Ka&&isFinite(Ea)?0<=za&&0<=Ea||0>=za&&0>=Ea:0<=Ha&&0<=ya||0>=Ha&&0>=ya;Ka&&za?(Ga+=ua,Ha+=ya):(Ga=ua,Ha=ya,ca+=ea);Q(U.coords,ha,ca,ja,Ga,Ha);
ja+=ea;za=Ea}ca+=ea;ua=(ca-ra)/ea;ua>=da&&(U.lengths[ia]=ua,ra=ca,ia++)}U.coords.length>ra&&(U.coords.length=ra);U.lengths.length>ia&&(U.lengths.length=ia);return U.coords.length&&U.lengths.length?U:null};r.removeZMValues=function(U,Q,da,ea,ja,ha){const Y=k(da,ea);da=g(da,ea,ja,ha);ea=Q.coords;U.coords.length=0;U.lengths.length=0;U.lengths.push(...Q.lengths);for(Q=0;Q<ea.length;Q+=Y)da(U.coords,ea,U.coords.length,Q,ea[Q],ea[Q+1]);return U};r.unquantizeOptimizedFeatureSet=function(U){const {transform:Q,
features:da,hasM:ea,hasZ:ja}=U;if(!Q)return U;for(const ha of da)C.isSome(ha.geometry)&&R(ha.geometry,ha.geometry,ea,ja,Q),C.isSome(ha.centroid)&&R(ha.centroid,ha.centroid,ea,ja,Q);U.transform=null;return U};r.unquantizeOptimizedGeometry=R;r.unquantizeX=t;r.unquantizeY=e;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/OptimizedFeature":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../core/maybe"],function(r,
u,E){let C=function(){function z(x=null,f={},k,g){this.geometry=x;this.attributes=f;this.centroid=k;this.objectId=g;this.geohashY=this.geohashX=this.displayId=0}z.prototype.weakClone=function(){const x=new z(this.geometry,this.attributes,this.centroid,this.objectId);x.displayId=this.displayId;x.geohashX=this.geohashX;x.geohashY=this.geohashY;return x};return z}(),v=function(z){function x(){return z.apply(this,arguments)||this}u._inheritsLoose(x,z);return x}(C);r.OptimizedFeature=C;r.OptimizedFeatureWithGeometry=
v;r.hasGeometry=function(z){return!(E.isNone(z.geometry)||!z.geometry.coords||!z.geometry.coords.length)};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/OptimizedFeatureSet":function(){define(function(){return function(){function r(){this.spatialReference=this.geometryType=this.geometryProperties=this.geohashFieldName=this.globalIdFieldName=this.objectIdFieldName=null;this.hasM=this.hasZ=!1;this.features=[];this.fields=[];this.transform=
null;this.exceededTransferLimit=!1;this.queryGeometry=this.queryGeometryType=this.uniqueIdField=null}r.prototype.weakClone=function(){const u=new r;u.objectIdFieldName=this.objectIdFieldName;u.globalIdFieldName=this.globalIdFieldName;u.geohashFieldName=this.geohashFieldName;u.geometryProperties=this.geometryProperties;u.geometryType=this.geometryType;u.spatialReference=this.spatialReference;u.hasZ=this.hasZ;u.hasM=this.hasM;u.features=this.features;u.fields=this.fields;u.transform=this.transform;
u.exceededTransferLimit=this.exceededTransferLimit;u.uniqueIdField=this.uniqueIdField;u.queryGeometry=this.queryGeometry;u.queryGeometryType=this.queryGeometryType;return u};return r}()})},"esri/layers/graphics/OptimizedGeometry":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(r){return function(){function u(C=[],v=[],z=!1){this.lengths=null!=C?C:[];this.coords=null!=v?v:[];this.hasIndeterminateRingOrder=z}u.fromRect=function(C){const [v,z,x,f]=C;C=x-v;const k=f-z;return new u([5],
[v,z,C,0,0,k,-C,0,0,-k])};var E=u.prototype;E.forEachVertex=function(C){let v=0;this.lengths.length||C(this.coords[0],this.coords[1]);for(let z=0;z<this.lengths.length;z++){const x=this.lengths[z];for(let f=0;f<x;f++)C(this.coords[2*(f+v)],this.coords[2*(f+v)+1]);v+=x}};E.clone=function(C){return C?(C.set(this.coords),new u(this.lengths.slice(),C,this.hasIndeterminateRingOrder)):new u(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)};r._createClass(u,[{key:"isPoint",get:function(){return 0===
this.lengths.length}},{key:"maxLength",get:function(){return Math.max(...this.lengths)}},{key:"size",get:function(){return this.lengths.reduce((C,v)=>C+v)}}]);return u}()})},"esri/layers/graphics/data/QueryEngine":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/arrayUtils ../../../core/Error ../../../core/lang ../../../core/maybe ../../../core/MemCache ../../../core/unitUtils ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./attributeSupport ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./spatialQuerySupport ./timeSupport ./utils ../../support/FieldsIndex ../../../support/arcadeOnDemand ../../../views/support/Scheduler".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t,e,c,a,b,h,l,d,q,n,B,A,w){function y(H){return H.every(M=>"exceedslimit"!==M.statisticType)}const D=new x.MemCacheStorage(2E6);let F=0,G=function(){function H(N){this.capabilities={query:h.queryCapabilities};this.geometryType=N.geometryType;this.hasM=N.hasM;this.hasZ=N.hasZ;this.objectIdField=N.objectIdField;this.spatialReference=N.spatialReference;this.definitionExpression=N.definitionExpression;this.featureStore=N.featureStore;this.aggregateAdapter=N.aggregateAdapter;
this._changeHandle=this.featureStore.events.on("changed",()=>this.clearCache());this.timeInfo=N.timeInfo;N.cacheSpatialQueries&&(this._geometryQueryCache=new x.MemCache(F++ +"$$",D));this.fieldsIndex=new B(N.fields);N.scheduler&&N.priority&&(this._frameTask=N.scheduler.registerTask(N.priority))}var M=H.prototype;M.destroy=function(){this._frameTask=z.removeMaybe(this._frameTask);this.clearCache();z.destroyMaybe(this._geometryQueryCache);this._changeHandle=z.removeMaybe(this._changeHandle);z.destroyMaybe(this.fieldsIndex)};
M.clearCache=function(){var N;null==(N=this._geometryQueryCache)?void 0:N.clear();this._timeExtent=this._allItems=null};M.executeQuery=function(){var N=u._asyncToGenerator(function*(P,ba){try{return(yield this._executeQuery(P,{},ba)).createQueryResponse()}catch(X){if(X!==n.QUERY_ENGINE_EMPTY_RESULT)throw X;return(new l.QueryEngineResult([],P,this)).createQueryResponse()}});return function(P,ba){return N.apply(this,arguments)}}();M.executeQueryForCount=function(){var N=u._asyncToGenerator(function*(P=
{},ba){try{return(yield this._executeQuery(P,{returnGeometry:!1,returnCentroid:!1,outSR:null},ba)).createQueryResponseForCount()}catch(X){if(X!==n.QUERY_ENGINE_EMPTY_RESULT)throw X;return 0}});return function(){return N.apply(this,arguments)}}();M.executeQueryForExtent=function(){var N=u._asyncToGenerator(function*(P,ba){const X=P.outSR;try{const S=yield this._executeQuery(P,{returnGeometry:!0,returnCentroid:!1,outSR:null},ba),W=S.size;if(!W)return{count:0,extent:null};k.set(J,k.NEGATIVE_INFINITY);
this.featureStore.forEachBounds(S.items,ka=>k.expandWithAABB(J,ka),K);const R={xmin:J[0],ymin:J[1],xmax:J[3],ymax:J[4],spatialReference:n.cleanFromGeometryEngine(this.spatialReference)};this.hasZ&&isFinite(J[2])&&isFinite(J[5])&&(R.zmin=J[2],R.zmax=J[5]);const Z=b.project(R,S.spatialReference,X);Z.spatialReference=n.cleanFromGeometryEngine(X||this.spatialReference);if(0===Z.xmax-Z.xmin){const ka=f.getMetersPerUnitForSR(Z.spatialReference);Z.xmin-=ka;Z.xmax+=ka}if(0===Z.ymax-Z.ymin){const ka=f.getMetersPerUnitForSR(Z.spatialReference);
Z.ymin-=ka;Z.ymax+=ka}if(this.hasZ&&null!=Z.zmin&&null!=Z.zmax&&0===Z.zmax-Z.zmin){const ka=f.getMetersPerUnitForSR(Z.spatialReference);Z.zmin-=ka;Z.zmax+=ka}return{count:W,extent:Z}}catch(S){if(S===n.QUERY_ENGINE_EMPTY_RESULT)return{count:0,extent:null};throw S;}});return function(P,ba){return N.apply(this,arguments)}}();M.executeQueryForIds=function(){var N=u._asyncToGenerator(function*(P,ba){return this.executeQueryForIdSet(P,ba).then(X=>Array.from(X))});return function(P,ba){return N.apply(this,
arguments)}}();M.executeQueryForIdSet=function(){var N=u._asyncToGenerator(function*(P,ba){try{const X=yield this._executeQuery(P,{returnGeometry:!0,returnCentroid:!1,outSR:null},ba),S=X.items,W=new Set;yield this._reschedule(()=>{for(const R of S)W.add(X.featureAdapter.getObjectId(R))},ba);return W}catch(X){if(X===n.QUERY_ENGINE_EMPTY_RESULT)return new Set;throw X;}});return function(P,ba){return N.apply(this,arguments)}}();M.executeQueryForSnapping=function(){var N=u._asyncToGenerator(function*(P,
ba){const {point:X,distance:S,types:W}=P;if(W===l.SnappingTypes.NONE)return{candidates:[]};const R=yield this._reschedule(()=>this._checkQuerySupport(P.query),ba),Z=!e.equals(X.spatialReference,this.spatialReference);Z&&(yield b.checkProjectionSupport(X.spatialReference,this.spatialReference));var ka="number"===typeof S?S:S.x,ta="number"===typeof S?S:S.y;ka={xmin:X.x-ka,xmax:X.x+ka,ymin:X.y-ta,ymax:X.y+ta,spatialReference:X.spatialReference};ka=Z?b.project(ka,this.spatialReference):ka;if(!ka)return{candidates:[]};
ta=(yield t.normalizeCentralMeridian(p.fromJSON(X),null,{signal:ba}))[0];const pa=(yield t.normalizeCentralMeridian(p.fromJSON(ka),null,{signal:ba}))[0];if(z.isNone(ta)||z.isNone(pa))return{candidates:[]};const wa=new l.QueryEngineResult(this._searchFeatures(this._getQueryBBoxes(pa.toJSON())),R,this);yield this._reschedule(()=>this._executeObjectIdsQuery(wa),ba);yield this._reschedule(()=>this._executeTimeQuery(wa),ba);yield this._reschedule(()=>this._executeAttributesQuery(wa),ba);ba=ta.toJSON();
ba=Z?b.project(ba,this.spatialReference):ba;return wa.createSnappingResponse({...P,point:ba,distance:Z?Math.max(ka.xmax-ka.xmin,ka.ymax-ka.ymin)/2:S},X.spatialReference)});return function(P,ba){return N.apply(this,arguments)}}();M.executeQueryForLatestObservations=function(){var N=u._asyncToGenerator(function*(P,ba){if(!this.timeInfo||!this.timeInfo.trackIdField)throw new C("feature-store:unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:P,timeInfo:this.timeInfo});try{const X=
yield this._executeQuery(P,{},ba);yield this._reschedule(()=>this._filterLatest(X),ba);return X.createQueryResponse()}catch(X){if(X!==n.QUERY_ENGINE_EMPTY_RESULT)throw X;return(new l.QueryEngineResult([],P,this)).createQueryResponse()}});return function(P,ba){return N.apply(this,arguments)}}();M.executeQueryForSummaryStatistics=function(){var N=u._asyncToGenerator(function*(P={},ba,X){const {field:S,normalizationField:W,valueExpression:R}=ba;return(yield this._getQueryEngineResultForStats(P,{field:S,
normalizationField:W,valueExpression:R},X)).createSummaryStatisticsResponse(ba)});return function(){return N.apply(this,arguments)}}();M.executeQueryForUniqueValues=function(){var N=u._asyncToGenerator(function*(P={},ba,X){const {field:S,valueExpression:W}=ba;return(yield this._getQueryEngineResultForStats(P,{field:S,valueExpression:W},X)).createUniqueValuesResponse(ba)});return function(){return N.apply(this,arguments)}}();M.executeQueryForClassBreaks=function(){var N=u._asyncToGenerator(function*(P=
{},ba,X){const {field:S,normalizationField:W,valueExpression:R}=ba;return(yield this._getQueryEngineResultForStats(P,{field:S,normalizationField:W,valueExpression:R},X)).createClassBreaksResponse(ba)});return function(){return N.apply(this,arguments)}}();M.executeQueryForHistogram=function(){var N=u._asyncToGenerator(function*(P={},ba,X){const {field:S,normalizationField:W,valueExpression:R}=ba;return(yield this._getQueryEngineResultForStats(P,{field:S,normalizationField:W,valueExpression:R},X)).createHistogramResponse(ba)});
return function(){return N.apply(this,arguments)}}();M._schedule=function(){var N=u._asyncToGenerator(function*(P,ba){return z.isSome(this._frameTask)?this._frameTask.schedule(P,ba):P(w.noBudget)});return function(P,ba){return N.apply(this,arguments)}}();M._reschedule=function(){var N=u._asyncToGenerator(function*(P,ba){return z.isSome(this._frameTask)?this._frameTask.reschedule(P,ba):P(w.noBudget)});return function(P,ba){return N.apply(this,arguments)}}();M._getAll=function(N){z.isNone(this._allItems)&&
(this._allItems=this.featureStore.toArray());return new l.QueryEngineResult(this._allItems,N,this)};M._executeQuery=function(){var N=u._asyncToGenerator(function*(P,ba,X){P=v.clone(P);P=yield this._schedule(()=>n.normalizeQuery(P,this.definitionExpression,this.spatialReference),X);P=yield this._reschedule(()=>this._checkQuerySupport(P),X);P={...P,...ba};const S=yield this._reschedule(()=>this._executeSceneFilterQuery(P,X),X),W=yield this._reschedule(()=>this._executeGeometryQuery(P,S,X),X);yield this._reschedule(()=>
this._executeAggregateIdsQuery(W),X);yield this._reschedule(()=>this._executeObjectIdsQuery(W),X);yield this._reschedule(()=>this._executeTimeQuery(W),X);yield this._reschedule(()=>this._executeAttributesQuery(W),X);return W});return function(P,ba,X){return N.apply(this,arguments)}}();M._executeSceneFilterQuery=function(){var N=u._asyncToGenerator(function*(P,ba){var X=this;if(z.isNone(P.sceneFilter))return null;const {outSR:S,returnGeometry:W,returnCentroid:R}=P;var Z=this.featureStore.featureSpatialReference,
ka=P.sceneFilter.geometry;const ta=z.isNone(Z)||e.equals(Z,ka.spatialReference)?ka:b.project(ka,Z);if(!ta)return null;Z=W||R;Z=e.isValid(S)&&!e.equals(this.spatialReference,S)&&Z?function(){var L=u._asyncToGenerator(function*(T){return X._project(T,S)});return function(T){return L.apply(this,arguments)}}():L=>L;const pa=this.featureAdapter;ka=this._searchFeatures(this._getQueryBBoxes(ta));if("disjoint"===P.sceneFilter.spatialRelationship){if(!ka.length)return null;const L=new Set;for(var wa of ka)L.add(pa.getObjectId(wa));
const T=yield this._reschedule(()=>this.featureStore.toArray(),ba);wa=yield this._reschedule(u._asyncToGenerator(function*(){const la=yield d.getSpatialQueryOperator("esriSpatialRelDisjoint",ta,X.geometryType,X.hasZ,X.hasM),U=yield X._runSpatialFilter(T,Q=>!L.has(pa.getObjectId(Q))||la(pa.getGeometry(Q)),ba);return new l.QueryEngineResult(U,P,X)}),ba);return Z(wa)}if(!ka.length)return new l.QueryEngineResult([],P,this);if(this._canExecuteSinglePass(ta,P))return Z(new l.QueryEngineResult(ka,P,this));
const Ba=yield d.getSpatialQueryOperator("esriSpatialRelContains",ta,this.geometryType,this.hasZ,this.hasM);wa=yield this._runSpatialFilter(ka,L=>Ba(pa.getGeometry(L)),ba);return Z(new l.QueryEngineResult(wa,P,this))});return function(P,ba){return N.apply(this,arguments)}}();M._executeGeometryQuery=function(){var N=u._asyncToGenerator(function*(P,ba,X){var S=this;if(z.isSome(ba)&&0===ba.items.length)return ba;P=z.isSome(ba)?ba.query:P;const {geometry:W,outSR:R,spatialRel:Z,returnGeometry:ka,returnCentroid:ta}=
P;var pa=this.featureStore.featureSpatialReference;const wa=!W||z.isNone(pa)||e.equals(pa,W.spatialReference)?W:b.project(W,pa),Ba=ka||ta,L=e.isValid(R)&&!e.equals(this.spatialReference,R),T=this._geometryQueryCache&&z.isNone(ba)?L&&Ba?JSON.stringify({originalFilterGeometry:W,spatialRelationship:Z,outSpatialReference:R}):JSON.stringify({originalFilterGeometry:W,spatialRelationship:Z}):null;pa=T?this._geometryQueryCache.get(T):null;if(z.isSome(pa))return new l.QueryEngineResult(pa,P,this);pa=function(){var ea=
u._asyncToGenerator(function*(ja){L&&Ba&&(yield S._project(ja,R));T&&S._geometryQueryCache.put(T,ja.items,ja.items.length+1);return ja});return function(ja){return ea.apply(this,arguments)}}();if(!wa)return pa(z.isSome(ba)?ba:this._getAll(P));const la=this.featureAdapter;let U=this._searchFeatures(this._getQueryBBoxes(W));if("esriSpatialRelDisjoint"===Z){if(!U.length)return pa(z.isSome(ba)?ba:this._getAll(P));const ea=new Set;for(var Q of U)ea.add(la.getObjectId(Q));const ja=z.isSome(ba)?ba.items:
yield this._reschedule(()=>this.featureStore.toArray(),X);Q=yield this._reschedule(u._asyncToGenerator(function*(){const ha=yield d.getSpatialQueryOperator(Z,wa,S.geometryType,S.hasZ,S.hasM),Y=yield S._runSpatialFilter(ja,ca=>!ea.has(la.getObjectId(ca))||ha(la.getGeometry(ca)),X);return new l.QueryEngineResult(Y,P,S)}),X);return pa(Q)}if(z.isSome(ba)){const ea=new E.PositionHint;U=U.filter(ja=>0<=E.indexOf(ba.items,ja,ba.items.length,ea))}if(!U.length)return pa=new l.QueryEngineResult([],P,this),
T&&this._geometryQueryCache.put(T,pa.items,1),pa;if(this._canExecuteSinglePass(wa,P))return pa(new l.QueryEngineResult(U,P,this));const da=yield d.getSpatialQueryOperator(Z,wa,this.geometryType,this.hasZ,this.hasM);Q=yield this._runSpatialFilter(U,ea=>da(la.getGeometry(ea)),X);return pa(new l.QueryEngineResult(Q,P,this))});return function(P,ba,X){return N.apply(this,arguments)}}();M._executeAggregateIdsQuery=function(N){if(0!==N.items.length&&N.query.aggregateIds&&N.query.aggregateIds.length&&!z.isNone(this.aggregateAdapter)){var P=
new Set;for(const X of N.query.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(X).forEach(S=>P.add(S));var ba=this.featureAdapter.getObjectId;N.items=N.items.filter(X=>P.has(ba(X)))}};M._executeObjectIdsQuery=function(N){if(0!==N.items.length&&N.query.objectIds&&N.query.objectIds.length){var P=new Set(N.query.objectIds),ba=this.featureAdapter.getObjectId;N.items=N.items.filter(X=>P.has(ba(X)))}};M._executeTimeQuery=function(N){if(0!==N.items.length){var P=q.getTimeOperator(this.timeInfo,N.query.timeExtent,
this.featureAdapter);z.isNone(P)||(N.items=N.items.filter(P))}};M._executeAttributesQuery=function(N){if(0!==N.items.length){var P=a.getWhereClause(N.query.where,this.fieldsIndex);if(P){if(!P.isStandardized)throw new TypeError("Where clause is not standardized");N.items=N.items.filter(ba=>P.testFeature(ba,this.featureAdapter))}}};M._runSpatialFilter=function(){var N=u._asyncToGenerator(function*(P,ba,X){var S=this;if(!ba)return P;if(z.isNone(this._frameTask))return P.filter(ka=>ba(ka));let W=0;const R=
[],Z=function(){var ka=u._asyncToGenerator(function*(ta){for(;W<P.length;){const pa=P[W++];ba(pa)&&(R.push(pa),ta.madeProgress());ta.done&&(yield S._reschedule(wa=>Z(wa),X))}});return function(ta){return ka.apply(this,arguments)}}();return this._reschedule(ka=>Z(ka),X).then(()=>R)});return function(P,ba,X){return N.apply(this,arguments)}}();M._filterLatest=function(N){const {trackIdField:P,startTimeField:ba,endTimeField:X}=this.timeInfo,S=X||ba,W=new Map,R=this.featureAdapter.getAttribute;for(const Z of N.items){const ka=
R(Z,P),ta=R(Z,S),pa=W.get(ka);(!pa||ta>R(pa,S))&&W.set(ka,Z)}N.items=Array.from(W.values())};M._canExecuteSinglePass=function(N,P){({spatialRel:P}=P);return d.canQueryWithRBush(N)&&("esriSpatialRelEnvelopeIntersects"===P||"esriGeometryPoint"===this.geometryType&&("esriSpatialRelIntersects"===P||"esriSpatialRelContains"===P||"esriSpatialRelWithin"===P))};M._project=function(){var N=u._asyncToGenerator(function*(P,ba){if(!ba||e.equals(this.spatialReference,ba))return P;const X=this.featureAdapter;ba=
yield b.projectMany(P.items.map(S=>n.getGeometry(this.geometryType,this.hasZ,this.hasM,X.getGeometry(S))),this.spatialReference,ba);P.items=ba.map((S,W)=>X.cloneWithGeometry(P.items[W],c.convertFromGeometry(S,this.hasZ,this.hasM)));return P});return function(P,ba){return N.apply(this,arguments)}}();M._getQueryBBoxes=function(N){if(d.canQueryWithRBush(N)){if(p.isExtent(N))return[g.fromValues(N.xmin,N.ymin,N.xmax,N.ymax)];if(p.isPolygon(N))return N.rings.map(P=>g.fromValues(Math.min(P[0][0],P[2][0]),
Math.min(P[0][1],P[2][1]),Math.max(P[0][0],P[2][0]),Math.max(P[0][1],P[2][1])))}return[m.getBoundsXY(g.create(),N)]};M._searchFeatures=function(N){for(const P of N)this.featureStore.forEachInBounds(P,ba=>I.add(ba));N=Array.from(I.values());I.clear();return N};M._checkStatisticsSupport=function(){var N=u._asyncToGenerator(function*(P,ba){if(0>P.distance||null!=P.geometryPrecision||P.multipatchOption||P.pixelSize||P.relationParam||P.text||P.outStatistics||P.groupByFieldsForStatistics||P.having||P.orderByFields)throw new C("feature-store:unsupported-query",
"Unsupported query options",{query:P});this._checkAttributesQuerySupport(P);return Promise.all([this._checkStatisticsParamsSupport(ba),d.checkSpatialQuerySupport(P,this.geometryType,this.spatialReference),b.checkProjectionSupport(this.spatialReference,P.outSR)]).then(()=>P)});return function(P,ba){return N.apply(this,arguments)}}();M._checkStatisticsParamsSupport=function(){var N=u._asyncToGenerator(function*(P){var ba=[];P.valueExpression&&({arcadeUtils:ba}=yield A.loadArcade(),ba=ba.extractFieldNames(P.valueExpression));
P.field&&ba.push(P.field);P.normalizationField&&ba.push(P.normalizationField);if(!ba.length)throw new C("feature-store:unsupported-query","params should have at least a field or valueExpression",{params:P});a.validateFields(this.fieldsIndex,ba,"params contains missing fields")});return function(P){return N.apply(this,arguments)}}();M._checkQuerySupport=function(){var N=u._asyncToGenerator(function*(P){if(0>P.distance||null!=P.geometryPrecision||P.multipatchOption||P.pixelSize||P.relationParam||P.text)throw new C("feature-store:unsupported-query",
"Unsupported query options",{query:P});this._checkAttributesQuerySupport(P);this._checkStatisticsQuerySupport(P);return Promise.all([d.checkSpatialQuerySupport(P,this.geometryType,this.spatialReference),b.checkProjectionSupport(this.spatialReference,P.outSR)]).then(()=>P)});return function(P){return N.apply(this,arguments)}}();M._checkAttributesQuerySupport=function(N){const {outFields:P,orderByFields:ba,returnDistinctValues:X,outStatistics:S}=N,W=S?S.map(R=>R.outStatisticFieldName&&R.outStatisticFieldName.toLowerCase()).filter(Boolean):
[];if(ba&&0<ba.length){const R=ba.map(Z=>{const ka=Z.toLowerCase();return ka.includes(" asc")?ka.split(" asc")[0]:ka.includes(" desc")?ka.split(" desc")[0]:Z}).filter(Z=>!W.includes(Z));a.validateFields(this.fieldsIndex,R,"orderByFields contains missing fields")}if(P&&0<P.length)a.validateFields(this.fieldsIndex,P,"outFields contains missing fields");else if(X)throw new C("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:N});a.validateWhere(this.fieldsIndex,
N.where)};M._checkStatisticsQuerySupport=function(N){const {outStatistics:P,groupByFieldsForStatistics:ba,having:X}=N;var S=ba&&ba.length,W=P&&P.length;if(X){if(!S||!W)throw new C("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:N});a.validateHaving(this.fieldsIndex,X,P)}if(W&&y(P)){W=P.map(R=>R.onStatisticField).filter(Boolean);a.validateFields(this.fieldsIndex,W,"onStatisticFields contains missing fields");S&&a.validateFields(this.fieldsIndex,
ba,"groupByFieldsForStatistics contains missing fields");for(const R of P){const {onStatisticField:Z,statisticType:ka}=R;if(("percentile_disc"===ka||"percentile_cont"===ka)&&"statisticParameters"in R){if({statisticParameters:S}=R,!S)throw new C("feature-store:unsupported-query","statisticParamters should be set for percentile type",{definition:R,query:N});}else if("count"!==ka&&Z&&a.hasInvalidFieldType(Z,this.fieldsIndex))throw new C("feature-store:unsupported-query","outStatistics contains non-numeric fields",
{definition:R,query:N});}}};M._getQueryEngineResultForStats=function(){var N=u._asyncToGenerator(function*(P,ba,X){P=v.clone(P);try{P=yield this._schedule(()=>n.normalizeQuery(P,this.definitionExpression,this.spatialReference),X);P=yield this._reschedule(()=>this._checkStatisticsSupport(P,ba),X);const S=yield this._reschedule(()=>this._executeSceneFilterQuery(P,X),X),W=yield this._reschedule(()=>this._executeGeometryQuery(P,S,X),X);yield this._reschedule(()=>this._executeAggregateIdsQuery(W),X);yield this._reschedule(()=>
this._executeObjectIdsQuery(W),X);yield this._reschedule(()=>this._executeTimeQuery(W),X);yield this._reschedule(()=>this._executeAttributesQuery(W),X);return W}catch(S){if(S!==n.QUERY_ENGINE_EMPTY_RESULT)throw S;return new l.QueryEngineResult([],P,this)}});return function(P,ba,X){return N.apply(this,arguments)}}();u._createClass(H,[{key:"featureAdapter",get:function(){return this.featureStore.featureAdapter}},{key:"fullExtent",get:function(){const N=this.featureStore.fullBounds;return z.isNone(N)?
null:{xmin:N[0],ymin:N[1],xmax:N[2],ymax:N[3],spatialReference:n.cleanFromGeometryEngine(this.spatialReference)}}},{key:"timeExtent",get:function(){if(!this.timeInfo)return null;this._timeExtent||(this._timeExtent=q.getTimeExtent(this.timeInfo,this.featureStore));return this._timeExtent}}]);return H}();const K=k.create(),J=k.create(),I=new Set;r.Feature=function(H,M=null,N,P,ba){this.attributes=H;this.geometry=N;this.centroid=P;this.filterFlags=ba;this.groupId=-1;this.displayId=M};r.QueryEngine=G;
Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/MemCache":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","./maybe","./PooledArray"],function(r,u,E,C){r.RemoveMode=void 0;(function(x){x[x.ALL=0]="ALL";x[x.SOME=1]="SOME"})(r.RemoveMode||(r.RemoveMode={}));let v=function(){function x(k,g,m){this._namespace=k;this._storage=g;this._removeFunc=!1;this._miss=this._hit=0;this._storage.register(this);this._namespace+=":";m&&(this._storage.registerRemoveFunc(this._namespace,
m),this._removeFunc=!0)}var f=x.prototype;f.destroy=function(){this._storage.clear(this._namespace);this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace);this._storage.deregister(this);this._storage=null};f.resetHitRate=function(){this._hit=this._miss=0};f.put=function(k,g,m,p=0){this._storage.put(this._namespace+k,g,m,p)};f.get=function(k){k=this._storage.get(this._namespace+k);void 0===k?++this._miss:++this._hit;return k};f.pop=function(k){k=this._storage.pop(this._namespace+k);
void 0===k?++this._miss:++this._hit;return k};f.updateSize=function(k,g,m){this._storage.updateSize(this._namespace+k,g,m)};f.clear=function(){this._storage.clear(this._namespace)};f.clearAll=function(){this._storage.clearAll()};f.getStats=function(){return this._storage.getStats()};f.resetStats=function(){this._storage.resetStats()};u._createClass(x,[{key:"namespace",get:function(){return this._namespace.slice(0,-1)}},{key:"hitRate",get:function(){return this._hit/(this._hit+this._miss)}},{key:"size",
get:function(){return this._storage.size}},{key:"maxSize",get:function(){return this._storage.maxSize}}]);return x}(),z=function(){function x(k=10485760){this._maxSize=k;this._db=new Map;this._miss=this._hit=this._size=0;this._removeFuncs=new C;this._users=new C}var f=x.prototype;f.destroy=function(){this.clearAll();this._removeFuncs.clear();this._users.clear();this._db=null};f.register=function(k){this._users.push(k)};f.deregister=function(k){this._users.removeUnordered(k)};f.registerRemoveFunc=
function(k,g){this._removeFuncs.push([k,g])};f.deregisterRemoveFunc=function(k){this._removeFuncs.filterInPlace(g=>g[0]!==k)};f.put=function(k,g,m,p){const t=this._db.get(k);t&&(this._size-=t.size,this._db.delete(k),t.entry!==g&&this._notifyRemove(k,t.entry,r.RemoveMode.ALL));m>this._maxSize?this._notifyRemove(k,g,r.RemoveMode.ALL):void 0===g?console.warn("Refusing to cache undefined entry "):!m||0>m?console.warn("Refusing to cache entry with invalid size "+m):(p=1+Math.max(p,-3)- -3,this._db.set(k,
{entry:g,size:m,lifetime:p,lives:p}),this._size+=m,this._checkSizeLimit())};f.updateSize=function(k,g,m){const p=this._db.get(k);if(p&&p.entry===g){for(this._size-=p.size;m>this._maxSize;)if(m=this._notifyRemove(k,g,r.RemoveMode.SOME),!(E.isSome(m)&&0<m)){this._db.delete(k);return}p.size=m;this._size+=m;this._checkSizeLimit()}};f.pop=function(k){const g=this._db.get(k);if(g)return this._size-=g.size,this._db.delete(k),++this._hit,g.entry;++this._miss};f.get=function(k){const g=this._db.get(k);if(void 0===
g)++this._miss;else return this._db.delete(k),g.lives=g.lifetime,this._db.set(k,g),++this._hit,g.entry};f.getStats=function(){const k={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},g={},m=[];this._db.forEach((e,c)=>{const a=e.lifetime;m[a]=(m[a]||0)+e.size;this._users.forAll(b=>{b=b.namespace;c.startsWith(b)&&(g[b]=(g[b]||0)+e.size)})});const p={};this._users.forAll(e=>{const c=e.namespace;
!isNaN(e.hitRate)&&0<e.hitRate?(g[c]=g[c]||0,p[c]=Math.round(100*e.hitRate)+"%"):p[c]="0%"});var t=Object.keys(g);t.sort((e,c)=>g[c]-g[e]);t.forEach(e=>k[e]=Math.round(g[e]/2**20)+"MB / "+p[e]);for(t=m.length-1;0<=t;--t){const e=m[t];e&&(k["Priority "+(t+-3-1)]=Math.round(e/this.size*100)+"%")}return k};f.resetStats=function(){this._hit=this._miss=0;this._users.forAll(k=>k.resetHitRate())};f.clear=function(k){this._db.forEach((g,m)=>{m.startsWith(k)&&(this._size-=g.size,this._db.delete(m),this._notifyRemove(m,
g.entry,r.RemoveMode.ALL))})};f.clearAll=function(){this._db.forEach((k,g)=>this._notifyRemove(g,k.entry,r.RemoveMode.ALL));this._size=0;this._db.clear()};f._getHitRate=function(){return this._hit/(this._hit+this._miss)};f._notifyRemove=function(k,g,m){let p;this._removeFuncs.some(t=>k.startsWith(t[0])?(t=t[1](g,m),"number"===typeof t&&(p=t),!0):!1);return p};f._checkSizeLimit=function(){if(!(this._size<=this._maxSize))for(const [k,g]of this._db){this._db.delete(k);if(1>=g.lives){this._size-=g.size;
const m=this._notifyRemove(k,g.entry,r.RemoveMode.SOME);E.isSome(m)&&0<m&&(this._size+=m,g.lives=g.lifetime,g.size=m,this._db.set(k,g))}else--g.lives,this._db.set(k,g);if(this._size<=.9*this.maxSize)break}};u._createClass(x,[{key:"size",get:function(){return this._size}},{key:"maxSize",get:function(){return this._maxSize},set:function(k){this._maxSize=Math.max(k,0);this._checkSizeLimit()}}]);return x}();r.MIN_PRIORITY=-3;r.MemCache=v;r.MemCacheStorage=z;Object.defineProperties(r,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/support/aaBoundingBox":function(){define(["exports","../../core/maybe","../Extent","./aaBoundingRect"],function(r,u,E,C){function v(a=e){return[a[0],a[1],a[2],a[3],a[4],a[5]]}function z(a,b,h,l,d,q,n=v()){n[0]=a;n[1]=b;n[2]=h;n[3]=l;n[4]=d;n[5]=q;return n}function x(a){return a[0]>=a[3]?0:a[3]-a[0]}function f(a){return a[1]>=a[4]?0:a[4]-a[1]}function k(a){return a[2]>=a[5]?0:a[5]-a[2]}function g(a,b){return Math.max(b[0],a[0])<=Math.min(b[3],
a[3])&&Math.max(b[1],a[1])<=Math.min(b[4],a[4])&&Math.max(b[2],a[2])<=Math.min(b[5],a[5])}function m(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];return a}function p(a){return 6===a.length}const t=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity],e=[0,0,0,0,0,0],c=v();r.NEGATIVE_INFINITY=t;r.POSITIVE_INFINITY=[-Infinity,-Infinity,-Infinity,Infinity,Infinity,Infinity];r.ZERO=e;r.allFinite=function(a){for(let b=0;6>b;b++)if(!isFinite(a[b]))return!1;return!0};r.center=function(a,
b=[0,0,0]){b[0]=a[0]+x(a)/2;b[1]=a[1]+f(a)/2;b[2]=a[2]+k(a)/2;return b};r.contains=function(a,b){return b[0]>=a[0]&&b[1]>=a[1]&&b[2]>=a[2]&&b[3]<=a[3]&&b[4]<=a[4]&&b[5]<=a[5]};r.containsPoint=function(a,b){return b[0]>=a[0]&&b[1]>=a[1]&&b[2]>=a[2]&&b[0]<=a[3]&&b[1]<=a[4]&&b[2]<=a[5]};r.containsPointWithMargin=function(a,b,h){return b[0]>=a[0]-h&&b[1]>=a[1]-h&&b[2]>=a[2]-h&&b[0]<=a[3]+h&&b[1]<=a[4]+h&&b[2]<=a[5]+h};r.create=v;r.depth=f;r.diameter=function(a){const b=x(a),h=k(a);a=f(a);return Math.sqrt(b*
b+h*h+a*a)};r.empty=function(a){return a?m(a,t):v(t)};r.equals=function(a,b,h){if(u.isNone(a)||u.isNone(b))return a===b;if(!p(a)||!p(b))return!1;if(h)for(let l=0;l<a.length;l++){if(!h(a[l],b[l]))return!1}else for(h=0;h<a.length;h++)if(a[h]!==b[h])return!1;return!0};r.expandWithAABB=function(a,b){a[0]=Math.min(a[0],b[0]);a[1]=Math.min(a[1],b[1]);a[2]=Math.min(a[2],b[2]);a[3]=Math.max(a[3],b[3]);a[4]=Math.max(a[4],b[4]);a[5]=Math.max(a[5],b[5])};r.expandWithBuffer=function(a,b,h=0,l=b.length/3){let d=
a[0],q=a[1],n=a[2],B=a[3],A=a[4],w=a[5];for(let y=0;y<l;y++)d=Math.min(d,b[h+3*y]),q=Math.min(q,b[h+3*y+1]),n=Math.min(n,b[h+3*y+2]),B=Math.max(B,b[h+3*y]),A=Math.max(A,b[h+3*y+1]),w=Math.max(w,b[h+3*y+2]);a[0]=d;a[1]=q;a[2]=n;a[3]=B;a[4]=A;a[5]=w};r.expandWithNestedArray=function(a,b,h){const l=b.length;let d=a[0],q=a[1],n=a[2],B=a[3],A=a[4],w=a[5];if(h)for(h=0;h<l;h++){var y=b[h];d=Math.min(d,y[0]);q=Math.min(q,y[1]);n=Math.min(n,y[2]);B=Math.max(B,y[0]);A=Math.max(A,y[1]);w=Math.max(w,y[2])}else for(h=
0;h<l;h++)y=b[h],d=Math.min(d,y[0]),q=Math.min(q,y[1]),B=Math.max(B,y[0]),A=Math.max(A,y[1]);a[0]=d;a[1]=q;a[2]=n;a[3]=B;a[4]=A;a[5]=w};r.expandWithOffset=function(a,b,h,l){a[0]=Math.min(a[0],a[0]+b);a[3]=Math.max(a[3],a[3]+b);a[1]=Math.min(a[1],a[1]+h);a[4]=Math.max(a[4],a[4]+h);a[2]=Math.min(a[2],a[2]+l);a[5]=Math.max(a[5],a[5]+l)};r.expandWithRect=function(a,b){a[0]=Math.min(a[0],b[0]);a[1]=Math.min(a[1],b[1]);a[3]=Math.max(a[3],b[2]);a[4]=Math.max(a[4],b[3])};r.expandWithVec3=function(a,b){a[0]=
Math.min(a[0],b[0]);a[1]=Math.min(a[1],b[1]);a[2]=Math.min(a[2],b[2]);a[3]=Math.max(a[3],b[0]);a[4]=Math.max(a[4],b[1]);a[5]=Math.max(a[5],b[2])};r.fromExtent=function(a,b=v()){b[0]=a.xmin;b[1]=a.ymin;b[2]=a.zmin;b[3]=a.xmax;b[4]=a.ymax;b[5]=a.zmax;return b};r.fromMinMax=function(a,b,h=v()){h[0]=a[0];h[1]=a[1];h[2]=a[2];h[3]=b[0];h[4]=b[1];h[5]=b[2];return h};r.fromRect=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=Number.NEGATIVE_INFINITY;a[3]=b[2];a[4]=b[3];a[5]=Number.POSITIVE_INFINITY;return a};r.fromValues=
z;r.getMax=function(a,b){b[0]=a[3];b[1]=a[4];b[2]=a[5];return b};r.getMin=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};r.height=k;r.intersects=g;r.intersectsClippingArea=function(a,b){return u.isNone(b)?!0:g(a,b)};r.is=p;r.isPoint=function(a){return 0===x(a)&&0===f(a)&&0===k(a)};r.maximumDimension=function(a){return Math.max(x(a),k(a),f(a))};r.offset=function(a,b,h,l,d=a){d[0]=a[0]+b;d[1]=a[1]+h;d[2]=a[2]+l;d[3]=a[3]+b;d[4]=a[4]+h;d[5]=a[5]+l;return d};r.scale=function(a,b,h=a){const l=a[0]+
x(a)/2,d=a[1]+f(a)/2,q=a[2]+k(a)/2;h[0]=l+(a[0]-l)*b;h[1]=d+(a[1]-d)*b;h[2]=q+(a[2]-q)*b;h[3]=l+(a[3]-l)*b;h[4]=d+(a[4]-d)*b;h[5]=q+(a[5]-q)*b;return h};r.set=m;r.setMax=function(a,b,h=a){h[3]=b[0];h[4]=b[1];h[5]=b[2];h!==a&&(h[0]=a[0],h[1]=a[1],h[2]=a[2]);return a};r.setMin=function(a,b,h=a){h[0]=b[0];h[1]=b[1];h[2]=b[2];h!==a&&(h[3]=a[3],h[4]=a[4],h[5]=a[5]);return h};r.size=function(a,b=[0,0,0]){b[0]=x(a);b[1]=f(a);b[2]=k(a);return b};r.toExtent=function(a,b){return isFinite(a[2])||isFinite(a[5])?
new E({xmin:a[0],xmax:a[3],ymin:a[1],ymax:a[4],zmin:a[2],zmax:a[5],spatialReference:b}):new E({xmin:a[0],xmax:a[3],ymin:a[1],ymax:a[4],spatialReference:b})};r.toRect=function(a,b){b||(b=C.create());b[0]=a[0];b[1]=a[1];b[2]=a[3];b[3]=a[4];return b};r.width=x;r.wrap=function(a,b,h,l,d,q){return z(a,b,h,l,d,q,c)};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/support/normalizeUtils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../config ../../core/Error ../../core/Logger ../../core/maybe ../Polygon ../Polyline ./normalizeUtilsCommon ./spatialReferenceUtils ./webMercatorUtils ../../rest/geometry/cut ../../rest/geometry/simplify".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t){function e(n){const B=[];let A=0,w=0;for(let y=0;y<n.length;y++){const D=n[y];let F=null;for(let G=0;G<D.length;G++)F=D[G],B.push(F),0===G?w=A=F[0]:(A=Math.min(A,F[0]),w=Math.max(w,F[0]));F&&B.push([(A+w)/2,0])}return B}function c(n,B){if(!(n instanceof f||n instanceof x))throw q.error("straightLineDensify: the input geometry is neither polyline nor polygon"),new C("straightLineDensify: the input geometry is neither polyline nor polygon");var A=k.getGeometryParts(n);
const w=[];for(const D of A){A=[];w.push(A);A.push([D[0][0],D[0][1]]);for(let F=0;F<D.length-1;F++){const G=D[F][0],K=D[F][1],J=D[F+1][0],I=D[F+1][1];var y=Math.sqrt((J-G)*(J-G)+(I-K)*(I-K));const H=(I-K)/y,M=(J-G)/y,N=y/B;if(1<N){for(let P=1;P<=N-1;P++){const ba=P*B;A.push([M*ba+G,H*ba+K])}y=(y+Math.floor(N-1)*B)/2;A.push([M*y+G,H*y+K])}A.push([J,I])}}return"polygon"===n.type?new x({rings:w,spatialReference:n.spatialReference}):new f({paths:w,spatialReference:n.spatialReference})}function a(n,B,
A){B&&(n=c(n,1E6),n=m.webMercatorToGeographic(n,!0));A&&(n=k.updatePolyGeometry(n,A));return n}function b(n,B,A){if(Array.isArray(n)){var w=n[0];w>B?(A=k.offsetMagnitude(w,B),n[0]=w+-2*A*B):w<A&&(B=k.offsetMagnitude(w,A),n[0]=w+-2*B*A)}else w=n.x,w>B?(A=k.offsetMagnitude(w,B),n=n.clone().offset(-2*A*B,0)):w<A&&(B=k.offsetMagnitude(w,A),n=n.clone().offset(-2*B*A,0));return n}function h(n,B){let A=-1;for(let w=0;w<B.cutIndexes.length;w++){const y=B.cutIndexes[w],D=B.geometries[w],F=k.getGeometryParts(D);
for(let G=0;G<F.length;G++){const K=F[G];K.some(J=>{if(180>J[0])return!0;J=0;for(var I=0;I<K.length;I++){var H=K[I][0];J=H>J?H:J}J=Number(J.toFixed(9));J=-360*k.offsetMagnitude(J,180);for(I=0;I<K.length;I++)H=D.getPoint(G,I),D.setPoint(G,I,H.clone().offset(J,0));return!0})}if(y===A)if("polygon"===n[0].type)for(const G of k.getGeometryParts(D))n[y]=n[y].addRing(G);else{if("polyline"===n[0].type)for(const G of k.getGeometryParts(D))n[y]=n[y].addPath(G)}else A=y,n[y]=D}return n}function l(n,B,A){return d.apply(this,
arguments)}function d(){d=u._asyncToGenerator(function*(n,B,A){var w;if(!Array.isArray(n))return l([n],B);B&&"string"!==typeof B&&q.warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");B="string"===typeof B?B:null!=(w=null==B?void 0:B.url)?w:E.geometryServiceUrl;let y,D,F;let G=0;var K=[];w=[];for(var J of n)if(z.isNone(J))w.push(J);else{if(!I){var I=J.spatialReference;var H=g.getInfo(I);var M=(y=I.isWebMercator)?102100:4326;D=k.cutParams[M].maxX;F=k.cutParams[M].minX;
var N=k.cutParams[M].plus180Line;M=k.cutParams[M].minus180Line}if(H)if("mesh"===J.type)w.push(J);else if("point"===J.type)w.push(b(J.clone(),D,F));else if("multipoint"===J.type){var P=J.clone();P.points=P.points.map(ba=>b(ba,D,F));w.push(P)}else if("extent"===J.type)P=J.clone()._normalize(!1,!1,H),w.push(P.rings?new x(P):P);else if(J.extent){P=J.extent;const ba=2*k.offsetMagnitude(P.xmin,F)*D;let X=0===ba?J.clone():k.updatePolyGeometry(J.clone(),ba);P.offset(ba,0);P.intersects(N)&&P.xmax!==D?(G=P.xmax>
G?P.xmax:G,X=a(X,y),K.push(X),w.push("cut")):P.intersects(M)&&P.xmin!==F?(G=2*P.xmax*D>G?2*P.xmax*D:G,X=a(X,y,360),K.push(X),w.push("cut")):w.push(X)}else w.push(J.clone());else w.push(J)}I=k.offsetMagnitude(G,D);H=-90;N=I;for(J=new f;0<I;)M=-180+360*I,J.addPath([[M,H],[M,-1*H]]),H*=-1,I--;if(0<K.length&&0<N){I=yield p.cut(B,K,J,A);I=h(K,I);H=[];K=[];for(N=0;N<w.length;N++)J=w[N],"cut"!==J?K.push(J):(J=I.shift(),M=n[N],z.isSome(M)&&"polygon"===M.type&&M.rings&&1<M.rings.length&&J.rings.length>=M.rings.length?
(H.push(J),K.push("simplify")):K.push(y?m.geographicToWebMercator(J):J));if(!H.length)return K;w=yield t.simplify(B,H,A);n=[];for(A=0;A<K.length;A++)B=K[A],"simplify"!==B?n.push(B):n.push(y?m.geographicToWebMercator(w.shift()):w.shift());return n}n=[];for(A=0;A<w.length;A++)B=w[A],"cut"!==B?n.push(B):(B=K.shift(),n.push(!0===y?m.geographicToWebMercator(B):B));return n});return d.apply(this,arguments)}const q=v.getLogger("esri.geometry.support.normalizeUtils");r.getDenormalizedExtent=function(n){if(!n)return null;
const B=n.extent;if(!B)return null;var A=n.spatialReference&&g.getInfo(n.spatialReference);if(!A)return B;const [w,y]=A.valid;({width:A}=B);let {xmin:D,xmax:F}=B;[D,F]=[F,D];if("extent"===n.type||0===A||A<=y||A>2*y||D<w||F>y)return B;let G;switch(n.type){case "polygon":if(1<n.rings.length)G=e(n.rings);else return B;break;case "polyline":if(1<n.paths.length)G=e(n.paths);else return B;break;case "multipoint":G=n.points}n=B.clone();for(let K=0;K<G.length;K++){let J=G[K][0];0>J?(J+=y,F=Math.max(J,F)):
(J-=y,D=Math.min(J,D))}n.xmin=D;n.xmax=F;return n.width<A?(n.xmin-=y,n.xmax-=y,n):B};r.normalizeCentralMeridian=l;r.normalizeMapX=function(n,B){if(B=g.getInfo(B)){const [A,w]=B.valid;B=w-A;if(n<A)for(;n<A;)n+=B;if(n>w)for(;n>w;)n-=B}return n};r.straightLineDensify=c;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/support/normalizeUtilsCommon":function(){define(["exports","../Polyline","../SpatialReference","./jsonUtils"],function(r,u,E,C){function v(z){return C.isPolygon(z)?
z.rings:z.paths}u={102100:{maxX:2.0037508342788905E7,minX:-2.0037508342788905E7,plus180Line:new u({paths:[[[2.0037508342788905E7,-2.0037508342788905E7],[2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:E.WebMercator}),minus180Line:new u({paths:[[[-2.0037508342788905E7,-2.0037508342788905E7],[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:E.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new u({paths:[[[180,-180],[180,180]]],spatialReference:E.WGS84}),minus180Line:new u({paths:[[[-180,
-180],[-180,180]]],spatialReference:E.WGS84})}};r.cutParams=u;r.getGeometryParts=v;r.offsetMagnitude=function(z,x){return Math.ceil((z-x)/(2*x))};r.updatePolyGeometry=function(z,x){const f=v(z);for(const k of f)for(const g of k)g[0]+=x;return z};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/geometry/cut":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../geometry ../../request ../../core/urlUtils ../../geometry/support/jsonUtils".split(" "),
function(r,u,E,C,v,z){function x(){x=u._asyncToGenerator(function*(f,k,g,m){f="string"===typeof f?v.urlToObject(f):f;const p=k[0].spatialReference;k={...m,query:{...f.query,f:"json",sr:JSON.stringify(p),target:JSON.stringify({geometryType:z.getJsonType(k[0]),geometries:k}),cutter:JSON.stringify(g)}};k=yield C(f.path+"/cut",k);const {cutIndexes:t,geometries:e=[]}=k.data;return{cutIndexes:t,geometries:e.map(c=>{c=z.fromJSON(c);c.spatialReference=p;return c})}});return x.apply(this,arguments)}r.cut=
function(f,k,g,m){return x.apply(this,arguments)};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/geometry/simplify":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../request","../../core/urlUtils","../../geometry/support/jsonUtils"],function(r,u,E,C,v){function z(){z=u._asyncToGenerator(function*(k,g,m){const p="string"===typeof k?C.urlToObject(k):k;k=g[0].spatialReference;const t=v.getJsonType(g[0]);g={...m,query:{...p.query,
f:"json",sr:k.wkid?k.wkid:JSON.stringify(k),geometries:JSON.stringify(x(g))}};g=yield E(p.path+"/simplify",g);return f(g.data,t,k)});return z.apply(this,arguments)}function x(k){return{geometryType:v.getJsonType(k[0]),geometries:k.map(g=>g.toJSON())}}function f(k,g,m){const p=v.getGeometryType(g);return k.map(t=>{t=p.fromJSON(t);t.spatialReference=m;return t})}r.simplify=function(k,g,m){return z.apply(this,arguments)};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/layers/graphics/data/attributeSupport":function(){define(["exports","../../../core/Error","../../../core/sql/WhereClauseCache"],function(r,u,E){function C(k,g){return k?x.get(k,g):null}function v(k,g,m,p=!0){const t=[];for(const e of g)if("*"!==e&&!k.has(e))if(p){g=z(e);try{const c=C(g,k);if(!c)throw new u("feature-store:unsupported-query","invalid SQL expression",{where:g});if(!c.isStandardized)throw new u("feature-store:unsupported-query","expression is not standard",{clause:c});v(k,c.fieldNames,
"expression contains missing fields")}catch(c){if((g=c&&c.details)&&(g.clause||g.where))throw c;g&&g.missingFields?t.push(...g.missingFields):t.push(e)}}else t.push(e);if(t.length)throw new u("feature-store:unsupported-query",m,{missingFields:t});}function z(k){return k.split(" as ")[0]}const x=new E.WhereClauseCache(50,500),f=new Set("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));r.getAliasFromFieldName=
function(k){return k.split(" as ")[1]};r.getExpressionFromFieldName=z;r.getWhereClause=C;r.hasInvalidFieldType=function(k,g){return(k=g.get(k))?!f.has(k.type):!1};r.validateFields=v;r.validateHaving=function(k,g,m){if(!g)return!0;const p=x.get(g,k);if(!p)throw new u("feature-store:unsupported-query","invalid SQL expression",{having:g});if(!p.isAggregate)throw new u("feature-store:unsupported-query","having does not contain a valid aggregate function",{having:g});v(k,p.fieldNames,"having contains missing fields");
if(!p.getExpressions().every(t=>{const {aggregateType:e,field:c}=t,a=k.has(c)&&k.get(c).name;return m.some(b=>{const {onStatisticField:h,statisticType:l}=b;return(k.has(h)&&k.get(h).name)===a&&l.toLowerCase().trim()===e})}))throw new u("feature-store:unsupported-query","expressions in having should also exist in outStatistics",{having:g});return!0};r.validateWhere=function(k,g){if(!g)return!0;const m=x.get(g,k);if(!m)throw new u("feature-store:unsupported-query","invalid SQL expression",{where:g});
if(!m.isStandardized)throw new u("feature-store:unsupported-query","where clause is not standard",{where:g});v(k,m.fieldNames,"where clause contains missing fields");return!0};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/sql/WhereClauseCache":function(){define(["exports","../ItemCache","./WhereClause"],function(r,u,E){let C=function(){function v(z,x){this._cache=new u(z);this._invalidCache=new u(x)}v.prototype.get=function(z,x){const f=`${x.uid}:${z}`,
k=this._cache.get(f);if(k)return k;if(void 0!==this._invalidCache.get(f))return null;try{const g=E.WhereClause.create(z,x);this._cache.put(f,g);return g}catch{return this._invalidCache.put(f,null),null}};return v}();r.WhereClauseCache=C;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/ItemCache":function(){define(["./MemCache"],function(r){return function(){function u(C,v){this._storage=new r.MemCacheStorage;this._storage.maxSize=C;v&&this._storage.registerRemoveFunc("",
v)}var E=u.prototype;E.put=function(C,v){this._storage.put(C,v,1,1)};E.pop=function(C){return this._storage.pop(C)};E.get=function(C){return this._storage.get(C)};E.clear=function(){this._storage.clearAll()};E.destroy=function(){this._storage.destroy()};return u}()})},"esri/core/sql/WhereClause":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../has ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),function(r,u,E,C,v,z){function x(J,I){J+="";return J.length>=
I?J:Array(I-J.length+1).join("0")+J}function f(J,I,H="0",M="0",N="0",P="0",ba="",X="0",S="0"){return"+"===ba||"-"===ba?(J=`${x(parseInt(J,10),4)}-${x(parseInt(I,10),2)}-${x(parseInt(H,10),2)}`,I="",10>parseFloat(P)&&(I="0"),M=`${x(parseInt(M,10),2)}:${x(parseInt(N,10),2)}:${I+parseFloat(P).toString()}`,ba=`${ba}${x(parseInt(X,10),2)}:${x(parseInt(S,10),2)}`,new Date(J+"T"+M+ba)):new Date(parseInt(J,10),parseInt(I,10)-1,parseInt(H,10),parseInt(M,10),parseInt(N,10),parseFloat(P))}function k(J){let I=
n.exec(J);if(null!==I){const [,H,M,N,P,ba,X]=I;return f(H,M,N,P,ba,X)}I=B.exec(J);if(null!==I){const [,H,M,N,P,ba,X,S,W,R]=I;return f(H,M,N,P,ba,X,S,W,R)}I=A.exec(J);if(null!==I){const [,H,M,N,P,ba,X,S,W]=I;return f(H,M,N,P,ba,"0",X,S,W)}I=w.exec(J);if(null!==I){const [,H,M,N,P,ba]=I;return f(H,M,N,P,ba)}I=q.exec(J);if(null!==I){const [,H,M,N]=I;return f(H,M,N)}throw Error("SQL Invalid Timestamp");}function g(J){J=q.exec(J);if(null===J)throw Error("SQL Invalid Date");const [,I,H,M]=J;return new Date(parseInt(I,
10),parseInt(H,10)-1,parseInt(M,10))}function m(J){return Array.isArray(J)?J:[J]}function p(J){return null!==J?!0!==J:null}function t(J,I){return null!=J&&null!=I?!0===J&&!0===I:!1===J||!1===I?!1:null}function e(J,I){return null!=J&&null!=I?!0===J||!0===I:!0===J||!0===I?!0:null}function c(J,I){if(null==J)return null;let H=!1;for(const M of I)if(null==M)H=null;else if(J===M){H=!0;break}return H}function a(J,I,H){if(null==J)return null;{let M="",N=G.Normal;for(let P=0;P<I.length;P++){const ba=I.charAt(P);
switch(N){case G.Normal:ba===H?N=G.Escaped:M="-[]/{}()*+?.\\^$|".includes(ba)?M+("\\"+ba):"%"===ba?M+".*":"_"===ba?M+".":M+ba;break;case G.Escaped:M="-[]/{}()*+?.\\^$|".includes(ba)?M+("\\"+ba):M+ba,N=G.Normal}}I=new RegExp("^"+M+"$","m")}return I.test(J)}function b(J){return J instanceof Date?J.valueOf():J}function h(J,I,H){if(null==I||null==H)return null;I=b(I);H=b(H);switch(J){case "\x3c\x3e":return I!==H;case "\x3d":return I===H;case "\x3e":return I>H;case "\x3c":return I<H;case "\x3e\x3d":return I>=
H;case "\x3c\x3d":return I<=H}}function l(J,I,H){if(I instanceof v.SqlInterval)if(H instanceof Date)switch(J){case "+":return new Date(I.valueInMilliseconds()+H.getTime());case "-":return I.valueInMilliseconds()-H.getTime();case "*":return I.valueInMilliseconds()*H.getTime();case "/":return I.valueInMilliseconds()/H.getTime()}else if(H instanceof v.SqlInterval)switch(J){case "+":return v.SqlInterval.createFromMilliseconds(I.valueInMilliseconds()+H.valueInMilliseconds());case "-":return v.SqlInterval.createFromMilliseconds(I.valueInMilliseconds()-
H.valueInMilliseconds());case "*":return I.valueInMilliseconds()*H.valueInMilliseconds();case "/":return I.valueInMilliseconds()/H.valueInMilliseconds()}else I=I.valueInMilliseconds();else if(H instanceof v.SqlInterval)if(I instanceof Date)switch(J){case "+":return new Date(H.valueInMilliseconds()+I.getTime());case "-":return new Date(I.getTime()-H.valueInMilliseconds());case "*":return I.getTime()*H.valueInMilliseconds();case "/":return I.getTime()/H.valueInMilliseconds()}else H=H.valueInMilliseconds();
else if(I instanceof Date&&"number"===typeof H)switch(H*=864E5,I=I.getTime(),J){case "+":return new Date(I+H);case "-":return new Date(I-H);case "*":return new Date(I*H);case "/":return new Date(I/H)}else if(H instanceof Date&&"number"===typeof I)switch(I*=864E5,H=H.getTime(),J){case "+":return new Date(I+H);case "-":return new Date(I-H);case "*":return new Date(I*H);case "/":return new Date(I/H)}switch(J){case "+":return I+H;case "-":return I-H;case "*":return I*H;case "/":return I/H}}function d(J,
I,H,M){J=M.getAttribute(J,I);return null!=J&&1===H[I]?new Date(J):J}const q=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,n=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,B=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,A=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,w=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,y=new Set(["current_timestamp","current_date","current_time"]);let D=function(){function J(){}
J.makeBool=function(I){return!0===I};J.featureValue=function(I,H,M,N){return d(I,H,M,N)};J.equalsNull=function(I){return null===I};J.applyLike=function(I,H,M){return a(I,H,M)};J.ensureArray=function(I){return m(I)};J.applyIn=function(I,H){return c(I,H)};J.currentDate=function(){const I=new Date;I.setHours(0,0,0,0);return I};J.makeSqlInterval=function(I,H,M){return v.SqlInterval.createFromValueAndQualifer(I,H,M)};J.convertInterval=function(I){return I instanceof v.SqlInterval?I.valueInMilliseconds():
I};J.currentTimestamp=function(){return new Date};J.compare=function(I,H,M){return h(I,H,M)};J.calculate=function(I,H,M){return l(I,H,M)};J.makeComparable=function(I){return b(I)};J.evaluateFunction=function(I,H){return v.evaluateFunction(I,H)};J.lookup=function(I,H){I=H[I];return void 0===I?null:I};J.between=function(I,H){return null==I||null==H[0]||null==H[1]?null:I>=H[0]&&I<=H[1]};J.notbetween=function(I,H){return null==I||null==H[0]||null==H[1]?null:I<H[0]||I>H[1]};J.ternaryNot=function(I){return p(I)};
J.ternaryAnd=function(I,H){return t(I,H)};J.ternaryOr=function(I,H){return e(I,H)};return J}(),F=function(){function J(H,M){this.fieldsIndex=M;this.datefields={};this.parameters={};this._hasDateFunctions=void 0;this.parseTree=z.WhereGrammar.parse(H);const {isStandardized:N,isAggregate:P,referencedFieldNames:ba}=this._extractExpressionInfo(M);this.referencedFieldNames=ba;this.isStandardized=N;this.isAggregate=P}J.create=function(H,M){return new J(H,M)};var I=J.prototype;I.testSet=function(H,M=K){const N=
{};for(const P of this.fieldNames)N[P]=H.map(ba=>M.getAttribute(ba,P));return!!this._evaluateNode(this.parseTree,{attributes:N},K)};I.calculateValue=function(H,M=K){H=this._evaluateNode(this.parseTree,H,M);return H instanceof v.SqlInterval?H.valueInMilliseconds()/864E5:H};I.calculateValueCompiled=function(H,M=K){if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(H,this.parameters,M,this.datefields);if(E("esri-csp-restrictions"))return this.calculateValue(H,M);this._compileMe();
return this.parseTree._compiledVersion(H,this.parameters,M,this.datefields)};I.testFeature=function(H,M=K){return!!this._evaluateNode(this.parseTree,H,M)};I.testFeatureCompiled=function(H,M=K){if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(H,this.parameters,M,this.datefields);if(E("esri-csp-restrictions"))return this.testFeature(H,M);this._compileMe();return!!this.parseTree._compiledVersion(H,this.parameters,M,this.datefields)};I.getFunctions=function(){const H=new Set;
this._visitAll(this.parseTree,M=>{"function"===M.type&&H.add(M.name.toLowerCase())});return Array.from(H)};I.getExpressions=function(){const H=new Map;this._visitAll(this.parseTree,M=>{if("function"===M.type){const N=M.name.toLowerCase();M=M.args.value[0];if("column-reference"===M.type){M=M.column;const P=`${N}-${M}`;H.has(P)||H.set(P,{aggregateType:N,field:M})}}});return[...H.values()]};I.getVariables=function(){const H=new Set;this._visitAll(this.parseTree,M=>{"parameter"===M.type&&H.add(M.value.toLowerCase())});
return Array.from(H)};I._compileMe=function(){const H="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",H)).bind(D)};I._extractExpressionInfo=function(H){const M=[],N=new Set;let P=!0,ba=!0;this._visitAll(this.parseTree,X=>{switch(X.type){case "column-reference":{const S=H.get(X.column);let W,R;S?W=R=S.name:(R=X.column,W=R.toLowerCase());!S||"date"!==S.type&&"esriFieldTypeDate"!==
S.type||(this.datefields[S.name]=1);N.has(W)||(N.add(W),M.push(R));X.column=R;break}case "function":{const {name:S,args:W}=X;X=W.value.length;P&&(P=v.isStandardized(S,X));ba&&(ba=C.isAggregate(S,X))}}});return{referencedFieldNames:Array.from(M),isStandardized:P,isAggregate:ba}};I._visitAll=function(H,M){if(null!=H)switch(M(H),H.type){case "when-clause":this._visitAll(H.operand,M);this._visitAll(H.value,M);break;case "case-expression":for(const N of H.clauses)this._visitAll(N,M);"simple"===H.format&&
this._visitAll(H.operand,M);null!==H.else&&this._visitAll(H.else,M);break;case "expression-list":for(const N of H.value)this._visitAll(N,M);break;case "unary-expression":this._visitAll(H.expr,M);break;case "binary-expression":this._visitAll(H.left,M);this._visitAll(H.right,M);break;case "function":this._visitAll(H.args,M)}};I.evaluateNodeToJavaScript=function(H){switch(H.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(H.value)+", "+JSON.stringify(H.qualifier)+","+
JSON.stringify(H.op)+")";case "case-expression":var M="";if("simple"===H.format){var N="this.makeComparable("+this.evaluateNodeToJavaScript(H.operand)+")";M="( ";for(let P=0;P<H.clauses.length;P++)M+=" ("+N+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(H.clauses[P].operand)+")) ? ("+this.evaluateNodeToJavaScript(H.clauses[P].value)+") : "}else for(M="( ",N=0;N<H.clauses.length;N++)M+=" this.makeBool("+this.evaluateNodeToJavaScript(H.clauses[N].operand)+")\x3d\x3d\x3dtrue ? ("+
this.evaluateNodeToJavaScript(H.clauses[N].value)+") : ";M=null!==H.else?M+this.evaluateNodeToJavaScript(H.else):M+"null";return M+=" )";case "parameter":return"this.lookup("+JSON.stringify(H.value.toLowerCase())+",lookups)";case "expression-list":M="[";for(N of H.value)"["!==M&&(M+=","),M+=this.evaluateNodeToJavaScript(N);return M+="]";case "unary-expression":return"this.ternaryNot("+this.evaluateNodeToJavaScript(H.expr)+")";case "binary-expression":switch(H.operator){case "AND":return"this.ternaryAnd("+
this.evaluateNodeToJavaScript(H.left)+","+this.evaluateNodeToJavaScript(H.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(H.left)+","+this.evaluateNodeToJavaScript(H.right)+" )";case "IS":if("null"!==H.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(H.left)+")";case "ISNOT":if("null"!==H.right.type)throw Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(H.left)+")))";case "IN":return"this.applyIn("+
this.evaluateNodeToJavaScript(H.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(H.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(H.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(H.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(H.left)+","+this.evaluateNodeToJavaScript(H.right)+")";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(H.left)+","+this.evaluateNodeToJavaScript(H.right)+
")";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(H.left)+","+this.evaluateNodeToJavaScript(H.right)+","+JSON.stringify(H.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(H.left)+","+this.evaluateNodeToJavaScript(H.right)+","+JSON.stringify(H.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(H.operator)+","+this.evaluateNodeToJavaScript(H.left)+","+
this.evaluateNodeToJavaScript(H.right)+")";case "*":case "-":case "+":case "/":return"this.calculate("+JSON.stringify(H.operator)+","+this.evaluateNodeToJavaScript(H.left)+","+this.evaluateNodeToJavaScript(H.right)+")"}throw Error("Not Supported Operator "+H.operator);case "null":case "boolean":case "string":case "number":return JSON.stringify(H.value);case "date":return"(new Date("+g(H.value).getTime().toString()+"))";case "timestamp":return"(new Date("+k(H.value).getTime().toString()+"))";case "current-time":return"date"===
H.mode?"this.currentDate()":"this.currentTimestamp()";case "column-reference":return"this.featureValue(feature,"+JSON.stringify(H.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(H.name)+","+this.evaluateNodeToJavaScript(H.args)+")"}throw Error("Unsupported sql syntax "+H.type);};I._evaluateNode=function(H,M,N){switch(H.type){case "interval":return M=this._evaluateNode(H.value,M,N),v.SqlInterval.createFromValueAndQualifer(M,H.qualifier,H.op);case "case-expression":if("simple"===
H.format){var P=b(this._evaluateNode(H.operand,M,N));for(var ba=0;ba<H.clauses.length;ba++)if(P===b(this._evaluateNode(H.clauses[ba].operand,M,N)))return this._evaluateNode(H.clauses[ba].value,M,N)}else for(P=0;P<H.clauses.length;P++)if(!0===this._evaluateNode(H.clauses[P].operand,M,N))return this._evaluateNode(H.clauses[P].value,M,N);return null!==H.else?this._evaluateNode(H.else,M,N):null;case "parameter":return this.parameters[H.value.toLowerCase()];case "expression-list":P=[];for(ba of H.value)P.push(this._evaluateNode(ba,
M,N));return P;case "unary-expression":return p(this._evaluateNode(H.expr,M,N));case "binary-expression":switch(H.operator){case "AND":return t(this._evaluateNode(H.left,M,N),this._evaluateNode(H.right,M,N));case "OR":return e(this._evaluateNode(H.left,M,N),this._evaluateNode(H.right,M,N));case "IS":if("null"!==H.right.type)throw Error("Unsupported RHS for IS");return null===this._evaluateNode(H.left,M,N);case "ISNOT":if("null"!==H.right.type)throw Error("Unsupported RHS for IS");return null!==this._evaluateNode(H.left,
M,N);case "IN":return P=m(this._evaluateNode(H.right,M,N)),c(this._evaluateNode(H.left,M,N),P);case "NOT IN":return P=m(this._evaluateNode(H.right,M,N)),p(c(this._evaluateNode(H.left,M,N),P));case "BETWEEN":return P=this._evaluateNode(H.left,M,N),H=this._evaluateNode(H.right,M,N),null==P||null==H[0]||null==H[1]?null:P>=b(H[0])&&P<=b(H[1]);case "NOTBETWEEN":return P=this._evaluateNode(H.left,M,N),H=this._evaluateNode(H.right,M,N),null==P||null==H[0]||null==H[1]?null:P<b(H[0])||P>b(H[1]);case "LIKE":return a(this._evaluateNode(H.left,
M,N),this._evaluateNode(H.right,M,N),H.escape);case "NOT LIKE":return p(a(this._evaluateNode(H.left,M,N),this._evaluateNode(H.right,M,N),H.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return h(H.operator,this._evaluateNode(H.left,M,N),this._evaluateNode(H.right,M,N));case "-":case "+":case "*":case "/":return l(H.operator,this._evaluateNode(H.left,M,N),this._evaluateNode(H.right,M,N))}case "null":case "boolean":case "string":case "number":return H.value;
case "date":return g(H.value);case "timestamp":return k(H.value);case "current-time":return M=new Date,"date"===H.mode&&M.setHours(0,0,0,0),M;case "column-reference":return d(M,H.column,this.datefields,N);case "function":return M=this._evaluateNode(H.args,M,N),this.isAggregate?C.aggregateFunction(H.name,M):v.evaluateFunction(H.name,M)}throw Error("Unsupported sql syntax "+H.type);};u._createClass(J,[{key:"fieldNames",get:function(){return this.referencedFieldNames}},{key:"hasDateFunctions",get:function(){if(null!=
this._hasDateFunctions)return this._hasDateFunctions;this._hasDateFunctions=!1;this._visitAll(this.parseTree,H=>{"current-time"===H.type?this._hasDateFunctions=!0:"function"===H.type&&(this._hasDateFunctions=this._hasDateFunctions||y.has(H.name.toLowerCase()))});return this._hasDateFunctions}}]);return J}();var G;(function(J){J[J.Normal=0]="Normal";J[J.Escaped=1]="Escaped"})(G||(G={}));const K={getAttribute(J,I){return(J&&"object"===typeof J.attributes?J.attributes:J)[I]}};r.WhereClause=F;r.defaultAttributeAdapter=
K;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/sql/AggregateFunctions":function(){define(["exports"],function(r){function u(v){let z=0;for(let x=0;x<v.length;x++)z+=v[x];return z/v.length}function E(v){const z=u(v),x=v.length;let f=0;for(const k of v)f+=(k-z)**2;return 1<x?f/(x-1):0}const C={min:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.min.apply(Math,v[0])},max:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.max.apply(Math,
v[0])},avg:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:u(v[0])},sum:{minParams:1,maxParams:1,evaluate:v=>{if(null==v[0])v=null;else{{v=v[0];let z=0;for(let x=0;x<v.length;x++)z+=v[x];v=z}}return v}},stddev:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.sqrt(E(v[0]))},count:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:v[0].length},var:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:E(v[0])}};r.aggregateFunction=function(v,z){const x=C[v.toLowerCase()];if(null==x)throw Error("Function Not Recognised");
if(z.length<x.minParams||z.length>x.maxParams)throw Error(`Invalid Parameter count for call to ${v.toUpperCase()}`);return x.evaluate(z)};r.isAggregate=function(v,z){v=C[v.toLowerCase()];return null!=v&&z>=v.minParams&&z<=v.maxParams};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/sql/StandardizedFunctions":function(){define(["exports","../string"],function(r,u){let E=function(){function v(){this.op="+";this.minute=this.year=this.month=this.hour=
this.second=this.day=0}v._fixDefaults=function(z){if(null!==z.precision||null!==z.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");};v.createFromMilliseconds=function(z){const x=new v;x.second=z/1E3;return x};v.createFromValueAndQualifer=function(z,x,f){let k=null;const g=new v;g.op="-"===f?"-":"+";if("interval-period"===x.type){v._fixDefaults(x);if("year"===x.period||"month"===x.period)throw Error("Year-Month Intervals not supported");if(/^[0-9]{1,}$/.test(z))g[x.period]=
parseFloat(z);else throw Error("Illegal Interval");}else{v._fixDefaults(x.start);v._fixDefaults(x.end);if("year"===x.start.period||"month"===x.start.period)throw Error("Year-Month Intervals not supported");if("year"===x.end.period||"month"===x.end.period)throw Error("Year-Month Intervals not supported");switch(x.start.period){case "day":switch(x.end.period){case "hour":k=/^[0-9]{1,} [0-9]{1,}$/;if(k.test(z))g[x.start.period]=parseFloat(z.split(" ")[0]),g[x.end.period]=parseFloat(z.split(" ")[1]);
else throw Error("Illegal Interval");break;case "minute":k=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$/;if(k.test(z))g[x.start.period]=parseFloat(z.split(" ")[0]),z=z.split(" ")[1].split(":"),g.hour=parseFloat(z[0]),g.minute=parseFloat(z[1]);else throw Error("Illegal Interval");break;case "second":k=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(k.test(z))g[x.start.period]=parseFloat(z.split(" ")[0]),z=z.split(" ")[1].split(":"),g.hour=parseFloat(z[0]),g.minute=parseFloat(z[1]),g.second=
parseFloat(z[2]);else throw Error("Illegal Interval");break;default:throw Error("Invalid Interval.");}break;case "hour":switch(x.end.period){case "minute":k=/^[0-9]{1,}:[0-9]{1,}$/;if(k.test(z))g.hour=parseFloat(z.split(":")[0]),g.minute=parseFloat(z.split(":")[1]);else throw Error("Illegal Interval");break;case "second":k=/^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(k.test(z))z=z.split(":"),g.hour=parseFloat(z[0]),g.minute=parseFloat(z[1]),g.second=parseFloat(z[2]);else throw Error("Illegal Interval");
break;default:throw Error("Invalid Interval.");}break;case "minute":switch(x.end.period){case "second":k=/^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(k.test(z))z=z.split(":"),g.minute=parseFloat(z[0]),g.second=parseFloat(z[1]);else throw Error("Illegal Interval");break;default:throw Error("Invalid Interval.");}break;default:throw Error("Invalid Interval.");}}return g};v.prototype.valueInMilliseconds=function(){return("-"===this.op?-1:1)*(1E3*this.second+6E4*this.minute+36E5*this.hour+864E5*this.day+
365/12*this.month*864E5+31536E6*this.year)};return v}();const C={extract:{minParams:2,maxParams:2,evaluate:([v,z])=>{if(null==z)return null;if(z instanceof Date)switch(v.toUpperCase()){case "SECOND":return z.getSeconds();case "MINUTE":return z.getMinutes();case "HOUR":return z.getHours();case "DAY":return z.getDate();case "MONTH":return z.getMonth()+1;case "YEAR":return z.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,maxParams:3,evaluate:v=>{if(2===v.length){const [z,
x]=v;return null==z||null==x?null:z.toString().substring(x-1)}if(3===v.length){const [z,x,f]=v;return null==z||null==x||null==f?null:0>=f?"":z.toString().substring(x-1,x+f-1)}}},position:{minParams:2,maxParams:2,evaluate:([v,z])=>null==v||null==z?null:z.indexOf(v)+1},trim:{minParams:2,maxParams:3,evaluate:v=>{var z=3===v.length,x=z?v[1]:" ";z=z?v[2]:v[1];if(null==x||null==z)return null;x=`(${u.escapeRegExpString(x)})`;switch(v[0]){case "BOTH":return z.replace(new RegExp(`^${x}*|${x}*$`,"g"),"");case "LEADING":return z.replace(new RegExp(`^${x}*`,
"g"),"");case "TRAILING":return z.replace(new RegExp(`${x}*$`,"g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.abs(v[0])},ceiling:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.ceil(v[0])},floor:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.floor(v[0])},log:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.log(v[0])},log10:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.log(v[0])*Math.LOG10E},
sin:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.sin(v[0])},cos:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.cos(v[0])},tan:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.tan(v[0])},asin:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.asin(v[0])},acos:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.acos(v[0])},atan:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.atan(v[0])},sign:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:
0<v[0]?1:0>v[1]?-1:0},power:{minParams:2,maxParams:2,evaluate:v=>null==v[0]||null==v[1]?null:v[0]**v[1]},mod:{minParams:2,maxParams:2,evaluate:v=>null==v[0]||null==v[1]?null:v[0]%v[1]},round:{minParams:1,maxParams:2,evaluate:v=>{const z=v[0];v=2===v.length?10**v[1]:1;return null==z?null:Math.round(z*v)/v}},truncate:{minParams:1,maxParams:2,evaluate:v=>null==v[0]?null:1===v.length?parseInt(v[0].toFixed(0),10):parseFloat(v[0].toFixed(v[1]))},char_length:{minParams:1,maxParams:1,evaluate:v=>"string"===
typeof v[0]||v[0]instanceof String?v[0].length:0},concat:{minParams:1,maxParams:Infinity,evaluate:v=>{let z="";for(let x=0;x<v.length;x++){if(null==v[x])return null;z+=v[x].toString()}return z}},lower:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:v[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:v[0].toString().toUpperCase()}};r.SqlInterval=E;r.evaluateFunction=function(v,z){const x=C[v.toLowerCase()];if(null==x)throw Error("Function Not Recognised");
if(z.length<x.minParams||z.length>x.maxParams)throw Error(`Invalid Parameter count for call to ${v.toUpperCase()}`);return x.evaluate(z)};r.isStandardized=function(v,z){v=C[v.toLowerCase()];return null!=v&&z>=v.minParams&&z<=v.maxParams};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/sql/WhereGrammar":function(){define(["exports","../../chunks/_commonjsHelpers"],function(r,u){var E={exports:{}};(function(v){(function(z,x){v.exports&&(v.exports=
x())})(u.commonjsGlobal,function(){function z(f,k,g,m){f=Error.call(this,f);Object.setPrototypeOf&&Object.setPrototypeOf(f,z.prototype);f.expected=k;f.found=g;f.location=m;f.name="SyntaxError";return f}function x(f,k,g){g=g||" ";if(f.length>k)return f;k-=f.length;g+=g.repeat(k);return f+g.slice(0,k)}(function(f,k){function g(){this.constructor=f}g.prototype=k.prototype;f.prototype=new g})(z,Error);z.prototype.format=function(f){var k="Error: "+this.message;if(this.location){var g=null,m;for(m=0;m<
f.length;m++)if(f[m].source===this.location.source){g=f[m].text.split(/\r\n|\n|\r/g);break}f=this.location.start;m=this.location.source+":"+f.line+":"+f.column;if(g){var p=this.location.end,t=x("",f.line.toString().length);g=g[f.line-1];p=f.line===p.line?p.column:g.length+1;k+="\n --\x3e "+m+"\n"+t+" |\n"+f.line+" | "+g+"\n"+t+" | "+x("",f.column-1)+x("",p-f.column,"^")}else k+="\n at "+m}return k};z.buildMessage=function(f,k){function g(c){return c.charCodeAt(0).toString(16).toUpperCase()}function m(c){return c.replace(/\\/g,
"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+g(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+g(a)})}function p(c){return c.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+g(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,
function(a){return"\\x"+g(a)})}function t(c){return e[c.type](c)}var e={literal:function(c){return'"'+m(c.text)+'"'},class:function(c){var a=c.parts.map(function(b){return Array.isArray(b)?p(b[0])+"-"+p(b[1]):p(b)});return"["+(c.inverted?"^":"")+a+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(c){return c.description}};return"Expected "+function(c){c=c.map(t);var a,b;c.sort();if(0<c.length){for(b=a=1;a<c.length;a++)c[a-1]!==c[a]&&(c[b]=c[a],b++);c.length=
b}switch(c.length){case 1:return c[0];case 2:return c[0]+" or "+c[1];default:return c.slice(0,-1).join(", ")+", or "+c[c.length-1]}}(f)+" but "+(k?'"'+m(k)+'"':"end of input")+" found."};return{SyntaxError:z,parse:function(f,k){function g(aa,fa){return{type:"literal",text:aa,ignoreCase:fa}}function m(aa,fa,na){return{type:"class",parts:aa,inverted:fa,ignoreCase:na}}function p(aa){var fa=fc[aa],na;if(!fa){for(na=aa-1;!fc[na];)na--;fa=fc[na];for(fa={line:fa.line,column:fa.column};na<aa;)10===f.charCodeAt(na)?
(fa.line++,fa.column=1):fa.column++,na++;fc[aa]=fa}return fa}function t(aa,fa){var na=p(aa),Aa=p(fa);return{source:Va,start:{offset:aa,line:na.line,column:na.column},end:{offset:fa,line:Aa.line,column:Aa.column}}}function e(aa){V<wb||(V>wb&&(wb=V,yc=[]),yc.push(aa))}function c(){var aa=V;xa();var fa=b();fa!==O?(xa(),aa=fa):(V=aa,aa=O);return aa}function a(){var aa=V;var fa=b();if(fa!==O){aa=[];var na=V;var Aa=xa();var La=Ea();if(La!==O){var Sa=xa();var Ta=b();Ta!==O?na=Aa=[Aa,La,Sa,Ta]:(V=na,na=O)}else V=
na,na=O;for(;na!==O;)aa.push(na),na=V,Aa=xa(),La=Ea(),La!==O?(Sa=xa(),Ta=b(),Ta!==O?na=Aa=[Aa,La,Sa,Ta]:(V=na,na=O)):(V=na,na=O);na={type:"expression-list"};fa=[fa];for(Aa=0;Aa<aa.length;Aa++)fa.push(aa[Aa][3]);na.value=fa;aa=na}else V=aa,aa=O;return aa}function b(){var aa=V;var fa=h();if(fa!==O){aa=[];var na=V;var Aa=xa();var La=da();if(La!==O){var Sa=xa();var Ta=h();Ta!==O?na=Aa=[Aa,La,Sa,Ta]:(V=na,na=O)}else V=na,na=O;for(;na!==O;)aa.push(na),na=V,Aa=xa(),La=da(),La!==O?(Sa=xa(),Ta=h(),Ta!==O?
na=Aa=[Aa,La,Sa,Ta]:(V=na,na=O)):(V=na,na=O);aa=Ra(fa,aa)}else V=aa,aa=O;return aa}function h(){var aa=V;var fa=l();if(fa!==O){aa=[];var na=V;var Aa=xa();var La=Q();if(La!==O){var Sa=xa();var Ta=l();Ta!==O?na=Aa=[Aa,La,Sa,Ta]:(V=na,na=O)}else V=na,na=O;for(;na!==O;)aa.push(na),na=V,Aa=xa(),La=Q(),La!==O?(Sa=xa(),Ta=l(),Ta!==O?na=Aa=[Aa,La,Sa,Ta]:(V=na,na=O)):(V=na,na=O);aa=Ra(fa,aa)}else V=aa,aa=O;return aa}function l(){var aa=V;var fa=U();if(fa===O){fa=V;if(33===f.charCodeAt(V)){var na=db;V++}else na=
O,0===Ca&&e(rd);if(na!==O){var Aa=V;Ca++;if(61===f.charCodeAt(V)){var La=hb;V++}else La=O,0===Ca&&e(Pc);Ca--;La===O?Aa=void 0:(V=Aa,Aa=O);Aa!==O?fa=na=[na,Aa]:(V=fa,fa=O)}else V=fa,fa=O}fa!==O?(na=xa(),Aa=l(),Aa!==O?aa={type:"unary-expression",operator:"NOT",expr:Aa}:(V=aa,aa=O)):(V=aa,aa=O);if(aa===O){fa=V;aa=B();if(aa!==O){xa();fa=[];na=V;Aa=xa();La=d();if(La!==O){var Sa=xa();var Ta=B();Ta!==O?na=Aa=[Aa,La,Sa,Ta]:(V=na,na=O)}else V=na,na=O;if(na!==O)for(;na!==O;)fa.push(na),na=V,Aa=xa(),La=d(),
La!==O?(Sa=xa(),Ta=B(),Ta!==O?na=Aa=[Aa,La,Sa,Ta]:(V=na,na=O)):(V=na,na=O);else fa=O;fa!==O&&(fa={type:"arithmetic",tail:fa});fa===O&&(fa=V,na=n(),na!==O?(xa(),Aa=Ka(),Aa!==O?(xa(),Aa=a(),Aa!==O?(xa(),La=Ma(),La!==O?fa={op:na,right:Aa}:(V=fa,fa=O)):(V=fa,fa=O)):(V=fa,fa=O)):(V=fa,fa=O),fa===O&&(fa=V,na=n(),na!==O?(xa(),Aa=Ka(),Aa!==O?(xa(),Aa=Ma(),Aa!==O?fa={op:na,right:{type:"expression-list",value:[]}}:(V=fa,fa=O)):(V=fa,fa=O)):(V=fa,fa=O),fa===O&&(fa=V,na=n(),na!==O?(xa(),Aa=I(),Aa!==O?fa={op:na,
right:Aa}:(V=fa,fa=O)):(V=fa,fa=O))),fa===O&&(fa=V,La=U(),La!==O?(xa(),na=ea(),na!==O?(xa(),Aa=B(),Aa!==O?(xa(),Sa=Q(),Sa!==O?(xa(),La=B(),La!==O?fa={op:"NOT"+na,right:{type:"expression-list",value:[Aa,La]}}:(V=fa,fa=O)):(V=fa,fa=O)):(V=fa,fa=O)):(V=fa,fa=O)):(V=fa,fa=O),fa===O&&(fa=V,La=ea(),La!==O?(xa(),na=B(),na!==O?(xa(),Aa=Q(),Aa!==O?(xa(),Sa=B(),Sa!==O?fa={op:La,right:{type:"expression-list",value:[na,Sa]}}:(V=fa,fa=O)):(V=fa,fa=O)):(V=fa,fa=O)):(V=fa,fa=O)),fa===O&&(fa=V,na=T(),na!==O?(xa(),
Aa=U(),Aa!==O?(xa(),Aa=B(),Aa!==O?fa={op:na+"NOT",right:Aa}:(V=fa,fa=O)):(V=fa,fa=O)):(V=fa,fa=O),fa===O&&(fa=V,na=T(),na!==O?(xa(),Aa=B(),Aa!==O?fa={op:na,right:Aa}:(V=fa,fa=O)):(V=fa,fa=O)),fa===O&&(fa=V,na=q(),na!==O?(xa(),Aa=X(),Aa!==O?(xa(),La=V,f.substr(V,6).toLowerCase()===Ia?(Sa=f.substr(V,6),V+=6):(Sa=O,0===Ca&&e(sd)),Sa!==O?(Sa=V,Ca++,Ta=K(),Ca--,Ta===O?Sa=void 0:(V=Sa,Sa=O),Sa!==O?La="ESCAPE":(V=La,La=O)):(V=La,La=O),La!==O?(xa(),La=S(),La!==O?fa={op:na,right:Aa,escape:La.value}:(V=fa,
fa=O)):(V=fa,fa=O)):(V=fa,fa=O)):(V=fa,fa=O),fa===O&&(fa=V,na=q(),na!==O?(xa(),Aa=X(),Aa!==O?fa={op:na,right:Aa,escape:""}:(V=fa,fa=O)):(V=fa,fa=O))))));fa===O&&(fa=null);""==fa||void 0==fa||null==fa?fa=aa:(na=null,fa=na="arithmetic"==fa.type?Ra(aa,fa.tail):Wa(fa.op,aa,fa.right,fa.escape))}else V=fa,fa=O;aa=fa}return aa}function d(){if(f.substr(V,2)===mb){var aa=mb;V+=2}else aa=O,0===Ca&&e(td);aa===O&&(62===f.charCodeAt(V)?(aa=tb,V++):(aa=O,0===Ca&&e(ud)),aa===O&&(f.substr(V,2)===sa?(aa=sa,V+=2):
(aa=O,0===Ca&&e(vd)),aa===O&&(f.substr(V,2)===kb?(aa=kb,V+=2):(aa=O,0===Ca&&e(wd)),aa===O&&(60===f.charCodeAt(V)?(aa=xb,V++):(aa=O,0===Ca&&e(xd)),aa===O&&(61===f.charCodeAt(V)?(aa=hb,V++):(aa=O,0===Ca&&e(Pc)),aa===O&&(f.substr(V,2)===ib?(aa=ib,V+=2):(aa=O,0===Ca&&e(yd))))))));return aa}function q(){var aa=aa=V;var fa=U();if(fa!==O){var na=xa();var Aa=la();Aa!==O?aa=fa=[fa,na,Aa]:(V=aa,aa=O)}else V=aa,aa=O;aa!==O&&(aa=aa[0]+" "+aa[2]);aa===O&&(aa=la());return aa}function n(){var aa=aa=V;var fa=U();
if(fa!==O){var na=xa();var Aa=L();Aa!==O?aa=fa=[fa,na,Aa]:(V=aa,aa=O)}else V=aa,aa=O;aa!==O&&(aa=aa[0]+" "+aa[2]);aa===O&&(aa=L());return aa}function B(){var aa=V;var fa=w();if(fa!==O){aa=[];var na=V;var Aa=xa();var La=A();if(La!==O){var Sa=xa();var Ta=w();Ta!==O?na=Aa=[Aa,La,Sa,Ta]:(V=na,na=O)}else V=na,na=O;for(;na!==O;)aa.push(na),na=V,Aa=xa(),La=A(),La!==O?(Sa=xa(),Ta=w(),Ta!==O?na=Aa=[Aa,La,Sa,Ta]:(V=na,na=O)):(V=na,na=O);aa=Ra(fa,aa)}else V=aa,aa=O;return aa}function A(){if(43===f.charCodeAt(V)){var aa=
jb;V++}else aa=O,0===Ca&&e(zc);aa===O&&(45===f.charCodeAt(V)?(aa=Ib,V++):(aa=O,0===Ca&&e(Ac)));return aa}function w(){var aa=V;var fa=D();if(fa!==O){aa=[];var na=V;var Aa=xa();var La=y();if(La!==O){var Sa=xa();var Ta=D();Ta!==O?na=Aa=[Aa,La,Sa,Ta]:(V=na,na=O)}else V=na,na=O;for(;na!==O;)aa.push(na),na=V,Aa=xa(),La=y(),La!==O?(Sa=xa(),Ta=D(),Ta!==O?na=Aa=[Aa,La,Sa,Ta]:(V=na,na=O)):(V=na,na=O);aa=Ra(fa,aa)}else V=aa,aa=O;return aa}function y(){if(42===f.charCodeAt(V)){var aa=Vb;V++}else aa=O,0===Ca&&
e(zd);aa===O&&(47===f.charCodeAt(V)?(aa=Bc,V++):(aa=O,0===Ca&&e(Ad)));return aa}function D(){var aa=S();if(aa===O){var fa=V;var na=V;var Aa=ka();if(Aa!==O){var La=ta();if(La!==O){var Sa=pa();Sa!==O?na=parseFloat(Aa+La+Sa):(V=na,na=O)}else V=na,na=O}else V=na,na=O;na===O&&(na=V,Aa=ka(),Aa!==O?(La=ta(),La!==O?na=parseFloat(Aa+La):(V=na,na=O)):(V=na,na=O),na===O&&(na=V,Aa=ka(),Aa!==O?(La=pa(),La!==O?na=parseFloat(Aa+La):(V=na,na=O)):(V=na,na=O),na===O&&(na=V,Aa=ka(),Aa!==O&&(Aa=parseFloat(Aa)),na=Aa)));
var Ta=na;if(Ta!==O){var gc=V;Ca++;var Bd=G();Ca--;Bd===O?gc=void 0:(V=gc,gc=O);gc!==O?fa={type:"number",value:Ta}:(V=fa,fa=O)}else V=fa,fa=O;aa=fa;if(aa===O){var Wb=V;var Jb=V;if(f.substr(V,4).toLowerCase()===Kb){var hc=f.substr(V,4);V+=4}else hc=O,0===Ca&&e(Cd);if(hc!==O){var Xb=V;Ca++;var Dd=K();Ca--;Dd===O?Xb=void 0:(V=Xb,Xb=O);Xb!==O?Jb=hc=[hc,Xb]:(V=Jb,Jb=O)}else V=Jb,Jb=O;var Hb=Jb;Hb!==O&&(Hb={type:"boolean",value:!0});Wb=Hb;if(Wb===O){Wb=V;var Lb=V;if(f.substr(V,5).toLowerCase()===ma){var ic=
f.substr(V,5);V+=5}else ic=O,0===Ca&&e(Ed);if(ic!==O){var Yb=V;Ca++;var Fd=K();Ca--;Fd===O?Yb=void 0:(V=Yb,Yb=O);Yb!==O?Lb=ic=[ic,Yb]:(V=Lb,Lb=O)}else V=Lb,Lb=O;Hb=Lb;Hb!==O&&(Hb={type:"boolean",value:!1});Wb=Hb}aa=Wb;if(aa===O){var Mb=V;if(f.substr(V,4).toLowerCase()===Ua){var jc=f.substr(V,4);V+=4}else jc=O,0===Ca&&e(Gd);if(jc!==O){var Zb=V;Ca++;var Hd=K();Ca--;Hd===O?Zb=void 0:(V=Zb,Zb=O);Zb!==O?Mb=jc=[jc,Zb]:(V=Mb,Mb=O)}else V=Mb,Mb=O;var Cc=Mb;Cc!==O&&(Cc={type:"null",value:null});aa=Cc;if(aa===
O){var Nb=V;var Ob=V;if(f.substr(V,4).toLowerCase()===Id){var Qc=f.substr(V,4);V+=4}else Qc=O,0===Ca&&e(Jd);if(Qc!==O){var kc=V;Ca++;var Kd=K();Ca--;Kd===O?kc=void 0:(V=kc,kc=O);kc!==O?Ob="DATE":(V=Ob,Ob=O)}else V=Ob,Ob=O;if(Ob!==O){xa();var Rc=X();Rc!==O?Nb={type:"date",value:Rc.value}:(V=Nb,Nb=O)}else V=Nb,Nb=O;aa=Nb;if(aa===O){var Pb=V;var Qb=V;if(f.substr(V,9).toLowerCase()===Ld){var Sc=f.substr(V,9);V+=9}else Sc=O,0===Ca&&e(Md);if(Sc!==O){var lc=V;Ca++;var Nd=K();Ca--;Nd===O?lc=void 0:(V=lc,
lc=O);lc!==O?Qb="TIMESTAMP":(V=Qb,Qb=O)}else V=Qb,Qb=O;if(Qb!==O){xa();var Tc=X();Tc!==O?Pb={type:"timestamp",value:Tc.value}:(V=Pb,Pb=O)}else V=Pb,Pb=O;aa=Pb;if(aa===O){var eb=V;var Dc=Y();if(Dc!==O){xa();if(45===f.charCodeAt(V)){var Bb=Ib;V++}else Bb=O,0===Ca&&e(Ac);Bb===O&&(43===f.charCodeAt(V)?(Bb=jb,V++):(Bb=O,0===Ca&&e(zc)));if(Bb!==O){xa();var $b=X();if($b!==O){xa();var Uc=M();Uc!==O?eb={type:"interval",value:$b,qualifier:Uc,op:Bb}:(V=eb,eb=O)}else V=eb,eb=O}else V=eb,eb=O}else V=eb,eb=O;eb===
O&&(eb=V,Dc=Y(),Dc!==O?(xa(),Bb=X(),Bb!==O?(xa(),$b=M(),$b!==O?eb={type:"interval",value:Bb,qualifier:$b,op:""}:(V=eb,eb=O)):(V=eb,eb=O)):(V=eb,eb=O));aa=eb}}}}}}var ab=aa;if(ab===O){var ob=V;var Rb=V;if(f.substr(V,7).toLowerCase()===sb){var Vc=f.substr(V,7);V+=7}else Vc=O,0===Ca&&e(Od);if(Vc!==O){var mc=V;Ca++;var Pd=K();Ca--;Pd===O?mc=void 0:(V=mc,mc=O);mc!==O?Rb="EXTRACT":(V=Rb,Rb=O)}else V=Rb,Rb=O;if(Rb!==O){xa();var Qd=Ka();if(Qd!==O){xa();var ub=ca();ub===O&&(ub=ia(),ub===O&&(ub=ra(),ub===O&&
(ub=ua(),ub===O&&(ub=za(),ub===O&&(ub=Da())))));var Wc=ub;if(Wc!==O){xa();var Rd=ja();if(Rd!==O){xa();var Xc=b();if(Xc!==O){xa();var Sd=Ma();Sd!==O?ob={type:"function",name:"extract",args:{type:"expression-list",value:[{type:"string",value:Wc},Xc]}}:(V=ob,ob=O)}else V=ob,ob=O}else V=ob,ob=O}else V=ob,ob=O}else V=ob,ob=O}else V=ob,ob=O;ab=ob;if(ab===O){var pb=V;var Sb=V;if(f.substr(V,9).toLowerCase()===fb){var Yc=f.substr(V,9);V+=9}else Yc=O,0===Ca&&e(Td);if(Yc!==O){var nc=V;Ca++;var Ud=K();Ca--;Ud===
O?nc=void 0:(V=nc,nc=O);nc!==O?Sb="SUBSTRING":(V=Sb,Sb=O)}else V=Sb,Sb=O;if(Sb!==O){xa();var Vd=Ka();if(Vd!==O){xa();var Ec=b();if(Ec!==O){xa();var Wd=ja();if(Wd!==O){xa();var Fc=b();if(Fc!==O){xa();var Cb=V;var Tb=V;if(f.substr(V,3).toLowerCase()===Za){var Zc=f.substr(V,3);V+=3}else Zc=O,0===Ca&&e(Xd);if(Zc!==O){var oc=V;Ca++;var Yd=K();Ca--;Yd===O?oc=void 0:(V=oc,oc=O);oc!==O?Tb="FOR":(V=Tb,Tb=O)}else V=Tb,Tb=O;var ac=Tb;if(ac!==O){var Zd=xa();var $c=b();if($c!==O){var $d=xa();Cb=ac=[ac,Zd,$c,$d]}else V=
Cb,Cb=O}else V=Cb,Cb=O;Cb===O&&(Cb=null);ac=Ma();ac!==O?pb={type:"function",name:"substring",args:{type:"expression-list",value:Cb?[Ec,Fc,Cb[2]]:[Ec,Fc]}}:(V=pb,pb=O)}else V=pb,pb=O}else V=pb,pb=O}else V=pb,pb=O}else V=pb,pb=O}else V=pb,pb=O;ab=pb;if(ab===O){var cb=V;var Gc=ha();if(Gc!==O){xa();var Hc=Ka();if(Hc!==O){xa();var Db=H();Db===O&&(Db=null);xa();var bc=b();if(bc!==O){xa();var Ic=ja();if(Ic!==O){xa();var ad=b();if(ad!==O){xa();var ae=Ma();ae!==O?cb={type:"function",name:"trim",args:{type:"expression-list",
value:[{type:"string",value:null==Db?"BOTH":Db},bc,ad]}}:(V=cb,cb=O)}else V=cb,cb=O}else V=cb,cb=O}else V=cb,cb=O}else V=cb,cb=O}else V=cb,cb=O;cb===O&&(cb=V,Gc=ha(),Gc!==O?(xa(),Hc=Ka(),Hc!==O?(xa(),Db=H(),Db===O&&(Db=null),xa(),bc=b(),bc!==O?(xa(),Ic=Ma(),Ic!==O?cb={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==Db?"BOTH":Db},bc]}}:(V=cb,cb=O)):(V=cb,cb=O)):(V=cb,cb=O)):(V=cb,cb=O));ab=cb;if(ab===O){var qb=V;var Ub=V;if(f.substr(V,8).toLowerCase()===be){var bd=
f.substr(V,8);V+=8}else bd=O,0===Ca&&e(ce);if(bd!==O){var pc=V;Ca++;var de=K();Ca--;de===O?pc=void 0:(V=pc,pc=O);pc!==O?Ub="POSITION":(V=Ub,Ub=O)}else V=Ub,Ub=O;if(Ub!==O){xa();var ee=Ka();if(ee!==O){xa();var cd=b();if(cd!==O){xa();var fe=L();if(fe!==O){xa();var dd=b();if(dd!==O){xa();var ge=Ma();ge!==O?qb={type:"function",name:"position",args:{type:"expression-list",value:[cd,dd]}}:(V=qb,qb=O)}else V=qb,qb=O}else V=qb,qb=O}else V=qb,qb=O}else V=qb,qb=O}else V=qb,qb=O;ab=qb;if(ab===O){var Gb=V;var qc;
var vb=V;vb=qc=F();if(vb===O)if(vb=V,96===f.charCodeAt(V)?(qc=ed,V++):(qc=O,0===Ca&&e(fd)),qc!==O){var rc=[];if(gd.test(f.charAt(V))){var Eb=f.charAt(V);V++}else Eb=O,0===Ca&&e(hd);if(Eb!==O)for(;Eb!==O;)rc.push(Eb),gd.test(f.charAt(V))?(Eb=f.charAt(V),V++):(Eb=O,0===Ca&&e(hd));else rc=O;rc!==O?(96===f.charCodeAt(V)?(Eb=ed,V++):(Eb=O,0===Ca&&e(fd)),Eb!==O?vb=rc.join(""):(V=vb,vb=O)):(V=vb,vb=O)}else V=vb,vb=O;var id=vb;if(id!==O){xa();var he=Ka();if(he!==O){xa();var sc=a();sc===O&&(sc=null);xa();
var ie=Ma();ie!==O?Gb={type:"function",name:id,args:sc?sc:{type:"expression-list",value:[]}}:(V=Gb,Gb=O)}else V=Gb,Gb=O}else V=Gb,Gb=O;ab=Gb;if(ab===O){var yb;var gb=V;var Jc=ya();if(Jc!==O){xa();var cc=b();if(cc!==O){xa();var dc=[];for(yb=R();yb!==O;)dc.push(yb),yb=R();yb=xa();var tc=Ga();tc!==O?gb={type:"case-expression",format:"simple",operand:cc,clauses:dc,else:null}:(V=gb,gb=O)}else V=gb,gb=O}else V=gb,gb=O;if(gb===O)if(gb=V,Jc=ya(),Jc!==O)if(xa(),cc=b(),cc!==O){xa();dc=[];for(yb=R();yb!==O;)dc.push(yb),
yb=R();yb=xa();tc=Z();if(tc!==O){xa();var je=Ga();je!==O?gb={type:"case-expression",format:"simple",operand:cc,clauses:dc,else:tc.value}:(V=gb,gb=O)}else V=gb,gb=O}else V=gb,gb=O;else V=gb,gb=O;var Kc=gb;if(Kc===O){var zb;var nb=V;var Lc=ya();if(Lc!==O){xa();var ec=[];for(zb=W();zb!==O;)ec.push(zb),zb=W();zb=xa();var uc=Ga();uc!==O?nb={type:"case-expression",format:"searched",clauses:ec,else:null}:(V=nb,nb=O)}else V=nb,nb=O;if(nb===O)if(nb=V,Lc=ya(),Lc!==O){xa();ec=[];for(zb=W();zb!==O;)ec.push(zb),
zb=W();zb=xa();uc=Z();if(uc!==O){xa();var ke=Ga();ke!==O?nb={type:"case-expression",format:"searched",clauses:ec,else:uc.value}:(V=nb,nb=O)}else V=nb,nb=O}else V=nb,nb=O;Kc=nb}ab=Kc;if(ab===O){var vc;var wc=V;var jd=G();if(jd!==O){var kd=[];for(vc=J();vc!==O;)kd.push(vc),vc=J();wc=jd+kd.join("")}else V=wc,wc=O;var xc=wc;if(xc!==O){var Mc=xc;xc=/^CURRENT_DATE$/i.test(Mc)?{type:"current-time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(Mc)?{type:"current-time",mode:"timestamp"}:{type:"column-reference",
table:"",column:Mc}}ab=xc;if(ab===O&&(ab=I(),ab===O)){ab=V;var le=Ka();if(le!==O){xa();var Nc=b();if(Nc!==O){xa();var me=Ma();me!==O?(Nc.paren=!0,ab=Nc):(V=ab,ab=O)}else V=ab,ab=O}else V=ab,ab=O}}}}}}}}return ab}function F(){var aa;var fa=V;var na=G();if(na!==O){fa=[];for(aa=K();aa!==O;)fa.push(aa),aa=K();fa=na+fa.join("")}else V=fa,fa=O;return fa}function G(){if(ne.test(f.charAt(V))){var aa=f.charAt(V);V++}else aa=O,0===Ca&&e(oe);return aa}function K(){if(pe.test(f.charAt(V))){var aa=f.charAt(V);
V++}else aa=O,0===Ca&&e(qe);return aa}function J(){if(re.test(f.charAt(V))){var aa=f.charAt(V);V++}else aa=O,0===Ca&&e(se);return aa}function I(){var aa=V;if(64===f.charCodeAt(V)){var fa=rb;V++}else fa=O,0===Ca&&e(te);if(fa!==O){var na=F();na!==O?aa=fa=[fa,na]:(V=aa,aa=O)}else V=aa,aa=O;aa!==O&&(aa={type:"parameter",value:aa[1]});return aa}function H(){var aa=V;if(f.substr(V,7).toLowerCase()===ue){var fa=f.substr(V,7);V+=7}else fa=O,0===Ca&&e(ve);if(fa!==O){fa=V;Ca++;var na=K();Ca--;na===O?fa=void 0:
(V=fa,fa=O);fa!==O?aa="LEADING":(V=aa,aa=O)}else V=aa,aa=O;aa===O&&(aa=V,f.substr(V,8).toLowerCase()===we?(fa=f.substr(V,8),V+=8):(fa=O,0===Ca&&e(xe)),fa!==O?(fa=V,Ca++,na=K(),Ca--,na===O?fa=void 0:(V=fa,fa=O),fa!==O?aa="TRAILING":(V=aa,aa=O)):(V=aa,aa=O),aa===O&&(aa=V,f.substr(V,4).toLowerCase()===ye?(fa=f.substr(V,4),V+=4):(fa=O,0===Ca&&e(ze)),fa!==O?(fa=V,Ca++,na=K(),Ca--,na===O?fa=void 0:(V=fa,fa=O),fa!==O?aa="BOTH":(V=aa,aa=O)):(V=aa,aa=O)));return aa}function M(){var aa=V;var fa=V;var na=N();
if(na!==O){xa();var Aa=Ka();if(Aa!==O)if(xa(),Aa=ba(),Aa!==O){xa();var La=Ma();La!==O?fa={type:"interval-period",period:na.value,precision:Aa,secondary:null}:(V=fa,fa=O)}else V=fa,fa=O;else V=fa,fa=O}else V=fa,fa=O;fa===O&&(fa=V,na=N(),na!==O&&(na=ld(na)),fa=na);if(fa!==O)if(xa(),na=V,f.substr(V,2).toLowerCase()===Ae?(Aa=f.substr(V,2),V+=2):(Aa=O,0===Ca&&e(Be)),Aa!==O?(Aa=V,Ca++,La=K(),Ca--,La===O?Aa=void 0:(V=Aa,Aa=O),Aa!==O?na="TO":(V=na,na=O)):(V=na,na=O),na!==O){xa();na=V;Aa=N();Aa!==O&&(Aa={type:"interval-period",
period:Aa.value,precision:null,secondary:null});na=Aa;if(na===O){na=V;Aa=Da();if(Aa!==O)if(xa(),Aa=Ka(),Aa!==O)if(xa(),Aa=ba(),Aa!==O)if(xa(),La=Ea(),La!==O)if(xa(),La=P(),La!==O){xa();var Sa=Ma();Sa!==O?na=md(Aa,La):(V=na,na=O)}else V=na,na=O;else V=na,na=O;else V=na,na=O;else V=na,na=O;else V=na,na=O;na===O&&(na=V,Aa=Da(),Aa!==O?(xa(),Aa=Ka(),Aa!==O?(xa(),Aa=ba(),Aa!==O?(xa(),La=Ma(),La!==O?na={type:"interval-period",period:"second",precision:Aa,secondary:null}:(V=na,na=O)):(V=na,na=O)):(V=na,na=
O)):(V=na,na=O),na===O&&(na=V,Aa=Da(),Aa!==O&&(Aa={type:"interval-period",period:"second",precision:null,secondary:null}),na=Aa))}na!==O?aa={type:"interval-qualifier",start:fa,end:na}:(V=aa,aa=O)}else V=aa,aa=O;else V=aa,aa=O;aa===O&&(aa=V,na=N(),na!==O?(xa(),fa=Ka(),fa!==O?(xa(),fa=P(),fa!==O?(xa(),Aa=Ma(),Aa!==O?aa={type:"interval-period",period:na.value,precision:fa,secondary:null}:(V=aa,aa=O)):(V=aa,aa=O)):(V=aa,aa=O)):(V=aa,aa=O),aa===O&&(aa=V,na=N(),na!==O&&(na=ld(na)),aa=na,aa===O&&(aa=V,na=
Da(),na!==O?(xa(),fa=Ka(),fa!==O?(xa(),fa=ba(),fa!==O?(xa(),Aa=Ea(),Aa!==O?(xa(),na=P(),na!==O?(xa(),Aa=Ma(),Aa!==O?aa=md(fa,na):(V=aa,aa=O)):(V=aa,aa=O)):(V=aa,aa=O)):(V=aa,aa=O)):(V=aa,aa=O)):(V=aa,aa=O),aa===O&&(aa=V,na=Da(),na!==O?(xa(),fa=Ka(),fa!==O?(xa(),fa=P(),fa!==O?(xa(),Aa=Ma(),Aa!==O?aa={type:"interval-period",period:"second",precision:fa,secondary:null}:(V=aa,aa=O)):(V=aa,aa=O)):(V=aa,aa=O)):(V=aa,aa=O),aa===O&&(aa=V,na=Da(),na!==O&&(na={type:"interval-period",period:"second",precision:null,
secondary:null}),aa=na)))));return aa}function N(){var aa=V;aa=ra();aa!==O&&(aa={type:"string",value:"day"});aa===O&&(aa=V,aa=ua(),aa!==O&&(aa={type:"string",value:"hour"}),aa===O&&(aa=V,aa=za(),aa!==O&&(aa={type:"string",value:"minute"}),aa===O&&(aa=V,aa=ia(),aa!==O&&(aa={type:"string",value:"month"}),aa===O&&(aa=V,aa=ca(),aa!==O&&(aa={type:"string",value:"year"})))));return aa}function P(){var aa=wa();aa!==O&&(aa=parseFloat(aa));return aa}function ba(){var aa=wa();aa!==O&&(aa=parseFloat(aa));return aa}
function X(){var aa=S();aa===O&&(aa=I());return aa}function S(){var aa=V;if(39===f.charCodeAt(V)){var fa=Fb;V++}else fa=O,0===Ca&&e(nd);fa===O&&(f.substr(V,2)===Ya?(fa=Ya,V+=2):(fa=O,0===Ca&&e(Ce)));if(fa!==O){fa=[];var na=V;f.substr(V,2)===lb?(na=lb,V+=2):(na=O,0===Ca&&e(od));na!==O&&(na="'");na===O&&(pd.test(f.charAt(V))?(na=f.charAt(V),V++):(na=O,0===Ca&&e(qd)));for(;na!==O;)fa.push(na),na=V,f.substr(V,2)===lb?(na=lb,V+=2):(na=O,0===Ca&&e(od)),na!==O&&(na="'"),na===O&&(pd.test(f.charAt(V))?(na=
f.charAt(V),V++):(na=O,0===Ca&&e(qd)));39===f.charCodeAt(V)?(na=Fb,V++):(na=O,0===Ca&&e(nd));na!==O?aa={type:"string",value:fa.join("")}:(V=aa,aa=O)}else V=aa,aa=O;return aa}function W(){var aa=V;if(Ha()!==O){xa();var fa=b();if(fa!==O){xa();var na=Fa();na!==O?(xa(),na=b(),na!==O?aa={type:"when-clause",operand:fa,value:na}:(V=aa,aa=O)):(V=aa,aa=O)}else V=aa,aa=O}else V=aa,aa=O;return aa}function R(){var aa=V;if(Ha()!==O){xa();var fa=b();if(fa!==O){xa();var na=Fa();na!==O?(xa(),na=b(),na!==O?aa={type:"when-clause",
operand:fa,value:na}:(V=aa,aa=O)):(V=aa,aa=O)}else V=aa,aa=O}else V=aa,aa=O;return aa}function Z(){var aa=V;var fa=V;if(f.substr(V,4).toLowerCase()===De){var na=f.substr(V,4);V+=4}else na=O,0===Ca&&e(Ee);if(na!==O){na=V;Ca++;var Aa=K();Ca--;Aa===O?na=void 0:(V=na,na=O);na!==O?fa="ELSE":(V=fa,fa=O)}else V=fa,fa=O;fa!==O?(xa(),fa=b(),fa!==O?aa={type:"else-clause",value:fa}:(V=aa,aa=O)):(V=aa,aa=O);return aa}function ka(){var aa=wa();if(aa===O){aa=V;if(45===f.charCodeAt(V)){var fa=Ib;V++}else fa=O,0===
Ca&&e(Ac);fa===O&&(43===f.charCodeAt(V)?(fa=jb,V++):(fa=O,0===Ca&&e(zc)));if(fa!==O){var na=wa();na!==O?aa=fa[0]+na:(V=aa,aa=O)}else V=aa,aa=O}return aa}function ta(){var aa=V;if(46===f.charCodeAt(V)){var fa=Ab;V++}else fa=O,0===Ca&&e(Fe);fa!==O?(aa=wa(),aa===O&&(aa=null),aa="."+(null!=aa?aa:"")):(V=aa,aa=O);return aa}function pa(){var aa;var fa=aa=V;if(Ge.test(f.charAt(V))){var na=f.charAt(V);V++}else na=O,0===Ca&&e(He);na!==O?(Ie.test(f.charAt(V))?(fa=f.charAt(V),V++):(fa=O,0===Ca&&e(Je)),fa===
O&&(fa=null),fa="e"+(null===fa?"":fa)):(V=fa,fa=O);fa!==O?(na=wa(),na!==O?aa=fa+na:(V=aa,aa=O)):(V=aa,aa=O);return aa}function wa(){var aa=[];var fa=Ba();if(fa!==O)for(;fa!==O;)aa.push(fa),fa=Ba();else aa=O;aa!==O&&(aa=aa.join(""));return aa}function Ba(){if(Ke.test(f.charAt(V))){var aa=f.charAt(V);V++}else aa=O,0===Ca&&e(Le);return aa}function L(){var aa=V;if(f.substr(V,2).toLowerCase()===qa){var fa=f.substr(V,2);V+=2}else fa=O,0===Ca&&e(Me);if(fa!==O){fa=V;Ca++;var na=K();Ca--;na===O?fa=void 0:
(V=fa,fa=O);fa!==O?aa="IN":(V=aa,aa=O)}else V=aa,aa=O;return aa}function T(){var aa=V;if(f.substr(V,2).toLowerCase()===oa){var fa=f.substr(V,2);V+=2}else fa=O,0===Ca&&e(Ne);if(fa!==O){fa=V;Ca++;var na=K();Ca--;na===O?fa=void 0:(V=fa,fa=O);fa!==O?aa="IS":(V=aa,aa=O)}else V=aa,aa=O;return aa}function la(){var aa=V;if(f.substr(V,4).toLowerCase()===va){var fa=f.substr(V,4);V+=4}else fa=O,0===Ca&&e(Oe);if(fa!==O){fa=V;Ca++;var na=K();Ca--;na===O?fa=void 0:(V=fa,fa=O);fa!==O?aa="LIKE":(V=aa,aa=O)}else V=
aa,aa=O;return aa}function U(){var aa=V;if(f.substr(V,3).toLowerCase()===Ja){var fa=f.substr(V,3);V+=3}else fa=O,0===Ca&&e(Pe);if(fa!==O){fa=V;Ca++;var na=K();Ca--;na===O?fa=void 0:(V=fa,fa=O);fa!==O?aa="NOT":(V=aa,aa=O)}else V=aa,aa=O;return aa}function Q(){var aa=V;if(f.substr(V,3).toLowerCase()===Oa){var fa=f.substr(V,3);V+=3}else fa=O,0===Ca&&e(Qe);if(fa!==O){fa=V;Ca++;var na=K();Ca--;na===O?fa=void 0:(V=fa,fa=O);fa!==O?aa="AND":(V=aa,aa=O)}else V=aa,aa=O;return aa}function da(){var aa=V;if(f.substr(V,
2).toLowerCase()===Pa){var fa=f.substr(V,2);V+=2}else fa=O,0===Ca&&e(Re);if(fa!==O){fa=V;Ca++;var na=K();Ca--;na===O?fa=void 0:(V=fa,fa=O);fa!==O?aa="OR":(V=aa,aa=O)}else V=aa,aa=O;return aa}function ea(){var aa=V;if(f.substr(V,7).toLowerCase()===bb){var fa=f.substr(V,7);V+=7}else fa=O,0===Ca&&e(Se);if(fa!==O){fa=V;Ca++;var na=K();Ca--;na===O?fa=void 0:(V=fa,fa=O);fa!==O?aa="BETWEEN":(V=aa,aa=O)}else V=aa,aa=O;return aa}function ja(){var aa=V;if(f.substr(V,4).toLowerCase()===$a){var fa=f.substr(V,
4);V+=4}else fa=O,0===Ca&&e(Te);if(fa!==O){fa=V;Ca++;var na=K();Ca--;na===O?fa=void 0:(V=fa,fa=O);fa!==O?aa="FROM":(V=aa,aa=O)}else V=aa,aa=O;return aa}function ha(){var aa=V;if(f.substr(V,4).toLowerCase()===Ue){var fa=f.substr(V,4);V+=4}else fa=O,0===Ca&&e(Ve);if(fa!==O){fa=V;Ca++;var na=K();Ca--;na===O?fa=void 0:(V=fa,fa=O);fa!==O?aa="TRIM":(V=aa,aa=O)}else V=aa,aa=O;return aa}function Y(){var aa=V;if(f.substr(V,8).toLowerCase()===We){var fa=f.substr(V,8);V+=8}else fa=O,0===Ca&&e(Xe);if(fa!==O){fa=
V;Ca++;var na=K();Ca--;na===O?fa=void 0:(V=fa,fa=O);fa!==O?aa="INTERVAL":(V=aa,aa=O)}else V=aa,aa=O;return aa}function ca(){var aa=V;if(f.substr(V,4).toLowerCase()===Ye){var fa=f.substr(V,4);V+=4}else fa=O,0===Ca&&e(Ze);if(fa!==O){fa=V;Ca++;var na=K();Ca--;na===O?fa=void 0:(V=fa,fa=O);fa!==O?aa="YEAR":(V=aa,aa=O)}else V=aa,aa=O;return aa}function ia(){var aa=V;if(f.substr(V,5).toLowerCase()===$e){var fa=f.substr(V,5);V+=5}else fa=O,0===Ca&&e(af);if(fa!==O){fa=V;Ca++;var na=K();Ca--;na===O?fa=void 0:
(V=fa,fa=O);fa!==O?aa="MONTH":(V=aa,aa=O)}else V=aa,aa=O;return aa}function ra(){var aa=V;if(f.substr(V,3).toLowerCase()===bf){var fa=f.substr(V,3);V+=3}else fa=O,0===Ca&&e(cf);if(fa!==O){fa=V;Ca++;var na=K();Ca--;na===O?fa=void 0:(V=fa,fa=O);fa!==O?aa="DAY":(V=aa,aa=O)}else V=aa,aa=O;return aa}function ua(){var aa=V;if(f.substr(V,4).toLowerCase()===df){var fa=f.substr(V,4);V+=4}else fa=O,0===Ca&&e(ef);if(fa!==O){fa=V;Ca++;var na=K();Ca--;na===O?fa=void 0:(V=fa,fa=O);fa!==O?aa="HOUR":(V=aa,aa=O)}else V=
aa,aa=O;return aa}function za(){var aa=V;if(f.substr(V,6).toLowerCase()===ff){var fa=f.substr(V,6);V+=6}else fa=O,0===Ca&&e(gf);if(fa!==O){fa=V;Ca++;var na=K();Ca--;na===O?fa=void 0:(V=fa,fa=O);fa!==O?aa="MINUTE":(V=aa,aa=O)}else V=aa,aa=O;return aa}function Da(){var aa=V;if(f.substr(V,6).toLowerCase()===hf){var fa=f.substr(V,6);V+=6}else fa=O,0===Ca&&e(jf);if(fa!==O){fa=V;Ca++;var na=K();Ca--;na===O?fa=void 0:(V=fa,fa=O);fa!==O?aa="SECOND":(V=aa,aa=O)}else V=aa,aa=O;return aa}function ya(){var aa=
V;if(f.substr(V,4).toLowerCase()===kf){var fa=f.substr(V,4);V+=4}else fa=O,0===Ca&&e(lf);if(fa!==O){fa=V;Ca++;var na=K();Ca--;na===O?fa=void 0:(V=fa,fa=O);fa!==O?aa="CASE":(V=aa,aa=O)}else V=aa,aa=O;return aa}function Ga(){var aa=V;if(f.substr(V,3).toLowerCase()===mf){var fa=f.substr(V,3);V+=3}else fa=O,0===Ca&&e(nf);if(fa!==O){fa=V;Ca++;var na=K();Ca--;na===O?fa=void 0:(V=fa,fa=O);fa!==O?aa="END":(V=aa,aa=O)}else V=aa,aa=O;return aa}function Ha(){var aa=V;if(f.substr(V,4).toLowerCase()===of){var fa=
f.substr(V,4);V+=4}else fa=O,0===Ca&&e(pf);if(fa!==O){fa=V;Ca++;var na=K();Ca--;na===O?fa=void 0:(V=fa,fa=O);fa!==O?aa="WHEN":(V=aa,aa=O)}else V=aa,aa=O;return aa}function Fa(){var aa=V;if(f.substr(V,4).toLowerCase()===qf){var fa=f.substr(V,4);V+=4}else fa=O,0===Ca&&e(rf);if(fa!==O){fa=V;Ca++;var na=K();Ca--;na===O?fa=void 0:(V=fa,fa=O);fa!==O?aa="THEN":(V=aa,aa=O)}else V=aa,aa=O;return aa}function Ea(){if(44===f.charCodeAt(V)){var aa=sf;V++}else aa=O,0===Ca&&e(tf);return aa}function Ka(){if(40===
f.charCodeAt(V)){var aa=uf;V++}else aa=O,0===Ca&&e(vf);return aa}function Ma(){if(41===f.charCodeAt(V)){var aa=wf;V++}else aa=O,0===Ca&&e(xf);return aa}function xa(){var aa;var fa=[];for(aa=Qa();aa!==O;)fa.push(aa),aa=Qa();return fa}function Qa(){if(yf.test(f.charAt(V))){var aa=f.charAt(V);V++}else aa=O,0===Ca&&e(zf);return aa}function Wa(aa,fa,na,Aa){aa={type:"binary-expression",operator:aa,left:fa,right:na};void 0!==Aa&&(aa.escape=Aa);return aa}function Ra(aa,fa){for(var na=0;na<fa.length;na++)aa=
Wa(fa[na][1],aa,fa[na][3]);return aa}k=void 0!==k?k:{};var O={},Va=k.grammarSource,Na={start:c},Xa=c,db="!",hb="\x3d",mb="\x3e\x3d",tb="\x3e",sa="\x3c\x3d",kb="\x3c\x3e",xb="\x3c",ib="!\x3d",jb="+",Ib="-",Vb="*",Bc="/",rb="@",Fb="'",Ya="N'",lb="''",Ab=".",Ua="null",Kb="true",ma="false",qa="in",oa="is",va="like",Ia="escape",Ja="not",Oa="and",Pa="or",bb="between",$a="from",Za="for",fb="substring",sb="extract",Ue="trim",be="position",Ld="timestamp",Id="date",ue="leading",we="trailing",ye="both",Ae="to",
We="interval",Ye="year",$e="month",bf="day",df="hour",ff="minute",hf="second",kf="case",mf="end",of="when",qf="then",De="else",sf=",",uf="(",wf=")",ed="`",ne=/^[A-Za-z_\x80-\uFFFF]/,pe=/^[A-Za-z0-9_]/,re=/^[A-Za-z0-9_.\x80-\uFFFF]/,pd=/^[^']/,Ke=/^[0-9]/,Ge=/^[eE]/,Ie=/^[+\-]/,yf=/^[ \t\n\r]/,gd=/^[^`]/,rd=g("!",!1),Pc=g("\x3d",!1),td=g("\x3e\x3d",!1),ud=g("\x3e",!1),vd=g("\x3c\x3d",!1),wd=g("\x3c\x3e",!1),xd=g("\x3c",!1),yd=g("!\x3d",!1),zc=g("+",!1),Ac=g("-",!1),zd=g("*",!1),Ad=g("/",!1),oe=m([["A",
"Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),qe=m([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),se=m([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),te=g("@",!1),nd=g("'",!1),Ce=g("N'",!1),od=g("''",!1),qd=m(["'"],!0,!1),Fe=g(".",!1),Le=m([["0","9"]],!1,!1),He=m(["e","E"],!1,!1),Je=m(["+","-"],!1,!1),Gd=g("NULL",!0),Cd=g("TRUE",!0),Ed=g("FALSE",!0),Me=g("IN",!0),Ne=g("IS",!0),Oe=g("LIKE",!0),sd=g("ESCAPE",!0),Pe=g("NOT",!0),Qe=g("AND",!0),Re=g("OR",!0),Se=g("BETWEEN",!0),Te=g("FROM",
!0),Xd=g("FOR",!0),Td=g("SUBSTRING",!0),Od=g("EXTRACT",!0),Ve=g("TRIM",!0),ce=g("POSITION",!0),Md=g("TIMESTAMP",!0),Jd=g("DATE",!0),ve=g("LEADING",!0),xe=g("TRAILING",!0),ze=g("BOTH",!0),Be=g("TO",!0),Xe=g("INTERVAL",!0),Ze=g("YEAR",!0),af=g("MONTH",!0),cf=g("DAY",!0),ef=g("HOUR",!0),gf=g("MINUTE",!0),jf=g("SECOND",!0),lf=g("CASE",!0),nf=g("END",!0),pf=g("WHEN",!0),rf=g("THEN",!0),Ee=g("ELSE",!0),tf=g(",",!1),vf=g("(",!1),xf=g(")",!1),zf=m([" ","\t","\n","\r"],!1,!1),fd=g("`",!1),hd=m(["`"],!0,!1),
ld=function(aa){return{type:"interval-period",period:aa.value,precision:null,secondary:null}},md=function(aa,fa){return{type:"interval-period",period:"second",precision:aa,secondary:fa}},V=0,fc=[{line:1,column:1}],wb=0,yc=[],Ca=0;if("startRule"in k){if(!(k.startRule in Na))throw Error("Can't start parsing from rule \""+k.startRule+'".');Xa=Na[k.startRule]}var Oc=Xa();if(Oc!==O&&V===f.length)return Oc;Oc!==O&&V<f.length&&e({type:"end"});throw function(aa,fa,na){return new z(z.buildMessage(aa,fa),aa,
fa,na)}(yc,wb<f.length?f.charAt(wb):null,wb<f.length?t(wb,wb+1):t(wb,wb));}}})})(E);let C=function(){function v(){}v.parse=function(z){return E.exports.parse(z)};return v}();r.WhereGrammar=C;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/chunks/_commonjsHelpers":function(){define(["exports"],function(r){r.commonjsGlobal="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?
self:{};r.commonjsRequire=function(u){throw Error('Could not dynamically require "'+u+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.');};r.getDefaultExportFromCjs=function(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u["default"]:u}})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(r,u,E,C,v,z,x){function f(a,b){if(!b)return null;if("x"in b){var h={x:0,y:0};[h.x,h.y]=a(b.x,b.y,p);null!=b.z&&(h.z=b.z);null!=b.m&&(h.m=b.m);return h}if("xmin"in b)return h={xmin:0,ymin:0,xmax:0,ymax:0},[h.xmin,h.ymin]=a(b.xmin,b.ymin,p),[h.xmax,h.ymax]=a(b.xmax,b.ymax,p),b.hasZ&&(h.zmin=b.zmin,h.zmax=b.zmax,h.hasZ=!0),b.hasM&&(h.mmin=b.mmin,h.mmax=b.mmax,h.hasM=!0),h;if("rings"in b)return{rings:k(b.rings,a),hasM:b.hasM,hasZ:b.hasZ};if("paths"in b)return{paths:k(b.paths,a),hasM:b.hasM,hasZ:b.hasZ};
if("points"in b)return{points:g(b.points,a),hasM:b.hasM,hasZ:b.hasZ}}function k(a,b){const h=[];for(const l of a)h.push(g(l,b));return h}function g(a,b){const h=[];for(const l of a)a=b(l[0],l[1],[0,0]),h.push(a),2<l.length&&a.push(l[2]),3<l.length&&a.push(l[3]);return h}function m(){m=u._asyncToGenerator(function*(a,b){b&&(a=Array.isArray(a)?a.map(h=>E.isSome(h.geometry)&&h.geometry.spatialReference):[a],yield C.initializeProjection(a.map(h=>({source:h,dest:b}))))});return m.apply(this,arguments)}
const p=[0,0],t=f.bind(null,x.lngLatToXY),e=f.bind(null,x.xyToLngLat),c=new (function(){function a(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}var b=a.prototype;b.push=function(){var h=u._asyncToGenerator(function*(l,d,q){if(!(l&&l.length&&d&&q)||z.equals(d,q))return l;const n={geometries:l,inSpatialReference:d,outSpatialReference:q,resolve:null};this._jobs.push(n);return new Promise(B=>{n.resolve=B;null===this._timer&&(this._timer=setTimeout(this._process,10))})});return function(l,
d,q){return h.apply(this,arguments)}}();b._process=function(){this._timer=null;const h=this._jobs.shift();if(h){var {geometries:l,inSpatialReference:d,outSpatialReference:q,resolve:n}=h;x.canProject(d,q)?z.isWebMercator(q)?n(l.map(t)):n(l.map(e)):n(C.projectMany(v.jsonAdapter,l,d,q,null,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return a}());r.checkProjectionSupport=function(a,b){return m.apply(this,arguments)};r.project=function(a,b,h,l){if(!a)return a;h||(h=b,b=a.spatialReference);
return z.isValid(b)&&z.isValid(h)&&!z.equals(b,h)?x.canProject(b,h)?(a=z.isWebMercator(h)?t(a):e(a),a.spatialReference=h,a):C.projectMany(v.jsonAdapter,[a],b,h,null,l)[0]:a};r.projectMany=function(a,b,h){return c.push(a,b,h)};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/projection":function(){define("require exports ../chunks/_rollupPluginBabelHelpers ../core/Error ../core/mathUtils ../core/maybe ../core/promiseUtils ../core/unitUtils ../core/accessorSupport/tracking ../core/accessorSupport/tracking/SimpleObservable ../chunks/mat4 ../chunks/vec3 ../chunks/vec3f64 ./Extent ./Multipoint ../chunks/pe ./Point ./Polygon ./Polyline ./projectionEllipsoid ./support/aaBoundingRect ./support/Ellipsoid ./support/geodesicConstants ./support/GeographicTransformation ./support/spatialReferenceUtils ./support/SupportedGCSWkids ./support/zscale".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t,e,c,a,b,h,l,d,q,n,B,A,w,y,D){function F(){return!!Na&&a.isLoaded()}function G(ma){z.isNone(db)&&(db=Promise.all([a.load(),(new Promise((qa,oa)=>r(["../chunks/geometryEngineBase"],qa,oa))).then(qa=>qa.geometryEngineBase),new Promise((qa,oa)=>r(["./geometryAdapters/hydrated"],qa,oa))]));return db.then(([,qa,{hydratedAdapter:oa}])=>{x.throwIfAborted(ma);Xa=oa;Na=qa.default;Na._enableProjection(a.pe);mb.notify()})}function K(ma,qa,oa=null,va=null){return Array.isArray(ma)?
0===ma.length?[]:J(Xa,ma,ma[0].spatialReference,qa,oa,va):J(Xa,[ma],ma.spatialReference,qa,oa,va)[0]}function J(ma,qa,oa,va,Ia=null,Ja=null){if(z.isNone(oa)||z.isNone(va))return qa;if(M(oa,va,Ia))return qa.map(Oa=>z.unwrap(P(Oa,oa,va)));if(z.isNone(Ia)){const Oa=A.cacheKey(oa,va);void 0!==hb[Oa]?Ia=hb[Oa]:(Ia=I(oa,va,null),z.isNone(Ia)&&(Ia=new A),hb[Oa]=Ia)}if(z.isNone(Na))throw new tb;return z.isSome(Ja)?Na._project(ma,qa,oa,va,Ia,Ja):Na._project(ma,qa,oa,va,Ia)}function I(ma,qa,oa=null){if(z.isNone(Na))throw new tb;
if(z.isNone(ma)||z.isNone(qa))return null;ma=Na._getTransformation(Xa,ma,qa,oa,null==oa?void 0:oa.spatialReference);return null!==ma?A.fromGE(ma):null}function H(ma,qa){try{const oa=K(ma,qa);if(null==oa)return null;"xmin"in ma&&"xmin"in oa&&(oa.zmin=ma.zmin,oa.zmax=ma.zmax);const va=D.getGeometryZScaler(oa.type,ma.spatialReference,qa);z.isSome(va)&&va(oa);return oa}catch(oa){if(!(oa instanceof tb))throw oa;return null}}function M(ma,qa,oa){return oa?!1:w.equals(ma,qa)?!0:w.isValid(ma)&&w.isValid(qa)&&
!!Ra(ma,qa,Vb)}function N(){N=E._asyncToGenerator(function*(ma,qa,oa,va){if(F())return x.waitTick(va);if(Array.isArray(ma))for(const {source:Ia,dest:Ja,geographicTransformation:Oa}of ma){if(!M(Ia,Ja,Oa))return G(va)}else if(!M(ma,qa,oa))return G(va);return x.waitTick(va)});return N.apply(this,arguments)}function P(ma,qa,oa){return ma?"x"in ma?ba(ma,qa,new b,oa,0):"xmin"in ma?R(ma,qa,new e,oa,0):"rings"in ma?W(ma,qa,new h,oa,0):"paths"in ma?S(ma,qa,new l,oa,0):"points"in ma?X(ma,qa,new c,oa,0):null:
null}function ba(ma,qa,oa,va,Ia){Ua[0]=ma.x;Ua[1]=ma.y;const Ja=ma.z;Ua[2]=void 0!==Ja?Ja:Ia;if(!pa(Ua,qa,0,Ua,va,0,1))return null;oa.x=Ua[0];oa.y=Ua[1];oa.spatialReference=va;void 0===Ja?(oa.z=void 0,oa.hasZ=!1):(oa.z=Ua[2],oa.hasZ=!0);void 0===ma.m?(oa.m=void 0,oa.hasM=!1):(oa.m=ma.m,oa.hasM=!0);return oa}function X(ma,qa,oa,va,Ia){const {points:Ja,hasZ:Oa,hasM:Pa}=ma;ma=[];const bb=Ja.length,$a=[];for(var Za of Ja)$a.push(Za[0],Za[1],Oa?Za[2]:Ia);if(!pa($a,qa,0,$a,va,0,bb))return null;for(qa=0;qa<
bb;++qa){Ia=3*qa;Za=$a[Ia];const fb=$a[Ia+1];Oa&&Pa?ma.push([Za,fb,$a[Ia+2],Ja[qa][3]]):Oa?ma.push([Za,fb,$a[Ia+2]]):Pa?ma.push([Za,fb,Ja[qa][2]]):ma.push([Za,fb])}oa.points=ma;oa.spatialReference=va;oa.hasZ=Oa;oa.hasM=Pa;return oa}function S(ma,qa,oa,va,Ia){const {paths:Ja,hasZ:Oa,hasM:Pa}=ma;ma=[];if(!wa(Ja,Oa,Pa,qa,ma,va,Ia))return null;oa.paths=ma;oa.spatialReference=va;oa.hasZ=Oa;oa.hasM=Pa;return oa}function W(ma,qa,oa,va,Ia){const {rings:Ja,hasZ:Oa,hasM:Pa}=ma;ma=[];if(!wa(Ja,Oa,Pa,qa,ma,va,
Ia))return null;oa.rings=ma;oa.spatialReference=va;oa.hasZ=Oa;oa.hasM=Pa;return oa}function R(ma,qa,oa,va,Ia){const {xmin:Ja,ymin:Oa,xmax:Pa,ymax:bb,hasZ:$a,hasM:Za}=ma;if(!Z(Ja,Oa,$a?ma.zmin:Ia,qa,Ua,va))return null;oa.xmin=Ua[0];oa.ymin=Ua[1];$a&&(oa.zmin=Ua[2]);if(!Z(Pa,bb,$a?ma.zmax:Ia,qa,Ua,va))return null;oa.xmax=Ua[0];oa.ymax=Ua[1];$a&&(oa.zmax=Ua[2]);Za&&(oa.mmin=ma.mmin,oa.mmax=ma.mmax);oa.spatialReference=va;return oa}function Z(ma,qa,oa,va,Ia,Ja){Ya[0]=ma;Ya[1]=qa;Ya[2]=oa;return pa(Ya,
va,0,Ia,Ja,0,1)}function ka(ma,qa,oa,va){if(z.isNone(qa)||z.isNone(va)||2>ma.length)return!1;2===ma.length&&(Ya[0]=ma[0],Ya[1]=ma[1],Ya[2]=0,ma=Ya);return pa(ma,qa,0,oa,va,0,1)}function ta(ma,qa,oa){if(z.isNone(qa))return!1;qa=la(qa,jb);qa=ib[qa][sa.WGS84_COMPARABLE_LON_LAT];if(z.isNone(qa))return!1;qa(ma,0,Ya,0);oa!==Ya&&(oa[0]=Ya[0],oa[1]=Ya[1],2<oa.length&&(oa[2]=Ya[2]));return!0}function pa(ma,qa,oa,va,Ia,Ja,Oa=1){qa=Ra(qa,Ia,Vb);if(z.isNone(qa))return!1;if(qa===U){if(ma===va&&oa===Ja)return!0;
Oa=oa+3*Oa;for(let Pa=oa,bb=Ja;Pa<Oa;Pa++,bb++)va[bb]=ma[Pa];return!0}Oa=oa+3*Oa;for(let Pa=oa,bb=Ja;Pa<Oa;Pa+=3,bb+=3)qa(ma,Pa,va,bb);return!0}function wa(ma,qa,oa,va,Ia,Ja,Oa=0){const Pa=[];for(const bb of ma)for(const $a of bb)Pa.push($a[0],$a[1],qa?$a[2]:Oa);if(!pa(Pa,va,0,Pa,Ja,0,Pa.length/3))return!1;va=0;Ia.length=0;for(const bb of ma){ma=[];for(const $a of bb)qa&&oa?ma.push([Pa[va++],Pa[va++],Pa[va++],$a[3]]):qa?ma.push([Pa[va++],Pa[va++],Pa[va++]]):(oa?ma.push([Pa[va++],Pa[va++],$a[2]]):
ma.push([Pa[va++],Pa[va++]]),va++);Ia.push(ma)}return!0}function Ba(ma,qa,oa,va){qa=va+qa;if(qa<va/2||oa>qa)return Number.MAX_VALUE;ma=Math.abs(rb*ma)+Math.asin(oa/qa);return ma>=Math.PI/2?Number.MAX_VALUE:oa/Math.cos(ma)}function L(ma,qa,oa){const va=Math.sin(ma);ma=Math.cos(ma);const Ia=Math.sin(qa);qa=Math.cos(qa);oa[0]=-va;oa[4]=-Ia*ma;oa[8]=qa*ma;oa[12]=0;oa[1]=ma;oa[5]=-Ia*va;oa[9]=qa*va;oa[13]=0;oa[2]=0;oa[6]=qa;oa[10]=Ia;oa[14]=0;oa[3]=0;oa[7]=0;oa[11]=0;oa[15]=1;return oa}function T(ma,qa,
oa){L(ma,qa,oa);m.transpose(oa,oa);return oa}function la(ma,qa){if(qa.spatialReference===ma)return qa.spatialReferenceId;qa.spatialReference=ma;"metersPerUnit"in qa&&(qa.metersPerUnit=f.getMetersPerUnitForSR(ma,1));return ma.wkt===d.SphericalECEFSpatialReference.wkt?qa.spatialReferenceId=sa.SPHERICAL_ECEF:w.isWGS84(ma)?qa.spatialReferenceId=sa.WGS84:w.isWebMercator(ma)?qa.spatialReferenceId=sa.WEB_MERCATOR:w.isPlateCarree(ma)?qa.spatialReferenceId=sa.PLATE_CARREE:ma.wkt===d.WGS84ECEFSpatialReference.wkt?
qa.spatialReferenceId=sa.WGS84_ECEF:ma.wkid===y.SupportedGCSWkids.CGCS2000?qa.spatialReferenceId=sa.CGCS2000:ma.wkt===d.SphericalPCPFMars.wkt?qa.spatialReferenceId=sa.SPHERICAL_MARS_PCPF:ma.wkt===d.SphericalPCPFMoon.wkt?qa.spatialReferenceId=sa.SPHERICAL_MOON_PCPF:w.isMars(ma)?qa.spatialReferenceId=sa.GCSMARS2000:w.isMoon(ma)?qa.spatialReferenceId=sa.GCSMOON2000:qa.spatialReferenceId=sa.UNKNOWN}function U(ma,qa,oa,va){ma!==oa&&(oa[va++]=ma[qa++],oa[va++]=ma[qa++],oa[va]=ma[qa])}function Q(ma,qa,oa,
va){oa[va++]=Fb*(ma[qa++]/n.earth.radius);oa[va++]=Fb*(Math.PI/2-2*Math.atan(Math.exp(-ma[qa++]/n.earth.radius)));oa[va]=ma[qa]}function da(ma,qa,oa,va){Q(ma,qa,oa,va);Da(oa,va,oa,va)}function ea(ma,qa,oa,va){Q(ma,qa,oa,va);Ma(oa,va,oa,va)}function ja(ma,qa,oa,va,Ia){var Ja=.4999999*Math.PI;Ja=v.clamp(rb*ma[qa+1],-Ja,Ja);Ja=Math.sin(Ja);oa[va++]=rb*ma[qa]*Ia.radius;oa[va++]=Ia.halfSemiMajorAxis*Math.log((1+Ja)/(1-Ja));oa[va]=ma[qa+2]}function ha(ma,qa,oa,va){ja(ma,qa,oa,va,n.earth)}function Y(ma,
qa,oa,va){oa[va]=ma[qa]*kb;oa[va+1]=ma[qa+1]*kb;oa[va+2]=ma[qa+2]}function ca(ma,qa,oa,va){oa[va]=ma[qa]*xb;oa[va+1]=ma[qa+1]*xb;oa[va+2]=ma[qa+2]}function ia(ma,qa,oa,va){Q(ma,qa,oa,va);Y(oa,va,oa,va)}function ra(ma,qa,oa,va,Ia){Ia+=ma[qa+2];const Ja=rb*ma[qa+1];ma=rb*ma[qa];qa=Math.cos(Ja);oa[va++]=Math.cos(ma)*qa*Ia;oa[va++]=Math.sin(ma)*qa*Ia;oa[va]=Math.sin(Ja)*Ia}function ua(ma,qa,oa,va){ra(ma,qa,oa,va,n.moon.radius)}function za(ma,qa,oa,va){ra(ma,qa,oa,va,n.mars.radius)}function Da(ma,qa,oa,
va){ra(ma,qa,oa,va,n.earth.radius)}function ya(ma,qa,oa,va,Ia){var Ja=ma[qa];const Oa=ma[qa+1];qa=ma[qa+2];ma=Math.sqrt(Ja*Ja+Oa*Oa+qa*qa);qa=v.asinClamped(qa/(0===ma?1:ma));Ja=Math.atan2(Oa,Ja);oa[va++]=Fb*Ja;oa[va++]=Fb*qa;oa[va]=ma-Ia}function Ga(ma,qa,oa,va){ya(ma,qa,oa,va,n.moon.radius)}function Ha(ma,qa,oa,va){ya(ma,qa,oa,va,n.mars.radius)}function Fa(ma,qa,oa,va){ya(ma,qa,oa,va,n.earth.radius)}function Ea(ma,qa,oa,va){Fa(ma,qa,oa,va);ha(oa,va,oa,va)}function Ka(ma,qa,oa,va){Fa(ma,qa,oa,va);
Ma(oa,va,oa,va)}function Ma(ma,qa,oa,va){{var Ia=n.earth;const Oa=rb*ma[qa];var Ja=rb*ma[qa+1];ma=ma[qa+2];qa=Math.sin(Ja);Ja=Math.cos(Ja);const Pa=Ia.radius/Math.sqrt(1-Ia.eccentricitySquared*qa*qa);oa[va++]=(Pa+ma)*Ja*Math.cos(Oa);oa[va++]=(Pa+ma)*Ja*Math.sin(Oa);oa[va++]=(Pa*(1-Ia.eccentricitySquared)+ma)*qa}}function xa(ma,qa,oa,va){var Ia=B.earthEllipsoidConstants,Ja=ma[qa],Oa=ma[qa+1];ma=ma[qa+2];let Pa;qa=Math.abs(ma);var bb=Ja*Ja+Oa*Oa;var $a=Math.sqrt(bb);var Za=bb+ma*ma;var fb=Math.sqrt(Za);
Ja=Math.atan2(Oa,Ja);var sb=ma*ma/Za;Za=bb/Za;Oa=Ia.a2/fb;bb=Ia.a3-Ia.a4/fb;.3<Za?(sb=qa/fb*(1+Za*(Ia.a1+Oa+sb*bb)/fb),fb=Math.asin(sb),Oa=sb*sb,Za=Math.sqrt(1-Oa)):(Za=$a/fb*(1-sb*(Ia.a5-Oa-Za*bb)/fb),fb=Math.acos(Za),Oa=1-Za*Za,sb=Math.sqrt(Oa));Pa=1-n.earth.eccentricitySquared*Oa;Oa=n.earth.radius/Math.sqrt(Pa);Ia=Ia.a6*Oa;Oa=$a-Oa*Za;bb=qa-Ia*sb;qa=Za*Oa+sb*bb;$a=Za*bb-sb*Oa;Ia=$a/(Ia/Pa+qa);fb+=Ia;0>ma&&(fb=-fb);oa[va++]=Fb*Ja;oa[va++]=Fb*fb;oa[va]=qa+$a*Ia/2}function Qa(ma,qa,oa,va){xa(ma,qa,
oa,va);Da(oa,va,oa,va)}function Wa(ma,qa,oa,va){xa(ma,qa,oa,va);ha(oa,va,oa,va)}function Ra(ma,qa,oa=Va()){return z.isNone(ma)||z.isNone(qa)?null:O(ma,qa,oa).projector}function O(ma,qa,oa){if(z.isNone(ma)||z.isNone(qa)||oa.source.spatialReference===ma&&oa.dest.spatialReference===qa)return oa;const va=la(ma,oa.source),Ia=la(qa,oa.dest);va===sa.UNKNOWN&&Ia===sa.UNKNOWN?w.equals(ma,qa)?oa.projector=U:oa.projector=null:oa.projector=ib[va][Ia];return oa}function Va(){return{source:{spatialReference:null,
spatialReferenceId:sa.UNKNOWN,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:sa.UNKNOWN,metersPerUnit:1},projector:U}}let Na=null,Xa=null,db=null,hb={};const mb=new g.SimpleObservable;let tb=function(ma){function qa(){return ma.call(this,"projection:not-loaded","projection engine not fully loaded yet, please call load()")||this}E._inheritsLoose(qa,ma);return qa}(C);var sa;(function(ma){ma[ma.UNKNOWN=0]="UNKNOWN";ma[ma.SPHERICAL_ECEF=1]="SPHERICAL_ECEF";ma[ma.WGS84=2]="WGS84";ma[ma.WEB_MERCATOR=
3]="WEB_MERCATOR";ma[ma.WGS84_ECEF=4]="WGS84_ECEF";ma[ma.CGCS2000=5]="CGCS2000";ma[ma.WGS84_COMPARABLE_LON_LAT=6]="WGS84_COMPARABLE_LON_LAT";ma[ma.SPHERICAL_MARS_PCPF=7]="SPHERICAL_MARS_PCPF";ma[ma.GCSMARS2000=8]="GCSMARS2000";ma[ma.SPHERICAL_MOON_PCPF=9]="SPHERICAL_MOON_PCPF";ma[ma.GCSMOON2000=10]="GCSMOON2000";ma[ma.LON_LAT=11]="LON_LAT";ma[ma.PLATE_CARREE=12]="PLATE_CARREE"})(sa||(sa={}));const kb=n.earth.radius*Math.PI/180,xb=180/(n.earth.radius*Math.PI),ib={[sa.WGS84]:{[sa.CGCS2000]:null,[sa.GCSMARS2000]:null,
[sa.GCSMOON2000]:null,[sa.LON_LAT]:U,[sa.WGS84_COMPARABLE_LON_LAT]:U,[sa.SPHERICAL_ECEF]:Da,[sa.SPHERICAL_MARS_PCPF]:null,[sa.SPHERICAL_MOON_PCPF]:null,[sa.UNKNOWN]:null,[sa.WEB_MERCATOR]:ha,[sa.PLATE_CARREE]:Y,[sa.WGS84]:U,[sa.WGS84_ECEF]:Ma},[sa.CGCS2000]:{[sa.CGCS2000]:U,[sa.GCSMARS2000]:null,[sa.GCSMOON2000]:null,[sa.LON_LAT]:U,[sa.WGS84_COMPARABLE_LON_LAT]:U,[sa.SPHERICAL_ECEF]:Da,[sa.SPHERICAL_MARS_PCPF]:null,[sa.SPHERICAL_MOON_PCPF]:null,[sa.UNKNOWN]:null,[sa.WEB_MERCATOR]:null,[sa.PLATE_CARREE]:Y,
[sa.WGS84]:null,[sa.WGS84_ECEF]:Ma},[sa.GCSMARS2000]:{[sa.CGCS2000]:null,[sa.GCSMARS2000]:U,[sa.GCSMOON2000]:null,[sa.LON_LAT]:U,[sa.WGS84_COMPARABLE_LON_LAT]:null,[sa.SPHERICAL_ECEF]:null,[sa.SPHERICAL_MARS_PCPF]:za,[sa.SPHERICAL_MOON_PCPF]:null,[sa.UNKNOWN]:null,[sa.WEB_MERCATOR]:null,[sa.PLATE_CARREE]:null,[sa.WGS84]:null,[sa.WGS84_ECEF]:null},[sa.GCSMOON2000]:{[sa.CGCS2000]:null,[sa.GCSMARS2000]:null,[sa.GCSMOON2000]:U,[sa.LON_LAT]:U,[sa.WGS84_COMPARABLE_LON_LAT]:null,[sa.SPHERICAL_ECEF]:null,
[sa.SPHERICAL_MARS_PCPF]:null,[sa.SPHERICAL_MOON_PCPF]:ua,[sa.UNKNOWN]:null,[sa.WEB_MERCATOR]:null,[sa.PLATE_CARREE]:null,[sa.WGS84]:null,[sa.WGS84_ECEF]:null},[sa.WEB_MERCATOR]:{[sa.CGCS2000]:null,[sa.GCSMARS2000]:null,[sa.GCSMOON2000]:null,[sa.LON_LAT]:Q,[sa.WGS84_COMPARABLE_LON_LAT]:Q,[sa.SPHERICAL_ECEF]:da,[sa.SPHERICAL_MARS_PCPF]:null,[sa.SPHERICAL_MOON_PCPF]:null,[sa.UNKNOWN]:null,[sa.WEB_MERCATOR]:U,[sa.PLATE_CARREE]:ia,[sa.WGS84]:Q,[sa.WGS84_ECEF]:ea},[sa.WGS84_ECEF]:{[sa.CGCS2000]:xa,[sa.GCSMARS2000]:null,
[sa.GCSMOON2000]:null,[sa.LON_LAT]:xa,[sa.WGS84_COMPARABLE_LON_LAT]:xa,[sa.SPHERICAL_ECEF]:Qa,[sa.SPHERICAL_MARS_PCPF]:null,[sa.SPHERICAL_MOON_PCPF]:null,[sa.UNKNOWN]:null,[sa.WEB_MERCATOR]:Wa,[sa.PLATE_CARREE]:function(ma,qa,oa,va){xa(ma,qa,oa,va);Y(oa,va,oa,va)},[sa.WGS84]:xa,[sa.WGS84_ECEF]:U},[sa.SPHERICAL_ECEF]:{[sa.CGCS2000]:Fa,[sa.GCSMARS2000]:null,[sa.GCSMOON2000]:null,[sa.LON_LAT]:Fa,[sa.WGS84_COMPARABLE_LON_LAT]:Fa,[sa.SPHERICAL_ECEF]:U,[sa.SPHERICAL_MARS_PCPF]:null,[sa.SPHERICAL_MOON_PCPF]:null,
[sa.UNKNOWN]:null,[sa.WEB_MERCATOR]:Ea,[sa.PLATE_CARREE]:function(ma,qa,oa,va){Fa(ma,qa,oa,va);Y(oa,va,oa,va)},[sa.WGS84]:Fa,[sa.WGS84_ECEF]:Ka},[sa.SPHERICAL_MARS_PCPF]:{[sa.CGCS2000]:null,[sa.GCSMARS2000]:Ha,[sa.GCSMOON2000]:null,[sa.LON_LAT]:Ha,[sa.WGS84_COMPARABLE_LON_LAT]:null,[sa.SPHERICAL_ECEF]:null,[sa.SPHERICAL_MARS_PCPF]:U,[sa.SPHERICAL_MOON_PCPF]:null,[sa.UNKNOWN]:null,[sa.WEB_MERCATOR]:null,[sa.PLATE_CARREE]:null,[sa.WGS84]:null,[sa.WGS84_ECEF]:null},[sa.SPHERICAL_MOON_PCPF]:{[sa.CGCS2000]:null,
[sa.GCSMARS2000]:null,[sa.GCSMOON2000]:Ga,[sa.LON_LAT]:Ga,[sa.WGS84_COMPARABLE_LON_LAT]:null,[sa.SPHERICAL_ECEF]:null,[sa.SPHERICAL_MARS_PCPF]:null,[sa.SPHERICAL_MOON_PCPF]:U,[sa.UNKNOWN]:null,[sa.WEB_MERCATOR]:null,[sa.PLATE_CARREE]:null,[sa.WGS84]:null,[sa.WGS84_ECEF]:null},[sa.UNKNOWN]:{[sa.CGCS2000]:null,[sa.GCSMARS2000]:null,[sa.GCSMOON2000]:null,[sa.LON_LAT]:null,[sa.WGS84_COMPARABLE_LON_LAT]:null,[sa.SPHERICAL_ECEF]:null,[sa.SPHERICAL_MARS_PCPF]:null,[sa.SPHERICAL_MOON_PCPF]:null,[sa.UNKNOWN]:U,
[sa.WEB_MERCATOR]:null,[sa.PLATE_CARREE]:null,[sa.WGS84]:null,[sa.WGS84_ECEF]:null},[sa.LON_LAT]:{[sa.CGCS2000]:U,[sa.GCSMARS2000]:U,[sa.GCSMOON2000]:U,[sa.LON_LAT]:U,[sa.WGS84_COMPARABLE_LON_LAT]:U,[sa.SPHERICAL_ECEF]:Da,[sa.SPHERICAL_MARS_PCPF]:za,[sa.SPHERICAL_MOON_PCPF]:ua,[sa.UNKNOWN]:null,[sa.WEB_MERCATOR]:ha,[sa.PLATE_CARREE]:Y,[sa.WGS84]:U,[sa.WGS84_ECEF]:Ma},[sa.WGS84_COMPARABLE_LON_LAT]:{[sa.CGCS2000]:null,[sa.GCSMARS2000]:null,[sa.GCSMOON2000]:null,[sa.LON_LAT]:U,[sa.WGS84_COMPARABLE_LON_LAT]:U,
[sa.SPHERICAL_ECEF]:Da,[sa.SPHERICAL_MARS_PCPF]:null,[sa.SPHERICAL_MOON_PCPF]:null,[sa.UNKNOWN]:null,[sa.WEB_MERCATOR]:null,[sa.PLATE_CARREE]:Y,[sa.WGS84]:U,[sa.WGS84_ECEF]:Ma},[sa.PLATE_CARREE]:{[sa.CGCS2000]:ca,[sa.GCSMARS2000]:null,[sa.GCSMOON2000]:null,[sa.LON_LAT]:ca,[sa.WGS84_COMPARABLE_LON_LAT]:ca,[sa.SPHERICAL_ECEF]:function(ma,qa,oa,va){ca(ma,qa,oa,va);Da(oa,va,oa,va)},[sa.SPHERICAL_MARS_PCPF]:null,[sa.SPHERICAL_MOON_PCPF]:null,[sa.UNKNOWN]:null,[sa.WEB_MERCATOR]:function(ma,qa,oa,va){ca(ma,
qa,oa,va);ha(oa,va,oa,va)},[sa.PLATE_CARREE]:U,[sa.WGS84]:ca,[sa.WGS84_ECEF]:function(ma,qa,oa,va){ca(ma,qa,oa,va);Ma(oa,va,oa,va)}}},jb={spatialReference:null,spatialReferenceId:sa.UNKNOWN},Ib={spatialReference:null,spatialReferenceId:sa.UNKNOWN},Vb=Va(),Bc=Va(),rb=v.deg2rad(1),Fb=v.rad2deg(1),Ya=t.create(),lb=t.create(),Ab=t.create(),Ua=t.create(),Kb=t.create();u.canProjectToWGS84ComparableLonLat=function(ma){if(z.isNone(ma))return!1;ma=la(ma,jb);return!!ib[ma][sa.WGS84_COMPARABLE_LON_LAT]};u.canProjectWithoutEngine=
M;u.computeENUToSphericalPCPFLocalRotation=L;u.computeSphericalPCPFToENULocalRotation=T;u.computeTranslationToOriginAndRotation=function(ma,qa,oa,va){if(z.isNone(ma)||z.isNone(va))return!1;var Ia=la(ma,jb),Ja=la(va,Ib);if(Ia===Ja&&Ja!==sa.SPHERICAL_ECEF&&Ja!==sa.SPHERICAL_MARS_PCPF&&Ja!==sa.SPHERICAL_MOON_PCPF&&(Ia!==sa.UNKNOWN||w.equals(ma,va)))return m.fromTranslation(oa,qa),!0;if(Ja===sa.SPHERICAL_ECEF||Ja===sa.SPHERICAL_MARS_PCPF||Ja===sa.SPHERICAL_MOON_PCPF){Ia=ib[Ia][sa.LON_LAT];Ja=ib[sa.LON_LAT][Ja];
if(z.isNone(Ia)||z.isNone(Ja))return!1;Ia(qa,0,lb,0);Ja(lb,0,Ab,0);L(rb*lb[0],rb*lb[1],oa);oa[12]=Ab[0];oa[13]=Ab[1];oa[14]=Ab[2];return!0}if((Ja===sa.WEB_MERCATOR||Ja===sa.PLATE_CARREE)&&(Ia===sa.WGS84||Ia===sa.CGCS2000&&Ja===sa.PLATE_CARREE||Ia===sa.SPHERICAL_ECEF||Ia===sa.WEB_MERCATOR)){ma=ib[Ia][sa.LON_LAT];Ja=ib[sa.LON_LAT][Ja];if(z.isNone(ma)||z.isNone(Ja))return!1;ma(qa,0,lb,0);Ja(lb,0,Ab,0);Ia===sa.SPHERICAL_ECEF?T(rb*lb[0],rb*lb[1],oa):m.identity(oa);oa[12]=Ab[0];oa[13]=Ab[1];oa[14]=Ab[2];
return!0}return!1};u.getProjectorName=function(ma,qa){switch(Ra(ma,qa,Vb)){case U:return"copy3";case Da:return"wgs84ToSphericalECEF";case ha:return"wgs84ToWebMercator";case Y:return"wgs84ToPlateCarree";case Ma:return"wgs84ToWGS84ECEF";case Q:return"webMercatorToWGS84";case da:return"webMercatorToSphericalECEF";case ea:return"webMercatorToWGS84ECEF";case ia:return"webMercatorToPlateCarree";case xa:return"wgs84ECEFToWGS84";case Qa:return"wgs84ECEFToSphericalECEF";case Wa:return"wgs84ECEFToWebMercator";
case Fa:return"sphericalECEFToWGS84";case Ea:return"sphericalECEFToWebMercator";case Ha:return"sphericalMarsPCPFToMars2000";case Ga:return"sphericalMoonPCPFToMoon2000";case Ka:return"sphericalECEFToWGS84ECEF";case za:return"mars2000ToSphericalPCPF";case ua:return"moon2000ToSphericalPCPF";default:return null}};u.getTransformation=I;u.getTransformations=function(ma,qa,oa=null){if(z.isNone(Na))throw new tb;ma=Na._getTransformationBySuitability(Xa,ma,qa,oa,null==oa?void 0:oa.spatialReference);if(null!==
ma){qa=[];for(const va of ma)qa.push(A.fromGE(va));return qa}return[]};u.initializeProjection=function(ma,qa,oa,va){return N.apply(this,arguments)};u.isLoaded=F;u.load=G;u.localLinearScaleFactors=function(ma,qa,oa,va){if(z.isNone(qa)||z.isNone(va))return!1;const Ia=la(qa,jb);var Ja=la(va,Ib);if(Ia===Ja&&Ia!==sa.UNKNOWN||w.equals(qa,va))return oa[0]=1,oa[1]=1,oa[2]=1,!0;if(Ia===sa.SPHERICAL_ECEF){qa=p.length(ma);ma=qa/Math.sqrt(ma[0]*ma[0]+ma[1]*ma[1]);qa/=n.earth.radius;if(Ja===sa.WEB_MERCATOR)return oa[0]=
ma*qa,oa[1]=ma*qa,oa[2]=1,!0;if(Ja===sa.WGS84||Ja===sa.CGCS2000)return Ja=xb,oa[0]=Ja*ma*qa,oa[1]=Ja*qa,oa[2]=1,!0}else if(Ia===sa.PLATE_CARREE){if(Ja===sa.WGS84||Ja===sa.CGCS2000)return oa[0]=xb,oa[1]=xb,oa[2]=1,!0;if(Ja===sa.WEB_MERCATOR)return Ja=ma[1]/n.earth.radius,oa[0]=1,oa[1]=1/Math.cos(Ja),oa[2]=1,!0}return!1};u.lonLatToSphericalPCPF=function(ma,qa,oa,va){const Ia=Math.cos(oa);ma[0]=Math.cos(qa)*Ia*va;ma[1]=Math.sin(qa)*Ia*va;ma[2]=Math.sin(oa)*va};u.lonLatToWebMercatorComparable=ja;u.project=
K;u.projectBoundingRect=function(ma,qa,oa,va){if(null==ma)return!1;if(w.equals(qa,va))return q.copy(oa,ma),!0;Ya[0]=ma[0];Ya[1]=ma[1];Ya[2]=0;if(!pa(Ya,qa,0,Ya,va,0,1))return!1;oa[0]=Ya[0];oa[1]=Ya[1];Ya[0]=ma[2];Ya[1]=ma[3];Ya[2]=0;if(!pa(Ya,qa,0,Ya,va,0,1))return!1;oa[2]=Ya[0];oa[3]=Ya[1];return!0};u.projectBoundingSphere=function(ma,qa,oa,va){if(z.isNone(qa)||z.isNone(va))return!1;qa=O(qa,va,Bc);if(qa.projector===U)return oa[0]=ma[0],oa[1]=ma[1],oa[2]=ma[2],oa[3]=ma[3],!0;if(z.isNone(qa.projector))return!1;
const {source:Ia,dest:Ja}=qa;if(Ja.spatialReferenceId===sa.WEB_MERCATOR){qa=ib[Ia.spatialReferenceId][sa.WGS84];if(z.isNone(qa))return!1;qa(ma,0,lb,0);ha(lb,0,oa,0);oa[3]=Ba(lb[1],ma[2],ma[3],n.earth.radius);return!0}if(Ia.spatialReferenceId!==sa.WGS84&&Ia.spatialReferenceId!==sa.CGCS2000||Ja.spatialReferenceId!==sa.PLATE_CARREE)qa.projector(ma,0,oa,0),oa[3]=ma[3]*Ia.metersPerUnit/Ja.metersPerUnit;else{va=ib[sa.SPHERICAL_ECEF][sa.PLATE_CARREE];let Oa=ma[3];z.isSome(ib[Ia.spatialReferenceId][sa.SPHERICAL_ECEF])&&
z.isSome(va)&&(Oa=Ba(ma[1],ma[2],ma[3],n.earth.radius));qa.projector(ma,0,oa,0);oa[3]=Oa}return!0};u.projectBuffer=pa;u.projectDirection=function(ma,qa,oa,va,Ia){p.copy(Ua,ma);p.add(Kb,ma,qa);ka(Ua,oa,Ua,Ia);ka(Kb,oa,Kb,Ia);p.subtract(va,Kb,Ua);p.normalize(va,va)};u.projectExtent=function(ma,qa,oa=qa.spatialReference,va=0){return z.isSome(oa)&&z.isSome(R(ma,ma.spatialReference,qa,oa,va))};u.projectMany=J;u.projectMultipoint=function(ma,qa,oa=qa.spatialReference,va=0){return z.isNone(oa)?!1:z.isSome(X(ma,
ma.spatialReference,qa,oa,va))};u.projectOrLoad=function(ma,qa){return z.isNone(ma)?{pending:null,geometry:null}:w.equals(ma.spatialReference,qa)?{pending:null,geometry:ma}:w.isValid(ma.spatialReference)&&w.isValid(qa)?M(ma.spatialReference,qa)?{pending:null,geometry:H(ma,qa)}:F()?{pending:null,geometry:H(ma,qa)}:(k.trackAccess(mb),{pending:G(),geometry:null}):{pending:null,geometry:null}};u.projectPoint=function(ma,qa,oa=qa.spatialReference,va=0){return z.isNone(oa)?!1:z.isSome(ba(ma,ma.spatialReference,
qa,oa,va))};u.projectPointToVector=function(ma,qa,oa,va=0){Ua[0]=ma.x;Ua[1]=ma.y;const Ia=ma.z;Ua[2]=void 0!==Ia?Ia:va;return pa(Ua,ma.spatialReference,0,qa,oa,0,1)};u.projectPointToWGS84ComparableLonLat=function(ma,qa){Ua[0]=ma.x;Ua[1]=ma.y;const oa=ma.z;Ua[2]=void 0!==oa?oa:0;return ta(Ua,ma.spatialReference,qa)};u.projectPolygon=function(ma,qa,oa=qa.spatialReference,va=0){return z.isSome(oa)&&z.isSome(W(ma,ma.spatialReference,qa,oa,va))};u.projectPolygonToWGS84ComparableLonLat=function({hasZ:ma,
spatialReference:qa,rings:oa},va,Ia=0){qa=la(qa,jb);qa=ib[qa][sa.WGS84_COMPARABLE_LON_LAT];if(z.isNone(qa))return!1;ma=ma?Ja=>Ja:Ja=>p.set(Ua,Ja[0],Ja[1],Ia);for(const Ja of oa){oa=[];for(const Oa of Ja){const Pa=[0,0,Ia];qa(ma(Oa),0,Pa,0);oa.push(Pa)}va.push(oa)}return!0};u.projectPolyline=function(ma,qa,oa=qa.spatialReference,va=0){return z.isSome(oa)&&z.isSome(S(ma,ma.spatialReference,qa,oa,va))};u.projectPolylineToWGS84ComparableLonLat=function({hasZ:ma,spatialReference:qa,paths:oa},va,Ia=0){qa=
la(qa,jb);qa=ib[qa][sa.WGS84_COMPARABLE_LON_LAT];if(z.isNone(qa))return!1;ma=ma?Ja=>Ja:Ja=>p.set(Ua,Ja[0],Ja[1],Ia);for(const Ja of oa){oa=[];for(const Oa of Ja){const Pa=[0,0,Ia];qa(ma(Oa),0,Pa,0);oa.push(Pa)}va.push(oa)}return!0};u.projectVectorToDehydratedPoint=function(ma,qa,oa){return pa(ma,qa,0,Ua,oa.spatialReference,0,1)?(oa.x=Ua[0],oa.y=Ua[1],oa.z=Ua[2],oa):null};u.projectVectorToPoint=function(ma,qa,oa){if(z.isNone(qa)||z.isNone(oa))return null;const va=new b({spatialReference:oa});return pa(ma,
qa,0,Ua,oa,0,1)?(va.x=Ua[0],va.y=Ua[1],va.z=Ua[2],va):null};u.projectVectorToVector=ka;u.projectVectorToWGS84ComparableLonLat=function(ma,qa,oa){return ta(ma,qa,oa)};u.projectWithoutEngine=P;u.projectXYZToVector=Z;u.sphericalPCPFtoLonLatElevation=ya;u.test={get loadPromise(){return db}};u.tryProjectWithZConversion=H;u.unload=function(){db=Xa=Na=null;hb={}};Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/chunks/mat4":function(){define(["exports","./vec3f64",
"./common"],function(r,u,E){function C(L,T){L[0]=T[0];L[1]=T[1];L[2]=T[2];L[3]=T[3];L[4]=T[4];L[5]=T[5];L[6]=T[6];L[7]=T[7];L[8]=T[8];L[9]=T[9];L[10]=T[10];L[11]=T[11];L[12]=T[12];L[13]=T[13];L[14]=T[14];L[15]=T[15];return L}function v(L,T,la,U,Q,da,ea,ja,ha,Y,ca,ia,ra,ua,za,Da,ya){L[0]=T;L[1]=la;L[2]=U;L[3]=Q;L[4]=da;L[5]=ea;L[6]=ja;L[7]=ha;L[8]=Y;L[9]=ca;L[10]=ia;L[11]=ra;L[12]=ua;L[13]=za;L[14]=Da;L[15]=ya;return L}function z(L){L[0]=1;L[1]=0;L[2]=0;L[3]=0;L[4]=0;L[5]=1;L[6]=0;L[7]=0;L[8]=0;L[9]=
0;L[10]=1;L[11]=0;L[12]=0;L[13]=0;L[14]=0;L[15]=1;return L}function x(L,T){if(L===T){const la=T[1],U=T[2],Q=T[3],da=T[6],ea=T[7],ja=T[11];L[1]=T[4];L[2]=T[8];L[3]=T[12];L[4]=la;L[6]=T[9];L[7]=T[13];L[8]=U;L[9]=da;L[11]=T[14];L[12]=Q;L[13]=ea;L[14]=ja}else L[0]=T[0],L[1]=T[4],L[2]=T[8],L[3]=T[12],L[4]=T[1],L[5]=T[5],L[6]=T[9],L[7]=T[13],L[8]=T[2],L[9]=T[6],L[10]=T[10],L[11]=T[14],L[12]=T[3],L[13]=T[7],L[14]=T[11],L[15]=T[15];return L}function f(L,T){const la=T[0],U=T[1],Q=T[2],da=T[3],ea=T[4],ja=T[5],
ha=T[6],Y=T[7],ca=T[8],ia=T[9],ra=T[10],ua=T[11],za=T[12],Da=T[13],ya=T[14];T=T[15];const Ga=la*ja-U*ea,Ha=la*ha-Q*ea,Fa=la*Y-da*ea,Ea=U*ha-Q*ja,Ka=U*Y-da*ja,Ma=Q*Y-da*ha,xa=ca*Da-ia*za,Qa=ca*ya-ra*za,Wa=ca*T-ua*za,Ra=ia*ya-ra*Da,O=ia*T-ua*Da,Va=ra*T-ua*ya;let Na=Ga*Va-Ha*O+Fa*Ra+Ea*Wa-Ka*Qa+Ma*xa;if(!Na)return null;Na=1/Na;L[0]=(ja*Va-ha*O+Y*Ra)*Na;L[1]=(Q*O-U*Va-da*Ra)*Na;L[2]=(Da*Ma-ya*Ka+T*Ea)*Na;L[3]=(ra*Ka-ia*Ma-ua*Ea)*Na;L[4]=(ha*Wa-ea*Va-Y*Qa)*Na;L[5]=(la*Va-Q*Wa+da*Qa)*Na;L[6]=(ya*Fa-za*
Ma-T*Ha)*Na;L[7]=(ca*Ma-ra*Fa+ua*Ha)*Na;L[8]=(ea*O-ja*Wa+Y*xa)*Na;L[9]=(U*Wa-la*O-da*xa)*Na;L[10]=(za*Ka-Da*Fa+T*Ga)*Na;L[11]=(ia*Fa-ca*Ka-ua*Ga)*Na;L[12]=(ja*Qa-ea*Ra-ha*xa)*Na;L[13]=(la*Ra-U*Qa+Q*xa)*Na;L[14]=(Da*Ha-za*Ea-ya*Ga)*Na;L[15]=(ca*Ea-ia*Ha+ra*Ga)*Na;return L}function k(L,T){const la=T[0],U=T[1],Q=T[2],da=T[3],ea=T[4],ja=T[5],ha=T[6],Y=T[7],ca=T[8],ia=T[9],ra=T[10],ua=T[11],za=T[12],Da=T[13],ya=T[14];T=T[15];L[0]=ja*(ra*T-ua*ya)-ia*(ha*T-Y*ya)+Da*(ha*ua-Y*ra);L[1]=-(U*(ra*T-ua*ya)-ia*
(Q*T-da*ya)+Da*(Q*ua-da*ra));L[2]=U*(ha*T-Y*ya)-ja*(Q*T-da*ya)+Da*(Q*Y-da*ha);L[3]=-(U*(ha*ua-Y*ra)-ja*(Q*ua-da*ra)+ia*(Q*Y-da*ha));L[4]=-(ea*(ra*T-ua*ya)-ca*(ha*T-Y*ya)+za*(ha*ua-Y*ra));L[5]=la*(ra*T-ua*ya)-ca*(Q*T-da*ya)+za*(Q*ua-da*ra);L[6]=-(la*(ha*T-Y*ya)-ea*(Q*T-da*ya)+za*(Q*Y-da*ha));L[7]=la*(ha*ua-Y*ra)-ea*(Q*ua-da*ra)+ca*(Q*Y-da*ha);L[8]=ea*(ia*T-ua*Da)-ca*(ja*T-Y*Da)+za*(ja*ua-Y*ia);L[9]=-(la*(ia*T-ua*Da)-ca*(U*T-da*Da)+za*(U*ua-da*ia));L[10]=la*(ja*T-Y*Da)-ea*(U*T-da*Da)+za*(U*Y-da*ja);
L[11]=-(la*(ja*ua-Y*ia)-ea*(U*ua-da*ia)+ca*(U*Y-da*ja));L[12]=-(ea*(ia*ya-ra*Da)-ca*(ja*ya-ha*Da)+za*(ja*ra-ha*ia));L[13]=la*(ia*ya-ra*Da)-ca*(U*ya-Q*Da)+za*(U*ra-Q*ia);L[14]=-(la*(ja*ya-ha*Da)-ea*(U*ya-Q*Da)+za*(U*ha-Q*ja));L[15]=la*(ja*ra-ha*ia)-ea*(U*ra-Q*ia)+ca*(U*ha-Q*ja);return L}function g(L){const T=L[0],la=L[1],U=L[2],Q=L[3],da=L[4],ea=L[5],ja=L[6],ha=L[7],Y=L[8],ca=L[9],ia=L[10],ra=L[11],ua=L[12],za=L[13],Da=L[14];L=L[15];return(T*ea-la*da)*(ia*L-ra*Da)-(T*ja-U*da)*(ca*L-ra*za)+(T*ha-Q*
da)*(ca*Da-ia*za)+(la*ja-U*ea)*(Y*L-ra*ua)-(la*ha-Q*ea)*(Y*Da-ia*ua)+(U*ha-Q*ja)*(Y*za-ca*ua)}function m(L,T,la){const U=T[0],Q=T[1],da=T[2],ea=T[3],ja=T[4],ha=T[5],Y=T[6],ca=T[7],ia=T[8],ra=T[9],ua=T[10],za=T[11],Da=T[12],ya=T[13],Ga=T[14];T=T[15];let Ha=la[0],Fa=la[1],Ea=la[2],Ka=la[3];L[0]=Ha*U+Fa*ja+Ea*ia+Ka*Da;L[1]=Ha*Q+Fa*ha+Ea*ra+Ka*ya;L[2]=Ha*da+Fa*Y+Ea*ua+Ka*Ga;L[3]=Ha*ea+Fa*ca+Ea*za+Ka*T;Ha=la[4];Fa=la[5];Ea=la[6];Ka=la[7];L[4]=Ha*U+Fa*ja+Ea*ia+Ka*Da;L[5]=Ha*Q+Fa*ha+Ea*ra+Ka*ya;L[6]=Ha*
da+Fa*Y+Ea*ua+Ka*Ga;L[7]=Ha*ea+Fa*ca+Ea*za+Ka*T;Ha=la[8];Fa=la[9];Ea=la[10];Ka=la[11];L[8]=Ha*U+Fa*ja+Ea*ia+Ka*Da;L[9]=Ha*Q+Fa*ha+Ea*ra+Ka*ya;L[10]=Ha*da+Fa*Y+Ea*ua+Ka*Ga;L[11]=Ha*ea+Fa*ca+Ea*za+Ka*T;Ha=la[12];Fa=la[13];Ea=la[14];Ka=la[15];L[12]=Ha*U+Fa*ja+Ea*ia+Ka*Da;L[13]=Ha*Q+Fa*ha+Ea*ra+Ka*ya;L[14]=Ha*da+Fa*Y+Ea*ua+Ka*Ga;L[15]=Ha*ea+Fa*ca+Ea*za+Ka*T;return L}function p(L,T,la){const U=la[0],Q=la[1];la=la[2];if(T===L)L[12]=T[0]*U+T[4]*Q+T[8]*la+T[12],L[13]=T[1]*U+T[5]*Q+T[9]*la+T[13],L[14]=T[2]*
U+T[6]*Q+T[10]*la+T[14],L[15]=T[3]*U+T[7]*Q+T[11]*la+T[15];else{const da=T[0],ea=T[1],ja=T[2],ha=T[3],Y=T[4],ca=T[5],ia=T[6],ra=T[7],ua=T[8],za=T[9],Da=T[10],ya=T[11];L[0]=da;L[1]=ea;L[2]=ja;L[3]=ha;L[4]=Y;L[5]=ca;L[6]=ia;L[7]=ra;L[8]=ua;L[9]=za;L[10]=Da;L[11]=ya;L[12]=da*U+Y*Q+ua*la+T[12];L[13]=ea*U+ca*Q+za*la+T[13];L[14]=ja*U+ia*Q+Da*la+T[14];L[15]=ha*U+ra*Q+ya*la+T[15]}return L}function t(L,T,la){const U=la[0],Q=la[1];la=la[2];L[0]=T[0]*U;L[1]=T[1]*U;L[2]=T[2]*U;L[3]=T[3]*U;L[4]=T[4]*Q;L[5]=T[5]*
Q;L[6]=T[6]*Q;L[7]=T[7]*Q;L[8]=T[8]*la;L[9]=T[9]*la;L[10]=T[10]*la;L[11]=T[11]*la;L[12]=T[12];L[13]=T[13];L[14]=T[14];L[15]=T[15];return L}function e(L,T,la,U){let Q=U[0],da=U[1];U=U[2];let ea=Math.sqrt(Q*Q+da*da+U*U);var ja=void 0,ha=void 0;let Y=void 0,ca=void 0,ia=void 0,ra=void 0,ua=void 0,za=void 0,Da=void 0,ya=void 0,Ga=void 0,Ha=void 0,Fa=void 0,Ea=void 0,Ka=void 0,Ma=void 0,xa=void 0,Qa=void 0,Wa=void 0,Ra=void 0,O=void 0,Va=void 0;ha=ja=void 0;if(ea<E.EPSILON)return null;ea=1/ea;Q*=ea;da*=
ea;U*=ea;ja=Math.sin(la);ha=Math.cos(la);Y=1-ha;ca=T[0];ia=T[1];ra=T[2];ua=T[3];za=T[4];Da=T[5];ya=T[6];Ga=T[7];Ha=T[8];Fa=T[9];Ea=T[10];Ka=T[11];Ma=Q*Q*Y+ha;xa=da*Q*Y+U*ja;Qa=U*Q*Y-da*ja;Wa=Q*da*Y-U*ja;Ra=da*da*Y+ha;O=U*da*Y+Q*ja;Va=Q*U*Y+da*ja;ja=da*U*Y-Q*ja;ha=U*U*Y+ha;L[0]=ca*Ma+za*xa+Ha*Qa;L[1]=ia*Ma+Da*xa+Fa*Qa;L[2]=ra*Ma+ya*xa+Ea*Qa;L[3]=ua*Ma+Ga*xa+Ka*Qa;L[4]=ca*Wa+za*Ra+Ha*O;L[5]=ia*Wa+Da*Ra+Fa*O;L[6]=ra*Wa+ya*Ra+Ea*O;L[7]=ua*Wa+Ga*Ra+Ka*O;L[8]=ca*Va+za*ja+Ha*ha;L[9]=ia*Va+Da*ja+Fa*ha;L[10]=
ra*Va+ya*ja+Ea*ha;L[11]=ua*Va+Ga*ja+Ka*ha;T!==L&&(L[12]=T[12],L[13]=T[13],L[14]=T[14],L[15]=T[15]);return L}function c(L,T,la){const U=Math.sin(la);la=Math.cos(la);const Q=T[4],da=T[5],ea=T[6],ja=T[7],ha=T[8],Y=T[9],ca=T[10],ia=T[11];T!==L&&(L[0]=T[0],L[1]=T[1],L[2]=T[2],L[3]=T[3],L[12]=T[12],L[13]=T[13],L[14]=T[14],L[15]=T[15]);L[4]=Q*la+ha*U;L[5]=da*la+Y*U;L[6]=ea*la+ca*U;L[7]=ja*la+ia*U;L[8]=ha*la-Q*U;L[9]=Y*la-da*U;L[10]=ca*la-ea*U;L[11]=ia*la-ja*U;return L}function a(L,T,la){const U=Math.sin(la);
la=Math.cos(la);const Q=T[0],da=T[1],ea=T[2],ja=T[3],ha=T[8],Y=T[9],ca=T[10],ia=T[11];T!==L&&(L[4]=T[4],L[5]=T[5],L[6]=T[6],L[7]=T[7],L[12]=T[12],L[13]=T[13],L[14]=T[14],L[15]=T[15]);L[0]=Q*la-ha*U;L[1]=da*la-Y*U;L[2]=ea*la-ca*U;L[3]=ja*la-ia*U;L[8]=Q*U+ha*la;L[9]=da*U+Y*la;L[10]=ea*U+ca*la;L[11]=ja*U+ia*la;return L}function b(L,T,la){const U=Math.sin(la);la=Math.cos(la);const Q=T[0],da=T[1],ea=T[2],ja=T[3],ha=T[4],Y=T[5],ca=T[6],ia=T[7];T!==L&&(L[8]=T[8],L[9]=T[9],L[10]=T[10],L[11]=T[11],L[12]=T[12],
L[13]=T[13],L[14]=T[14],L[15]=T[15]);L[0]=Q*la+ha*U;L[1]=da*la+Y*U;L[2]=ea*la+ca*U;L[3]=ja*la+ia*U;L[4]=ha*la-Q*U;L[5]=Y*la-da*U;L[6]=ca*la-ea*U;L[7]=ia*la-ja*U;return L}function h(L,T){L[0]=1;L[1]=0;L[2]=0;L[3]=0;L[4]=0;L[5]=1;L[6]=0;L[7]=0;L[8]=0;L[9]=0;L[10]=1;L[11]=0;L[12]=T[0];L[13]=T[1];L[14]=T[2];L[15]=1;return L}function l(L,T){L[0]=T[0];L[1]=0;L[2]=0;L[3]=0;L[4]=0;L[5]=T[1];L[6]=0;L[7]=0;L[8]=0;L[9]=0;L[10]=T[2];L[11]=0;L[12]=0;L[13]=0;L[14]=0;L[15]=1;return L}function d(L,T,la){let U=la[0],
Q=la[1];la=la[2];let da=Math.sqrt(U*U+Q*Q+la*la),ea=void 0,ja=void 0,ha=void 0;if(da<E.EPSILON)return null;da=1/da;U*=da;Q*=da;la*=da;ea=Math.sin(T);ja=Math.cos(T);ha=1-ja;L[0]=U*U*ha+ja;L[1]=Q*U*ha+la*ea;L[2]=la*U*ha-Q*ea;L[3]=0;L[4]=U*Q*ha-la*ea;L[5]=Q*Q*ha+ja;L[6]=la*Q*ha+U*ea;L[7]=0;L[8]=U*la*ha+Q*ea;L[9]=Q*la*ha-U*ea;L[10]=la*la*ha+ja;L[11]=0;L[12]=0;L[13]=0;L[14]=0;L[15]=1;return L}function q(L,T){const la=Math.sin(T);T=Math.cos(T);L[0]=1;L[1]=0;L[2]=0;L[3]=0;L[4]=0;L[5]=T;L[6]=la;L[7]=0;L[8]=
0;L[9]=-la;L[10]=T;L[11]=0;L[12]=0;L[13]=0;L[14]=0;L[15]=1;return L}function n(L,T){const la=Math.sin(T);T=Math.cos(T);L[0]=T;L[1]=0;L[2]=-la;L[3]=0;L[4]=0;L[5]=1;L[6]=0;L[7]=0;L[8]=la;L[9]=0;L[10]=T;L[11]=0;L[12]=0;L[13]=0;L[14]=0;L[15]=1;return L}function B(L,T){const la=Math.sin(T);T=Math.cos(T);L[0]=T;L[1]=la;L[2]=0;L[3]=0;L[4]=-la;L[5]=T;L[6]=0;L[7]=0;L[8]=0;L[9]=0;L[10]=1;L[11]=0;L[12]=0;L[13]=0;L[14]=0;L[15]=1;return L}function A(L,T,la){var U=T[0],Q=T[1],da=T[2],ea=T[3],ja=U+U,ha=Q+Q;const Y=
da+da;T=U*ja;const ca=U*ha;U*=Y;const ia=Q*ha;Q*=Y;da*=Y;ja*=ea;ha*=ea;ea*=Y;L[0]=1-(ia+da);L[1]=ca+ea;L[2]=U-ha;L[3]=0;L[4]=ca-ea;L[5]=1-(T+da);L[6]=Q+ja;L[7]=0;L[8]=U+ha;L[9]=Q-ja;L[10]=1-(T+ia);L[11]=0;L[12]=la[0];L[13]=la[1];L[14]=la[2];L[15]=1;return L}function w(L,T){const la=Ba,U=-T[0],Q=-T[1],da=-T[2],ea=T[3],ja=T[4],ha=T[5],Y=T[6],ca=T[7],ia=U*U+Q*Q+da*da+ea*ea;0<ia?(la[0]=2*(ja*ea+ca*U+ha*da-Y*Q)/ia,la[1]=2*(ha*ea+ca*Q+Y*U-ja*da)/ia,la[2]=2*(Y*ea+ca*da+ja*Q-ha*U)/ia):(la[0]=2*(ja*ea+ca*
U+ha*da-Y*Q),la[1]=2*(ha*ea+ca*Q+Y*U-ja*da),la[2]=2*(Y*ea+ca*da+ja*Q-ha*U));A(L,T,la);return L}function y(L,T){L[0]=T[12];L[1]=T[13];L[2]=T[14];return L}function D(L,T){const la=T[0],U=T[1],Q=T[2],da=T[4],ea=T[5],ja=T[6],ha=T[8],Y=T[9];T=T[10];L[0]=Math.sqrt(la*la+U*U+Q*Q);L[1]=Math.sqrt(da*da+ea*ea+ja*ja);L[2]=Math.sqrt(ha*ha+Y*Y+T*T);return L}function F(L,T){const la=T[0]+T[5]+T[10];let U=0;0<la?(U=2*Math.sqrt(la+1),L[3]=.25*U,L[0]=(T[6]-T[9])/U,L[1]=(T[8]-T[2])/U,L[2]=(T[1]-T[4])/U):T[0]>T[5]&&
T[0]>T[10]?(U=2*Math.sqrt(1+T[0]-T[5]-T[10]),L[3]=(T[6]-T[9])/U,L[0]=.25*U,L[1]=(T[1]+T[4])/U,L[2]=(T[8]+T[2])/U):T[5]>T[10]?(U=2*Math.sqrt(1+T[5]-T[0]-T[10]),L[3]=(T[8]-T[2])/U,L[0]=(T[1]+T[4])/U,L[1]=.25*U,L[2]=(T[6]+T[9])/U):(U=2*Math.sqrt(1+T[10]-T[0]-T[5]),L[3]=(T[1]-T[4])/U,L[0]=(T[8]+T[2])/U,L[1]=(T[6]+T[9])/U,L[2]=.25*U);return L}function G(L,T,la,U){var Q=T[0],da=T[1],ea=T[2],ja=T[3],ha=Q+Q,Y=da+da,ca=ea+ea;T=Q*ha;const ia=Q*Y;Q*=ca;const ra=da*Y;da*=ca;ea*=ca;ha*=ja;Y*=ja;ja*=ca;ca=U[0];
const ua=U[1];U=U[2];L[0]=(1-(ra+ea))*ca;L[1]=(ia+ja)*ca;L[2]=(Q-Y)*ca;L[3]=0;L[4]=(ia-ja)*ua;L[5]=(1-(T+ea))*ua;L[6]=(da+ha)*ua;L[7]=0;L[8]=(Q+Y)*U;L[9]=(da-ha)*U;L[10]=(1-(T+ra))*U;L[11]=0;L[12]=la[0];L[13]=la[1];L[14]=la[2];L[15]=1;return L}function K(L,T,la,U,Q){var da=T[0],ea=T[1],ja=T[2],ha=T[3],Y=da+da,ca=ea+ea,ia=ja+ja;T=da*Y;var ra=da*ca,ua=da*ia;da=ea*ca;ea*=ia;var za=ja*ia;ja=ha*Y;ca*=ha;const Da=ha*ia;var ya=U[0],Ga=U[1];ia=U[2];U=Q[0];ha=Q[1];Q=Q[2];Y=(1-(da+za))*ya;const Ha=(ra+Da)*
ya;ya*=ua-ca;ra=(ra-Da)*Ga;za=(1-(T+za))*Ga;Ga*=ea+ja;ua=(ua+ca)*ia;ea=(ea-ja)*ia;T=(1-(T+da))*ia;L[0]=Y;L[1]=Ha;L[2]=ya;L[3]=0;L[4]=ra;L[5]=za;L[6]=Ga;L[7]=0;L[8]=ua;L[9]=ea;L[10]=T;L[11]=0;L[12]=la[0]+U-(Y*U+ra*ha+ua*Q);L[13]=la[1]+ha-(Ha*U+za*ha+ea*Q);L[14]=la[2]+Q-(ya*U+Ga*ha+T*Q);L[15]=1;return L}function J(L,T){var la=T[0],U=T[1],Q=T[2];T=T[3];var da=la+la,ea=U+U;const ja=Q+Q;la*=da;const ha=U*da;U*=ea;const Y=Q*da,ca=Q*ea;Q*=ja;da*=T;ea*=T;T*=ja;L[0]=1-U-Q;L[1]=ha+T;L[2]=Y-ea;L[3]=0;L[4]=ha-
T;L[5]=1-la-Q;L[6]=ca+da;L[7]=0;L[8]=Y+ea;L[9]=ca-da;L[10]=1-la-U;L[11]=0;L[12]=0;L[13]=0;L[14]=0;L[15]=1;return L}function I(L,T,la,U,Q,da,ea){const ja=1/(la-T),ha=1/(Q-U),Y=1/(da-ea);L[0]=2*da*ja;L[1]=0;L[2]=0;L[3]=0;L[4]=0;L[5]=2*da*ha;L[6]=0;L[7]=0;L[8]=(la+T)*ja;L[9]=(Q+U)*ha;L[10]=(ea+da)*Y;L[11]=-1;L[12]=0;L[13]=0;L[14]=ea*da*2*Y;L[15]=0;return L}function H(L,T,la,U,Q){T=1/Math.tan(T/2);let da=void 0;L[0]=T/la;L[1]=0;L[2]=0;L[3]=0;L[4]=0;L[5]=T;L[6]=0;L[7]=0;L[8]=0;L[9]=0;L[11]=-1;L[12]=0;
L[13]=0;L[15]=0;null!=Q&&Infinity!==Q?(da=1/(U-Q),L[10]=(Q+U)*da,L[14]=2*Q*U*da):(L[10]=-1,L[14]=-2*U);return L}function M(L,T,la,U){const Q=Math.tan(T.upDegrees*Math.PI/180),da=Math.tan(T.downDegrees*Math.PI/180),ea=Math.tan(T.leftDegrees*Math.PI/180);T=Math.tan(T.rightDegrees*Math.PI/180);const ja=2/(ea+T),ha=2/(Q+da);L[0]=ja;L[1]=0;L[2]=0;L[3]=0;L[4]=0;L[5]=ha;L[6]=0;L[7]=0;L[8]=-((ea-T)*ja*.5);L[9]=(Q-da)*ha*.5;L[10]=U/(la-U);L[11]=-1;L[12]=0;L[13]=0;L[14]=U*la/(la-U);L[15]=0;return L}function N(L,
T,la,U,Q,da,ea){const ja=1/(T-la),ha=1/(U-Q),Y=1/(da-ea);L[0]=-2*ja;L[1]=0;L[2]=0;L[3]=0;L[4]=0;L[5]=-2*ha;L[6]=0;L[7]=0;L[8]=0;L[9]=0;L[10]=2*Y;L[11]=0;L[12]=(T+la)*ja;L[13]=(Q+U)*ha;L[14]=(ea+da)*Y;L[15]=1;return L}function P(L,T,la,U){let Q=void 0,da=void 0;var ea=void 0,ja=void 0;let ha=void 0,Y=void 0;var ca=void 0,ia=void 0;let ra=void 0,ua=void 0;const za=T[0],Da=T[1];T=T[2];ea=U[0];ja=U[1];U=U[2];ca=la[0];ia=la[1];la=la[2];if(Math.abs(za-ca)<E.EPSILON&&Math.abs(Da-ia)<E.EPSILON&&Math.abs(T-
la)<E.EPSILON)return z(L);ca=za-ca;ia=Da-ia;ra=T-la;ua=1/Math.sqrt(ca*ca+ia*ia+ra*ra);ca*=ua;ia*=ua;ra*=ua;Q=ja*ra-U*ia;da=U*ca-ea*ra;ea=ea*ia-ja*ca;(ua=Math.sqrt(Q*Q+da*da+ea*ea))?(ua=1/ua,Q*=ua,da*=ua,ea*=ua):ea=da=Q=0;ja=ia*ea-ra*da;ha=ra*Q-ca*ea;Y=ca*da-ia*Q;(ua=Math.sqrt(ja*ja+ha*ha+Y*Y))?(ua=1/ua,ja*=ua,ha*=ua,Y*=ua):Y=ha=ja=0;L[0]=Q;L[1]=ja;L[2]=ca;L[3]=0;L[4]=da;L[5]=ha;L[6]=ia;L[7]=0;L[8]=ea;L[9]=Y;L[10]=ra;L[11]=0;L[12]=-(Q*za+da*Da+ea*T);L[13]=-(ja*za+ha*Da+Y*T);L[14]=-(ca*za+ia*Da+ra*
T);L[15]=1;return L}function ba(L,T,la,U){const Q=T[0],da=T[1];T=T[2];var ea=U[0];const ja=U[1];var ha=U[2];U=Q-la[0];let Y=da-la[1];la=T-la[2];let ca=U*U+Y*Y+la*la;0<ca&&(ca=1/Math.sqrt(ca),U*=ca,Y*=ca,la*=ca);let ia=ja*la-ha*Y;ha=ha*U-ea*la;ea=ea*Y-ja*U;ca=ia*ia+ha*ha+ea*ea;0<ca&&(ca=1/Math.sqrt(ca),ia*=ca,ha*=ca,ea*=ca);L[0]=ia;L[1]=ha;L[2]=ea;L[3]=0;L[4]=Y*ea-la*ha;L[5]=la*ia-U*ea;L[6]=U*ha-Y*ia;L[7]=0;L[8]=U;L[9]=Y;L[10]=la;L[11]=0;L[12]=Q;L[13]=da;L[14]=T;L[15]=1;return L}function X(L){return"mat4("+
L[0]+", "+L[1]+", "+L[2]+", "+L[3]+", "+L[4]+", "+L[5]+", "+L[6]+", "+L[7]+", "+L[8]+", "+L[9]+", "+L[10]+", "+L[11]+", "+L[12]+", "+L[13]+", "+L[14]+", "+L[15]+")"}function S(L){return Math.sqrt(L[0]**2+L[1]**2+L[2]**2+L[3]**2+L[4]**2+L[5]**2+L[6]**2+L[7]**2+L[8]**2+L[9]**2+L[10]**2+L[11]**2+L[12]**2+L[13]**2+L[14]**2+L[15]**2)}function W(L,T,la){L[0]=T[0]+la[0];L[1]=T[1]+la[1];L[2]=T[2]+la[2];L[3]=T[3]+la[3];L[4]=T[4]+la[4];L[5]=T[5]+la[5];L[6]=T[6]+la[6];L[7]=T[7]+la[7];L[8]=T[8]+la[8];L[9]=T[9]+
la[9];L[10]=T[10]+la[10];L[11]=T[11]+la[11];L[12]=T[12]+la[12];L[13]=T[13]+la[13];L[14]=T[14]+la[14];L[15]=T[15]+la[15];return L}function R(L,T,la){L[0]=T[0]-la[0];L[1]=T[1]-la[1];L[2]=T[2]-la[2];L[3]=T[3]-la[3];L[4]=T[4]-la[4];L[5]=T[5]-la[5];L[6]=T[6]-la[6];L[7]=T[7]-la[7];L[8]=T[8]-la[8];L[9]=T[9]-la[9];L[10]=T[10]-la[10];L[11]=T[11]-la[11];L[12]=T[12]-la[12];L[13]=T[13]-la[13];L[14]=T[14]-la[14];L[15]=T[15]-la[15];return L}function Z(L,T,la){L[0]=T[0]*la;L[1]=T[1]*la;L[2]=T[2]*la;L[3]=T[3]*la;
L[4]=T[4]*la;L[5]=T[5]*la;L[6]=T[6]*la;L[7]=T[7]*la;L[8]=T[8]*la;L[9]=T[9]*la;L[10]=T[10]*la;L[11]=T[11]*la;L[12]=T[12]*la;L[13]=T[13]*la;L[14]=T[14]*la;L[15]=T[15]*la;return L}function ka(L,T,la,U){L[0]=T[0]+la[0]*U;L[1]=T[1]+la[1]*U;L[2]=T[2]+la[2]*U;L[3]=T[3]+la[3]*U;L[4]=T[4]+la[4]*U;L[5]=T[5]+la[5]*U;L[6]=T[6]+la[6]*U;L[7]=T[7]+la[7]*U;L[8]=T[8]+la[8]*U;L[9]=T[9]+la[9]*U;L[10]=T[10]+la[10]*U;L[11]=T[11]+la[11]*U;L[12]=T[12]+la[12]*U;L[13]=T[13]+la[13]*U;L[14]=T[14]+la[14]*U;L[15]=T[15]+la[15]*
U;return L}function ta(L,T){return L[0]===T[0]&&L[1]===T[1]&&L[2]===T[2]&&L[3]===T[3]&&L[4]===T[4]&&L[5]===T[5]&&L[6]===T[6]&&L[7]===T[7]&&L[8]===T[8]&&L[9]===T[9]&&L[10]===T[10]&&L[11]===T[11]&&L[12]===T[12]&&L[13]===T[13]&&L[14]===T[14]&&L[15]===T[15]}function pa(L,T){if(L===T)return!0;const la=L[0],U=L[1],Q=L[2],da=L[3],ea=L[4],ja=L[5],ha=L[6],Y=L[7],ca=L[8],ia=L[9],ra=L[10],ua=L[11],za=L[12],Da=L[13],ya=L[14];L=L[15];const Ga=T[0],Ha=T[1],Fa=T[2],Ea=T[3],Ka=T[4],Ma=T[5],xa=T[6],Qa=T[7],Wa=T[8],
Ra=T[9],O=T[10],Va=T[11],Na=T[12],Xa=T[13],db=T[14];T=T[15];return Math.abs(la-Ga)<=E.EPSILON*Math.max(1,Math.abs(la),Math.abs(Ga))&&Math.abs(U-Ha)<=E.EPSILON*Math.max(1,Math.abs(U),Math.abs(Ha))&&Math.abs(Q-Fa)<=E.EPSILON*Math.max(1,Math.abs(Q),Math.abs(Fa))&&Math.abs(da-Ea)<=E.EPSILON*Math.max(1,Math.abs(da),Math.abs(Ea))&&Math.abs(ea-Ka)<=E.EPSILON*Math.max(1,Math.abs(ea),Math.abs(Ka))&&Math.abs(ja-Ma)<=E.EPSILON*Math.max(1,Math.abs(ja),Math.abs(Ma))&&Math.abs(ha-xa)<=E.EPSILON*Math.max(1,Math.abs(ha),
Math.abs(xa))&&Math.abs(Y-Qa)<=E.EPSILON*Math.max(1,Math.abs(Y),Math.abs(Qa))&&Math.abs(ca-Wa)<=E.EPSILON*Math.max(1,Math.abs(ca),Math.abs(Wa))&&Math.abs(ia-Ra)<=E.EPSILON*Math.max(1,Math.abs(ia),Math.abs(Ra))&&Math.abs(ra-O)<=E.EPSILON*Math.max(1,Math.abs(ra),Math.abs(O))&&Math.abs(ua-Va)<=E.EPSILON*Math.max(1,Math.abs(ua),Math.abs(Va))&&Math.abs(za-Na)<=E.EPSILON*Math.max(1,Math.abs(za),Math.abs(Na))&&Math.abs(Da-Xa)<=E.EPSILON*Math.max(1,Math.abs(Da),Math.abs(Xa))&&Math.abs(ya-db)<=E.EPSILON*Math.max(1,
Math.abs(ya),Math.abs(db))&&Math.abs(L-T)<=E.EPSILON*Math.max(1,Math.abs(L),Math.abs(T))}function wa(L){const T=E.EPSILON,la=L[0],U=L[1],Q=L[2],da=L[4],ea=L[5],ja=L[6],ha=L[8],Y=L[9];L=L[10];return Math.abs(1-(la*la+da*da+ha*ha))<=T&&Math.abs(1-(U*U+ea*ea+Y*Y))<=T&&Math.abs(1-(Q*Q+ja*ja+L*L))<=T}const Ba=u.create();u=Object.freeze(Object.defineProperty({__proto__:null,copy:C,set:v,identity:z,transpose:x,invert:f,adjoint:k,determinant:g,multiply:m,translate:p,scale:t,rotate:e,rotateX:c,rotateY:a,rotateZ:b,
fromTranslation:h,fromScaling:l,fromRotation:d,fromXRotation:q,fromYRotation:n,fromZRotation:B,fromRotationTranslation:A,fromQuat2:w,getTranslation:y,getScaling:D,getRotation:F,fromRotationTranslationScale:G,fromRotationTranslationScaleOrigin:K,fromQuat:J,frustum:I,perspective:H,perspectiveFromFieldOfView:M,ortho:N,lookAt:P,targetTo:ba,str:X,frob:S,add:W,subtract:R,multiplyScalar:Z,multiplyScalarAndAdd:ka,exactEquals:ta,equals:pa,isOrthoNormal:wa,mul:m,sub:R},Symbol.toStringTag,{value:"Module"}));
r.add=W;r.adjoint=k;r.copy=C;r.determinant=g;r.equals=pa;r.exactEquals=ta;r.frob=S;r.fromQuat=J;r.fromQuat2=w;r.fromRotation=d;r.fromRotationTranslation=A;r.fromRotationTranslationScale=G;r.fromRotationTranslationScaleOrigin=K;r.fromScaling=l;r.fromTranslation=h;r.fromXRotation=q;r.fromYRotation=n;r.fromZRotation=B;r.frustum=I;r.getRotation=F;r.getScaling=D;r.getTranslation=y;r.identity=z;r.invert=f;r.isOrthoNormal=wa;r.lookAt=P;r.mat4=u;r.mul=m;r.multiply=m;r.multiplyScalar=Z;r.multiplyScalarAndAdd=
ka;r.ortho=N;r.perspective=H;r.perspectiveFromFieldOfView=M;r.rotate=e;r.rotateX=c;r.rotateY=a;r.rotateZ=b;r.scale=t;r.set=v;r.str=X;r.sub=R;r.subtract=R;r.targetTo=ba;r.translate=p;r.transpose=x})},"esri/chunks/pe":function(){define(["require","exports","./_rollupPluginBabelHelpers","../assets","../core/has"],function(r,u,E,C,v){function z(){return!!u._pe}function x(){return!!v("esri-wasm")}function f(){return e?e:e=(new Promise((a,b)=>r(["./pe-wasm"],a,b))).then(a=>a.peWasm).then(({default:a})=>
a({locateFile:b=>C.getAssetUrl(`esri/geometry/support/${b}`)})).then(a=>{k(a)})}function k(a){function b(d,q,n){d[q]=n(d[q])}u._pe=a;u.PeDefs.init();u.PeGTlistExtended.init();u.PeNotationMgrs.init();u.PeNotationUtm.init();u.PePCSInfo.init();u.PeGCSExtent=function(d){function q(){return d.apply(this,arguments)||this}E._inheritsLoose(q,d);q.prototype.destroy=function(){u._pe.destroy(this)};return q}(u._pe.PeGCSExtent);a=[u._pe.PeDatum,u._pe.PeGeogcs,u._pe.PeGeogtran,u._pe.PeObject,u._pe.PeParameter,
u._pe.PePrimem,u._pe.PeProjcs,u._pe.PeSpheroid,u._pe.PeUnit];for(var h of a)b(h.prototype,"getName",d=>function(){return d.call(this,Array(u.PeDefs.PE_NAME_MAX))});for(const d of[u._pe.PeGeogtran,u._pe.PeProjcs])b(d.prototype,"getParameters",q=>function(){const n=Array(u.PeDefs.PE_PARM_MAX);let B=q.call(this);for(let A=0;A<n.length;A++){const w=u._pe.getValue(B,"*");n[A]=w?u._pe.wrapPointer(w,u._pe.PeParameter):null;B+=Int32Array.BYTES_PER_ELEMENT}return n});b(u._pe.PeHorizon.prototype,"getCoord",
d=>function(){const q=this.getSize();if(!q)return null;const n=[],B=d.call(this);t(n,q,B);return n});b(u._pe.PeGTlistExtendedEntry.prototype,"getEntries",d=>{const q=u._pe._pe_getPeGTlistExtendedGTsSize();return function(){let n=null;var B=d.call(this);if(!u._pe.compare(B,u._pe.NULL)){n=[B];const A=this.getSteps();if(1<A){B=u._pe.getPointer(B);for(let w=1;w<A;w++)n.push(u._pe.wrapPointer(B+q*w,u._pe.PeGTlistExtendedGTs))}}return n}});const l=u._pe._pe_getPeHorizonSize();h=d=>function(){let q=this._cache;
q||(this._cache=q=new Map);if(q.has(d))return q.get(d);let n=null;var B=d.call(this);if(!u._pe.compare(B,u._pe.NULL)){n=[B];const A=B.getNump();if(1<A){B=u._pe.getPointer(B);for(let w=1;w<A;w++)n.push(u._pe.wrapPointer(B+l*w,u._pe.PeHorizon))}}q.set(d,n);return n};b(u._pe.PeProjcs.prototype,"horizonGcsGenerate",h);b(u._pe.PeProjcs.prototype,"horizonPcsGenerate",h);u._pe.PeObject.prototype.toString=function(d=u.PeDefs.PE_STR_OPTS_NONE){u._pe.ensureCache.prepare();const q=u._pe.getPointer(this),n=u._pe.ensureInt8(Array(u.PeDefs.PE_BUFFER_MAX));
return u._pe.UTF8ToString(u._pe._pe_object_to_string_ext(q,d,n))}}function g(a){if(a){var b=u._pe.getClass(a);b&&(b=u._pe.getCache(b))&&(a=u._pe.getPointer(a))&&delete b[a]}}function m(a,b){const h=[];b=Array(b);for(let l=0;l<a;l++)h.push(u._pe.ensureInt8(b));return h}function p(a){let b;Array.isArray(a[0])?(b=[],a.forEach(h=>{b.push(h[0],h[1])})):b=a;return b}function t(a,b,h,l=!1){if(l)for(l=0;l<2*b;l++)a[l]=u._pe.getValue(h+l*Float64Array.BYTES_PER_ELEMENT,"double");else{l=0===a.length;for(let d=
0;d<b;d++)l&&(a[d]=Array(2)),a[d][0]=u._pe.getValue(h,"double"),a[d][1]=u._pe.getValue(h+Float64Array.BYTES_PER_ELEMENT,"double"),h+=2*Float64Array.BYTES_PER_ELEMENT}}let e;u._pe=null;u.PeCSTransformations=void 0;(function(a){function b(d,q,n){u._pe.ensureCache.prepare();var B=p(n);const A=n===B;B=u._pe.ensureFloat64(B);(d=u._pe._pe_geog_to_proj(u._pe.getPointer(d),q,B))&&t(n,q,B,A);return d}function h(d,q,n){return l(d,q,n,0)}function l(d,q,n,B){u._pe.ensureCache.prepare();var A=p(n);const w=n===
A;A=u._pe.ensureFloat64(A);(d=u._pe._pe_proj_to_geog_center(u._pe.getPointer(d),q,A,B))&&t(n,q,A,w);return d}a.geogToProj=b;a.projGeog=function(d,q,n,B){switch(B){case u.PeDefs.PE_TRANSFORM_P_TO_G:return h(d,q,n);case u.PeDefs.PE_TRANSFORM_G_TO_P:return b(d,q,n)}return 0};a.projToGeog=h;a.projToGeogCenter=l})(u.PeCSTransformations||(u.PeCSTransformations={}));u.PeDefs=void 0;(function(a){a.init=function(){a.PE_BUFFER_MAX=u._pe.PeDefs.prototype.PE_BUFFER_MAX;a.PE_NAME_MAX=u._pe.PeDefs.prototype.PE_NAME_MAX;
a.PE_MGRS_MAX=u._pe.PeDefs.prototype.PE_MGRS_MAX;a.PE_USNG_MAX=u._pe.PeDefs.prototype.PE_USNG_MAX;a.PE_DD_MAX=u._pe.PeDefs.prototype.PE_DD_MAX;a.PE_DDM_MAX=u._pe.PeDefs.prototype.PE_DDM_MAX;a.PE_DMS_MAX=u._pe.PeDefs.prototype.PE_DMS_MAX;a.PE_UTM_MAX=u._pe.PeDefs.prototype.PE_UTM_MAX;a.PE_PARM_MAX=u._pe.PeDefs.prototype.PE_PARM_MAX;a.PE_TYPE_NONE=u._pe.PeDefs.prototype.PE_TYPE_NONE;a.PE_TYPE_GEOGCS=u._pe.PeDefs.prototype.PE_TYPE_GEOGCS;a.PE_TYPE_PROJCS=u._pe.PeDefs.prototype.PE_TYPE_PROJCS;a.PE_TYPE_GEOGTRAN=
u._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;a.PE_TYPE_COORDSYS=u._pe.PeDefs.prototype.PE_TYPE_COORDSYS;a.PE_TYPE_UNIT=u._pe.PeDefs.prototype.PE_TYPE_UNIT;a.PE_TYPE_LINUNIT=u._pe.PeDefs.prototype.PE_TYPE_LINUNIT;a.PE_STR_OPTS_NONE=u._pe.PeDefs.prototype.PE_STR_OPTS_NONE;a.PE_STR_AUTH_NONE=u._pe.PeDefs.prototype.PE_STR_AUTH_NONE;a.PE_STR_AUTH_TOP=u._pe.PeDefs.prototype.PE_STR_AUTH_TOP;a.PE_STR_NAME_CANON=u._pe.PeDefs.prototype.PE_STR_NAME_CANON;a.PE_PARM_X0=u._pe.PeDefs.prototype.PE_PARM_X0;a.PE_PARM_ND=
u._pe.PeDefs.prototype.PE_PARM_ND;a.PE_TRANSFORM_1_TO_2=u._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;a.PE_TRANSFORM_2_TO_1=u._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;a.PE_TRANSFORM_P_TO_G=u._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;a.PE_TRANSFORM_G_TO_P=u._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;a.PE_HORIZON_RECT=u._pe.PeDefs.prototype.PE_HORIZON_RECT;a.PE_HORIZON_POLY=u._pe.PeDefs.prototype.PE_HORIZON_POLY;a.PE_HORIZON_LINE=u._pe.PeDefs.prototype.PE_HORIZON_LINE;a.PE_HORIZON_DELTA=u._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(u.PeDefs||
(u.PeDefs={}));u.PeFactory=void 0;(function(a){function b(q,n){let B=null,A=h[q];A||(A={},h[q]=A);A.hasOwnProperty(String(n))?B=A[n]:(q=u._pe.PeFactory.prototype.factoryByType(q,n),u._pe.compare(q,u._pe.NULL)||(B=q,A[n]=B));return B=d(B)}const h={},l={},d=q=>{if(q){const n=q.getType();switch(n){case u.PeDefs.PE_TYPE_GEOGCS:q=u._pe.castObject(q,u._pe.PeGeogcs);break;case u.PeDefs.PE_TYPE_PROJCS:q=u._pe.castObject(q,u._pe.PeProjcs);break;case u.PeDefs.PE_TYPE_GEOGTRAN:q=u._pe.castObject(q,u._pe.PeGeogtran);
break;default:n&u.PeDefs.PE_TYPE_UNIT&&(q=u._pe.castObject(q,u._pe.PeUnit))}}return q};a.initialize=function(){u._pe.PeFactory.prototype.initialize(null)};a.coordsys=function(q){return b(u.PeDefs.PE_TYPE_COORDSYS,q)};a.factoryByType=b;a.fromString=function(q,n){let B=null,A=l[q];A||(A={},l[q]=A);A.hasOwnProperty(n)?B=A[n]:(q=u._pe.PeFactory.prototype.fromString(q,n),u._pe.compare(q,u._pe.NULL)||(B=q,A[n]=B));return B=d(B)};a.geogcs=function(q){return b(u.PeDefs.PE_TYPE_GEOGCS,q)};a.geogtran=function(q){return b(u.PeDefs.PE_TYPE_GEOGTRAN,
q)};a.getCode=function(q){return u._pe.PeFactory.prototype.getCode(q)};a.projcs=function(q){return b(u.PeDefs.PE_TYPE_PROJCS,q)};a.unit=function(q){return b(u.PeDefs.PE_TYPE_UNIT,q)}})(u.PeFactory||(u.PeFactory={}));u.PeGCSExtent=null;u.PeGTlistExtended=void 0;(function(a){let b;a.init=function(){a.PE_GTLIST_OPTS_COMMON=u._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;b=u._pe._pe_getPeGTlistExtendedEntrySize()};a.getGTlist=function(h,l,d,q,n,B){let A=null;const w=new u._pe.PeInteger(B);try{const y=
u._pe.PeGTlistExtended.prototype.getGTlist(h,l,d,q,n,w);if(B=w.val)if(A=[y],1<B){const D=u._pe.getPointer(y);for(h=1;h<B;h++)A.push(u._pe.wrapPointer(D+b*h,u._pe.PeGTlistExtendedEntry))}}finally{u._pe.destroy(w)}return A}})(u.PeGTlistExtended||(u.PeGTlistExtended={}));u.PeGTlistExtendedEntry=void 0;(function(a){a.destroy=function(b){if(b&&b.length){for(const h of b)g(h),h.getEntries().forEach(l=>{g(l);l=l.getGeogtran();g(l);l.getParameters().forEach(g);[l.getGeogcs1(),l.getGeogcs2()].forEach(d=>{g(d);
const q=d.getDatum();g(q);g(q.getSpheroid());g(d.getPrimem());g(d.getUnit())})});u._pe.PeGTlistExtendedEntry.prototype.Delete(b[0])}}})(u.PeGTlistExtendedEntry||(u.PeGTlistExtendedEntry={}));u.PeGTTransformations=void 0;(function(a){a.geogToGeog=function(b,h,l,d,q){u._pe.ensureCache.prepare();var n=p(l);const B=l===n;n=u._pe.ensureFloat64(n);let A=0;d&&(A=u._pe.ensureFloat64(d));(b=u._pe._pe_geog_to_geog(u._pe.getPointer(b),h,n,A,q))&&t(l,h,n,B);return b}})(u.PeGTTransformations||(u.PeGTTransformations=
{}));u.PeNotationDms=void 0;(function(a){const b=(l,d,q,n,B,A)=>{u._pe.ensureCache.prepare();switch(l){case "dd":var w=u._pe._pe_geog_to_dd;var y=u.PeDefs.PE_DD_MAX;break;case "ddm":w=u._pe._pe_geog_to_ddm;y=u.PeDefs.PE_DDM_MAX;break;case "dms":w=u._pe._pe_geog_to_dms,y=u.PeDefs.PE_DMS_MAX}l=0;d&&(l=u._pe.getPointer(d));d=p(n);d=u._pe.ensureFloat64(d);y=m(q,y);n=u._pe.ensureInt32(y);if(B=w(l,q,d,B,n))for(w=0;w<q;w++)A[w]=u._pe.UTF8ToString(y[w]);return B},h=(l,d,q,n,B)=>{u._pe.ensureCache.prepare();
switch(l){case "dd":var A=u._pe._pe_dd_to_geog;break;case "ddm":A=u._pe._pe_ddm_to_geog;break;case "dms":A=u._pe._pe_dms_to_geog}l=0;d&&(l=u._pe.getPointer(d));d=n.map(w=>u._pe.ensureString(w));n=u._pe.ensureInt32(d);d=u._pe.ensureFloat64(Array(2*q));(A=A(l,q,n,d))&&t(B,q,d);return A};a.geogToDms=function(l,d,q,n,B){return b("dms",l,d,q,n,B)};a.dmsToGeog=function(l,d,q,n){return h("dms",l,d,q,n)};a.geogToDdm=function(l,d,q,n,B){return b("ddm",l,d,q,n,B)};a.ddmToGeog=function(l,d,q,n){return h("ddm",
l,d,q,n)};a.geogToDd=function(l,d,q,n,B){return b("dd",l,d,q,n,B)};a.ddToGeog=function(l,d,q,n){return h("dd",l,d,q,n)}})(u.PeNotationDms||(u.PeNotationDms={}));u.PeNotationMgrs=void 0;(function(a){a.init=function(){a.PE_MGRS_STYLE_NEW=u._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;a.PE_MGRS_STYLE_OLD=u._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;a.PE_MGRS_STYLE_AUTO=u._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;a.PE_MGRS_180_ZONE_1_PLUS=u._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;
a.PE_MGRS_ADD_SPACES=u._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};a.geogToMgrsExtended=function(b,h,l,d,q,n,B){u._pe.ensureCache.prepare();let A=0;b&&(A=u._pe.getPointer(b));b=p(l);l=u._pe.ensureFloat64(b);b=m(h,u.PeDefs.PE_MGRS_MAX);const w=u._pe.ensureInt32(b);if(d=u._pe._pe_geog_to_mgrs_extended(A,h,l,d,q,n,w))for(q=0;q<h;q++)B[q]=u._pe.UTF8ToString(b[q]);return d};a.mgrsToGeogExtended=function(b,h,l,d,q){u._pe.ensureCache.prepare();let n=0;b&&(n=u._pe.getPointer(b));b=l.map(B=>u._pe.ensureString(B));
l=u._pe.ensureInt32(b);b=u._pe.ensureFloat64(Array(2*h));(d=u._pe._pe_mgrs_to_geog_extended(n,h,l,d,b))&&t(q,h,b);return d}})(u.PeNotationMgrs||(u.PeNotationMgrs={}));u.PeNotationUsng=void 0;(function(a){a.geogToUsng=function(b,h,l,d,q,n,B){u._pe.ensureCache.prepare();let A=0;b&&(A=u._pe.getPointer(b));b=p(l);l=u._pe.ensureFloat64(b);b=m(h,u.PeDefs.PE_MGRS_MAX);const w=u._pe.ensureInt32(b);if(d=u._pe._pe_geog_to_usng(A,h,l,d,q,n,w))for(q=0;q<h;q++)B[q]=u._pe.UTF8ToString(b[q]);return d};a.usngToGeog=
function(b,h,l,d){u._pe.ensureCache.prepare();var q=0;b&&(q=u._pe.getPointer(b));b=l.map(n=>u._pe.ensureString(n));l=u._pe.ensureInt32(b);b=u._pe.ensureFloat64(Array(2*h));(q=u._pe._pe_usng_to_geog(q,h,l,b))&&t(d,h,b);return q}})(u.PeNotationUsng||(u.PeNotationUsng={}));u.PeNotationUtm=void 0;(function(a){a.init=function(){a.PE_UTM_OPTS_NONE=u._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;a.PE_UTM_OPTS_ADD_SPACES=u._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;a.PE_UTM_OPTS_NS=u._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};
a.geogToUtm=function(b,h,l,d,q){u._pe.ensureCache.prepare();var n=0;b&&(n=u._pe.getPointer(b));b=p(l);l=u._pe.ensureFloat64(b);b=m(h,u.PeDefs.PE_UTM_MAX);const B=u._pe.ensureInt32(b);if(d=u._pe._pe_geog_to_utm(n,h,l,d,B))for(n=0;n<h;n++)q[n]=u._pe.UTF8ToString(b[n]);return d};a.utmToGeog=function(b,h,l,d,q){u._pe.ensureCache.prepare();let n=0;b&&(n=u._pe.getPointer(b));b=l.map(B=>u._pe.ensureString(B));l=u._pe.ensureInt32(b);b=u._pe.ensureFloat64(Array(2*h));(d=u._pe._pe_utm_to_geog(n,h,l,d,b))&&
t(q,h,b);return d}})(u.PeNotationUtm||(u.PeNotationUtm={}));u.PePCSInfo=void 0;(function(a){const b=new Map;a.init=function(){a.PE_PCSINFO_OPTION_NONE=u._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;a.PE_PCSINFO_OPTION_DOMAIN=u._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;a.PE_POLE_OUTSIDE_BOUNDARY=u._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;a.PE_POLE_POINT=u._pe.PePCSInfo.prototype.PE_POLE_POINT};a.generate=function(h,l=a.PE_PCSINFO_OPTION_DOMAIN){let d,q;b.has(h)&&(q=b.get(h),q[l]&&
(d=q[l]));d||(d=u._pe.PePCSInfo.prototype.generate(h,l),q||(q=[],b.set(h,q)),q[l]=d);return d}})(u.PePCSInfo||(u.PePCSInfo={}));u.PeVersion=void 0;(function(a){a.versionString=function(){return u._pe.PeVersion.prototype.version_string()}})(u.PeVersion||(u.PeVersion={}));const c=Object.freeze(Object.defineProperty({__proto__:null,get _pe(){return u._pe},isLoaded:z,isSupported:x,load:f,get PeCSTransformations(){return u.PeCSTransformations},get PeDefs(){return u.PeDefs},get PeFactory(){return u.PeFactory},
get PeGCSExtent(){return u.PeGCSExtent},get PeGTlistExtended(){return u.PeGTlistExtended},get PeGTlistExtendedEntry(){return u.PeGTlistExtendedEntry},get PeGTTransformations(){return u.PeGTTransformations},get PeNotationDms(){return u.PeNotationDms},get PeNotationMgrs(){return u.PeNotationMgrs},get PeNotationUsng(){return u.PeNotationUsng},get PeNotationUtm(){return u.PeNotationUtm},get PePCSInfo(){return u.PePCSInfo},get PeVersion(){return u.PeVersion},_init:k},Symbol.toStringTag,{value:"Module"}));
u._init=k;u.isLoaded=z;u.isSupported=x;u.load=f;u.pe=c})},"esri/geometry/support/geodesicConstants":function(){define(["exports","./Ellipsoid"],function(r,u){const E=Math.PI/180;var C=u.earth.radius;const v=u.earth.eccentricitySquared;C={a1:C*v,a2:C*v*C*v,a3:C*v*v/2,a4:C*v*C*v*2.5,a5:C*v+C*v*v/2,a6:1-v};u={4267:{a:6378206.4,f:1/294.9786982},4269:{a:6378137,f:1/298.257222101},4326:{a:u.earth.radius,f:u.earth.flattening},104900:{a:2439700,f:0},104901:{a:6051E3,f:0},104902:{a:6051800,f:0},104903:{a:u.moon.radius,
f:u.moon.flattening},104904:{a:3393400,f:.005207166853303471},104905:{a:u.mars.radius,f:u.mars.flattening},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492E3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1E4,f:0},104912:{a:2409300,f:0},104913:{a:15E3,f:0},104914:{a:4E4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85E3,f:0},104918:{a:1821460,f:0},104919:{a:5E3,f:0},104920:{a:12E3,f:0},104921:{a:3E4,f:3},104922:{a:18E3,f:0},104923:{a:14E3,f:0},104924:{a:49300,
f:0},104925:{a:60268E3,f:.09796243445941462},104926:{a:16E3,f:0},104927:{a:9500,f:0},104928:{a:56E4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16E3,f:0},104932:{a:133E3,f:0},104933:{a:718E3,f:0},104934:{a:888E3,f:0},104935:{a:1986300,f:0},104936:{a:1E4,f:0},104937:{a:41900,f:0},104938:{a:11E4,f:0},104939:{a:50100,f:0},104940:{a:764E3,f:0},104941:{a:11E3,f:0},104942:{a:529800,f:0},104943:{a:2575E3,f:0},104944:{a:25559E3,f:.022927344575296365},104945:{a:578900,f:0},104946:{a:33E3,f:0},
104947:{a:21E3,f:0},104948:{a:13E3,f:0},104949:{a:31E3,f:0},104950:{a:27E3,f:0},104951:{a:42E3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15E3,f:0},104955:{a:54E3,f:0},104956:{a:77E3,f:0},104957:{a:27E3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764E3,f:.01708124697141011},104961:{a:74E3,f:0},104962:{a:79E3,f:0},104963:{a:104E3,f:.14423076923076922},104964:{a:29E3,f:0},104965:{a:17E4,f:0},104966:{a:208E3,f:0},104967:{a:4E4,f:0},104968:{a:1352600,f:0},104969:{a:1195E3,
f:0},104970:{a:593E3,f:0},104971:{a:u.mars.radius,f:0},104972:{a:47E4,f:0},104973:{a:255E3,f:0},104974:{a:2439400,f:0}};r.WKT_SPHEROID_REGEX=/SPHEROID\[([^\]]+)]/i;r.earthEllipsoidConstants=C;r.spheroids=u;r.toRadians=E;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/support/GeographicTransformation":function(){define(["./GeographicTransformationStep"],function(r){return function(){function u(C){this.steps=[];this._cached_projection={};this._chain=
"";this._gtlistentry=null;if(C&&C.steps)for(const v of C.steps)v instanceof r?this.steps.push(v):this.steps.push(new r({wkid:v.wkid,wkt:v.wkt,isInverse:v.isInverse}))}u.cacheKey=function(C,v){return[void 0!==C.wkid&&null!==C.wkid?C.wkid.toString():"-1",void 0!==C.wkt&&null!==C.wkt?C.wkt.toString():"",void 0!==v.wkid&&null!==v.wkid?v.wkid.toString():"-1",void 0!==v.wkt&&null!==v.wkt?v.wkt.toString():""].join()};u.fromGE=function(C){const v=new u;let z="";for(const x of C.steps)C=r.fromGE(x),v.steps.push(C),
z+=C.uid.toString()+",";v._cached_projection={};v._gtlistentry=null;v._chain=z;return v};var E=u.prototype;E.getInverse=function(){const C=new u;C.steps=[];for(let v=this.steps.length-1;0<=v;v--)C.steps.push(this.steps[v].getInverse());return C};E.getGTListEntry=function(){let C="";for(const v of this.steps)C+=v.uid.toString()+",";C!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=C);return this._gtlistentry};E.assignCachedGe=function(C,v,z){this._cached_projection[u.cacheKey(C,
v)]=z};E.getCachedGeTransformation=function(C,v){let z="";for(const x of this.steps)z+=x.uid.toString()+",";z!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=z);C=this._cached_projection[u.cacheKey(C,v)];return void 0===C?null:C};return u}()})},"esri/geometry/support/GeographicTransformationStep":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(r){let u=0;return function(){function E(C=null){this.uid=u++;C?(this._wkt=void 0!==C.wkt?C.wkt:null,this._wkid=
void 0!==C.wkid?C.wkid:-1,this._isInverse=void 0!==C.isInverse?!0===C.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}E.fromGE=function(C){const v=new E;v._wkt=C.wkt;v._wkid=C.wkid;v._isInverse=C.isInverse;return v};E.prototype.getInverse=function(){const C=new E;C._wkt=this.wkt;C._wkid=this._wkid;C._isInverse=!this.isInverse;return C};r._createClass(E,[{key:"wkt",get:function(){return this._wkt},set:function(C){this._wkt=C;this.uid=u++}},{key:"wkid",get:function(){return this._wkid},
set:function(C){this._wkid=C;this.uid=u++}},{key:"isInverse",get:function(){return this._isInverse},set:function(C){this._isInverse=C;this.uid=u++}}]);return E}()})},"esri/geometry/support/zscale":function(){define(["exports","../../core/maybe","../../core/unitUtils","./spatialReferenceUtils"],function(r,u,E,C){r.getGeometryZScaler=function(v,z,x){if(u.isNone(z)||u.isNone(x)||x.vcsWkid||C.equals(z,x))return null;z=E.getMetersPerVerticalUnitForSR(z);x=E.getMetersPerVerticalUnitForSR(x);const f=z/x;
if(1===f)return null;switch(v){case "point":case "esriGeometryPoint":return k=>{k&&null!=k.z&&(k.z*=f)};case "polyline":case "esriGeometryPolyline":return k=>{if(k)for(const g of k.paths)for(const m of g)2<m.length&&(m[2]*=f)};case "polygon":case "esriGeometryPolygon":return k=>{if(k)for(const g of k.rings)for(const m of g)2<m.length&&(m[2]*=f)};case "multipoint":case "esriGeometryMultipoint":return k=>{if(k)for(const g of k.points)2<g.length&&(g[2]*=f)};case "extent":case "esriGeometryExtent":return k=>
{k&&null!=k.zmin&&null!=k.zmax&&(k.zmin*=f,k.zmax*=f)};default:return null}};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],function(r){let u=function(x,f,k){this.x=x;this.y=f;this.spatialReference=k;this.m=this.z=void 0},E=function(x,f,k,g){this.rings=x;this.spatialReference=f;this.hasM=this.hasZ=void 0;k&&(this.hasZ=k);g&&(this.hasM=g)},C=function(x,f,k,g){this.paths=x;this.spatialReference=
f;this.hasM=this.hasZ=void 0;k&&(this.hasZ=k);g&&(this.hasM=g)},v=function(x,f,k,g){this.points=x;this.spatialReference=f;this.hasM=this.hasZ=void 0;k&&(this.hasZ=k);g&&(this.hasM=g)},z=function(x,f,k,g,m){this.xmin=x;this.ymin=f;this.xmax=k;this.ymax=g;this.spatialReference=m;this.mmax=this.mmin=this.zmax=this.zmin=void 0};r.jsonAdapter={convertToGEGeometry:function(x,f){return null==f?null:x.convertJSONToGeometry(f)},exportPoint:function(x,f,k){k=new u(x.getPointX(f),x.getPointY(f),k);const g=x.hasZ(f),
m=x.hasM(f);g&&(k.z=x.getPointZ(f));m&&(k.m=x.getPointM(f));return k},exportPolygon:function(x,f,k){return new E(x.exportPaths(f),k,x.hasZ(f),x.hasM(f))},exportPolyline:function(x,f,k){return new C(x.exportPaths(f),k,x.hasZ(f),x.hasM(f))},exportMultipoint:function(x,f,k){return new v(x.exportPoints(f),k,x.hasZ(f),x.hasM(f))},exportExtent:function(x,f,k){var g=x.hasZ(f);const m=x.hasM(f);k=new z(x.getXMin(f),x.getYMin(f),x.getXMax(f),x.getYMax(f),k);g&&(g=x.getZExtent(f),k.zmin=g.vmin,k.zmax=g.vmax);
m&&(x=x.getMExtent(f),k.mmin=x.vmin,k.mmax=x.vmax);return k}};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["exports"],function(r){r.queryCapabilities={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,
supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,
supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/support/centroid ../../../geometry/support/extentUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ./AttributesBuilder ./projectionSupport ./utils ../../support/fieldUtils ../../../statistics/utils ../../../support/arcadeOnDemand".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t,e){function c(h,l,d,q,n,B){n-=d;B-=q;h=Math.min(1,Math.max(0,((h-d)*n+(l-q)*B)/(n*n+B*B)));return{x:d+n*h,y:q+B*h}}function a(h,l){return h?l?4:3:l?3:2}let b=function(){function h(d,q,n){this.items=d;this.query=q;this.geometryType=n.geometryType;this.hasM=n.hasM;this.hasZ=n.hasZ;this.fieldsIndex=n.fieldsIndex;this.objectIdField=n.objectIdField;this.spatialReference=n.spatialReference;this.featureAdapter=n.featureAdapter}var l=h.prototype;l.createQueryResponseForCount=
function(){const d=new k(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return d.countDistinctValues(this.items);const {groupByFieldsForStatistics:q,having:n,outStatistics:B}=this.query;if(null==q||!q.length)return 1;const A=new Map,w=new Map,y=new Set;for(const G of B){var {statisticType:D}=G;D="exceedslimit"!==D?G.onStatisticField:void 0;if(!w.has(D)){var F=[];for(const K of q){const J=this._getAttributeValues(d,K,A);F.push(J)}w.set(D,this._calculateUniqueValues(F,
d.returnDistinctValues))}D=w.get(D);for(const K in D){const {data:J,items:I}=D[K];F=J.join(",");n&&!d.validateItems(I,n)||y.add(F)}}return y.size};l.createQueryResponse=function(){var d=E._asyncToGenerator(function*(){let q;q=this.query.outStatistics?this.query.outStatistics.some(n=>"exceedslimit"===n.statisticType)?this._createExceedsLimitQueryResponse(this.query):yield this._createStatisticsQueryResponse(this.query):this._createFeatureQueryResponse(this.query);this.query.returnQueryGeometry&&(f.isValid(this.query.outSR)&&
!f.equals(this.query.geometry.spatialReference,this.query.outSR)?q.queryGeometry=m.cleanFromGeometryEngine({spatialReference:this.query.outSR,...g.project(this.query.geometry,this.query.geometry.spatialReference,this.query.outSR)}):q.queryGeometry=m.cleanFromGeometryEngine({spatialReference:this.query.outSR,...this.query.geometry}));return q});return function(){return d.apply(this,arguments)}}();l.createSnappingResponse=function(d,q){const n=this.featureAdapter,B=a(this.hasZ,this.hasM),{x:A,y:w}=
d.point,y="number"===typeof d.distance?d.distance:d.distance.x,D="number"===typeof d.distance?d.distance:d.distance.y,F={candidates:[]},G="esriGeometryPolygon"===this.geometryType;q=this._getPointCreator(d.point,this.spatialReference,q);for(const ba of this.items){var K=n.getGeometry(ba);if(C.isNone(K))continue;const {coords:X,lengths:S}=K;if(d.types&u.SnappingTypes.EDGE){K=0;for(var J=0;J<S.length;J++){var I=S[J];for(var H=0;H<I;H++,K+=B){var M=X[K],N=X[K+1];if(H!==I-1){const W=X[K+B],R=X[K+B+1],
{x:Z,y:ka}=c(A,w,M,N,W,R);var P=(A-Z)/y;const ta=(w-ka)/D;P=P*P+ta*ta;1>=P&&F.candidates.push({type:"edge",objectId:n.getObjectId(ba),distance:Math.sqrt(P),target:q(Z,ka),start:q(M,N),end:q(W,R)})}}}}if(d.types&u.SnappingTypes.VERTEX)for(K=G?X.length-B:X.length,J=0;J<K;J+=B)I=X[J],H=X[J+1],M=(A-I)/y,N=(w-H)/D,M=M*M+N*N,1>=M&&F.candidates.push({type:"vertex",objectId:n.getObjectId(ba),distance:Math.sqrt(M),target:q(I,H)})}F.candidates.sort((ba,X)=>ba.distance-X.distance);return F};l._getPointCreator=
function(d,q,n){const B=C.isSome(n)&&!f.equals(q,n)?A=>g.project(A,q,n):A=>A;return null!=d.z&&null!=d.m?(A,w)=>B({x:A,y:w,z:d.z,m:d.m}):null!=d.z?(A,w)=>B({x:A,y:w,z:d.z}):null!=d.m?(A,w)=>B({x:A,y:w,m:d.m}):(A,w)=>B({x:A,y:w})};l.createSummaryStatisticsResponse=function(){var d=E._asyncToGenerator(function*(q){const {field:n,valueExpression:B,normalizationField:A,normalizationType:w,normalizationTotal:y,minValue:D,maxValue:F,scale:G}=q;q=this.fieldsIndex.isDateField(n);var K=yield this._getDataValues({field:n,
valueExpression:B,normalizationField:A,normalizationType:w,normalizationTotal:y,scale:G});const J=t.isNullCountSupported({normalizationType:w,normalizationField:A,minValue:D,maxValue:F}),I=this.fieldsIndex.get(n),H={value:.5,fieldType:null==I?void 0:I.type};K=p.isStringField(I)?t.calculateStringStatistics({values:K,supportsNullCount:J,percentileParams:H}):t.calculateStatistics({values:K,minValue:D,maxValue:F,useSampleStdDev:!w,supportsNullCount:J,percentileParams:H});return t.processSummaryStatisticsResult(K,
q)});return function(q){return d.apply(this,arguments)}}();l.createUniqueValuesResponse=function(){var d=E._asyncToGenerator(function*(q){const {field:n,valueExpression:B,domain:A,returnAllCodedValues:w,scale:y}=q;q=yield this._getDataValues({field:n,valueExpression:B,scale:y});q=t.calculateUniqueValuesCount(q);return t.createUVResult(q,A,w)});return function(q){return d.apply(this,arguments)}}();l.createClassBreaksResponse=function(){var d=E._asyncToGenerator(function*(q){const {field:n,valueExpression:B,
normalizationField:A,normalizationType:w,normalizationTotal:y,classificationMethod:D,standardDeviationInterval:F,minValue:G,maxValue:K,numClasses:J,scale:I}=q;q=yield this._getDataValues({field:n,valueExpression:B,normalizationField:A,normalizationType:w,normalizationTotal:y,scale:I});q=t.calculateClassBreaks(q,{field:n,normalizationField:A,normalizationType:w,normalizationTotal:y,classificationMethod:D,standardDeviationInterval:F,minValue:G,maxValue:K,numClasses:J});return t.resolveCBResult(q,D)});
return function(q){return d.apply(this,arguments)}}();l.createHistogramResponse=function(){var d=E._asyncToGenerator(function*(q){const {field:n,valueExpression:B,normalizationField:A,normalizationType:w,normalizationTotal:y,classificationMethod:D,standardDeviationInterval:F,minValue:G,maxValue:K,numBins:J,scale:I}=q;q=yield this._getDataValues({field:n,valueExpression:B,normalizationField:A,normalizationType:w,normalizationTotal:y,scale:I});return t.calculateHistogram(q,{field:n,normalizationField:A,
normalizationType:w,normalizationTotal:y,classificationMethod:D,standardDeviationInterval:F,minValue:G,maxValue:K,numBins:J})});return function(q){return d.apply(this,arguments)}}();l._sortFeatures=function(d,q,n){if(1<d.length&&q&&q.length)for(const B of q.reverse()){q=B.split(" ");const A=q[0],w=this.fieldsIndex.get(A);q=q[1]&&"desc"===q[1].toLowerCase();const y=t.getAttributeComparator(null==w?void 0:w.type,q);d.sort((D,F)=>{D=n(D,A,w);F=n(F,A,w);return y(D,F)})}};l._createFeatureQueryResponse=
function(d){const q=this.items,{geometryType:n,hasM:B,hasZ:A,objectIdField:w,spatialReference:y}=this,{outFields:D,outSR:F,quantizationParameters:G,resultRecordCount:K,resultOffset:J,returnZ:I,returnM:H}=d,M=null!=K?q.length>(J||0)+K:!1,N=D&&(D.includes("*")?[...this.fieldsIndex.fields]:D.map(P=>this.fieldsIndex.get(P)));return{exceededTransferLimit:M,features:this._createFeatures(d,q),fields:N,geometryType:n,hasM:B&&H,hasZ:A&&I,objectIdFieldName:w,spatialReference:m.cleanFromGeometryEngine(F?F:y),
transform:G&&x.toQuantizationTransform(G)||null}};l._createFeatures=function(d,q){const n=new k(d,this.featureAdapter,this.fieldsIndex),{hasM:B,hasZ:A}=this,{orderByFields:w,quantizationParameters:y,returnGeometry:D,returnCentroid:F,maxAllowableOffset:G,resultOffset:K,resultRecordCount:J,returnZ:I=!1,returnM:H=!1}=d,M=A&&I,N=B&&H;d=[];var P=0;q=[...q];this._sortFeatures(q,w,(S,W,R)=>n.getFieldValue(S,W,R));if(D||F){var ba=x.toQuantizationTransform(y);if(D&&!F)for(var X of q)d[P++]={attributes:n.getAttributes(X),
geometry:m.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(X),G,ba,M,N)};else if(!D&&F)for(const S of q)d[P++]={attributes:n.getAttributes(S),centroid:m.transformCentroid(this,this.featureAdapter.getCentroid(S,this),ba)};else for(const S of q)d[P++]={attributes:n.getAttributes(S),centroid:m.transformCentroid(this,this.featureAdapter.getCentroid(S,this),ba),geometry:m.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(S),G,ba,M,N)}}else for(ba of q)(X=
n.getAttributes(ba))&&(d[P++]={attributes:X});P=K||0;null!=J&&(d=d.slice(P,Math.min(d.length,P+J)));return d};l._createExceedsLimitQueryResponse=function(d){var q=!1;let n=Number.POSITIVE_INFINITY,B=Number.POSITIVE_INFINITY;q=Number.POSITIVE_INFINITY;for(const A of d.outStatistics)if("exceedslimit"===A.statisticType){n=null!=A.maxPointCount?A.maxPointCount:Number.POSITIVE_INFINITY;B=null!=A.maxRecordCount?A.maxRecordCount:Number.POSITIVE_INFINITY;q=null!=A.maxVertexCount?A.maxVertexCount:Number.POSITIVE_INFINITY;
break}if("esriGeometryPoint"===this.geometryType)q=this.items.length>n;else if(this.items.length>B)q=!0;else{d=this.hasZ?this.hasM?4:3:this.hasM?3:2;const A=this.featureAdapter;q=this.items.reduce((w,y)=>{y=A.getGeometry(y);return w+(C.isSome(y)&&y.coords.length||0)},0)/d>q}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(q)}}]}};l._createStatisticsQueryResponse=
function(){var d=E._asyncToGenerator(function*(q){var n={attributes:{}};const B=[],A=new Map,w=new Map,y=new Map,D=new Map,F=new k(q,this.featureAdapter,this.fieldsIndex);var G=q.outStatistics;const {groupByFieldsForStatistics:K,having:J,orderByFields:I}=q;q=K&&K.length;const H=!!q,M=H&&K[0],N=H&&!this.fieldsIndex.get(M);for(const W of G){const {outStatisticFieldName:R,statisticType:Z}=W;G=W;var P="exceedslimit"!==Z?W.onStatisticField:void 0;const ka="percentile_disc"===Z||"percentile_cont"===Z,ta=
"EnvelopeAggregate"===Z||"CentroidAggregate"===Z||"ConvexHullAggregate"===Z,pa=H&&1===q&&(P===M||N)&&"count"===Z;if(H){if(!y.has(P)){var ba=[];for(const wa of K){var X=this._getAttributeValues(F,wa,A);ba.push(X)}y.set(P,this._calculateUniqueValues(ba,F.returnDistinctValues))}ba=y.get(P);for(const wa in ba){const {count:Ba,data:L,items:T,itemPositions:la}=ba[wa];X=L.join(",");if(!J||F.validateItems(T,J)){const U=D.get(X)||{attributes:{}};if(ta){U.aggregateGeometries||(U.aggregateGeometries={});const {aggregateGeometries:Q,
outStatisticFieldName:da}=yield this._getAggregateGeometry(G,T);U.aggregateGeometries[da]=Q}else{var S=null;if(pa)S=Ba;else{const Q=this._getAttributeValues(F,P,A);S=la.map(da=>Q[da]);S=ka&&"statisticParameters"in G?this._getPercentileValue(G,S):this._getStatisticValue(G,S,null,F.returnDistinctValues)}U.attributes[R]=S}K.forEach((Q,da)=>U.attributes[this.fieldsIndex.get(Q)?Q:`EXPR_${da+1}`]=L[da]);D.set(X,U)}}}else if(ta){n.aggregateGeometries||(n.aggregateGeometries={});const {aggregateGeometries:wa,
outStatisticFieldName:Ba}=yield this._getAggregateGeometry(G,this.items);n.aggregateGeometries[Ba]=wa}else P=this._getAttributeValues(F,P,A),n.attributes[R]=ka&&"statisticParameters"in G?this._getPercentileValue(G,P):this._getStatisticValue(G,P,w,F.returnDistinctValues);B.push({name:R,alias:R,type:"esriFieldTypeDouble"})}n=H?Array.from(D.values()):[n];this._sortFeatures(n,I,(W,R)=>W.attributes[R]);return{fields:B,features:n}});return function(q){return d.apply(this,arguments)}}();l._getAggregateGeometry=
function(){var d=E._asyncToGenerator(function*(q,n){var B=yield new Promise((I,H)=>r(["../../../geometry/geometryEngineJSON"],I,H));const {statisticType:A,outStatisticFieldName:w}=q,{featureAdapter:y,spatialReference:D,geometryType:F,hasZ:G,hasM:K}=this;n=n.map(I=>m.getGeometry(F,G,K,y.getGeometry(I)));const J=B.convexHull(D,n,!0)[0];q={aggregateGeometries:null,outStatisticFieldName:null};"EnvelopeAggregate"===A?(B=J?z.getPolygonExtent(J):z.getGeometryExtent(B.union(D,n)),q.aggregateGeometries={...B,
spatialReference:D},q.outStatisticFieldName=w||"extent"):"CentroidAggregate"===A?(B=J?v.polygonCentroid(J):v.extentCentroid(z.getGeometryExtent(B.union(D,n))),q.aggregateGeometries={x:B[0],y:B[1],spatialReference:D},q.outStatisticFieldName=w||"centroid"):"ConvexHullAggregate"===A&&(q.aggregateGeometries=J,q.outStatisticFieldName=w||"convexHull");return q});return function(q,n){return d.apply(this,arguments)}}();l._getStatisticValue=function(d,q,n,B){const {onStatisticField:A,statisticType:w}=d;d=
null;d=null!=n&&n.has(A)?n.get(A):p.isStringField(this.fieldsIndex.get(A))?t.calculateStringStatistics({values:q,returnDistinct:B}):t.calculateStatistics({values:q,minValue:null,maxValue:null,useSampleStdDev:!0});n&&n.set(A,d);return d["var"===w?"variance":w]};l._getPercentileValue=function(d,q){const {onStatisticField:n,statisticParameters:B,statisticType:A}=d,{value:w,orderBy:y}=B;d=this.fieldsIndex.get(n);return t.calculatePercentile(q,{value:w,orderBy:y,fieldType:null==d?void 0:d.type,isDiscrete:"percentile_disc"===
A})};l._getAttributeValues=function(d,q,n){if(n.has(q))return n.get(q);const B=this.fieldsIndex.get(q),A=this.items.map(w=>d.getFieldValue(w,q,B));n.set(q,A);return A};l._getAttributeNormalizedValues=function(d,q){return this.items.map(n=>d.getNormalizedValue(n,{field:q.field,fieldInfo:this.fieldsIndex.get(q.field),normalizationField:q.normalizationField,normalizationFieldInfo:this.fieldsIndex.get(q.normalizationField),normalizationType:q.normalizationType,normalizationTotal:q.normalizationTotal}))};
l._getAttributeExpressionValues=function(){var d=E._asyncToGenerator(function*(q,n,B){const {arcadeUtils:A}=yield e.loadArcade();n=A.createFunction(n);B=B&&A.getViewInfo(B);return q.getExpressionValues(this.items,n,B,A)});return function(q,n,B){return d.apply(this,arguments)}}();l._calculateUniqueValues=function(d,q){const n={},B=this.items,A=B.length;for(let w=0;w<A;w++){const y=B[w],D=[];for(const G of d)D.push(G[w]);const F=D.join(",");q?null==n[F]&&(n[F]={count:1,data:D,items:[y],itemPositions:[w]}):
null==n[F]?n[F]={count:1,data:D,items:[y],itemPositions:[w]}:(n[F].count++,n[F].items.push(y),n[F].itemPositions.push(w))}return n};l._getDataValues=function(){var d=E._asyncToGenerator(function*(q){const n=new k(this.query,this.featureAdapter,this.fieldsIndex),{valueExpression:B,field:A,normalizationField:w,normalizationType:y,normalizationTotal:D,scale:F}=q;q=B?{viewingMode:"map",scale:F,spatialReference:this.query.outSR||this.spatialReference}:null;return B?this._getAttributeExpressionValues(n,
B,q):this._getAttributeNormalizedValues(n,{field:A,normalizationField:w,normalizationType:y,normalizationTotal:D})});return function(q){return d.apply(this,arguments)}}();E._createClass(h,[{key:"size",get:function(){return this.items.length}}]);return h}();u.SnappingTypes=void 0;(function(h){h[h.NONE=0]="NONE";h[h.EDGE=1]="EDGE";h[h.VERTEX=2]="VERTEX"})(u.SnappingTypes||(u.SnappingTypes={}));u.QueryEngineResult=b;Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/geometry/support/quantizationUtils":function(){define(["exports","../../core/maybe","./jsonUtils"],function(r,u,E){function C({scale:D,translate:F},G){return Math.round((G-F[0])/D[0])}function v({scale:D,translate:F},G){return Math.round((F[1]-G)/D[1])}function z(D,F,G){const K=[];let J,I,H,M;for(let N=0;N<G.length;N++){const P=G[N];if(0<N){if(H=C(D,P[0]),M=v(D,P[1]),H!==J||M!==I)K.push(F(P,H-J,M-I)),J=H,I=M}else J=C(D,P[0]),I=v(D,P[1]),K.push(F(P,J,I))}return 0<K.length?K:null}function x(D,
F,G,K){return z(D,G?K?y:w:K?w:A,F)}function f(D,F,G,K){const J=[];G=G?K?y:w:K?w:A;for(K=0;K<F.length;K++){const I=z(D,G,F[K]);I&&3<=I.length&&J.push(I)}return J.length?J:null}function k(D,F,G,K){const J=[];G=G?K?y:w:K?w:A;for(K=0;K<F.length;K++){const I=z(D,G,F[K]);I&&2<=I.length&&J.push(I)}return J.length?J:null}function g({scale:D,translate:F},G){return G*D[0]+F[0]}function m({scale:D,translate:F},G){return F[1]-G*D[1]}function p(D,F,G){const K=Array(G.length);if(!G.length)return K;const [J,I]=
D.scale;let H=g(D,G[0][0]);D=m(D,G[0][1]);K[0]=F(G[0],H,D);for(let M=1;M<G.length;M++){const N=G[M];H+=N[0]*J;D-=N[1]*I;K[M]=F(N,H,D)}return K}function t(D,F,G){const K=Array(G.length);for(let J=0;J<G.length;J++)K[J]=p(D,F,G[J]);return K}function e(D,F,G,K){return p(D,G?K?y:w:K?w:A,F)}function c(D,F,G,K){return t(D,G?K?y:w:K?w:A,F)}function a(D,F,G,K){return t(D,G?K?y:w:K?w:A,F)}function b(D,F,G){let [K,J]=G[0],I=Math.min(K,F[0]),H=Math.min(J,F[1]),M=Math.max(K,F[2]);F=Math.max(J,F[3]);for(let N=
1;N<G.length;N++){const [P,ba]=G[N];K+=P;J+=ba;0>P&&(I=Math.min(I,K));0<P&&(M=Math.max(M,K));0>ba?H=Math.min(H,J):0<ba&&(F=Math.max(F,J))}D[0]=I;D[1]=H;D[2]=M;D[3]=F;return D}function h(D,F){if(!F.length)return null;D[0]=D[1]=Number.POSITIVE_INFINITY;D[2]=D[3]=Number.NEGATIVE_INFINITY;for(let G=0;G<F.length;G++)b(D,D,F[G]);return D}function l(D,F,G,K,J){F.xmin=C(D,G.xmin);F.ymin=v(D,G.ymin);F.xmax=C(D,G.xmax);F.ymax=v(D,G.ymax);F!==G&&(K&&(F.zmin=G.zmin,F.zmax=G.zmax),J&&(F.mmin=G.mmin,F.mmax=G.mmax));
return F}function d(D,F,G,K,J){F.points=x(D,G.points,K,J);return F}function q(D,F,G,K,J){F.x=C(D,G.x);F.y=v(D,G.y);F!==G&&(K&&(F.z=G.z),J&&(F.m=G.m));return F}function n(D,F,G,K,J){D=f(D,G.rings,K,J);if(!D)return null;F.rings=D;return F}function B(D,F,G,K,J){D=k(D,G.paths,K,J);if(!D)return null;F.paths=D;return F}const A=(D,F,G)=>[F,G],w=(D,F,G)=>[F,G,D[2]],y=(D,F,G)=>[F,G,D[2],D[3]];r.equals=function(D,F){if(D===F||null==D&&null==F)return!0;if(null==D||null==F)return!1;let G,K,J,I;D&&"upperLeft"===
D.originPosition?(G=D.translate[0],K=D.translate[1],D=D.scale[0]):(G=u.isSome(D.extent)?D.extent.xmin:0,K=u.isSome(D.extent)?D.extent.ymax:0,D=D.tolerance);F&&"upperLeft"===F.originPosition?(J=F.translate[0],I=F.translate[1],F=F.scale[0]):(J=u.isSome(F.extent)?F.extent.xmin:0,I=u.isSome(F.extent)?F.extent.ymax:0,F=F.tolerance);return G===J&&K===I&&D===F};r.getQuantizedBoundsCoordsArray=b;r.getQuantizedBoundsCoordsArrayArray=h;r.getQuantizedBoundsPaths=function(D){return h([0,0,0,0],D)};r.getQuantizedBoundsPoints=
function(D){const F=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return b(F,F,D)};r.getQuantizedBoundsRings=function(D){return h([0,0,0,0],D)};r.quantizeBounds=function(D,F,G){F[0]=C(D,G[0]);F[3]=v(D,G[1]);F[2]=C(D,G[2]);F[1]=v(D,G[3]);return F};r.quantizeExtent=l;r.quantizeGeometry=function(D,F){return D&&F?E.isPoint(F)?q(D,{},F,!1,!1):E.isPolyline(F)?B(D,{},F,!1,!1):E.isPolygon(F)?n(D,{},F,!1,!1):E.isMultipoint(F)?d(D,{},F,!1,!1):E.isExtent(F)?
l(D,{},F,!1,!1):null:null};r.quantizeMultipoint=d;r.quantizePaths=k;r.quantizePoint=q;r.quantizePoints=x;r.quantizePolygon=n;r.quantizePolyline=B;r.quantizeRings=f;r.quantizeX=C;r.quantizeY=v;r.toQuantizationTransform=function(D){return D?{originPosition:"upper-left"===D.originPosition?"upperLeft":"lower-left"===D.originPosition?"lowerLeft":D.originPosition,scale:D.tolerance?[D.tolerance,D.tolerance]:[1,1],translate:u.isSome(D.extent)?[D.extent.xmin,D.extent.ymax]:[0,0]}:null};r.unquantizeBounds=
function(D,F,G){return G?(F[0]=g(D,G[0]),F[1]=m(D,G[3]),F[2]=g(D,G[2]),F[3]=m(D,G[1]),F):[g(D,F[0]),m(D,F[3]),g(D,F[2]),m(D,F[1])]};r.unquantizeCoordsArray=p;r.unquantizeCoordsArrayArray=t;r.unquantizeExtent=function(D,F,G,K,J){F.xmin=g(D,G.xmin);F.ymin=m(D,G.ymin);F.xmax=g(D,G.xmax);F.ymax=m(D,G.ymax);F!==G&&(K&&(F.zmin=G.zmin,F.zmax=G.zmax),J&&(F.mmin=G.mmin,F.mmax=G.mmax));return F};r.unquantizeMultipoint=function(D,F,G,K,J){u.isSome(G)&&(F.points=e(D,G.points,K,J));return F};r.unquantizePaths=
c;r.unquantizePoint=function(D,F,G,K,J){if(u.isNone(G))return F;F.x=g(D,G.x);F.y=m(D,G.y);F!==G&&(K&&(F.z=G.z),J&&(F.m=G.m));return F};r.unquantizePoints=e;r.unquantizePolygon=function(D,F,G,K,J){u.isSome(G)&&(F.rings=a(D,G.rings,K,J));return F};r.unquantizePolyline=function(D,F,G,K,J){u.isSome(G)&&(F.paths=c(D,G.paths,K,J));return F};r.unquantizeRings=a;r.unquantizeX=g;r.unquantizeY=m;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["../../../core/maybe",
"./attributeSupport","../../../statistics/utils"],function(r,u,E){return function(){function C(z,x,f){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=z.returnDistinctValues;this.fieldsIndex=f;this.featureAdapter=x;if((x=z.outFields)&&!x.includes("*")){this.outFields=x;z=0;for(const g of x){var k=u.getExpressionFromFieldName(g);k=(x=this.fieldsIndex.get(k))?null:u.getWhereClause(k,f);x=x?x.name:u.getAliasFromFieldName(g)||`FIELD_EXP_${z++}`;this._fieldDataCache.set(g,
{alias:x,clause:k})}}}var v=C.prototype;v.countDistinctValues=function(z){if(!this.returnDistinctValues)return z.length;z.forEach(x=>this.getAttributes(x));return this._returnDistinctMap.size};v.getAttributes=function(z){z=this._processAttributesForOutFields(z);return this._processAttributesForDistinctValues(z)};v.getFieldValue=function(z,x,f){const k=f?f.name:x;let g=null;this._fieldDataCache.has(k)?g=this._fieldDataCache.get(k).clause:f||(g=u.getWhereClause(x,this.fieldsIndex),this._fieldDataCache.set(k,
{alias:k,clause:g}));return f?this.featureAdapter.getAttribute(z,k):g.calculateValue(z,this.featureAdapter)};v.getNormalizedValue=function(z,x){const f=x.normalizationType,k=x.normalizationTotal;let g=this.getFieldValue(z,x.field,x.fieldInfo);f&&Number.isFinite(g)&&(z=this.getFieldValue(z,x.normalizationField,x.normalizationFieldInfo),g=E.getNormalizedValue(g,f,z,k));return g};v.getExpressionValue=function(z,x,f,k){z={attributes:this.featureAdapter.getAttributes(z),layer:{fields:this.fieldsIndex.fields}};
f=k.createExecContext(z,f);return k.executeFunction(x,f)};v.getExpressionValues=function(z,x,f,k){const g={fields:this.fieldsIndex.fields};return z.map(m=>{m={attributes:this.featureAdapter.getAttributes(m),layer:g};m=k.createExecContext(m,f);return k.executeFunction(x,m)})};v.validateItem=function(z,x){this._fieldDataCache.has(x)||this._fieldDataCache.set(x,{alias:x,clause:u.getWhereClause(x,this.fieldsIndex)});return this._fieldDataCache.get(x).clause.testFeature(z,this.featureAdapter)};v.validateItems=
function(z,x){this._fieldDataCache.has(x)||this._fieldDataCache.set(x,{alias:x,clause:u.getWhereClause(x,this.fieldsIndex)});return this._fieldDataCache.get(x).clause.testSet(z,this.featureAdapter)};v._processAttributesForOutFields=function(z){const x=this.outFields;if(!x||!x.length)return this.featureAdapter.getAttributes(z);const f={};for(const k of x){const {alias:g,clause:m}=this._fieldDataCache.get(k);f[g]=m?m.calculateValue(z,this.featureAdapter):this.featureAdapter.getAttribute(z,g)}return f};
v._processAttributesForDistinctValues=function(z){if(r.isNone(z)||!this.returnDistinctValues)return z;var x=this.outFields,f=[];if(x)for(const g of x){var {alias:k}=this._fieldDataCache.get(g);f.push(z[k])}else for(k in z)f.push(z[k]);x=`${(x||["*"]).join(",")}=${f.join(",")}`;f=this._returnDistinctMap.get(x)||0;this._returnDistinctMap.set(x,++f);return 1<f?null:z};return C}()})},"esri/statistics/utils":function(){define(["exports","../rest/support/ClassBreaksDefinition","../rest/support/generateRendererUtils"],
function(r,u,E){function C(d){const q=null!=d.minValue||null!=d.maxValue,n=!!d.sqlExpression&&d.supportsSQLExpression;return!(null!=d.normalizationField||null!=d.normalizationType)&&!q&&!n}function v(d){const {values:q,useSampleStdDev:n,supportsNullCount:B}=d;var A=Number.POSITIVE_INFINITY;let w=Number.NEGATIVE_INFINITY,y=null,D=null;var F=null;let G=null,K=0;const J=null==d.minValue?-Infinity:d.minValue,I=null==d.maxValue?Infinity:d.maxValue;for(const H of q)Number.isFinite(H)?H>=J&&H<=I&&(y+=H,
A=Math.min(A,H),w=Math.max(w,H),K++):"string"===typeof H&&K++;if(K&&null!=y){D=y/K;F=0;for(const H of q)Number.isFinite(H)&&H>=J&&H<=I&&(F+=(H-D)**2);G=n?1<K?F/(K-1):0:0<K?F/K:0;F=Math.sqrt(G)}else w=A=null;A={avg:D,count:K,max:w,min:A,stddev:F,sum:y,variance:G};B&&(A.nullcount=q.length-K);d.percentileParams&&(A.median=z(q,d.percentileParams));return A}function z(d,q){const {fieldType:n,value:B,orderBy:A,isDiscrete:w}=q,y=x(n,"desc"===A);d=[...d].filter(K=>null!=K).sort((K,J)=>y(K,J));if(0===d.length)return null;
if(0>=B)return d[0];if(1<=B)return d[d.length-1];var D=(d.length-1)*B,F=Math.floor(D);q=F+1;D%=1;F=d[F];const G=d[q];return q>=d.length||w||"string"===typeof F||"string"===typeof G?F:F*(1-D)+G*D}function x(d,q){const n=q?1:-1,B=k(q),A=f(q);if(!d||!["esriFieldTypeDate","esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...h].includes(d))return(w,y)=>"number"===typeof w&&"number"===typeof y?B(w,y):"string"===typeof w&&"string"===typeof y?A(w,y):n;if("esriFieldTypeDate"===d)return(w,y)=>
{w=(new Date(w)).getTime();y=(new Date(y)).getTime();return isNaN(w)||isNaN(y)?n:B(w,y)};if(h.has(d))return(w,y)=>B(w,y);if("esriFieldTypeString"===d)return(w,y)=>A(w,y);if("esriFieldTypeGUID"===d||"esriFieldTypeGlobalID"===d){const w=f(q);return(y,D)=>w(g(y),g(D))}return q?(w,y)=>1:(w,y)=>-1}function f(d){return d?(q,n)=>{var B,A;q=null==(B=q)?void 0:B.toUpperCase();n=null==(A=n)?void 0:A.toUpperCase();return q>n?-1:q<n?1:0}:(q,n)=>{var B,A;q=null==(B=q)?void 0:B.toUpperCase();n=null==(A=n)?void 0:
A.toUpperCase();return q<n?-1:q>n?1:0}}function k(d){return d?(q,n)=>n-q:(q,n)=>q-n}function g(d){return d.substr(24,12)+d.substr(19,4)+d.substr(16,2)+d.substr(14,2)+d.substr(11,2)+d.substr(9,2)+d.substr(6,2)+d.substr(4,2)+d.substr(2,2)+d.substr(0,2)}function m(d,q){const n=t({field:q.field,normalizationType:q.normalizationType,normalizationField:q.normalizationField,classificationMethod:q.classificationMethod,standardDeviationInterval:q.standardDeviationInterval,breakCount:q.numClasses||5});d=p(d,
q.minValue,q.maxValue);return E.createGenerateRendererClassBreaks({definition:n,values:d,normalizationTotal:q.normalizationTotal})}function p(d,q,n){q=null==q?-Infinity:q;n=null==n?Infinity:n;return d.filter(B=>Number.isFinite(B)&&B>=q&&B<=n)}function t(d){const q=d.field,n=d.classificationMethod||"equal-interval",B=d.normalizationType,A=d.normalizationField,w=new u;w.classificationField=q;w.breakCount=d.breakCount;w.classificationMethod=n;w.standardDeviationInterval="standard-deviation"===n?d.standardDeviationInterval||
1:void 0;w.normalizationType=B;w.normalizationField="field"===B?A:void 0;return w}function e(d,q){const {field:n,classificationMethod:B,standardDeviationInterval:A,normalizationType:w,normalizationField:y,normalizationTotal:D,minValue:F,maxValue:G}=q,K=q.numBins||10;let J=q=null,I=null;B&&"equal-interval"!==B||w?({classBreaks:d}=m(d,{field:n,normalizationType:w,normalizationField:y,normalizationTotal:D,classificationMethod:B,standardDeviationInterval:A,minValue:F,maxValue:G,numClasses:K}),q=d[0].minValue,
J=d[d.length-1].maxValue,I=d.map(H=>[H.minValue,H.maxValue])):(null!=F&&null!=G?(q=F,J=G):(d=v({values:d,minValue:F,maxValue:G,useSampleStdDev:!w,supportsNullCount:C({normalizationType:w,normalizationField:y,minValue:F,maxValue:G})}),q=d.min,J=d.max),I=a(q,J,K));return{min:q,max:J,intervals:I}}function c(d,q){let n=-1;for(let B=d.length-1;0<=B;B--)if(q>=d[B][0]){n=B;break}return n}function a(d,q,n){const B=(q-d)/n,A=[];let w;for(let y=1;y<=n;y++)w=d+B,w=Number(w.toFixed(16)),A.push([d,y===n?q:w]),
d=w;return A}const b=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,h=new Set(["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]),l="min max avg stddev count sum variance nullcount median".split(" ");r.calculateClassBreaks=m;r.calculateHistogram=function(d,q){const {min:n,max:B,intervals:A}=e(d,q),w=A.map((y,D)=>({minValue:A[D][0],maxValue:A[D][1],count:0}));for(const y of d)null!=y&&y>=n&&y<=B&&(d=c(A,y),-1<d&&w[d].count++);return{bins:w,minValue:n,maxValue:B,
normalizationTotal:q.normalizationTotal}};r.calculatePercentile=z;r.calculateStatistics=v;r.calculateStringStatistics=function(d){const q=d.returnDistinct?[...new Set(d.values)]:d.values,n=q.filter(A=>null!=A).length,B={count:n};d.supportsNullCount&&(B.nullcount=q.length-n);d.percentileParams&&(B.median=z(q,d.percentileParams));return B};r.calculateUniqueValuesCount=function(d){const q={};for(let n of d){if(null==n||"string"===typeof n&&""===n.trim())n=null;null==q[n]?q[n]={count:1,data:n}:q[n].count++}return{count:q}};
r.createClassBreaksDefinition=t;r.createUVResult=function(d,q,n){const B=d.count;d=[];n&&q&&"coded-value"===q.type&&q.codedValues.forEach(A=>{A=A.code;B.hasOwnProperty(A)||(B[A]={data:A,count:0})});for(const A in B)q=B[A],d.push({value:q.data,count:q.count,label:q.label});return{uniqueValueInfos:d}};r.getAttributeComparator=x;r.getEqualIntervalBins=a;r.getNormalizedValue=function(d,q,n,B){let A=null;switch(q){case "log":0!==d&&(A=Math.log(d)*Math.LOG10E);break;case "percent-of-total":Number.isFinite(B)&&
0!==B&&(A=d/B*100);break;case "field":Number.isFinite(n)&&0!==n&&(A=d/n);break;case "natural-log":0<d&&(A=Math.log(d));break;case "square-root":0<d&&(A=d**.5)}return A};r.isNullCountSupported=C;r.processSummaryStatisticsResult=function(d,q){let n;for(n in d)l.includes(n)&&(Number.isFinite(d[n])||(d[n]=null));if(!q)return d;["avg","stddev","variance"].forEach(B=>{null!=d[B]&&(d[B]=Math.ceil(d[B]))});return d};r.resolveCBResult=function(d,q){let n=d.classBreaks;const B=n[0].minValue,A=n[n.length-1].maxValue,
w="standard-deviation"===q;n=n.map(y=>{const D=y.label;y={minValue:y.minValue,maxValue:y.maxValue,label:D};if(w&&D){const F=D.match(b).map(G=>+G.trim());2===F.length?(y.minStdDev=F[0],y.maxStdDev=F[1],0>F[0]&&0<F[1]&&(y.hasAvg=!0)):1===F.length&&(D.includes("\x3c")?(y.minStdDev=null,y.maxStdDev=F[0]):D.includes("\x3e")&&(y.minStdDev=F[0],y.maxStdDev=null))}return y});return{minValue:B,maxValue:A,classBreakInfos:n,normalizationTotal:d.normalizationTotal}};r.statisticTypes=l;Object.defineProperties(r,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./ClassificationDefinition".split(" "),function(r,u,E,C,v,z,x,f,k){v=new E.JSONMap({esriClassifyEqualInterval:"equal-interval",
esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});E=new E.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});k=function(g){function m(){var p=g.apply(this,arguments)||this;p.breakCount=null;p.classificationField=null;p.classificationMethod=null;p.normalizationField=null;p.normalizationType=
null;p.type="class-breaks-definition";return p}r._inheritsLoose(m,g);r._createClass(m,[{key:"standardDeviationInterval",set:function(p){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",p)}},{key:"definedInterval",set:function(p){"defined-interval"===this.classificationMethod&&this._set("definedInterval",p)}}]);return m}(k);u.__decorate([C.property({json:{write:!0}})],k.prototype,"breakCount",void 0);u.__decorate([C.property({json:{write:!0}})],k.prototype,"classificationField",
void 0);u.__decorate([C.property({type:String,json:{read:v.read,write:v.write}})],k.prototype,"classificationMethod",void 0);u.__decorate([C.property({json:{write:!0}})],k.prototype,"normalizationField",void 0);u.__decorate([C.property({json:{read:E.read,write:E.write}})],k.prototype,"normalizationType",void 0);u.__decorate([C.property({value:null,json:{write:!0}})],k.prototype,"standardDeviationInterval",null);u.__decorate([C.property({value:null,json:{write:!0}})],k.prototype,"definedInterval",
null);u.__decorate([C.property()],k.prototype,"type",void 0);return k=u.__decorate([f.subclass("esri.rest.support.ClassBreaksDefinition")],k)})},"esri/rest/support/ClassificationDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./colorRamps ../../symbols/Symbol".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m){E=new E.JSONMap({classBreaksDef:"class-breaks-definition",uniqueValueDef:"unique-value-definition"});C=function(p){function t(){var e=p.apply(this,arguments)||this;e.baseSymbol=null;e.colorRamp=null;e.type=null;return e}r._inheritsLoose(t,p);return t}(C.JSONSupport);u.__decorate([v.property({type:m,json:{write:!0}})],C.prototype,"baseSymbol",void 0);u.__decorate([v.property({types:g.types,json:{read:{reader:g.fromJSON},write:!0}})],C.prototype,"colorRamp",void 0);u.__decorate([v.property({json:{read:E.read,
write:E.write}})],C.prototype,"type",void 0);return C=u.__decorate([k.subclass("esri.rest.support.ClassificationDefinition")],C)})},"esri/rest/support/colorRamps":function(){define(["exports","./AlgorithmicColorRamp","./ColorRamp","./MultipartColorRamp"],function(r,u,E,C){E={key:"type",base:E,typeMap:{algorithmic:u,multipart:C}};r.fromJSON=function(v){return v&&v.type?"algorithmic"===v.type?u.fromJSON(v):"multipart"===v.type?C.fromJSON(v):null:null};r.types=E;Object.defineProperties(r,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/support/AlgorithmicColorRamp":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Color ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./ColorRamp".split(" "),function(r,u,E,C,v,z,x,f,k){var g;k=g=function(m){function p(t){t=m.call(this,t)||this;t.algorithm=null;
t.fromColor=null;t.toColor=null;t.type="algorithmic";return t}r._inheritsLoose(p,m);p.prototype.clone=function(){return new g({fromColor:C.clone(this.fromColor),toColor:C.clone(this.toColor),algorithm:this.algorithm})};return p}(k);u.__decorate([x.enumeration({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],k.prototype,"algorithm",void 0);u.__decorate([v.property({type:E,json:{type:[z.Integer],write:!0}})],k.prototype,"fromColor",void 0);u.__decorate([v.property({type:E,
json:{type:[z.Integer],write:!0}})],k.prototype,"toColor",void 0);u.__decorate([v.property({type:["algorithmic"]})],k.prototype,"type",void 0);return k=g=u.__decorate([f.subclass("esri.rest.support.AlgorithmicColorRamp")],k)})},"esri/core/accessorSupport/decorators/enumeration":function(){define(["exports","../../jsonMap","./property"],function(r,u,E){r.enumeration=function(C,v={}){var z;C=C instanceof u.JSONMap?C:new u.JSONMap(C,v);C={type:(null!=(z=null==v?void 0:v.ignoreUnknown)?z:1)?C.apiValues:
String,json:{type:C.jsonValues,read:null!=v&&v.readOnly?!1:{reader:C.read},write:{writer:C.write}}};void 0!==(null==v?void 0:v.readOnly)&&(C.readOnly=!!v.readOnly);void 0!==(null==v?void 0:v.default)&&(C.json.default=v.default);void 0!==(null==v?void 0:v.name)&&(C.json.name=v.name);return E.property(C)};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/support/ColorRamp":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(r,u,E,C,v,z,x,f){E=function(k){function g(m){m=k.call(this,m)||this;m.type=null;return m}r._inheritsLoose(g,k);return g}(E.JSONSupport);u.__decorate([C.property({readOnly:!0,json:{read:!1,write:!0}})],E.prototype,"type",void 0);return E=u.__decorate([f.subclass("esri.rest.support.ColorRamp")],E)})},"esri/rest/support/MultipartColorRamp":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./AlgorithmicColorRamp ./ColorRamp".split(" "),
function(r,u,E,C,v,z,x,f){var k;v=k=function(g){function m(p){p=g.call(this,p)||this;p.colorRamps=null;p.type="multipart";return p}r._inheritsLoose(m,g);m.prototype.clone=function(){return new k({colorRamps:E.clone(this.colorRamps)})};return m}(f);u.__decorate([C.property({type:[x],json:{write:!0}})],v.prototype,"colorRamps",void 0);u.__decorate([C.property({type:["multipart"]})],v.prototype,"type",void 0);return v=k=u.__decorate([z.subclass("esri.rest.support.MultipartColorRamp")],v)})},"esri/symbols/Symbol":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../Color ../core/jsonMap ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m){C=new C.JSONMap({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let p=0;v=function(t){function e(a){a=t.call(this,a)||this;a.id=`sym${p++}`;a.type=null;a.color=new E([0,0,0,1]);
return a}r._inheritsLoose(e,t);var c=e.prototype;c.readColor=function(a){return a&&null!=a[0]?[a[0],a[1],a[2],a[3]/255]:a};c.collectRequiredFields=function(){var a=r._asyncToGenerator(function*(b,h){});return function(b,h){return a.apply(this,arguments)}}();c.hash=function(){return JSON.stringify(this.toJSON())};c.clone=function(){};return e}(v.JSONSupport);u.__decorate([z.property({type:C.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:C.write}}})],v.prototype,"type",void 0);u.__decorate([z.property({type:E,
json:{write:{allowNull:!0}}})],v.prototype,"color",void 0);u.__decorate([g.reader("color")],v.prototype,"readColor",null);return v=u.__decorate([m.subclass("esri.symbols.Symbol")],v)})},"esri/rest/support/generateRendererUtils":function(){define(["exports"],function(r){function u(m){const {classificationMethod:p,breakCount:t,normalizationType:e,definedInterval:c}=m.definition,a=[];var b=m.values;if(0===b.length)return[];b=b.sort((B,A)=>B-A);var h=b[0],l=b[b.length-1];if("equal-interval"===p)if(b.length>=
t){b=(l-h)/t;m=h;for(var d=1;d<t;d++){var q=Number((h+d*b).toFixed(6));a.push({minValue:m,maxValue:q,label:E(m,q,e)});m=q}a.push({minValue:m,maxValue:l,label:E(m,l,e)})}else b.forEach(B=>{a.push({minValue:B,maxValue:B,label:E(B,B,e)})});else if("natural-breaks"===p){b=C(b);m=v(b.uniqueValues,m.valueFrequency||b.valueFrequency,t);for(d=1;d<t;d++)b.uniqueValues.length>d&&(q=Number(b.uniqueValues[m[d]].toFixed(6)),a.push({minValue:h,maxValue:q,label:E(h,q,e)}),h=q);a.push({minValue:h,maxValue:l,label:E(h,
l,e)})}else if("quantile"===p)if(b.length>=t&&h!==l){m=Math.ceil(b.length/t);d=0;for(q=1;q<t;q++){var n=m+d-1;n>b.length&&(n=b.length-1);0>n&&(n=0);a.push({minValue:h,maxValue:b[n],label:E(h,b[n],e)});h=b[n];d+=m;m=Math.ceil((b.length-d)/(t-q))}a.push({minValue:h,maxValue:l,label:E(h,l,e)})}else for(l=-1,h=0;h<b.length;h++)m=b[h],m!==l&&(l=m,a.push({minValue:l,maxValue:m,label:E(l,m,e)}),l=m);else if("standard-deviation"===p)if(m=f(b),d=k(b,m),0===d)a.push({minValue:b[0],maxValue:b[0],label:E(b[0],
b[0],e)});else{b=x(h,l,t,m,d)*d;d=0;for(q=t;1<=q;q--)n=Number((m-(q-.5)*b).toFixed(6)),a.push({minValue:h,maxValue:n,label:E(h,n,e)}),h=n,d++;q=Number((m+.5*b).toFixed(6));a.push({minValue:h,maxValue:q,label:E(h,q,e)});h=q;d++;for(n=1;n<=t;n++)q=d===2*t?l:Number((m+(n+.5)*b).toFixed(6)),a.push({minValue:h,maxValue:q,label:E(h,q,e)}),h=q,d++}else if("defined-interval"===p){if(!c)return a;l=b[0];b=b[b.length-1];h=Math.ceil((b-l)/c);m=l;for(d=1;d<h;d++)q=Number((l+d*c).toFixed(6)),a.push({minValue:m,
maxValue:q,label:E(m,q,e)}),m=q;a.push({minValue:m,maxValue:b,label:E(m,b,e)})}return a}function E(m,p,t){let e=null;return e=m===p?t&&"percent-of-total"===t?m+"%":m.toString():t&&"percent-of-total"===t?m+"% - "+p+"%":m+" - "+p}function C(m){const p=[],t=[];let e=Number.MIN_VALUE,c=1,a=-1;for(let b=0;b<m.length;b++){const h=m[b];h===e?(c++,t[a]=c):null!==h&&(p.push(h),e=h,c=1,t.push(c),a++)}return{uniqueValues:p,valueFrequency:t}}function v(m,p,t){var e=m.length;const c=[];t>e&&(t=e);for(var a=0;a<
t;a++)c.push(Math.round(a*e/t-1));c.push(e-1);a=z(c,m,p,t);{e=a.mean;a=a.sdcm;var b=t,h=0,l=0;let q=0,n=0,B=!0;for(let A=0;2>A&&B;A++){0===A&&(B=!1);for(var d=0;d<b-1;d++)for(;c[d+1]+1!==c[d+2];)if(c[d+1]+=1,h=g(d,c,m,p),q=h.sbMean,h=h.sbSdcm,l=g(d+1,c,m,p),n=l.sbMean,l=l.sbSdcm,h+l<a[d]+a[d+1])a[d]=h,a[d+1]=l,e[d]=q,e[d+1]=n,B=!0;else{--c[d+1];break}for(d=b-1;0<d;d--)for(;c[d]!==c[d-1]+1;)if(--c[d],h=g(d-1,c,m,p),q=h.sbMean,h=h.sbSdcm,l=g(d,c,m,p),n=l.sbMean,l=l.sbSdcm,h+l<a[d-1]+a[d])a[d-1]=h,a[d]=
l,e[d-1]=q,e[d]=n,B=!0;else{c[d]+=1;break}}e=B}e&&(a=z(c,m,p,t));return c}function z(m,p,t,e){let c=[];var a=[],b=[];let h=0;const l=[],d=[];for(var q=0;q<e;q++){var n=g(q,m,p,t);l.push(n.sbMean);d.push(n.sbSdcm);h+=d[q]}n=h;for(q=!0;q||h<n;){q=!1;c=[];for(a=0;a<e;a++)c.push(m[a]);for(b=0;b<e;b++)for(n=m[b]+1;n<=m[b+1];n++)if(a=p[n],0<b&&n!==m[b+1]&&Math.abs(a-l[b])>Math.abs(a-l[b-1]))m[b]=n;else if(b<e-1&&m[b]!==n-1&&Math.abs(a-l[b])>Math.abs(a-l[b+1])){m[b+1]=n-1;break}n=h;h=0;a=[];b=[];for(let B=
0;B<e;B++){a.push(l[B]);b.push(d[B]);const A=g(B,m,p,t);l[B]=A.sbMean;d[B]=A.sbSdcm;h+=d[B]}}if(h>n){for(p=0;p<e;p++)m[p]=c[p],l[p]=a[p],d[p]=b[p];h=n}return{mean:l,sdcm:d}}function x(m,p,t,e,c){m=Math.max(e-m,p-e)/c/t;return 1<=m?1:.5<=m?.5:.25}function f(m){let p=0;for(let t=0;t<m.length;t++)p+=m[t];return p/=m.length}function k(m,p){let t=0;for(let e=0;e<m.length;e++){const c=m[e];t+=(c-p)*(c-p)}t/=m.length;return Math.sqrt(t)}function g(m,p,t,e){var c=0,a=0;for(var b=p[m]+1;b<=p[m+1];b++){const h=
e[b];c+=t[b]*h;a+=h}0>=a&&console.log("Exception in Natural Breaks calculation");c/=a;a=0;for(b=p[m]+1;b<=p[m+1];b++)a+=e[b]*(t[b]-c)**2;return{sbMean:c,sbSdcm:a}}r.createGenerateRendererClassBreaks=function(m){const {normalizationTotal:p}=m;return{classBreaks:u(m),normalizationTotal:p}};r.createGenerateRendererUniqueValues=function(m){m=C(m);const p=[],t=m.uniqueValues.length;for(let e=0;e<t;e++){const c=m.uniqueValues[e];p.push({value:c,count:m.valueFrequency[e],label:c.toString()})}return{uniqueValues:p}};
Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/data/utils":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/jsonMap ../../../core/maybe ../../../core/unitUtils ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../centroid ../featureConversionUtils ../OptimizedGeometry ./projectionSupport".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t,e){function c(K,J,I,H=K.hasZ,M=K.hasM){if(v.isNone(J))return null;const N=K.hasZ&&H,P=K.hasM&&M;return I?(K=p.quantizeOptimizedGeometry(D,J,K.hasZ,K.hasM,"esriGeometryPoint",I,H,M),p.convertToPoint(K,N,P)):p.convertToPoint(J,N,P)}function a(){a=E._asyncToGenerator(function*(K,J,I){const {outFields:H,orderByFields:M,groupByFieldsForStatistics:N,outStatistics:P}=K;if(H)for(var ba=0;ba<H.length;ba++)H[ba]=H[ba].trim();if(M)for(ba=0;ba<M.length;ba++)M[ba]=M[ba].trim();
if(N)for(ba=0;ba<N.length;ba++)N[ba]=N[ba].trim();if(P)for(ba=0;ba<P.length;ba++)P[ba].onStatisticField&&(P[ba].onStatisticField=P[ba].onStatisticField.trim());K.geometry&&!K.outSR&&(K.outSR=K.geometry.spatialReference);return b(K,J,I)});return a.apply(this,arguments)}function b(K,J,I){return h.apply(this,arguments)}function h(){h=E._asyncToGenerator(function*(K,J,I){if(!K)return null;var {where:H}=K;K.where=H=H&&H.trim();if(!H||/^1 *= *1$/.test(H)||J&&J===H)K.where=null;if(!K.geometry)return K;J=
yield l(K);K.distance=0;K.units=null;"esriSpatialRelEnvelopeIntersects"===K.spatialRel&&({spatialReference:H}=K.geometry,J=x.getGeometryExtent(J),J.spatialReference=H);K.geometry=J;yield e.checkProjectionSupport(J.spatialReference,I);J=(yield k.normalizeCentralMeridian(f.fromJSON(J)))[0];if(v.isNone(J))throw A;J=J.toJSON();J=yield e.project(J,J.spatialReference,I);if(!J)throw A;J.spatialReference=I;K.geometry=J;return K});return h.apply(this,arguments)}function l(K){return d.apply(this,arguments)}
function d(){d=E._asyncToGenerator(function*(K){const {geometry:J,distance:I,units:H}=K;if(null==I||"vertexAttributes"in J)return J;var M=J.spatialReference;K=H?B.fromJSON(H):z.getUnitString(M);M=M&&(g.isGeographic(M)||g.isWebMercator(M))?J:yield e.checkProjectionSupport(M,g.WGS84).then(()=>e.project(J,g.WGS84));return(yield q())(M.spatialReference,M,I,K)});return d.apply(this,arguments)}function q(){return n.apply(this,arguments)}function n(){n=E._asyncToGenerator(function*(){return(yield new Promise((K,
J)=>r(["../../../geometry/geometryEngineJSON"],K,J))).geodesicBuffer});return n.apply(this,arguments)}const B=new C.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),A=Object.freeze({}),w=new t,y=new t,D=new t,F={esriGeometryPoint:p.convertToPoint,esriGeometryPolyline:p.convertToPolyline,esriGeometryPolygon:p.convertToPolygon,esriGeometryMultipoint:p.convertToMultipoint},
G=(K,J)=>"_geVersion"!==K?J:void 0;u.QUERY_ENGINE_EMPTY_RESULT=A;u.cleanFromGeometryEngine=function(K){return K&&"_geVersion"in K?JSON.parse(JSON.stringify(K,G)):K};u.getCentroid=function(K,J,I){if("esriGeometryPolygon"!==K.geometryType||!J||!J.centroid&&!J.geometry)return null;J.centroid||(J.centroid=m.getCentroidOptimizedGeometry(new t,J.geometry,K.hasZ,K.hasM));return c(K,J.centroid,I)};u.getGeometry=function(K,J,I,H,M,N,P=J,ba=I){const X=J&&P,S=I&&ba;H=v.isSome(H)?"coords"in H?H:H.geometry:null;
if(v.isNone(H))return null;if(M)return J=p.generalizeOptimizedGeometry(y,H,J,I,K,M,P,ba),N&&(J=p.quantizeOptimizedGeometry(D,J,X,S,K,N)),F[K](J,X,S);if(N)return N=p.quantizeOptimizedGeometry(D,H,J,I,K,N,P,ba),F[K](N,X,S);p.removeZMValues(w,H,J,I,P,ba);return F[K](w,X,S)};u.normalizeQuery=function(K,J,I){return a.apply(this,arguments)};u.normalizeQueryLike=b;u.transformCentroid=c;Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/centroid":function(){define(["exports",
"../../core/maybe"],function(r,u){function E(v,z,x,f,k,g,m=1){g=k?g?4:3:g?3:2;let p=x,t=x+g,e=0,c=0,a=x=0,b=0;for(let h=0,l=f-1;h<l;h++,p+=g,t+=g){f=z[p];const d=z[p+1],q=z[p+2],n=z[t],B=z[t+1],A=z[t+2];let w=f*B-n*d;a+=w;e+=(f+n)*w;c+=(d+B)*w;k&&(w=f*A-n*q,x+=(q+A)*w,b+=w);f<v[0]&&(v[0]=f);f>v[1]&&(v[1]=f);d<v[2]&&(v[2]=d);d>v[3]&&(v[3]=d);k&&(q<v[4]&&(v[4]=q),q>v[5]&&(v[5]=q))}0<a*m&&(a*=-1);0<b*m&&(b*=-1);if(!a)return null;v=[e,c,.5*a];k&&(v[3]=x,v[4]=.5*b);return v}function C(v,z,x,f,k){k=f?k?
4:3:k?3:2;let g=z,m=z+k,p=0,t=0,e=0,c=0;for(let l=0,d=x-1;l<d;l++,g+=k,m+=k){var a=v[g];const q=v[g+1],n=v[g+2],B=v[m],A=v[m+1],w=v[m+2];if(f){{var b=B-a;var h=A-q;const y=w-n;b=Math.sqrt(b*b+h*h+y*y)}}else b=B-a,h=A-q,b=Math.sqrt(b*b+h*h);b&&(p+=b,f?(a=[a+.5*(B-a),q+.5*(A-q),n+.5*(w-n)],t+=b*a[0],e+=b*a[1],c+=b*a[2]):(a=[a+.5*(B-a),q+.5*(A-q)],t+=b*a[0],e+=b*a[1]))}return 0<p?f?[t/p,e/p,c/p]:[t/p,e/p]:0<x?f?[v[z],v[z+1],v[z+2]]:[v[z],v[z+1]]:null}r.getCentroidOptimizedGeometry=function(v,z,x,f,k){if(u.isNone(z)||
!z.lengths.length)return null;const g="upperLeft"===(null==k?void 0:k.originPosition)?-1:1;v.lengths.length&&(v.lengths.length=0);v.coords.length&&(v.coords.length=0);k=v.coords;const m=[],p=x?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:t,coords:e}=z,c=x?f?4:3:f?3:2;let a=0;for(var b of t){const h=
E(p,e,a,b,x,f,g);h&&m.push(h);a+=b*c}m.sort((h,l)=>{let d=g*h[2]-g*l[2];0===d&&x&&(d=h[4]-l[4]);return d});m.length&&(b=6*m[0][2],k[0]=m[0][0]/b,k[1]=m[0][1]/b,x&&(b=6*m[0][4],k[2]=0!==b?m[0][3]/b:0),k[0]<p[0]||k[0]>p[1]||k[1]<p[2]||k[1]>p[3]||x&&(k[2]<p[4]||k[2]>p[5]))&&(k.length=0);if(!k.length)if(z=z.lengths[0]?C(e,0,t[0],x,f):null)k[0]=z[0],k[1]=z[1],x&&2<z.length&&(k[2]=z[2]);else return null;return v};r.lineCentroid=C;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/layers/support/fieldUtils":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../core/Error ../../core/maybe ../../core/object ./domainUtils ../../support/arcadeOnDemand".split(" "),function(r,u,E,C,v,z,x,f){function k(Y,ca,ia){if(Y)for(const ra of Y)(Y=(Y=z.getDeepValue(ra,ca))&&"function"!==typeof Y&&ia.get(Y))&&z.setDeepValue(ra,Y.name,ca)}function g(Y,ca){if(!Y||!ca)return[];T.clear();m(T,Y,ca);return Array.from(T).sort()}function m(Y,ca,ia){var ra;if(ia)if(null!=
ca&&null!=(ra=ca.fields)&&ra.length)if(ia.includes("*"))for(const {name:ua}of ca.fields)Y.add(ua);else for(const ua of ia)p(Y,ca,ua);else if(ia.includes("*"))Y.clear(),Y.add("*");else for(const ua of ia)Y.add(ua)}function p(Y,ca,ia){"string"===typeof ia&&(ca?(ca=ca.get(ia))&&Y.add(ca.name):Y.add(ia))}function t(Y,ca,ia){return e.apply(this,arguments)}function e(){e=E._asyncToGenerator(function*(Y,ca,ia){var ra;if(ia){var {arcadeUtils:ua}=yield f.loadArcade();ia=ua.extractFieldNames(ia,null==ca?void 0:
null==(ra=ca.fields)?void 0:ra.map(za=>za.name));for(const za of ia)p(Y,ca,za)}});return e.apply(this,arguments)}function c(Y,ca,ia){return a.apply(this,arguments)}function a(){a=E._asyncToGenerator(function*(Y,ca,ia){if(ia&&"1\x3d1"!==ia){const ra=(yield new Promise((ua,za)=>r(["../../core/sql/WhereClause"],ua,za))).WhereClause.create(ia,ca);if(!ra.isStandardized)throw new C("fieldUtils:collectFilterFields","Where clause is not standardized",{where:ia});m(Y,ca,ra.fieldNames)}});return a.apply(this,
arguments)}function b(Y,ca){for(const ia of Y)if(ia&&ia.valueType&&ia.valueType===ca)return ia.name;return null}function h(){h=E._asyncToGenerator(function*(Y){if(!Y)return[];const ca=new Set;yield l(ca,Y);return Array.from(ca).sort()});return h.apply(this,arguments)}function l(Y,ca){return d.apply(this,arguments)}function d(){d=E._asyncToGenerator(function*(Y,ca){if(ca){var ia=z.getDeepValue("elevationInfo.featureExpressionInfo",ca);if(ia)return ia.collectRequiredFields(Y,ca.fieldsIndex)}});return d.apply(this,
arguments)}function q(Y,ca,ia){return n.apply(this,arguments)}function n(){n=E._asyncToGenerator(function*(Y,ca,ia){ia.outStatistic.onStatisticValueExpression?t(Y,ca,ia.outStatistic.onStatisticValueExpression):Y.add(ia.outStatistic.onStatisticField)});return n.apply(this,arguments)}function B(){B=E._asyncToGenerator(function*(Y,ca,ia){var ra,ua;if(ca&&ia&&"fields"in ia){var za=[];null!=(ra=ia.popupTemplate)&&ra.expressionInfos&&za.push(...ia.popupTemplate.expressionInfos.map(Da=>t(Y,ca.fieldsIndex,
Da.expression)));if(Array.isArray(null==(ua=ia.popupTemplate)?void 0:ua.content)){ra=ia.popupTemplate.content;for(const Da of ra)"expression"===Da.type&&Da.expressionInfo&&za.push(t(Y,ca.fieldsIndex,Da.expressionInfo.expression))}ia.fields&&za.push(...ia.fields.map(Da=>q(Y,ca.fieldsIndex,Da)));yield Promise.all(za)}});return B.apply(this,arguments)}function A(){A=E._asyncToGenerator(function*(Y,ca,ia){ca&&(ca.timeInfo&&v.isSome(ia)&&ia.timeExtent&&m(Y,ca.fieldsIndex,[ca.timeInfo.startField,ca.timeInfo.endField]),
ca.floorInfo&&m(Y,ca.fieldsIndex,[ca.floorInfo.floorField]),v.isSome(ia)&&v.isSome(ia.where)&&(yield c(Y,ca.fieldsIndex,ia.where)))});return A.apply(this,arguments)}function w(){w=E._asyncToGenerator(function*(Y,ca,ia){ca&&ia&&(yield Promise.all(ia.map(ra=>y(Y,ca,ra))))});return w.apply(this,arguments)}function y(Y,ca,ia){return D.apply(this,arguments)}function D(){D=E._asyncToGenerator(function*(Y,ca,ia){ca&&ia&&(ia.valueExpression?yield t(Y,ca.fieldsIndex,ia.valueExpression):ia.field&&p(Y,ca.fieldsIndex,
ia.field))});return D.apply(this,arguments)}function F(){F=E._asyncToGenerator(function*(Y){if(!Y)return[];const ca="timeInfo"in Y&&Y.timeInfo;return ca?g(Y.fieldsIndex,[Y.trackIdField,ca.startField,ca.endField]):[]});return F.apply(this,arguments)}function G(){G=E._asyncToGenerator(function*(Y){if(!Y)return[];const ca=new Set;yield K(ca,Y);return Array.from(ca).sort()});return G.apply(this,arguments)}function K(Y,ca){return J.apply(this,arguments)}function J(){J=E._asyncToGenerator(function*(Y,ca){const {labelingInfo:ia,
fieldsIndex:ra}=ca;ia&&ia.length&&(yield Promise.all(ia.map(ua=>I(Y,ra,ua))))});return J.apply(this,arguments)}function I(Y,ca,ia){return H.apply(this,arguments)}function H(){H=E._asyncToGenerator(function*(Y,ca,ia){if(ia){var ra=ia.getLabelExpression();ia=ia.where;"arcade"===ra.type?yield t(Y,ca,ra.expression):(ra=ra.expression.match(/{[^}]*}/g))&&ra.forEach(ua=>{p(Y,ca,ua.slice(1,-1))});yield c(Y,ca,ia)}});return H.apply(this,arguments)}function M(Y){return"number"===typeof Y&&!isNaN(Y)&&isFinite(Y)}
function N(Y){return null===Y||M(Y)}function P(Y){return null===Y||la(Y)}function ba(Y){return null!=Y&&"string"===typeof Y}function X(Y){return null===Y||ba(Y)}function S(){return!0}function W(Y,ca){let ia;switch(Y.type){case "date":case "integer":case "long":case "small-integer":case "esriFieldTypeDate":case "esriFieldTypeInteger":case "esriFieldTypeLong":case "esriFieldTypeSmallInteger":ia=Y.nullable?P:la;break;case "double":case "single":case "esriFieldTypeSingle":case "esriFieldTypeDouble":ia=
Y.nullable?N:M;break;case "string":case "esriFieldTypeString":ia=Y.nullable?X:ba;break;default:ia=S}return 1===arguments.length?ia:ia(ca)}function R(Y){return null!=Y&&Q.has(Y.type)}function Z(Y,ca){return Y.nullable&&null===ca?null:R(Y)&&!ka(Y.type,Number(ca))?u.NumericRangeValidationError.OUT_OF_RANGE:W(Y,ca)?Y.domain?x.validateDomainValue(Y.domain,ca):null:u.TypeValidationError.INVALID_TYPE}function ka(Y,ca){return(Y="string"===typeof Y?ta(Y):Y)?Y.isInteger?la(ca)&&ca>=Y.min&&ca<=Y.max:ca>=Y.min&&
ca<=Y.max:!1}function ta(Y){switch(Y){case "esriFieldTypeSmallInteger":case "small-integer":return da;case "esriFieldTypeInteger":case "integer":return ea;case "esriFieldTypeSingle":case "single":return ja;case "esriFieldTypeDouble":case "double":return ha}}function pa(Y,ca,ia){if(!ca||!ca.attributes||!Y){if(v.isSome(ia))for(var ra of Y)ia.add(ra);return!0}ca=ca.attributes;ra=!1;for(const ua of Y)if(!(ua in ca))if(ra=!0,v.isSome(ia))ia.add(ua);else break;return ra}function wa(){wa=E._asyncToGenerator(function*(Y,
ca){const ia=new Set;for(const ra of ca)yield t(ia,Y.fieldsIndex,ra);return Array.from(ia).sort()});return wa.apply(this,arguments)}const Ba="field field2 field3 normalizationField rotationInfo.field proportionalSymbolInfo.field proportionalSymbolInfo.normalizationField colorInfo.field colorInfo.normalizationField".split(" "),L=["field","normalizationField"],T=new Set,la=(()=>"isInteger"in Number?Number.isInteger:Y=>"number"===typeof Y&&isFinite(Y)&&Math.floor(Y)===Y)(),U=["integer","small-integer",
"single","double"],Q=new Set([...U,"esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]);u.NumericRangeValidationError=void 0;(u.NumericRangeValidationError||(u.NumericRangeValidationError={})).OUT_OF_RANGE="numeric-range-validation-error::out-of-range";u.TypeValidationError=void 0;(u.TypeValidationError||(u.TypeValidationError={})).INVALID_TYPE="type-validation-error::invalid-type";const da={min:-32768,max:32767,isInteger:!0},ea={min:-2147483648,max:2147483647,
isInteger:!0},ja={min:-3.4E38,max:1.2E38,isInteger:!1},ha={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1};u.collectArcadeFieldNames=t;u.collectElevationFields=l;u.collectFeatureReductionFields=function(Y,ca,ia){return B.apply(this,arguments)};u.collectField=p;u.collectFields=m;u.collectFilterFields=function(Y,ca,ia){return A.apply(this,arguments)};u.collectLabelingFields=K;u.collectOrderByInfos=function(Y,ca,ia){return w.apply(this,arguments)};u.doubleRange=ha;u.featureHasFields=function(Y,
ca){return!pa(Y,ca,null)};u.fixFields=g;u.fixRendererFields=function(Y,ca){if(null!=Y&&null!=ca)for(const ia of Array.isArray(Y)?Y:[Y])if(k(Ba,ia,ca),"visualVariables"in ia&&ia.visualVariables)for(const ra of ia.visualVariables)k(L,ra,ca)};u.fixTimeInfoFields=function(Y,ca){if(null!=Y&&null!=ca&&ca.fields.length)if("startField"in Y){var ia=ca.get(Y.startField);ca=ca.get(Y.endField);Y.startField=ia&&ia.name||null;Y.endField=ca&&ca.name||null}else ia=ca.get(Y.startTimeField),ca=ca.get(Y.endTimeField),
Y.startTimeField=ia&&ia.name||null,Y.endTimeField=ca&&ca.name||null};u.getDisplayFieldName=function({displayField:Y,fields:ca}){if(Y)return Y;if(!ca||!ca.length)return null;if(!(Y=b(ca,"name-or-title")||b(ca,"unique-identifier")||b(ca,"type-or-category")))a:{for(const ia of ca)if(ia&&ia.name&&(ca=ia.name.toLowerCase(),ca.includes("name")||ca.includes("title"))){Y=ia.name;break a}Y=null}return Y};u.getElevationFields=function(Y){return h.apply(this,arguments)};u.getExpressionFields=function(Y,ca){return wa.apply(this,
arguments)};u.getFeatureEditFields=function(Y){if(!Y)return[];const ca="editFieldsInfo"in Y&&Y.editFieldsInfo;return ca?g(Y.fieldsIndex,[ca&&ca.creatorField,ca&&ca.creationDateField,ca&&ca.editorField,ca&&ca.editDateField]):[]};u.getFeatureGeometryFields=function(Y){if(!Y)return[];const ca=Y.geometryFieldsInfo;return ca?g(Y.fieldsIndex,[ca.shapeAreaField,ca.shapeLengthField]):[]};u.getFieldDefaultValue=function(Y){const ca=Y.defaultValue;if(void 0!==ca&&W(Y,ca))return ca;if(Y.nullable)return null};
u.getFieldRange=function(Y){const ca=x.getDomainRange(Y.domain);if(ca)return ca;if(R(Y))return ta(Y.type)};u.getLabelingFields=function(Y){return G.apply(this,arguments)};u.getNumericTypeForValue=function(Y){if(!M(Y))return null;if(la(Y)){if(Y>=da.min&&Y<=da.max)return"esriFieldTypeSmallInteger";if(Y>=ea.min&&Y<=ea.max)return"esriFieldTypeInteger"}return Y>=ja.min&&Y<=ja.max?"esriFieldTypeSingle":"esriFieldTypeDouble"};u.getTimeFields=function(Y){return F.apply(this,arguments)};u.integerRange=ea;
u.isDateField=function(Y){return null!=Y&&("date"===Y.type||"esriFieldTypeDate"===Y.type)};u.isNumberInRange=ka;u.isNumericField=R;u.isRasterPixelValueField=function(Y){return["raster.itempixelvalue","raster.servicepixelvalue"].some(ca=>Y.toLowerCase().startsWith(ca))};u.isStringField=function(Y){return null!=Y&&("string"===Y.type||"esriFieldTypeString"===Y.type)};u.isValidFieldValue=function(Y,ca){return null===Z(Y,ca)};u.isValueMatchingFieldType=W;u.numericTypes=U;u.packFields=function(Y,ca,ia=
1){if(!ca||!Y)return[];if(ca.includes("*"))return["*"];ca=g(Y,ca);return ca.length/Y.fields.length>=ia?["*"]:ca};u.populateMissingFields=pa;u.rendererFields=Ba;u.sanitizeNullFieldValue=function(Y){return null==Y||"number"===typeof Y&&isNaN(Y)?null:Y};u.singleRange=ja;u.smallIntegerRange=da;u.unpackFieldNames=function(Y,ca){return v.isNone(ca)||v.isNone(Y)?[]:ca.includes("*")?Y.fields.map(ia=>ia.name):ca};u.validateFieldValue=Z;u.validationErrorToString=function(Y,ca,ia){switch(Y){case x.DomainValidationError.INVALID_CODED_VALUE:return`Value ${ia} is not in the coded domain - field: ${ca.name}, domain: ${JSON.stringify(ca.domain)}`;
case x.DomainValidationError.VALUE_OUT_OF_RANGE:return`Value ${ia} is out of the range of valid values - field: ${ca.name}, domain: ${JSON.stringify(ca.domain)}`;case u.TypeValidationError.INVALID_TYPE:return`Value ${ia} is not a valid value for the field type - field: ${ca.name}, type: ${ca.type}, nullable: ${ca.nullable}`;case u.NumericRangeValidationError.OUT_OF_RANGE:{const {min:ra,max:ua}=ta(ca.type);return`Value ${ia} is out of range for the number type - field: ${ca.name}, type: ${ca.type}, value range is ${ra} to ${ua}`}}};
u.visualVariableFields=L;Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/domainUtils":function(){define(["exports"],function(r){function u(E,C){switch(E.type){case "range":{const v="range"in E?E.range[1]:E.maxValue;if(+C<("range"in E?E.range[0]:E.minValue)||+C>v)return r.DomainValidationError.VALUE_OUT_OF_RANGE;break}case "coded-value":case "codedValue":if(null==E.codedValues||E.codedValues.every(v=>null==v||v.code!==C))return r.DomainValidationError.INVALID_CODED_VALUE}return null}
r.DomainValidationError=void 0;(function(E){E.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range";E.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"})(r.DomainValidationError||(r.DomainValidationError={}));r.getDomainRange=function(E){if(E&&"range"===E.type)return{min:"range"in E?E.range[0]:E.minValue,max:"range"in E?E.range[1]:E.maxValue}};r.isValidDomainValue=function(E,C){return null===u(E,C)};r.validateDomainValue=u;Object.defineProperties(r,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/support/arcadeOnDemand":function(){define("require exports ../chunks/_rollupPluginBabelHelpers ../geometry ../core/maybe ../geometry/SpatialReference".split(" "),function(r,u,E,C,v,z){function x(){f||(f=E._asyncToGenerator(function*(){const g=yield new Promise((m,p)=>r(["./arcadeUtils"],m,p));return{arcade:g.arcade,arcadeUtils:g,Dictionary:g.Dictionary,Feature:g.arcadeFeature}})());return f}let f;C=(g,m,p)=>k.create(g,m,p,null,["$feature","$view"]);
let k=function(){function g(p,t,e,c,a,b,h,l){this.script=p;this.evaluate=a;this.fields=Array.isArray(h)?h:h.fields;this._syntaxTree=c;this._arcade=t;this._arcadeDictionary=e;this._arcadeFeature=b;this._spatialReference=l;this._referencesGeometry=t.scriptTouchesGeometry(this._syntaxTree);this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale")}g.create=function(){var p=E._asyncToGenerator(function*(t,e,c,a,b,h){const {arcade:l,Feature:d,Dictionary:q}=yield x(),n=z.fromJSON(e);
e=l.parseScript(t,h);b=b.reduce((D,F)=>({...D,[F]:null}),{});let B=null;v.isSome(a)&&(B=new q(a),B.immutable=!0,b.$config=null);a=l.scriptUsesGeometryEngine(e)&&l.enableGeometrySupport();h=l.scriptUsesFeatureSet(e)&&l.enableFeatureSetSupport();const A=l.scriptIsAsync(e)&&l.enableAsyncSupport();b={vars:b,spatialReference:n,useAsync:!!A};const w=new q;w.immutable=!1;w.setField("scale",0);const y=l.compileScript(e,b);yield Promise.all([a,h,A]);return new g(t,l,q,e,D=>{"$view"in D&&D.$view&&(w.setField("scale",
D.$view.scale),D.$view=w);B&&(D.$config=B);return y({vars:D,spatialReference:n})},new d,c,n)});return function(t,e,c,a,b,h){return p.apply(this,arguments)}}();var m=g.prototype;m.repurposeFeature=function(p){p.geometry&&!p.geometry.spatialReference&&(p.geometry.spatialReference=this._spatialReference);this._arcadeFeature.repurposeFromGraphicLikeObject(p.geometry,p.attributes,{fields:this.fields});return this._arcadeFeature};m.createDictionary=function(){return new this._arcadeDictionary};m.referencesMember=
function(p){return this._arcade.referencesMember(this._syntaxTree,p)};m.referencesFunction=function(p){return this._arcade.referencesFunction(this._syntaxTree,p)};m.referencesGeometry=function(){return this._referencesGeometry};m.referencesScale=function(){return this._referencesScale};m.extractFieldLiterals=function(){return this._arcade.extractExpectedFieldLiterals(this._syntaxTree)};return g}();u.ArcadeExpression=k;u.createDictionaryExpression=(g,m,p,t)=>k.create(g,m,p,t,["$feature","$view"]);
u.createLabelExpression=(g,m,p)=>k.create(g,m,p,null,["$feature"]);u.createRendererExpression=C;u.createVVExpression=C;u.loadArcade=x;Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Error ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./utils".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t){function e(){return new Promise((h,l)=>r(["../../../geometry/geometryEngineJSON"],h,l))}function c(){c=E._asyncToGenerator(function*(h,l,d){const {spatialRel:q,geometry:n}=h;if(n){if(!0!==b.spatialRelationship[q])throw new C("feature-store:unsupported-query","Unsupported query spatial relationship",{query:h});if(f.isValid(n.spatialReference)&&f.isValid(d)){if(!0!==b.queryGeometry[x.getJsonType(n)])throw new C("feature-store:unsupported-query","Unsupported query geometry type",
{query:h});if(!0!==b.layerGeometry[l])throw new C("feature-store:unsupported-query","Unsupported layer geometry type",{query:h});if(h.outSR)return p.checkProjectionSupport(h.geometry&&h.geometry.spatialReference,h.outSR)}}});return c.apply(this,arguments)}const a={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",
esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},b={spatialRelationship:{esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},queryGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},
layerGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1}};u.canQueryWithRBush=function(h){if(x.isExtent(h))return!0;if(x.isPolygon(h)){for(const l of h.rings)if(5!==l.length||l[0][0]!==l[1][0]||l[0][0]!==l[4][0]||l[2][0]!==l[3][0]||l[0][1]!==l[3][1]||l[0][1]!==l[4][1]||l[1][1]!==l[2][1])return!1;return!0}return!1};u.checkSpatialQuerySupport=function(h,l,d){return c.apply(this,arguments)};u.getSpatialQueryOperator=function(h,
l,d,q,n){if(x.isPolygon(l)&&"esriGeometryPoint"===d&&("esriSpatialRelIntersects"===h||"esriSpatialRelContains"===h)){const B=g.convertFromPolygon(new m,l,!1,!1);return Promise.resolve(A=>k.polygonContainsPoint(B,!1,!1,A))}if(x.isPolygon(l)&&"esriGeometryMultipoint"===d){const B=g.convertFromPolygon(new m,l,!1,!1);if("esriSpatialRelContains"===h)return Promise.resolve(A=>k.polygonContainsMultipoint(B,!1,!1,A,q,n))}if(x.isExtent(l)&&"esriGeometryPoint"===d&&("esriSpatialRelIntersects"===h||"esriSpatialRelContains"===
h))return Promise.resolve(B=>v.extentContainsPoint(l,t.getGeometry(d,q,n,B)));if(x.isExtent(l)&&"esriGeometryMultipoint"===d&&"esriSpatialRelContains"===h)return Promise.resolve(B=>v.extentContainsMultipoint(l,t.getGeometry(d,q,n,B)));if(x.isExtent(l)&&"esriSpatialRelIntersects"===h){const B=z.getExtentIntersector(d);return Promise.resolve(A=>B(l,t.getGeometry(d,q,n,A)))}return e().then(B=>{const A=B[a[h]].bind(null,l.spatialReference,l);return w=>A(t.getGeometry(d,q,n,w))})};Object.defineProperties(u,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/support/intersects":function(){define(["exports","./intersectsBase"],function(r,u){r.extentIntersectsExtent=u.extentIntersectsExtent;r.extentIntersectsMultipoint=u.extentIntersectsMultipoint;r.extentIntersectsPoint=u.extentIntersectsPoint;r.extentIntersectsPolygon=u.extentIntersectsPolygon;r.extentIntersectsPolyline=u.extentIntersectsPolyline;r.extentIntersectsRings=u.extentIntersectsRings;r.getFeatureExtentIntersector=
u.getFeatureExtentIntersector;r.isSelfIntersecting=u.isSelfIntersecting;r.segmentIntersects=u.segmentIntersects;r.getExtentIntersector=function(E){return"mesh"===E?u.extentIntersectsExtent:u.getFeatureExtentIntersector(E)};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/contains":function(){define(["exports"],function(r){function u(E,C,v,z,x){if(!E)return!1;C=C?v?4:3:v?3:2;const {coords:f,lengths:k}=E;v=!1;E=0;for(const m of k){var g=
E;for(let p=E,t=E+m*C;p<t;p+=C){g=p+C;g===t&&(g=E);const e=f[p],c=f[p+1],a=f[g];g=f[g+1];(c<x&&g>=x||g<x&&c>=x)&&e+(x-c)/(g-c)*(a-e)<z&&(v=!v)}E+=m*C}return v}r.polygonContainsCoords=u;r.polygonContainsMultipoint=function(E,C,v,z,x,f){x=x?f?4:3:f?3:2;const {coords:k,lengths:g}=z;if(!g)return!1;for(let m=0,p=0;m<g.length;m++,p+=x)if(!u(E,C,v,k[p],k[p+1]))return!1;return!0};r.polygonContainsPoint=function(E,C,v,z){return u(E,C,v,z.coords[0],z.coords[1])};Object.defineProperties(r,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/data/timeSupport":function(){define(["exports"],function(r){function u(v,z,x,f,k){if(null!=f&&null!=k)return g=>{const m=v.getAttribute(g,z);g=v.getAttribute(g,x);return(null==m||m<=k)&&(null==g||g>=f)};if(null!=f)return g=>{g=v.getAttribute(g,x);return null==g||g>=f};if(null!=k)return g=>{g=v.getAttribute(g,z);return null==g||g<=k}}function E(v,z,x,f){if(null!=x&&null!=f&&x===f)return k=>v.getAttribute(k,z)===x;if(null!=x&&null!=f)return k=>
{k=v.getAttribute(k,z);return k>=x&&k<=f};if(null!=x)return k=>v.getAttribute(k,z)>=x;if(null!=f)return k=>v.getAttribute(k,z)<=f}function C(){return()=>!1}r.getTimeExtent=function(v,z){if(!v)return null;const x=z.featureAdapter,{startTimeField:f,endTimeField:k}=v;let g=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY;if(f&&k)z.forEach(p=>{const t=x.getAttribute(p,f);p=x.getAttribute(p,k);null==t||isNaN(t)||(g=Math.min(g,t));null==p||isNaN(p)||(m=Math.max(m,p))});else{const p=f||k;z.forEach(t=>
{t=x.getAttribute(t,p);null==t||isNaN(t)||(g=Math.min(g,t),m=Math.max(m,t))})}return{start:g,end:m}};r.getTimeOperator=function(v,z,x){if(!z||!v)return null;const {startTimeField:f,endTimeField:k}=v;if(!f&&!k)return null;const {start:g,end:m}=z;return null===g&&null===m?null:void 0===g&&void 0===m?C():f&&k?u(x,f,k,g,m):E(x,f||k,g,m)};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/FieldsIndex":function(){define(["../../chunks/_rollupPluginBabelHelpers",
"./fieldUtils"],function(r,u){function E(v){return"oid"===v.type||"esriFieldTypeOID"===v.type}function C(v){return"global-id"===v.type||"esriFieldTypeGlobalID"===v.type}return function(){function v(x){this.fields=x;this._fieldsMap=new Map;this._dateFieldsSet=new Set;this._numericFieldsSet=new Set;this.dateFields=[];this.numericFields=[];this._requiredFields=null;if(x){var f=[];for(const k of x)if(x=k&&k.name){const g=x.toLowerCase().trim();this._fieldsMap.set(x,k);this._fieldsMap.set(g,k);f.push(g);
"date"===k.type||"esriFieldTypeDate"===k.type?(this.dateFields.push(k),this._dateFieldsSet.add(k)):u.isNumericField(k)&&(this._numericFieldsSet.add(k),this.numericFields.push(k));E(k)||C(k)||(k.editable=null==k.editable?!0:!!k.editable,k.nullable=null==k.nullable?!0:!!k.nullable)}f.sort();this.uid=f.join(",")}}var z=v.prototype;z.destroy=function(){this._fieldsMap.clear()};z.has=function(x){return null!=this.get(x)};z.get=function(x){return null!=x?this._fieldsMap.get(x)||this._fieldsMap.get(x.toLowerCase().trim()):
void 0};z.isDateField=function(x){return this._dateFieldsSet.has(this.get(x))};z.isNumericField=function(x){return this._numericFieldsSet.has(this.get(x))};z.normalizeFieldName=function(x){if(x=this.get(x))return x.name};r._createClass(v,[{key:"requiredFields",get:function(){if(!this._requiredFields){this._requiredFields=[];for(const x of this.fields)E(x)||C(x)||x.nullable||void 0!==u.getFieldDefaultValue(x)||this._requiredFields.push(x)}return this._requiredFields}}]);return v}()})},"esri/views/support/Scheduler":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Handles ../../core/Logger ../../core/maybe ../../core/PerformanceSampler ../../core/PooledArray ../../core/promiseUtils ../../core/reactiveUtils ../../core/time ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../layers/support/PromiseQueue ./debugFlags".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t,e,c,a,b,h,l){function d(I){return n.has(I)?n.get(I):"number"===typeof I?I:1}const q=z.getLogger("esri.views.support.Scheduler");r.TaskPriority=void 0;(function(I){I.RESOURCE_CONTROLLER="schedule";I.SLIDE="slide";I.STREAM_DATA_LOADER="stream loader";I.ELEVATION_QUERY="elevation query";I.TERRAIN_SURFACE="terrain";I.SURFACE_GEOMETRY_UPDATES="surface geometry updates";I.GRAPHICS_CORE="Graphics3D";I.I3S_CONTROLLER="I3S";I.POINT_CLOUD_LAYER="point cloud";I.FEATURE_TILE_FETCHER=
"feature fetcher";I.OVERLAY="overlay";I.STAGE="stage";I.GRAPHICS_DECONFLICTOR="graphics deconflictor";I.FILTER_VISIBILITY="Graphics3D filter visibility";I.SCALE_VISIBILITY="Graphics3D scale visibility";I.FRUSTUM_VISIBILITY="Graphics3D frustum visibility";I.POINT_OF_INTEREST_FREQUENT="POI frequent";I.POINT_OF_INTEREST_INFREQUENT="POI infrequent";I.LABELER="labeler";I.FEATURE_QUERY_ENGINE="feature query";I.FEATURE_TILE_TREE="feature tile tree";I.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree";I.ELEVATION_ALIGNMENT=
"elevation alignment";I.TEXT_TEXTURE_ATLAS="text texture atlas";I.TEXTURE_UNLOAD="texture unload";I.LINE_OF_SIGHT_TOOL="line of sight tool";I.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool";I.ELEVATION_PROFILE="elevation profile";I.SNAPPING="snapping";I.SHADOW_ACCUMULATOR="shadow accumulator";I.CLOUDS_GENERATOR="cloud generator";I[I.TEST_PRIO=1]="TEST_PRIO"})(r.TaskPriority||(r.TaskPriority={}));const n=new Map([[r.TaskPriority.RESOURCE_CONTROLLER,0],[r.TaskPriority.SLIDE,0],[r.TaskPriority.STREAM_DATA_LOADER,
0],[r.TaskPriority.ELEVATION_QUERY,0],[r.TaskPriority.TERRAIN_SURFACE,1],[r.TaskPriority.SURFACE_GEOMETRY_UPDATES,1],[r.TaskPriority.GRAPHICS_CORE,2],[r.TaskPriority.I3S_CONTROLLER,2],[r.TaskPriority.POINT_CLOUD_LAYER,2],[r.TaskPriority.FEATURE_TILE_FETCHER,2],[r.TaskPriority.OVERLAY,4],[r.TaskPriority.STAGE,4],[r.TaskPriority.GRAPHICS_DECONFLICTOR,4],[r.TaskPriority.FILTER_VISIBILITY,4],[r.TaskPriority.SCALE_VISIBILITY,4],[r.TaskPriority.FRUSTUM_VISIBILITY,4],[r.TaskPriority.POINT_OF_INTEREST_FREQUENT,
6],[r.TaskPriority.POINT_OF_INTEREST_INFREQUENT,30],[r.TaskPriority.LABELER,8],[r.TaskPriority.FEATURE_QUERY_ENGINE,8],[r.TaskPriority.FEATURE_TILE_TREE,16],[r.TaskPriority.FEATURE_TILE_TREE_ACTIVE,0],[r.TaskPriority.ELEVATION_ALIGNMENT,12],[r.TaskPriority.TEXT_TEXTURE_ATLAS,12],[r.TaskPriority.CLOUDS_GENERATOR,12],[r.TaskPriority.TEXTURE_UNLOAD,12],[r.TaskPriority.LINE_OF_SIGHT_TOOL,16],[r.TaskPriority.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[r.TaskPriority.SNAPPING,0],[r.TaskPriority.SHADOW_ACCUMULATOR,
30]]);r.State=void 0;(function(I){I[I.ANIMATING=0]="ANIMATING";I[I.INTERACTING=1]="INTERACTING";I[I.IDLE=2]="IDLE"})(r.State||(r.State={}));const B=p.Milliseconds(6.5),A=p.Milliseconds(1),w=p.Milliseconds(30),y=p.Milliseconds(1E3/30),D=p.Milliseconds(100);var F;(function(I){let H=function(P){function ba(){var S=P.call(this)||this;S.updating=!0;S._microTaskQueued=!1;S.performanceInfo={total:new f("total"),tasks:new Map};S._frameTaskTimes=new Map;S._budget=new N;S._state=r.State.INTERACTING;S._tasks=
new k;S._runQueue=new k;S._load=0;S._idleStateCallbacks=new k;S._idleUpdatesStartFired=!1;S._maxReschedule=J;S._forceTask=!1;S._debug=!1;S._debugHandle=m.watch(()=>l.SCHEDULER_LOG_SLOW_TASKS,Z=>S._debug=Z,m.initial);for(const Z of Object.keys(r.TaskPriority))S.performanceInfo.tasks.set(r.TaskPriority[Z],new f(r.TaskPriority[Z]));let W;const R=u._assertThisInitialized(S);S._test={get state(){return x.unwrapOr(W,R._state)},set state(Z){W=Z},FRAME_SAFETY_BUDGET:B,INTERACTING_BUDGET:y,IDLE_BUDGET:D,get availableBudget(){return R._budget.budget},
usedBudget:0,getBudget:()=>R._budget,setBudget:Z=>R._budget=Z,updateTask:Z=>S._updateTask(Z),getState:Z=>S._getState(Z),getRuntime:Z=>S._getRuntime(Z),frameTaskTimes:S._frameTaskTimes,resetRuntimes:()=>S._resetRuntimes(),getRunning:()=>S._getRunning()};return S}u._inheritsLoose(ba,P);var X=ba.prototype;X.destroy=function(){this._tasks.toArray().forEach(S=>S.remove());this._tasks.clear();x.removeMaybe(this._debugHandle);this.updating=this._microTaskQueued=!1};X.activate=function(){this._budget.done||
this._microTaskQueued||(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.done||(this._maxReschedule=J,this._schedule(),this.frame()))}))};X.registerTask=function(S,W){const R=d(S);W=new M(this,S,W,R);this._tasks.push(W);this.performanceInfo.tasks.has(S)||this.performanceInfo.tasks.set(S,new f(S));return W};X.registerIdleStateCallbacks=function(S,W){const R={idleBegin:S,idleEnd:W};this._idleStateCallbacks.push(R);this.state===r.State.IDLE&&
this._idleUpdatesStartFired&&R.idleBegin();const Z=this;return{remove:()=>this._removeIdleStateCallbacks(R),set idleBegin(ka){Z._idleUpdatesStartFired&&(R.idleEnd(),Z._state===r.State.IDLE&&ka());R.idleBegin=ka},set idleEnd(ka){R.idleEnd=ka}}};X.updateBudget=function(S){this._test.usedBudget=0;let W=B,R=S.frameDuration,Z=A;switch(this.state){case r.State.IDLE:W=p.Milliseconds(0);R=p.Milliseconds(Math.max(D,S.frameDuration));Z=w;break;case r.State.INTERACTING:R=p.Milliseconds(Math.max(y,S.frameDuration))}R=
p.Milliseconds(R-S.elapsedFrameTime-W);if(this.state!==r.State.IDLE&&R<A&&!this._forceTask)return this._forceTask=!0,!1;R=p.Milliseconds(Math.max(R,Z));this._budget.reset(R,this.state);this._maxReschedule=J;this._updateLoad();return this._schedule()};X.frame=function(){this._microTaskQueued=this._forceTask=!1;switch(this.state){case r.State.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll(S=>S.idleBegin()));this._runIdle();break;case r.State.INTERACTING:this._runInteracting();
break;default:this._runAnimating()}this._test.usedBudget=this._budget.elapsed};X.stopFrame=function(){this._budget.reset(p.Milliseconds(0),this._state);this._budget.madeProgress()};X._removeIdleStateCallbacks=function(S){this._idleUpdatesStartFired&&S.idleEnd();this._idleStateCallbacks.removeUnordered(S)};X.removeTask=function(S){this._tasks.removeUnordered(S);this._runQueue.removeUnordered(S)};X._updateTask=function(S){this._tasks.forAll(W=>{W.name===S&&W.setPriority(S)})};X._getState=function(S){if(this._runQueue.some(R=>
R.name===S))return r.TaskState.SCHEDULED;let W=r.TaskState.IDLE;this._tasks.forAll(R=>{R.name===S&&R.needsUpdate&&(1>=R.schedulePriority?W=r.TaskState.READY:W!==r.TaskState.READY&&(W=r.TaskState.WAITING))});return W};X._getRuntime=function(S){let W=0;this._tasks.forAll(R=>{R.name===S&&(W+=R.runtime)});return W};X._resetRuntimes=function(){this._tasks.forAll(S=>S.runtime=0)};X._getRunning=function(){const S=new Map;this._tasks.forAll(R=>{R.needsUpdate&&S.set(R.name,(S.get(R.name)||0)+1)});if(0===S.size)return null;
let W="";S.forEach((R,Z)=>{W=1<R?W+` ${R}x ${Z}`:W+` ${Z}`});return W};X._runIdle=function(){this._run()};X._runInteracting=function(){this._run()};X._runAnimating=function(){this._run()};X._updateLoad=function(){const S=this._tasks.reduce((W,R)=>R.needsUpdate?++W:W,0);this._load=.9*this._load+S*(1-.9)};X._schedule=function(){if(0>=this._maxReschedule)return!1;this._runQueue.filterInPlace(S=>{if(S.needsUpdate)return!0;S.schedulePriority=S.basePriority;return!1});for(this._tasks.forAll(S=>{0===S.basePriority&&
S.needsUpdate&&!this._runQueue.includes(S)&&this._runQueue.unshift(S)});0===this._runQueue.length;){let S=!1,W=0;this._tasks.forAll(R=>{if(R.needsUpdate&&0!==R.schedulePriority&&0!==R.basePriority)switch(S=!0,W=Math.max(W,R.basePriority),R.schedulePriority){case 1:R.schedulePriority=0;this._runQueue.push(R);break;default:--R.schedulePriority}});if(!S)return this.updating=!1;this._maxReschedule===J&&(this._maxReschedule=W);--this._maxReschedule}return this.updating=!0};X._run=function(){const S=this._budget.now();
this._startFrameTaskTimes();do for(;0<this._runQueue.length;){var W=this._budget.now();const R=this._runQueue.pop();this._budget.resetProgress();try{R.task.runTask(this._budget)}catch(Z){q.error(`Exception in task "${R.name}"`,Z)}R.schedulePriority=R.basePriority;W=this._budget.now()-W;R.runtime+=W;this._frameTaskTimes.set(R.priority,this._frameTaskTimes.get(R.priority)+W);this._debug&&this._budget.elapsed>2*this._budget.budget&&console.log("Task",R.name,"used",this._budget.elapsed,"of max",this._budget.budget,
"ms");if(0>=this._budget.remaining){this.updating=this._tasks.some(Z=>Z.needsUpdate);this._recordFrameTaskTimes(this._budget.now()-S);return}}while(this._schedule());this.updating=this._tasks.some(R=>R.needsUpdate);this._recordFrameTaskTimes(this._budget.now()-S)};X._startFrameTaskTimes=function(){for(const S of Object.keys(r.TaskPriority))this._frameTaskTimes.set(r.TaskPriority[S],0)};X._recordFrameTaskTimes=function(S){this._frameTaskTimes.forEach((W,R)=>this.performanceInfo.tasks.get(R).record(W));
this.performanceInfo.total.record(S)};u._createClass(ba,[{key:"load",get:function(){return this._load}},{key:"state",get:function(){return x.isNone(this._test.state)?this._state:this._test.state},set:function(S){this._state!==S&&(this._state=S,this.state!==r.State.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll(W=>W.idleEnd())))}},{key:"test",get:function(){return this._test}}]);return ba}(C);E.__decorate([t.property()],H.prototype,"updating",void 0);
H=E.__decorate([b.subclass("esri.views.support.Scheduler")],H);I.Scheduler=H;let M=function(P){function ba(S,W,R,Z){var ka=P.call(this,{})||this;ka._scheduler=S;ka.name=W;ka._basePriority=Z;ka.runtime=0;ka._queue=new h.PromiseQueue;ka._handles=new v;ka.schedulePriority=ka._basePriority;ka.task=x.isSome(R)?R:ka._queue;ka._handles.add(m.when(()=>ka.task.running,()=>S.activate()));return ka}u._inheritsLoose(ba,P);var X=ba.prototype;X.normalizeCtorArgs=function(){return{}};X.remove=function(){this.processQueue(G);
this._scheduler.removeTask(this);this.schedule=K.schedule;this.reschedule=K.reschedule;this._handles.destroy()};X.setPriority=function(S){this.name=S;S=d(S);if(0===this._basePriority||0!==this.schedulePriority)this.schedulePriority=S;this._basePriority=S};X.schedule=function(S,W,R){return this._queue.push(S,W,R)};X.reschedule=function(S,W,R){return this._queue.unshift(S,W,R)};X.processQueue=function(S){this._queue.runTask(S)};u._createClass(ba,[{key:"updating",get:function(){return this._queue.running}},
{key:"basePriority",get:function(){return this._basePriority}},{key:"priority",get:function(){return this.name},set:function(S){this.setPriority(S)}},{key:"needsUpdate",get:function(){return this.updating||this.task.running}}]);return ba}(C);E.__decorate([t.property({constructOnly:!0})],M.prototype,"task",void 0);E.__decorate([t.property({readOnly:!0})],M.prototype,"updating",null);M=E.__decorate([b.subclass("esri.views.support.SchedulerTask")],M);let N=function(){function P(){this._begin="undefined"!==
typeof performance?performance.now():0;this._budget=0;this._state=r.State.IDLE;this._didWork=!1;this._enabled=!0}var ba=P.prototype;ba.run=function(X){if(this.done)return!1;!0===X()&&(this._didWork=!0);return!0};ba.madeProgress=function(){this._didWork=!0};ba.reset=function(X,S){this._begin=this.now();this._budget=X;this._state=S;this._didWork=!1};ba.now=function(){return performance.now()};ba.resetProgress=function(){this._didWork=!1};u._createClass(P,[{key:"done",get:function(){return this._didWork&&
this.elapsed>=this._budget&&this._enabled}},{key:"budget",get:function(){return this._budget}},{key:"state",get:function(){return this._state}},{key:"enabled",get:function(){return this._enabled},set:function(X){this._enabled=X}},{key:"remaining",get:function(){return Math.max(this._budget-this.elapsed,0)}},{key:"elapsed",get:function(){return performance.now()-this._begin}},{key:"hasProgressed",get:function(){return this._didWork}}]);return P}();I.Budget=N})(F||(F={}));r.TaskState=void 0;(function(I){I.SCHEDULED=
"s";I.READY="r";I.WAITING="w";I.IDLE="i"})(r.TaskState||(r.TaskState={}));const G=(()=>{const I=new F.Budget;I.enabled=!1;return I})(),K=new (function(){function I(){}var H=I.prototype;H.remove=function(){};H.processQueue=function(){};H.schedule=function(M,N,P){try{if(g.isAborted(N)){const ba=g.createAbortError();return P?Promise.resolve(P(ba)):Promise.reject(ba)}return g.when(M(G))}catch(ba){return Promise.reject(ba)}};H.reschedule=function(M,N,P){return this.schedule(M,N,P)};return I}()),J=Number.MAX_SAFE_INTEGER;
r.ImmediateTask=K;r.getTaskPriority=d;r.newScheduler=function(){return new F.Scheduler};r.noBudget=G;r.taskPriorities=n;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/PromiseQueue":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(r,u,E,C,v,z,x,f,k,g){r.PromiseQueue=function(p){function t(){var c=p.apply(this,arguments)||this;c._tasks=[];c.running=!1;return c}u._inheritsLoose(t,p);var e=t.prototype;e.destroy=function(){this.cancelAll()};e.runTask=function(c){for(;!c.done&&this._process(c);)c.madeProgress()};e.push=function(c,a,b){this.running=!0;return new Promise((h,l)=>this._tasks.push(new m(h,l,c,a,b)))};e.unshift=function(c,a,b){this.running=!0;return new Promise((h,l)=>this._tasks.unshift(new m(h,l,c,a,b)))};
e._process=function(c){if(0===this._tasks.length)return!1;const a=this._tasks.shift();try{const b=v.isAborted(a.signal);if(b&&!a.abortCallback)a.reject(v.createAbortError());else{const h=b?a.abortCallback(v.createAbortError()):a.callback(c);v.isPromiseLike(h)?h.then(a.resolve,a.reject):a.resolve(h)}}catch(b){a.reject(b)}this.running=0<this._tasks.length;return!0};e.cancelAll=function(){const c=v.createAbortError();for(const a of this._tasks)if(a.abortCallback){const b=a.abortCallback(c);a.resolve(b)}else a.reject(c);
this._tasks.length=0;this.running=!1};u._createClass(t,[{key:"length",get:function(){return this._tasks.length}}]);return t}(C);E.__decorate([z.property()],r.PromiseQueue.prototype,"running",void 0);r.PromiseQueue=E.__decorate([g.subclass("esri.layers.support.PromiseQueue")],r.PromiseQueue);let m=function(p,t,e,c,a){this.resolve=p;this.reject=t;this.callback=e;this.signal=c;this.abortCallback=a};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/support/debugFlags":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(r,u,E,C,v,z,x,f){E=function(k){function g(){var m=k.apply(this,arguments)||this;m.SCHEDULER_LOG_SLOW_TASKS=!1;m.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1;return m}r._inheritsLoose(g,k);return g}(E);u.__decorate([C.property()],E.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0);u.__decorate([C.property()],E.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0);E=u.__decorate([f.subclass("esri.views.support.DebugFlags")],E);return new E})},"esri/views/2d/layers/features/FeatureStore2D":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/CircularArray ../../../../core/Evented ../../../../core/has ../../../../core/maybe ../../../../chunks/rbush ../../../../geometry/support/aaBoundingBox ./Store2D ./support/FeatureSetReaderPBFIndirect".split(" "),
function(r,u,E,C,v,z,x,f,k,g){const m={getObjectId(p){return p.getObjectId()},getAttributes(p){return p.readAttributes()},getAttribute(p,t){return p.readAttribute(t)},cloneWithGeometry(p,t){return p},getGeometry(p){return p.readHydratedGeometry()},getCentroid(p,t){return p.readCentroid()}};v=function(p){function t(c,a,b){var h=p.call(this,c,a)||this;h.featureAdapter=m;h.events=new C;h._featureSetsByInstance=new Map;h._objectIdToDisplayId=new Map;h._spatialIndexInvalid=!0;h._indexSearchCache=new E(50);
h._index=x.rbush(9,l=>({minX:h._storage.getXMin(l),minY:h._storage.getYMin(l),maxX:h._storage.getXMax(l),maxY:h._storage.getYMax(l)}));h.mode=b;return h}u._inheritsLoose(t,p);var e=t.prototype;e.hasInstance=function(c){return this._featureSetsByInstance.has(c)};e.onTileData=function(c,a){if(z.isNone(a.addOrUpdate))return a;a.addOrUpdate.attachStorage(this._storage);if("snapshot"===this.mode){for(var b=a.addOrUpdate.getCursor();b.next();){const h=b.getDisplayId();this.setComputedAttributes(this._storage,
b,h,c.scale)}return a}this._featureSetsByInstance.set(a.addOrUpdate.instance,a.addOrUpdate);for(b=a.addOrUpdate.getCursor();b.next();)this._insertFeature(b,c.scale);this._spatialIndexInvalid=!0;this.events.emit("changed");return a};e.search=function(c){this._rebuildIndex();const a=c.id;var b=this._indexSearchCache.find(d=>d.tileId===a);if(z.isSome(b))return b.readers;b=new Map;c=this._searchIndex(c.bounds);const h=[];for(const d of c){var l=this._storage.getInstanceId(d);c=(4294901760&l)>>>16;l&=
65535;b.has(c)||b.set(c,[]);b.get(c).push(l)}b.forEach((d,q)=>{q=this._featureSetsByInstance.get(q);h.push(g.FeatureSetReaderIndirect.from(q,d))});this._indexSearchCache.enqueue({tileId:a,readers:h});return h};e.insert=function(c){const a=c.getCursor(),b=this._storage;for(;a.next();){var h,l=a.getIndex();l|=a.instance<<16;const d=a.getObjectId(),q=null!=(h=this._objectIdToDisplayId.get(d))?h:this._storage.createDisplayId();a.setDisplayId(q);b.setInstanceId(q,l);this._objectIdToDisplayId.set(d,q)}this._featureSetsByInstance.set(c.instance,
c);this._spatialIndexInvalid=!0};e.remove=function(c){const a=this._objectIdToDisplayId.get(c);if(a){var b=this._storage.getInstanceId(a),h=65535&b;b=(4294901760&b)>>>16;var l=this._featureSetsByInstance.get(b);this._objectIdToDisplayId.delete(c);this._storage.releaseDisplayId(a);l.removeAtIndex(h);l.isEmpty&&this._featureSetsByInstance.delete(b);this._spatialIndexInvalid=!0}};e.toArray=function(){const c=[];this.forEach(a=>c.push(a));return c};e.forEach=function(c){this._objectIdToDisplayId.forEach(a=>
{a=this._storage.getInstanceId(a);a=this._lookupFeature(a);c(a)})};e.forEachUnsafe=function(c){this._objectIdToDisplayId.forEach(a=>{var b=this._storage.getInstanceId(a);a=65535&b;b=this._getFeatureSet((4294901760&b)>>>16);b.setIndex(a);c(b)})};e.forEachInBounds=function(c,a){c=this._searchIndex(c);for(const b of c)c=this.lookupFeatureByDisplayId(b,this._storage),a(z.unwrap(c))};e.forEachBounds=function(c,a,b){this._rebuildIndex();const h=[0,0,0,0];for(const l of c)l.readGeometry()&&(c=l.getDisplayId(),
h[0]=this._storage.getXMin(c),h[1]=this._storage.getYMin(c),h[2]=this._storage.getXMax(c),h[3]=this._storage.getYMax(c),a(f.fromRect(b,h)))};e.sweepFeatures=function(c,a,b){this._spatialIndexInvalid=!0;this._objectIdToDisplayId.forEach((h,l)=>{c.has(h)||(a.releaseDisplayId(h),b&&b.unsetAttributeData(h),this._objectIdToDisplayId.delete(l))});this.events.emit("changed")};e.sweepFeatureSets=function(c){this._spatialIndexInvalid=!0;this._featureSetsByInstance.forEach((a,b)=>{c.has(b)||this._featureSetsByInstance.delete(b)})};
e.lookupObjectId=function(c,a){c=this.lookupFeatureByDisplayId(c,a);return z.isNone(c)?null:c.getObjectId()};e.lookupDisplayId=function(c){return this._objectIdToDisplayId.get(c)};e.lookupFeatureByDisplayId=function(c,a){c=a.getInstanceId(c);return this._lookupFeature(c)};e.lookupByDisplayIdUnsafe=function(c){var a=this._storage.getInstanceId(c);c=65535&a;a=this._getFeatureSet((4294901760&a)>>>16);if(!a)return null;a.setIndex(c);return a};e._insertFeature=function(c,a){const b=this._storage,h=c.getObjectId();
var l=c.getIndex();l|=c.instance<<16;b.getInstanceId(c.getDisplayId());let d=this._objectIdToDisplayId.get(h);d||(d=b.createDisplayId(),this._objectIdToDisplayId.set(h,d),this._spatialIndexInvalid=!0);c.setDisplayId(d);b.setInstanceId(d,l);this.setComputedAttributes(b,c,d,a)};e._searchIndex=function(c){this._rebuildIndex();return this._index.search({minX:c[0],minY:c[1],maxX:c[2],maxY:c[3]})};e._rebuildIndex=function(){if(this._spatialIndexInvalid){var c=[];"snapshot"===this.mode?this._featureSetsByInstance.forEach(a=>
{for(a=a.getCursor();a.next();){const b=a.getDisplayId();this._storage.setBounds(b,a)&&c.push(b)}}):this._objectIdToDisplayId.forEach(a=>{const b=this._storage.getInstanceId(a);this._storage.setBounds(a,this._lookupFeature(b))&&c.push(a)});this._index.clear();this._index.load(c);this._indexSearchCache.clear();this._spatialIndexInvalid=!1}};e._lookupFeature=function(c){var a=this._getFeatureSet((4294901760&c)>>>16);if(!a)return null;a=a.getCursor();a.setIndex(65535&c);return a};e._getFeatureSet=function(c){return this._featureSetsByInstance.get(c)};
u._createClass(t,[{key:"storeStatistics",get:function(){let c=0,a=0,b=0;this.forEach(h=>{if(h=h.readGeometry())a+=h.isPoint?1:h.lengths.reduce((l,d)=>l+d,0),b+=h.isPoint?1:h.lengths.length,c+=1});return{featureCount:c,vertexCount:a,ringCount:b}}}]);return t}(k.Store2D);r.FeatureStore2D=v;r.featureAdapter=m;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/CircularArray":function(){define(["../chunks/_rollupPluginBabelHelpers","./maybe"],function(r,
u){return function(){function E(v){this._start=this.size=0;this.maxSize=v;this._buffer=Array(v)}var C=E.prototype;C.enqueue=function(v){if(this.size===this.maxSize){const z=this._buffer[this._start];this._buffer[this._start]=v;this._start=(this._start+1)%this.maxSize;return z}this._buffer[(this._start+this.size++)%this.maxSize]=v;return null};C.dequeue=function(){if(0===this.size)return null;const v=this._buffer[this._start];this._buffer[this._start]=null;this.size--;this._start=(this._start+1)%this.maxSize;
return v};C.peek=function(){return 0===this.size?null:this._buffer[this._start]};C.find=function(v){if(0===this.size)return null;for(const z of this._buffer)if(u.isSome(z)&&v(z))return z;return null};C.clear=function(v){let z=this.dequeue();for(;u.isSome(z);)v&&v(z),z=this.dequeue()};r._createClass(E,[{key:"entries",get:function(){return this._buffer}}]);return E}()})},"esri/chunks/rbush":function(){define(["exports","./quickselect"],function(r,u){function E(c,a){if(!(this instanceof E))return new E(c,
a);this._maxEntries=Math.max(4,c||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));a&&("function"===typeof a?this.toBBox=a:this._initFormat(a));this.clear()}function C(c,a){v(c,0,c.children.length,a,c)}function v(c,a,b,h,l){l||(l=t(null));l.minX=Infinity;l.minY=Infinity;l.maxX=-Infinity;l.maxY=-Infinity;for(var d;a<b;a++)d=c.children[a],z(l,c.leaf?h(d):d);return l}function z(c,a){c.minX=Math.min(c.minX,a.minX);c.minY=Math.min(c.minY,a.minY);c.maxX=Math.max(c.maxX,a.maxX);c.maxY=Math.max(c.maxY,
a.maxY);return c}function x(c,a){return c.minX-a.minX}function f(c,a){return c.minY-a.minY}function k(c){return(c.maxX-c.minX)*(c.maxY-c.minY)}function g(c){return c.maxX-c.minX+(c.maxY-c.minY)}function m(c,a){return c.minX<=a.minX&&c.minY<=a.minY&&a.maxX<=c.maxX&&a.maxY<=c.maxY}function p(c,a){return a.minX<=c.maxX&&a.minY<=c.maxY&&a.maxX>=c.minX&&a.maxY>=c.minY}function t(c){return{children:c,height:1,leaf:!0,minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function e(c,a,b,h,l){for(var d=
[a,b],q;d.length;)b=d.pop(),a=d.pop(),b-a<=h||(q=a+Math.ceil((b-a)/h/2)*h,u.quickselect(c,q,a,b,l),d.push(a,q,q,b))}E.prototype={all:function(){return this._all(this.data,[])},search:function(c){var a=this.data,b=[],h=this.toBBox;if(!p(c,a))return b;for(var l=[],d,q,n,B;a;){d=0;for(q=a.children.length;d<q;d++)n=a.children[d],B=a.leaf?h(n):n,p(c,B)&&(a.leaf?b.push(n):m(c,B)?this._all(n,b):l.push(n));a=l.pop()}return b},collides:function(c){var a=this.data,b=this.toBBox;if(!p(c,a))return!1;for(var h=
[],l,d,q,n;a;){l=0;for(d=a.children.length;l<d;l++)if(q=a.children[l],n=a.leaf?b(q):q,p(c,n)){if(a.leaf||m(c,n))return!0;h.push(q)}a=h.pop()}return!1},load:function(c){if(!c||!c.length)return this;if(c.length<this._minEntries){for(var a=0,b=c.length;a<b;a++)this.insert(c[a]);return this}c=this._build(c.slice(),0,c.length-1,0);this.data.children.length?this.data.height===c.height?this._splitRoot(this.data,c):(this.data.height<c.height&&(a=this.data,this.data=c,c=a),this._insert(c,this.data.height-
c.height-1,!0)):this.data=c;return this},insert:function(c){c&&this._insert(c,this.data.height-1);return this},clear:function(){this.data=t([]);return this},remove:function(c,a){if(!c)return this;for(var b=this.data,h=this.toBBox(c),l=[],d=[],q,n,B,A;b||l.length;){b||(b=l.pop(),n=l[l.length-1],q=d.pop(),A=!0);if(b.leaf){a:{B=c;var w=b.children,y=a;if(y){for(var D=0;D<w.length;D++)if(y(B,w[D])){B=D;break a}B=-1}else B=w.indexOf(B)}if(-1!==B){b.children.splice(B,1);l.push(b);this._condense(l);break}}A||
b.leaf||!m(b,h)?n?(q++,b=n.children[q],A=!1):b=null:(l.push(b),d.push(q),q=0,n=b,b=b.children[0])}return this},toBBox:function(c){return c},compareMinX:x,compareMinY:f,toJSON:function(){return this.data},fromJSON:function(c){this.data=c;return this},_all:function(c,a){for(var b=[];c;)c.leaf?a.push.apply(a,c.children):b.push.apply(b,c.children),c=b.pop();return a},_build:function(c,a,b,h){var l=b-a+1,d=this._maxEntries;if(l<=d){var q=t(c.slice(a,b+1));C(q,this.toBBox);return q}h||(h=Math.ceil(Math.log(l)/
Math.log(d)),d=Math.ceil(l/Math.pow(d,h-1)));q=t([]);q.leaf=!1;q.height=h;l=Math.ceil(l/d);d=l*Math.ceil(Math.sqrt(d));var n;for(e(c,a,b,d,this.compareMinX);a<=b;a+=d){var B=Math.min(a+d-1,b);e(c,a,B,l,this.compareMinY);for(n=a;n<=B;n+=l){var A=Math.min(n+l-1,B);q.children.push(this._build(c,n,A,h-1))}}C(q,this.toBBox);return q},_chooseSubtree:function(c,a,b,h){for(var l,d,q,n,B,A,w,y;;){h.push(a);if(a.leaf||h.length-1===b)break;w=y=Infinity;l=0;for(d=a.children.length;l<d;l++)q=a.children[l],B=k(q),
A=(Math.max(q.maxX,c.maxX)-Math.min(q.minX,c.minX))*(Math.max(q.maxY,c.maxY)-Math.min(q.minY,c.minY))-B,A<y?(y=A,w=B<w?B:w,n=q):A===y&&B<w&&(w=B,n=q);a=n||a.children[0]}return a},_insert:function(c,a,b){var h=this.toBBox;b=b?c:h(c);h=[];var l=this._chooseSubtree(b,this.data,a,h);l.children.push(c);for(z(l,b);0<=a;)if(h[a].children.length>this._maxEntries)this._split(h,a),a--;else break;this._adjustParentBBoxes(b,h,a)},_split:function(c,a){var b=c[a],h=b.children.length,l=this._minEntries;this._chooseSplitAxis(b,
l,h);h=this._chooseSplitIndex(b,l,h);h=t(b.children.splice(h,b.children.length-h));h.height=b.height;h.leaf=b.leaf;C(b,this.toBBox);C(h,this.toBBox);a?c[a-1].children.push(h):this._splitRoot(b,h)},_splitRoot:function(c,a){this.data=t([c,a]);this.data.height=c.height+1;this.data.leaf=!1;C(this.data,this.toBBox)},_chooseSplitIndex:function(c,a,b){var h,l;var d=l=Infinity;for(h=a;h<=b-a;h++){var q=v(c,0,h,this.toBBox);var n=v(c,h,b,this.toBBox);var B=Math.max(0,Math.min(q.maxX,n.maxX)-Math.max(q.minX,
n.minX))*Math.max(0,Math.min(q.maxY,n.maxY)-Math.max(q.minY,n.minY));q=k(q)+k(n);if(B<d){d=B;var A=h;l=q<l?q:l}else B===d&&q<l&&(l=q,A=h)}return A},_chooseSplitAxis:function(c,a,b){var h=c.leaf?this.compareMinX:x,l=c.leaf?this.compareMinY:f,d=this._allDistMargin(c,a,b,h);a=this._allDistMargin(c,a,b,l);d<a&&c.children.sort(h)},_allDistMargin:function(c,a,b,h){c.children.sort(h);h=this.toBBox;var l=v(c,0,a,h),d=v(c,b-a,b,h),q=g(l)+g(d),n;for(n=a;n<b-a;n++){var B=c.children[n];z(l,c.leaf?h(B):B);q+=
g(l)}for(n=b-a-1;n>=a;n--)B=c.children[n],z(d,c.leaf?h(B):B),q+=g(d);return q},_adjustParentBBoxes:function(c,a,b){for(;0<=b;b--)z(a[b],c)},_condense:function(c){for(var a=c.length-1,b;0<=a;a--)0===c[a].children.length?0<a?(b=c[a-1].children,b.splice(b.indexOf(c[a]),1)):this.clear():C(c[a],this.toBBox)},_initFormat:function(c){var a=["return a"," - b",";"];this.compareMinX=new Function("a","b",a.join(c[0]));this.compareMinY=new Function("a","b",a.join(c[1]));this.toBBox=new Function("a","return {minX: a"+
c[0]+", minY: a"+c[1]+", maxX: a"+c[2]+", maxY: a"+c[3]+"};")}};r.rbush=E})},"esri/chunks/quickselect":function(){define(["exports"],function(r){var u={exports:{}};(function(E){(function(C){C=C();void 0!==C&&(E.exports=C)})(function(){function C(x,f,k,g,m){for(;g>k;){if(600<g-k){var p=g-k+1,t=f-k+1,e=Math.log(p),c=.5*Math.exp(2*e/3);e=.5*Math.sqrt(e*c*(p-c)/p)*(0>t-p/2?-1:1);C(x,f,Math.max(k,Math.floor(f-t*c/p+e)),Math.min(g,Math.floor(f+(p-t)*c/p+e)),m)}p=x[f];t=k;c=g;v(x,k,f);for(0<m(x[g],p)&&v(x,
k,g);t<c;){v(x,t,c);t++;for(c--;0>m(x[t],p);)t++;for(;0<m(x[c],p);)c--}0===m(x[k],p)?v(x,k,c):(c++,v(x,c,g));c<=f&&(k=c+1);f<=c&&(g=c-1)}}function v(x,f,k){var g=x[f];x[f]=x[k];x[k]=g}function z(x,f){return x<f?-1:x>f?1:0}return function(x,f,k,g,m){C(x,f,k||0,g||x.length-1,m||z)}})})(u);r.quickselect=u.exports})},"esri/views/2d/layers/features/Store2D":function(){define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/maybe ../../../../core/accessorSupport/diffUtils ../../../../support/arcadeOnDemand ../../arcade/callExpressionWithCursor".split(" "),
function(r,u,E,C,v,z,x,f){const k=new Promise((m,p)=>r(["../../../../layers/support/labelFormatUtils"],m,p));let g=function(){function m(t,e){this._canCacheExpressionValue=!1;this._sourceInfo=t;this._storage=e;this._bitsets={computed:e.getBitset(e.createBitset())}}var p=m.prototype;p.invalidate=function(){this._bitsets.computed.clear()};p.updateSchema=function(){var t=E._asyncToGenerator(function*(e,c){var a=z.diff(this._schema,c);if((this._schema=c)&&!v.isNone(a)&&z.hasDiff(a,"attributes")){C("esri-2d-update-debug")&&
console.debug("Applying Update - Store:",a);this._bitsets.computed.clear();e.targets[c.name]=!0;e=c.attributes;c=[];a=[];for(const b in e){const h=e[b];switch(h.type){case "expression":c.push(this._createArcadeComputedField(h));break;case "label-expression":c.push(this._createLabelArcadeComputedField(h));break;case "statistic":a.push(h)}}this._computedFields=yield Promise.all(c);this._canCacheExpressionValue=!this._computedFields.some(b=>"expression"===b.type&&b.expression.referencesScale());this._statisticFields=
a}});return function(e,c){return t.apply(this,arguments)}}();p.setComputedAttributes=function(t,e,c,a){var b=this._bitsets.computed;if(!this._canCacheExpressionValue||!b.has(c)){b.set(c);for(const h of this._computedFields)switch(b=this._evaluateField(e,h,a),h.resultType){case "numeric":t.setComputedNumericAtIndex(c,h.fieldIndex,b);break;case "string":t.setComputedStringAtIndex(c,h.fieldIndex,b)}}};p._createArcadeComputedField=function(){var t=E._asyncToGenerator(function*(e){return{...e,expression:yield x.createRendererExpression(e.valueExpression,
this._sourceInfo.spatialReference,this._sourceInfo.fieldsIndex)}});return function(e){return t.apply(this,arguments)}}();p._createLabelArcadeComputedField=function(){var t=E._asyncToGenerator(function*(e){var c=this._sourceInfo.spatialReference;const a=this._sourceInfo.fieldsIndex,{createLabelFunction:b}=yield k;c=yield b(e.label,a,c);return{...e,builder:c}});return function(e){return t.apply(this,arguments)}}();p._evaluateField=function(t,e,c){switch(e.type){case "label-expression":return t=t.readArcadeFeature(),
e.builder.evaluate(t)||"";case "expression":return{expression:e}=e,f(e,t,{$view:{scale:c}})}};E._createClass(m,[{key:"storage",get:function(){return this._storage}}]);return m}();u.Store2D=g;Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/accessorSupport/diffUtils":function(){define(["exports","../Accessor","../Collection","../maybe","./utils"],function(r,u,E,C,v){function z(e){return e instanceof E?Object.keys(e.items):e instanceof u?v.getProperties(e).keys():
e?Object.keys(e):[]}function x(e,c){return e instanceof E?e.items[c]:e[c]}function f(e,c){return Array.isArray(e)&&Array.isArray(c)?e.length!==c.length:!1}function k(e){return e?e.declaredClass:null}function g(e,c){const a=e.diff;if(a&&"function"===typeof a)return a(e,c);const b=z(e),h=z(c);if(0!==b.length||0!==h.length){if(!b.length||!h.length||f(e,c))return{type:"complete",oldValue:e,newValue:c};var l=h.filter(n=>!b.includes(n)),d=b.filter(n=>!h.includes(n));d=b.filter(n=>h.includes(n)&&x(e,n)!==
x(c,n)).concat(l,d).sort();if((l=k(e))&&t.includes(l)&&d.length)return{type:"complete",oldValue:e,newValue:c};var q;l=e instanceof u&&c instanceof u;for(const n of d){d=x(e,n);const B=x(c,n);if((l||"function"!==typeof d&&"function"!==typeof B)&&d!==B&&(null!=d||null!=B)){if(a&&a[n]&&"function"===typeof a[n])d=a[n](d,B);else if(d instanceof Date&&B instanceof Date){if(d.getTime()===B.getTime())continue;d={type:"complete",oldValue:d,newValue:B}}else d="object"===typeof d&&"object"===typeof B&&k(d)===
k(B)?g(d,B):{type:"complete",oldValue:d,newValue:B};C.isSome(d)&&(C.isSome(q)?q.diff[n]=d:q={type:"partial",diff:{[n]:d}})}}return q}}function m(e,c){if(C.isNone(e))return!1;c=c.split(".");for(const a of c){if("complete"===e.type)break;if("partial"===e.type){if(e=e.diff[a],!e)return!1}else return!1}return!0}function p(e){if(C.isNone(e))return!0;switch(e.type){case "complete":return!1;case "collection":for(const c of e.added)if(!p(c))return!1;for(const c of e.removed)if(!p(c))return!1;for(const c of e.changed)if(!p(c))return!1;
return!0;case "partial":for(const c in e.diff)if(!p(e.diff[c]))return!1;return!0}}const t=["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"];r.diff=function(e,c){if(!("function"===typeof e||"function"===typeof c||C.isNone(e)&&C.isNone(c)))return C.isNone(e)||C.isNone(c)||"object"===typeof e&&"object"===typeof c&&k(e)!==k(c)?{type:"complete",oldValue:e,newValue:c}:g(e,c)};r.hasDiff=m;r.hasDiffAny=function(e,c){for(const a of c)if(m(e,
a))return!0;return!1};r.isEmpty=p;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/arcade/callExpressionWithCursor":function(){define(["../../../core/Logger"],function(r){return function(u,E,C){u.referencesGeometry();E=E.readArcadeFeature();try{return u.evaluate({...C,$feature:E})}catch(v){return r.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",v),null}}})},"esri/views/2d/layers/features/support/FeatureSetReaderPBFIndirect":function(){define(["exports",
"../../../../../chunks/_rollupPluginBabelHelpers","./FeatureSetReader"],function(r,u,E){let C=function(v){function z(f,k){var g=v.call(this,E.FeatureSetReader.createInstance(),f.fullSchema())||this;g._currentIndex=-1;g._reader=f;g._indices=k;return g}u._inheritsLoose(z,v);z.from=function(f,k){return new z(f.copy(),k)};var x=z.prototype;x.getSize=function(){return this._indices.length};x.getCursor=function(){return this.copy()};x.copy=function(){const f=new z(this._reader.copy(),this._indices);f._currentIndex=
this._currentIndex;return f};x.next=function(){for(;this._nextIndex()&&!this._reader._getExists(););return this._currentIndex<this._indices.length};x._nextIndex=function(){return++this._currentIndex<this._indices.length?(this._reader.setIndex(this._indices[this._currentIndex]),!0):!1};x.setArcadeSpatialReference=function(f){this._reader.setArcadeSpatialReference(f)};x.attachStorage=function(f){this._reader.attachStorage(f)};x.getStorage=function(){return this._reader.getStorage()};x.getComputedNumeric=
function(f){return this._reader.getComputedNumericAtIndex(0)};x.setComputedNumeric=function(f,k){return this._reader.setComputedNumericAtIndex(k,0)};x.getComputedString=function(f){return this._reader.getComputedStringAtIndex(0)};x.setComputedString=function(f,k){return this._reader.setComputedStringAtIndex(0,k)};x.getComputedNumericAtIndex=function(f){return this._reader.getComputedNumericAtIndex(f)};x.setComputedNumericAtIndex=function(f,k){this._reader.setComputedNumericAtIndex(f,k)};x.getComputedStringAtIndex=
function(f){return this._reader.getComputedStringAtIndex(f)};x.setComputedStringAtIndex=function(f,k){return this._reader.setComputedStringAtIndex(f,k)};x.transform=function(f,k,g,m){const p=this.copy();p._reader=this._reader.transform(f,k,g,m);return p};x.readAttribute=function(f,k=!1){return this._reader.readAttribute(f,k)};x.readAttributes=function(){return this._reader.readAttributes()};x.joinAttributes=function(f){return this._reader.joinAttributes(f)};x.readArcadeFeature=function(){return this._reader.readArcadeFeature()};
x.geometry=function(){return this._reader.geometry()};x.field=function(f){return this.readAttribute(f,!0)};x.hasField=function(f){return this._reader.hasField(f)};x.setField=function(f,k){return this._reader.setField(f,k)};x.keys=function(){return this._reader.keys()};x.castToText=function(){return this._reader.castToText()};x.getQuantizationTransform=function(){return this._reader.getQuantizationTransform()};x.getFieldNames=function(){return this._reader.getFieldNames()};x.getAttributeHash=function(){return this._reader.getAttributeHash()};
x.getObjectId=function(){return this._reader.getObjectId()};x.getDisplayId=function(){return this._reader.getDisplayId()};x.setDisplayId=function(f){return this._reader.setDisplayId(f)};x.getGroupId=function(){return this._reader.getGroupId()};x.setGroupId=function(f){return this._reader.setGroupId(f)};x.getXHydrated=function(){return this._reader.getXHydrated()};x.getYHydrated=function(){return this._reader.getYHydrated()};x.getX=function(){return this._reader.getX()};x.getY=function(){return this._reader.getY()};
x.setIndex=function(f){return this._reader.setIndex(f)};x.getIndex=function(){return this._reader.getIndex()};x.readLegacyFeature=function(){return this._reader.readLegacyFeature()};x.readOptimizedFeature=function(){return this._reader.readOptimizedFeature()};x.readLegacyPointGeometry=function(){return this._reader.readLegacyPointGeometry()};x.readLegacyGeometry=function(){return this._reader.readLegacyGeometry()};x.readLegacyCentroid=function(){return this._reader.readLegacyCentroid()};x.readGeometryArea=
function(){return this._reader.readGeometryArea()};x.readUnquantizedGeometry=function(){return this._reader.readUnquantizedGeometry()};x.readHydratedGeometry=function(){return this._reader.readHydratedGeometry()};x.readGeometry=function(){return this._reader.readGeometry()};x.readCentroid=function(){return this._reader.readCentroid()};x._readAttribute=function(f,k){throw Error("Error: Should not be called. Underlying _reader should be used instead");};x._readAttributes=function(){throw Error("Error: Should not be called. Underlying _reader should be used instead");
};u._createClass(z,[{key:"hasNext",get:function(){return this._currentIndex+1<this._indices.length}},{key:"geometryType",get:function(){return this._reader.geometryType}},{key:"hasFeatures",get:function(){return this._reader.hasFeatures}},{key:"exceededTransferLimit",get:function(){return this._reader.exceededTransferLimit}},{key:"hasZ",get:function(){return this._reader.hasZ}},{key:"hasM",get:function(){return this._reader.hasM}}]);return z}(E.FeatureSetReader);r.FeatureSetReaderIndirect=C;Object.defineProperties(r,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/FeatureSetReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry ../../../../../core/has ../../../../../core/maybe ../../../../../layers/graphics/centroid ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedGeometry ./StaticBitSet ../../../../../geometry/support/jsonUtils".split(" "),function(r,u,E,C,
v,z,x,f,k,g){var m,p,t;let e=0;E=null!=(m=C("featurelayer-simplify-thresholds"))?m:[.5,.5,.5,.5];const c=E[0],a=E[1],b=E[2],h=E[3];m=null!=(p=C("featurelayer-simplify-payload-size-factors"))?p:[1,2,4];const l=m[0],d=m[1],q=m[2],n=null!=(t=C("featurelayer-simplify-mobile-factor"))?t:2,B=C("esri-mobile");C=function(){function A(y,D){this.type="FeatureSetReader";this.arcadeDeclaredClass="esri.arcade.Feature";this.seen=!1;this._ty=this._tx=this.instance=0;this._sy=this._sx=1;this._deleted=null;this._joined=
[];this._objectIdToIndex=null;this._level=0;this.instance=y;this._layerSchema=D}A.createInstance=function(){e++;return e=65535<e?0:e};var w=A.prototype;w.getAreaSimplificationThreshold=function(y,D){let F=1;const G=B?n:1;4E6<D?F=q*G:1E6<D?F=d*G:5E5<D?F=l*G:1E5<D&&(F=G);D=0;4E3<y?D=h*F:2E3<y?D=b*F:100<y?D=a:15<y&&(D=c);y=8;4>this._level?y=1:5>this._level?y=2:6>this._level&&(y=4);return D*y};w.setArcadeSpatialReference=function(y){this._arcadeSpatialReference=y};w.attachStorage=function(y){this._storage=
y};w.getQuantizationTransform=function(){throw Error("Unable to find transform for featureSet");};w.getStorage=function(){return this._storage};w.getComputedNumeric=function(y){return this.getComputedNumericAtIndex(0)};w.setComputedNumeric=function(y,D){return this.setComputedNumericAtIndex(D,0)};w.getComputedString=function(y){return this.getComputedStringAtIndex(0)};w.setComputedString=function(y,D){return this.setComputedStringAtIndex(0,D)};w.getComputedNumericAtIndex=function(y){return this._storage.getComputedNumericAtIndex(this.getDisplayId(),
y)};w.setComputedNumericAtIndex=function(y,D){this._storage.setComputedNumericAtIndex(this.getDisplayId(),y,D)};w.getComputedStringAtIndex=function(y){return this._storage.getComputedStringAtIndex(this.getDisplayId(),y)};w.setComputedStringAtIndex=function(y,D){return this._storage.setComputedStringAtIndex(this.getDisplayId(),y,D)};w.transform=function(y,D,F,G){const K=this.copy();K._tx+=y;K._ty+=D;K._sx*=F;K._sy*=G;return K};w.readAttribute=function(y,D=!1){var F=this._readAttribute(y,D);if(void 0!==
F)return F;for(const G of this._joined)if(G.setIndex(this.getIndex()),F=G._readAttribute(y,D),void 0!==F)return F};w.readAttributes=function(){const y=this._readAttributes();for(const D of this._joined){D.setIndex(this.getIndex());const F=D._readAttributes();for(const G of Object.keys(F))y[G]=F[G]}return y};w.joinAttributes=function(y){this._joined.push(y)};w.readArcadeFeature=function(){return this};w.geometry=function(){var y=this.readHydratedGeometry();y=x.convertToGeometry(y,this.geometryType,
this.hasZ,this.hasM);if(y=g.fromJSON(y))y.spatialReference=this._arcadeSpatialReference;return y};w.field=function(y){if(this.hasField(y))return this.readAttribute(y,!0);for(const D of this._joined)if(D.setIndex(this.getIndex()),D.hasField(y))return D._readAttribute(y,!0);throw Error(`Field ${y} does not exist`);};w.setField=function(y,D){throw Error("Unable to update feature attribute values, feature is readonly");};w.keys=function(){return this.getFieldNames()};w.castToText=function(){return JSON.stringify(this.readLegacyFeature())};
w.gdbVersion=function(){return null};w.fullSchema=function(){return this._layerSchema};w.castAsJson=function(y=null){return{attributes:this._readAttributes(),geometry:!0===(null==y?void 0:y.keepGeometryType)?this.geometry():this.geometry().toJSON()}};w.castAsJsonAsync=function(y,D=null){return Promise.resolve(this.castAsJson(D))};w.removeIds=function(y){if(v.isNone(this._objectIdToIndex)){var D=new Map;const F=this.getCursor();for(;F.next();)D.set(F.getObjectId(),F.getIndex());this._objectIdToIndex=
D}D=this._objectIdToIndex;for(const F of y)D.has(F)&&this.removeAtIndex(D.get(F))};w.removeAtIndex=function(y){v.isNone(this._deleted)&&(this._deleted=k.StaticBitSet.create(this.getSize()));this._deleted.set(y)};w.readGeometryForDisplay=function(){return this.readUnquantizedGeometry(!0)};w.readLegacyGeometryForDisplay=function(){return this.readLegacyGeometry(!0)};w.features=function*(){const y=this.getCursor();for(;y.next();)yield y.readOptimizedFeature()};w._getExists=function(){return v.isNone(this._deleted)||
!this._deleted.has(this.getIndex())};w._computeCentroid=function(){if("esriGeometryPolygon"!==this.geometryType)return null;const y=this.readUnquantizedGeometry();if(!y||y.hasIndeterminateRingOrder)return null;const D=v.unwrapOr(this.getQuantizationTransform(),null);return z.getCentroidOptimizedGeometry(new f,y,this.hasM,this.hasZ,D)};w.copyInto=function(y){y.seen=this.seen;y._storage=this._storage;y._arcadeSpatialReference=this._arcadeSpatialReference;y._joined=this._joined;y._tx=this._tx;y._ty=
this._ty;y._sx=this._sx;y._sy=this._sy;y._deleted=this._deleted;y._objectIdToIndex=this._objectIdToIndex};u._createClass(A,[{key:"isEmpty",get:function(){return v.isSome(this._deleted)&&this._deleted.countSet()===this.getSize()}},{key:"level",set:function(y){this._level=y}}]);return A}();r.FeatureSetReader=C;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/StaticBitSet":function(){define(["exports"],function(r){let u=
function(){function E(v,z){this._mask=0;this._buf=v;this._mask=z}E.fromBuffer=function(v,z){return new E(v,z)};E.create=function(v,z=4294967295){v=new Uint32Array(Math.ceil(v/32));return new E(v,z)};var C=E.prototype;C._getIndex=function(v){return Math.floor(v/32)};C.has=function(v){v&=this._mask;return!!(this._buf[this._getIndex(v)]&1<<v%32)};C.hasRange=function(v,z){for(;v%32&&v!==z;){if(this.has(v))return!0;v++}for(;z%32&&v!==z;){if(this.has(v))return!0;z--}if(v===z)return!1;for(v/=32;v!==z/32;v++)if(this._buf[v])return!0;
return!1};C.set=function(v){v&=this._mask;const z=this._getIndex(v);this._buf[z]|=1<<v%32};C.setRange=function(v,z){for(;v%32&&v!==z;)this.set(v++);for(;z%32&&v!==z;)this.set(z--);if(v!==z)for(v/=32;v!==z/32;v++)this._buf[v]=4294967295};C.unset=function(v){v&=this._mask;const z=this._getIndex(v);this._buf[z]&=4294967295^1<<v%32};C.resize=function(v){const z=this._buf;v=new Uint32Array(Math.ceil(v/32));v.set(z);this._buf=v};C.or=function(v){for(let z=0;z<this._buf.length;z++)this._buf[z]|=v._buf[z];
return this};C.and=function(v){for(let z=0;z<this._buf.length;z++)this._buf[z]&=v._buf[z];return this};C.xor=function(v){for(let z=0;z<this._buf.length;z++)this._buf[z]^=v._buf[z];return this};C.ior=function(v){for(let z=0;z<this._buf.length;z++)this._buf[z]|=~v._buf[z];return this};C.iand=function(v){for(let z=0;z<this._buf.length;z++)this._buf[z]&=~v._buf[z];return this};C.ixor=function(v){for(let z=0;z<this._buf.length;z++)this._buf[z]^=~v._buf[z];return this};C.any=function(){for(let v=0;v<this._buf.length;v++)if(this._buf[v])return!0;
return!1};C.copy=function(v){for(let z=0;z<this._buf.length;z++)this._buf[z]=v._buf[z];return this};C.clone=function(){return new E(this._buf.slice(),this._mask)};C.clear=function(){for(let v=0;v<this._buf.length;v++)this._buf[v]=0};C.forEachSet=function(v){for(let z=0;z<this._buf.length;z++){let x=this._buf[z],f=32*z;if(x)for(;x;)x&1&&v(f),x>>>=1,f++}};C.countSet=function(){let v=0;this.forEachSet(z=>{v++});return v};return E}();r.StaticBitSet=u;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/layers/features/sources/createSource":function(){define("exports ../../../../../core/maybe ../../../../../layers/support/arcgisLayerUrl ./DrillDownFeatureSource ./GeoEventSource ./PagedFeatureSource ./SnapshotFeatureSource".split(" "),function(r,u,E,C,v,z,x){r.createSource=function(f,k,g,m,p,t){a:{switch(f.type){case "snapshot":f={type:"feature",origin:"snapshot",featureCount:u.unwrapOr(f.featureCount,0),serviceInfo:f,onMessage:m,outSR:k,tileInfoView:g,canAcceptRequest:p,store:t};break a;
case "stream":f={type:"geoevent",serviceInfo:f,onMessage:m,outSR:k,canAcceptRequest:p};break a;case "memory":case "on-demand":t=f.source;t=Array.isArray(t)?"local":"path"in t&&E.isHostedAgolService(t.path)?"hosted":"unknown";f={type:"feature",serviceInfo:f,onMessage:m,outSR:k,origin:t,tileInfoView:g,canAcceptRequest:p};break a}f=void 0}switch(f.type){case "feature":switch(f.origin){case "hosted":case "local":return new z.PagedFeatureSource(f);case "snapshot":return new x.SnapshotFeatureSource(f);
case "unknown":return new C.DrillDownFeatureSource(f)}case "geoevent":return new v.GeoEventSource(f)}};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/arcgisLayerUrl":function(){define(["exports","../../core/maybe","../../core/urlUtils","../../chunks/persistableUrlUtils"],function(r,u,E,C){function v(t){if(u.isNone(t))return null;t=E.urlToObject(t);t=t.path.match(g)||t.path.match(m);if(!t)return null;const [,e,c,a,b]=t;t=c.indexOf("/");
return{title:x(-1!==t?c.slice(t+1):c),serverType:f[a.toLowerCase()],sublayer:null!=b&&""!==b?parseInt(b,10):null,url:{path:e}}}function z(t){return(t=E.urlToObject(t).path.match(p))?{serviceUrl:t[1],sublayerId:Number(t[2])}:null}function x(t){t=t.replace(/\s*[/_]+\s*/g," ");return t[0].toUpperCase()+t.slice(1)}const f={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer"},k=Object.values(f),
g=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${k.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),m=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(${k.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),p=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;r.cleanTitle=x;r.isAGOLUrl=function(t){return t?(new E.Url(E.makeAbsolute(t))).authority.toLowerCase().includes("arcgis.com"):!1};r.isArcGISUrl=function(t){return!!g.test(t)};r.isHostedAgolService=function(t){if(!t)return!1;t=t.toLowerCase();
const e=t.includes(".arcgis.com/");t=t.includes("//services")||t.includes("//tiles")||t.includes("//features");return e&&t};r.isHostedSecuredProxyService=function(t,e){return e&&t&&t.toLowerCase().includes(e.toLowerCase())};r.isServerOrServicesAGOLUrl=function(t){if(!t)return!1;t=(new E.Url(E.makeAbsolute(t))).authority.toLowerCase();return"server.arcgisonline.com"===t||"services.arcgisonline.com"===t};r.isWmsServer=function(t){if(!t)return!1;var e=t.toLowerCase();t=e.includes("/services/");const c=
e.includes("/mapserver/wmsserver"),a=e.includes("/imageserver/wmsserver");e=e.includes("/wmsserver");return t&&(c||a||e)};r.parse=v;r.parseNonStandardSublayerUrl=z;r.sanitizeUrl=function(t,e){return t?E.removeTrailingSlash(E.removeQueryParameters(t,e)):t};r.sanitizeUrlWithLayerId=function(t){let {url:e}=t;if(!e)return{url:e};e=E.removeQueryParameters(e,t.logger);const c=E.urlToObject(e),a=v(c.path);let b;u.isSome(a)?(null!=a.sublayer&&null==t.layer.layerId&&(b=a.sublayer),e=a.url.path):t.nonStandardUrlAllowed&&
(t=z(c.path),u.isSome(t)&&(e=t.serviceUrl,b=t.sublayerId));return{url:E.removeTrailingSlash(e),layerId:b}};r.serverTypes=k;r.titleFromUrlAndName=function(t,e){const c=[];t&&(t=v(t),u.isSome(t)&&t.title&&c.push(t.title));e&&(e=x(e),c.push(e));if(2===c.length){if(c[0].toLowerCase().includes(c[1].toLowerCase()))return c[0];if(c[1].toLowerCase().includes(c[0].toLowerCase()))return c[1]}return c.join(" - ")};r.writeUrlWithLayerId=function(t,e,c,a,b){C.write(e,a,"url",b);a.url&&null!=t.layerId&&(a.url=
E.join(a.url,c,t.layerId.toString()))};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/chunks/persistableUrlUtils":function(){define(["exports","../core/maybe","../core/urlUtils"],function(r,u,E){function C(e,c){var a=c&&c.url&&c.url.path;e&&a&&(e=E.makeAbsolute(e,a,{preserveProtocolRelative:!0}),c.portalItem&&c.readResourcePaths&&(a=E.makeRelative(e,c.portalItem.itemUrl),p.test(a)&&c.readResourcePaths.push(c.portalItem.resourceFromPath(a).path)));
return g(e,c&&c.portal)}function v(e,c,a=r.MarkKeep.YES){if(!e)return e;!E.isAbsolute(e)&&c&&c.blockedRelativeUrls&&c.blockedRelativeUrls.push(e);let b=E.makeAbsolute(e);if(c){var h=c.verifyItemRelativeUrls&&c.verifyItemRelativeUrls.rootPath||c.url&&c.url.path;h&&(h=g(h,c.portal),b=E.makeRelative(g(b,c.portal),h,h),b!==e&&c.verifyItemRelativeUrls&&c.verifyItemRelativeUrls.writtenUrls.push(b))}b=k(b,c&&c.portal);E.isAbsolute(b)&&(b=E.normalize(b));null!=c&&c.resources&&null!=c&&c.portalItem&&!E.isAbsolute(b)&&
!E.isDataProtocol(b)&&a===r.MarkKeep.YES&&c.resources.toKeep.push({resource:c.portalItem.resourceFromPath(b)});return b}function z(e,c,a){return C(e,a)}function x(e,c,a,b){e=v(e,b);void 0!==e&&(c[a]=e)}function f(e){e=u.isSome(e)?e.match(m):null;return u.isSome(e)?e[1]:null}function k(e,c){return c&&!c.isPortal&&c.urlKey&&c.customBaseUrl?E.changeDomain(e,`${c.urlKey}.${c.customBaseUrl}`,c.portalHostname):e}function g(e,c){if(!c||c.isPortal||!c.urlKey||!c.customBaseUrl)return e;const a=`${c.urlKey}.${c.customBaseUrl}`,
b=E.getAppUrl();return E.hasSameOrigin(b,`${b.scheme}://${a}`)?E.changeDomain(e,c.portalHostname,a):E.changeDomain(e,a,c.portalHostname)}const m=/\/items\/([^\/]+)\/resources\//,p=/^\.\/resources\//;r.MarkKeep=void 0;(function(e){e[e.YES=0]="YES";e[e.NO=1]="NO"})(r.MarkKeep||(r.MarkKeep={}));const t=Object.freeze(Object.defineProperty({__proto__:null,fromJSON:C,toJSON:v,read:z,write:x,itemIdFromResourceUrl:f,ensureMainOnlineDomain:k,get MarkKeep(){return r.MarkKeep}},Symbol.toStringTag,{value:"Module"}));
r.ensureMainOnlineDomain=k;r.fromJSON=C;r.itemIdFromResourceUrl=f;r.persistableUrlUtils=t;r.read=z;r.toJSON=v;r.write=x})},"esri/views/2d/layers/features/sources/DrillDownFeatureSource":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/has","../../../../../core/promiseUtils","./BaseFeatureSource"],function(r,u,E,C,v){var z=(E=E("esri-mobile"))?1:4,x=E?1:3;v=function(f){function k(g){return f.call(this,g)||this}u._inheritsLoose(k,f);k.prototype._fetchDataTile=
function(){var g=u._asyncToGenerator(function*(m){var p=this;const t=this._serviceInfo.capabilities.query.supportsMaxRecordCountFactor,e=this._subscriptions.get(m.key.id),c=e.signal,a=m.getQuantizationParameters();let b=0;const h=function(){var l=u._asyncToGenerator(function*(d,q){const n=p._queryInfo,B=p.createTileQuery(d,{maxRecordCountFactor:t?x:void 0,returnExceededLimitFeatures:!1,quantizationParameters:a});b++;try{const w=yield p._queue.push({tile:m,query:B,signal:c,depth:q});b--;C.throwIfAborted(c);
if(w)if(n!==p._queryInfo)h(d,q);else if(w.exceededTransferLimit&&q<z)for(const y of d.createChildTiles())h(y,q+1);else{var A={id:m.id,addOrUpdate:w,end:0===b,type:"append"};e.add({query:B,message:A});p._onMessage(A)}}catch(w){C.isAbortError(w)||p._onMessage({id:m.id,addOrUpdate:null,end:!0,type:"append"})}});return function(d,q){return l.apply(this,arguments)}}();h(m,0)});return function(m){return g.apply(this,arguments)}}();return k}(v.BaseFeatureSource);r.DrillDownFeatureSource=v;Object.defineProperties(r,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/sources/BaseFeatureSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../request ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../controllers/support/sourceAdapters ./DataTileSource ../../../../support/QueueProcessor".split(" "),function(r,u,E,C,v,z,x,f,k,g,m){const p=z.getLogger("esri.views.2d.layers.features.sources.BaseFeatureSource");
z=function(t){function e(a){var b=t.call(this,a)||this;b.type="feature";b.mode="on-demand";b._adapter=k.createSourceAdapter(a.serviceInfo);b._queue=new m.QueueProcessor({concurrency:8,process:function(){var h=u._asyncToGenerator(function*(l){f.throwIfAborted(l);if(x.isSome(l.tile)){var d=l.tile.key.id,{signal:q}=l;d=v("esri-tiles-debug")?{tile:d.replace(/\//g,"."),depth:l.depth}:void 0;q=yield b._adapter.executeQuery(l.query,{signal:q,query:{...d,...b._schema.customParameters}});q.level=l.tile.key.level;
return q}return b._adapter.executeQuery(l.query,{...l,query:b._schema.customParameters})});return function(l){return h.apply(this,arguments)}}()});b._patchQueue=new m.QueueProcessor({concurrency:8,process:function(){var h=u._asyncToGenerator(function*(l){f.throwIfAborted(l);if(x.isSome(l.tile)){var d=l.tile.key.id,{signal:q}=l;d=v("esri-tiles-debug")?{tile:d.replace(/\//g,"."),depth:l.depth}:void 0;q=yield b._adapter.executeQuery(l.query,{signal:q,query:{...d,...b._schema.customParameters}});q.level=
l.tile.key.level;return q}return b._adapter.executeQuery(l.query,{...l,query:b._schema.customParameters})});return function(l){return h.apply(this,arguments)}}()});return b}u._inheritsLoose(e,t);var c=e.prototype;c.destroy=function(){t.prototype.destroy.call(this);this._adapter.destroy();this._queue.destroy();this._patchQueue.destroy()};c.enableEvent=function(a,b){};c.subscribe=function(a,b){t.prototype.subscribe.call(this,a,b);const h=this._subscriptions.get(a.id);this._fetchDataTile(a).catch(l=>
{f.isAbortError(l)||p.error(new C("mapview-query-error","Encountered error when fetching tile",{tile:a,error:l}))}).then(()=>h.end())};c.unsubscribe=function(a){t.prototype.unsubscribe.call(this,a)};c.readers=function(a){return this._subscriptions.get(a).readers()};c.query=function(){var a=u._asyncToGenerator(function*(b){return this._adapter.executeQuery(b,{query:this._schema.customParameters})});return function(b){return a.apply(this,arguments)}}();c.queryLastEditDate=function(){var a=u._asyncToGenerator(function*(){const b=
this._serviceInfo.source;return(yield E(b.path,{query:{...b.query,f:"json"},responseType:"json"})).data.editingInfo.lastEditDate});return function(){return a.apply(this,arguments)}}();c.createTileQuery=function(a,b={}){var h;const l=this._serviceInfo.geometryType,d=this.createQuery(b);d.quantizationParameters=null!=(h=b.quantizationParameters)?h:a.getQuantizationParameters();d.resultType="tile";d.geometry=a.extent;if(this._serviceInfo.capabilities.query.supportsQuantization)"esriGeometryPolyline"===
l&&(d.maxAllowableOffset=a.resolution*v("feature-polyline-generalization-factor"));else if("esriGeometryPolyline"===l||"esriGeometryPolygon"===l)d.maxAllowableOffset=a.resolution,"esriGeometryPolyline"===l&&(d.maxAllowableOffset*=v("feature-polyline-generalization-factor"));a=this._serviceInfo.capabilities.query;d.defaultSpatialReferenceEnabled=a.supportsDefaultSpatialReference;d.compactGeometryEnabled=a.supportsCompactGeometry;return d};c._executePatchQuery=function(){var a=u._asyncToGenerator(function*(b,
h,l,d){h=h.clone();h.outFields=[this._serviceInfo.objectIdField,...l];h.returnCentroid=!1;h.returnGeometry=!1;l=x.isSome(h.start)?h.start/8E3:0;return this._patchQueue.push({tile:b,query:h,signal:d.signal,depth:l})});return function(b,h,l,d){return a.apply(this,arguments)}}();c._resend=function(){var a=u._asyncToGenerator(function*(b,h){const {query:l,message:d}=b,q=x.isSome(l.outFields)?l.outFields:[];b=this._queryInfo.outFields;const n=b.filter(B=>!q.includes(B));if(x.isNone(d.addOrUpdate))this._onMessage({...d,
type:"append"});else if(n.length)try{const B=this._subscriptions.get(d.id).tile,A=yield this._executePatchQuery(B,l,n,h);f.throwIfAborted(h);l.outFields=b;d.addOrUpdate.joinAttributes(A);this._onMessage({...d,end:d.end,type:"append"})}catch(B){}else this._onMessage({...d,type:"append"})});return function(b,h){return a.apply(this,arguments)}}();c._resendSubscription=function(){var a=u._asyncToGenerator(function*(b){v("esri-2d-update-debug")&&console.debug(b.tile.id,"Resend Subscription");if(b.empty)return this._onMessage({id:b.tile.id,
addOrUpdate:null,end:!1,type:"append"});const h=b.signal;for(const l of b.requests.done)yield this._resend(l,{signal:h});if(x.isSome(b.edits))return this._onMessage(b.edits)});return function(b){return a.apply(this,arguments)}}();c.resend=function(){var a=u._asyncToGenerator(function*(){const b=Array.from(this._subscriptions.values());yield Promise.all(b.map(h=>this._resendSubscription(h)))});return function(){return a.apply(this,arguments)}}();u._createClass(e,[{key:"updating",get:function(){return!!this._queue.length||
Array.from(this._subscriptions.values()).some(a=>!a.done)}},{key:"maxRecordCountFactor",get:function(){const {query:a}=this._serviceInfo.capabilities;return a.supportsMaxRecordCountFactor?4:null}},{key:"maxPageSize",get:function(){var a,{query:b}=this._serviceInfo.capabilities;b=null!=(a=b.maxRecordCount)?a:8E3;a=x.unwrapOr(this.maxRecordCountFactor,1);return b*a}},{key:"pageSize",get:function(){return Math.min(8E3,this.maxPageSize)}}]);return e}(g.DataTileSource);r.BaseFeatureSource=z;Object.defineProperties(r,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/controllers/support/sourceAdapters":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../../core/maybe ../../../../../../core/workers/Connection ../../../../../../geometry/support/quantizationUtils ../../../../../../layers/graphics/featureConversionUtils ../../../../../../layers/ogc/ogcFeatureUtils ../../../../../../rest/query/operations/query ../../support/FeatureSetReaderJSON ../../support/FeatureSetReaderPBF".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m){function p(l){return t.apply(this,arguments)}function t(){t=u._asyncToGenerator(function*(l){const d=new v;yield d.open(l,{});return d});return t.apply(this,arguments)}let e=function(){function l(d){this.service=d}l.prototype.destroy=function(){};return l}(),c=function(l){function d(n){var B=l.call(this,n)||this;B._portsOpen=p(n.source).then(A=>B.client=A);return B}u._inheritsLoose(d,l);var q=d.prototype;q.destroy=function(){this.client.close();this.client=null};q.executeQuery=
function(){var n=u._asyncToGenerator(function*(B,A){yield this._portsOpen;B=yield this.client.invoke("queryFeatures",B.toJSON(),A);return g.FeatureSetReaderJSON.fromFeatureSet(B,this.service)});return function(B,A){return n.apply(this,arguments)}}();return d}(e),a=function(l){function d(){return l.apply(this,arguments)||this}u._inheritsLoose(d,l);d.prototype.executeQuery=function(){var q=u._asyncToGenerator(function*(n,B){({data:B}=yield k.executeQueryPBFBuffer(this.service.source,n,B));return m.FeatureSetReaderPBF.fromBuffer(B,
this.service,!n.quantizationParameters)});return function(n,B){return q.apply(this,arguments)}}();return d}(e),b=function(l){function d(){return l.apply(this,arguments)||this}u._inheritsLoose(d,l);d.prototype.executeQuery=function(){var q=u._asyncToGenerator(function*(n,B){const {source:A,capabilities:w,spatialReference:y,objectIdField:D,geometryType:F}=this.service;if(C.isSome(n.quantizationParameters)&&!w.query.supportsQuantization){n=n.clone();var G=z.toQuantizationTransform(C.unwrap(n.quantizationParameters));
n.quantizationParameters=null;({data:B}=yield k.executeQuery(A,n,y,B));B=x.convertFromFeatureSet(B,D);x.quantizeOptimizedFeatureSet(G,B);return g.FeatureSetReaderJSON.fromOptimizedFeatureSet(B,this.service)}({data:B}=yield k.executeQuery(A,n,this.service.spatialReference,B));"esriGeometryPoint"===F&&(B.features=null==(G=B.features)?void 0:G.filter(K=>C.isSome(K.geometry)?(K=K.geometry,Number.isFinite(K.x)&&Number.isFinite(K.y)):!0));return g.FeatureSetReaderJSON.fromFeatureSet(B,this.service)});return function(n,
B){return q.apply(this,arguments)}}();return d}(e),h=function(l){function d(){return l.apply(this,arguments)||this}u._inheritsLoose(d,l);d.prototype.executeQuery=function(){var q=u._asyncToGenerator(function*(n,B){var {capabilities:A}=this.service;if(n.quantizationParameters&&!A.query.supportsQuantization){const w=n.clone();A=z.toQuantizationTransform(C.unwrap(w.quantizationParameters));w.quantizationParameters=null;n=yield f.queryOptimizedFeatureSet(this.service.source,n,B);x.quantizeOptimizedFeatureSet(A,
n);return g.FeatureSetReaderJSON.fromOptimizedFeatureSet(n,this.service)}n=yield f.queryOptimizedFeatureSet(this.service.source,n,B);return g.FeatureSetReaderJSON.fromOptimizedFeatureSet(n,this.service)});return function(n,B){return q.apply(this,arguments)}}();return d}(e);r.SourceAdapter=e;r.createSourceAdapter=function(l){const {capabilities:d}=l;var q=l.source;return q&&q.capabilities&&q.collection&&q.layerDefinition?new h(l):Array.isArray(l.source)?new c(l):d.query.supportsFormatPBF&&E("featurelayer-pbf")?
new a(l):new b(l)};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/workers/Connection":function(){define("../../chunks/_rollupPluginBabelHelpers ../handleUtils ../Logger ../promiseUtils ../Queue ./RemoteClient".split(" "),function(r,u,E,C,v,z){const x=E.getLogger("esri.core.workers.Connection");return function(){function f(){this._inUseClients=[];this._clients=[];this._clientPromises=[];this._ongoingJobsQueue=new v}var k=f.prototype;k.destroy=
function(){this.close()};k.open=function(g,m){return new Promise((p,t)=>{let e=!0;const c=a=>{C.throwIfAborted(m.signal);e&&(e=!1,a())};this._clients.length=g.length;this._clientPromises.length=g.length;this._inUseClients.length=g.length;for(let a=0;a<g.length;++a){const b=g[a];C.isPromiseLike(b)?this._clientPromises[a]=b.then(h=>{this._clients[a]=new z(h,m,()=>this._ongoingJobsQueue.pop());c(p);return this._clients[a]},()=>{c(t);return null}):(this._clients[a]=new z(b,m,()=>this._ongoingJobsQueue.pop()),
this._clientPromises[a]=Promise.resolve(this._clients[a]),c(p))}})};k.broadcast=function(g,m,p){const t=Array(this._clientPromises.length);for(let e=0;e<this._clientPromises.length;++e)t[e]=this._clientPromises[e].then(c=>c.invoke(g,m,p));return t};k.close=function(){let g;for(;g=this._ongoingJobsQueue.pop();)g.deferred.reject(C.createAbortError(`Worker closing, aborting job calling '${g.methodName}'`));for(const m of this._clientPromises)m.then(p=>p.close());this._clients.length=0;this._clientPromises.length=
0};k.invoke=function(g,m,p){let t=null;Array.isArray(p)?(x.warn("invoke()","The transferList parameter is deprecated, use the options object instead"),t={transferList:p}):t=p;p=C.createDeferred();this._ongoingJobsQueue.push({methodName:g,data:m,invokeOptions:t,deferred:p});for(g=0;g<this._clientPromises.length;g++)(m=this._clients[g])?m.jobAdded():this._clientPromises[g].then(e=>e.jobAdded());return p.promise};k.on=function(g,m){return Promise.all(this._clientPromises).then(()=>u.handlesGroup(this._clients.map(p=>
p.on(g,m))))};k.openPorts=function(){return new Promise(g=>{const m=Array(this._clientPromises.length);let p=m.length;for(let t=0;t<this._clientPromises.length;++t)this._clientPromises[t].then(e=>{m[t]=e.openPort();0===--p&&g(m)})})};r._createClass(f,[{key:"closed",get:function(){return!this._clients||!this._clients.length}},{key:"test",get:function(){return{numClients:this._clients.length}}}]);return f}()})},"esri/core/Queue":function(){define(["../chunks/_rollupPluginBabelHelpers","./maybe"],function(r,
u){return function(){function E(v=z=>z.values().next().value){this._peeker=v;this._items=new Set}var C=E.prototype;C.clear=function(){this._items.clear()};C.last=function(){if(0!==this._items.size){for(var v of this._items);return v}};C.peek=function(){if(0!==this._items.size)return this._peeker(this._items)};C.push=function(v){this.contains(v)||this._items.add(v)};C.contains=function(v){return this._items.has(v)};C.pop=function(){if(0!==this.length){var v=this.peek();this._items.delete(u.assumeNonNull(v));
return v}};C.popLast=function(){if(0!==this.length){var v=this.last();this._items.delete(u.assumeNonNull(v));return v}};C.remove=function(v){this._items.delete(v)};C.filter=function(v){this._items.forEach(z=>{v(z)||this._items.delete(z)});return this};r._createClass(E,[{key:"length",get:function(){return this._items.size}}]);return E}()})},"esri/layers/ogc/ogcFeatureUtils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../geometry ../../request ../../core/Error ../../core/Logger ../../core/maybe ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ../graphics/featureConversionUtils ../graphics/OptimizedFeatureSet ../graphics/sources/geojson/geojson ../graphics/sources/support/clientSideDefaults ../support/FieldsIndex ../support/fieldType ../../geometry/SpatialReference".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t,e,c,a){function b(){b=u._asyncToGenerator(function*(I,H,M={},N=5){({links:I}=I);I=K(I,"items","application/geo+json")||K(I,"http://www.opengis.net/def/rel/ogc/1.0/items","application/geo+json");if(x.isNone(I))throw new v("ogc-feature-layer:missing-items-page","Missing items url");({data:M}=yield C(I.href,{signal:M.signal,query:{limit:N,...M.customParameters,token:M.apiKey},headers:{accept:"application/geo+json"}}));yield p.validateGeoJSON(M);const P=p.inferLayerProperties(M,
{geometryType:H.geometryType});M=H.fields||P.fields||[];N=null!=H.hasZ?H.hasZ:P.hasZ;I=P.geometryType;const ba=H.objectIdField||P.objectIdFieldName||"OBJECTID";H=H.timeInfo;var X=M.find(W=>W.name===ba);if(X)X.type="esriFieldTypeOID",X.editable=!1,X.nullable=!1;else{if(!P.objectIdFieldType)throw new v("ogc-feature-layer:missing-feature-id","Collection geojson require a feature id as a unique identifier");M.unshift({name:ba,alias:ba,type:"esriFieldTypeOID",editable:!1,nullable:!1})}ba!==P.objectIdFieldName&&
(X=M.find(W=>W.name===P.objectIdFieldName))&&(X.type="esriFieldTypeInteger");M===P.fields&&0<P.unknownFields.length&&J.warn({name:"ogc-feature-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:P.unknownFields}});for(var S of M){null==S.name&&(S.name=S.alias);null==S.alias&&(S.alias=S.name);"esriFieldTypeOID"!==S.type&&"esriFieldTypeGlobalID"!==S.type&&(S.editable=null==S.editable?!0:!!S.editable,S.nullable=null==S.nullable?
!0:!!S.nullable);if(!S.name)throw new v("ogc-feature-layer:invalid-field-name","field name is missing",{field:S});if(!c.kebabDict.jsonValues.includes(S.type))throw new v("ogc-feature-layer:invalid-field-type",`invalid type for field "${S.name}"`,{field:S});}H&&(S=new e(M),H.startTimeField&&((X=S.get(H.startTimeField))?(H.startTimeField=X.name,X.type="esriFieldTypeDate"):H.startTimeField=null),H.endTimeField&&((X=S.get(H.endTimeField))?(H.endTimeField=X.name,X.type="esriFieldTypeDate"):H.endTimeField=
null),H.trackIdField&&((S=S.get(H.trackIdField))?H.trackIdField=S.name:(H.trackIdField=null,J.warn({name:"ogc-feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:H}}))),H.startTimeField||H.endTimeField||(J.warn({name:"ogc-feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",details:{timeInfo:H}}),H=null));return{drawingInfo:I?t.createDrawingInfo(I):null,geometryType:I,fields:M,hasZ:!!N,objectIdField:ba,timeInfo:H}});return b.apply(this,
arguments)}function h(){h=u._asyncToGenerator(function*(I,H={}){({links:I}=I);I=K(I,"data","application/json")||K(I,"http://www.opengis.net/def/rel/ogc/1.0/data","application/json");if(x.isNone(I))throw new v("ogc-feature-layer:missing-collections-page","Missing collections url");const {apiKey:M,customParameters:N,signal:P}=H;({data:H}=yield C(I.href,{signal:P,headers:{accept:"application/json"},query:{...N,token:M}}));return H});return h.apply(this,arguments)}function l(){l=u._asyncToGenerator(function*(I,
H={}){({links:I}=I);I=K(I,"conformance","application/json")||K(I,"http://www.opengis.net/def/rel/ogc/1.0/conformance","application/json");if(x.isNone(I))throw new v("ogc-feature-layer:missing-conformance-page","Missing conformance url");const {apiKey:M,customParameters:N,signal:P}=H;({data:H}=yield C(I.href,{signal:P,headers:{accept:"application/json"},query:{...N,token:M}}));return H});return l.apply(this,arguments)}function d(){d=u._asyncToGenerator(function*(I,H={}){const {apiKey:M,customParameters:N,
signal:P}=H;({data:I}=yield C(I,{signal:P,headers:{accept:"application/json"},query:{...N,token:M}}));return I});return d.apply(this,arguments)}function q(){q=u._asyncToGenerator(function*(I,H={}){I=K(I.links,"service-desc","application/vnd.oai.openapi+json;version\x3d3.0");if(x.isNone(I))return J.warn("ogc-feature-layer:missing-openapi-page","The OGC API-Features server does not have an OpenAPI page."),null;const {apiKey:M,customParameters:N,signal:P}=H;({data:H}=yield C(I.href,{signal:P,headers:{accept:"application/vnd.oai.openapi+json;version\x3d3.0"},
query:{...N,token:M}}));return H});return q.apply(this,arguments)}function n(){n=u._asyncToGenerator(function*(I,H,M){I=yield B(I,H,M);return g.convertToFeatureSet(I)});return n.apply(this,arguments)}function B(I,H,M){return A.apply(this,arguments)}function A(){A=u._asyncToGenerator(function*(I,H,M){const {capabilities:{query:{maxRecordCount:N}},collection:P,layerDefinition:ba,queryParameters:{apiKey:X,customParameters:S},spatialReference:W,supportedCrs:R}=I;({links:I}=P);var Z=K(I,"items","application/geo+json")||
K(I,"http://www.opengis.net/def/rel/ogc/1.0/items","application/geo+json");if(x.isNone(Z))throw new v("ogc-feature-layer:missing-items-page","Missing items url");const {geometry:ka,num:ta,start:pa,timeExtent:wa,where:Ba}=H;if(H.objectIds)throw new v("ogc-feature-layer:query-by-objectids-not-supported","Queries with objectids are not supported");I=a.fromJSON(W);H=x.unwrapOr(H.outSpatialReference,I);I=H.isWGS84?null:w(H,R);var L=G(ka,R),T=D(wa);const la=F(Ba);({data:L}=yield C(Z.href,{...M,query:{...S,
...L,crs:I,datetime:T,query:la,limit:null!=ta?ta:null!=pa&&void 0!==pa?10:N,startindex:pa,token:X},headers:{accept:"application/geo+json"}}));M=!1;L.links&&(M=!!L.links.find(ca=>"next"===ca.rel));!M&&Number.isInteger(L.numberMatched)&&Number.isInteger(L.numberReturned)&&(M=L.numberReturned<L.numberMatched);const {fields:U,globalIdField:Q,hasM:da,hasZ:ea,objectIdField:ja}=ba;Z=ba.geometryType;L=p.createOptimizedFeatures(L,{geometryType:Z,hasZ:ea,objectIdField:ja});if(!I&&H.isWebMercator)for(var ha of L)x.isSome(ha.geometry)&&
(T=g.convertToGeometry(ha.geometry,Z,ea,!1),T.spatialReference=a.WGS84,ha.geometry=g.convertFromGeometry(k.project(T,H)));for(var Y of L)Y.objectId=Y.attributes[ja];ha=I||!I&&H.isWebMercator?H.toJSON():f.WGS84;Y=new m;Y.exceededTransferLimit=M;Y.features=L;Y.fields=U;Y.geometryType=Z;Y.globalIdFieldName=Q;Y.hasM=da;Y.hasZ=ea;Y.objectIdFieldName=ja;Y.spatialReference=ha;return Y});return A.apply(this,arguments)}function w(I,H){var M,N,P;const {isWebMercator:ba,wkid:X}=I;return X?(I=ba?null!=(M=null!=
(N=null!=(P=H[3857])?P:H[102100])?N:H[102113])?M:H[900913]:H[I.wkid])?`${"http://www.opengis.net/def/crs/"}${I}`:null:null}function y(I){if(x.isNone(I))return"";const {xmin:H,ymin:M,xmax:N,ymax:P}=I;return`${H},${M},${N},${P}`}function D(I){if(x.isNone(I))return null;const {start:H,end:M}=I;return`${x.isSome(H)?H.toISOString():".."}/${x.isSome(M)?M.toISOString():".."}`}function F(I){return x.isNone(I)||!I||"1\x3d1"===I?null:I}function G(I,H){if(!x.isSome(I)||"extent"!==I.type)return null;const {spatialReference:M}=
I;if(!M||M.isWGS84)return{bbox:y(I)};H=w(M,H);return x.isSome(H)?{bbox:y(I),"bbox-crs":H}:M.isWebMercator?{bbox:y(k.project(I,a.WGS84))}:null}function K(I,H,M){return I.find(N=>N.rel===H&&N.type===M)||I.find(N=>N.rel===H&&!N.type)}const J=z.getLogger("esri.layers.graphics.sources.ogcfeature");r.crsDefault="http://www.opengis.net/def/crs/OGC/1.3/CRS84";r.crsPrefix="http://www.opengis.net/def/crs/";r.getCollectionDefinition=function(I,H){return b.apply(this,arguments)};r.getServerCollections=function(I){return h.apply(this,
arguments)};r.getServerConformance=function(I){return l.apply(this,arguments)};r.getServerLandingPage=function(I){return d.apply(this,arguments)};r.getServerOpenApi=function(I){return q.apply(this,arguments)};r.getSpatialReferenceWkid=function(I){I=/^http:\/\/www\.opengis.net\/def\/crs\/(?<authority>.*)\/(?<version>.*)\/(?<code>.*)$/i.exec(I);I=null==I?void 0:I.groups;if(!I)return null;const {authority:H,code:M}=I;switch(H.toLowerCase()){case "ogc":switch(M.toLowerCase()){case "crs27":return a.GCS_NAD_1927.wkid;
case "crs83":return 4269;case "crs84":case "crs84h":return a.WGS84.wkid;default:return null}case "esri":case "epsg":return I=Number.parseInt(M,10),Number.isNaN(I)?null:I;default:return null}};r.queryFeatureSetJSON=function(I,H,M){return n.apply(this,arguments)};r.queryOptimizedFeatureSet=B;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/sources/geojson/geojson":function(){define(["exports","../../../../core/Error","../../OptimizedFeature",
"../../OptimizedGeometry","../../../support/fieldUtils"],function(r,u,E,C,v){function*z(l){switch(l.type){case "Feature":yield l;break;case "FeatureCollection":for(const d of l.features)d&&(yield d)}}function*x(l){if(!l)return null;switch(l.type){case "Point":yield l.coordinates;break;case "LineString":case "MultiPoint":yield*l.coordinates;break;case "MultiLineString":case "Polygon":for(const d of l.coordinates)yield*d;break;case "MultiPolygon":for(const d of l.coordinates)for(const q of d)yield*q}}
function*f(l,d={}){const {geometryType:q,objectIdField:n}=d;for(const A of l){var B;const {geometry:w,properties:y,id:D}=A;if(w&&h[w.type]!==q)continue;l=y||{};let F=null!=(B=l[n])?B:null;n&&null!=D&&!l[n]&&(l[n]=F=D);yield new E.OptimizedFeature(w?p(new C,w,d):null,l,null,F)}}function k(l){for(const d of l)if(2<d.length)return!0;return!1}function g(l){let d=0;for(let q=0;q<l.length;q++){const n=l[q],B=l[(q+1)%l.length];d+=n[0]*B[1]-B[0]*n[1]}return 0>=d}function m(l){const d=l[0],q=l[l.length-1];
d[0]===q[0]&&d[1]===q[1]&&d[2]===q[2]||l.push(d);return l}function p(l,d,q){switch(d.type){case "LineString":return c(l,d.coordinates,q),l;case "MultiLineString":for(const B of d.coordinates)c(l,B,q);return l;case "MultiPoint":return c(l,d.coordinates,q),l;case "MultiPolygon":for(var n of d.coordinates)for(t(l,n[0],q),d=1;d<n.length;d++)e(l,n[d],q);return l;case "Point":return b(l,d.coordinates,q),l;case "Polygon":n=d.coordinates;t(l,n[0],q);for(d=1;d<n.length;d++)e(l,n[d],q);return l}}function t(l,
d,q){d=m(d);g(d)?c(l,d,q):a(l,d,q)}function e(l,d,q){d=m(d);g(d)?a(l,d,q):c(l,d,q)}function c(l,d,q){for(const n of d)b(l,n,q);l.lengths.push(d.length)}function a(l,d,q){for(let n=d.length-1;0<=n;n--)b(l,d[n],q);l.lengths.push(d.length)}function b(l,d,q){const [n,B,A]=d;l.coords.push(n,B);q.hasZ&&l.coords.push(A||0)}const h={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};
r.createOptimizedFeatures=function(l,d){return Array.from(f(z(l),d))};r.getGeometryType=function(l){return h[l]};r.inferLayerProperties=function(l,d={}){const q=[];var n=new Set;const B=new Set;var A=!1;let w=null,y=!1,D=void 0;({geometryType:d=null}=d);var F=!1;for(const G of z(l)){const {geometry:K,properties:J,id:I}=G;if(K&&(d||(d=h[K.type]),h[K.type]!==d))continue;A||(A=x(K),A=k(A));!y&&(y=null!=I)&&(D=typeof I,w=Object.keys(J).filter(H=>J[H]===I));y&&null!=I&&(1<w.length?w=w.filter(H=>J[H]===
I):1===w.length&&(w=J[w[0]]===I?w:[]));if(!F&&J){l=!0;for(const H in J)if(!n.has(H))if(F=J[H],null==F)l=!1,B.add(H);else{a:switch(typeof F){case "string":F="esriFieldTypeString";break a;case "number":F="esriFieldTypeDouble";break a;default:F="unknown"}"unknown"===F?B.add(H):(B.delete(H),n.add(H),q.push({name:H,alias:H,type:F}))}F=l}}if(n=w&&1===w.length&&w[0]||null)for(const G of q)if(G.name===n&&v.isNumericField(G)){G.type="esriFieldTypeOID";break}return{fields:q,geometryType:d,hasZ:A,objectIdFieldName:n,
objectIdFieldType:D,unknownFields:Array.from(B)}};r.validateGeoJSON=function(l){if(!l)throw new u("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==l.type&&"FeatureCollection"!==l.type)throw new u("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:l});({crs:l}=l);if(l){var d="string"===typeof l?l:"name"===l.type?l.properties.name:"EPSG"===l.type?l.properties.code:null,q=/.*(CRS84H?|4326)$/i;if(!d||!q.test(d))throw new u("geojson-layer:unsupported-crs",
"unsupported GeoJSON 'crs' member",{crs:l});}};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/sources/support/clientSideDefaults":function(){define(["exports","../../../../core/has","../../../../core/lang","../../data/QueryEngineCapabilities","../../../../symbols/support/defaultsJSON"],function(r,u,E,C,v){const z=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let x=1;r.createCapabilities=function(f,k){return{analytics:{supportsCacheHint:!1},attachment:null,
data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:f},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:k,supportsDelete:k,supportsEditing:k,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:k,supportsExceedsLimitStatistics:!0},query:C.queryCapabilities,queryRelated:{supportsCount:!0,
supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:k,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1}}};r.createDefaultAttributesFunction=function(f,k){if(u("esri-csp-restrictions"))return()=>({[k]:null,
...f});try{let g=`this.${k} = null;`;for(const p in f){const t=z.test(p)?`.${p}`:`["${p}"]`;g+=`this${t} = ${JSON.stringify(f[p])};`}const m=(new Function(`\n      return class AttributesClass$${x++} {\n        constructor() {\n          ${g};\n        }\n      }\n    `))();return()=>new m}catch(g){return()=>({[k]:null,...f})}};r.createDefaultTemplate=function(f={}){return[{name:"New Feature",description:"",prototype:{attributes:E.clone(f)}}]};r.createDrawingInfo=function(f){return{renderer:{type:"simple",
symbol:"esriGeometryPoint"===f||"esriGeometryMultipoint"===f?v.defaultPointSymbolJSON:"esriGeometryPolyline"===f?v.defaultPolylineSymbolJSON:v.defaultPolygonSymbolJSON}}};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/support/defaultsJSON":function(){define(["exports"],function(r){const u=[252,146,31,255],E={type:"esriSMS",style:"esriSMSCircle",size:6,color:u,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},
C={type:"esriSLS",style:"esriSLSSolid",width:.75,color:u};r.defaultColor=u;r.defaultOutlineColor=[153,153,153,255];r.defaultPointSymbolJSON=E;r.defaultPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}};r.defaultPolylineSymbolJSON=C;r.defaultTextSymbolJSON={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,
0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0};r.errorPointSymbolJSON={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5};r.errorPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null};r.errorPolylineSymbolJSON={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/fieldType":function(){define(["exports",
"../../core/jsonMap"],function(r,u){u=new u.JSONMap({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"});r.kebabDict=u;Object.defineProperties(r,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/query/operations/query":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../request ../../../core/maybe ../../../core/urlUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../operations/urlUtils ./pbfQueryUtils ./queryZScale".split(" "),function(r,u,E,C,v,z,x,f,k,g){function m(b,h){if(h&&"extent"===b.type)return`${b.xmin},${b.ymin},${b.xmax},${b.ymax}`;if(h&&"point"===b.type)return`${b.x},${b.y}`;
b=b.toJSON();delete b.spatialReference;return JSON.stringify(b)}function p(b,h){const l=b.geometry,d=b.toJSON();delete d.compactGeometryEnabled;delete d.defaultSpatialReferenceEnabled;let q,n,B;C.isSome(l)&&(n=l.spatialReference,B=l.spatialReference.wkid||JSON.stringify(l.spatialReference),d.geometryType=z.getJsonType(l),d.geometry=m(l,b.compactGeometryEnabled),d.inSR=B);d.groupByFieldsForStatistics&&(d.groupByFieldsForStatistics=d.groupByFieldsForStatistics.join(","));d.objectIds&&(d.objectIds=d.objectIds.join(","));
d.orderByFields&&(d.orderByFields=d.orderByFields.join(","));!d.outFields||!d.returnDistinctValues&&(null!=h&&h.returnCountOnly||null!=h&&h.returnExtentOnly||null!=h&&h.returnIdsOnly)?delete d.outFields:d.outFields.includes("*")?d.outFields="*":d.outFields=d.outFields.join(",");d.outSR?(d.outSR=d.outSR.wkid||JSON.stringify(d.outSR),q=b.outSpatialReference):l&&(d.returnGeometry||d.returnCentroid)&&(d.outSR=d.inSR,q=n);d.returnGeometry&&delete d.returnGeometry;d.outStatistics&&(d.outStatistics=JSON.stringify(d.outStatistics));
d.pixelSize&&(d.pixelSize=JSON.stringify(d.pixelSize));d.quantizationParameters&&(b.defaultSpatialReferenceEnabled&&C.isSome(n)&&C.isSome(b.quantizationParameters)&&C.isSome(b.quantizationParameters.extent)&&n.equals(b.quantizationParameters.extent.spatialReference)&&delete d.quantizationParameters.extent.spatialReference,d.quantizationParameters=JSON.stringify(d.quantizationParameters));d.parameterValues&&(d.parameterValues=JSON.stringify(d.parameterValues));d.rangeValues&&(d.rangeValues=JSON.stringify(d.rangeValues));
d.dynamicDataSource&&(d.layer=JSON.stringify({source:d.dynamicDataSource}),delete d.dynamicDataSource);if(d.timeExtent){const {start:A,end:w}=d.timeExtent;if(null!=A||null!=w)d.time=A===w?A:`${null==A?"null":A},${null==w?"null":w}`;delete d.timeExtent}b.defaultSpatialReferenceEnabled&&C.isSome(n)&&C.isSome(q)&&n.equals(q)&&(d.defaultSR=d.inSR,delete d.inSR,delete d.outSR);return d}function t(){t=u._asyncToGenerator(function*(b,h,l,d){b=C.isSome(h.timeExtent)&&h.timeExtent.isEmpty?{data:{features:[]}}:
yield a(b,h,"json",d);g.applyFeatureSetZUnitScaling(h,l,b.data);return b});return t.apply(this,arguments)}function e(){e=u._asyncToGenerator(function*(b,h,l,d){if(C.isSome(h.timeExtent)&&h.timeExtent.isEmpty)return{data:l.createFeatureResult()};b=yield c(b,h,d);b.data=k.parsePBFFeatureQuery(b.data,l);return b});return e.apply(this,arguments)}function c(b,h,l){return a(b,h,"pbf",l)}function a(b,h,l,d={},q={}){const n="string"===typeof b?v.urlToObject(b):b;b=h.geometry?[h.geometry]:[];d.responseType=
"pbf"===l?"array-buffer":"json";return x.normalizeCentralMeridian(b,null,d).then(B=>{B=B&&B[0];C.isSome(B)&&(h=h.clone(),h.geometry=B);B=f.mapParameters({...n.query,f:l,...q,...p(h,q)});return E(v.join(n.path,"query"),{...d,query:{...B,...d.query}})})}r.encodeGeometry=m;r.executeQuery=function(b,h,l,d){return t.apply(this,arguments)};r.executeQueryForCount=function(b,h,l){return C.isSome(h.timeExtent)&&h.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):a(b,h,"json",l,{returnIdsOnly:!0,returnCountOnly:!0})};
r.executeQueryForExtent=function(b,h,l){return C.isSome(h.timeExtent)&&h.timeExtent.isEmpty?Promise.resolve({data:{count:0,extent:null}}):a(b,h,"json",l,{returnExtentOnly:!0,returnCountOnly:!0}).then(d=>{const q=d.data;if(q.hasOwnProperty("extent"))return d;if(q.features)throw Error("Layer does not support extent calculation.");if(q.hasOwnProperty("count"))throw Error("Layer does not support extent calculation.");return d})};r.executeQueryForIds=function(b,h,l){return C.isSome(h.timeExtent)&&h.timeExtent.isEmpty?
Promise.resolve({data:{objectIds:[]}}):a(b,h,"json",l,{returnIdsOnly:!0})};r.executeQueryPBF=function(b,h,l,d){return e.apply(this,arguments)};r.executeQueryPBFBuffer=c;r.queryToQueryStringParameters=p;r.runQuery=a;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/operations/urlUtils":function(){define(["exports"],function(r){function u(E){const C={};for(const v in E){if("declaredClass"===v)continue;const z=E[v];if(null!=z&&"function"!==typeof z)if(Array.isArray(z)){C[v]=
[];for(let x=0;x<z.length;x++)C[v][x]=u(z[x])}else"object"===typeof z?z.toJSON&&(C[v]=JSON.stringify(z)):C[v]=z}return C}r.mapParameters=u;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/query/operations/pbfQueryUtils":function(){define(["exports","./pbfFeatureServiceParser"],function(r,u){r.parsePBFFeatureQuery=function(E,C){var v=u.parseFeatureQuery(E,C);E=v.queryResult.featureResult;C=v.queryResult.queryGeometry;v=v.queryResult.queryGeometryType;
if(E&&E.features&&E.features.length&&E.objectIdFieldName){const z=E.objectIdFieldName;for(const x of E.features)x.attributes&&(x.objectId=x.attributes[z])}E&&(E.queryGeometry=C,E.queryGeometryType=v);return E};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/query/operations/pbfFeatureServiceParser":function(){define("exports ../../../core/Error ../../../core/maybe ../../../core/pbf ../../../layers/graphics/OptimizedGeometry ./pbfOptimizedFeatureSet".split(" "),
function(r,u,E,C,v,z){function x(w){return w>=n.length?null:n[w]}function f(w,y,D){for(D=y.createPointGeometry(D);w.next();)switch(w.tag()){case 3:{var F=w.getUInt32();F=w.pos()+F;let G=0;for(;w.pos()<F;)y.addCoordinatePoint(D,w.getSInt64(),G++);break}default:w.skip()}return D}function k(w,y,D){const F=y.createGeometry(D);for(D=2+(D.hasZ?1:0)+(D.hasM?1:0);w.next();)switch(w.tag()){case 2:var G=w.getUInt32();G=w.pos()+G;for(var K=0;w.pos()<G;)y.addLength(F,w.getUInt32(),K++);break;case 3:G=w.getUInt32();
G=w.pos()+G;K=0;for(y.allocateCoordinates(F);w.pos()<G;)y.addCoordinate(F,w.getSInt64(),K),K++,K===D&&(K=0);break;default:w.skip()}return F}function g(w){const y=new v;let D="esriGeometryPoint";for(;w.next();)switch(w.tag()){case 2:var F=w.getUInt32();for(F=w.pos()+F;w.pos()<F;)y.lengths.push(w.getUInt32());break;case 3:F=w.getUInt32();for(F=w.pos()+F;w.pos()<F;)y.coords.push(w.getSInt64());break;case 1:D=z.OPTIMIZED_GEOMETRY_TYPES[w.getEnum()];break;default:w.skip()}return{queryGeometry:y,queryGeometryType:D}}
function m(w){for(;w.next();)switch(w.tag()){case 1:return w.getString();case 2:return w.getFloat();case 3:return w.getDouble();case 4:return w.getSInt32();case 5:return w.getUInt32();case 6:return w.getInt64();case 7:return w.getUInt64();case 8:return w.getSInt64();case 9:return w.getBool();default:return w.skip(),null}return null}function p(w){const y={type:x(0)};for(;w.next();)switch(w.tag()){case 1:y.name=w.getString();break;case 2:y.type=x(w.getEnum());break;case 3:y.alias=w.getString();break;
case 4:var D=w.getEnum();D=D>=B.length?null:B[D];y.sqlType=D;break;case 5:w.skip();break;case 6:y.defaultValue=w.getString();break;default:w.skip()}return y}function t(w){const y={};for(;w.next();)switch(w.tag()){case 1:y.name=w.getString();break;case 2:y.isSystemMaintained=w.getBool();break;default:w.skip()}return y}function e(w,y,D,F){const G=y.createFeature(D);let K=0;for(;w.next();)switch(w.tag()){case 1:{const J=F[K++].name;G.attributes[J]=w.processMessage(m);break}case 2:G.geometry=w.processMessageWithArgs(k,
y,D);break;case 4:G.centroid=w.processMessageWithArgs(f,y,D);break;default:w.skip()}return G}function c(w){const y=[1,1,1,1];for(;w.next();)switch(w.tag()){case 1:y[0]=w.getDouble();break;case 2:y[1]=w.getDouble();break;case 4:y[2]=w.getDouble();break;case 3:y[3]=w.getDouble();break;default:w.skip()}return y}function a(w){const y=[0,0,0,0];for(;w.next();)switch(w.tag()){case 1:y[0]=w.getDouble();break;case 2:y[1]=w.getDouble();break;case 4:y[2]=w.getDouble();break;case 3:y[3]=w.getDouble();break;
default:w.skip()}return y}function b(w){const y={originPosition:0>=A.length?null:A[0]};for(;w.next();)switch(w.tag()){case 1:var D=w.getEnum();y.originPosition=D>=A.length?null:A[D];break;case 2:y.scale=w.processMessage(c);break;case 3:y.translate=w.processMessage(a);break;default:w.skip()}return y}function h(w){const y={};for(;w.next();)switch(w.tag()){case 1:y.shapeAreaFieldName=w.getString();break;case 2:y.shapeLengthFieldName=w.getString();break;case 3:y.units=w.getString();break;default:w.skip()}return y}
function l(w,y){for(y=y.createSpatialReference();w.next();)switch(w.tag()){case 1:y.wkid=w.getUInt32();break;case 5:y.wkt=w.getString();break;case 2:y.latestWkid=w.getUInt32();break;case 3:y.vcsWkid=w.getUInt32();break;case 4:y.latestVcsWkid=w.getUInt32();break;default:w.skip()}return y}function d(w,y){const D=y.createFeatureResult();D.geometryType=0>=y.geometryTypes.length?null:y.geometryTypes[0];let F=!1;for(;w.next();)switch(w.tag()){case 1:D.objectIdFieldName=w.getString();break;case 3:D.globalIdFieldName=
w.getString();break;case 4:D.geohashFieldName=w.getString();break;case 5:D.geometryProperties=w.processMessage(h);break;case 7:var G=w.getEnum();D.geometryType=G>=y.geometryTypes.length?null:y.geometryTypes[G];break;case 8:D.spatialReference=w.processMessageWithArgs(l,y);break;case 10:D.hasZ=w.getBool();break;case 11:D.hasM=w.getBool();break;case 12:D.transform=w.processMessage(b);break;case 9:G=w.getBool();D.exceededTransferLimit=G;break;case 13:y.addField(D,w.processMessage(p));break;case 15:F||
(y.prepareFeatures(D),F=!0);y.addFeature(D,w.processMessageWithArgs(e,y,D,D.fields));break;case 2:D.uniqueIdField=w.processMessage(t);break;default:w.skip()}y.finishFeatureResult(D);return D}function q(w,y){const D={};let F=null;for(;w.next();)switch(w.tag()){case 4:F=w.processMessageWithArgs(g);break;case 1:D.featureResult=w.processMessageWithArgs(d,y);break;default:w.skip()}E.isSome(F)&&D.featureResult&&y.addQueryGeometry(D,F);return D}const n="esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeString esriFieldTypeDate esriFieldTypeOID esriFieldTypeGeometry esriFieldTypeBlob esriFieldTypeRaster esriFieldTypeGUID esriFieldTypeGlobalID esriFieldTypeXML".split(" "),
B="sqlTypeBigInt sqlTypeBinary sqlTypeBit sqlTypeChar sqlTypeDate sqlTypeDecimal sqlTypeDouble sqlTypeFloat sqlTypeGeometry sqlTypeGUID sqlTypeInteger sqlTypeLongNVarchar sqlTypeLongVarbinary sqlTypeLongVarchar sqlTypeNChar sqlTypeNVarchar sqlTypeOther sqlTypeReal sqlTypeSmallInt sqlTypeSqlXml sqlTypeTime sqlTypeTimestamp sqlTypeTimestamp2 sqlTypeTinyInt sqlTypeVarbinary sqlTypeVarchar".split(" "),A=["upperLeft","lowerLeft"];r.parseFeatureQuery=function(w,y){try{const D=new C(new Uint8Array(w),new DataView(w));
for(w={};D.next();)switch(D.tag()){case 2:w.queryResult=D.processMessageWithArgs(q,y);break;default:D.skip()}return w}catch(D){throw new u("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:D});}};r.parseFieldType=x;r.parseTransform=b;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/query/operations/pbfOptimizedFeatureSet":function(){define("exports ../../../core/unitUtils ../../../geometry/support/spatialReferenceUtils ../../../layers/graphics/OptimizedFeature ../../../layers/graphics/OptimizedFeatureSet ../../../layers/graphics/OptimizedGeometry".split(" "),
function(r,u,E,C,v,z){const x=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"];let f=function(){function k(m){this.options=m;this.geometryTypes=x;this._vertexDimension=this._coordinatePtr=0}var g=k.prototype;g.createFeatureResult=function(){return new v};g.prepareFeatures=function(m){this._vertexDimension=2;m.hasZ&&this._vertexDimension++;m.hasM&&this._vertexDimension++};g.finishFeatureResult=function(m){if(m&&m.features&&m.hasZ&&this.options.sourceSpatialReference&&
m.spatialReference&&!E.equals(m.spatialReference,this.options.sourceSpatialReference)&&!m.spatialReference.vcsWkid){var p=u.getMetersPerVerticalUnitForSR(this.options.sourceSpatialReference),t=u.getMetersPerVerticalUnitForSR(m.spatialReference);p/=t;if(1!==p)for(const e of m.features)if(C.hasGeometry(e))for(m=e.geometry.coords,t=2;t<m.length;t+=3)m[t]*=p}};g.addFeature=function(m,p){m.features.push(p)};g.createFeature=function(){return new C.OptimizedFeature};g.createSpatialReference=function(){return{wkid:0}};
g.createGeometry=function(){return new z};g.addField=function(m,p){m.fields.push(p)};g.allocateCoordinates=function(m){m.coords.length=m.lengths.reduce((p,t)=>p+t,0)*this._vertexDimension;this._coordinatePtr=0};g.addCoordinate=function(m,p){m.coords[this._coordinatePtr++]=p};g.addCoordinatePoint=function(m,p){m.coords.push(p)};g.addLength=function(m,p){m.lengths.push(p)};g.addQueryGeometry=function(m,p){m.queryGeometry=p.queryGeometry;m.queryGeometryType=p.queryGeometryType};g.createPointGeometry=
function(){return new z};return k}();r.OPTIMIZED_GEOMETRY_TYPES=x;r.OptimizedFeatureSetParserContext=f;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/query/operations/queryZScale":function(){define(["exports","../../../core/maybe","../../../geometry/support/zscale"],function(r,u,E){r.applyFeatureSetZUnitScaling=function(C,v,z){if(z&&z.features&&z.hasZ&&(C=E.getGeometryZScaler(z.geometryType,v,C.outSpatialReference),!u.isNone(C)))for(const x of z.features)C(x.geometry)};
Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/FeatureSetReaderJSON":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ./FeatureSetReader".split(" "),function(r,u,E,C,v,z){function x({coords:k,lengths:g}){let m=0;for(const p of g){for(g=1;g<p;g++)k[2*(m+g)]+=k[2*(m+
g)-2],k[2*(m+g)+1]+=k[2*(m+g)-1];m+=p}}let f=function(k){function g(p,t,e){p=k.call(this,p,e)||this;p._featureIndex=-1;p._dateFields=new Set;p._geometryType=null==e?void 0:e.geometryType;p._features=t;return p}u._inheritsLoose(g,k);g.fromFeatures=function(p,t){const {objectIdField:e,geometryType:c}=t,a=C.convertFromFeatures([],p,c,!1,!1,e);for(let b=0;b<a.length;b++)a[b].displayId=p[b].displayId;return g.fromOptimizedFeatures(a,t)};g.fromFeatureSet=function(p,t){p=C.convertFromFeatureSet(p,t.objectIdField);
return g.fromOptimizedFeatureSet(p,t)};g.fromOptimizedFeatureSet=function(p,t){const {features:e}=p;t=g.fromOptimizedFeatures(e,t);t._exceededTransferLimit=p.exceededTransferLimit;t._transform=p.transform;for(const c of p.fields)"esriFieldTypeDate"===c.type&&t._dateFields.add(c.name);return t};g.fromOptimizedFeatures=function(p,t,e){const c=z.FeatureSetReader.createInstance();p=new g(c,p,t);p._transform=e;return p};var m=g.prototype;m.removeIds=function(p){const t=new Set(p);this._features=this._features.filter(e=>
!t.has(e.objectId))};m.append=function(p){for(const t of p)this._features.push(t)};m.getSize=function(){return this._features.length};m.getCursor=function(){return this.copy()};m.getQuantizationTransform=function(){return this._transform};m.getAttributeHash=function(){let p="";for(const t in this._current.attributes)p+=this._current.attributes[t];return p};m.getIndex=function(){return this._featureIndex};m.setIndex=function(p){this._featureIndex=p};m.getObjectId=function(){return this._current.objectId};
m.getDisplayId=function(){return this._current.displayId};m.setDisplayId=function(p){this._current.displayId=p};m.getGroupId=function(){return this._current.groupId};m.setGroupId=function(p){this._current.groupId=p};m.copy=function(){const p=new g(this.instance,this._features,this.fullSchema());this.copyInto(p);return p};m.next=function(){for(;++this._featureIndex<this._features.length&&!this._getExists(););return this._featureIndex<this._features.length};m.readLegacyFeature=function(){return C.convertToFeature(this._current,
this.geometryType,this.hasZ,this.hasM)};m.readOptimizedFeature=function(){return this._current};m.readLegacyPointGeometry=function(){return this.readGeometry()?{x:this.getX(),y:this.getY()}:null};m.readLegacyGeometry=function(){const p=this.readGeometry();return C.convertToGeometry(p,this.geometryType,this.hasZ,this.hasM)};m.readLegacyCentroid=function(){const p=this.readCentroid();return E.isNone(p)?null:{x:p.coords[0]*this._sx+this._tx,y:p.coords[1]*this._sy+this._ty}};m.readGeometryArea=function(){return v.hasGeometry(this._current)?
C.getQuantizedArea(this._current.geometry,2):0};m.readUnquantizedGeometry=function(){var p=this.readGeometry();if("esriGeometryPoint"===this.geometryType||!p)return p;p=p.clone();x(p);return p};m.readHydratedGeometry=function(){var p=this._current.geometry;if(E.isNone(p))return null;p=p.clone();E.isSome(this._transform)&&C.unquantizeOptimizedGeometry(p,p,this.hasZ,this.hasM,this._transform);return p};m.getXHydrated=function(){if(!v.hasGeometry(this._current))return 0;const p=this._current.geometry.coords[0],
t=this.getQuantizationTransform();return E.isNone(t)?p:p*t.scale[0]+t.translate[0]};m.getYHydrated=function(){if(!v.hasGeometry(this._current))return 0;const p=this._current.geometry.coords[1],t=this.getQuantizationTransform();return E.isNone(t)?p:t.translate[1]-p*t.scale[1]};m.getX=function(){return v.hasGeometry(this._current)?this._current.geometry.coords[0]*this._sx+this._tx:0};m.getY=function(){return v.hasGeometry(this._current)?this._current.geometry.coords[1]*this._sy+this._ty:0};m.readGeometry=
function(){if(!v.hasGeometry(this._current))return null;const p=this._current.geometry.clone();if(p.isPoint)return p.coords[0]=p.coords[0]*this._sx+this._tx,p.coords[1]=p.coords[1]*this._sy+this._ty,p;let t=0;for(const e of p.lengths)p.coords[2*t]=p.coords[2*t]*this._sx+this._tx,p.coords[2*t+1]=p.coords[2*t+1]*this._sy+this._ty,t+=e;return p};m.readCentroid=function(){if(!v.hasGeometry(this._current))return null;if(E.isNone(this._current.centroid)){var p=this._computeCentroid();if(E.isNone(p))return null;
p.coords[0]=(p.coords[0]-this._tx)/this._sx;p.coords[1]=(p.coords[1]-this._ty)/this._sy;this._current.centroid=p}p=this._current.centroid.clone();p.coords[0]=p.coords[0]*this._sx+this._tx;p.coords[1]=p.coords[1]*this._sx+this._ty;return p};m.hasField=function(p){return p in this._current.attributes?!0:this.getFieldNames().map(t=>t.toLowerCase()).includes(p.toLowerCase())};m.getFieldNames=function(){return Object.keys(this._current.attributes)};m._readAttribute=function(p,t){var e=this._current.attributes[p];
if(void 0!==e)return null!=e&&t&&this._dateFields.has(p)?new Date(e):e;e=this.readAttributes();p=p.toLocaleLowerCase().trim();for(const c in e)if(c.toLocaleLowerCase().trim()===p)return p=this._current.attributes[c],null!=p&&t&&this._dateFields.has(c)?new Date(p):p};m.copyInto=function(p){k.prototype.copyInto.call(this,p);p._featureIndex=this._featureIndex;p._transform=this._transform;p._dateFields=this._dateFields};m._readAttributes=function(){return this._current.attributes};u._createClass(g,[{key:"_current",
get:function(){return this._features[this._featureIndex]}},{key:"geometryType",get:function(){return this._geometryType}},{key:"hasFeatures",get:function(){return!!this._features.length}},{key:"hasNext",get:function(){return this._featureIndex+1<this._features.length}},{key:"exceededTransferLimit",get:function(){return this._exceededTransferLimit}},{key:"hasZ",get:function(){return!1}},{key:"hasM",get:function(){return!1}}]);return g}(z.FeatureSetReader);r.FeatureSetReaderJSON=f;Object.defineProperties(r,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/FeatureSetReaderPBF":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/pbf ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ../../../../../layers/graphics/OptimizedGeometry ./FeatureSetReader ./FeatureSetReaderPBFHeader".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m){function p(b){if(b<=a.small.delta.length)return a.small;if(b<=a.large.delta.length)return a.large;a.large.delta=new Int32Array(Math.round(1.25*b));a.large.decoded=new Int32Array(Math.round(1.25*b));return a.large}function t(b){var h=b.getLength();for(h=b.pos()+h;b.pos()<h&&b.next();)switch(b.tag()){case 1:return b.getString();case 2:return b.getFloat();case 3:return b.getDouble();case 4:return b.getSInt32();case 5:return b.getUInt32();case 6:return b.getInt64();case 7:return b.getUInt64();
case 8:return b.getSInt64();case 9:return b.getBool();default:return b.skip(),null}return null}function e(b,h,l,d){return 0===b*d-l*h&&0<b*l+h*d}const c=C.getLogger("esri.view.2d.layers.features.support.FeatureSetReaderPBF"),a={small:{delta:new Int32Array(128),decoded:new Int32Array(128)},large:{delta:new Int32Array(128E3),decoded:new Int32Array(128E3)}};C=function(b){function h(d,q,n,B){d=b.call(this,d,B)||this;d._hasNext=!1;d._isPoints=!1;d._featureIndex=-1;d._featureOffset=0;d._cache={area:0,unquantGeometry:void 0,
geometry:void 0,centroid:void 0,legacyFeature:void 0,optFeature:void 0};d._geometryType=B.geometryType;d._reader=q;d._header=n;d._hasNext=n.hasFeatures;d._isPoints="esriGeometryPoint"===B.geometryType;return d}u._inheritsLoose(h,b);h.fromBuffer=function(d,q,n=!1){var B=q.geometryType;a:{try{const y=new z(new Uint8Array(d),new DataView(d));for(;y.next();)switch(y.tag()){case 2:b:{for(var A=y.getMessage();A.next();)switch(A.tag()){case 1:var w=A.getMessage();break b;default:A.skip()}w=null}break a;
default:y.skip()}}catch(y){d=new E("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:y}),c.error(d)}w=null}d=w;n=m.parseHeader(d,"esriGeometryPoint"===B,n);B=g.FeatureSetReader.createInstance();return new h(B,d,n,q)};var l=h.prototype;l.hasField=function(d){return this._header.hasField(d)||this._header.hasField(d.toLowerCase().trim())};l.getFieldNames=function(){return this._header.fields.map(d=>d.fieldName)};l.getSize=function(){return this.size};l.getQuantizationTransform=
function(){return this._header.transform};l.getCursor=function(){return this.copy()};l.getIndex=function(){return this._featureIndex};l.setIndex=function(d){this._cache.area=0;this._cache.unquantGeometry=void 0;this._cache.geometry=void 0;this._cache.centroid=void 0;this._cache.legacyFeature=void 0;this._cache.optFeature=void 0;this._featureIndex=d};l.getAttributeHash=function(){let d="";this._header.fields.forEach(({index:q})=>{d+=this._readAttributeAtIndex(q)+"."});return d};l.getObjectId=function(){return this._readAttributeAtIndex(this._header.objectIdFieldIndex)};
l.getDisplayId=function(){return this._header.displayIds[this._featureIndex]};l.setDisplayId=function(d){this._header.displayIds[this._featureIndex]=d};l.getGroupId=function(){return this._header.groupIds[this._featureIndex]};l.setGroupId=function(d){this._header.groupIds[this._featureIndex]=d};l.readLegacyFeature=function(){if(void 0===this._cache.legacyFeature){var d,q=this.readCentroid();q={attributes:this.readAttributes(),geometry:this._isPoints?this.readLegacyPointGeometry():this.readLegacyGeometry(),
centroid:null!=(d=q&&{x:q.coords[0],y:q.coords[1]})?d:null};return this._cache.legacyFeature=q}return this._cache.legacyFeature};l.readOptimizedFeature=function(){if(void 0===this._cache.optFeature){const d=new f.OptimizedFeature(this.readGeometry(),this.readAttributes(),this.readCentroid());d.objectId=this.getObjectId();d.displayId=this.getDisplayId();return this._cache.optFeature=d}return this._cache.optFeature};l.getXHydrated=function(){const d=this._header.centroid[2*this._featureIndex],q=this.getQuantizationTransform();
return v.isNone(q)?d:d*q.scale[0]+q.translate[0]};l.getYHydrated=function(){const d=this._header.centroid[2*this._featureIndex+1],q=this.getQuantizationTransform();return v.isNone(q)?d:q.translate[1]-d*q.scale[1]};l.getX=function(){return this._header.centroid[2*this._featureIndex]*this._sx+this._tx};l.getY=function(){return this._header.centroid[2*this._featureIndex+1]*this._sy+this._ty};l.readLegacyPointGeometry=function(){const d=this.getX(),q=this.getY();return{x:d,y:q}};l.readLegacyGeometry=
function(d){d=this.readGeometry(d);return x.convertToGeometry(d,this.geometryType,!1,!1)};l.readLegacyCentroid=function(){const d=this.readCentroid();if(!d)return null;const [q,n]=d.coords;return{x:q,y:n}};l.readGeometryArea=function(){this._cache.area||this.readGeometry(!0);return this._cache.area};l.readUnquantizedGeometry=function(d=!1){if(void 0===this._cache.unquantGeometry){d=this.readGeometry(d);if(!d)return this._cache.unquantGeometry=null;var q=p(d.coords.length).decoded;d=d.clone(q);q=d.coords;
let n=0;for(const B of d.lengths){for(let A=1;A<B;A++){const w=2*(n+A),y=2*(n+A-1);q[w]+=q[y];q[w+1]+=q[y+1]}n+=B}return this._cache.unquantGeometry=d}return this._cache.unquantGeometry};l.readHydratedGeometry=function(){if(this._isPoints){if(268435455===this._header.centroid[2*this._featureIndex])return null;var d=this.getXHydrated(),q=this.getYHydrated();return new k([],[d,q])}d=this.readGeometry();if(!d)return null;d=d.clone();q=this.getQuantizationTransform();v.isSome(q)&&x.unquantizeOptimizedGeometry(d,
d,this.hasZ,this.hasM,q);return d};l.readGeometry=function(d=!1){if(void 0===this._cache.geometry){var q=null;if(this._isPoints){if(268435455===this._header.centroid[2*this._featureIndex])return null;d=this.getX();q=this.getY();q=new k([],[d,q])}else{const n=this._header.offsets.geometry[this._featureIndex],B=this._reader;if(0===n)return null;B.move(n);try{q=d?this._parseGeometryForDisplay(B):this._parseGeometry(B)}catch(A){return console.error("Failed to parse geometry!",A),null}}return this._cache.geometry=
q}return this._cache.geometry};l.readCentroid=function(){if(void 0===this._cache.centroid){var d=null;d=this._header.centroid[2*this._featureIndex]+this._tx;const q=this._header.centroid[2*this._featureIndex+1]+this._ty;if(268435455===d){if(d=this._computeCentroid())this._header.centroid[2*this._featureIndex]=d.coords[0]-this._tx,this._header.centroid[2*this._featureIndex+1]=d.coords[1]-this._ty}else d=new k([],[d,q]);return this._cache.centroid=d}return this._cache.centroid};l.copy=function(){var d=
this._reader.clone();d=new h(this.instance,d,this._header,this.fullSchema());this.copyInto(d);return d};l.next=function(){this._cache.area=0;this._cache.unquantGeometry=void 0;this._cache.geometry=void 0;this._cache.centroid=void 0;this._cache.legacyFeature=void 0;for(this._cache.optFeature=void 0;++this._featureIndex<this.size&&!this._getExists(););return this._featureIndex<this.size};l._readAttribute=function(d,q){d=this._header.hasField(d)?d:d.toLowerCase().trim();var n=this._header.getFieldIndex(d);
if(null!=n)return n=this._readAttributeAtIndex(n),q&&null!=n?this._header.isDateField(d)?new Date(n):n:n};l._readAttributes=function(){const d={};this._header.fields.forEach(({fieldName:q,index:n})=>{d[q]=this._readAttributeAtIndex(n)});return d};l.copyInto=function(d){b.prototype.copyInto.call(this,d);d._featureIndex=this._featureIndex;d._featureOffset=this._featureOffset;d._hasNext=this._hasNext};l._readAttributeAtIndex=function(d){const q=this._reader;q.move(this._header.offsets.attributes[this._featureIndex*
this._header.fieldCount+d]);return t(q)};l._parseGeometry=function(d){var q=d.getLength();q=d.pos()+q;const n=[],B=[];for(;d.pos()<q&&d.next();)switch(d.tag()){case 2:var A=d.getUInt32();for(A=d.pos()+A;d.pos()<A;)B.push(d.getUInt32());break;case 3:A=d.getUInt32();A=d.pos()+A;n.push(d.getSInt32()+this._tx);n.push(d.getSInt32()+this._ty);this.hasZ&&d.getSInt32();for(this.hasM&&d.getSInt32();d.pos()<A;)n.push(d.getSInt32()),n.push(d.getSInt32()),this.hasZ&&d.getSInt32(),this.hasM&&d.getSInt32();break;
default:d.skip()}return new k(B,n)};l._parseGeometryForDisplay=function(d){var q=d.getLength();const n=d.pos()+q,B=[];q=[];let A=0,w=0;var y=null;let D=0;const F="esriGeometryPolygon"===this.geometryType;for(;d.pos()<n&&d.next();)switch(d.tag()){case 2:y=d.getUInt32();for(y=d.pos()+y;d.pos()<y;){var G=d.getUInt32();B.push(G);A+=G}y=p(2*A).delta;break;case 3:d.getUInt32();G=2+(this.hasZ?1:0)+(this.hasM?1:0);for(const X of B)if(w+G*X>y.length)for(var K=0;K<X;K++)d.getSInt32(),d.getSInt32(),this.hasZ&&
d.getSInt32(),this.hasM&&d.getSInt32();else if(F){K=this.getAreaSimplificationThreshold(X,this._header.vertexCount);var J=2,I=1,H=d.getSInt32(),M=d.getSInt32();y[w++]=H;y[w++]=M;this.hasZ&&d.getSInt32();this.hasM&&d.getSInt32();var N=d.getSInt32(),P=d.getSInt32();this.hasZ&&d.getSInt32();for(this.hasM&&d.getSInt32();J<X;){var ba=d.getSInt32();let S=d.getSInt32();this.hasZ&&d.getSInt32();this.hasM&&d.getSInt32();const W=H+N,R=M+P,Z=W+ba,ka=R+S;.5*Math.abs(H*R+W*ka+Z*M-H*ka-W*M-Z*R)>=K?(D+=-.5*(W-H)*
(R+M),1<I&&e(y[w-2],y[w-1],N,P)?(y[w-2]+=N,y[w-1]+=P):(y[w++]=N,y[w++]=P,I++),H=W,M=R):(ba+=N,S+=P);N=ba;P=S;J++}3>I?w-=2*I:(D+=-.5*(H+N-H)*(M+P+M),e(y[w-2],y[w-1],N,P)?(y[w-2]+=N,y[w-1]+=P,q.push(I)):(y[w++]=N,y[w++]=P,q.push(++I)))}else{K=0;J=d.getSInt32();I=d.getSInt32();this.hasZ&&d.getSInt32();this.hasM&&d.getSInt32();y[w++]=J;y[w++]=I;K+=1;for(H=1;H<X;H++)M=d.getSInt32(),N=d.getSInt32(),P=J+M,ba=I+N,D+=-.5*(P-J)*(ba+I),this.hasZ&&d.getSInt32(),this.hasM&&d.getSInt32(),2<H&&e(y[w-2],y[w-1],M,
N)?(y[w-2]+=M,y[w-1]+=N):(y[w++]=M,y[w++]=N,K+=1),J=P,I=ba;q.push(K)}break;default:d.skip()}this._cache.area=D;if(!q.length)return null;if(this._tx||this._ty){d=0;for(const X of q)y[2*d]+=this._tx,y[2*d+1]+=this._ty,d+=X}return new k(q,y)};u._createClass(h,[{key:"geometryType",get:function(){return this._geometryType}},{key:"size",get:function(){return this._header.featureCount}},{key:"hasZ",get:function(){return!1}},{key:"hasM",get:function(){return!1}},{key:"stride",get:function(){return 2+(this.hasZ?
1:0)+(this.hasM?1:0)}},{key:"hasFeatures",get:function(){return this._header.hasFeatures}},{key:"hasNext",get:function(){return this._hasNext}},{key:"exceededTransferLimit",get:function(){return this._header.exceededTransferLimit}}]);return h}(g.FeatureSetReader);r.FeatureSetReaderPBF=C;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/FeatureSetReaderPBFHeader":function(){define(["exports","../../../../../core/Error",
"../../../../../rest/query/operations/pbfFeatureServiceParser"],function(r,u,E){let C=function(){function v(){this.fieldMap=new Map;this.fields=[];this.hasFeatures=!1;this.vertexCount=this.objectIdFieldIndex=this.featureCount=this.fieldCount=0;this.offsets={attributes:[],geometry:[]};this.centroid=[]}var z=v.prototype;z.hasField=function(x){return this.fieldMap.has(x)};z.isDateField=function(x){var f;return null==(f=this.fieldMap.get(x))?void 0:f.isDate};z.getFieldIndex=function(x){var f;return null==
(f=this.fieldMap.get(x))?void 0:f.index};return v}();r.FeatureSetHeader=C;r.parseHeader=function(v,z,x=!1){const f=v.pos(),k=new C;let g=0,m=0,p=null,t=null,e=null,c=!1;for(;v.next();)switch(v.tag()){case 1:p=v.getString();break;case 3:t=v.getString();break;case 12:e=v.processMessage(E.parseTransform);break;case 9:k.exceededTransferLimit=v.getBool();if(k.exceededTransferLimit){k.offsets.geometry=x?new Float64Array(8E3):new Int32Array(8E3);k.centroid=x?new Float64Array(16E3):new Int32Array(16E3);for(var a=
0;a<k.centroid.length;a++)k.centroid[a]=268435455}break;case 13:a=v;var b=a.getLength();b=a.pos()+b;for(var h={name:"",isDate:!1};a.pos()<b&&a.next();)switch(a.tag()){case 1:h.name=a.getString();break;case 2:"esriFieldTypeDate"===E.parseFieldType(a.getEnum())&&(h.isDate=!0);break;default:a.skip()}a=h;h=a.name;b=a.name.toLowerCase().trim();h={fieldName:h,index:g++,isDate:a.isDate};k.fields.push(h);k.fieldMap.set(a.name,h);k.fieldMap.set(b,h);break;case 15:a=v.getLength();a=v.pos()+a;k.exceededTransferLimit||
(b=k.centroid,k.offsets.geometry.push(0),b.push(268435455),b.push(268435455));!c&&k.exceededTransferLimit&&(c=!0,k.offsets.attributes=x?new Float64Array(8E3*g):new Uint32Array(8E3*g));for(b=m*g;v.pos()<a&&v.next();)switch(v.tag()){case 1:c?k.offsets.attributes[b++]=v.pos():k.offsets.attributes.push(v.pos());h=v.getLength();v.skipLen(h);break;case 2:if(z)for(h=v.getLength(),h=v.pos()+h;v.pos()<h&&v.next();)switch(v.tag()){case 3:v.getUInt32();var l=v.getSInt64(),d=v.getSInt64();k.centroid[2*m]=l;k.centroid[2*
m+1]=d;break;default:v.skip()}else k.offsets.geometry[m]=v.pos(),h=v.getLength(),k.vertexCount+=h,v.skipLen(h);break;case 4:h=v.getLength();for(h=v.pos()+h;v.pos()<h&&v.next();)switch(v.tag()){case 3:v.getUInt32();l=v.getSInt64();d=v.getSInt64();k.centroid[2*m]=l;k.centroid[2*m+1]=d;break;default:v.skip()}break;default:v.skip()}m++;k.hasFeatures=!0;break;default:v.skip()}z=p||t;if(!z)throw new u("FeatureSet has no objectId or globalId field name");k.featureCount=m;k.fieldCount=g;k.objectIdFieldIndex=
k.getFieldIndex(z);k.transform=e;k.displayIds=new Uint32Array(k.featureCount);k.groupIds=new Uint16Array(k.featureCount);v.move(f);return k};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/sources/DataTileSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../TimeExtent ../../../../../core/Evented ../../../../../core/has ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/diffUtils ../../../../../rest/support/Query ./DataTileSubscription ../support/UpdateToken".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m){function p(e,c){const a=new Set;e&&e.forEach(b=>a.add(b));c&&c.forEach(b=>a.add(b));return a.has("*")?["*"]:Array.from(a)}let t=function(){function e(a){this.events=new C;this._resolver=x.createResolver();this._didEdit=!1;this._subscriptions=new Map;this._outSR=a.outSR;this._serviceInfo=a.serviceInfo;this._onTileUpdateMessage=a.onMessage}var c=e.prototype;c.destroy=function(){};c._onMessage=function(){var a=u._asyncToGenerator(function*(b){var h,l;const d=this._subscriptions.get(b.id);
if(d)return b={...b,remove:null!=(h=b.remove)?h:[],status:null!=(l=b.status)?l:m.UpdateToken.empty()},x.ignoreAbortErrors(this._onTileUpdateMessage(b,d.options))});return function(b){return a.apply(this,arguments)}}();c.update=function(a,b){var h,l=b.fields.length;b.outFields=p(null==(h=this._schema)?void 0:h.outFields,b.outFields);b.outFields=b.outFields.length>=.75*l?["*"]:b.outFields;b.outFields.sort();if(h=f.diff(this._schema,b)){v("esri-2d-update-debug")&&console.debug("Applying Update - Source:",
h);l="orderByFields"in this._serviceInfo&&this._serviceInfo.orderByFields?this._serviceInfo.orderByFields:this._serviceInfo.objectIdField+" ASC";l={returnCentroid:v("esri-2d-query-centroid-enabled")&&"esriGeometryPolygon"===this._serviceInfo.geometryType,returnGeometry:!0,timeReferenceUnknownClient:"stream"!==this._serviceInfo.type&&this._serviceInfo.timeReferenceUnknownClient,outFields:b.outFields,outSpatialReference:this._outSR,orderByFields:[l],where:b.definitionExpression||"1\x3d1",gdbVersion:b.gdbVersion,
historicMoment:b.historicMoment,timeExtent:E.fromJSON(b.timeExtent)};var d=this._schema&&f.hasDiff(h,"outFields");this._schema&&f.hasDiffAny(h,["timeExtent","definitionExpression","gdbVersion","historicMoment","customParameters"])&&(a.why.mesh.push("Layer filter and/or custom parameters changed"),a.why.source.push("Layer filter and/or custom parameters changed"),a.mesh=!0,a.source=!0,a.queryFilter=!0);d&&(a.why.source.push("Layer required fields changed"),a.source=!0);f.diff(l,this._queryInfo)&&(this._queryInfo=
l);this._schema=b;this._resolver.resolve()}};c.whenInitialized=function(){return this._resolver.promise};c.applyUpdate=function(){var a=u._asyncToGenerator(function*(b){b.queryFilter||b.source&&this._didEdit?(this.refresh(b.version),this._didEdit=!1):(this._subscriptions.forEach(h=>h.applyUpdate(b)),yield this.resend())});return function(b){return a.apply(this,arguments)}}();c.refresh=function(a){for(const b of this._tiles())this.unsubscribe(b),this.subscribe(b,a)};c.subscribe=function(a,b){b=new g.DataTileSubscription(a,
b);this._subscriptions.set(a.id,b)};c.unsubscribe=function(a){const b=this.get(a.id);z.isSome(b)&&b.abort();this._subscriptions.delete(a.id)};c.createQuery=function(a={}){return new k({...this._queryInfo,historicMoment:this._queryInfo.historicMoment?new Date(this._queryInfo.historicMoment):null,...a})};c.get=function(a){return this._subscriptions.has(a)?this._subscriptions.get(a):null};c.queryLastEditDate=function(){var a=u._asyncToGenerator(function*(){throw Error("Service does not support query type");
});return function(){return a.apply(this,arguments)}}();c.query=function(){var a=u._asyncToGenerator(function*(b){throw Error("Service does not support query");});return function(b){return a.apply(this,arguments)}}();c._tiles=function*(){const a=Array.from(this._subscriptions.values());for(const b of a)yield b.tile};c.edit=function(){var a=u._asyncToGenerator(function*(b,h){var l=this,d=Array.from(this._subscriptions.values());const q=d.map(({tile:n})=>n);for(const n of d)n.removeIds(h);b.length&&
(d=q.map(n=>{const B=this.createTileQuery(n);B.objectIds=b;return{tile:n,query:B}}).map(function(){var n=u._asyncToGenerator(function*({tile:B,query:A}){return{tile:B,result:yield l.query(A),query:A}});return function(B){return n.apply(this,arguments)}}()),d=(yield x.eachAlwaysValues(d)).map(function(){var n=u._asyncToGenerator(function*({tile:B,result:A}){(A.hasFeatures||h.length||b.length)&&(B=l._subscriptions.get(B.key.id))&&B.edit(A,b)});return function(B){return n.apply(this,arguments)}}()),
yield x.eachAlways(d));this._didEdit=!0});return function(b,h){return a.apply(this,arguments)}}();return e}();r.DataTileSource=t;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/TimeExtent":function(){define("./chunks/_rollupPluginBabelHelpers ./chunks/tslib.es6 ./core/JSONSupport ./core/maybe ./core/timeUtils ./core/accessorSupport/decorators/property ./core/arrayUtils ./core/has ./core/accessorSupport/ensureType ./core/accessorSupport/decorators/reader ./core/accessorSupport/decorators/subclass ./core/accessorSupport/decorators/writer".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p){var t;E=t=function(a){function b(l){l=a.call(this,l)||this;l.end=null;l.start=null;return l}r._inheritsLoose(b,a);var h=b.prototype;h.readEnd=function(l,d){return null!=d.end?new Date(d.end):null};h.writeEnd=function(l,d){d.end=l?l.getTime():null};h.readStart=function(l,d){return null!=d.start?new Date(d.start):null};h.writeStart=function(l,d){d.start=l?l.getTime():null};h.clone=function(){return new t({end:this.end,start:this.start})};h.equals=function(l){if(!l)return!1;
const d=C.isSome(this.start)?this.start.getTime():this.start,q=C.isSome(this.end)?this.end.getTime():this.end,n=C.isSome(l.start)?l.start.getTime():l.start;l=C.isSome(l.end)?l.end.getTime():l.end;return d===n&&q===l};h.expandTo=function(l){if(this.isEmpty||this.isAllTime)return this.clone();const d=C.applySome(this.start,n=>v.truncateDate(n,l)),q=C.applySome(this.end,n=>v.offsetDate(v.truncateDate(n,l),1,l));return new t({start:d,end:q})};h.intersection=function(l){if(!l)return this.clone();if(this.isEmpty||
l.isEmpty)return t.empty;if(this.isAllTime)return l.clone();if(l.isAllTime)return this.clone();var d=C.mapOr(this.start,-Infinity,w=>w.getTime());const q=C.mapOr(this.end,Infinity,w=>w.getTime()),n=C.mapOr(l.start,-Infinity,w=>w.getTime());l=C.mapOr(l.end,Infinity,w=>w.getTime());let B,A;n>=d&&n<=q?B=n:d>=n&&d<=l&&(B=d);q>=n&&q<=l?A=q:l>=d&&l<=q&&(A=l);return isNaN(B)||isNaN(A)?t.empty:(d=new t,d.start=-Infinity===B?null:new Date(B),d.end=Infinity===A?null:new Date(A),d)};h.offset=function(l,d){if(this.isEmpty||
this.isAllTime)return this.clone();const q=new t,{start:n,end:B}=this;C.isSome(n)&&(q.start=v.offsetDate(n,l,d));C.isSome(B)&&(q.end=v.offsetDate(B,l,d));return q};h.union=function(l){if(!l||l.isEmpty)return this.clone();if(this.isEmpty)return l.clone();if(this.isAllTime||l.isAllTime)return e.clone();const d=C.isSome(this.start)&&C.isSome(l.start)?new Date(Math.min(this.start.getTime(),l.start.getTime())):null;l=C.isSome(this.end)&&C.isSome(l.end)?new Date(Math.max(this.end.getTime(),l.end.getTime())):
null;return new t({start:d,end:l})};r._createClass(b,[{key:"isAllTime",get:function(){return this.equals(t.allTime)}},{key:"isEmpty",get:function(){return this.equals(t.empty)}}],[{key:"allTime",get:function(){return e}},{key:"empty",get:function(){return c}}]);return b}(E.JSONSupport);u.__decorate([z.property({type:Date,json:{write:{allowNull:!0}}})],E.prototype,"end",void 0);u.__decorate([g.reader("end")],E.prototype,"readEnd",null);u.__decorate([p.writer("end")],E.prototype,"writeEnd",null);u.__decorate([z.property({readOnly:!0,
json:{read:!1}})],E.prototype,"isAllTime",null);u.__decorate([z.property({readOnly:!0,json:{read:!1}})],E.prototype,"isEmpty",null);u.__decorate([z.property({type:Date,json:{write:{allowNull:!0}}})],E.prototype,"start",void 0);u.__decorate([g.reader("start")],E.prototype,"readStart",null);u.__decorate([p.writer("start")],E.prototype,"writeStart",null);E=t=u.__decorate([m.subclass("esri.TimeExtent")],E);const e=new E,c=new E({start:void 0,end:void 0});return E})},"esri/core/timeUtils":function(){define(["exports",
"./has"],function(r,u){function E(z,x,f){return 0===z?0:z*C[x]/C[f]}const C={milliseconds:1,seconds:1E3,minutes:6E4,hours:36E5,days:864E5,weeks:6048E5,months:26784E5,years:31536E6,decades:31536E7,centuries:31536E8},v={milliseconds:{getter:"getMilliseconds",setter:"setMilliseconds",multiplier:1},seconds:{getter:"getSeconds",setter:"setSeconds",multiplier:1},minutes:{getter:"getMinutes",setter:"setMinutes",multiplier:1},hours:{getter:"getHours",setter:"setHours",multiplier:1},days:{getter:"getDate",
setter:"setDate",multiplier:1},weeks:{getter:"getDate",setter:"setDate",multiplier:7},months:{getter:"getMonth",setter:"setMonth",multiplier:1},years:{getter:"getFullYear",setter:"setFullYear",multiplier:1},decades:{getter:"getFullYear",setter:"setFullYear",multiplier:10},centuries:{getter:"getFullYear",setter:"setFullYear",multiplier:100}};r.convertTime=E;r.makeUTCTime=function(z,x,f="milliseconds"){x=new Date(E(x,f,"milliseconds"));x.setUTCFullYear(z.getUTCFullYear(),z.getUTCMonth(),z.getUTCDate());
return x};r.offsetDate=function(z,x,f){z=new Date(z.getTime());if(x&&f){const {getter:g,setter:m,multiplier:p}=v[f];if("months"===f){f=z.getFullYear();var k=z.getMonth()+x;f=new Date(f,k+1,1);f.setDate(0);f=f.getDate();z.getDate()>f&&z.setDate(f)}z[m](z[g]()+x*p)}return z};r.offsetDateUTC=function(z,x,f="milliseconds"){z=z.getTime();x=E(x,f,"milliseconds");return new Date(z+x)};r.resetUTCDate=function(z,x){z=new Date(z.getTime());z.setUTCFullYear(x.getFullYear(),x.getMonth(),x.getDate());return z};
r.timeSinceUTCMidnight=function(z,x="milliseconds"){const f=E(z.getUTCHours(),"hours","milliseconds"),k=E(z.getUTCMinutes(),"minutes","milliseconds"),g=E(z.getUTCSeconds(),"seconds","milliseconds");z=z.getUTCMilliseconds();return E(f+k+g+z,"milliseconds",x)};r.truncateDate=function(z,x){switch(x){case "milliseconds":return new Date(z.getTime());case "seconds":return new Date(z.getFullYear(),z.getMonth(),z.getDate(),z.getHours(),z.getMinutes(),z.getSeconds());case "minutes":return new Date(z.getFullYear(),
z.getMonth(),z.getDate(),z.getHours(),z.getMinutes());case "hours":return new Date(z.getFullYear(),z.getMonth(),z.getDate(),z.getHours());case "days":return new Date(z.getFullYear(),z.getMonth(),z.getDate());case "weeks":return new Date(z.getFullYear(),z.getMonth(),z.getDate()-z.getDay());case "months":return new Date(z.getFullYear(),z.getMonth(),1);case "years":return new Date(z.getFullYear(),0,1);case "decades":return new Date(z.getFullYear()-z.getFullYear()%10,0,1);case "centuries":return new Date(z.getFullYear()-
z.getFullYear()%100,0,1);default:return new Date}};r.truncateLocalTime=function(z){const x=new Date(0);x.setHours(0);x.setMinutes(0);x.setSeconds(0);x.setMilliseconds(0);x.setFullYear(z.getUTCFullYear(),z.getUTCMonth(),z.getUTCDate());return x};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/support/Query":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../TimeExtent ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../core/accessorSupport/ensureType ../../geometry/support/jsonUtils ../../layers/support/source/DataLayerSource ./QuantizationParameters ./StatisticDefinition ../../geometry/SpatialReference ../../geometry/Point".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t,e,c,a,b,h,l,d){var q;const n=new v.JSONMap({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"});v=new v.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",
esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});z=q=function(B){function A(y){y=B.call(this,y)||this;y.aggregateIds=null;y.cacheHint=void 0;y.compactGeometryEnabled=!1;y.datumTransformation=null;y.defaultSpatialReferenceEnabled=!1;y.distance=void 0;y.dynamicDataSource=void 0;y.formatOf3DObjects=null;y.gdbVersion=null;y.geometry=null;y.geometryPrecision=void 0;y.groupByFieldsForStatistics=null;y.having=null;
y.historicMoment=null;y.maxAllowableOffset=void 0;y.maxRecordCountFactor=1;y.multipatchOption=null;y.num=void 0;y.objectIds=null;y.orderByFields=null;y.outFields=null;y.outSpatialReference=null;y.outStatistics=null;y.parameterValues=null;y.pixelSize=null;y.quantizationParameters=null;y.rangeValues=null;y.relationParameter=null;y.resultType=null;y.returnCentroid=!1;y.returnDistinctValues=!1;y.returnExceededLimitFeatures=!0;y.returnGeometry=!1;y.returnQueryGeometry=!1;y.returnM=void 0;y.returnZ=void 0;
y.sourceSpatialReference=null;y.spatialRelationship="intersects";y.start=void 0;y.sqlFormat=null;y.text=null;y.timeExtent=null;y.timeReferenceUnknownClient=!1;y.units=null;y.where=null;return y}r._inheritsLoose(A,B);A.from=function(y){return e.ensureClass(q,y)};var w=A.prototype;w.castDatumTransformation=function(y){return"number"===typeof y||"object"===typeof y?y:null};w.writeHistoricMoment=function(y,D){D.historicMoment=y&&y.getTime()};w.writeParameterValues=function(y,D){if(y){const F={};for(const G in y){const K=
y[G];Array.isArray(K)?F[G]=K.map(J=>J instanceof Date?J.getTime():J):F[G]=K instanceof Date?K.getTime():K}D.parameterValues=F}};w.writeStart=function(y,D){D.resultOffset=this.start;D.resultRecordCount=this.num||10;D.where="1\x3d1"};w.writeWhere=function(y,D){D.where=y||"1\x3d1"};w.clone=function(){return new q(x.clone({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,
distance:this.distance,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:f.isSome(this.historicMoment)?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,
outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,
returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))};return A}(z.JSONSupport);z.MAX_MAX_RECORD_COUNT_FACTOR=5;u.__decorate([k.property({json:{write:!0}})],z.prototype,"aggregateIds",void 0);u.__decorate([k.property({type:Boolean,
json:{write:!0}})],z.prototype,"cacheHint",void 0);u.__decorate([k.property({type:Boolean,json:{default:!1,write:!0}})],z.prototype,"compactGeometryEnabled",void 0);u.__decorate([k.property({json:{write:!0}})],z.prototype,"datumTransformation",void 0);u.__decorate([g.cast("datumTransformation")],z.prototype,"castDatumTransformation",null);u.__decorate([k.property({type:Boolean,json:{default:!1,write:!0}})],z.prototype,"defaultSpatialReferenceEnabled",void 0);u.__decorate([k.property({type:Number,
json:{write:{overridePolicy(B){return{enabled:0<B}}}}})],z.prototype,"distance",void 0);u.__decorate([k.property({type:a.DataLayerSource,json:{write:!0}})],z.prototype,"dynamicDataSource",void 0);u.__decorate([k.property({type:String,json:{write:!0}})],z.prototype,"formatOf3DObjects",void 0);u.__decorate([k.property({type:String,json:{write:!0}})],z.prototype,"gdbVersion",void 0);u.__decorate([k.property({types:E.geometryTypes,json:{read:c.fromJSON,write:!0}})],z.prototype,"geometry",void 0);u.__decorate([k.property({type:Number,
json:{write:!0}})],z.prototype,"geometryPrecision",void 0);u.__decorate([k.property({type:[String],json:{write:!0}})],z.prototype,"groupByFieldsForStatistics",void 0);u.__decorate([k.property({type:String,json:{write:!0}})],z.prototype,"having",void 0);u.__decorate([k.property({type:Date})],z.prototype,"historicMoment",void 0);u.__decorate([t.writer("historicMoment")],z.prototype,"writeHistoricMoment",null);u.__decorate([k.property({type:Number,json:{write:!0}})],z.prototype,"maxAllowableOffset",
void 0);u.__decorate([k.property({type:Number,cast(B){return 1>B?1:B>q.MAX_MAX_RECORD_COUNT_FACTOR?q.MAX_MAX_RECORD_COUNT_FACTOR:B},json:{write:{overridePolicy(B){return{enabled:1<B}}}}})],z.prototype,"maxRecordCountFactor",void 0);u.__decorate([k.property({type:["xyFootprint"],json:{write:!0}})],z.prototype,"multipatchOption",void 0);u.__decorate([k.property({type:Number,json:{read:{source:"resultRecordCount"}}})],z.prototype,"num",void 0);u.__decorate([k.property({json:{write:!0}})],z.prototype,
"objectIds",void 0);u.__decorate([k.property({type:[String],json:{write:!0}})],z.prototype,"orderByFields",void 0);u.__decorate([k.property({type:[String],json:{write:!0}})],z.prototype,"outFields",void 0);u.__decorate([k.property({type:l,json:{name:"outSR",write:!0}})],z.prototype,"outSpatialReference",void 0);u.__decorate([k.property({type:[h],json:{write:{enabled:!0,overridePolicy(){return{enabled:f.isSome(this.outStatistics)&&0<this.outStatistics.length}}}}})],z.prototype,"outStatistics",void 0);
u.__decorate([k.property({json:{write:!0}})],z.prototype,"parameterValues",void 0);u.__decorate([t.writer("parameterValues")],z.prototype,"writeParameterValues",null);u.__decorate([k.property({type:d,json:{write:!0}})],z.prototype,"pixelSize",void 0);u.__decorate([k.property({type:b,json:{write:!0}})],z.prototype,"quantizationParameters",void 0);u.__decorate([k.property({type:[Object],json:{write:!0}})],z.prototype,"rangeValues",void 0);u.__decorate([k.property({type:String,json:{read:{source:"relationParam"},
write:{target:"relationParam",overridePolicy(){return{enabled:"relation"===this.spatialRelationship}}}}})],z.prototype,"relationParameter",void 0);u.__decorate([k.property({type:String,json:{write:!0}})],z.prototype,"resultType",void 0);u.__decorate([k.property({type:Boolean,json:{default:!1,write:!0}})],z.prototype,"returnCentroid",void 0);u.__decorate([k.property({type:Boolean,json:{default:!1,write:!0}})],z.prototype,"returnDistinctValues",void 0);u.__decorate([k.property({type:Boolean,json:{default:!0,
write:!0}})],z.prototype,"returnExceededLimitFeatures",void 0);u.__decorate([k.property({type:Boolean,json:{write:!0}})],z.prototype,"returnGeometry",void 0);u.__decorate([k.property({type:Boolean,json:{default:!1,write:!0}})],z.prototype,"returnQueryGeometry",void 0);u.__decorate([k.property({type:Boolean,json:{default:!1,write:!0}})],z.prototype,"returnM",void 0);u.__decorate([k.property({type:Boolean,json:{write:{overridePolicy(B){return{enabled:B}}}}})],z.prototype,"returnZ",void 0);u.__decorate([k.property({type:l,
json:{write:!0}})],z.prototype,"sourceSpatialReference",void 0);u.__decorate([m.enumeration(n,{ignoreUnknown:!1,name:"spatialRel"})],z.prototype,"spatialRelationship",void 0);u.__decorate([k.property({type:Number,json:{read:{source:"resultOffset"}}})],z.prototype,"start",void 0);u.__decorate([t.writer("start"),t.writer("num")],z.prototype,"writeStart",null);u.__decorate([k.property({type:String,json:{write:!0}})],z.prototype,"sqlFormat",void 0);u.__decorate([k.property({type:String,json:{write:!0}})],
z.prototype,"text",void 0);u.__decorate([k.property({type:C,json:{write:!0}})],z.prototype,"timeExtent",void 0);u.__decorate([k.property({type:Boolean,json:{default:!1,write:!0}})],z.prototype,"timeReferenceUnknownClient",void 0);u.__decorate([m.enumeration(v,{ignoreUnknown:!1}),k.property({json:{write:{overridePolicy(B){return{enabled:B&&0<this.distance}}}}})],z.prototype,"units",void 0);u.__decorate([k.property({type:String,json:{write:{overridePolicy(B){return{enabled:null!=B||0<this.start}}}}})],
z.prototype,"where",void 0);u.__decorate([t.writer("where")],z.prototype,"writeWhere",null);return z=q=u.__decorate([p.subclass("esri.rest.support.Query")],z)})},"esri/layers/support/source/DataLayerSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/cast ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/extensions/serializableProperty/reader ../Field ./MapLayerSource ./QueryTableDataSource ./RasterDataSource ./TableDataSource".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t,e,c,a,b,h,l){function d(){A||(A=e.createTypeReader({types:q()}));return A}function q(){w||(w={key:"type",base:null,typeMap:{"data-layer":r.DataLayerSource,"map-layer":a.MapLayerSource}});return w}var n,B;C=C.strict()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});r.JoinTableDataSource=n=function(y){function D(G){G=y.call(this,G)||this;G.type="join-table";return G}u._inheritsLoose(D,y);var F=D.prototype;F.readLeftTableSource=function(G,
K,J){return d()(G,K,J)};F.castLeftTableSource=function(G){return t.ensureOneOfType(q(),G)};F.readRightTableSource=function(G,K,J){return d()(G,K,J)};F.castRightTableSource=function(G){return t.ensureOneOfType(q(),G)};F.clone=function(){var G,K;const {leftTableKey:J,rightTableKey:I,leftTableSource:H,rightTableSource:M,joinType:N}=this,P={leftTableKey:J,rightTableKey:I,leftTableSource:null!=(G=null==H?void 0:H.clone())?G:void 0,rightTableSource:null!=(K=null==M?void 0:M.clone())?K:void 0,joinType:N};
return new n(P)};return D}(v.JSONSupport);E.__decorate([g.enumeration({joinTable:"join-table"})],r.JoinTableDataSource.prototype,"type",void 0);E.__decorate([z.property({type:String,json:{write:!0}})],r.JoinTableDataSource.prototype,"leftTableKey",void 0);E.__decorate([z.property({type:String,json:{write:!0}})],r.JoinTableDataSource.prototype,"rightTableKey",void 0);E.__decorate([z.property({json:{write:!0}})],r.JoinTableDataSource.prototype,"leftTableSource",void 0);E.__decorate([m.reader("leftTableSource")],
r.JoinTableDataSource.prototype,"readLeftTableSource",null);E.__decorate([k.cast("leftTableSource")],r.JoinTableDataSource.prototype,"castLeftTableSource",null);E.__decorate([z.property({json:{write:!0}})],r.JoinTableDataSource.prototype,"rightTableSource",void 0);E.__decorate([m.reader("rightTableSource")],r.JoinTableDataSource.prototype,"readRightTableSource",null);E.__decorate([k.cast("rightTableSource")],r.JoinTableDataSource.prototype,"castRightTableSource",null);E.__decorate([g.enumeration(C)],
r.JoinTableDataSource.prototype,"joinType",void 0);r.JoinTableDataSource=n=E.__decorate([p.subclass("esri.layers.support.source.JoinTableDataSource")],r.JoinTableDataSource);let A=null,w=null;k={key:"type",base:null,typeMap:{"join-table":r.JoinTableDataSource,"query-table":b.QueryTableDataSource,raster:h.RasterDataSource,table:l.TableDataSource}};r.DataLayerSource=B=function(y){function D(F){F=y.call(this,F)||this;F.type="data-layer";return F}u._inheritsLoose(D,y);D.prototype.clone=function(){const {fields:F,
dataSource:G}=this;return new B({fields:F,dataSource:G})};return D}(v.JSONSupport);E.__decorate([g.enumeration({dataLayer:"data-layer"})],r.DataLayerSource.prototype,"type",void 0);E.__decorate([z.property({type:[c],json:{write:!0}})],r.DataLayerSource.prototype,"fields",void 0);E.__decorate([z.property({types:k,json:{write:!0}})],r.DataLayerSource.prototype,"dataSource",void 0);r.DataLayerSource=B=E.__decorate([p.subclass("esri.layers.support.source.DataLayerSource")],r.DataLayerSource);r.DataLayerSource.from=
t.ensureType(r.DataLayerSource);Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/Field":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ./domains ./fieldType".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t){var e;const c=new E.JSONMap({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});E=e=function(a){function b(l){l=a.call(this,l)||this;
l.alias=null;l.defaultValue=void 0;l.description=null;l.domain=null;l.editable=!0;l.length=-1;l.name=null;l.nullable=!0;l.type=null;l.valueType=null;return l}r._inheritsLoose(b,a);var h=b.prototype;h.readDescription=function(l,{description:d}){let q;try{q=JSON.parse(d)}catch(n){}return q?q.value:null};h.readValueType=function(l,{description:d}){let q;try{q=JSON.parse(d)}catch(n){}return q?c.fromJSON(q.fieldValueType):null};h.clone=function(){return new e({alias:this.alias,defaultValue:this.defaultValue,
description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType})};return b}(C.JSONSupport);u.__decorate([v.property({type:String,json:{write:!0}})],E.prototype,"alias",void 0);u.__decorate([v.property({type:[String,Number],json:{write:{allowNull:!0}}})],E.prototype,"defaultValue",void 0);u.__decorate([v.property()],E.prototype,"description",void 0);u.__decorate([g.reader("description")],
E.prototype,"readDescription",null);u.__decorate([v.property({types:p.types,json:{read:{reader:p.fromJSON},write:!0}})],E.prototype,"domain",void 0);u.__decorate([v.property({type:Boolean,json:{write:!0}})],E.prototype,"editable",void 0);u.__decorate([v.property({type:f.Integer,json:{write:!0}})],E.prototype,"length",void 0);u.__decorate([v.property({type:String,json:{write:!0}})],E.prototype,"name",void 0);u.__decorate([v.property({type:Boolean,json:{write:!0}})],E.prototype,"nullable",void 0);u.__decorate([k.enumeration(t.kebabDict)],
E.prototype,"type",void 0);u.__decorate([v.property()],E.prototype,"valueType",void 0);u.__decorate([g.reader("valueType",["description"])],E.prototype,"readValueType",null);return E=e=u.__decorate([m.subclass("esri.layers.support.Field")],E)})},"esri/layers/support/domains":function(){define("exports ../../core/has ./CodedValueDomain ./Domain ./InheritedDomain ./RangeDomain".split(" "),function(r,u,E,C,v,z){u={key:"type",base:C,typeMap:{range:z,"coded-value":E,inherited:v}};r.CodedValueDomain=E;
r.DomainBase=C;r.InheritedDomain=v;r.RangeDomain=z;r.fromJSON=function(x){if(!x||!x.type)return null;switch(x.type){case "range":return z.fromJSON(x);case "codedValue":return E.fromJSON(x);case "inherited":return v.fromJSON(x)}return null};r.types=u;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/CodedValueDomain":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./CodedValue ./Domain".split(" "),
function(r,u,E,C,v,z,x,f,k){var g;v=g=function(m){function p(e){e=m.call(this,e)||this;e.codedValues=null;e.type="coded-value";return e}r._inheritsLoose(p,m);var t=p.prototype;t.getName=function(e){let c=null;if(this.codedValues){const a=String(e);this.codedValues.some(b=>{String(b.code)===a&&(c=b.name);return!!c})}return c};t.clone=function(){return new g({codedValues:E.clone(this.codedValues),name:this.name})};return p}(k);u.__decorate([C.property({type:[f.CodedValue],json:{write:!0}})],v.prototype,
"codedValues",void 0);u.__decorate([z.enumeration({codedValue:"coded-value"})],v.prototype,"type",void 0);return v=g=u.__decorate([x.subclass("esri.layers.support.CodedValueDomain")],v)})},"esri/layers/support/CodedValue":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(r,u,E,C,v,z,x,f,k){var g;r.CodedValue=g=function(m){function p(t){t=m.call(this,t)||this;t.name=null;t.code=null;return t}u._inheritsLoose(p,m);p.prototype.clone=function(){return new g({name:this.name,code:this.code})};return p}(C.JSONSupport);E.__decorate([v.property({type:String,json:{write:!0}})],r.CodedValue.prototype,"name",void 0);E.__decorate([v.property({type:[String,Number],json:{write:!0}})],r.CodedValue.prototype,"code",void 0);r.CodedValue=g=E.__decorate([k.subclass("esri.layers.support.CodedValue")],
r.CodedValue);Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/Domain":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),function(r,u,
E,C,v,z,x,f,k,g){E=new E.JSONMap({inherited:"inherited",codedValue:"coded-value",range:"range"});C=function(m){function p(t){t=m.call(this,t)||this;t.name=null;t.type=null;return t}r._inheritsLoose(p,m);return p}(C.JSONSupport);u.__decorate([v.property({type:String,json:{write:!0}})],C.prototype,"name",void 0);u.__decorate([k.enumeration(E)],C.prototype,"type",void 0);return C=u.__decorate([g.subclass("esri.layers.support.Domain")],C)})},"esri/layers/support/InheritedDomain":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Logger ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/set ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./Domain".split(" "),
function(r,u,E,C,v,z,x,f,k,g){var m;E=m=function(p){function t(e){e=p.call(this,e)||this;e.type="inherited";return e}r._inheritsLoose(t,p);t.prototype.clone=function(){return new m};return t}(g);u.__decorate([f.enumeration({inherited:"inherited"})],E.prototype,"type",void 0);return E=m=u.__decorate([k.subclass("esri.layers.support.InheritedDomain")],E)})},"esri/layers/support/RangeDomain":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./Domain".split(" "),
function(r,u,E,C,v,z,x,f,k){var g;C=g=function(m){function p(t){t=m.call(this,t)||this;t.maxValue=null;t.minValue=null;t.type="range";return t}r._inheritsLoose(p,m);p.prototype.clone=function(){return new g({maxValue:this.maxValue,minValue:this.minValue,name:this.name})};return p}(k);u.__decorate([E.property({type:Number,json:{type:[Number],read:{source:"range",reader(m,p){return p.range&&p.range[1]}},write:{enabled:!1,overridePolicy(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",
writer(m,p,t){p[t]=[this.minValue||0,m]}}}})],C.prototype,"maxValue",void 0);u.__decorate([E.property({type:Number,json:{type:[Number],read:{source:"range",reader(m,p){return p.range&&p.range[0]}},write:{target:"range",writer(m,p,t){p[t]=[m,this.maxValue||0]}}}})],C.prototype,"minValue",void 0);u.__decorate([x.enumeration({range:"range"})],C.prototype,"type",void 0);return C=g=u.__decorate([f.subclass("esri.layers.support.RangeDomain")],C)})},"esri/layers/support/source/MapLayerSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),
function(r,u,E,C,v,z,x,f,k,g){var m;r.MapLayerSource=m=function(p){function t(e){e=p.call(this,e)||this;e.type="map-layer";return e}u._inheritsLoose(t,p);t.prototype.clone=function(){const {mapLayerId:e,gdbVersion:c}=this;return new m({mapLayerId:e,gdbVersion:c})};return t}(C.JSONSupport);E.__decorate([k.enumeration({mapLayer:"map-layer"})],r.MapLayerSource.prototype,"type",void 0);E.__decorate([v.property({type:f.Integer,json:{write:!0}})],r.MapLayerSource.prototype,"mapLayerId",void 0);E.__decorate([v.property({type:String,
json:{write:!0}})],r.MapLayerSource.prototype,"gdbVersion",void 0);r.MapLayerSource=m=E.__decorate([g.subclass("esri.layers.support.source.MapLayerSource")],r.MapLayerSource);Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/source/QueryTableDataSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ../../../geometry/SpatialReference ../../../geometry/support/typeUtils".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t){var e;r.QueryTableDataSource=e=function(c){function a(b){b=c.call(this,b)||this;b.type="query-table";return b}u._inheritsLoose(a,c);a.prototype.clone=function(){var b;const {workspaceId:h,query:l,oidFields:d,spatialReference:q,geometryType:n}=this,B={workspaceId:h,query:l,oidFields:d,spatialReference:null!=(b=null==q?void 0:q.clone())?b:void 0,geometryType:n};return new e(B)};return a}(v.JSONSupport);E.__decorate([g.enumeration({queryTable:"query-table"})],r.QueryTableDataSource.prototype,
"type",void 0);E.__decorate([z.property({type:String,json:{write:!0}})],r.QueryTableDataSource.prototype,"workspaceId",void 0);E.__decorate([z.property({type:String,json:{write:!0}})],r.QueryTableDataSource.prototype,"query",void 0);E.__decorate([z.property({type:String,json:{write:!0}})],r.QueryTableDataSource.prototype,"oidFields",void 0);E.__decorate([z.property({type:p,json:{write:!0}})],r.QueryTableDataSource.prototype,"spatialReference",void 0);E.__decorate([g.enumeration(t.featureGeometryTypeKebabDictionary)],
r.QueryTableDataSource.prototype,"geometryType",void 0);r.QueryTableDataSource=e=E.__decorate([m.subclass("esri.layers.support.source.QueryTableDataSource")],r.QueryTableDataSource);Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/source/RasterDataSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),
function(r,u,E,C,v,z,x,f,k,g){var m;r.RasterDataSource=m=function(p){function t(e){e=p.call(this,e)||this;e.type="raster";return e}u._inheritsLoose(t,p);t.prototype.clone=function(){const {workspaceId:e,dataSourceName:c}=this;return new m({workspaceId:e,dataSourceName:c})};return t}(C.JSONSupport);E.__decorate([k.enumeration({raster:"raster"})],r.RasterDataSource.prototype,"type",void 0);E.__decorate([v.property({type:String,json:{write:!0}})],r.RasterDataSource.prototype,"dataSourceName",void 0);
E.__decorate([v.property({type:String,json:{write:!0}})],r.RasterDataSource.prototype,"workspaceId",void 0);r.RasterDataSource=m=E.__decorate([g.subclass("esri.layers.support.source.RasterDataSource")],r.RasterDataSource);Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/source/TableDataSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),
function(r,u,E,C,v,z,x,f,k,g){var m;r.TableDataSource=m=function(p){function t(e){e=p.call(this,e)||this;e.type="table";return e}u._inheritsLoose(t,p);t.prototype.clone=function(){const {workspaceId:e,gdbVersion:c,dataSourceName:a}=this;return new m({workspaceId:e,gdbVersion:c,dataSourceName:a})};return t}(C.JSONSupport);E.__decorate([k.enumeration({table:"table"})],r.TableDataSource.prototype,"type",void 0);E.__decorate([v.property({type:String,json:{write:!0}})],r.TableDataSource.prototype,"workspaceId",
void 0);E.__decorate([v.property({type:String,json:{write:!0}})],r.TableDataSource.prototype,"gdbVersion",void 0);E.__decorate([v.property({type:String,json:{write:!0}})],r.TableDataSource.prototype,"dataSourceName",void 0);r.TableDataSource=m=E.__decorate([g.subclass("esri.layers.support.source.TableDataSource")],r.TableDataSource);Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/support/QuantizationParameters":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/Extent".split(" "),
function(r,u,E,C,v,z,x,f,k,g){var m;E=new C.JSONMap({upperLeft:"upper-left",lowerLeft:"lower-left"});v=m=function(p){function t(e){e=p.call(this,e)||this;e.extent=null;e.mode="view";e.originPosition="upper-left";e.tolerance=1;return e}r._inheritsLoose(t,p);t.prototype.clone=function(){return new m(z.clone({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))};return t}(v.JSONSupport);u.__decorate([x.property({type:g,json:{write:{overridePolicy(){return{enabled:"view"===
this.mode}}}}})],v.prototype,"extent",void 0);u.__decorate([x.property({type:["view","edit"],json:{write:!0}})],v.prototype,"mode",void 0);u.__decorate([x.property({type:String,json:{read:E.read,write:E.write}})],v.prototype,"originPosition",void 0);u.__decorate([x.property({type:Number,json:{write:{overridePolicy(){return{enabled:"view"===this.mode}}}}})],v.prototype,"tolerance",void 0);return v=m=u.__decorate([k.subclass("esri.rest.support.QuantizationParameters")],v)})},"esri/rest/support/StatisticDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer".split(" "),
function(r,u,E,C,v,z,x,f,k){var g;E=new E.JSONMap({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});C=g=function(m){function p(e){e=m.call(this,e)||this;e.maxPointCount=void 0;e.maxRecordCount=void 0;e.maxVertexCount=void 0;e.onStatisticField=
null;e.outStatisticFieldName=null;e.statisticType=null;e.statisticParameters=null;return e}r._inheritsLoose(p,m);var t=p.prototype;t.writeStatisticParameters=function(e,c){if("percentile-continuous"===this.statisticType||"percentile-discrete"===this.statisticType)c.statisticParameters=v.clone(e)};t.clone=function(){return new g({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,
statisticType:this.statisticType,statisticParameters:v.clone(this.statisticParameters)})};return p}(C.JSONSupport);u.__decorate([z.property({type:Number,json:{write:!0}})],C.prototype,"maxPointCount",void 0);u.__decorate([z.property({type:Number,json:{write:!0}})],C.prototype,"maxRecordCount",void 0);u.__decorate([z.property({type:Number,json:{write:!0}})],C.prototype,"maxVertexCount",void 0);u.__decorate([z.property({type:String,json:{write:!0}})],C.prototype,"onStatisticField",void 0);u.__decorate([z.property({type:String,
json:{write:!0}})],C.prototype,"outStatisticFieldName",void 0);u.__decorate([z.property({type:String,json:{read:{source:"statisticType",reader:E.read},write:{target:"statisticType",writer:E.write}}})],C.prototype,"statisticType",void 0);u.__decorate([z.property({type:Object})],C.prototype,"statisticParameters",void 0);u.__decorate([k.writer("statisticParameters")],C.prototype,"writeStatisticParameters",null);return C=g=u.__decorate([f.subclass("esri.rest.support.StatisticDefinition")],C)})},"esri/views/2d/layers/features/sources/DataTileSubscription":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/CircularArray ../../../../../core/has ../../../../../core/maybe ../support/FeatureSetReaderJSON ../support/UpdateToken".split(" "),
function(r,u,E,C,v,z,x){let f=function(){function k(m,p){this.requests={done:[],stream:new E(10)};this._edits=null;this._abortController=new AbortController;this._version=0;this.didSend=this._done=!1;this.tile=m;this._version=p}var g=k.prototype;g.end=function(){this._done=!0};g.clear=function(){this.requests.done=[]};g.applyUpdate=function(m){this.requests.done.forEach(p=>p.message.status.unset(m));this._version=m.version;v.isSome(this._edits)&&this._edits.status.unset(m)};g.add=function(m){var p;
m.message.status=null!=(p=m.message.status)?p:x.UpdateToken.empty();m.message.status.version=this._version;C("esri-2d-update-debug")&&console.debug(this.tile.id,"DataTileSubscription:add",this._version);m.message.end&&this.requests.done.forEach(t=>{v.isSome(t.message)&&t.message.end&&(t.message.end=!1)});this.requests.done.push(m)};g.edit=function(m,p){const t=m.getQuantizationTransform(),e=m.fullSchema(),c=Array.from(m.features()),a=c.map(b=>b.objectId);p=[...p,...a];this.removeIds(p);this._invalidate();
v.isNone(this._edits)?this._edits={type:"append",addOrUpdate:z.FeatureSetReaderJSON.fromOptimizedFeatures(c,e,v.unwrap(t)),id:this.tile.id,status:x.UpdateToken.empty(),end:!0}:(this.requests.done.forEach(b=>b.message.end=!1),v.unwrap(this._edits.addOrUpdate).append(m.features()))};g.readers=function*(){for(const {message:m}of this.requests.done)v.isSome(m.addOrUpdate)&&(yield m.addOrUpdate);v.isSome(this._edits)&&v.isSome(this._edits.addOrUpdate)&&(yield this._edits.addOrUpdate)};g._invalidate=function(){for(const m of this.requests.done)m.message.status=
x.UpdateToken.empty();v.isSome(this._edits)&&(this._edits.status=x.UpdateToken.empty())};g.removeIds=function(m){this._invalidate();for(const {message:p}of this.requests.done){const t=p.addOrUpdate;v.isSome(t)&&(t.removeIds(m),t.isEmpty&&(p.addOrUpdate=null))}v.isSome(this._edits)&&v.isSome(this._edits.addOrUpdate)&&this._edits.addOrUpdate.removeIds(m);this.requests.done=this.requests.done.filter(p=>p.message.addOrUpdate||p.message.end)};g.abort=function(){this._abortController.abort()};u._createClass(k,
[{key:"signal",get:function(){return this._abortController.signal}},{key:"options",get:function(){return{signal:this._abortController.signal}}},{key:"empty",get:function(){return!this.requests.done.length}},{key:"edits",get:function(){return this._edits}},{key:"done",get:function(){return this._done}}]);return k}();r.DataTileSubscription=f;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/UpdateToken":function(){define(["exports"],
function(r){let u=function(){function E(){this.version=0;this.source=!1;this.targets={feature:!1,aggregate:!1};this.storage={filters:!1,data:!1};this.queryFilter=this.mesh=!1;this.why={mesh:[],source:[]}}E.create=function(v){const z=new E;for(const x in v){const f=v[x];if("object"===typeof f)for(const k in f)z[x][k]=f[k];z[x]=f}return z};E.empty=function(){return E.create({})};E.all=function(){return E.create({source:!0,targets:{feature:!0,aggregate:!0},storage:{filters:!0,data:!0},mesh:!0})};var C=
E.prototype;C.unset=function(v){this.version=v.version;v.source&&(this.source=!1);v.targets.feature&&(this.targets.feature=!1);v.targets.aggregate&&(this.targets.aggregate=!1);v.storage.filters&&(this.storage.filters=!1);v.storage.data&&(this.storage.data=!1);v.mesh&&(this.mesh=!1);v.queryFilter&&(this.queryFilter=!1)};C.any=function(){return this.source||this.mesh||this.storage.filters||this.storage.data||this.targets.feature||this.targets.aggregate||this.queryFilter};C.describe=function(){let v=
0,z="";if(this.mesh){v+=20;z+="-\x3e (20) Mesh needs update\n";for(const x of this.why.mesh)z+=`    + ${x}\n`}if(this.source){v+=10;z+="-\x3e (10) The source needs update\n";for(const x of this.why.source)z+=`    + ${x}\n`}this.targets.feature&&(v+=5,z+="-\x3e (5) Feature target parameters changed\n");this.storage.filters&&(v+=5,z+="-\x3e (5) Feature filter parameters changed\n");this.targets.aggregate&&(v+=4,z+="-\x3e (4) Aggregate target parameters changed\n");this.storage.data&&(v+=1,z+="-\x3e (1) Texture storage parameters changed");
console.debug(`Applying ${5>v?"Fastest":10>v?"Fast":15>v?"Moderate":20>v?"Slow":"Very Slow"} update of cost ${v}/45 `);console.debug(z)};C.toJSON=function(){return{queryFilter:this.queryFilter,source:this.source,targets:this.targets,storage:this.storage,mesh:this.mesh}};return E}();r.UpdateToken=u;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/support/QueueProcessor":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/maybe ../../core/promiseUtils ../../core/Queue ../../core/scheduling".split(" "),
function(r,u,E,C,v,z){let x=function(k,g){this.item=k;this.controller=g;this.promise=null},f=function(){function k(m){this._deferreds=new Map;this._controllers=new Map;this._processingItems=new Map;this._isPaused=!1;this._task=this._schedule=null;this.concurrency=1;m.concurrency&&(this.concurrency=m.concurrency);this._queue=new v(m.peeker);this.process=m.process;const p=m.scheduler;m.priority&&E.isSome(p)&&(this._task=p.registerTask(m.priority,this))}var g=k.prototype;g.destroy=function(){this.clear();
this._schedule&&(this._schedule.remove(),this._schedule=null);this._task&&(this._task.remove(),this._task=null)};g.abort=function(m){(m=this._controllers.get(m))&&m.abort()};g.clear=function(){this._queue.clear();const m=[];this._controllers.forEach(p=>m.push(p));this._controllers.clear();m.forEach(p=>p.abort());this._processingItems.clear();this._cancelNext()};g.forEach=function(m){this._deferreds.forEach((p,t)=>m(t))};g.get=function(m){return(m=this._deferreds.get(m))?m.promise:void 0};g.isOngoing=
function(m){return this._processingItems.has(m)};g.has=function(m){return this._deferreds.has(m)};g.pause=function(){this._isPaused||(this._isPaused=!0,this._cancelNext())};g.push=function(m,p){const t=this.get(m);if(t)return t;const e=new AbortController;let c=null;p&&(c=C.onAbort(p,()=>e.abort()));const a=()=>{b.remove();E.isSome(c)&&c.remove();this._deferreds.delete(m);this._controllers.delete(m);this._queue.remove(m);this._processingItems.delete(m);this._scheduleNext()},b=C.onAbortOrThrow(e.signal,
()=>{const l=this._processingItems.get(m);l&&l.controller.abort();a();h.reject(C.createAbortError())}),h=C.createDeferred();this._deferreds.set(m,h);this._controllers.set(m,e);h.promise.then(a,a);this._queue.push(m);this._scheduleNext();return h.promise};g.last=function(){return this._queue.last()};g.peek=function(){return this._queue.peek()};g.popLast=function(){return this._queue.popLast()};g.reset=function(){const m=[];this._processingItems.forEach(p=>m.push(p));this._processingItems.clear();for(const p of m)this._queue.push(p.item),
p.controller.abort();this._scheduleNext()};g.resume=function(){this._isPaused&&(this._isPaused=!1,this._scheduleNext())};g.takeAll=function(){const m=[];for(;this._queue.length;)m.push(this._queue.pop());this.clear();return m};g.runTask=function(m){for(;!m.done&&0<this._queue.length&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),m.madeProgress()};g._scheduleNext=function(){this._task||this._isPaused||this._schedule||(this._schedule=z.schedule(()=>{this._schedule=null;
this._next()}))};g._next=function(){for(;0<this._queue.length&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())};g._cancelNext=function(){this._schedule&&(this._schedule.remove(),this._schedule=null)};g._processResult=function(m,p){this._canProcessFulfillment(m)&&(this._scheduleNext(),this._deferreds.get(m.item).resolve(p))};g._processError=function(m,p){this._canProcessFulfillment(m)&&(this._scheduleNext(),this._deferreds.get(m.item).reject(p))};g._canProcessFulfillment=
function(m){return this._deferreds.get(m.item)&&this._processingItems.get(m.item)===m?!0:!1};g._process=function(m){if(!E.isNone(m)){var p=new AbortController,t=new x(m,p);this._processingItems.set(m,t);try{var e=this.process(m,p.signal)}catch(c){this._processError(t,c)}C.isPromiseLike(e)?(t.promise=e,e.then(c=>this._processResult(t,c),c=>this._processError(t,c))):this._processResult(t,e)}};u._createClass(k,[{key:"length",get:function(){return this._processingItems.size+this._queue.length}},{key:"running",
get:function(){return!this._isPaused&&0<this._queue.length&&this._processingItems.size<this.concurrency}},{key:"test",get:function(){return{update:m=>this.runTask(m)}}}]);return k}();r.QueueProcessor=f;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/sources/GeoEventSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../chunks/rbush ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedGeometry ../../../../../layers/graphics/data/StreamFeatureManager ../../../../../layers/graphics/sources/connections/createConnection ./DataTileSource ../support/FeatureSetReaderJSON ../support/UpdateToken".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t){function e(h,l){const d=h.weakClone();if(C.isSome(h.geometry)){const q=x.quantizeX(l,h.geometry.coords[0]);h=x.quantizeY(l,h.geometry.coords[1]);d.geometry=new f([],[q,h])}return d}function c(h){switch(h){case "esriGeometryPoint":return e;default:return(l,d)=>{const q=l.weakClone(),n=new f;l=x.quantizeOptimizedGeometry(n,l.geometry,!1,!1,h,d,!1,!1);q.geometry=l;return q}}}function a(h){switch(h){case "esriGeometryPoint":return l=>C.isSome(l.geometry)?{minX:l.geometry.coords[0],
minY:l.geometry.coords[1],maxX:l.geometry.coords[0],maxY:l.geometry.coords[1]}:{minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity};default:return l=>{let d=Infinity,q=Infinity,n=-Infinity,B=-Infinity;C.isSome(l.geometry)&&l.geometry.forEachVertex((A,w)=>{d=Math.min(d,A);q=Math.min(q,w);n=Math.max(n,A);B=Math.max(B,w)});return{minX:d,minY:q,maxX:n,maxY:B}}}}let b=function(){function h(d,q){this.onUpdate=d;this._geometryType=q;this._objectIdToFeature=new Map}var l=h.prototype;l.add=function(d){this._objectIdToFeature.set(d.objectId,
d);this._index=null};l.get=function(d){return this._objectIdToFeature.has(d)?this._objectIdToFeature.get(d):null};l.forEach=function(d){this._objectIdToFeature.forEach(d)};l.search=function(d){if(!this._index){{var q=this._features;const n=z.rbush(9,a(this._geometryType));n.load(q);q=n}this._index=q}return this._index.search({minX:d.bounds[0],minY:d.bounds[1],maxX:d.bounds[2],maxY:d.bounds[3]})};l.removeById=function(d){const q=this._objectIdToFeature.get(d);return q?(this._objectIdToFeature.delete(d),
this._index=null,q):null};l.update=function(d,q){this.onUpdate(d,q)};u._createClass(h,[{key:"_features",get:function(){const d=[];this._objectIdToFeature.forEach(q=>d.push(q));return d}},{key:"size",get:function(){return this._objectIdToFeature.size}}]);return h}();E=function(h){function l(q){var n=h.call(this,q)||this;n.type="geoevent";n._dataReceiveEventEnabled=!1;n._level=0;n._updateInfo={websocket:0,client:0};const {outSR:B}=q,{geometryType:A,objectIdField:w,timeInfo:y,purgeOptions:D,source:F,
spatialReference:G,serviceFilter:K,maxReconnectionAttempts:J,maxReconnectionInterval:I,updateInterval:H,enableDataReceived:M,customParameters:N}=q.serviceInfo,P=new b(n._onUpdate.bind(u._assertThisInitialized(n)),A),ba=new k.StreamFeatureManager(P,w,y,D),X=g.createConnection(F,G,B,A,K,J,I,N);n._store=P;n._manager=ba;n._connection=X;n._quantize=c(A);n._dataReceiveEventEnabled=M;n._handles=[n._connection.on("feature",S=>n._onFeature(S)),v.watch(()=>X.connectionStatus,S=>n.events.emit("connectionStatus",
S)),v.watch(()=>X.errorString,S=>n.events.emit("errorString",S))];n._initUpdateInterval=()=>{let S=performance.now();n._updateIntervalId=setInterval(()=>{var W=performance.now(),R=W-S;2500<R&&(S=W,W=Math.round(n._updateInfo.client/(R/1E3)),R=Math.round(n._updateInfo.websocket/(R/1E3)),n._updateInfo.client=0,n._updateInfo.websocket=0,n.events.emit("updateRate",{client:W,websocket:R}));q.canAcceptRequest()&&n._manager.checkForUpdates()},H)};n._initUpdateInterval();return n}u._inheritsLoose(l,h);var d=
l.prototype;d.destroy=function(){h.prototype.destroy.call(this);this._clearUpdateInterval();this._handles.forEach(q=>q.remove());this._connection.destroy()};d._fetchDataTile=function(){};d.pauseStream=function(){this._clearUpdateInterval()};d.resumeStream=function(){this._initUpdateInterval()};d.enableEvent=function(q,n){"data-received"===q&&(this._dataReceiveEventEnabled=n)};d.subscribe=function(q,n){h.prototype.subscribe.call(this,q,n);n=this._subscriptions.get(q.id);this._level=q.level;const B=
this._getTileFeatures(q);this._onMessage({type:"append",id:q.key.id,addOrUpdate:B,end:!0});n.didSend=!0};d.unsubscribe=function(q){h.prototype.unsubscribe.call(this,q)};d.readers=function*(q){q=this._subscriptions.get(q);const {tile:n}=q;yield this._getTileFeatures(n);for(const B of q.requests.stream.entries)C.isSome(B)&&C.isSome(B.addOrUpdate)&&(yield B.addOrUpdate)};d.createTileQuery=function(q){throw Error("Service does not support tile  queries");};d.resend=function(){var q=u._asyncToGenerator(function*(){this._subscriptions.forEach(n=>
{({tile:n}=n);n={type:"append",id:n.id,addOrUpdate:this._getTileFeatures(n),end:!0};this._onMessage(n)})});return function(){return q.apply(this,arguments)}}();d._getTileFeatures=function(q){const n=this._store.search(q).map(B=>this._quantize(B,q.transform));return p.FeatureSetReaderJSON.fromOptimizedFeatures(n,this._serviceInfo,q.transform)};d._onFeature=function(q){this._updateInfo.websocket++;try{this._dataReceiveEventEnabled&&this.events.emit("feature",q);const n=x.convertFromFeature(q,this._serviceInfo.geometryType,
!1,!1,this._serviceInfo.objectIdField);this._manager.add(n)}catch(n){}};d._clearUpdateInterval=function(){clearInterval(this._updateIntervalId);this._updateIntervalId=0};d._onUpdate=function(q,n){C.isSome(q)&&(this._updateInfo.client+=q.length);this._subscriptions.forEach((B,A)=>{B.didSend&&B.tile.level===this._level&&this._onMessage({type:"append",id:A,addOrUpdate:null,clear:!0,end:!1})});this._subscriptions.forEach((B,A)=>{if(B.didSend&&B.tile.level===this._level){var w=this._getTileFeatures(B.tile);
A={type:"append",id:A,addOrUpdate:w,remove:[],end:!0,status:t.UpdateToken.empty()};B.requests.stream.enqueue(A);this._onMessage(A)}})};u._createClass(l,[{key:"updating",get:function(){return!1}}]);return l}(m.DataTileSource);r.GeoEventSource=E;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/data/StreamFeatureManager":function(){define(["exports","../../../core/CircularArray","../../../core/mathUtils","../../../core/maybe"],function(r,
u,E,C){let v=function(){function z(f,k,g,m,p=128){this._trackIdToObservations=new Map;this._idCounter=0;this._lastPurge=performance.now();this._addOrUpdated=new Map;this._removed=[];this._maxAge=0;this._timeInfo=g;this._purgeOptions=m;this.store=f;this.objectIdField=k;this.purgeInterval=p;this._useGeneratedIds="__esri_stream_id__"===this.objectIdField}var x=z.prototype;x.add=function(f){if(this._useGeneratedIds){var k=this._nextId();f.attributes[this.objectIdField]=k;f.objectId=k}else f.objectId=
f.attributes[this.objectIdField];this._addOrUpdated.set(f.objectId,f);this._maxAge=Math.max(this._maxAge,f.attributes[this._timeInfo.startTimeField]);if(this._timeInfo.trackIdField){k=f.attributes[this._timeInfo.trackIdField];if(!this._trackIdToObservations.has(k)){var g=C.isSome(this._purgeOptions)&&null!=this._purgeOptions.maxObservations?this._purgeOptions.maxObservations:1E3;g=E.clamp(g,0,1E3);this._trackIdToObservations.set(k,new u(g))}f=this._trackIdToObservations.get(k).enqueue(f.objectId);
C.isSome(f)&&(this._addOrUpdated.has(f)?this._addOrUpdated.delete(f):this._removed.push(f))}else C.isNone(this._trackIdLessObservations)&&(this._trackIdLessObservations=new u(1E5)),this._trackIdLessObservations.enqueue(f.objectId)};x.checkForUpdates=function(){const f=this._getToAdd();var k=this._getToRemove();const g=performance.now();g-this._lastPurge>=this.purgeInterval&&(this._purge(g),this._lastPurge=g);const m=[];if(C.isSome(k))for(const p of k)k=this.store.removeById(p),C.isSome(k)&&m.push(k);
if(C.isSome(f))for(const p of f)p.attributes.__esri_timestamp__=g,this.store.add(p);(f||m)&&this.store.update(f,m)};x._getToAdd=function(){if(!this._addOrUpdated.size)return null;const f=Array(this._addOrUpdated.size);let k=0;this._addOrUpdated.forEach(g=>f[k++]=g);this._addOrUpdated.clear();return f};x._getToRemove=function(){const f=this._removed;if(!this._removed.length)return null;this._removed=[];return f};x._nextId=function(){const f=this._idCounter;this._idCounter=(this._idCounter+1)%4294967294+
1;return f};x._purge=function(f){const k=this._purgeOptions;C.isSome(k)&&(this._purgeSomeByDisplayCount(k),this._purgeByAge(k),this._purgeByAgeReceived(f,k),this._purgeTracks())};x._purgeSomeByDisplayCount=function(f){if(f.displayCount){var k=this.store.size;if(k>f.displayCount){if(this._timeInfo.trackIdField)for(const g of this._trackIdToObservations.values())if(k>f.displayCount&&g.size){const m=C.unwrap(g.dequeue());this._removed.push(m);k--}if(C.isSome(this._trackIdLessObservations))for(f=k-f.displayCount;0<
f--;)k=this._trackIdLessObservations.dequeue(),C.isSome(k)&&this._removed.push(k)}}};x._purgeByAge=function(f){var k;if(f.age&&null!=(k=this._timeInfo)&&k.startTimeField){var g=this._maxAge-6E4*f.age;this.store.forEach(m=>{m.attributes[this._timeInfo.startTimeField]<g&&this._removed.push(m.objectId)})}};x._purgeByAgeReceived=function(f,k){if(k.ageReceived){var g=f-6E4*k.ageReceived;this.store.forEach(m=>{m.attributes.__esri_timestamp__<g&&this._removed.push(m.objectId)})}};x._purgeTracks=function(){this._trackIdToObservations.forEach((f,
k)=>{0===f.size&&this._trackIdToObservations.delete(k)})};return z}();r.DEFAULT_STREAM_ID_FIELD="__esri_stream_id__";r.ESRI_TIMESTAMP="__esri_timestamp__";r.StreamFeatureManager=v;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/sources/connections/createConnection":function(){define(["exports","./GeoEventConnection","./WebSocketConnection"],function(r,u,E){r.createConnection=function(C,v,z,x,f,k,g,m){const p=0===C.path.indexOf("wss://")||
0===C.path.indexOf("ws://");C={source:C,sourceSpatialReference:v,spatialReference:z,geometryType:x,filter:f,maxReconnectionAttempts:k,maxReconnectionInterval:g,customParameters:m};return p?new E.WebSocketConnection(C):new u(C)};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/sources/connections/GeoEventConnection":function(){define("require ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../request ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/set ../../../../core/accessorSupport/decorators/subclass ./WebSocketConnection ../../../../rest/query/operations/query ../../../../rest/support/Query ../../../../geometry/support/jsonUtils ../../../../geometry/SpatialReference".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t,e,c,a,b,h,l,d){const q=x.getLogger("esri.layers.graphics.sources.connections.GeoEventConnection"),n={maxQueryDepth:5,maxRecordCountFactor:3};C=function(B){function A(y){return B.call(this,{...n,...y})||this}u._inheritsLoose(A,B);var w=A.prototype;w._open=function(){var y=u._asyncToGenerator(function*(){var D=yield this._fetchServiceDefinition(this._config.source);D.timeInfo.trackIdField||q.warn("GeoEvent service was configured without a TrackIdField. This may result in certain functionality being disabled. The purgeOptions.maxObservations property will have no effect.");
D=this._fetchWebSocketUrl(D.streamUrls,this._config.spatialReference);this._buddyServicesQuery||(this._buddyServicesQuery=this._queryBuddyServices());yield this._buddyServicesQuery;yield this._tryCreateWebSocket(D);const {filter:F,outFields:G}=this._config;this.destroyed||this._setFilter(F,G)});return function(){return y.apply(this,arguments)}}();w._onMessage=function(y){let D;try{D=this._enrich(JSON.parse(y.data)),f.isSome(this._featureZScaler)&&this._featureZScaler(D.geometry)}catch(F){q.error(new z("geoevent-connection",
"Failed to parse message",F));return}this.onFeature(D)};w._fetchServiceDefinition=function(){var y=u._asyncToGenerator(function*(D){return this._serviceDefinition=D=(yield v(D.path,{query:{f:"json",...this._config.customParameters},responseType:"json"})).data});return function(D){return y.apply(this,arguments)}}();w._fetchWebSocketUrl=function(y,D){const {urls:F,token:G}=y[0];y=this._inferWebSocketBaseUrl(F);return g.addQueryParameters(`${y}/subscribe`,{outSR:""+D.wkid,token:G})};w._inferWebSocketBaseUrl=
function(y){if(1===y.length)return y[0];for(const D of y)if(D.includes("wss"))return D;q.error(new z("geoevent-connection","Unable to infer WebSocket url",y));return null};w._setFilter=function(){var y=u._asyncToGenerator(function*(D,F){const G=this._websocket;if(!(f.isNone(G)||f.isNone(D)&&f.isNone(F))){D=JSON.stringify({filter:this._serializeFilter(D,F)});var K=!1,J=k.createResolver();G.onmessage=I=>{I=JSON.parse(I.data);I.filter&&(I.error&&(q.error(new z("geoevent-connection","Failed to set service filter",
I.error)),this._set("errorString",`Could not set service filter - ${I.error}`),J.reject(I.error)),G.onmessage=this._onMessage.bind(this),K=!0,J.resolve())};G.send(D);setTimeout(()=>{K||(this.destroyed||this._websocket!==G||q.error(new z("geoevent-connection","Server timed out when setting filter")),J.reject())},1E4);return J.promise}});return function(D,F){return y.apply(this,arguments)}}();w._serializeFilter=function(y,D){const F={};if(f.isNone(y)&&f.isNone(D))return F;if(f.isSome(y)&&y.geometry)try{const G=
l.fromJSON(y.geometry);if("extent"!==G.type)throw new z(`Expected extent but found type ${G.type}`);F.geometry=JSON.stringify(G.shiftCentralMeridian())}catch(G){q.error(new z("geoevent-connection","Encountered an error when setting connection geometryDefinition",G))}f.isSome(y)&&y.where&&"1 \x3d 1"!==y.where&&(F.where=y.where);f.isSome(D)&&(F.outFields=D.join(","));return F};w._enrich=function(y){if(!this._relatedFeatures)return y;const D=y.attributes[this._serviceDefinition.relatedFeatures.joinField];
if(!this._relatedFeatures.has(D))return q.warn("geoevent-connection","Feature join failed. Is the join field configured correctly?",y),y;const {attributes:F,geometry:G}=this._relatedFeatures.get(D);for(const K in F)y.attributes[K]=F[K];G&&(y.geometry=G);y.geometry||y.centroid||q.error(new z("geoevent-connection","Found malformed feature - no geometry found",y));return y};w._queryBuddyServices=function(){var y=u._asyncToGenerator(function*(){try{const {relatedFeatures:D,keepLatestArchive:F}=this._serviceDefinition,
G=this._queryRelatedFeatures(D),K=this._queryArchive(F);yield G;const J=yield K;if(J)for(const I of J.features)this.onFeature(this._enrich(I))}catch(D){q.error(new z("geoevent-connection","Encountered an error when querying buddy services",{error:D}))}});return function(){return y.apply(this,arguments)}}();w._queryRelatedFeatures=function(){var y=u._asyncToGenerator(function*(D){D&&(D=yield this._queryBuddy(D.featuresUrl),this._addRelatedFeatures(D))});return function(D){return y.apply(this,arguments)}}();
w._queryArchive=function(){var y=u._asyncToGenerator(function*(D){if(D)return this._queryBuddy(D.featuresUrl)});return function(D){return y.apply(this,arguments)}}();w._queryBuddy=function(){var y=u._asyncToGenerator(function*(D){const F=new (yield new Promise((N,P)=>r(["../../../FeatureLayer"],ba=>N(Object.freeze(Object.defineProperty({__proto__:null,default:ba},Symbol.toStringTag,{value:"Module"}))),P))).default({url:D});var {capabilities:G}=yield F.load();const K=G.query.supportsMaxRecordCountFactor,
J=G.query.supportsPagination;G=G.query.supportsCentroid;const I=this._config.maxRecordCountFactor;var H=F.capabilities.query.maxRecordCount;H=K?H*I:H;const M=new h;M.outFields=f.unwrapOr(this._config.outFields,["*"]);M.where=f.unwrapOr(f.get(this._config.filter,"where"),"1\x3d1");M.returnGeometry=!0;M.returnExceededLimitFeatures=!0;M.outSpatialReference=d.fromJSON(this._config.spatialReference);G&&(M.returnCentroid=!0);K&&(M.maxRecordCountFactor=I);if(J)return M.num=H,F.destroy(),this._queryPages(D,
M);D=yield b.executeQuery(D,M,this._config.sourceSpatialReference);F.destroy();return D.data});return function(D){return y.apply(this,arguments)}}();w._queryPages=function(){var y=u._asyncToGenerator(function*(D,F,G=[],K=0){F.start=f.isSome(F.num)?K*F.num:null;const {data:J}=yield b.executeQuery(D,F,this._config.sourceSpatialReference);if(J.exceededTransferLimit&&K<this._config.maxQueryDepth)return J.features.forEach(I=>G.push(I)),this._queryPages(D,F,G,K+1);G.forEach(I=>J.features.push(I));return J});
return function(D,F){return y.apply(this,arguments)}}();w._addRelatedFeatures=function(y){const D=new Map;y=y.features;const F=this._serviceDefinition.relatedFeatures.joinField;for(const G of y)D.set(G.attributes[F],G);this._relatedFeatures=D};return A}(a.WebSocketConnection);return C=E.__decorate([c.subclass("esri.layers.graphics.sources.connections.GeoEventConnection")],C)})},"esri/layers/graphics/sources/connections/WebSocketConnection":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/support/zscale ./StreamConnection".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t,e,c){const a=v.getLogger("esri.layers.graphics.sources.connections.WebSocketConnection");r.ReadyState=void 0;(function(b){b[b.CONNECTING=0]="CONNECTING";b[b.OPEN=1]="OPEN";b[b.CLOSING=2]="CLOSING";b[b.CLOSED=3]="CLOSED"})(r.ReadyState||(r.ReadyState={}));r.WebSocketConnection=function(b){function h(d){var q=b.call(this)||this;q.errorString=null;const {geometryType:n,spatialReference:B,sourceSpatialReference:A}=d;q._config=d;q._featureZScaler=e.getGeometryZScaler(n,
A,B);q._open();return q}u._inheritsLoose(h,b);var l=h.prototype;l._open=function(){var d=u._asyncToGenerator(function*(){yield this._tryCreateWebSocket();this.destroyed||(yield this._handshake())});return function(){return d.apply(this,arguments)}}();l.destroy=function(){z.isSome(this._websocket)&&(this._websocket.onopen=null,this._websocket.onclose=null,this._websocket.onerror=null,this._websocket.onmessage=null,this._websocket.close());this._websocket=null};l._tryCreateWebSocket=function(){var d=
u._asyncToGenerator(function*(q=this._config.source.path,n=1E3,B=0){try{if(!this.destroyed){var A=f.addQueryParameters(q,this._config.customParameters);this._websocket=yield this._createWebSocket(A);this.notifyChange("connectionStatus")}}catch(w){if(A=n/1E3,this._config.maxReconnectionAttempts&&B>=this._config.maxReconnectionAttempts)a.error(new C("websocket-connection","Exceeded maxReconnectionAttempts attempts. No further attempts will be made")),this.destroy();else return a.error(new C("websocket-connection",
`Failed to connect. Attempting to reconnect in ${A}s`,w)),yield x.after(n),this._tryCreateWebSocket(q,Math.min(1.5*n,1E3*this._config.maxReconnectionInterval),B+1)}});return function(){return d.apply(this,arguments)}}();l._createWebSocket=function(d){return new Promise((q,n)=>{const B=new WebSocket(d);B.onopen=()=>{B.onopen=null;this.destroyed?(B.onclose=null,B.close()):(B.onclose=A=>this._onClose(A),B.onerror=A=>this._onError(A),B.onmessage=A=>this._onMessage(A),q(B))};B.onclose=A=>{B.onopen=B.onclose=
null;n(A)}})};l._handshake=function(){var d=u._asyncToGenerator(function*(q=1E4){const n=this._websocket;if(!z.isNone(n)){var B=x.createResolver(),A=n.onmessage,{filter:w,outFields:y,spatialReference:D}=this._config;B.timeout(q);n.onmessage=F=>{var G;let K=null;try{K=JSON.parse(F.data)}catch(J){}K&&"object"===typeof K||(a.error(new C("websocket-connection","Protocol violation. Handshake failed - malformed message",F.data)),B.reject(),this.destroy());(null==(G=K.spatialReference)?void 0:G.wkid)!==
(null==D?void 0:D.wkid)&&(a.error(new C("websocket-connection",`Protocol violation. Handshake failed - expected wkid of ${D.wkid}`,F.data)),B.reject(),this.destroy());"json"!==K.format&&(a.error(new C("websocket-connection","Protocol violation. Handshake failed - format is not set",F.data)),B.reject(),this.destroy());w&&K.filter!==w&&a.error(new C("websocket-connection","Tried to set filter, but server doesn't support it"));y&&K.outFields!==y&&a.error(new C("websocket-connection","Tried to set outFields, but server doesn't support it"));
n.onmessage=A;B.resolve()};n.send(JSON.stringify({filter:w,outFields:y,format:"json",spatialReference:{wkid:D.wkid}}));return B.promise}});return function(){return d.apply(this,arguments)}}();l._onMessage=function(d){try{const q=JSON.parse(d.data);if("featureResult"!==q.type)throw new C("websocket-connection","Protocol violation - Expected to find message of type 'featureResult'",q);for(const n of q.features)z.isSome(this._featureZScaler)&&this._featureZScaler(n.geometry),this.onFeature(n)}catch(q){a.error(new C("websocket-connection",
"Failed to parse message",q)),this.destroy()}};l._onError=function(d){this._set("errorString","Encountered an error over WebSocket connection");a.error("websocket-connection","Encountered an error over WebSocket connection")};l._onClose=function(d){this._websocket=null;this.notifyChange("connectionStatus");1E3!==d.code&&a.error("websocket-connection",`WebSocket closed unexpectedly with error code ${d.code}`);this.destroyed||this._open()};u._createClass(h,[{key:"connectionStatus",get:function(){if(z.isNone(this._websocket))return"disconnected";
switch(this._websocket.readyState){case r.ReadyState.CONNECTING:case r.ReadyState.OPEN:return"connected";case r.ReadyState.CLOSING:case r.ReadyState.CLOSED:return"disconnected"}}}]);return h}(c);E.__decorate([k.property()],r.WebSocketConnection.prototype,"connectionStatus",null);E.__decorate([k.property()],r.WebSocketConnection.prototype,"errorString",void 0);r.WebSocketConnection=E.__decorate([t.subclass("esri.layers.graphics.sources.connections.WebSocketConnection")],r.WebSocketConnection);Object.defineProperties(r,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/sources/connections/StreamConnection":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Evented ../../../../core/HandleOwner ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/set ../../../../core/accessorSupport/decorators/subclass".split(" "),function(r,
u,E,C,v,z,x,f,k,g){E=function(m){function p(){return m.apply(this,arguments)||this}r._inheritsLoose(p,m);p.prototype.onFeature=function(t){this.emit("feature",t)};return p}(E.EventedMixin(C.HandleOwner));return E=u.__decorate([g.subclass("esri.layers.graphics.sources.connections.StreamConnection")],E)})},"esri/views/2d/layers/features/sources/PagedFeatureSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ./BaseFeatureSource".split(" "),
function(r,u,E,C,v,z,x){const f=C.getLogger("esri.views.2d.layers.features.sources.FeatureSource");C=function(k){function g(p){return k.call(this,p)||this}u._inheritsLoose(g,k);var m=g.prototype;m._fetchDataTile=function(){var p=u._asyncToGenerator(function*(t){const e=this._subscriptions.get(t.key.id);let c=!1,a=0,b=0;const h=(q,n)=>{b--;z.throwIfAborted(e);const B=t.id,A=q.reader;q=q.query;A.exceededTransferLimit?(n={id:B,addOrUpdate:A,end:c&&0===b,type:"append"},e.add({message:n,query:q}),this._onMessage(n)):
(c=!0,n={id:B,addOrUpdate:A,end:0===b,type:"append"},e.add({message:n,query:q}),this._onMessage(n))};let l=0,d=0;for(;!c&&20>d++;){let q;for(let n=0;n<l+1;n++){const B=a++;b++;q=this._fetchDataTilePage(t,B,e).then(A=>A&&h(A,B)).catch(A=>{c=!0;z.isAbortError(A)||(f.error(new E("mapview-query-error","Encountered error when fetching tile",{tile:t,error:A})),this._onMessage({id:t.id,addOrUpdate:null,end:c,type:"append"}))})}yield q;z.throwIfAborted(e);l=Math.min(l+2,6)}});return function(t){return p.apply(this,
arguments)}}();m._fetchDataTilePage=function(){var p=u._asyncToGenerator(function*(t,e,c){z.throwIfAborted(c);const a=this._queryInfo;var b={start:this.pageSize*e,num:this.pageSize,returnExceededLimitFeatures:!0,quantizationParameters:t.getQuantizationParameters()};v.isSome(this.maxRecordCountFactor)&&(b.maxRecordCountFactor=this.maxRecordCountFactor);b=this.createTileQuery(t,b);try{const h=yield this._queue.push({tile:t,query:b,signal:c.signal,depth:e});z.throwIfAborted(c);return h?a!==this._queryInfo?
this._fetchDataTilePage(t,e,c):{reader:h,query:b}:null}catch(h){return z.throwIfNotAbortError(h),null}});return function(t,e,c){return p.apply(this,arguments)}}();return g}(x.BaseFeatureSource);r.PagedFeatureSource=C;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/sources/SnapshotFeatureSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/RandomLCG ./BaseFeatureSource ../support/FeatureSetReaderPBFIndirect ../support/UpdateToken".split(" "),
function(r,u,E,C,v,z,x,f,k,g){function m(e,c,a){var b=e.getXHydrated();e=e.getYHydrated();b=c.getColumnForX(b);b=Math.floor(c.normalizeCol(b));c=Math.floor(c.getRowForY(e));return`${a}/${c}/${b}`}function p(e,c){if(v.isNone(e))return null;c=c.transform;const a=e.getQuantizationTransform();if(v.isNone(a)){const [w,y]=c.scale,[D,F]=c.translate;return e.transform(-D/w,F/y,1/w,1/-y)}const [b,h]=a.scale,[l,d]=a.translate,[q,n]=c.scale,[B,A]=c.translate;return e.transform((l-B)/q,(-d+A)/n,b/q,h/n)}const t=
C.getLogger("esri.views.2d.layers.features.sources.SnapshotFeatureSource");E=function(e){function c(b){var h=e.call(this,b)||this;h.mode="snapshot";h._loading=!0;h._controller=new AbortController;h._downloadPromise=null;h._didSendEnd=!1;h._queries=[];h._invalidated=!1;h._hasAggregates=!1;h._random=new x(1E3);h._store=b.store;h._markedIdsBufId=h._store.storage.createBitset();return h}u._inheritsLoose(c,e);var a=c.prototype;a.destroy=function(){e.prototype.destroy.call(this);this._controller.abort()};
a.update=function(b,h){e.prototype.update.call(this,b,h);this._hasAggregates=b.targets.aggregate};a.resend=function(){var b=u._asyncToGenerator(function*(h=!1){yield this._downloadPromise;this._invalidated||h?(h=v.unwrapOrThrow(this._schema.featureCount,"Expected featureCount to be defined"),this._invalidated=!1,this._subscriptions.forEach(l=>l.clear()),this._downloadPromise=this._download(h),yield this._downloadPromise):(h=this._queries.map(({query:l,reader:d})=>this._sendPatchQuery(l,d)),yield Promise.all(h),
this._subscriptions.forEach(l=>{l.requests.done.forEach(d=>this._onMessage(d.message))}))});return function(){return b.apply(this,arguments)}}();a.refresh=function(){var b=u._asyncToGenerator(function*(){yield this.resend(!0)});return function(){return b.apply(this,arguments)}}();a._sendPatchQuery=function(){var b=u._asyncToGenerator(function*(h,l){const d=v.isSome(h.outFields)?h.outFields:[],q=this._queryInfo.outFields,n=q.filter(w=>!d.includes(w));if(n.length){var B=h.clone(),A=this._signal;B.returnGeometry=
!1;B.returnCentroid=!1;B.outFields=n;h.outFields=q;h=yield this._queue.push({query:B,depth:0,signal:A});z.throwIfAborted({signal:A});l.joinAttributes(h)}});return function(h,l){return b.apply(this,arguments)}}();a._fetchDataTile=function(){var b=u._asyncToGenerator(function*(h){if(!this._downloadPromise){var l=v.unwrapOrThrow(this._schema.featureCount,"Expected featureCount to be defined");this._downloadPromise=this._download(l)}var d=this._store.search(h);l=this._subscriptions.get(h.key.id);const q=
d.length-1;for(let B=0;B<q;B++){var n=p(d[B],h);n={type:"append",id:h.id,addOrUpdate:n,end:!1,status:g.UpdateToken.empty()};l.add({query:null,message:n});this._hasAggregates||(yield z.after(1));this._onMessage(n)}d=p(0<=q?d[q]:null,h);h={type:"append",id:h.id,addOrUpdate:d,end:this._didSendEnd,status:g.UpdateToken.empty()};l.add({query:null,message:h});this._onMessage(h)});return function(h){return b.apply(this,arguments)}}();a._download=function(){var b=u._asyncToGenerator(function*(h){try{yield this.whenInitialized();
const l=this._store.storage.getBitset(this._markedIdsBufId),d=new Set;l.clear();const q=Array.from({length:Math.ceil(h/this.pageSize)},(n,B)=>B).sort((n,B)=>this._random.getInt()-this._random.getInt()).map(n=>this._downloadPage(n,l,d));yield Promise.all(q);this._store.sweepFeatures(l,this._store.storage);this._store.sweepFeatureSets(d)}catch(l){t.error("mapview-snapshot-source","Encountered and error when downloading feature snapshot",l)}this._sendEnd();this._loading=!1});return function(h){return b.apply(this,
arguments)}}();a._downloadPage=function(){var b=u._asyncToGenerator(function*(h,l,d){var q=this.pageSize;q={start:h*q,num:q,cacheHint:!0};v.isSome(this.maxRecordCountFactor)&&(q.maxRecordCountFactor=this.maxRecordCountFactor);q=this.createQuery(q);const n=this._signal;h=yield this._queue.push({query:q,depth:h,signal:n});z.throwIfAborted({signal:n});this._queries.push({query:q,reader:h});this._store.insert(h);d.add(h.instance);for(d=h.getCursor();d.next();)l.set(d.getDisplayId());this._send(h)});return function(h,
l,d){return b.apply(this,arguments)}}();a._send=function(b){if(this._subscriptions.size){var h=null,l=new Map,d=new Set,q=new Map;this._subscriptions.forEach(B=>{var A,w=B.tile;l.set(w.key.id,null);h=w.tileInfoView;d.add(w.level);const {row:y,col:D}=w.key;w=`${w.level}/${y}/${D}`;const F=null!=(A=q.get(w))?A:[];F.push(B);q.set(w,F)});for(const B of d){const A=h.getLODInfoAt(B),w=b.getCursor();for(;w.next();){var n=m(w,A,B);const y=w.getIndex();if(q.has(n))for(const D of q.get(n)){n=D.tile.id;let F=
l.get(n);v.isNone(F)&&(F=[],l.set(n,F));F.push(y)}}}l.forEach((B,A)=>{if(v.isSome(B)){const w=this._subscriptions.get(A);B=p(k.FeatureSetReaderIndirect.from(b,B),w.tile);A={type:"append",id:A,addOrUpdate:B,end:!1,status:g.UpdateToken.empty()};w.add({query:null,message:A});this._onMessage(A)}})}};a._sendEnd=function(){this._subscriptions.forEach(b=>{const h={type:"append",id:b.tile.id,addOrUpdate:null,end:!0,status:g.UpdateToken.empty()};b.add({query:null,message:h});this._onMessage(h)});this._didSendEnd=
!0};u._createClass(c,[{key:"loading",get:function(){return this._loading}},{key:"_signal",get:function(){return this._controller.signal}}]);return c}(f.BaseFeatureSource);r.SnapshotFeatureSource=E;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/AttributeStore":function(){define("require ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/diffUtils ../../../../../layers/support/FieldsIndex ../../../engine/webgl/definitions ../../../engine/webgl/DisplayId ../../../engine/webgl/Utils ../../../engine/webgl/util/debug ../tileRenderers/support/visualVariablesUtils ../../../../webgl/enums".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t,e,c,a){function b(B,A){return w=>A(B(w))}const h=v.getLogger("esri.views.layers.2d.features.support.AttributeStore"),l=e.createDebugLogger(e.DEBUG_ATTR_UPDATES,h);var d=C("esri-shared-array-buffer"),q=C("esri-atomics");let n=function(){function B(w,y,D,F){this.size=0;this.texelSize=4;const {pixelType:G,layout:K,textureOnly:J}=F;this.textureOnly=J||!1;this.pixelType=G;this._ctype=y;this.layout=K;this._resetRange();this._shared=w;this.size=D;J||(this.data=this._initData(G,
D,w,y))}var A=B.prototype;A.unsetComponentAllTexels=function(w,y){const D=x.unwrap(this.data);for(let F=0;F<this.size*this.size;F++)D[F*this.texelSize+w]&=~y;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};A.setComponentAllTexels=function(w,y){const D=x.unwrap(this.data);for(let F=0;F<this.size*this.size;F++)D[F*this.texelSize+w]|=255&y;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};A.setComponent=function(w,y,D){const F=x.unwrap(this.data);for(const G of D)F[G*this.texelSize+w]|=y,
this.dirtyStart=Math.min(this.dirtyStart,G),this.dirtyEnd=Math.max(this.dirtyEnd,G)};A.setComponentTexel=function(w,y,D){x.unwrap(this.data)[D*this.texelSize+w]|=y;this.dirtyStart=Math.min(this.dirtyStart,D);this.dirtyEnd=Math.max(this.dirtyEnd,D)};A.unsetComponentTexel=function(w,y,D){x.unwrap(this.data)[D*this.texelSize+w]&=~y;this.dirtyStart=Math.min(this.dirtyStart,D);this.dirtyEnd=Math.max(this.dirtyEnd,D)};A.getData=function(w,y){w=p.getDisplayIdTexel(w);return x.unwrap(this.data)[w*this.texelSize+
y]};A.setData=function(w,y,D){w=p.getDisplayIdTexel(w);0===(this.layout&1<<y)?h.error("mapview-attributes-store","Tried to set a value for a texel's readonly component"):(this.data[w*this.texelSize+y]=D,this.dirtyStart=Math.min(this.dirtyStart,w),this.dirtyEnd=Math.max(this.dirtyEnd,w))};A.lock=function(){this.pixelType===a.PixelType.UNSIGNED_BYTE&&this._shared&&q&&"local"!==this._ctype&&Atomics.store(this.data,0,1)};A.unlock=function(){this.pixelType===a.PixelType.UNSIGNED_BYTE&&this._shared&&q&&
"local"!==this._ctype&&Atomics.store(this.data,0,0)};A.expand=function(w){this.size=w;if(!this.textureOnly){w=this._initData(this.pixelType,w,this._shared,this._ctype);const y=x.unwrap(this.data);w.set(y);this.data=w}};A.toMessage=function(){const w=this.dirtyStart,y=this.dirtyEnd;var D=this.texelSize;if(w>y)return null;this._resetRange();const F=!this._shared&&"local"!==this._ctype,G=this.pixelType,K=this.layout,J=x.unwrap(this.data);D=F&&J.slice(w*D,(y+1)*D)||null;return{start:w,end:y,data:D,pixelType:G,
layout:K}};A._initData=function(w,y,D,F){D=D&&"local"!==F?SharedArrayBuffer:ArrayBuffer;w=t.getPixelArrayCtor(w);y=new w(new D(y*y*4*w.BYTES_PER_ELEMENT));for(w=0;w<y.length;w+=4)y[w+1]=255;return y};A._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};u._createClass(B,[{key:"buffer",get:function(){return x.applySome(this.data,w=>w.buffer)}}]);return B}();return function(){function B(w,y,D=()=>{}){this._client=w;this.config=y;this._notifyChange=D;this._attributeComputeMap=new Map;
this._blocks=[];this._filters=Array(m.MAX_FILTERS);this._targetType=0;this._abortController=new AbortController;this._hasScaleExpr=!1;this._size=32;this._idsToHighlight=new Set;w=y.supportsTextureFloat?a.PixelType.FLOAT:a.PixelType.UNSIGNED_BYTE;l(`Creating AttributeStore ${d?"with":"without"} shared memory`);this._blockDescriptors=[{pixelType:a.PixelType.UNSIGNED_BYTE,layout:1},{pixelType:a.PixelType.UNSIGNED_BYTE,layout:15,textureOnly:!0},{pixelType:a.PixelType.UNSIGNED_BYTE,layout:15,textureOnly:!0},
{pixelType:w,layout:15},{pixelType:w,layout:15},{pixelType:w,layout:15},{pixelType:w,layout:15}];this._blocks=this._blockDescriptors.map(()=>null)}var A=B.prototype;A.destroy=function(){this._abortController.abort()};A.isUpdating=function(){return!!this._currUpdate||!!this._nextUpdate};A.update=function(w,y){this.config=y;y=y.schema.processors[0].storage;const D=k.diff(this._schema,y);if(w.targets.feature||w.targets.aggregate)w.storage.data=!0;if(D&&(C("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:",
D),w.storage.data=!0,this._schema=y,this._attributeComputeMap.clear(),!x.isNone(y))){switch(y.target){case "feature":this._targetType=p.DISPLAY_ID_TYPE_FEATURE;break;case "aggregate":this._targetType=p.DISPLAY_ID_TYPE_AGGREGATE}if("subtype"===y.type)for(const F in y.mapping){if(w=y.mapping[F],x.isSome(w)&&x.isSome(w.vvMapping))for(const G of w.vvMapping)this._bindAttribute(G)}else{if(x.isSome(y.vvMapping))for(const F of y.vvMapping)this._bindAttribute(F);if(x.isSome(y.attributeMapping))for(const F of y.attributeMapping)this._bindAttribute(F)}}};
A.onTileData=function(w,y){if(!x.isNone(y.addOrUpdate))for(w=y.addOrUpdate.getCursor();w.next();)y=w.getDisplayId(),this.setAttributeData(y,w)};A.invalidateResources=function(){this._createResourcesPromise=null;this._abortController.abort();this._abortController=new AbortController};A.setHighlight=function(){var w=u._asyncToGenerator(function*(y,D){const F=this._getBlock(0);D=D.map(G=>p.getDisplayIdTexel(G));F.lock();F.unsetComponentAllTexels(0,1);F.setComponent(0,1,D);F.unlock();this._idsToHighlight.clear();
for(const G of y)this._idsToHighlight.add(G);yield this.sendUpdates()});return function(y,D){return w.apply(this,arguments)}}();A.updateFilters=function(){var w=u._asyncToGenerator(function*(y,D,F){const {service:G,spatialReference:K}=F;({filters:D}=D);D=D.map((J,I)=>this._updateFilter(J,I,G,K));(yield Promise.all(D)).some(J=>J)&&(y.storage.filters=!0,C("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:","Filters changed"))});return function(y,D,F){return w.apply(this,arguments)}}();
A.setData=function(w,y,D,F){const G=p.getDisplayIdTexel(w);this._ensureSizeForTexel(G);this._getBlock(y).setData(w,D,F)};A.getData=function(w,y,D){return this._getBlock(y).getData(w,D)};A.getHighlightFlag=function(w){return this._idsToHighlight.has(w)?m.HIGHLIGHT_FLAG:0};A.unsetAttributeData=function(w){w=p.getDisplayIdTexel(w);this._getBlock(0).setData(w,0,0)};A.setAttributeData=function(w,y){const D=p.getDisplayIdTexel(w);this._ensureSizeForTexel(D);this._getBlock(0).setData(D,0,this.getFilterFlags(y));
if(this._targetType===p.getDisplayIdType(w)){w=this._attributeComputeMap;var F=this.config.supportsTextureFloat?1:2;w.size&&w.forEach((G,K)=>{const J=K*F%4;K=this._getBlock(Math.floor(K*F/4)+m.ATTRIBUTE_DATA_VV);G=G(y);if(this.config.supportsTextureFloat)K.setData(D,J,G);else if(G===m.NAN_MAGIC_NUMBER)K.setData(D,J,255),K.setData(D,J+1,255);else{G=z.clamp(Math.round(G),-32767,32766)+32768;const I=(G&65280)>>8;K.setData(D,J,G&255);K.setData(D,J+1,I)}})}};A.sendUpdates=function(){C("esri-2d-update-debug")&&
console.debug("AttributeStore::sendUpdate");this._notifyChange();if(this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=f.createResolver(),this._nextUpdate.promise;const w={blocks:this._blocks.map(y=>x.isSome(y)?y.toMessage():null)};return this._currUpdate=this._createResources().then(()=>{var y=()=>{this._currUpdate=null;if(this._nextUpdate){const D=this._nextUpdate;this._nextUpdate=null;this.sendUpdates().then(()=>D.resolve())}else C("esri-2d-update-debug")&&
console.debug("AttributeStore::sendUpdate::No additional updates queued");this._notifyChange()};C("esri-2d-update-debug")&&console.debug("AttributeStore::sendUpdate::client.update");y=this._client.update(w,this._signal).then(y).catch(y);this._client.render(this._signal);return y}).catch(y=>{if(f.isAbortError(y))return this._createResourcesPromise=null,this._createResources();this._notifyChange();h.error(new E("mapview-attribute-store","Encountered an error during client update",y))})};A._ensureSizeForTexel=
function(w){for(;w>=this._size*this._size&&!this._expand(););};A._bindAttribute=function(w){function y(){return w.normalizationField?G=>{const K=G.readAttribute(w.normalizationField);return K?G.readAttribute(w.field)/K:null}:G=>G.readAttribute(w.field)}function D(){w.normalizationField&&h.warn("mapview-arcade","Ignoring normalizationField specified with an arcade expression which is not supported.");return G=>G.getComputedNumericAtIndex(w.fieldIndex)}let F;if(null!=w.fieldIndex)F=D();else if(w.field)F=
y();else return;w.valueRepresentation&&(F=b(F,G=>c.getVisualVariableSizeValueRepresentationRatio(G,w.valueRepresentation)));this._attributeComputeMap.set(w.binding,b(F,G=>null===G||isNaN(G)||Infinity===G?m.NAN_MAGIC_NUMBER:G))};A._createResources=function(){if(x.isSome(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(m.ATTRIBUTE_DATA_ANIMATION);this._getBlock(m.ATTRIBUTE_DATA_GPGPU);l("Initializing AttributeStore");var w={shared:d&&"local"!==this._client.type,size:this._size,
blocks:x.mapMany(this._blocks,y=>({textureOnly:y.textureOnly,buffer:y.buffer,pixelType:y.pixelType}))};this._createResourcesPromise=w=this._client.initialize(w,this._signal).catch(y=>{f.isAbortError(y)?this._createResourcesPromise=null:h.error(new E("mapview-attribute-store","Encountered an error during client initialization",y))});w.then(()=>x.isNone(this._createResourcesPromise)?this._createResources():void 0);return w};A._getBlock=function(w){var y=this._blocks[w];if(x.isSome(y))return y;l(`Initializing AttributeBlock at index ${w}`);
y=new n(d,this._client.type,this._size,this._blockDescriptors[w]);this._blocks[w]=y;this._createResourcesPromise=null;return y};A._expand=function(){if(this._size<this.config.maxTextureSize){const w=this._size<<=1;l("Expanding block size to",w,this._blocks);x.forEachSome(this._blocks,y=>y.expand(w));this._createResourcesPromise=null;this._size=w;return 0}h.error(new E("mapview-limitations","Maximum number of onscreen features exceeded."));return-1};A._updateFilter=function(){var w=u._asyncToGenerator(function*(y,
D,F,G){const K=this._filters[D],J=x.isSome(K)&&K.hash;if(!K&&!y||J===JSON.stringify(y))return!1;if(x.isNone(y)){if(!K)return!1;y=1<<D+1;F=this._getBlock(0);this._filters[D]=null;F.setComponentAllTexels(0,y);this.sendUpdates();return!0}yield(yield this._getFilter(D,F)).update(y,G);return!0});return function(y,D,F,G){return w.apply(this,arguments)}}();A._getFilter=function(){var w=u._asyncToGenerator(function*(y,D){var F=this._filters[y];if(x.isSome(F))return F;({default:F}=yield new Promise((G,K)=>
r(["./FeatureFilter"],J=>G(Object.freeze(Object.defineProperty({__proto__:null,default:J},Symbol.toStringTag,{value:"Module"}))),K)));D=new F({geometryType:D.geometryType,hasM:!1,hasZ:!1,timeInfo:D.timeInfo,fieldsIndex:new g(D.fields)});return this._filters[y]=D});return function(y,D){return w.apply(this,arguments)}}();A.isVisible=function(w){return!!(this._getBlock(0).getData(w,0)&2)};A.getFilterFlags=function(w){let y=0;var D=p.getDisplayIdFilterMask(w.getDisplayId());for(let G=0;G<this._filters.length;G++){var F=
this._filters[G];F=!(D&1<<G)||x.isNone(F)||F.check(w);y|=(F?1:0)<<G}D=0;this._idsToHighlight.size&&(w=w.getObjectId(),D=this.getHighlightFlag(w));return y<<1|D};u._createClass(B,[{key:"hasScaleExpr",get:function(){return this._hasScaleExpr}},{key:"_signal",get:function(){return this._abortController.signal}},{key:"hasHighlight",get:function(){return 0<this._idsToHighlight.size}}]);return B}()})},"esri/views/2d/engine/webgl/DisplayId":function(){define(["exports"],function(r){r.AGGREGATE_VALID_FILTERS_MASK=
254;r.DISPLAY_ID_TEXEL_MASK=8388607;r.DISPLAY_ID_TYPE_AGGREGATE=1;r.DISPLAY_ID_TYPE_FEATURE=0;r.DISPLAY_ID_TYPE_MASK=8388608;r.NONAGGREGATE_VALID_FILTERS_MASK=255;r.createDisplayId=function(u,E){return((E?8388608:0)|u)>>>0};r.getDisplayIdFilterMask=u=>1===(u&8388608)>>>23?254:255;r.getDisplayIdTexel=u=>u&8388607;r.getDisplayIdType=u=>(u&8388608)>>>23;r.isAggregateId=function(u){return 1===(u&8388608)>>>23};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/engine/webgl/Utils":function(){define("exports ../../../../core/Error ../../../../core/Logger ../../../../core/mathUtils ../../../../core/screenUtils ../../../../symbols/cim/enums ./color ./enums ./SymbolProperties ../../../webgl/enums ../../../webgl/Texture ../../../webgl/VertexElementDescriptor".split(" "),function(r,u,E,C,v,z,x,f,k,g,m,p){function t(pa){const wa={};for(const Ba of pa)wa[Ba.name]=Ba.strideInBytes;return wa}function e(pa){switch(pa){case f.WGLGeometryType.MARKER:return M;
case f.WGLGeometryType.FILL:return N;case f.WGLGeometryType.LINE:return P;case f.WGLGeometryType.TEXT:return ba;case f.WGLGeometryType.LABEL:return X}}function c(pa){switch(pa%4){case 0:case 2:return 4;case 1:case 3:return 1}}function a(pa){switch(pa){case g.DataType.BYTE:case g.DataType.UNSIGNED_BYTE:return 1;case g.DataType.SHORT:case g.DataType.UNSIGNED_SHORT:return 2;case g.DataType.FLOAT:case g.DataType.INT:case g.DataType.UNSIGNED_INT:return 4}}function b(pa){const wa={};for(const Ba in pa){let L=
0;wa[Ba]=pa[Ba].map(T=>{const la=new p.VertexElementDescriptor(T.name,T.count,T.type,L,0,T.normalized||!1);L+=T.count*a(T.type);return la});wa[Ba].forEach(T=>T.stride=L)}return wa}const h=E.getLogger("esri.views.2d.engine.webgl.Utils");E=[{name:"geometry",strideInBytes:36}];const l=[{name:"geometry",strideInBytes:12}],d=[{name:"geometry",strideInBytes:36}],q=[{name:"geometry",strideInBytes:24}],n=[{name:"geometry",strideInBytes:12}],B=[{name:"geometry",strideInBytes:40}],A=[{name:"geometry",strideInBytes:36}],
w=[{name:"geometry",strideInBytes:36}],y=t(E),D=t(l),F=t(d),G=t(q),K=t(n),J=t(B),I=t(A),H=t(w),M=["geometry"],N=["geometry"],P=["geometry"],ba=["geometry"],X=["geometry"],S={["geometry"]:g.Usage.STATIC_DRAW},W=new Map,R=pa=>pa.startsWith("data:image/gif"),Z=pa=>pa.startsWith("data:image/png"),ka=pa=>{if(!pa)return!1;pa=pa.trim();return/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(pa)&&/[\dz]$/i.test(pa)&&4<pa.length?!0:!1},ta=pa=>{var wa,Ba;return"fill"===pa.type&&"CIMMarkerPlacementInsidePolygon"===
(null==pa?void 0:null==(wa=pa.cim)?void 0:null==(Ba=wa.markerPlacement)?void 0:Ba.type)};r.C_FILL_STRIDE_SPEC=F;r.C_FILL_STRIDE_SPEC_DD=K;r.C_FILL_STRIDE_SPEC_SIMPLE=G;r.C_FILL_VERTEX_DEF=d;r.C_FILL_VERTEX_DEF_DD=n;r.C_FILL_VERTEX_DEF_SIMPLE=q;r.C_HEATMAP_STRIDE_SPEC=D;r.C_HEATMAP_VERTEX_DEF=l;r.C_ICON_STRIDE_SPEC=y;r.C_ICON_VERTEX_DEF=E;r.C_LABEL_STRIDE_SPEC=H;r.C_LABEL_VERTEX_DEF=w;r.C_LINE_STRIDE_SPEC=J;r.C_LINE_VERTEX_DEF=B;r.C_TEXT_STRIDE_SPEC=I;r.C_TEXT_VERTEX_DEF=A;r.C_VBO_GEOMETRY="geometry";
r.C_VBO_INFO=S;r.C_VBO_PERINSTANCE="per_instance";r.C_VBO_PERINSTANCE_VV="per_instance_vv";r.allocateTypedArrayBuffer=function(pa,wa){switch(wa%4){case 0:case 2:return new Uint32Array(Math.floor(pa*wa/4));case 1:case 3:return new Uint8Array(pa*wa)}};r.allocateTypedArrayBufferwithData=function(pa,wa){switch(wa%4){case 0:case 2:return new Uint32Array(pa);case 1:case 3:return new Uint8Array(pa)}};r.charCodes=function(pa){const wa=[];for(let Ba=0;Ba<pa.length;Ba++)wa.push(pa.charCodeAt(Ba));return wa};
r.copyMeshData=function(pa,wa,Ba,L,T,la,U){for(const ea in la){var Q=la[ea].stride,da=c(Q);const ja=la[ea].data,ha=Ba[ea].data,Y=Q*T.vertexCount/da,ca=Q*pa/da;Q=Q*T.vertexFrom/da;for(da=0;da<Y;++da)ha[da+ca]=ja[da+Q]}Ba=T.indexCount;for(la=0;la<Ba;++la)L[la+wa]=U[la+T.indexFrom]-T.vertexFrom+pa};r.createGeometryData=function(pa,wa){const Ba=[];for(let L=0;5>L;++L){const T=e(L),la={};for(const U of T)la[U]={data:wa(L,U)};Ba.push({data:pa(L),buffers:la})}return Ba};r.createProgramDescriptor=(pa,wa)=>
{if(!W.has(pa)){const T=b(wa);var Ba=T;var L={};for(const la in Ba){const U=Ba[la];L[la]=U.length?U[0].stride:0}Ba=L;L=new Map;for(const la in wa)for(const U of wa[la])L.set(U.name,U.location);wa=L;W.set(pa,{strides:Ba,bufferLayouts:T,attributes:wa})}return W.get(pa)};r.createTextureFromTexelData=function(pa,wa){let Ba,L;C.isPowerOfTwo(wa.width)&&C.isPowerOfTwo(wa.height)?(Ba=!0,L=g.TextureSamplingMode.LINEAR_MIPMAP_LINEAR):(Ba=!1,L=g.TextureSamplingMode.LINEAR);return new m.Texture(pa,{target:g.TextureType.TEXTURE_2D,
pixelFormat:g.PixelFormat.RGBA,internalFormat:g.PixelFormat.RGBA,dataType:g.PixelType.UNSIGNED_BYTE,hasMipmap:Ba,samplingMode:L,wrapMode:g.TextureWrapMode.CLAMP_TO_EDGE,flipped:!0},wa)};r.forEachGeometryType=function(pa){pa(f.WGLGeometryType.FILL);pa(f.WGLGeometryType.LINE);pa(f.WGLGeometryType.MARKER);pa(f.WGLGeometryType.TEXT);pa(f.WGLGeometryType.LABEL)};r.geometryToMappedGeometry=function(pa){return{vertexFrom:void 0,vertexTo:void 0,geometry:pa}};r.getBytes=a;r.getCapType=function(pa){switch(pa){case "butt":return z.CapType.BUTT;
case "round":return z.CapType.ROUND;case "square":return z.CapType.SQUARE;default:return h.error(new u("mapview-invalid-type",`Cap type ${pa} is not a valid option. Defaulting to round`)),z.CapType.ROUND}};r.getJoinType=function(pa){switch(pa){case "miter":return z.JoinType.MITER;case "bevel":return z.JoinType.BEVEL;case "round":return z.JoinType.ROUND;default:return h.error(new u("mapview-invalid-type",`Join type ${pa} is not a valid option. Defaulting to round`)),z.JoinType.ROUND}};r.getNamedBuffers=
e;r.getPMSResourceSize=function(pa){const wa="maxVVSize"in pa&&pa.maxVVSize;pa="width"in pa&&pa.width||"size"in pa&&pa.size||0;return wa?wa:pa};r.getPixelArrayCtor=function(pa){switch(pa){case g.PixelType.UNSIGNED_BYTE:return Uint8Array;case g.PixelType.UNSIGNED_SHORT_4_4_4_4:return Uint16Array;case g.PixelType.FLOAT:return Float32Array;default:h.error(new u("webgl-utils",`Unable to handle type ${pa}`))}};r.getPixelBytes=function(pa){switch(pa){case g.PixelType.UNSIGNED_BYTE:return 1;case g.PixelType.UNSIGNED_SHORT_4_4_4_4:return 2;
case g.PixelType.FLOAT:return 4;default:h.error(new u("webgl-utils",`Unable to handle type ${pa}`))}};r.getStrides=function(pa,wa){switch(pa){case f.WGLGeometryType.MARKER:switch(wa){case f.WGLSymbologyType.HEATMAP:return D;default:return y}case f.WGLGeometryType.FILL:switch(wa){case f.WGLSymbologyType.DOT_DENSITY:return K;case f.WGLSymbologyType.SIMPLE:case f.WGLSymbologyType.OUTLINE_FILL_SIMPLE:return G;default:return F}case f.WGLGeometryType.LINE:return J;case f.WGLGeometryType.TEXT:return I;case f.WGLGeometryType.LABEL:return H}};
r.getTextProperties=function(pa){return k.TextProperties.pool.acquire(pa.color?x.copyAndPremultiply(pa.color):[255,255,255,255],pa.haloColor?x.copyAndPremultiply(pa.haloColor):[255,255,255,255],v.pt2px(pa.haloSize),v.pt2px(pa.font.size),pa.angle*Math.PI/180,pa.xoffset/pa.font.size,pa.yoffset/pa.font.size,"left"===pa.horizontalAlignment?0:"right"===pa.horizontalAlignment?1:.5,"top"===pa.verticalAlignment?0:"bottom"===pa.verticalAlignment?1:.5)};r.getTransformParams=function(pa){const {transform:wa,
hasZ:Ba,hasM:L}=pa;return{transform:wa,hasZ:Ba,hasM:L}};r.getUrl=pa=>"imageData"in pa&&pa.imageData&&"contentType"in pa&&pa.contentType?`data:${pa.contentType};base64,${pa.imageData}`:"url"in pa?pa.url:null;r.getVVType=function(pa){switch(pa){case "opacity":return f.VVType.OPACITY;case "color":return f.VVType.COLOR;case "rotation":return f.VVType.ROTATION;case "size":return f.VVType.SIZE;default:return h.error(`Cannot interpret unknown vv: ${pa}`),null}};r.is3D=pa=>pa.type&&pa.type.toLowerCase().includes("3d");
r.isDefined=function(pa){return null!=pa};r.isGIF=pa=>"url"in pa&&pa.url&&(pa.url.includes(".gif")||R(pa.url))||"contentType"in pa&&"image/gif"===pa.contentType||"imageData"in pa&&R(pa.imageData);r.isGIFDataUri=R;r.isImageResource=pa=>"url"in pa&&pa.url||"imageData"in pa&&pa.imageData;r.isMarkerPlacementInsidePolygon=ta;r.isNumber=function(pa){return"number"===typeof pa};r.isPNG=pa=>"url"in pa&&pa.url&&(pa.url.includes(".png")||Z(pa.url))||"contentType"in pa&&"image/png"===pa.contentType||"imageData"in
pa&&Z(pa.imageData);r.isPNGDataUri=Z;r.isSVGImage=pa=>pa.includes("data:image/svg+xml");r.isSVGResource=pa=>"path"in pa&&ka(pa.path);r.isSimple=function(pa){switch(pa.type){case "line":return"CIMSolidStroke"===pa.cim.type&&!pa.dashTemplate;case "fill":return"CIMSolidFill"===pa.cim.type;case "esriSFS":return"esriSFSSolid"===pa.style||"esriSFSNull"===pa.style;case "esriSLS":return"esriSLSSolid"===pa.style||"esriSLSNull"===pa.style;default:return!1}};r.isValidSVG=ka;r.shouldRepeat=function(pa){switch("cim"in
pa?pa.cim.type:pa.type){case "esriSMS":case "esriPMS":case "CIMPointSymbol":return!1;case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":return ta(pa);default:return!0}};r.strideToPackingFactor=c;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/screenUtils":function(){define(["exports"],function(r){function u(C){return C?72*C/96:0}const E=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;r.castRenderScreenPointArray=function(C){return C};
r.castRenderScreenPointArray3=function(C){return C};r.castScreenPointArray=function(C){return C};r.createRenderScreenPoint=function(C=0,v=0){return{x:C,y:v}};r.createRenderScreenPointArray=function(C=0,v=0){return[C,v]};r.createRenderScreenPointArray3=function(C=0,v=0,z=0){return[C,v,z]};r.createScreenPoint=function(C=0,v=0){return{x:C,y:v}};r.createScreenPointArray=function(C=0,v=0){return[C,v]};r.pt2px=function(C){return C?C/72*96:0};r.px2pt=u;r.screenPointArrayToObject=function(C,v){return v?(v.x=
C[0],v.y=C[1],v):{x:C[0],y:C[1]}};r.screenPointObjectToArray=function(C,v){return v?(v[0]=C.x,v[1]=C.y,2<v.length&&(v[2]=0),v):[C.x,C.y]};r.toPt=function(C){if("string"===typeof C){var v=C.match(E);if(v){var z=Number(v[1]);v=v[3]&&v[3].toLowerCase();C="-"===C.charAt(0);z="px"===v?u(z):z;return C?-z:z}console.warn("screenUtils.toPt: input not recognized!");return null}return C};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/color":function(){define(["exports",
"../../../../core/maybe","./number"],function(r,u,E){function C(x,f){Array.isArray(f)?(x[0]=f[0],x[1]=f[1],x[2]=f[2],x[3]=f[3]):(x[0]=f.r,x[1]=f.g,x[2]=f.b,x[3]=f.a);return x}function v(x,f=0,k=!1){const g=x[f+3];x[f+0]*=g;x[f+1]*=g;x[f+2]*=g;k||(x[f+3]*=255);return x}const z=[0,0,0,0];r.copyAndPremultiply=function(x){return v(C([],x))};r.premultiplyAlpha=v;r.premultiplyAlphaRGBA=function(x){if(!x)return 0;const {r:f,g:k,b:g,a:m}=x;return E.i8888to32(f*m,k*m,g*m,255*m)};r.premultiplyAlphaRGBAArray=
function(x){if(!x)return 0;const [f,k,g,m]=x;return E.i8888to32(m/255*f,m/255*k,m/255*g,m)};r.premultiplyAlphaUint32=function(x){v(C(z,x));return E.i8888to32(z[0],z[1],z[2],z[3])};r.white=[255,255,255,1];r.writeColor=function(x,f,k=0){if(u.isNone(f))x[k+0]=0,x[k+1]=0,x[k+2]=0,x[k+3]=0;else{var {r:g,g:m,b:p,a:t}=f;x[k+0]=g*t/255;x[k+1]=m*t/255;x[k+2]=p*t/255;x[k+3]=t}};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/number":function(){define(["exports"],
function(r){function u(v,z,x){return Math.round(Math.max(Math.min(v,x),z))}const E=new Float32Array(1),C=new Uint32Array(E.buffer);r.i16=function(v){return u(v,-32768,32767)};r.i1616to32=function(v,z){return 65535&v|z<<16};r.i32=function(v){return u(v,-2147483648,2147483647)};r.i8=function(v){return u(v,-128,127)};r.i8816to32=function(v,z,x){return v&255|(z&255)<<8|x<<16};r.i8888to32=function(v,z,x,f){return v&255|(z&255)<<8|(x&255)<<16|f<<24};r.numTo32=function(v){return v|0};r.toFloat32=function(v){C[0]=
v;return E[0]};r.toUint32=function(v){E[0]=v;return C[0]};r.u16=function(v){return u(v,0,65535)};r.u32=function(v){return u(v,0,4294967295)};r.u32to4Xu8=function(v){return[v&255,(v&65280)>>>8,(v&16711680)>>>16,(v&4278190080)>>>24]};r.u4u4to8=function(v,z){return 15&v|(15&z)<<4};r.u8=function(v){return u(v,0,255)};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/enums":function(){define(["exports"],function(r){r.WGLGeometryType=
void 0;(function(u){u[u.FILL=0]="FILL";u[u.LINE=1]="LINE";u[u.MARKER=2]="MARKER";u[u.TEXT=3]="TEXT";u[u.LABEL=4]="LABEL"})(r.WGLGeometryType||(r.WGLGeometryType={}));r.WGLGeometryTransactionStatus=void 0;(function(u){u[u.SUCCEEDED=0]="SUCCEEDED";u[u.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"})(r.WGLGeometryTransactionStatus||(r.WGLGeometryTransactionStatus={}));r.WGLDrawPhase=void 0;(function(u){u[u.NONE=0]="NONE";u[u.MAP=1]="MAP";u[u.LABEL=2]="LABEL";u[u.LABEL_ALPHA=4]="LABEL_ALPHA";u[u.HITTEST=
8]="HITTEST";u[u.HIGHLIGHT=16]="HIGHLIGHT";u[u.CLIP=32]="CLIP";u[u.DEBUG=64]="DEBUG";u[u.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(r.WGLDrawPhase||(r.WGLDrawPhase={}));r.VVType=void 0;(function(u){u[u.SIZE=0]="SIZE";u[u.COLOR=1]="COLOR";u[u.OPACITY=2]="OPACITY";u[u.ROTATION=3]="ROTATION"})(r.VVType||(r.VVType={}));r.WGLVVFlag=void 0;(function(u){u[u.NONE=0]="NONE";u[u.OPACITY=1]="OPACITY";u[u.COLOR=2]="COLOR";u[u.ROTATION=4]="ROTATION";u[u.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";u[u.SIZE_SCALE_STOPS=
16]="SIZE_SCALE_STOPS";u[u.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";u[u.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(r.WGLVVFlag||(r.WGLVVFlag={}));r.WGLVVTarget=void 0;(function(u){u[u.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";u[u.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE";u[u.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";u[u.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(r.WGLVVTarget||(r.WGLVVTarget={}));r.MosaicType=void 0;(function(u){u[u.SPRITE=0]="SPRITE";u[u.GLYPH=1]=
"GLYPH"})(r.MosaicType||(r.MosaicType={}));r.WGLSymbologyType=void 0;(function(u){u[u.DEFAULT=0]="DEFAULT";u[u.SIMPLE=1]="SIMPLE";u[u.DOT_DENSITY=2]="DOT_DENSITY";u[u.OUTLINE_FILL=3]="OUTLINE_FILL";u[u.OUTLINE_FILL_SIMPLE=4]="OUTLINE_FILL_SIMPLE";u[u.HEATMAP=5]="HEATMAP";u[u.PIE_CHART=6]="PIE_CHART"})(r.WGLSymbologyType||(r.WGLSymbologyType={}));Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/SymbolProperties":function(){define(["exports",
"../../../../core/ObjectPool"],function(r,u){let E=function(){function C(){this.color=[0,0,0,0];this.haloColor=[0,0,0,0];this.haloSize=0;this.size=12;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=0}var v=C.prototype;v.acquire=function(z,x,f,k,g,m,p,t,e){this.color=z;this.haloColor=x;this.haloSize=f;this.size=k;this.angle=g;this.offsetX=m;this.offsetY=p;this.hAnchor=t;this.vAnchor=e};v.release=function(){this.color[0]=this.color[1]=this.color[2]=this.color[3]=0;this.vAnchor=this.hAnchor=
this.offsetY=this.offsetX=this.angle=this.size=this.haloSize=this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0};return C}();E.pool=new u(E);r.TextProperties=E;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/Texture":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/has ../../core/mathUtils ../../core/maybe ./checkWebGLError ./context-util ./enums ./capabilities/isWebGL2Context".split(" "),
function(r,u,E,C,v,z,x,f,k){function g(e){return v.isSome(e)&&"type"in e&&"compressed"===e.type}function m(e){var c;if(c=v.isSome(e)&&!g(e))c=!(v.isSome(e)&&"byteLength"in e);return c}function p(e){return e===f.TextureType.TEXTURE_3D||e===f.TextureType.TEXTURE_2D_ARRAY}function t(e,c,a,b=1){c=Math.max(c,a);e===f.TextureType.TEXTURE_3D&&(c=Math.max(c,b));return Math.round(Math.log(c)/Math.LN2)+1}E=function(){function e(a,b,h=null){this._context=a;this.type="texture";this._glName=null;this._descriptor=
void 0;this._wasImmutablyAllocated=this._wrapModeDirty=this._samplingModeDirty=!1;a.instanceCounter.increment(f.ResourceType.Texture,this);this._descriptor={target:f.TextureType.TEXTURE_2D,samplingMode:f.TextureSamplingMode.LINEAR,wrapMode:f.TextureWrapMode.REPEAT,flipped:!1,hasMipmap:!1,isOpaque:!1,unpackAlignment:4,preMultiplyAlpha:!1,isImmutable:!1,...b};if(a.type!==x.ContextType.WEBGL2&&(this._descriptor.isImmutable&&(this._descriptor.isImmutable=!1),p(this._descriptor.target)))throw Error("3D and array textures are not supported in WebGL1");
this._descriptor.target===f.TextureType.TEXTURE_CUBE_MAP?this._setDataCubeMap(h):this.setData(h)}var c=e.prototype;c.dispose=function(){this._context.gl&&this._glName&&(this._context.unbindTexture(this),this._context.gl.deleteTexture(this._glName),this._glName=null,this._context.instanceCounter.decrement(f.ResourceType.Texture,this))};c.release=function(){this.dispose()};c.resize=function(a,b){const h=this._descriptor;if(h.width!==a||h.height!==b){if(this._wasImmutablyAllocated)throw Error("Immutable textures can't be resized!");
h.width=a;h.height=b;this._descriptor.target===f.TextureType.TEXTURE_CUBE_MAP?this._setDataCubeMap(null):this.setData(null)}};c._setDataCubeMap=function(a=null){for(let b=f.TextureType.TEXTURE_CUBE_MAP_POSITIVE_X;b<=f.TextureType.TEXTURE_CUBE_MAP_NEGATIVE_Z;b++)this._setData(a,b)};c.setData=function(a){this._setData(a)};c._setData=function(a,b){var h;if(this._context&&this._context.gl){var l=this._context.gl;this._glName||(this._glName=l.createTexture());void 0===a&&(a=null);var d=this._descriptor;
null!=(h=b)?h:b=d.target;h=p(b);if(null===a&&(d.width=d.width||4,d.height=d.height||4,h)){var q;d.depth=null!=(q=d.depth)?q:1}q=this._context.bindTexture(this,e.TEXTURE_UNIT_FOR_UPDATES);this._context.setActiveTexture(e.TEXTURE_UNIT_FOR_UPDATES);e._validateTexture(this._context,d);this._configurePixelStorage();var n=d.pixelFormat,B=d.internalFormat?d.internalFormat:this._deriveInternalFormat(n,d.dataType);if(m(a)){n=a.width;let A=a.height;a instanceof HTMLVideoElement&&(n=a.videoWidth,A=a.videoHeight);
d.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(b,B,d.hasMipmap,n,A,1);this._texImage(b,0,B,n,A,1,a);z.checkWebGLError(l);d.hasMipmap&&this.generateMipmap();void 0===d.width&&(d.width=n);void 0===d.height&&(d.height=A);h&&void 0===d.depth&&(d.depth=1)}else{const {width:A,height:w,depth:y}=d;null!=A&&null!=w||console.error("Width and height must be specified!");h&&null==y&&console.error("Depth must be specified!");d.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(b,B,d.hasMipmap,
A,w,y);l.DEPTH24_STENCIL8&&B===l.DEPTH_STENCIL&&(B=l.DEPTH24_STENCIL8);if(g(a)){const D=a.levels;a=t(b,A,w,y);h=Math.min(a-1,D.length-1);k(l)?l.texParameteri(d.target,l.TEXTURE_MAX_LEVEL,h):d.hasMipmap=d.hasMipmap&&a===D.length;const F=B;if(!(F in f.CompressedTextureFormat))throw Error("Attempting to use compressed data with an umcompressed format!");this._forEachMipmapLevel((G,K,J,I)=>{this._compressedTexImage(b,G,F,K,J,I,D[Math.min(G,D.length-1)])},h)}else v.isSome(a)?(this._texImage(b,0,B,A,w,
y,a),z.checkWebGLError(l),d.hasMipmap&&this.generateMipmap()):this._forEachMipmapLevel((D,F,G,K)=>{this._texImage(b,D,B,F,G,K,null);z.checkWebGLError(l)})}e._applySamplingMode(l,this._descriptor);e._applyWrapMode(l,this._descriptor);e._applyAnisotropicFilteringParameters(this._context,this._descriptor);z.checkWebGLError(l);this._context.bindTexture(q,e.TEXTURE_UNIT_FOR_UPDATES)}};c.updateData=function(a,b,h,l,d,q){q||console.error("An attempt to use uninitialized data!");this._glName||console.error("An attempt to update uninitialized texture!");
const n=this._context.gl,B=this._descriptor,{pixelFormat:A,internalFormat:w,dataType:y,isImmutable:D,target:F}=B;if(D&&!this._wasImmutablyAllocated)throw Error("Cannot update immutable texture before allocation!");const G=this._context.bindTexture(this,e.TEXTURE_UNIT_FOR_UPDATES);(0>b||0>h||l>B.width||d>B.height||b+l>B.width||h+d>B.height)&&console.error("An attempt to update out of bounds of the texture!");this._configurePixelStorage();m(q)?n.texSubImage2D(F,a,b,h,A,y,q):g(q)?n.compressedTexSubImage2D(F,
a,b,h,l,d,w,q.levels[a]):n.texSubImage2D(F,a,b,h,l,d,A,y,q);this._context.bindTexture(G,e.TEXTURE_UNIT_FOR_UPDATES)};c.updateData3D=function(a,b,h,l,d,q,n,B){B||console.error("An attempt to use uninitialized data!");this._glName||console.error("An attempt to update uninitialized texture!");const A=this._context.gl;if(!k(A))throw Error("3D textures are not supported in WebGL1");const w=this._descriptor,{pixelFormat:y,dataType:D,isImmutable:F,target:G,internalFormat:K}=w;if(F&&!this._wasImmutablyAllocated)throw Error("Cannot update immutable texture before allocation!");
p(G)||console.warn("Attempting to set 3D texture data on a non-3D texture");const J=this._context.bindTexture(this,e.TEXTURE_UNIT_FOR_UPDATES);this._context.setActiveTexture(e.TEXTURE_UNIT_FOR_UPDATES);(0>b||0>h||0>l||d>w.width||q>w.height||n>w.depth||b+d>w.width||h+q>w.height||l+n>w.depth)&&console.error("An attempt to update out of bounds of the texture!");this._configurePixelStorage();g(B)?(B=B.levels[a],A.compressedTexSubImage3D(G,a,b,h,l,d,q,n,K,B)):A.texSubImage3D(G,a,b,h,l,d,q,n,y,D,B);this._context.bindTexture(J,
e.TEXTURE_UNIT_FOR_UPDATES)};c.generateMipmap=function(){const a=this._descriptor;if(!a.hasMipmap){if(this._wasImmutablyAllocated)throw Error("Cannot add mipmaps to immutable texture after allocation");this._samplingModeDirty=a.hasMipmap=!0;e._validateTexture(this._context,a)}a.samplingMode===f.TextureSamplingMode.LINEAR?(this._samplingModeDirty=!0,a.samplingMode=f.TextureSamplingMode.LINEAR_MIPMAP_NEAREST):a.samplingMode===f.TextureSamplingMode.NEAREST&&(this._samplingModeDirty=!0,a.samplingMode=
f.TextureSamplingMode.NEAREST_MIPMAP_NEAREST);const b=this._context.bindTexture(this,e.TEXTURE_UNIT_FOR_UPDATES);this._context.setActiveTexture(e.TEXTURE_UNIT_FOR_UPDATES);this._context.gl.generateMipmap(a.target);this._context.bindTexture(b,e.TEXTURE_UNIT_FOR_UPDATES)};c.setSamplingMode=function(a){a!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=a,this._samplingModeDirty=!0)};c.setWrapMode=function(a){a!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=a,e._validateTexture(this._context,
this._descriptor),this._wrapModeDirty=!0)};c.applyChanges=function(){const a=this._context.gl,b=this._descriptor;this._samplingModeDirty&&(e._applySamplingMode(a,b),this._samplingModeDirty=!1);this._wrapModeDirty&&(e._applyWrapMode(a,b),this._wrapModeDirty=!1)};c._deriveInternalFormat=function(a,b){if(this._context.type===x.ContextType.WEBGL1)return a;switch(b){case f.PixelType.FLOAT:switch(a){case f.PixelFormat.RGBA:return f.SizedPixelFormat.RGBA32F;case f.PixelFormat.RGB:return f.SizedPixelFormat.RGB32F;
default:throw Error("Unable to derive format");}case f.PixelType.UNSIGNED_BYTE:switch(a){case f.PixelFormat.RGBA:return f.SizedPixelFormat.RGBA8;case f.PixelFormat.RGB:return f.SizedPixelFormat.RGB8}default:return a}};c._configurePixelStorage=function(){const a=this._context.gl,{unpackAlignment:b,flipped:h,preMultiplyAlpha:l}=this._descriptor;a.pixelStorei(a.UNPACK_ALIGNMENT,b);a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,h?1:0);a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l?1:0)};c._texStorage=function(a,
b,h,l,d,q){const n=this._context.gl;if(!k(n))throw Error("Immutable textures are not supported in WebGL1");if(!(b in f.SizedPixelFormat))throw Error("Immutable textures must have a sized internal format");this._descriptor.isImmutable&&(h=h?t(a,l,d,q):1,p(a)?n.texStorage3D(a,h,b,l,d,q):n.texStorage2D(a,h,b,l,d),this._wasImmutablyAllocated=!0)};c._texImage=function(a,b,h,l,d,q,n){const B=this._context.gl;let A=null;const w=this._context.type===x.ContextType.WEBGL2,y=p(a),{isImmutable:D,pixelFormat:F,
dataType:G}=this._descriptor;w&&(A=B);!w&&m(n)?B.texImage2D(a,0,h,F,G,n):D?v.isSome(n)&&(y?A.texSubImage3D(a,b,0,0,0,l,d,q,F,G,n):B.texSubImage2D(a,b,0,0,l,d,F,G,n)):(n=v.unwrap(n),y?A.texImage3D(a,b,h,l,d,q,0,F,G,n):B.texImage2D(a,b,h,l,d,0,F,G,n))};c._compressedTexImage=function(a,b,h,l,d,q,n){const B=this._context.gl;let A=null;const w=p(a),y=this._descriptor.isImmutable;if(w){if(this._context.type!==x.ContextType.WEBGL2)throw Error("3D textures are not supported in WebGL1");A=B}y?v.isSome(n)&&
(w?A.compressedTexSubImage3D(a,b,0,0,0,l,d,q,h,n):B.compressedTexSubImage2D(a,b,0,0,l,d,h,n)):w?A.compressedTexImage3D(a,b,h,l,d,q,0,n):B.compressedTexImage2D(a,b,h,l,d,0,n)};c._forEachMipmapLevel=function(a,b=Infinity){let {width:h,height:l,depth:d,hasMipmap:q,target:n}=this._descriptor;const B=n===f.TextureType.TEXTURE_3D;for(let A=0;;++A){a(A,h,l,d);if(!q||1===h&&1===l&&(!B||1===d)||A>=b)break;h=Math.max(1,h>>1);l=Math.max(1,l>>1);B&&(d=Math.max(1,d>>1))}};e._validateTexture=function(a,b){(0>b.width||
0>b.height||0>b.depth)&&console.error("Negative dimension parameters are not allowed!");a=k(a.gl);const h=C.isPowerOfTwo(b.width)&&C.isPowerOfTwo(b.height);a||!b.isImmutable&&!p(b.target)||console.error("Immutable and 3D-like textures are not supported in WebGL1!");a||h||("number"===typeof b.wrapMode?b.wrapMode!==f.TextureWrapMode.CLAMP_TO_EDGE&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"):(b.wrapMode.s!==f.TextureWrapMode.CLAMP_TO_EDGE||b.wrapMode.t!==f.TextureWrapMode.CLAMP_TO_EDGE)&&
console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),b.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))};e._applySamplingMode=function(a,b){let h=b.samplingMode,l=b.samplingMode;if(h===f.TextureSamplingMode.LINEAR_MIPMAP_NEAREST||h===f.TextureSamplingMode.LINEAR_MIPMAP_LINEAR)h=f.TextureSamplingMode.LINEAR,b.hasMipmap||(l=f.TextureSamplingMode.LINEAR);else if(h===f.TextureSamplingMode.NEAREST_MIPMAP_NEAREST||h===f.TextureSamplingMode.NEAREST_MIPMAP_LINEAR)h=
f.TextureSamplingMode.NEAREST,b.hasMipmap||(l=f.TextureSamplingMode.NEAREST);a.texParameteri(b.target,a.TEXTURE_MAG_FILTER,h);a.texParameteri(b.target,a.TEXTURE_MIN_FILTER,l)};e._applyWrapMode=function(a,b){"number"===typeof b.wrapMode?(a.texParameteri(b.target,a.TEXTURE_WRAP_S,b.wrapMode),a.texParameteri(b.target,a.TEXTURE_WRAP_T,b.wrapMode)):(a.texParameteri(b.target,a.TEXTURE_WRAP_S,b.wrapMode.s),a.texParameteri(b.target,a.TEXTURE_WRAP_T,b.wrapMode.t))};e._applyAnisotropicFilteringParameters=function(a,
b){var h;const l=a.capabilities.textureFilterAnisotropic;l&&a.gl.texParameterf(b.target,l.TEXTURE_MAX_ANISOTROPY,null!=(h=b.maxAnisotropy)?h:1)};u._createClass(e,[{key:"glName",get:function(){return this._glName}},{key:"descriptor",get:function(){return this._descriptor}},{key:"isDirty",get:function(){return this._samplingModeDirty||this._wrapModeDirty}}]);return e}();E.TEXTURE_UNIT_FOR_UPDATES=0;r.Texture=E;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/webgl/checkWebGLError":function(){define(["exports","../../core/Error","../../core/has","../../core/Logger"],function(r,u,E,C){function v(f,k){switch(k){case f.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case f.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case f.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case f.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";
case f.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case f.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}const z=C.getLogger("esri/views/webgl"),x=!!E("enable-feature:webgl-debug");r.checkWebGLError=function(f){if(x){const k=f.getError();k&&(f=v(f,k),z.error(new u("webgl-error","WebGL error occured",{message:f,stack:Error().stack})))}};r.hasFeatureFlagWebGLDebug=x;r.webglDebugEnabled=function(){return x};r.webglValidateShadersEnabled=
function(){return x};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/context-util":function(){define(["exports","../../core/has","../../core/maybe"],function(r,u,E){function C(f){const k=u("esri-force-webgl");if(k===r.ContextType.WEBGL1||k===r.ContextType.WEBGL2)return[k];switch(f){case "2d":return u("mac")&&u("chrome")?[r.ContextType.WEBGL1,r.ContextType.WEBGL2]:[r.ContextType.WEBGL2,r.ContextType.WEBGL1];case "3d":return[r.ContextType.WEBGL2,
r.ContextType.WEBGL1]}}function v(f,k,g={}){if(!window.WebGLRenderingContext)return x(f,'This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e'),null;k=z(f,k,g);E.isNone(k)&&x(f,'It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e');return k}function z(f,k,g={}){k=k===r.ContextType.WEBGL1?["webgl",
"experimental-webgl","webkit-3d","moz-webgl"]:["webgl2"];let m=null;for(const p of k){try{m=f.getContext(p,g)}catch(t){}if(m)break}return m}function x(f,k){(f=f.parentNode)&&(f.innerHTML='\x3ctable style\x3d"background-color: #8CE; width: 100%; height: 100%;"\x3e\x3ctr\x3e\x3ctd align\x3d"center"\x3e\x3cdiv style\x3d"display: table-cell; vertical-align: middle;"\x3e\x3cdiv style\x3d""\x3e'+k+"\x3c/div\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e")}r.ContextType=void 0;(function(f){f[f.WEBGL1=
1]="WEBGL1";f[f.WEBGL2=2]="WEBGL2"})(r.ContextType||(r.ContextType={}));r.createContext=z;r.createContextOrErrorHTML=function(f,k,g={}){for(f=C(f);1<f.length;){const m=z(k,f.shift(),g);if(E.isSome(m))return m}return v(k,f.shift(),g)};r.getContextTypes=C;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/capabilities/isWebGL2Context":function(){define(function(){return function(r){return window.WebGL2RenderingContext&&r instanceof window.WebGL2RenderingContext}})},
"esri/views/2d/engine/webgl/util/debug":function(){define(["exports"],function(r){r.DEBUG_ATTR_UPDATES=!1;r.createDebugLogger=(u,E)=>u&&((...C)=>E.warn("DEBUG:",...C))||(()=>null);Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../engine/webgl/color ../../../../engine/webgl/definitions ../../../../engine/webgl/enums ../../../../engine/webgl/visualVariablesUtils".split(" "),
function(r,u,E,C,v,z,x){function f(c){return{value:c.value,size:E.toPt(c.size)}}function k(c){return c.map(a=>f(a))}function g(c){return"string"===typeof c||"number"===typeof c?E.toPt(c):{type:"size",expression:c.expression,stops:k(c.stops)}}function m(c){const a={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if("string"===typeof c.field)if(c.stops){if(8<c.stops.length)return null;c=c.stops;for(var b=0;8>b;++b){const h=c[Math.min(b,c.length-1)];a.values[b]=h.value;a.opacities[b]=h.opacity}}else return null;
else if(c.stops&&0<=c.stops.length)for(c=c.stops&&0<=c.stops.length&&c.stops[0].opacity,b=0;8>b;b++)a.values[b]=Infinity,a.opacities[b]=c;else return null;return a}function p(c,a,b){c[4*a]=b.r/255;c[4*a+1]=b.g/255;c[4*a+2]=b.b/255;c[4*a+3]=b.a}function t(c){if(u.isNone(c)||c.normalizationField)return null;const a={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if("string"===typeof c.field)if(c.stops){if(8<c.stops.length)return null;a.field=
c.field;c=c.stops;for(var b=0;8>b;++b){const h=c[Math.min(b,c.length-1)];a.values[b]=h.value;p(a.colors,b,h.color)}}else return null;else if(c.stops&&0<=c.stops.length)for(c=c.stops&&0<=c.stops.length&&c.stops[0].color,b=0;8>b;b++)a.values[b]=Infinity,p(a.colors,b,c);else return null;for(c=0;32>c;c+=4)C.premultiplyAlpha(a.colors,c,!0);return a}const e=c=>{const a=[],b=[];c=k(c);const h=c.length;for(let l=0;6>l;l++){const d=c[Math.min(l,h-1)];a.push(d.value);b.push(null==d.size?v.NAN_MAGIC_NUMBER:
E.pt2px(d.size))}return{values:new Float32Array(a),sizes:new Float32Array(b)}};r.convertColorVariable=t;r.convertVisualVariables=function(c){const a=c&&0<c.length?{}:null,b=a?{}:null;if(!a)return{vvFields:a,vvRanges:b};for(const h of c)if(h.field&&(a[h.type]=h.field),"size"===h.type)switch(b.size||(b.size={}),c=h,x.getTypeOfSizeVisualVariable(c)){case z.WGLVVFlag.SIZE_MINMAX_VALUE:b.size.minMaxValue={minDataValue:c.minDataValue,maxDataValue:c.maxDataValue,minSize:g(c.minSize),maxSize:g(c.maxSize)};
break;case z.WGLVVFlag.SIZE_SCALE_STOPS:b.size.scaleStops={stops:k(c.stops)};break;case z.WGLVVFlag.SIZE_FIELD_STOPS:if(c.levels){const l={};for(const d in c.levels)l[d]=e(c.levels[d]);b.size.fieldStops={type:"level-dependent",levels:l}}else b.size.fieldStops={type:"static",...e(c.stops)};break;case z.WGLVVFlag.SIZE_UNIT_VALUE:b.size.unitValue={unit:c.valueUnit,valueRepresentation:c.valueRepresentation}}else"color"===h.type?b.color=t(h):"opacity"===h.type?b.opacity=m(h):"rotation"===h.type&&(b.rotation=
{type:h.rotationType});return{vvFields:a,vvRanges:b}};r.getVisualVariableSizeValueRepresentationRatio=function(c,a){if(!c||!a)return c;switch(a){case "radius":case "distance":return 2*c;case "area":return Math.sqrt(c)}return c};r.getVisualVariablesFields=function(c){const a=c&&0<c.length?{}:null;a&&c.forEach(b=>{const h=b.type;b.field&&(a[h]=b.field)});return a};r.normalizeSizeElement=g;r.normalizeSizeStops=k;r.stopToSizeStop=f;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define(["exports","../../../../core/Error","../../../../core/Logger","./enums","./Utils"],function(r,u,E,C,v){const z=E.getLogger("esri.views.2d.engine.webgl");r.getTypeOfSizeVisualVariable=function(x){if(v.isNumber(x.minDataValue)&&v.isNumber(x.maxDataValue)&&null!=x.minSize&&null!=x.maxSize)return C.WGLVVFlag.SIZE_MINMAX_VALUE;if((x.expression&&"view.scale"===x.expression||x.valueExpression&&"$view.scale"===x.valueExpression)&&Array.isArray(x.stops))return C.WGLVVFlag.SIZE_SCALE_STOPS;
if((null!=x.field||x.expression&&"view.scale"!==x.expression||x.valueExpression&&"$view.scale"!==x.valueExpression)&&(Array.isArray(x.stops)||"levels"in x&&x.levels))return C.WGLVVFlag.SIZE_FIELD_STOPS;if((null!=x.field||x.expression&&"view.scale"!==x.expression||x.valueExpression&&"$view.scale"!==x.valueExpression)&&null!=x.valueUnit)return C.WGLVVFlag.SIZE_UNIT_VALUE;z.error(new u("mapview-bad-type","Found invalid size VisualVariable",x));return C.WGLVVFlag.NONE};Object.defineProperties(r,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/BinStore":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/accessorSupport/diffUtils ../../../../../geohash/GeohashTree ../../../../../geohash/geohashUtils ../../../../../geometry/support/Ellipsoid ../../../../../geometry/support/spatialReferenceUtils ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ../../../../../layers/graphics/OptimizedGeometry ../../../../../layers/graphics/data/projectionSupport ../../../engine/webgl/DisplayId ../Store2D ./FeatureSetReaderJSON ../../../../../geometry/SpatialReference ../../../../../geometry/Polygon ../../../../../geometry/Extent".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t,e,c,a,b,h,l,d,q){const n=v.getLogger("esri.view.2d.layers.features.support.BinStore");E=function(B){function A(y,D,F,G){var K=B.call(this,y,F)||this;K._geohashLevel=5;K._geohashBuf=[];K._serviceInfo=G;K.geometryInfo=y.geometryInfo;K._spatialReference=D;K._projectionSupportCheck=c.checkProjectionSupport(D,l.WGS84);K._bitsets.geohash=F.getBitset(F.createBitset());K._bitsets.inserted=F.getBitset(F.createBitset());return K}u._inheritsLoose(A,B);var w=A.prototype;w.destroy=
function(){this._tree&&this._tree.destroy()};w.updateSchema=function(){var y=u._asyncToGenerator(function*(D,F){const G=this._schema;try{yield B.prototype.updateSchema.call(this,D,F),yield this._projectionSupportCheck}catch(J){}const K=x.diff(G,F);if(!F||z.isNone(K)&&!D.source&&!D.storage.filters)G&&(D.mesh=!0);else{if(x.hasDiff(K,"params.fields")||x.hasDiff(K,"params")||!this._tree||D.source)this._tree&&this._tree.destroy(),this._tree=new f.GeohashTree(this._statisticFields,this._serviceInfo),this._tree.onRelease=
J=>J.displayId&&this._storage.releaseDisplayId(J.displayId),this._geohashLevel=this._schema.params.fixedBinLevel,this._rebuildTree(),C("esri-2d-update-debug")&&n.info("Aggregate mesh needs update due to tree changing");C("esri-2d-update-debug")&&n.info("Aggregate mesh needs update due to tree changing");D.targets[F.name]=!0;D.mesh=!1}});return function(D,F){return y.apply(this,arguments)}}();w.clear=function(){this._rebuildTree()};w.sweepFeatures=function(y,D){this._bitsets.inserted.forEachSet(F=>
{y.has(F)||(F=D.lookupByDisplayIdUnsafe(F),this._remove(F))})};w.sweepAggregates=function(y,D,F){};w.onTileData=function(y,D,F,G,K=!0){if(!this._schema||z.isNone(D.addOrUpdate))return D;var J=this._getTransforms(y,this._spatialReference);{const I=D.addOrUpdate.getCursor();for(;I.next();)this._update(I,G)}if(D.status.mesh||!K)return D;G=[];this._getBinsForTile(G,y,J,F);D.addOrUpdate=h.FeatureSetReaderJSON.fromOptimizedFeatures(G,{...this._serviceInfo,geometryType:"esriGeometryPolygon"});D.addOrUpdate.attachStorage(F);
D.clear=!0;D.end=!0;for(J=D.addOrUpdate.getCursor();J.next();)G=J.getDisplayId(),this._bitsets.computed.unset(G),this.setComputedAttributes(F,J,G,y.scale);return D};w.forEach=function(y){this._tree.forEach(y)};w.onTileUpdate=function(y){};w.getAggregate=function(y){const D=a.createDisplayId(y,!0);y=this._tree.findIf(F=>F.displayId===D);return z.applySome(y,F=>this._toAggregateGraphic(F))};w.getAggregates=function(){return this._tree.findAllIf(y=>y.depth===this._geohashLevel).map(this._toAggregateGraphic.bind(this))};
w.getDisplayId=function(y){const D=this._tree.findIf(F=>F.id===y);return z.applySome(D,F=>F.displayId)};w.getFeatureDisplayIdsForAggregate=function(y){const D=this._tree.findIf(F=>F.id===y);return z.mapOr(D,[],F=>Array.from(F.displayIds))};w.getDisplayIdForReferenceId=function(y){const D=this._tree.findIf(F=>1===F.displayIds.size&&F.displayIds.has(y));return z.applySome(D,F=>F.displayId)};w._toAggregateGraphic=function(y){const D=this._spatialReference;return{referenceId:null,objectId:y.id,displayId:y.displayId,
attributes:y.getAttributes(),geometry:p.convertToGeometry(y.getGeometry(D),"esriGeometryPolygon",!1,!1),centroid:null}};w._rebuildTree=function(){this._bitsets.computed.clear();this._bitsets.inserted.clear();this._tree&&this._tree.clear()};w._remove=function(y){const D=y.getDisplayId(),F=y.getXHydrated(),G=y.getYHydrated(),K=this._geohashBuf[2*D],J=this._geohashBuf[2*D+1];this._bitsets.inserted.has(D)&&(this._bitsets.inserted.unset(D),this._tree.removeCursor(y,F,G,K,J,this._geohashLevel))};w._update=
function(y,D){const F=y.getDisplayId(),G=this._bitsets.inserted;D=D.isVisible(F);var K=G.has(F);D!==K&&(D?(D=y.getXHydrated(),K=y.getYHydrated(),this._setGeohash(F,D,K)&&(this._tree.insertCursor(y,F,D,K,this._geohashBuf[2*F],this._geohashBuf[2*F+1],this._geohashLevel),G.set(F))):this._remove(y))};w._setGeohash=function(y,D,F){if(this._bitsets.geohash.has(y))return!0;const G=this._geohashBuf;if(this._spatialReference.isWebMercator)D=D/g.earth.radius*57.29577951308232,k.setGeohashBuf(G,y,57.29577951308232*
(Math.PI/2-2*Math.atan(Math.exp(-F/g.earth.radius))),D-360*Math.floor((D+180)/360),12);else{F=c.project({x:D,y:F},this._spatialReference,l.WGS84);if(!F)return!1;k.setGeohashBuf(G,y,F.y,F.x,12)}this._bitsets.geohash.set(y);return!0};w._getBinsForTile=function(y,D,F,G){try{const {xLL:K,yLL:J,xTR:I,yTR:H,level:M}=this._getGeohashBounds(D),N=this._tree.getBins(K,J,I,H,M);for(const P of N){P.displayId||(P.displayId=G.createDisplayId(!0));const ba=P.getGeometry(this._spatialReference,F.tile),X=new t.OptimizedFeature(ba,
P.getAttributes());X.objectId=P.id;X.displayId=P.displayId;y.push(X)}}catch(K){n.error("Unable to get bins for tile",D.key.id)}};w._getGeohash=function(y,D,F){const G={geohashX:0,geohashY:0};k.setGeohashXY(G,D,y,F);return G};w._getGeohashBounds=function(y){const D=this._getGeohashLevel(y.key.level);var F=d.fromExtent(q.fromBounds([y.extent.xmin,y.extent.ymin,y.extent.xmax,y.extent.ymax],this._spatialReference));y=c.project(F,this._spatialReference,l.WGS84,{densificationStep:64*y.resolution});y=p.convertFromPolygon(new e,
y,!1,!1);var G=y.coords.filter((J,I)=>!(I%2)),K=y.coords.filter((J,I)=>I%2);y=Math.min(...G);F=Math.min(...K);G=Math.max(...G);K=Math.max(...K);y=this._getGeohash(y,F,D);F=this._getGeohash(G,K,D);return{xLL:y.geohashX,yLL:y.geohashY,xTR:F.geohashX,yTR:F.geohashY,level:D}};w._getGeohashLevel=function(y){return this._schema.params.fixedBinLevel};w._getTransforms=function(y,D){const F={originPosition:"upperLeft",scale:[y.resolution,y.resolution],translate:[y.bounds[0],y.bounds[3]]};D=m.getInfo(D);if(!D)return{tile:F,
left:null,right:null};const [G,K]=D.valid;return{tile:F,left:{...F,translate:[K,y.bounds[3]]},right:{...F,translate:[G-K+y.bounds[0],y.bounds[3]]}}};return A}(b.Store2D);r.BinStore=E;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geohash/GeohashTree":function(){define("exports ../chunks/_rollupPluginBabelHelpers ../core/CircularArray ../core/maybe ./geohashUtils ../geometry/SpatialReference ../layers/graphics/featureConversionUtils ../layers/graphics/OptimizedGeometry ../layers/graphics/data/projectionSupport ../views/2d/layers/features/support/FeatureSetReaderJSON".split(" "),
function(r,u,E,C,v,z,x,f,k,g){let m=function(){function t(c=[],a,b=8096){this.onRelease=h=>{};this._nodes=0;this._root=new p(this,0,0,0);this._statisticFields=c;this._pool=b?new E(8096):null;this._serviceInfo=a}var e=t.prototype;e.destroy=function(){this.clear()};e._acquire=function(c,a,b){this._nodes++;let h=null;C.isSome(this._pool)&&(h=this._pool.dequeue());C.isSome(h)?h.realloc(c,a,b):h=new p(this,c,a,b);return h};e._release=function(c){this.onRelease(c);this._nodes--;C.isSome(this._pool)&&this._pool.enqueue(c)};
e.dropLevels=function(c){this.forEach(a=>{if(a.depth>=c)for(let b=0;b<a.children.length;b++){const h=a.children[b];h&&this._release(h)}});this.forEach(a=>{if(a.depth>=c)for(let b=0;b<a.children.length;b++)a.children[b]=null})};e.clear=function(){this.forEach(c=>this._release(c));this._root=new p(this,0,0,0)};e.insert=function(c,a,b=0){const h=g.FeatureSetReaderJSON.fromOptimizedFeatures([c],this._serviceInfo).getCursor();h.next();const l=h.readGeometry();if(l){var [d,q]=l.coords;this.insertCursor(h,
c.displayId,d,q,c.geohashX,c.geohashY,a,b)}};e.insertCursor=function(c,a,b,h,l,d,q,n=0){let B=this._root,A=0,w=0,y=0;for(;null!==B;){B.depth>=n&&(B.count+=1,B.xTotal+=b,B.yTotal+=h,B.xGeohashTotal+=l,B.yGeohashTotal+=d,B.referenceId=a,this._updateStatisticsCursor(c,B,1));if(A>=q){B.add(a);break}var D=Math.ceil((A+1)/2),F=Math.floor((A+1)/2);const K=1-A%2;var G=30-(3*D+2*F);D=30-(2*D+3*F);G=(l&7*K+3*(1-K)<<G)>>G;D=(d&3*K+7*(1-K)<<D)>>D;F=G+D*(8*K+4*(1-K));const J=2*K+3*(1-K);w=w<<3*K+2*(1-K)|G;y=y<<
J|D;null==B.children[F]&&(B.children[F]=this._acquire(w,y,A+1));A+=1;B=B.children[F]}};e.remove=function(c,a){const b=g.FeatureSetReaderJSON.fromOptimizedFeatures([c],this._serviceInfo).getCursor();b.next();const h=b.readGeometry();if(h){var [l,d]=h.coords;this.removeCursor(b,l,d,c.geohashX,c.geohashY,a)}};e.removeCursor=function(c,a,b,h,l,d){let q=this._root,n=0;for(;null!==q;){--q.count;q.xTotal-=a;q.yTotal-=b;q.xGeohashTotal-=h;q.yGeohashTotal-=l;this._updateStatisticsCursor(c,q,-1);if(n>=d){q.remove(c.getDisplayId());
break}var B=Math.ceil((n+1)/2);const y=Math.floor((n+1)/2);var A=1-n%2,w=30-(3*B+2*y);B=30-(2*B+3*y);A=((h&7*A+3*(1-A)<<w)>>w)+((l&3*A+7*(1-A)<<B)>>B)*(8*A+4*(1-A));w=q.children[A];1===w.count&&(this._release(w),q.children[A]=null);n+=1;q=w}};e.forEach=function(c){let a=this._root;for(;null!==a;){const b=this._linkChildren(a)||a.next;c(a);a=b}};e.find=function(c,a,b){return this._root.find(c,a,b,0,0,0)};e.findIf=function(c){let a=null;this.forEach(b=>{c(b)&&(a=b)});return a};e.findAllIf=function(c){const a=
[];this.forEach(b=>{c(b)&&a.push(b)});return a};e.findSingleOccupancyNode=function(c,a,b,h,l){let d=this._root;for(;null!==d;){var q=d.depth,n=d.xNode,B=d.yNode;const G=1-q%2;var A=d.xGeohashTotal/d.count,w=d.yGeohashTotal/d.count;if(1===d.count&&c<A&&A<=b&&a<w&&w<=h)return d;if(q>=l)d=d.next;else{w=Math.ceil((q+1)/2);q=Math.floor((q+1)/2);A=30-(3*w+2*q);var y=30-(2*w+3*q),D=~((1<<A)-1),F=~((1<<y)-1);n<<=3*G+2*(1-G);B<<=2*G+3*(1-G);q=Math.max(n,(c&D)>>A);w=Math.max(B,(a&F)>>y);A=Math.min(n+8*G+4*
(1-G),(b&D)>>A);y=Math.min(B+4*G+8*(1-G),(h&F)>>y);for(D=F=null;w<=y;w++)for(let K=q;K<=A;K++){const J=d.children[K-n+(w-B)*(8*G+4*(1-G))];J&&(F||(F=J,F.next=d.next),D&&(D.next=J),D=J,J.next=d.next)}d=F||d.next}}return null};e.getRegionDisplayIds=function(c,a,b,h,l){let d=this._root;const q=[];for(;null!==d;){var n=d.depth,B=d.xNode,A=d.yNode;if(n>=l)n=d.xGeohashTotal/d.count,B=d.yGeohashTotal/d.count,c<=n&&n<=b&&a<=B&&B<=h&&d.displayIds.forEach(J=>q.push(J)),d=d.next;else{var w=Math.ceil((n+1)/2),
y=Math.floor((n+1)/2);n=1-n%2;var D=30-(3*w+2*y),F=30-(2*w+3*y),G=~((1<<D)-1),K=~((1<<F)-1);B<<=3*n+2*(1-n);A<<=2*n+3*(1-n);w=Math.max(B,(c&G)>>D);y=Math.max(A,(a&K)>>F);D=Math.min(B+8*n+4*(1-n),(b&G)>>D);F=Math.min(A+4*n+8*(1-n),(h&K)>>F);for(G=K=null;y<=F;y++)for(let J=w;J<=D;J++){const I=d.children[J-B+(y-A)*(8*n+4*(1-n))];I&&(K||(K=I,K.next=d.next),G&&(G.next=I),G=I,I.next=d.next)}d=K||d.next}}return q};e.getRegionStatistics=function(c,a,b,h,l){let d=this._root,q=0,n=0,B=0;const A={};let w=0;
for(;null!==d;){var y=d.depth,D=d.xNode,F=d.yNode;if(y>=l)y=d.xGeohashTotal/d.count,D=d.yGeohashTotal/d.count,c<y&&y<=b&&a<D&&D<=h&&(q+=d.count,n+=d.xTotal,B+=d.yTotal,1===d.count&&(w=d.referenceId),this._aggregateStatistics(A,d.statistics)),d=d.next;else{var G=Math.ceil((y+1)/2),K=Math.floor((y+1)/2);y=1-y%2;var J=30-(3*G+2*K),I=30-(2*G+3*K),H=~((1<<J)-1),M=~((1<<I)-1);D<<=3*y+2*(1-y);F<<=2*y+3*(1-y);G=Math.max(D,(c&H)>>J);K=Math.max(F,(a&M)>>I);J=Math.min(D+8*y+4*(1-y),(b&H)>>J);I=Math.min(F+4*
y+8*(1-y),(h&M)>>I);H=M=null;for(let N=K;N<=I;N++)for(let P=G;P<=J;P++){const ba=d.children[P-D+(N-F)*(8*y+4*(1-y))];if(ba)if(N!==K&&N!==I&&P!==G&&P!==J){const X=ba.xGeohashTotal/ba.count,S=ba.yGeohashTotal/ba.count;c<X&&X<=b&&a<S&&S<=h&&(q+=ba.count,n+=ba.xTotal,B+=ba.yTotal,1===d.count&&(w=d.referenceId),this._aggregateStatistics(A,ba.statistics))}else M||(M=ba,M.next=d.next),H&&(H.next=ba),H=ba,ba.next=d.next}d=M||d.next}}c=this.normalizeStatistics(A,q);return{count:q,attributes:c,xTotal:n,yTotal:B,
referenceId:w}};e.getBins=function(c,a,b,h,l){const d=[];let q=this._root;for(;null!==q;){var n=q.depth,B=q.xNode,A=q.yNode;if(n>=l)d.push(q),q=q.next;else{var w=Math.ceil((n+1)/2),y=Math.floor((n+1)/2);n=1-n%2;var D=30-(3*w+2*y),F=30-(2*w+3*y),G=~((1<<D)-1),K=~((1<<F)-1);B<<=3*n+2*(1-n);A<<=2*n+3*(1-n);w=Math.max(B,(c&G)>>D);y=Math.max(A,(a&K)>>F);D=Math.min(B+8*n+4*(1-n),(b&G)>>D);F=Math.min(A+4*n+8*(1-n),(h&K)>>F);for(G=K=null;y<=F;y++)for(let J=w;J<=D;J++){const I=q.children[J-B+(y-A)*(8*n+4*
(1-n))];I&&(K||(K=I,K.next=q.next),G&&(G.next=I),G=I,I.next=q.next)}q=K||q.next}}return d};e._linkChildren=function(c){let a=null,b=null;for(let h=0;h<=c.children.length;h++){const l=c.children[h];l&&(a||(a=l,a.next=c.next),b&&(b.next=l),b=l,l.next=c.next)}return a};e._updateStatisticsCursor=function(c,a,b){for(const q of this._statisticFields){const n=q.name,B=q.inField?c.readAttribute(q.inField):c.getComputedNumericAtIndex(q.inFieldIndex);switch(q.statisticType){case "norm":a.statistics[n]||(a.statistics[n]=
{});var h=c.readAttribute(q.inNormalizationField),l=a.statistics[n].onStatisticField||0,d=a.statistics[n].onStatisticNormalizationField||0;null==B||isNaN(B)||null==h||0===h||isNaN(h)||(a.statistics[n].onStatisticField=l+b*B,a.statistics[n].onStatisticNormalizationField=d+b*h);break;case "sum":case "avg":a.statistics[n]||(a.statistics[n]={value:0,nanCount:0});h=a.statistics[n].value;l=a.statistics[n].nanCount;null==B||isNaN(B)?a.statistics[n].nanCount=l+b:a.statistics[n].value=h+b*B;break;case "avg_angle":{a.statistics[n]||
(a.statistics[n]={x:0,y:0,nanCount:0});h=a.statistics[n].x;l=a.statistics[n].y;d=a.statistics[n].nanCount;const A=Math.PI/180;null==B||isNaN(B)?a.statistics[n].nanCount=d+b:(a.statistics[n].x=h+b*Math.cos(B*A),a.statistics[n].y=l+b*Math.sin(B*A));break}case "mode":a.statistics[n]||(a.statistics[n]={}),a.statistics[n][B]=(a.statistics[n][B]||0)+b}}};e._aggregateStatistics=function(c,a){for(const b of this._statisticFields){const h=b.name;switch(b.statisticType){case "sum":case "avg":case "avg_angle":case "mode":case "norm":c[h]||
(c[h]={});for(const l in a[h])c[h][l]=(c[h][l]||0)+a[h][l]}}};e.normalizeStatistics=function(c,a){const b={};for(const l of this._statisticFields){const d=l.name;switch(l.statisticType){case "norm":var h=c[d];if(a&&null==h.onStatisticNormalizationField)break;if(a&&h.onStatisticNormalizationField){b[d]=h.onStatisticField/h.onStatisticNormalizationField;break}b[d]=0;break;case "sum":{if(!a)break;const {value:q,nanCount:n}=c[d];if(!(a-n))break;b[d]=q;break}case "avg":{if(!a)break;const {value:q,nanCount:n}=
c[d];if(!(a-n))break;b[d]=q/(a-n);break}case "avg_angle":{if(!a)break;const {x:q,y:n,nanCount:B}=c[d];if(!(a-B))break;b[d]=180/Math.PI*Math.atan2(n/(a-B),q/(a-B));break}case "mode":{h=c[d];let q=0,n=null;for(const B in h){const A=h[B];A>q&&(q=A,n=B)}b[d]="null"===n?null:n}}}return b};u._createClass(t,[{key:"count",get:function(){return this._root.count}},{key:"size",get:function(){return this._nodes}},{key:"poolSize",get:function(){return C.mapOr(this._pool,0,c=>c.size)}},{key:"depth",get:function(){let c=
0;this.forEach(a=>c=Math.max(c,a.depth));return c}}]);return t}(),p=function(){function t(c,a,b,h){this.yTotal=this.xTotal=this.count=0;this.statistics={};this.referenceId=this.displayId=0;this.displayIds=new Set;this.next=null;this.yGeohashTotal=this.xGeohashTotal=this.yNode=this.xNode=this.depth=0;this._tree=c;this.children=Array(32);for(c=0;c<this.children.length;c++)this.children[c]=null;this.xNode=a;this.yNode=b;this.depth=h}var e=t.prototype;e.realloc=function(c,a,b){for(let h=0;h<this.children.length;h++)this.children[h]=
null;this.xNode=c;this.yNode=a;this.depth=b;this.next=null;this.count=this.yTotal=this.xTotal=this.referenceId=this.displayId=this.yGeohashTotal=this.xGeohashTotal=0;this.statistics={};this.displayIds.clear();return this};e.add=function(c){this.displayIds.add(c)};e.remove=function(c){this.displayIds.delete(c)};e.getAttributes=function(){const c=this._tree.normalizeStatistics(this.statistics,this.count);c.aggregateId=this.id;c.aggregateCount=this.count;return c};e.getGeometry=function(c,a){const b=
this.getLngLatBounds(),[h,l,d,q]=b;c=k.project({rings:[[[h,l],[h,q],[d,q],[d,l],[h,l]]]},z.WGS84,c);c=x.convertFromPolygon(new f,c,!1,!1);return C.isSome(a)?x.quantizeOptimizedGeometry(new f,c,!1,!1,"esriGeometryPolygon",a,!1,!1):c};e.getLngLatBounds=function(){var c=this.depth;const a=Math.ceil(c/2);c=Math.floor(c/2);return v.decodeGeohashXY({geohashX:this.xNode<<30-(3*a+2*c),geohashY:this.yNode<<30-(2*a+3*c)},this.depth)};e.find=function(c,a,b,h,l,d){if(h>=b)return this;var q=1-h%2;const n=3*q+
2*(1-q),B=2*q+3*(1-q),A=30-l-n,w=30-d-B;q=this.children[((c&7*q+3*(1-q)<<A)>>A)+((a&3*q+7*(1-q)<<w)>>w)*(8*q+4*(1-q))];return null==q?null:q.find(c,a,b,h+1,l+n,d+B)};u._createClass(t,[{key:"id",get:function(){return`${this.xNode}.${this.yNode}`}}]);return t}();r.GeohashNode=p;r.GeohashTree=m;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geohash/geohashUtils":function(){define(["exports"],function(r){function u(c){return 57>=c?c-48:104>=c?c-88:107>=
c?c-89:110>=c?c-90:c-91}function E(c,a,b){c[0]=a;c[1]=b;return c}function C(c,a){const b=(c[0]+c[1])/2,h=!a;c[0]=h*c[0]+a*b;c[1]=h*b+a*c[1]}function v(c,a){a=a>(c[0]+c[1])/2;C(c,a);return a}function z(c,a){const b=E(t,-90,90),h=E(e,-180,180);for(let d=0;d<a.length;d++){var l=a.charCodeAt(d);l=u(l);0===d%2?(C(h,!!(16&l)),C(h,!!(4&l)),C(h,!!(1&l)),C(b,!!(8&l)),C(b,!!(2&l))):(C(b,!!(16&l)),C(b,!!(4&l)),C(b,!!(1&l)),C(h,!!(8&l)),C(h,!!(2&l)))}c[0]=(b[0]+b[1])/2;c[1]=(h[0]+h[1])/2;return c}function x(c,
a,b){let h="";const l=E(t,-90,90),d=E(e,-180,180);for(let q=0;q<b;q++){let n=0;q%2?(n|=v(l,c)<<4,n|=v(d,a)<<3,n|=v(l,c)<<2,n|=v(d,a)<<1,n|=v(l,c)<<0):(n|=v(d,a)<<4,n|=v(l,c)<<3,n|=v(d,a)<<2,n|=v(l,c)<<1,n|=v(d,a)<<0);h+="0123456789bcdefghjkmnpqrstuvwxyz"[n]}return h}function f(c){return 180/2**Math.floor(5*c/2)}function k(c){return 360/2**Math.ceil(5*c/2)}function g(c,a){return a?1&c|(4&c)>>1|(16&c)>>2:(2&c)>>1|(8&c)>>2}function m(c,a){return a?(2&c)>>1|(8&c)>>2:1&c|(4&c)>>1|(16&c)>>2}function p(c,
a,b){var h=!((c.length-1)%2);const l=c.substring(0,c.length-1);var d=u(c.charCodeAt(c.length-1)),q=0,n=0;let B=0;var A=0;h?(q=8,n=4,B=1&d|(4&d)>>1|(16&d)>>2,A=(2&d)>>1|(8&d)>>2):(q=4,n=8,A=1&d|(4&d)>>1|(16&d)>>2,B=(2&d)>>1|(8&d)>>2);a=B+a;d=A+b;b=Math.floor(a/q);A=Math.floor(d/n);q=a-b*q;n=d-A*n;h="0123456789bcdefghjkmnpqrstuvwxyz"[h?q&1|(n&1)<<1|(q&2)<<1|(n&2)<<2|(q&4)<<2:n&1|(q&1)<<1|(n&2)<<1|(q&2)<<2|(n&4)<<2];return 1<c.length&&(b||A)?p(l,b,A)+h:l+h}const t=new Float64Array(2),e=new Float64Array(2);
r.convertGeohash32ToXY=function(c,a){let b=c=0,h=30,l=30;for(let n=0;n<a.length;n++){var d=a.charCodeAt(n),q=u(d);d=0===n%2;const B=g(q,d);q=m(q,d);h-=d?3:2;l-=d?2:3;c|=B<<h;b|=q<<l}return{geohashX:c,geohashY:b}};r.decodeBase32Char=u;r.decodeGeohash=z;r.decodeGeohashXY=function(c,a){let b=-90,h=90,l=-180,d=180;for(let y=0;y<a;y++){var q=Math.ceil((y+1)/2),n=Math.floor((y+1)/2),B=1-y%2,A=30-(3*q+2*n),w=30-(2*q+3*n);n=3*B+2*(1-B);q=2*B+3*(1-B);A=(7*B+3*(1-B)<<A&c.geohashX)>>A;B=(3*B+7*(1-B)<<w&c.geohashY)>>
w;for(--n;0<=n;n--){w=(l+d)/2;const D=A&1<<n?1:0;l=(1-D)*l+D*w;d=(1-D)*w+D*d}for(--q;0<=q;q--)A=(b+h)/2,n=B&1<<q?1:0,b=(1-n)*b+n*A,h=(1-n)*A+n*h}return[l,b,d,h]};r.encodeBase32Char=function(c){return"0123456789bcdefghjkmnpqrstuvwxyz"[c]};r.encodeGeohash=x;r.forEachIntersectingGeohash=function(c,a,b,h,l,d){var q=Math.abs(b-c),n=Math.abs(h-a);const B=f(l),A=k(l);n=Math.ceil(n/A);q=Math.ceil(q/B);l=x(c,a,l);for(let w=0;w<n;w++)for(let y=0;y<q;y++){const D=p(l,w,y),[F,G]=z([0,0],D);d(D,Math.abs((Math.min(b,
F+B/2)-Math.max(c,F-B/2))*(Math.min(h,G+A/2)-Math.max(a,G-A/2)))/(B*A))}};r.getIntersectingGeohashes=function(c,a,b,h,l){b=Math.abs(b-c);h=Math.abs(h-a);var d=f(l);const q=k(l);h=Math.ceil(h/q);b=Math.ceil(b/d);c=x(c,a,l);a=[];for(l=0;l<h;l++)for(d=0;d<b;d++)a.push(p(c,l,d));return a};r.getRelativeGeohash=p;r.latDistPerGeohash=f;r.lonDistPerGeohash=k;r.setGeohashBuf=function(c,a,b,h,l){l%2&&(l+=1);let d=0,q=0,n=-90,B=90,A=-180,w=180;for(let G=0;G<l/2;G++){for(var y=0;5>y;y++){var D=(A+w)/2,F=h>D?
1:0;d|=F<<29-(y+5*G);A=(1-F)*A+F*D;w=(1-F)*D+F*w}for(y=0;5>y;y++)D=(n+B)/2,F=b>D?1:0,q|=F<<29-(y+5*G),n=(1-F)*n+F*D,B=(1-F)*D+F*B}c[2*a]=d;c[2*a+1]=q};r.setGeohashXY=function(c,a,b,h){h%2&&(h+=1);let l=0,d=0,q=-90,n=90,B=-180,A=180;for(let F=0;F<h/2;F++){for(var w=0;5>w;w++){var y=(B+A)/2,D=b>y?1:0;l|=D<<29-(w+5*F);B=(1-D)*B+D*y;A=(1-D)*y+D*A}for(w=0;5>w;w++)y=(q+n)/2,D=a>y?1:0,d|=D<<29-(w+5*F),q=(1-D)*q+D*y,n=(1-D)*y+D*n}c.geohashX=l;c.geohashY=d};r.unpackXBits=g;r.unpackYBits=m;Object.defineProperties(r,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/ClusterStore":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry ../../../../../core/Evented ../../../../../core/has ../../../../../core/maybe ../../../../../core/accessorSupport/diffUtils ../../../../../geohash/GeohashTree ../../../../../geohash/geohashUtils ../../../../../geometry/support/Ellipsoid ../../../../../geometry/support/spatialReferenceUtils ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ../../../../../layers/graphics/OptimizedGeometry ../../../../../layers/graphics/data/projectionSupport ../../../engine/webgl/definitions ../../../engine/webgl/DisplayId ../Store2D ./FeatureSetReaderJSON ../../../../../geometry/SpatialReference".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t,e,c,a,b,h,l,d){let q=function(n){function B(w,y,D,F,G){y=new e([],[y,D]);w=n.call(this,y,F,null,w)||this;w.geohashBoundsInfo=G;return w}u._inheritsLoose(B,n);B.create=function(w,y,D,F,G,K,J,I){y=new B(y,D,F,K,J);y.displayId=w.createDisplayId(!0);y.referenceId=I;y.tileLevel=G;return y};var A=B.prototype;A.update=function(w,y,D,F,G,K){this.geometry.coords[0]=w;this.geometry.coords[1]=y;this.tileLevel=D;this.attributes=F;this.geohashBoundsInfo=G;this.referenceId=null;
this.referenceId=K;return this};A.toJSON=function(){return{objectId:this.objectId,referenceId:1===this.attributes.cluster_count?this.referenceId:null,attributes:{...this.attributes,clusterId:this.objectId},geometry:{x:this.geometry.coords[0],y:this.geometry.coords[1]}}};u._createClass(B,[{key:"count",get:function(){return this.attributes.cluster_count}}]);return B}(t.OptimizedFeatureWithGeometry);E=function(n){function B(w,y,D,F){var G=n.call(this,w,D)||this;G.events=new C;G._geohashLevel=0;G._tileLevel=
0;G._aggregateValueRanges={};G._aggregateValueRangesChanged=!1;G._geohashBuf=[];G._clusters=new Map;G._tiles=new Map;G._serviceInfo=F;G.geometryInfo=w.geometryInfo;G._spatialReference=y;G._projectionSupportCheck=c.checkProjectionSupport(y,d.WGS84);G._bitsets.geohash=D.getBitset(D.createBitset());G._bitsets.inserted=D.getBitset(D.createBitset());return G}u._inheritsLoose(B,n);var A=B.prototype;A.destroy=function(){this._tree.destroy()};A.updateSchema=function(){var w=u._asyncToGenerator(function*(y,
D){const F=this._schema;try{yield n.prototype.updateSchema.call(this,y,D),yield this._projectionSupportCheck}catch(K){}const G=x.diff(F,D);if(!D||z.isNone(G)&&!y.source&&!y.storage.filters)F&&(y.mesh=!0);else{if(x.hasDiff(G,"params.fields")||!this._tree||y.source)this._tree&&this._tree.destroy(),this._tree=new f.GeohashTree(this._statisticFields,this._serviceInfo),this._rebuildTree(),v("esri-2d-update-debug")&&console.debug("Aggregate mesh needs update due to tree changing");v("esri-2d-update-debug")&&
console.debug("Applying Update - ClusterStore:",G);y.targets[D.name]=!0;y.mesh=!1;this._aggregateValueRanges={}}});return function(y,D){return w.apply(this,arguments)}}();A.clear=function(){this._rebuildTree()};A.sweepFeatures=function(w,y){this._bitsets.inserted.forEachSet(D=>{w.has(D)||(D=y.lookupByDisplayIdUnsafe(D),this._remove(D))})};A.sweepAggregates=function(w,y,D){this._clusters.forEach((F,G)=>{F&&F.tileLevel!==D&&(w.releaseDisplayId(F.displayId),y.unsetAttributeData(F.displayId),this._clusters.delete(G))})};
A.onTileData=function(w,y,D,F,G=!0){if(!this._schema||z.isNone(y.addOrUpdate))return y;var K=this._getTransforms(w,this._spatialReference);{const J=y.addOrUpdate.getCursor();for(;J.next();)this._update(J,F)}if(y.status.mesh||!G)return y;F=[];this._getClustersForTile(F,w,this._schema.params.clusterRadius,D,K);y.addOrUpdate=l.FeatureSetReaderJSON.fromOptimizedFeatures(F,this._serviceInfo);y.addOrUpdate.attachStorage(D);y.clear=!0;y.end=!0;for(K=y.addOrUpdate.getCursor();K.next();)F=K.getDisplayId(),
this._bitsets.computed.unset(F),this.setComputedAttributes(D,K,F,w.scale);this._aggregateValueRangesChanged&&y.end&&(this.events.emit("valueRangesChanged",{valueRanges:this._aggregateValueRanges}),this._aggregateValueRangesChanged=!1);return y};A.onTileUpdate=function({added:w,removed:y}){w.length&&(this._tileLevel=w=w[0].level,this._setGeohashLevel(w));if(this._schema){var D=this._schema.params.clusterRadius;y.forEach(F=>{this._tiles.delete(F.key.id);this._markTileClustersForDeletion(F,D)})}};A.getAggregate=
function(w){for(const y of this._clusters.values())if(((null==y?NaN:y.displayId)&b.DISPLAY_ID_TEXEL_MASK)===(w&b.DISPLAY_ID_TEXEL_MASK))return y.toJSON();return null};A.getAggregates=function(){const w=[];for(const y of this._clusters.values())(null==y?void 0:y.tileLevel)===this._tileLevel&&w.push(y.toJSON());return w};A.getDisplayId=function(w){return(w=this._clusters.get(w))?w.displayId:null};A.getFeatureDisplayIdsForAggregate=function(w){w=this._clusters.get(w);if(!w)return[];w=w.geohashBoundsInfo;
return this._tree.getRegionDisplayIds(w.xLL,w.yLL,w.xTR,w.yTR,w.level)};A.getDisplayIdForReferenceId=function(w){for(const y of this._clusters.values())if((null==y?void 0:y.referenceId)===w)return y.displayId;return null};A.getAggregateValueRanges=function(){return this._aggregateValueRanges};A.forEach=function(w){for(const [y,D]of this._clusters)D&&w(D,y)};A.size=function(){let w=0;this.forEach(y=>w++);return w};A._rebuildTree=function(){this._bitsets.computed.clear();this._bitsets.inserted.clear();
this._tree&&this._tree.clear()};A._remove=function(w){const y=w.getDisplayId(),D=w.getXHydrated(),F=w.getYHydrated(),G=this._geohashBuf[2*y],K=this._geohashBuf[2*y+1];this._bitsets.inserted.has(y)&&(this._bitsets.inserted.unset(y),this._tree.removeCursor(w,D,F,G,K,this._geohashLevel))};A._update=function(w,y){const D=w.getDisplayId(),F=this._bitsets.inserted;y=y.isVisible(D);var G=F.has(D);y!==G&&(y?(y=w.getXHydrated(),G=w.getYHydrated(),this._setGeohash(D,y,G)&&(this._tree.insertCursor(w,D,y,G,this._geohashBuf[2*
D],this._geohashBuf[2*D+1],this._geohashLevel),F.set(D))):this._remove(w))};A._setGeohash=function(w,y,D){if(this._bitsets.geohash.has(w))return!0;const F=this._geohashBuf;if(this._spatialReference.isWebMercator)y=y/g.earth.radius*57.29577951308232,k.setGeohashBuf(F,w,57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-D/g.earth.radius))),y-360*Math.floor((y+180)/360),12);else{D=c.project({x:y,y:D},this._spatialReference,d.WGS84);if(!D)return!1;k.setGeohashBuf(F,w,D.y,D.x,12)}this._bitsets.geohash.set(w);
return!0};A._getClustersForTile=function(w,y,D,F,G,K=!0){var J=this._schema.params.clusterPixelBuffer,I=2*D;D=this._getGeohashLevel(y.key.level);const H=Math.ceil(2**y.key.level*a.TILE_SIZE/I);var M=Math.ceil(J/I)+0,N=Math.ceil(a.TILE_SIZE/I);const {row:P,col:ba}=y.key;var X=Math.floor(ba*a.TILE_SIZE/I)-M;I=Math.floor(P*a.TILE_SIZE/I)-M;J=X+N+2*M;M=I+N+2*M;for(N=y.tileInfoView.getLODInfoAt(y.key.level);X<=J;X++)for(let R=I;R<=M;R++){var S=X;N.wrap&&(S=0>X?X+H:X%H);const Z=N.wrap&&0>X,ka=N.wrap&&X%
H!==X;S=this._lookupCluster(F,N,y.key.level,S,R,D);if(z.isSome(S)){var W=z.applySome(G,ta=>Z?ta.left:ka?ta.right:ta.tile);if((!K||!z.isNone(W))&&S.count&&z.isSome(W)&&K){const ta=S.geometry.clone();let pa=S.attributes;ta.coords[0]=p.quantizeX(W,ta.coords[0]);ta.coords[1]=p.quantizeY(W,ta.coords[1]);1===S.count&&z.isSome(S.referenceId)&&(pa={...S.attributes,referenceId:S.referenceId});W=new t.OptimizedFeature(ta,pa);W.displayId=S.displayId;w.push(W)}}}};A._getGeohashLevel=function(w){return Math.min(Math.ceil(w/
2+2),12)};A._setGeohashLevel=function(w){w=this._getGeohashLevel(w);w=1*(Math.floor(w/1)+1)-1;this._geohashLevel!==w&&(this._geohashLevel=w,this._rebuildTree(),this._bitsets.geohash.clear())};A._getTransforms=function(w,y){const D={originPosition:"upperLeft",scale:[w.resolution,w.resolution],translate:[w.bounds[0],w.bounds[3]]};y=m.getInfo(y);if(!y)return{tile:D,left:null,right:null};const [F,G]=y.valid;return{tile:D,left:{...D,translate:[G,w.bounds[3]]},right:{...D,translate:[F-G+w.bounds[0],w.bounds[3]]}}};
A._getClusterId=function(w,y,D){return(w&15)<<28|(y&16383)<<14|D&16383};A._markForDeletion=function(w,y,D){w=this._getClusterId(w,y,D);this._clusters.delete(w)};A._getClusterBounds=function(w,y,D){var F=this._schema.params.clusterRadius,G=2*F;y=D%2?y*G:y*G-F;const K=D*G;F=y+G;D=2**w.level*a.TILE_SIZE;w.wrap&&0>y&&(y=0);w.wrap&&F>D&&(F=D);D=K/a.TILE_SIZE;F/=a.TILE_SIZE;G=(K-G)/a.TILE_SIZE;y=w.getXForColumn(y/a.TILE_SIZE);D=w.getYForRow(D);F=w.getXForColumn(F);w=w.getYForRow(G);return[y,D,F,w]};A._lookupCluster=
function(w,y,D,F,G,K){const J=this._getClusterId(D,F,G),I=this._clusters.get(J),[H,M,N,P]=this._getClusterBounds(y,F,G);var ba={x:H,y:M};G={x:N,y:P};var X=F=y=0,S=0;if(this._spatialReference.isWebMercator)y=ba.x/g.earth.radius*57.29577951308232,y-=360*Math.floor((y+180)/360),F=57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-ba.y/g.earth.radius))),X=G.x/g.earth.radius*57.29577951308232,X-=360*Math.floor((X+180)/360),S=57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-G.y/g.earth.radius)));else{F=
c.project(ba,this._spatialReference,d.WGS84);G=c.project(G,this._spatialReference,d.WGS84);if(!F||!G)return null;y=F.x;F=F.y;X=G.x;S=G.y}ba={geohashX:0,geohashY:0};G={geohashX:0,geohashY:0};k.setGeohashXY(ba,F,y,K);k.setGeohashXY(G,S,X,K);F=ba.geohashX;X=ba.geohashY;S=G.geohashX;G=G.geohashY;y={xLL:F,yLL:X,xTR:S,yTR:G,level:K};G=this._tree.getRegionStatistics(F,X,S,G,K);const {count:W,xTotal:R,yTotal:Z,referenceId:ka}=G;K=W?R/W:0;F=W?Z/W:0;if(0===W)return this._clusters.set(J,null),null;G={cluster_count:W,
...G.attributes};w=z.isSome(I)?I.update(K,F,D,G,y,ka):q.create(w,J,K,F,D,G,y,ka);0===W&&(w.geometry.coords[0]=(H+N)/2,w.geometry.coords[1]=(M+P)/2);this._clusters.set(J,w);this._updateAggregateValueRangeForCluster(w,w.tileLevel);return w};A._updateAggregateValueRangeForCluster=function(w,y){const D=this._aggregateValueRanges[y]||{minValue:Infinity,maxValue:0},F=D.minValue,G=D.maxValue;D.minValue=Math.min(F,w.count);D.maxValue=Math.max(G,w.count);this._aggregateValueRanges[y]=D;if(F!==D.minValue||
G!==D.maxValue)this._aggregateValueRangesChanged=!0};A._markTileClustersForDeletion=function(w,y){var D=2*y;y=Math.ceil(a.TILE_SIZE/D);const {row:F,col:G}=w.key,K=Math.floor(G*a.TILE_SIZE/D);D=Math.floor(F*a.TILE_SIZE/D);for(let J=K;J<K+y;J++)for(let I=D;I<D+y;I++)this._markForDeletion(w.key.level,J,I)};return B}(h.Store2D);r.ClusterInfo=q;r.ClusterStore=E;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/ComputedAttributeStorage":function(){define(["exports",
"../../../engine/webgl/DisplayId","./DisplayIdGenerator","./StaticBitSet"],function(r,u,E,C){function v(x,f,k){if(!(x.length>f))for(;x.length<=f;)x.push(k)}let z=function(){function x(){this._numerics=[];this._strings=[];this._idGenerator=new E.DisplayIdGenerator;this._allocatedSize=256;this._bitsets=[];this._instanceIds=[];this._bounds=[]}var f=x.prototype;f.createBitset=function(){const k=this._bitsets.length;this._bitsets.push(C.StaticBitSet.create(this._allocatedSize,u.DISPLAY_ID_TEXEL_MASK));
return k+1};f.getBitset=function(k){return this._bitsets[k-1]};f._expand=function(){this._allocatedSize<<=1;for(const k of this._bitsets)k.resize(this._allocatedSize)};f._ensureNumeric=function(k,g){this._numerics[k]||(this._numerics[k]=[]);v(this._numerics[k],g,0)};f._ensureInstanceId=function(k){v(this._instanceIds,k,0)};f._ensureString=function(k,g){this._strings[k]||(this._strings[k]=[]);v(this._strings[k],g,null)};f.createDisplayId=function(k=!1){const g=this._idGenerator.createId();g>this._allocatedSize&&
this._expand();return u.createDisplayId(g,k)};f.releaseDisplayId=function(k){for(const g of this._bitsets)g.unset(k);return this._idGenerator.releaseId(k&u.DISPLAY_ID_TEXEL_MASK)};f.getComputedNumeric=function(k,g){return this.getComputedNumericAtIndex(k&u.DISPLAY_ID_TEXEL_MASK,0)};f.setComputedNumeric=function(k,g,m){return this.setComputedNumericAtIndex(k&u.DISPLAY_ID_TEXEL_MASK,m,0)};f.getComputedString=function(k,g){return this.getComputedStringAtIndex(k&u.DISPLAY_ID_TEXEL_MASK,0)};f.setComputedString=
function(k,g,m){return this.setComputedStringAtIndex(k&u.DISPLAY_ID_TEXEL_MASK,0,m)};f.getComputedNumericAtIndex=function(k,g){k&=u.DISPLAY_ID_TEXEL_MASK;this._ensureNumeric(g,k);return this._numerics[g][k]};f.setComputedNumericAtIndex=function(k,g,m){k&=u.DISPLAY_ID_TEXEL_MASK;this._ensureNumeric(g,k);this._numerics[g][k]=m};f.getInstanceId=function(k){k&=u.DISPLAY_ID_TEXEL_MASK;this._ensureInstanceId(k);return this._instanceIds[k]};f.setInstanceId=function(k,g){k&=u.DISPLAY_ID_TEXEL_MASK;this._ensureInstanceId(k);
this._instanceIds[k]=g};f.getComputedStringAtIndex=function(k,g){k&=u.DISPLAY_ID_TEXEL_MASK;this._ensureString(g,k);return this._strings[g][k]};f.setComputedStringAtIndex=function(k,g,m){k&=u.DISPLAY_ID_TEXEL_MASK;this._ensureString(g,k);this._strings[g][k]=m};f.getXMin=function(k){return this._bounds[4*(k&u.DISPLAY_ID_TEXEL_MASK)]};f.getYMin=function(k){return this._bounds[4*(k&u.DISPLAY_ID_TEXEL_MASK)+1]};f.getXMax=function(k){return this._bounds[4*(k&u.DISPLAY_ID_TEXEL_MASK)+2]};f.getYMax=function(k){return this._bounds[4*
(k&u.DISPLAY_ID_TEXEL_MASK)+3]};f.setBounds=function(k,g){g=g.readHydratedGeometry();if(!g||!g.coords.length)return!1;let m=Infinity,p=Infinity,t=-Infinity,e=-Infinity;g.forEachVertex((c,a)=>{m=Math.min(m,c);p=Math.min(p,a);t=Math.max(t,c);e=Math.max(e,a)});k&=u.DISPLAY_ID_TEXEL_MASK;v(this._bounds,4*k+4,0);this._bounds[4*k]=m;this._bounds[4*k+1]=p;this._bounds[4*k+2]=t;this._bounds[4*k+3]=e;return!0};return x}();r.ComputedAttributeStorage=z;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/layers/features/support/DisplayIdGenerator":function(){define(["exports","../../../engine/webgl/DisplayId"],function(r,u){let E=function(){function C(){this._freeIds=[];this._idCounter=1}var v=C.prototype;v.createId=function(z=!1){return u.createDisplayId(this._getFreeId(),z)};v.releaseId=function(z){this._freeIds.push(z)};v._getFreeId=function(){return this._freeIds.length?this._freeIds.pop():this._idCounter++};return C}();r.DisplayIdGenerator=E;Object.defineProperties(r,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/TileStore":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Evented ../../../../../core/has ../../../../../chunks/rbush ./Tile ../../../tiling/TileCoverage ../../../tiling/TileKey".split(" "),function(r,u,E,C,v,z,x){const f={added:[],removed:[]},k=new Set,g=new x(0,0,0,0);return function(m){function p(e){var c=m.call(this)||this;c._tiles=new Map;c._index=C.rbush(9,E("esri-csp-restrictions")?
a=>({minX:a.bounds[0],minY:a.bounds[1],maxX:a.bounds[2],maxY:a.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]);c.tiles=[];c.tileScheme=e;return c}r._inheritsLoose(p,m);var t=p.prototype;t.destroy=function(){this.clear()};t.clear=function(){this.tiles.length=0;this._tiles.clear();this._index.clear()};t.has=function(e){return this._tiles.has(e)};t.get=function(e){return this._tiles.get(e)};t.boundsIntersections=function(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],
maxY:e[3]})};t.updateTiles=function(e){const c={added:[],removed:[]};for(const a of e.added)if(!this.has(a)){const b=new v.Tile(this.tileScheme,a);this._tiles.set(a,b);this._index.insert(b);c.added.push(b)}for(const a of e.removed)this.has(a)&&(e=this.get(a),this._tiles.delete(a),this._index.remove(e),c.removed.push(e));this.tiles.length=0;this._tiles.forEach(a=>this.tiles.push(a));(c.added.length||c.removed.length)&&this.emit("update",c)};t.setViewState=function(e){if(e=this.tileScheme.getTileCoverage(e,
0)){var {spans:c,lodInfo:a}=e,{level:b}=a;if(0<c.length)for(const {row:l,colFrom:d,colTo:q}of c)for(var h=d;h<=q;h++){const n=g.set(b,l,a.normalizeCol(h),a.getWorldForColumn(h)).id;k.add(n);if(!this.has(n)){const B=new v.Tile(this.tileScheme,n);this._tiles.set(n,B);this._index.insert(B);this.tiles.push(B);f.added.push(B)}}for(b=this.tiles.length-1;0<=b;b--)h=this.tiles[b],k.has(h.id)||(this._tiles.delete(h.id),this.tiles.splice(b,1),this._index.remove(h),f.removed.push(h));(f.added.length||f.removed.length)&&
this.emit("update",f);z.pool.release(e);k.clear();f.added.length=0;f.removed.length=0}};return p}(u)})},"esri/views/2d/layers/features/support/Tile":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/ArrayPool ../../../../../geometry/Extent ../../../../../geometry/support/aaBoundingRect ../../../../../rest/support/QuantizationParameters ../../../tiling/TileKey".split(" "),function(r,u,E,C,v,z,x){let f=function(){function k(m,p){this.key=new x(0,0,0,0);this.bounds=
v.create();this.objectIds=new Set;this.key.set(p);p=m.getLODInfoAt(this.key);this.tileInfoView=m;this.tileInfoView.getTileBounds(this.bounds,this.key,!0);this.resolution=p.resolution;this.scale=p.scale;this.level=p.level}var g=k.prototype;g.createChildTiles=function(){const m=this.key.getChildKeys(),p=E.acquire();for(let t=0;t<m.length;t++)p[t]=new k(this.tileInfoView,m[t]);return p};g.getQuantizationParameters=function(){return z.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,
extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})};u._createClass(k,[{key:"id",get:function(){return this.key.id}},{key:"extent",get:function(){return C.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)}},{key:"transform",get:function(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}}}]);return k}();r.Tile=f;Object.defineProperties(r,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/tiling/TileKey":function(){define(["../../../chunks/_rollupPluginBabelHelpers","../../../core/ObjectPool"],function(r,u){let E=function(){function C(z,x,f,k){this.set(z,x,f,k)}C.getId=function(z,x,f,k){return"object"===typeof z?`${z.level}/${z.row}/${z.col}/${z.world}`:`${z}/${x}/${f}/${k}`};var v=C.prototype;v.acquire=function(z,x,f,k){this.set(z,x,f,k)};v.contains=function(z){const x=z.level-this.level;return this.row===
z.row>>x&&this.col===z.col>>x&&this.world===z.world};v.equals=function(z){return this.level===z.level&&this.row===z.row&&this.col===z.col&&this.world===z.world};v.clone=function(){return new C(this)};v.release=function(){this.world=this.col=this.row=this.level=0};v.set=function(z,x,f,k){if(null==z)this.world=this.col=this.row=this.level=0;else if("object"===typeof z)this.level=z.level||0,this.row=z.row||0,this.col=z.col||0,this.world=z.world||0;else if("string"===typeof z){const [g,m,p,t]=z.split("/");
this.level=parseFloat(g);this.row=parseFloat(m);this.col=parseFloat(p);this.world=parseFloat(t)}else this.level=+z,this.row=+x,this.col=+f,this.world=+k||0;return this};v.toString=function(){return`${this.level}/${this.row}/${this.col}/${this.world}`};v.getParentKey=function(){return 0>=this.level?null:new C(this.level-1,this.row>>1,this.col>>1,this.world)};v.getChildKeys=function(){const z=this.level+1,x=this.row<<1,f=this.col<<1,k=this.world;return[new C(z,x,f,k),new C(z,x,f+1,k),new C(z,x+1,f,
k),new C(z,x+1,f+1,k)]};v.compareRowMajor=function(z){return this.row<z.row?-1:this.row>z.row?1:this.col<z.col?-1:this.col>z.col?1:0};r._createClass(C,[{key:"key",get:function(){return this}},{key:"id",get:function(){return this.toString()},set:function(z){this.set(z)}},{key:"hash",get:function(){return(this.world&3)<<30|(this.col&4095)<<22|(this.row&4095)<<8|this.level&63}}]);return C}();E.pool=new u(E,null,null,25,50);return E})},"esri/views/2d/tiling/TileCoverage":function(){define(["../../../core/ObjectPool"],
function(r){let u=function(){function E(){this.spans=[]}var C=E.prototype;C.acquire=function(v){this.lodInfo=v};C.release=function(){this.lodInfo=null;this.spans.length=0};C.forEach=function(v,z){const {spans:x,lodInfo:f}=this,{level:k}=f;if(0!==x.length)for(const {row:g,colFrom:m,colTo:p}of x)for(let t=m;t<=p;t++)v.call(z,k,g,f.normalizeCol(t),f.getWorldForColumn(t))};return E}();u.pool=new r(u);return u})},"esri/views/2d/tiling/TileInfoView":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../geometry/support/spatialReferenceUtils ./LODInfo ./TileCoverage ./TileKey ./TileSpan".split(" "),
function(r,u,E,C,v,z){const x=new v("0/0/0/0");let f=function(){function g(p,t,e,c,a,b,h,l){this.x=p;this.ymin=t;this.ymax=e;this.invM=c;this.leftAdjust=a;this.rightAdjust=b;this.leftBound=h;this.rightBound=l}g.create=function(p,t){p[1]>t[1]&&([p,t]=[t,p]);const [e,c]=p,[a,b]=t;p=a-e;t=b-c;t=0!==t?p/t:0;const h=(Math.ceil(c)-c)*t,l=(Math.floor(c)-c)*t;return new g(e,Math.floor(c),Math.ceil(b),t,0>p?h:l,0>p?l:h,0>p?a:e,0>p?e:a)};var m=g.prototype;m.incrRow=function(){this.x+=this.invM};m.getLeftCol=
function(){return Math.max(this.x+this.leftAdjust,this.leftBound)};m.getRightCol=function(){return Math.min(this.x+this.rightAdjust,this.rightBound)};return g}();const k=[[0,0],[0,0],[0,0],[0,0]];return function(){function g(p,t=null){this.tileInfo=p;this.fullExtent=t;this.scales=[];this._lodInfos=null;this._infoByScale={};this._infoByLevel={};const e=p.lods.slice();e.sort((a,b)=>b.scale-a.scale);const c=this._lodInfos=e.map(a=>E.create(p,a,t));e.forEach((a,b)=>{this._infoByLevel[a.level]=c[b];this._infoByScale[a.scale]=
c[b];this.scales[b]=a.scale},this);this._wrap=p.isWrappable}var m=g.prototype;m.getLODInfoAt=function(p){return this._infoByLevel["number"===typeof p?p:p.level]};m.getTileBounds=function(p,t,e=!1){x.set(t);return(t=this._infoByLevel[x.level])?t.getTileBounds(p,x,e):p};m.getTileCoords=function(p,t,e=!1){x.set(t);return(t=this._infoByLevel[x.level])?t.getTileCoords(p,x,e):p};m.getTileCoverage=function(p,t=192,e="closest"){e="closest"===e?this.getClosestInfoForScale(p.scale):this.getSmallestInfoForScale(p.scale);
const c=C.pool.acquire(e),a=this._wrap;var b=Infinity;let h=-Infinity;const l=c.spans;k[0][0]=k[0][1]=k[1][1]=k[3][0]=-t;k[1][0]=k[2][0]=p.size[0]+t;k[2][1]=k[3][1]=p.size[1]+t;for(d of k)p.toMap(d,d),d[0]=e.getColumnForX(d[0]),d[1]=e.getRowForY(d[1]);p=[];var d=3;for(t=0;4>t;t++)k[t][1]===k[d][1]?d=t:(d=f.create(k[t],k[d]),b=Math.min(d.ymin,b),h=Math.max(d.ymax,h),void 0===p[d.ymin]&&(p[d.ymin]=[]),p[d.ymin].push(d),d=t);if(null==b||null==h||100<h-b)return null;for(t=[];b<h;){null!=p[b]&&(t=t.concat(p[b]));
d=Infinity;var q=-Infinity;for(var n=t.length-1;0<=n;n--){var B=t[n];d=Math.min(d,B.getLeftCol());q=Math.max(q,B.getRightCol())}d=Math.floor(d);q=Math.floor(q);if(b>=e.first[1]&&b<=e.last[1])if(a)if(e.size[0]<e.worldSize[0])for(n=Math.floor(q/e.worldSize[0]),B=Math.floor(d/e.worldSize[0]);B<=n;B++)l.push(new z(b,Math.max(e.getFirstColumnForWorld(B),d),Math.min(e.getLastColumnForWorld(B),q)));else l.push(new z(b,d,q));else d>e.last[0]||q<e.first[0]||(d=Math.max(d,e.first[0]),q=Math.min(q,e.last[0]),
l.push(new z(b,d,q)));b+=1;for(d=t.length-1;0<=d;d--)q=t[d],q.ymax>=b?q.incrRow():t.splice(d,1)}return c};m.getTileParentId=function(p){x.set(p);p=this._lodInfos.indexOf(this._infoByLevel[x.level])-1;if(0>p)return null;this._getTileIdAtLOD(x,this._lodInfos[p],x);return x.id};m.getTileResolution=function(p){return(p=this._infoByLevel["object"===typeof p?p.level:p])?p.resolution:-1};m.getTileScale=function(p){return(p=this._infoByLevel[p.level])?p.scale:-1};m.intersects=function(p,t){x.set(t);t=this._infoByLevel[x.level];
const e=p.lodInfo;if(e.resolution>t.resolution){this._getTileIdAtLOD(x,e,x);var c=e.denormalizeCol(x.col,x.world);for(var a of p.spans)if(a.row===x.row&&a.colFrom<=c&&a.colTo>=c)return!0}if(e.resolution<t.resolution){const [h,l,d,q]=p.spans.reduce((n,B)=>{n[0]=Math.min(n[0],B.row);n[1]=Math.max(n[1],B.row);n[2]=Math.min(n[2],B.colFrom);n[3]=Math.max(n[3],B.colTo);return n},[Infinity,-Infinity,Infinity,-Infinity]);c=t.denormalizeCol(x.col,x.world);p=e.getColumnForX(t.getXForColumn(c));a=e.getRowForY(t.getYForRow(x.row));
c=e.getColumnForX(t.getXForColumn(c+1))-1;t=e.getRowForY(t.getYForRow(x.row+1))-1;return!(p>q||c<d||a>l||t<h)}const b=e.denormalizeCol(x.col,x.world);return p.spans.some(h=>h.row===x.row&&h.colFrom<=b&&h.colTo>=b)};m.normalizeBounds=function(p,t,e){p[0]=t[0];p[1]=t[1];p[2]=t[2];p[3]=t[3];this._wrap&&(t=u.getInfo(this.tileInfo.spatialReference),e=-e*(t.valid[1]-t.valid[0]),p[0]+=e,p[2]+=e);return p};m.getSmallestInfoForScale=function(p){const t=this.scales;if(this._infoByScale[p])return this._infoByScale[p];
if(p>t[0])return this._infoByScale[t[0]];for(let e=1;e<t.length-1;e++)if(p>t[e]+1E-6)return this._infoByScale[t[e-1]];return this._infoByScale[t[t.length-1]]};m.getClosestInfoForScale=function(p){const t=this.scales;if(this._infoByScale[p])return this._infoByScale[p];p=t.reduce((e,c)=>Math.abs(c-p)<Math.abs(e-p)?c:e,t[0]);return this._infoByScale[p]};m.scaleToLevel=function(p){const t=this.scales;if(this._infoByScale[p])return this._infoByScale[p].level;for(let e=t.length-1;0<=e;e--)if(p<t[e])return e===
t.length-1?this._infoByScale[t[t.length-1]].level:this._infoByScale[t[e]].level+(t[e]-p)/(t[e]-t[e+1]);return this._infoByScale[t[0]].level};m.scaleToZoom=function(p){return this.tileInfo.scaleToZoom(p)};m._getTileIdAtLOD=function(p,t,e){const c=this._infoByLevel[e.level];p.set(e);if(t.resolution<c.resolution)return null;if(t.resolution===c.resolution)return p;p.level=t.level;p.col=Math.floor(e.col*c.resolution/t.resolution+.01);p.row=Math.floor(e.row*c.resolution/t.resolution+.01);return p};r._createClass(g,
[{key:"spatialReference",get:function(){return this.tileInfo.spatialReference}}]);return g}()})},"esri/views/2d/tiling/LODInfo":function(){define(["../../../core/maybe","../../../geometry/support/spatialReferenceUtils","./TileKey"],function(r,u,E){function C(z,x,f){z[0]=x;z[1]=f;return z}const v=new E("0/0/0/0");return function(){function z(f,k,g,m,p,t,e,c,a,b,h,l){this.level=f;this.resolution=k;this.scale=g;this.origin=m;this.first=p;this.last=t;this.size=e;this.norm=c;this.worldStart=a;this.worldEnd=
b;this.worldSize=h;this.wrap=l}z.create=function(f,k,g=null){var m=u.getInfo(f.spatialReference);const p=k.origin||[f.origin.x,f.origin.y],t=[f.size[0]*k.resolution,f.size[1]*k.resolution],e=[-Infinity,-Infinity],c=[Infinity,Infinity],a=[Infinity,Infinity];r.isSome(g)&&(C(e,Math.max(0,Math.floor((g.xmin-p[0])/t[0])),Math.max(0,Math.floor((p[1]-g.ymax)/t[1]))),C(c,Math.max(0,Math.floor((g.xmax-p[0])/t[0])),Math.max(0,Math.floor((p[1]-g.ymin)/t[1]))),C(a,c[0]-e[0]+1,c[1]-e[1]+1));const {cols:b,rows:h}=
k;!g&&b&&h&&(C(e,b[0],h[0]),C(c,b[1],h[1]),C(a,b[1]-b[0]+1,h[1]-h[0]+1));let l;f.isWrappable?(f=[Math.ceil(Math.round((m.valid[1]-m.valid[0])/k.resolution)/f.size[0]),a[1]],m=[Math.floor((m.origin[0]-p[0])/t[0]),e[1]],g=[f[0]+m[0]-1,c[1]],l=!0):(m=e,g=c,f=a,l=!1);return new z(k.level,k.resolution,k.scale,p,e,c,a,t,m,g,f,l)};var x=z.prototype;x.normalizeCol=function(f){if(!this.wrap)return f;const k=this.worldSize[0];return 0>f?k-1-Math.abs((f+1)%k):f%k};x.denormalizeCol=function(f,k){return this.wrap?
this.worldSize[0]*k+f:f};x.getWorldForColumn=function(f){return this.wrap?Math.floor(f/this.worldSize[0]):0};x.getFirstColumnForWorld=function(f){return f*this.worldSize[0]+this.first[0]};x.getLastColumnForWorld=function(f){return f*this.worldSize[0]+this.first[0]+this.size[0]-1};x.getColumnForX=function(f){return(f-this.origin[0])/this.norm[0]};x.getXForColumn=function(f){return this.origin[0]+f*this.norm[0]};x.getRowForY=function(f){return(this.origin[1]-f)/this.norm[1]};x.getYForRow=function(f){return this.origin[1]-
f*this.norm[1]};x.getTileBounds=function(f,k,g=!1){v.set(k);var m=g?v.col:this.denormalizeCol(v.col,v.world),p=v.row;k=this.getXForColumn(m);g=this.getYForRow(p+1);m=this.getXForColumn(m+1);p=this.getYForRow(p);f[0]=k;f[1]=g;f[2]=m;f[3]=p;return f};x.getTileCoords=function(f,k,g=!1){v.set(k);k=g?v.col:this.denormalizeCol(v.col,v.world);Array.isArray(f)?C(f,this.getXForColumn(k),this.getYForRow(v.row)):(f.x=this.getXForColumn(k),f.y=this.getYForRow(v.row));return f};return z}()})},"esri/views/2d/tiling/TileSpan":function(){define(function(){return function(r,
u,E){this.row=r;this.colFrom=u;this.colTo=E}})},"esri/views/2d/layers/features/processors/SymbolProcessor":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/BidiText ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/ensureType ../../../../../core/arrayUtils ../../../../../core/accessorSupport/set ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/accessorSupport/diffUtils ../../../../../geometry/SpatialReference ../../../engine/webgl/DisplayId ../../../engine/webgl/mesh/MeshData ../../../engine/webgl/mesh/factories/WGLMeshFactory ../../../engine/webgl/mesh/templates/WGLTemplateStore ../../../engine/webgl/util/Matcher ../textUtils ./BaseProcessor ../support/ResourceManagerProxy".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t,e,c,a,b,h,l,d,q,n){function B(w,y){return(!w.minScale||w.minScale>=y)&&(!w.maxScale||w.maxScale<=y)}function A(w){w=w.message;const y={message:{data:{},tileKey:w.tileKey,tileKeyOrigin:w.tileKeyOrigin,version:w.version},transferList:[]};for(const G in w.data){var D=w.data[G];y.message.data[G]=null;if(x.isSome(D)){var F=D.stride;const K=D.indices.slice(0),J=D.vertices.slice(0),I=D.records.slice(0);D=x.applySome(D.metrics,H=>H.slice(0));F={stride:F,indices:K,vertices:J,
records:I,metrics:D};y.transferList.push(K,J,I);y.message.data[G]=F}}return y}z.getLogger("esri.views.2d.layers.features.processors.SymbolProcessor");C=function(w){function y(){var F=w.apply(this,arguments)||this;F.type="symbol";F._matchers={feature:null,aggregate:null};F._bufferData=new Map;F._bufferIds=new Map;return F}r._inheritsLoose(y,w);var D=y.prototype;D.initialize=function(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))]);this._resourceManagerProxy=new n(this.remoteClient)};
D.destroy=function(){this._resourceManagerProxy.destroy()};D.forEachBufferId=function(F){this._bufferIds.forEach(G=>{G.forEach(F)})};D.update=function(){var F=r._asyncToGenerator(function*(G,K){K=K.schema.processors[0];if("symbol"===K.type){var J=t.diff(this._schema,K);t.hasDiff(J,"mesh")&&(G.mesh=!0,G.why.mesh.push("Symbology changed"),this._schema=K,this._factory=this._createFactory(K),this._factory.update(K,this.tileStore.tileScheme.tileInfo))}});return function(G,K){return F.apply(this,arguments)}}();
D.onTileMessage=function(F,G,K,J){f.throwIfAborted(J);return this._onTileData(F,G,K,J)};D.onTileClear=function(F){this._bufferData.delete(F.key.id);this._bufferIds.delete(F.key.id);return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:F.id,data:{clear:!0}})};D.onTileError=function(F,G,K){return this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:F.id,error:G},{signal:K.signal})};D.onTileUpdate=function(F){for(const G of F.removed)this._bufferData.has(G.key.id)&&this._bufferData.delete(G.key.id),
this._bufferIds.has(G.key.id)&&this._bufferIds.delete(G.key.id);for(const G of F.added)this._bufferData.forEach(K=>{for(const J of K)J.message.tileKey===G.id&&this._updateTileMesh("append",G,A(J),[],!1,!1,null)})};D._addBufferData=function(F,G){this._bufferData.has(F)||this._bufferData.set(F,[]);this._bufferData.get(F).push(A(G))};D._createFactory=function(F){const {geometryType:G,objectIdField:K,fields:J}=this.service,I=e.fromJSON(this.spatialReference),H={geometryType:G,fields:J,spatialReference:I},
M=new h.WGLTemplateStore((ba,X)=>this.remoteClient.invoke("tileRenderer.getMaterialItems",ba,X),this.tileStore.tileScheme.tileInfo),{matcher:N,aggregateMatcher:P}=F.mesh;this._store=M;this._matchers.feature=l.createMatcher(N,M,H,this._resourceManagerProxy);this._matchers.aggregate=x.applySome(P,ba=>l.createMatcher(ba,M,H,this._resourceManagerProxy));return new b.WGLMeshFactory(G,K,M)};D._onTileData=function(){var F=r._asyncToGenerator(function*(G,K,J,I){f.throwIfAborted(I);const {type:H,addOrUpdate:M,
remove:N,clear:P,end:ba}=K;var X=!!this._schema.mesh.sortKey;if(!M)return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:G.id,data:{type:H,addOrUpdate:null,remove:N,clear:P,end:ba,sort:X}},I);J=this._processFeatures(G,M,J,I,K.status.version);try{var S=yield J;if(x.isNone(S))return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:G.id,data:{type:H,addOrUpdate:null,remove:N,clear:P,end:ba,sort:X}},I);X=[];for(const W of S){S=!1;const R=W.message.bufferIds,Z=G.key.id,ka=W.message.tileKey;
if(Z!==ka&&x.isSome(R)){if(!this.tileStore.get(ka)){this._addBufferData(Z,W);X.push(W);continue}let ta=this._bufferIds.get(ka);ta||(ta=new Set,this._bufferIds.set(ka,ta));const pa=Array.from(R);for(const wa of pa)if(ta.has(wa)){S=!0;break}else ta.add(wa)}S||(this._addBufferData(Z,W),X.push(W))}yield Promise.all(X.map(W=>{const R=G.key.id===W.message.tileKey;return this._updateTileMesh(H,G,W,R?K.remove:[],R&&K.end,K.clear,I.signal)}))}catch(W){this._handleError(G,W,I)}});return function(G,K,J,I){return F.apply(this,
arguments)}}();D._updateTileMesh=function(){var F=r._asyncToGenerator(function*(G,K,J,I,H,M,N){const P=J.message.tileKey,ba=!!this._schema.mesh.sortKey;P!==K.key.id&&(H=!1);K=x.applySome(J,X=>X.message);J=x.applySome(J,X=>X.transferList)||[];G={type:G,addOrUpdate:K,remove:I,clear:M,end:H,sort:ba};N={transferList:x.unwrap(J)||[],signal:N};f.throwIfAborted(N);return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:P,data:G},N)});return function(G,K,J,I,H,M,N){return F.apply(this,arguments)}}();
D._processFeatures=function(){var F=r._asyncToGenerator(function*(G,K,J,I,H){if(x.isNone(K)||!K.hasFeatures)return null;const M={transform:G.transform,hasZ:!1,hasM:!1},N=this._factory,P={viewingMode:"",scale:G.scale},ba=yield this._matchers.feature,X=yield this._matchers.aggregate;f.throwIfAborted(I);const S=this._getLabelInfos(G,K);yield N.analyze(K.getCursor(),this._resourceManagerProxy,ba,X,M,P);f.throwIfAborted(I);return this._writeFeatureSet(G,K,M,S,N,J,H)});return function(G,K,J,I,H){return F.apply(this,
arguments)}}();D._writeFeatureSet=function(F,G,K,J,I,H,M){const N=G.getSize();H=new a.MeshData(F.key.id,{features:N,records:N,metrics:0},this._schema.mesh.matcher.symbologyType,H,!0,M);M={viewingMode:"",scale:F.scale};for(G=G.getCursor();G.next();)try{const P=G.getDisplayId(),ba=x.isSome(J)?J.get(P):null;I.writeCursor(H,G,K,M,F.level,ba,this._resourceManagerProxy)}catch(P){}return H.serialize(F.tileInfoView.tileInfo.isWrappable)};D._handleError=function(F,G,K){if(!f.isAbortError(G))return this.remoteClient.invoke("tileRenderer.onTileError",
{tileKey:F.id,error:G.message},{signal:K.signal})};D._getLabelingSchemaForScale=function(F){var G=this._schema.mesh.labels;if(x.isNone(G))return null;if("subtype"===G.type){const K={type:"subtype",classes:{}};let J=!1;for(const I in G.classes){const H=G.classes[I].filter(M=>B(M,F.scale));J=J||!!H.length;K.classes[I]=H}return J?K:null}G=G.classes.filter(K=>B(K,F.scale));return G.length?{type:"simple",classes:G}:null};D._getLabels=function(F,G){if("subtype"===G.type){var K;const J=x.unwrapOrThrow(this.service.subtypeField,
"Expected to find subtype Field");F=F.readAttribute(J);return null==F?[]:null!=(K=G.classes[F])?K:[]}return G.classes};D._getLabelInfos=function(F,G){F=this._getLabelingSchemaForScale(F);if(x.isNone(F))return null;const K=new Map;for(G=G.getCursor();G.next();){const I=G.getDisplayId(),H=[],M=c.isAggregateId(I),N=M&&1!==G.readAttribute("cluster_count")?"aggregate":"feature";var J=this._getLabels(G,F);for(const P of J){if(P.target!==N)continue;J=G.getStorage();J=M&&"feature"===N?J.getComputedStringAtIndex(G.readAttribute("referenceId"),
P.fieldIndex):J.getComputedStringAtIndex(I,P.fieldIndex);if(!J)continue;J=E.bidiText(J.toString());const ba=J[1];this._store.getMosaicItem(P.symbol,d.codepoints(J[0])).then(X=>{H[P.index]={glyphs:X.glyphMosaicItems,rtl:ba,index:P.index}})}K.set(I,H)}return K};r._createClass(y,[{key:"supportsTileUpdates",get:function(){return!0}}]);return y}(q);return C=u.__decorate([p.subclass("esri.views.2d.layers.features.processors.SymbolProcessor")],C)})},"esri/core/BidiText":function(){define(["exports","./BidiEngine"],
function(r,u){const E=new u;r.bidiText=function(C){if(!E.hasBidiChar(C))return[C,!1];let v;v="rtl"===E.checkContextual(C)?"IDNNN":"ICNNN";return[E.bidiTransform(C,v,"VLYSN"),!0]};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/MeshData":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../tiling/PagedTileQueue ../../../tiling/TileInfoView ../../../tiling/TileKey ../../../tiling/TileQueue ../../../tiling/TileStrategy ../definitions ../DisplayId ../enums ../Utils ./VertexDataWriter ../../../layers/features/support/tileUtils".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t){function e(a){switch(a){case 1:case 8:case 32:return-1;case 2:case 64:return 0;case 4:case 16:case 128:return 1}}function c(a){switch(a){case 1:case 2:case 4:return-1;case 8:case 16:return 0;case 32:case 64:case 128:return 1}}E=function(){function a(h,l,d,q,n,B=0){this.hasRecords=this._hasAggregate=!1;this._data={self:new Map,neighbors:[]};this._version=0;this._current={geometryType:0,writer:null,overlaps:0,start:0,insertAfter:0,sortKey:0,id:0,materialKey:0,indexStart:0,
vertStart:0,isDotDensity:!1,bufferingEnabled:!1,metricBoxLenPointer:0};this.hint=l;this.tileKey=h;this._hasAggregate=q;this._pixelBufferEnabled=n;this._version=B;this._symbologyType=d}var b=a.prototype;b.serialize=function(h){const l=[];l.push(this._serializeTileVertexData(this.tileKey,this.tileKey,this._data.self));this._data.neighbors.forEach((d,q)=>{var n=1<<q;q=e(n);n=c(n);q=t.getPow2NeighborKey(new v(this.tileKey),q,n,h);q=this._serializeTileVertexData(this.tileKey,q.id,d.vertexData);q.message.bufferIds=
d.displayIds;l.push(q)});return l};b._serializeTileVertexData=function(h,l,d){var q,n,B,A,w;const y=[];d={[g.WGLGeometryType.MARKER]:null==(q=d.get(g.WGLGeometryType.MARKER))?void 0:q.serialize(y),[g.WGLGeometryType.FILL]:null==(n=d.get(g.WGLGeometryType.FILL))?void 0:n.serialize(y),[g.WGLGeometryType.LINE]:null==(B=d.get(g.WGLGeometryType.LINE))?void 0:B.serialize(y),[g.WGLGeometryType.TEXT]:null==(A=d.get(g.WGLGeometryType.TEXT))?void 0:A.serialize(y),[g.WGLGeometryType.LABEL]:null==(w=d.get(g.WGLGeometryType.LABEL))?
void 0:w.serialize(y)};return{message:{tileKeyOrigin:h,tileKey:l,data:d,version:this._version},transferList:y}};b.featureStart=function(h,l){this._current.insertAfter=h;this._current.sortKey=l};b.featureEnd=function(){};b.recordStart=function(h,l,d,q){this._current.writer=this._getVertexWriter(d);this._current.overlaps=0;this._current.indexStart=this._current.writer.indexCount;this._current.vertStart=this._current.writer.vertexCount;this._current.bufferingEnabled=q;this._current.id=h;this._current.materialKey=
l;this._current.geometryType=d;this._current.isDotDensity=!1;this._current.writer.recordStart()};b.recordCount=function(){return this._current.writer.recordCount};b.vertexCount=function(){return this._current.writer.vertexCount};b.indexCount=function(){return this._current.writer.indexCount};b.vertexEnsureSize=function(h){this._current.writer.vertexEnsureSize(h)};b.indexEnsureSize=function(h){this._current.writer.indexEnsureSize(h)};b.vertexBounds=function(h,l,d,q){this._current.bufferingEnabled&&
this._addOverlap(h,l,d,q)};b.vertexWrite=function(h){this._current.writer.writeVertex(h)};b.vertexWriteF32=function(h){this._current.writer.writeVertexF32(h)};b.vertexEnd=function(){};b.vertexWriter=function(){return this._current.writer.vertexWriter};b.indexWrite=function(h){this._current.writer.writeIndex(h)};b.indexWriter=function(){return this._current.writer.indexWriter};b.metricWriter=function(){return this._current.writer.metricWriter};b.metricStart=function(h,l,d,q,n,B,A,w){this._current.writer=
this._getVertexWriter(g.WGLGeometryType.LABEL);const y=this._current.writer.metricWriter;y.push(k.getDisplayIdTexel(h));y.push(l);y.push(d);y.push(q);y.push(n);y.push(B);y.push(A);y.push(w);y.push(255);this._current.metricBoxLenPointer=y.push(0)};b.metricEnd=function(){const h=this._current.writer.metricWriter;0===h.getValue(this._current.metricBoxLenPointer)&&h.seek(h.length-10)};b.metricBoxWrite=function(h,l,d,q){const n=this._current.writer.metricWriter;n.incr(this._current.metricBoxLenPointer);
n.push(0);n.push(0);n.push(h);n.push(l);n.push(d);n.push(q)};b.recordEnd=function(){var h=this._current.vertStart,l=this._current.writer.vertexCount-h;if(!l)return!1;this.hasRecords=!0;var d=this._current.indexStart;this._current.writer.recordEnd(this._current.id,this._current.materialKey,this._current.insertAfter,d,this._current.writer.indexCount-d,h,l,this._current.sortKey);if(!this._pixelBufferEnabled||this._hasAggregate||0===this._current.overlaps||this._current.geometryType===g.WGLGeometryType.LABEL)return!0;
h=this._current.writer;for(l=0;8>l;l++){var q=1<<l;if(this._current.overlaps&q){this._data.neighbors[l]||(this._data.neighbors[l]={vertexData:new Map,displayIds:new Set});d=this._data.neighbors[l];var n=this._current.geometryType;if(!d.vertexData.has(n)){var B=m.getStrides(n,this._symbologyType).geometry;B=new p.VertexDataWriter(n,B,f.PATCH_PIXEL_BUFFER_ALLOC_SIZE);d.vertexData.set(n,B)}n=d.vertexData.get(this._current.geometryType);B=4096*-e(q);q=4096*-c(q);n.copyLastFrom(h,B,q);d.displayIds.add(this._current.id)}}return!0};
b._addOverlap=function(h,l,d,q){this._current.overlaps|=255^((h<0+d?148:h>=f.TILE_SIZE-d?41:189)|(l<0+q?224:l>=f.TILE_SIZE-q?7:231))};b._getVertexWriter=function(h){if(!this._data.self.has(h)){const l=this._data.self,d=m.getStrides(h,this._symbologyType).geometry;l.set(h,new p.VertexDataWriter(h,d,this.hint.records))}return this._data.self.get(h)};u._createClass(a,[{key:"hasAggregates",get:function(){return this._hasAggregate}},{key:"hasPixelBufferEnabled",get:function(){return this._pixelBufferEnabled}}]);
return a}();r.MeshData=E;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/tiling/PagedTileQueue":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../chunks/vec2 ../../support/QueueProcessor".split(" "),
function(r,u,E,C,v,z,x,f,k,g){function m(a,b){a.length=0;b.forEach(h=>a.push(h));return a}const p=new Set,t=[],e=new Map,c=[0,0];E=function(a){function b(l){l=a.call(this,l)||this;l._keyToItem=new Map;l.concurrency=6;l.strategy="scale-first";l.tileInfoView=null;return l}r._inheritsLoose(b,a);var h=b.prototype;h.initialize=function(){const {concurrency:l,process:d}=this;this._queue=new g.QueueProcessor({concurrency:l,process:(q,n)=>{q=this._keyToItem.get(q);return d(q,{signal:n})},peeker:q=>q.values().next().value})};
h.destroy=function(){this.clear();this._queue.destroy();this._queue=null};h.abort=function(l){this._queue.abort("string"===typeof l?l:l.id)};h.clear=function(){this._queue.clear();this._keyToItem.clear();this.notifyChange("updating")};h.has=function(l){return"string"===typeof l?this._keyToItem.has(l):this._keyToItem.has(l.id)};h.isOngoing=function(l){l="string"===typeof l?l:l.id;return this.has(l)&&this._queue.isOngoing(l)};h.pause=function(){this._queue.pause()};h.push=function(l,d){const q=l.key.id+
"-"+d;if(this.has(q))return this.get(q);d=this._queue.push(q);const n=()=>{this._keyToItem.delete(q);this.notifyChange("updating")};this._keyToItem.set(q,l);d.then(n,n);this.notifyChange("updating");return d};h.reset=function(){this._queue.reset();this.notifyChange("updating")};h.resume=function(){this._queue.resume()};h._peekByScaleFirst=function(l){if(!this.state)return l.values().next().value;const d=this.tileInfoView;let q=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY;l.forEach(D=>{D=this._keyToItem.get(D);
const F=this.tileInfoView.getTileScale(D.key);e.has(F)||(e.set(F,[]),q=Math.max(F,q),n=Math.min(F,n));e.get(F).push(D.key);p.add(F)});let B=this.state.scale;e.has(B)||(m(t,p),t.sort((D,F)=>D-F),B=t.reduce((D,F)=>Math.abs(F-B)<Math.abs(D-B)?F:D,t[0]));B=Math.min(B,q);B=Math.max(B,n);l=e.get(B);const A=d.getClosestInfoForScale(B),w=A.getColumnForX(this.state.center[0]),y=A.getRowForY(this.state.center[1]);l.sort((D,F)=>{const G=A.denormalizeCol(D.col,D.world),K=A.denormalizeCol(F.col,F.world);return Math.sqrt((w-
G)*(w-G)+(y-D.row)*(y-D.row))-Math.sqrt((w-K)*(w-K)+(y-F.row)*(y-F.row))});p.clear();e.clear();return l[0].id};h._peekByCenterFirst=function(l){if(!this.state)return l.values().next().value;const d=this.tileInfoView,q=this.state.center;let n=Number.POSITIVE_INFINITY,B=null;l.forEach(A=>{A=this._keyToItem.get(A);d.getTileCoords(c,A.key);const w=k.distance(c,q);w<n&&(n=w,B=A.key)});return B.id};r._createClass(b,[{key:"length",get:function(){return this._queue?this._queue.length:0}},{key:"onGoingCount",
get:function(){return this._keyToItem.size}},{key:"updating",get:function(){return 0<this.length||0<this.onGoingCount}}]);return b}(E);u.__decorate([C.property({constructOnly:!0})],E.prototype,"concurrency",void 0);u.__decorate([C.property({constructOnly:!0})],E.prototype,"process",void 0);u.__decorate([C.property()],E.prototype,"state",void 0);u.__decorate([C.property({constructOnly:!0})],E.prototype,"strategy",void 0);u.__decorate([C.property({constructOnly:!0})],E.prototype,"tileInfoView",void 0);
u.__decorate([C.property({readOnly:!0})],E.prototype,"updating",null);return E=u.__decorate([f.subclass("esri.views.2d.tiling.PagedTileQueue")],E)})},"esri/chunks/vec2":function(){define(["exports","./common"],function(r,u){function E(X,S){X[0]=S[0];X[1]=S[1];return X}function C(X,S,W){X[0]=S;X[1]=W;return X}function v(X,S,W){X[0]=S[0]+W[0];X[1]=S[1]+W[1];return X}function z(X,S,W){X[0]=S[0]-W[0];X[1]=S[1]-W[1];return X}function x(X,S,W){X[0]=S[0]*W[0];X[1]=S[1]*W[1];return X}function f(X,S,W){X[0]=
S[0]/W[0];X[1]=S[1]/W[1];return X}function k(X,S){X[0]=Math.ceil(S[0]);X[1]=Math.ceil(S[1]);return X}function g(X,S){X[0]=Math.floor(S[0]);X[1]=Math.floor(S[1]);return X}function m(X,S,W){X[0]=Math.min(S[0],W[0]);X[1]=Math.min(S[1],W[1]);return X}function p(X,S,W){X[0]=Math.max(S[0],W[0]);X[1]=Math.max(S[1],W[1]);return X}function t(X,S){X[0]=Math.round(S[0]);X[1]=Math.round(S[1]);return X}function e(X,S,W){X[0]=S[0]*W;X[1]=S[1]*W;return X}function c(X,S,W,R){X[0]=S[0]+W[0]*R;X[1]=S[1]+W[1]*R;return X}
function a(X,S){const W=S[0]-X[0];X=S[1]-X[1];return Math.sqrt(W*W+X*X)}function b(X,S){const W=S[0]-X[0];X=S[1]-X[1];return W*W+X*X}function h(X){const S=X[0];X=X[1];return Math.sqrt(S*S+X*X)}function l(X){const S=X[0];X=X[1];return S*S+X*X}function d(X,S){X[0]=-S[0];X[1]=-S[1];return X}function q(X,S){X[0]=1/S[0];X[1]=1/S[1];return X}function n(X,S){var W=S[0];const R=S[1];W=W*W+R*R;0<W&&(W=1/Math.sqrt(W),X[0]=S[0]*W,X[1]=S[1]*W);return X}function B(X,S){return X[0]*S[0]+X[1]*S[1]}function A(X,
S,W){S=S[0]*W[1]-S[1]*W[0];X[0]=X[1]=0;X[2]=S;return X}function w(X,S,W,R){const Z=S[0];S=S[1];X[0]=Z+R*(W[0]-Z);X[1]=S+R*(W[1]-S);return X}function y(X,S){S=S||1;const W=2*u.RANDOM()*Math.PI;X[0]=Math.cos(W)*S;X[1]=Math.sin(W)*S;return X}function D(X,S,W){const R=S[0];S=S[1];X[0]=W[0]*R+W[2]*S;X[1]=W[1]*R+W[3]*S;return X}function F(X,S,W){const R=S[0];S=S[1];X[0]=W[0]*R+W[2]*S+W[4];X[1]=W[1]*R+W[3]*S+W[5];return X}function G(X,S,W){const R=S[0];S=S[1];X[0]=W[0]*R+W[3]*S+W[6];X[1]=W[1]*R+W[4]*S+W[7];
return X}function K(X,S,W){const R=S[0];S=S[1];X[0]=W[0]*R+W[4]*S+W[12];X[1]=W[1]*R+W[5]*S+W[13];return X}function J(X,S,W,R){const Z=S[0]-W[0];S=S[1]-W[1];const ka=Math.sin(R);R=Math.cos(R);X[0]=Z*R-S*ka+W[0];X[1]=Z*ka+S*R+W[1];return X}function I(X,S){var W=X[0];X=X[1];const R=S[0];S=S[1];let Z=W*W+X*X;0<Z&&(Z=1/Math.sqrt(Z));let ka=R*R+S*S;0<ka&&(ka=1/Math.sqrt(ka));W=(W*R+X*S)*Z*ka;return 1<W?0:-1>W?Math.PI:Math.acos(W)}function H(X){return"vec2("+X[0]+", "+X[1]+")"}function M(X,S){return X[0]===
S[0]&&X[1]===S[1]}function N(X,S){const W=X[0];X=X[1];const R=S[0];S=S[1];return Math.abs(W-R)<=u.EPSILON*Math.max(1,Math.abs(W),Math.abs(R))&&Math.abs(X-S)<=u.EPSILON*Math.max(1,Math.abs(X),Math.abs(S))}function P(X,S,W,R,Z){let ka=S[0]-W[0];W=S[1]-W[1];Z=(R[0]*ka+R[1]*W)*(Z-1);ka=R[0]*Z;W=R[1]*Z;X[0]=S[0]+ka;X[1]=S[1]+W;return X}const ba=Object.freeze(Object.defineProperty({__proto__:null,copy:E,set:C,add:v,subtract:z,multiply:x,divide:f,ceil:k,floor:g,min:m,max:p,round:t,scale:e,scaleAndAdd:c,
distance:a,squaredDistance:b,length:h,squaredLength:l,negate:d,inverse:q,normalize:n,dot:B,cross:A,lerp:w,random:y,transformMat2:D,transformMat2d:F,transformMat3:G,transformMat4:K,rotate:J,angle:I,str:H,exactEquals:M,equals:N,projectAndScale:P,len:h,sub:z,mul:x,div:f,dist:a,sqrDist:b,sqrLen:l},Symbol.toStringTag,{value:"Module"}));r.add=v;r.angle=I;r.ceil=k;r.copy=E;r.cross=A;r.dist=a;r.distance=a;r.div=f;r.divide=f;r.dot=B;r.equals=N;r.exactEquals=M;r.floor=g;r.inverse=q;r.len=h;r.length=h;r.lerp=
w;r.max=p;r.min=m;r.mul=x;r.multiply=x;r.negate=d;r.normalize=n;r.projectAndScale=P;r.random=y;r.rotate=J;r.round=t;r.scale=e;r.scaleAndAdd=c;r.set=C;r.sqrDist=b;r.sqrLen=l;r.squaredDistance=b;r.squaredLength=l;r.str=H;r.sub=z;r.subtract=z;r.transformMat2=D;r.transformMat2d=F;r.transformMat3=G;r.transformMat4=K;r.vec2=ba})},"esri/views/2d/tiling/TileQueue":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../chunks/vec2 ../../support/QueueProcessor".split(" "),
function(r,u,E,C,v,z,x,f,k,g){function m(a,b){a.length=0;b.forEach(h=>a.push(h));return a}const p=new Set,t=[],e=new Map,c=[0,0];E=function(a){function b(l){l=a.call(this,l)||this;l._keyToItem=new Map;l.concurrency=6;l.strategy="scale-first";l.tileInfoView=null;return l}r._inheritsLoose(b,a);var h=b.prototype;h.initialize=function(){const {concurrency:l,process:d,strategy:q}=this;this._queue=new g.QueueProcessor({concurrency:l,process:(n,B)=>{n=this._keyToItem.get(n);return d(n,{signal:B})},peeker:"scale-first"===
q?n=>this._peekByScaleFirst(n):n=>this._peekByCenterFirst(n)})};h.destroy=function(){this.clear();this._queue.destroy();this._queue=null};h.abort=function(l){this._queue.abort("string"===typeof l?l:l.id)};h.clear=function(){this._queue.clear();this._keyToItem.clear();this.notifyChange("updating")};h.has=function(l){return"string"===typeof l?this._keyToItem.has(l):this._keyToItem.has(l.id)};h.isOngoing=function(l){l="string"===typeof l?l:l.id;return this.has(l)&&this._queue.isOngoing(l)};h.pause=function(){this._queue.pause()};
h.push=function(l){const d=l.key.id;if(this._queue.has(d))return this._queue.get(d);const q=this._queue.push(d),n=()=>{this._keyToItem.delete(d);this.notifyChange("updating")};this._keyToItem.set(d,l);q.then(n,n);this.notifyChange("updating");return q};h.reset=function(){this._queue.reset()};h.resume=function(){this._queue.resume()};h._peekByScaleFirst=function(l){if(!this.state)return l.values().next().value;const d=this.tileInfoView;let q=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY;l.forEach(D=>
{D=this._keyToItem.get(D);const F=this.tileInfoView.getTileScale(D.key);e.has(F)||(e.set(F,[]),q=Math.max(F,q),n=Math.min(F,n));e.get(F).push(D.key);p.add(F)});let B=this.state.scale;e.has(B)||(m(t,p),t.sort((D,F)=>D-F),B=t.reduce((D,F)=>Math.abs(F-B)<Math.abs(D-B)?F:D,t[0]));B=Math.min(B,q);B=Math.max(B,n);l=e.get(B);const A=d.getClosestInfoForScale(B),w=A.getColumnForX(this.state.center[0]),y=A.getRowForY(this.state.center[1]);l.sort((D,F)=>{const G=A.denormalizeCol(D.col,D.world),K=A.denormalizeCol(F.col,
F.world);return Math.sqrt((w-G)*(w-G)+(y-D.row)*(y-D.row))-Math.sqrt((w-K)*(w-K)+(y-F.row)*(y-F.row))});p.clear();e.clear();return l[0].id};h._peekByCenterFirst=function(l){if(!this.state)return l.values().next().value;const d=this.tileInfoView,q=this.state.center;let n=Number.POSITIVE_INFINITY,B=null;l.forEach(A=>{A=this._keyToItem.get(A);d.getTileCoords(c,A.key);const w=k.distance(c,q);w<n&&(n=w,B=A.key)});return B.id};r._createClass(b,[{key:"length",get:function(){return this._queue?this._queue.length:
0}},{key:"onGoingCount",get:function(){return this._keyToItem.size}},{key:"updating",get:function(){return 0<this.length||0<this.onGoingCount}}]);return b}(E);u.__decorate([C.property({constructOnly:!0})],E.prototype,"concurrency",void 0);u.__decorate([C.property({constructOnly:!0})],E.prototype,"process",void 0);u.__decorate([C.property()],E.prototype,"state",void 0);u.__decorate([C.property({constructOnly:!0})],E.prototype,"strategy",void 0);u.__decorate([C.property({constructOnly:!0})],E.prototype,
"tileInfoView",void 0);u.__decorate([C.property({readOnly:!0})],E.prototype,"updating",null);return E=u.__decorate([f.subclass("esri.views.2d.tiling.TileQueue")],E)})},"esri/views/2d/tiling/TileStrategy":function(){define(["../../../geometry/support/aaBoundingRect","./TileCache","./TileCoverage","./TileKey"],function(r,u,E,C){const v=new C(0,0,0,0),z=new Map,x=[],f=[];return function(){function k(m){this._previousScale=Number.POSITIVE_INFINITY;this.cachePolicy="keep";this.coveragePolicy="closest";
this.resampling=!0;this.tileIndex=new Map;this.tiles=[];this.buffer=192;this.acquireTile=m.acquireTile;this.releaseTile=m.releaseTile;this.tileInfoView=m.tileInfoView;this.resampling=null==m.resampling||!!m.resampling;m.cachePolicy&&(this.cachePolicy=m.cachePolicy);m.coveragePolicy&&(this.coveragePolicy=m.coveragePolicy);null!=m.buffer&&(this.buffer=m.buffer);m.cacheSize&&(this._tileCache=new u(m.cacheSize,this.tileInfoView,p=>{this.releaseTile(p)}))}var g=k.prototype;g.destroy=function(){this.tileIndex.clear()};
g.update=function(m){const {resampling:p,tileIndex:t}=this,e=this.tileInfoView.getTileCoverage(m.state,this.buffer,this.coveragePolicy);f.length=0;x.length=0;z.clear();if(e){var {minScale:c,maxScale:a}=this.tileInfoView.tileInfo,{spans:b,lodInfo:h}=e,{level:l}=h,{scale:d,center:q,resolution:n}=m.state,B=!m.stationary&&d>this._previousScale;this._previousScale=d;this.tiles.length=0;if(!p&&(d>c||d<a))return this.tiles.length=0,z.clear(),t.forEach(F=>{this.releaseTile(F)}),t.clear(),f.length=0,x.length=
0,z.clear(),E.pool.release(e),!0;t.forEach(F=>F.visible=!0);var A=m=0;if(0<b.length)for(const {row:F,colFrom:G,colTo:K}of b)for(let J=G;J<=K;J++){m++;const I=v.set(l,F,h.normalizeCol(J),h.getWorldForColumn(J)).id;if(t.has(I)){var w=t.get(I);w.isReady?(z.set(I,w),A++):B||this._addParentTile(I,z)}else{if(this._tileCache&&this._tileCache.has(I)){if(w=this._tileCache.pop(I),this.tileIndex.set(I,w),w.isReady){z.set(I,w);A++;continue}}else w=this.acquireTile(v),this.tileIndex.set(I,w);B||this._addParentTile(I,
z)}}var y=A===m;t.forEach((F,G)=>{v.set(G);if(!z.has(G)){var K=this.tileInfoView.intersects(e,v),J="purge"===this.cachePolicy?v.level!==l:v.level>l;!K||!B&&y?!J&&K||x.push(G):F.isReady?J&&"purge"===this.cachePolicy&&this._hasReadyAncestor(v,l)?x.push(G):f.push(G):J&&x.push(G)}});for(var D of f)(m=t.get(D))&&m.isReady&&z.set(D,m);for(const F of x)D=t.get(F),this._tileCache?this._tileCache.add(D):this.releaseTile(D),t.delete(F);z.forEach(F=>this.tiles.push(F));t.forEach(F=>{z.has(F.key.id)||(F.visible=
!1)});this._tileCache&&this._tileCache.prune(l,q,n);E.pool.release(e);z.clear();return y}};g.clear=function(m=!0){const {tileIndex:p}=this;m&&p.forEach(t=>{this.releaseTile(t)});p.clear()};g.updateCacheSize=function(m){this._tileCache&&(this._tileCache.maxSize=m)};g._addParentTile=function(m,p){let t=null;for(;;){m=this.tileInfoView.getTileParentId(m);if(!m)break;if(this.tileIndex.has(m)){if((t=this.tileIndex.get(m))&&t.isReady){p.has(t.key.id)||p.set(t.key.id,t);break}}else if(this._tileCache&&this._tileCache.has(m)&&
(t=this._tileCache.pop(m),this.tileIndex.set(m,t),t&&t.isReady)){p.has(t.key.id)||p.set(t.key.id,t);break}}};g._hasReadyAncestor=function(m,p){const t=r.create();this.tileInfoView.getTileBounds(t,m,!0);for(const e of this.tileIndex.values())if(e.isReady&&e.key.level>=p&&e.key.level<m.level){const c=r.create();this.tileInfoView.getTileBounds(c,e.key,!0);if(r.contains(c,t))return!0}return!1};return k}()})},"esri/views/2d/tiling/TileCache":function(){define(["../../../chunks/vec2"],function(r){return function(){function u(C,
v,z){this.maxSize=C;this.tileInfoView=v;this.removedFunc=z;this._tilePerId=new Map;this._tileKeysPerLevel=[]}var E=u.prototype;E.has=function(C){return this._tilePerId.has(C)};E.get=function(C){return this._tilePerId.get(C)};E.pop=function(C){const v=this._tilePerId.get(C);if(!v)return null;const z=this._tileKeysPerLevel[v.key.level];this._tilePerId["delete"](C);for(let x=0;x<z.length;x++)if(z[x].id===C){z.splice(x,1);break}v.visible=!0;return v};E.add=function(C){C.visible=!1;const v=C.key,z=v.id;
this._tilePerId.has(z)||(this._tilePerId.set(z,C),C=v.level,this._tileKeysPerLevel[C]||(this._tileKeysPerLevel[C]=[]),this._tileKeysPerLevel[C].push(v))};E.prune=function(C,v,z){let x=this._tilePerId.size;if(!(x<=this.maxSize)){for(var f=this._tileKeysPerLevel.length-1;x>this.maxSize&&0<=f;)f!==C&&(x=this._pruneAroundCenterTile(x,v,z,f)),f--;x>this.maxSize&&(x=this._pruneAroundCenterTile(x,v,z,C))}};E._pruneAroundCenterTile=function(C,v,z,x){x=this._tileKeysPerLevel[x];if(!x||0===x.length)return C;
const {size:f,origin:k}=this.tileInfoView.tileInfo,g=z*f[0],m=z*f[1],p=[0,0],t=[0,0];for(x.sort((e,c)=>{p[0]=k.x+g*(e.col+.5);p[1]=k.y-m*(e.row+.5);t[0]=k.x+g*(c.col+.5);t[1]=k.y-m*(c.row+.5);return r.squaredDistance(p,v)-r.squaredDistance(t,v)});0<x.length&&(z=x.pop(),this._removeTile(z.id),C--,C!==this.maxSize););return C};E._removeTile=function(C){const v=this._tilePerId.get(C);this.removedFunc&&this.removedFunc(v);this._tilePerId["delete"](C)};return u}()})},"esri/views/2d/engine/webgl/mesh/VertexDataWriter":function(){define(["exports",
"../../../../../chunks/_rollupPluginBabelHelpers","../definitions","./heuristics","../util/Writer"],function(r,u,E,C,v){let z=function(){function x(k,g,m){this._start={index:0,vertex:0};m=C.getMeshSizeHint(k,g,m);g/=4;this.geometryType=k;this._records=new v(Int32Array,m.recordBytes);this._indices=new v(Uint32Array,m.indexBytes);this._vertices=new v(Uint32Array,m.vertexBytes);this._metrics=new v(Float32Array,0);this._strideInt=g}var f=x.prototype;f.serialize=function(k){const g=this._records.buffer(),
m=this._indices.buffer(),p=this._vertices.buffer(),t=this._metrics.length?this._metrics.buffer():null,e=4*this._strideInt;k.push(g,m,p);return{stride:e,records:g,indices:m,vertices:p,metrics:t}};f.vertexEnsureSize=function(k){this._vertices.ensureSize(k)};f.indexEnsureSize=function(k){this._indices.ensureSize(k)};f.recordStart=function(){this._start.index=this._indices.length;this._start.vertex=this._vertices.length};f.recordEnd=function(k,g,m,p,t,e,c,a){this._records.push(k);this._records.push(g);
this._records.push(m);this._records.push(p);this._records.push(t);this._records.push(e);this._records.push(c);this._records.writeF32(a)};f.writeIndex=function(k){this._indices.push(k)};f.writeVertex=function(k){this._vertices.push(k)};f.writeVertexF32=function(k){this._vertices.writeF32(k)};f.copyLastFrom=function(k,g,m){var p=k._records.length-E.DISPLAY_RECORD_INT_PER_ELEMENT;const t=k._records.getValue(p),e=k._records.getValue(p+1),c=k._records.getValue(p+2),a=k._records.getValue(p+4),b=k._records.getValue(p+
6);p=k._records.getValue(p+7);const h=this._vertices.length;var l=(k._start.vertex-this._vertices.length)/this._strideInt;const d=this._indices.length,q=this.vertexCount;for(var n=k._start.index;n!==k._indices.length;n++){const B=k._indices.getValue(n);this._indices.push(B-l)}for(l=k._start.vertex;l!==k._vertices.length;l++)n=k._vertices.getValue(l),this._vertices.push(n);for(k=h;k<=this._vertices.length;k+=this._strideInt)this._vertices.i1616Add(k,g,m);this._records.push(t);this._records.push(e);
this._records.push(c);this._records.push(d);this._records.push(a);this._records.push(q);this._records.push(b);this._records.push(p)};u._createClass(x,[{key:"strideInt",get:function(){return this._strideInt}},{key:"recordCount",get:function(){return this._records.length/E.DISPLAY_RECORD_INT_PER_ELEMENT}},{key:"vertexCount",get:function(){return this._vertices.length/this._strideInt}},{key:"indexCount",get:function(){return this._indices.length}},{key:"indexWriter",get:function(){return this._indices}},
{key:"vertexWriter",get:function(){return this._vertices}},{key:"metricWriter",get:function(){return this._metrics}}]);return x}();r.VertexDataWriter=z;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/heuristics":function(){define(["exports","../definitions","../enums"],function(r,u,E){const C=new Map;C.set(E.WGLGeometryType.MARKER,{multiplier:1,indicesPerRecord:6,verticesPerRecord:4});C.set(E.WGLGeometryType.LINE,{multiplier:1,
indicesPerRecord:24,verticesPerRecord:8});C.set(E.WGLGeometryType.FILL,{multiplier:1,indicesPerRecord:10,verticesPerRecord:10});C.set(E.WGLGeometryType.TEXT,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});C.set(E.WGLGeometryType.LABEL,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});r.getMeshHeuristic=function(v){return C.get(v)};r.getMeshSizeHint=function(v,z,x){const {indicesPerRecord:f,multiplier:k,verticesPerRecord:g}=C.get(v);return{recordBytes:x*u.DISPLAY_RECORD_INT_PER_ELEMENT*
Uint32Array.BYTES_PER_ELEMENT,indexBytes:k*f*x*Uint32Array.BYTES_PER_ELEMENT,vertexBytes:k*g*x*z}};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/util/Writer":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers"],function(r){return function(){function u(C,v){this._pos=0;v=v?this._roundToNearest(v,C.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(v);this._buffer=new C(this._array);this._ctor=C;this._i16View=
new Int16Array(this._array)}var E=u.prototype;E._roundToNearest=function(C,v){C=Math.round(C);return C+(v-C%v)};E._ensureSize=function(C){if(this._pos+C>=this._buffer.length){C=this._roundToNearest(1.25*(this._array.byteLength+C*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT);C=new ArrayBuffer(C);const v=new this._ctor(C);v.set(this._buffer,0);this._array=C;this._buffer=v;this._i16View=new Int16Array(this._array)}};E.ensureSize=function(C){this._ensureSize(C)};E.writeF32=function(C){this._ensureSize(1);
const v=this._pos;(new Float32Array(this._array,4*this._pos,1))[0]=C;this._pos++;return v};E.push=function(C){this._ensureSize(1);const v=this._pos;this._buffer[this._pos++]=C;return v};E.writeFixed=function(C){this._buffer[this._pos++]=C};E.setValue=function(C,v){this._buffer[C]=v};E.i1616Add=function(C,v,z){this._i16View[2*C]+=v;this._i16View[2*C+1]+=z};E.getValue=function(C){return this._buffer[C]};E.incr=function(C){if(this._buffer.length<C)throw Error("Increment index overflows the target buffer");
this._buffer[C]++};E.decr=function(C){this._buffer[C]--};E.writeRegion=function(C){this._ensureSize(C.length);const v=this._pos;this._buffer.set(C,this._pos);this._pos+=C.length;return v};E.writeManyFrom=function(C,v,z){for(this._ensureSize(z-v);v!==z;v++)this.writeFixed(C._buffer[v])};E.buffer=function(){const C=this._array.slice(0,4*this._pos);this.destroy();return C};E.toArray=function(){const C=this._array,v=[];for(let z=0;z<C.byteLength/4;z++)v.push(C[z]);return v};E.seek=function(C){this._pos=
C};E.destroy=function(){this._buffer=this._array=null};r._createClass(u,[{key:"length",get:function(){return this._pos}}]);return u}()})},"esri/views/2d/layers/features/support/tileUtils":function(){define(["exports","./Tile"],function(r,u){function E(C,v,z,x){C=C.clone();const f=1<<C.level;v=C.col+v;z=C.row+z;x&&0>v?(C.col=v+f,--C.world):v>=f?(C.col=v-f,C.world+=1):C.col=v;C.row=z;return C}r.getPow2NeighborKey=E;r.getPow2NeighborTile=function(C,v,z){v=E(C.key,v,z,C.tileInfoView.tileInfo.isWrappable);
return new u.Tile(C.tileInfoView,v)};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../../core/maybe ../../../../../../core/promiseUtils ../../../../../../geometry/libtess ../../DisplayId ../templates/WGLLabelTemplate ../templates/WGLMarkerTemplate ../templates/WGLTemplateStore".split(" "),
function(r,u,E,C,v,z,x,f,k,g){E=function(){function m(t,e,c){this._loadPromise=z.loadLibtess();this._geometryType=t;this._idField=e;this._templateStore=c}var p=m.prototype;p.update=function(t,e){C.isSome(t.mesh.labels)&&(this._labelTemplates=this._createLabelTemplates(t.mesh.labels,e));this._schema=t};p._createLabelTemplates=function(t,e){const c=new Map;if("simple"===t.type){for(var a of t.classes)t=f.fromLabelClass(a,e),c.set(a.index,t);return c}for(const b in t.classes){a=t.classes[b];for(const h of a)a=
f.fromLabelClass(h,e),c.set(h.index,a)}return c};p.analyze=function(){var t=u._asyncToGenerator(function*(e,c,a,b,h,l,d){if(!v.isAborted(d)){var q;"dictionary"===a.type&&(q=yield a.analyze(this._idField,e.copy(),c,h,l,d));for(c=0;e.next();){var n=void 0;n=q?q[c++]:C.isSome(b)&&x.isAggregateId(e.getDisplayId())&&1!==e.readAttribute("cluster_count")?b.match(this._idField,e,this._geometryType,h,l):a.match(this._idField,e,this._geometryType,h,l);e.setGroupId(n);if(g.isDynamicId(n)){n=this._templateStore.getDynamicTemplateGroup(n);
for(const B of n)B&&B.analyze&&B.analyze(this._templateStore,e,h,l)}}yield this._loadPromise;return this._templateStore.finalize(d)}});return function(e,c,a,b,h,l,d){return t.apply(this,arguments)}}();p.analyzeGraphics=function(){var t=u._asyncToGenerator(function*(e,c,a,b,h,l){if(!v.isAborted(l)){e=e.getCursor();for(a&&(yield a.analyze(this._idField,e.copy(),c,b,h,l));e.next();){c=e.getGroupId();if(null==c||-1===c)c=a.match(this._idField,e,e.geometryType,b,h),e.setGroupId(c);if(g.isDynamicId(c)){const d=
this._templateStore.getDynamicTemplateGroup(c);for(const q of d)q&&q.analyze&&q.analyze(this._templateStore,e,b,h)}e.setGroupId(c)}yield this._loadPromise;return this._templateStore.finalize(l)}});return function(e,c,a,b,h,l){return t.apply(this,arguments)}}();p.writeGraphic=function(t,e,c,a){const b=e.getGroupId(),h=e.getDisplayId(),l=this._templateStore.getTemplateGroup(b);t.featureStart(e.insertAfter,0);if(null!=h){if(g.isDynamicId(b))for(const d of l)d&&d.bindFeature(e,null,null);if(l){for(const d of l)d&&
d.write(t,e,c,a);t.featureEnd()}}};p.writeCursor=function(t,e,c,a,b,h,l){const d=e.getGroupId(),q=e.getDisplayId(),n=this._templateStore.getTemplateGroup(d),B=this._schema.mesh.sortKey;let A=0;C.isSome(B)&&(A=null!=B.fieldIndex?e.getComputedNumericAtIndex(B.fieldIndex):null!=B.field?e.readAttribute(B.field):e.readAttribute(this._idField),A*="asc"===B.order?1:-1);t.featureStart(0,null==A||isNaN(A)?0:A);if(null!=q&&n){if(g.isDynamicId(d))for(const w of n)w.bindFeature(e,c,a);for(const w of n)w.write(t,
e,b,l);C.isSome(h)&&t.hasRecords&&(c=h&&this._findLabelRef(n),this._writeLabels(t,e,h,c,b,l));t.featureEnd()}};p._findLabelRef=function(t){for(const e of t)if(e instanceof k)return e;return null};p._writeLabels=function(t,e,c,a,b,h){for(const l of c)if(C.isSome(l)&&l){const {glyphs:d,rtl:q,index:n}=l;c=this._labelTemplates.get(n);c.setZoomLevel(b);c.bindReferenceTemplate(a);c.bindTextInfo(d,q);c.write(t,e,null,h)}};u._createClass(m,[{key:"templates",get:function(){return this._templateStore}}]);return m}();
r.WGLMeshFactory=E;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./segmentUtils ./WGLTextTemplate".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t,e,c){const a=E.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),b=(l,d="mapview-labeling")=>a.error(new u(d,l)),h=function(l){const d=new Map;return q=>{d.has(q)||d.set(q,l(q));return d.get(q)}}(l=>{let d=0;if(0===l)return Infinity;for(;!(l%2);)d++,l/=2;return d});return function(l){function d(n,B,A,w){var y,D,F;var G=l.call(this,n,A.font.size,A.haloSize||0,A.font.size,A.color&&k.premultiplyAlphaRGBAArray(A.color)||0,A.haloColor&&k.premultiplyAlphaRGBAArray(A.haloColor)||
0,A.horizontalAlignment,A.verticalAlignment,f.isMapAligned(B.labelPlacement)?x.Alignment.MAP:x.Alignment.SCREEN,A.font.decoration,!1,A.angle||0,A.xoffset,A.yoffset,A.lineWidth,A.lineHeight,null,null,null,null,null)||this;G._outLineLabelAngle=0;G._refPlacementPadding=0;G._refPlacementDirX=0;G._refPlacementDirY=0;G._refOffsetX=0;G._refOffsetY=0;G._zoomLevel=0;G.geometryType=m.WGLGeometryType.LABEL;G._allowOverrun=null!=(y=B.allowOverrun)?y:!1;G._repeatLabel=null!=(D=B.repeatLabel)?D:!0;G._labelPosition=
null!=(F=B.labelPosition)?F:"curved";y=!!B.minScale&&w.scaleToZoom(B.minScale)||0;y=C.clamp(y,0,25.5);w=!!B.maxScale&&w.scaleToZoom(B.maxScale)||255;w=C.clamp(w,0,25.5);const [K,J]=f.getAlignmentFromPlacement(B.labelPlacement);G._xAlignD=K;G._yAlignD=J;G._minZoom=y;G._maxZoom=w;G._refPlacementPadding=z.pt2px(A.haloSize)+g.TEXT_PLACEMENT_PADDING;G._repeatLabelDistance=B.repeatLabelDistance?z.pt2px(B.repeatLabelDistance):128;n=t.LabelMaterialKey.load(n);n.sdf=!0;G._materialKey=n.data;return G}r._inheritsLoose(d,
l);d.fromLabelClass=function(n,B){if("esriServerLinePlacementCenterAlong"===n.labelPlacement){const A=n.symbol;A.xoffset=0;A.yoffset=0;A.angle=0;A.font.decoration="none"}return new d(n.materialKey,n,n.symbol,B)};var q=d.prototype;q.setZoomLevel=function(n){this._zoomLevel=n};q.bindReferenceTemplate=function(n){let B=f.getXDirection(this._xAlignD),A=f.getYDirection(this._yAlignD);this._refOffsetY=this._refOffsetX=0;if(v.isNone(n))this._refSymbolAndPlacementOffset=p.i8888to32(0,0,Math.floor(127*B+127),
Math.floor(127*A+127));else{if("circle"===n.boundsType&&(B||A)){var w=Math.sqrt(B*B+A*A);B/=w;A/=w}w=Math.max(n.height,n.width);this._refSymbolAndPlacementOffset=p.i8888to32(4*this._refPlacementPadding,w,Math.floor(127*B+127),Math.floor(127*A+127));this._referenceSize=w;this._refPlacementDirX=B;this._refPlacementDirY=A;this._refOffsetX=n.xOffset;this._refOffsetY=n.yOffset}};q._write=function(n,B){if(!v.isNone(this._shapingInfo)){var A=this._shapingInfo,w=B.getDisplayId(),y="esriGeometryPolygon"===
B.geometryType?B.readLegacyCentroid():B.readLegacyGeometry();if(y)switch(this.current={out:n,inId:w,inShaping:A,zoomLevel:this._zoomLevel},B.geometryType){case "esriGeometryPolyline":this._placeLineLabels(y);break;case "esriGeometryPoint":case "esriGeometryPolygon":this._placePointLabels(y);break;default:b("mapview-labeling",`Geometry of type ${B.geometryType} is not supported`)}}};q._isVisible=function(n,B){const A=Math.floor(10*this.current.zoomLevel);return Math.floor(10*n)<=A&&A<=Math.floor(10*
B)};q._placePointLabels=function(n){const {out:B,inId:A,inShaping:w}=this.current;this._writeGlyphs(B,A,n,w)};q._placeLineLabels=function(n){n=e.smoothPaths(n.paths,this.current.inShaping.bounds.width);const B=this._placeSubdivGlyphs.bind(this),A=(this._shapedBox.width+this._repeatLabelDistance)/2;for(const w of n)e.pathDivide(w,A,B,this._repeatLabel)};q._placeSubdivGlyphs=function(n,B,A,w){var y=h(B),D=this._shapedBox.width/2,F=Math.sqrt(this._repeatLabelDistance)/2;A=Math.min(A,w-A);D=this.current.inShaping.isMultiline?
25:Math.log2(A/(F+D/2));y=Math.max(this._minZoom,this.current.zoomLevel+1-(0===B?D:Math.min(y,D)));D=this.current.zoomLevel-y;F=this._shapedBox.width/2*2**D;this.current.inShaping.isMultiline?0===B&&this._placeStraight(n,y):this._allowOverrun&&0>D?this._placeStraightAlong(n,this._minZoom):"parallel"===this._labelPosition?this._placeStraightAlong(n,y):"curved"===this._labelPosition&&this._placeCurved(n,y,F)};q._placeStraight=function(n,B){const {out:A,inId:w,inShaping:y}=this.current,D=Math.ceil((180/
Math.PI*n.angle+180)%360);this._outLineLabelAngle=Math.round(254/360*Math.ceil(180/Math.PI*n.angle%360));this._writeGlyphs(A,w,n,y,B);this._outLineLabelAngle=Math.round(254/360*D);this._writeGlyphs(A,w,n,y,B)};q._placeCurved=function(n,B,A){const {out:w,inId:y}=this.current;w.metricStart(y,B,n.x,n.y,0,0,0,0);const D=n.clone(),F=(180/Math.PI*n.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*n.angle%360*(254/360));this._placeFirst(D,B,1);this._placeBack(n,D,B,A,1);this._placeForward(n,
D,B,A,1);this._outLineLabelAngle=Math.round(254/360*F);this._placeFirst(D,B,0);this._placeBack(n,D,B,A,0);this._placeForward(n,D,B,A,0);w.metricEnd()};q._placeStraightAlong=function(n,B){const {out:A,inId:w}=this.current;A.metricStart(w,B,n.x,n.y,0,0,0,0);const y=n.clone(),D=(180/Math.PI*n.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*n.angle%360*(254/360));this._placeFirst(y,B,1,!0);this._outLineLabelAngle=Math.round(254/360*D);this._placeFirst(y,B,0,!0);A.metricEnd()};q._placeBack=
function(n,B,A,w,y){const D=n.clone();for(n=n.backwardLength+0;D.prev()&&!(n>=w);)this._placeOnSegment(D,B,n,A,-1,y),n+=D.length+0};q._placeForward=function(n,B,A,w,y){const D=n.clone();for(n=n.remainingLength+0;D.next()&&!(n>=w);)this._placeOnSegment(D,B,n,A,1,y),n+=D.length+0};q._placeFirst=function(n,B,A,w=!1){const y=this.current.inShaping;var D=y.glyphs;const F=this.current.zoomLevel,{out:G,inId:K}=this.current;for(const J of D)D=J.x>y.bounds.x?A:1-A,D=Math.max(0,F+Math.log2(Math.abs(J.x+J.width/
2-y.bounds.x)/(D*n.remainingLength+(1-D)*n.backwardLength))),D=Math.max(B,w?0:D),J.maxZoom=25,J.angle=n.angle+(1-A)*Math.PI,J.minZoom=D,this._writeGlyph(G,K,n.x,n.y,J),A&&this._isVisible(J.minZoom,J.maxZoom)&&(D=J.bounds,G.metricBoxWrite(D.center[0],D.center[1],D.width,D.height))};q._placeOnSegment=function(n,B,A,w,y,D){var F=this.current.inShaping.glyphs;const {out:G,inId:K}=this.current,J=this.current.inShaping,I=this.current.zoomLevel;var H=n.x+n.dx/n.length*-y*A,M=n.y+n.dy/n.length*-y*A;for(const P of F)if((F=
P.x>J.bounds.x?D:1-D)&&1===y||!F&&-1===y){var N=Math.abs(P.x+P.width/2-J.bounds.x);F=Math.max(0,I+Math.log2(N/A)-.1);N=Math.max(w,I+Math.log2(N/(A+n.length+0)));0!==F&&(P.angle=n.angle+(1-D)*Math.PI,P.minZoom=N,P.maxZoom=F,this._writeGlyph(G,K,H,M,P),D&&this._isVisible(P.minZoom,P.maxZoom)&&(F=P.bounds,G.metricBoxWrite(F.center[0]+(n.x-B.x),F.center[1]+(n.y-B.y),F.width,F.height)))}};q._writeGlyphs=function(n,B,A,w,y=this._minZoom){if(!(0>A.x||512<=A.x||0>A.y||512<=A.y)){var D=A.x+this._refOffsetX;
A=A.y-this._refOffsetY;for(const F of w.glyphs)F.minZoom=y,F.maxZoom=this._maxZoom,this._writeGlyph(n,B,D,A,F);w=w.boundsT;n.metricStart(B,y,D,A,this._refPlacementDirX,this._refPlacementDirY,this._referenceSize,this._materialKey);n.metricBoxWrite(w.center[0],w.center[1],w.width,w.height);n.metricEnd()}};q._writeVertexCommon=function(n,B,A,w){const y=this._color,D=this._haloColor,F=p.i8888to32(0,0,this._size,this._haloSize);w=p.i8888to32(Math.floor(10*Math.max(w.minZoom,this._minZoom)),Math.floor(10*
Math.min(w.maxZoom,this._maxZoom)),this._outLineLabelAngle,0);n.vertexWrite(A);n.vertexWrite(B);n.vertexWrite(y);n.vertexWrite(D);n.vertexWrite(F);n.vertexWrite(this._refSymbolAndPlacementOffset);n.vertexWrite(w)};r._createClass(d,[{key:"_shapedBox",get:function(){return v.unwrap(this._shapingInfo).bounds}}]);return d}(c)})},"esri/views/2d/engine/webgl/alignmentUtils":function(){define(["exports"],function(r){r.HAlign=void 0;(function(u){u[u.Left=-1]="Left";u[u.Center=0]="Center";u[u.Right=1]="Right"})(r.HAlign||
(r.HAlign={}));r.VAlign=void 0;(function(u){u[u.Top=1]="Top";u[u.Center=0]="Center";u[u.Bottom=-1]="Bottom";u[u.Baseline=2]="Baseline"})(r.VAlign||(r.VAlign={}));r.getAlignmentFromPlacement=function(u){switch(u){case "above-left":case "esriServerPointLabelPlacementAboveLeft":return[r.HAlign.Right,r.VAlign.Bottom];case "above-center":case "above-along":case "esriServerPointLabelPlacementAboveCenter":case "esriServerLinePlacementAboveAlong":return[r.HAlign.Center,r.VAlign.Bottom];case "above-right":case "esriServerPointLabelPlacementAboveRight":return[r.HAlign.Left,
r.VAlign.Bottom];case "center-left":case "esriServerPointLabelPlacementCenterLeft":return[r.HAlign.Right,r.VAlign.Center];case "center-center":case "center-along":case "esriServerPointLabelPlacementCenterCenter":case "esriServerLinePlacementCenterAlong":return[r.HAlign.Center,r.VAlign.Center];case "center-right":case "esriServerPointLabelPlacementCenterRight":return[r.HAlign.Left,r.VAlign.Center];case "below-left":case "esriServerPointLabelPlacementBelowLeft":return[r.HAlign.Right,r.VAlign.Top];case "below-center":case "below-along":case "esriServerPointLabelPlacementBelowCenter":case "esriServerLinePlacementBelowAlong":return[r.HAlign.Center,
r.VAlign.Top];case "below-right":case "esriServerPointLabelPlacementBelowRight":return[r.HAlign.Left,r.VAlign.Top];case "always-horizontal":case "esriServerPolygonPlacementAlwaysHorizontal":return[r.HAlign.Center,r.VAlign.Center];default:return console.debug(`Found invalid placement type ${u}`),[r.HAlign.Center,r.VAlign.Center]}};r.getJustification=function(u){switch(u){case "left":return r.HAlign.Left;case "right":return r.HAlign.Right;case "center":return r.HAlign.Center}};r.getXAnchorDirection=
function(u){switch(u){case "left":return r.HAlign.Left;case "right":return r.HAlign.Right;case "center":return r.HAlign.Center}};r.getXDirection=function(u){switch(u){case r.HAlign.Right:return-1;case r.HAlign.Center:return 0;case r.HAlign.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${u}`),0}};r.getYAnchorDirection=function(u){switch(u){case "top":return r.VAlign.Top;case "middle":return r.VAlign.Center;case "baseline":return r.VAlign.Baseline;case "bottom":return r.VAlign.Bottom}};
r.getYDirection=function(u){switch(u){case r.VAlign.Top:return 1;case r.VAlign.Center:return 0;case r.VAlign.Bottom:case r.VAlign.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${u}`),0}};r.isMapAligned=function(u){switch(u){case "above-along":case "below-along":case "center-along":case "esriServerLinePlacementAboveAlong":case "esriServerLinePlacementBelowAlong":case "esriServerLinePlacementCenterAlong":return!0;default:return!1}};Object.defineProperties(r,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/materialKey/MaterialKey":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/Error","../alignmentUtils","../enums"],function(r,u,E,C,v){function z(l){return l===v.WGLSymbologyType.SIMPLE||l===v.WGLSymbologyType.OUTLINE_FILL_SIMPLE}function x(l){return l===v.WGLSymbologyType.OUTLINE_FILL||l===v.WGLSymbologyType.OUTLINE_FILL_SIMPLE}const f=Object.keys(v.WGLSymbologyType).filter(l=>
"number"===typeof v.WGLSymbologyType[l]).reduce((l,d)=>({...l,[d]:v.WGLSymbologyType[d]}),{});let k=function(){function l(q){this._data=0;this._data=q}l.load=function(q){const n=this.shared;n.data=q;return n};var d=l.prototype;d.setBit=function(q,n){q=1<<q;this._data=n?this._data|q:this._data&~q};d.bit=function(q){return(this._data&1<<q)>>q};d.setBits=function(q,n,B){for(let A=n,w=0;A<B;A++,w++)this.setBit(A,0!==(q&1<<w))};d.bits=function(q,n){let B=0;for(let A=q,w=0;A<n;A++,w++)B|=this.bit(A)<<w;
return B};d.hasVV=function(){return!1};d.setVV=function(q,n){};d.getVariation=function(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf,symbologyType:{value:v.WGLSymbologyType[this.symbologyType],options:f,namespace:"SYMBOLOGY_TYPE"}}};d.getVariationHash=function(){return this._data&~(7&this.textureBinding)};u._createClass(l,[{key:"data",get:function(){return this._data},set:function(q){this._data=q}},{key:"geometryType",get:function(){return this.bits(8,11)},set:function(q){this.setBits(q,
8,11)}},{key:"mapAligned",get:function(){return!!this.bit(20)},set:function(q){this.setBit(20,q)}},{key:"sdf",get:function(){return!!this.bit(11)},set:function(q){this.setBit(11,q)}},{key:"pattern",get:function(){return!!this.bit(12)},set:function(q){this.setBit(12,q)}},{key:"textureBinding",get:function(){return this.bits(0,8)},set:function(q){this.setBits(q,0,8)}},{key:"symbologyType",get:function(){return this.bits(21,26)},set:function(q){this.setBits(q,21,26)}},{key:"geometryTypeString",get:function(){switch(this.geometryType){case v.WGLGeometryType.FILL:return"fill";
case v.WGLGeometryType.MARKER:return"marker";case v.WGLGeometryType.LINE:return"line";case v.WGLGeometryType.TEXT:return"text";case v.WGLGeometryType.LABEL:return"label";default:throw new E(`Unable to handle unknown geometryType: ${this.geometryType}`);}}}]);return l}();k.shared=new k(0);const g=l=>function(d){function q(){return d.apply(this,arguments)||this}u._inheritsLoose(q,d);var n=q.prototype;n.hasVV=function(){return d.prototype.hasVV.call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||
this.vvSizeFieldStops||this.vvSizeUnitValue};n.setVV=function(B,A){d.prototype.setVV.call(this,B,A);{var w=this.geometryType;const y=v.WGLVVFlag.SIZE_FIELD_STOPS|v.WGLVVFlag.SIZE_MINMAX_VALUE|v.WGLVVFlag.SIZE_SCALE_STOPS|v.WGLVVFlag.SIZE_UNIT_VALUE,D=(B&(v.WGLVVTarget.FIELD_TARGETS_OUTLINE|v.WGLVVTarget.MINMAX_TARGETS_OUTLINE|v.WGLVVTarget.SCALE_TARGETS_OUTLINE|v.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;A=w===v.WGLGeometryType.LINE&&A.isOutline||w===v.WGLGeometryType.FILL&&x(A.symbologyType)?y&D:y&
~D}B&=A;this.vvSizeMinMaxValue=!!(B&v.WGLVVFlag.SIZE_MINMAX_VALUE);this.vvSizeFieldStops=!!(B&v.WGLVVFlag.SIZE_FIELD_STOPS);this.vvSizeUnitValue=!!(B&v.WGLVVFlag.SIZE_UNIT_VALUE);this.vvSizeScaleStops=!!(B&v.WGLVVFlag.SIZE_SCALE_STOPS)};u._createClass(q,[{key:"vvSizeMinMaxValue",get:function(){return 0!==this.bit(16)},set:function(B){this.setBit(16,B)}},{key:"vvSizeScaleStops",get:function(){return 0!==this.bit(17)},set:function(B){this.setBit(17,B)}},{key:"vvSizeFieldStops",get:function(){return 0!==
this.bit(18)},set:function(B){this.setBit(18,B)}},{key:"vvSizeUnitValue",get:function(){return 0!==this.bit(19)},set:function(B){this.setBit(19,B)}}]);return q}(l),m=l=>function(d){function q(){return d.apply(this,arguments)||this}u._inheritsLoose(q,d);var n=q.prototype;n.hasVV=function(){return d.prototype.hasVV.call(this)||this.vvRotation};n.setVV=function(B,A){d.prototype.setVV.call(this,B,A);this.vvRotation=!A.isOutline&&!!(B&v.WGLVVFlag.ROTATION)};u._createClass(q,[{key:"vvRotation",get:function(){return 0!==
this.bit(15)},set:function(B){this.setBit(15,B)}}]);return q}(l),p=l=>function(d){function q(){return d.apply(this,arguments)||this}u._inheritsLoose(q,d);var n=q.prototype;n.hasVV=function(){return d.prototype.hasVV.call(this)||this.vvColor};n.setVV=function(B,A){d.prototype.setVV.call(this,B,A);this.vvColor=!A.isOutline&&!!(B&v.WGLVVFlag.COLOR)};u._createClass(q,[{key:"vvColor",get:function(){return 0!==this.bit(13)},set:function(B){this.setBit(13,B)}}]);return q}(l),t=l=>function(d){function q(){return d.apply(this,
arguments)||this}u._inheritsLoose(q,d);var n=q.prototype;n.hasVV=function(){return d.prototype.hasVV.call(this)||this.vvOpacity};n.setVV=function(B,A){d.prototype.setVV.call(this,B,A);this.vvOpacity=!A.isOutline&&!!(B&v.WGLVVFlag.OPACITY)};u._createClass(q,[{key:"vvOpacity",get:function(){return 0!==this.bit(14)},set:function(B){this.setBit(14,B)}}]);return q}(l);let e=function(l){function d(){return l.apply(this,arguments)||this}u._inheritsLoose(d,l);d.load=function(q){const n=this.shared;n.data=
q;return n};d.from=function(q){const {symbologyType:n,vvFlags:B}=q,A=this.load(0);A.geometryType=v.WGLGeometryType.FILL;A.symbologyType=n;n!==v.WGLSymbologyType.DOT_DENSITY&&A.setVV(B,q);return A.data};d.prototype.getVariation=function(){return{...l.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return d}(p(t(g(k))));
e.shared=new e(0);let c=function(l){function d(){return l.apply(this,arguments)||this}u._inheritsLoose(d,l);d.load=function(q){const n=this.shared;n.data=q;return n};d.from=function(q){const {symbologyType:n,vvFlags:B}=q,A=this.load(0);A.geometryType=v.WGLGeometryType.MARKER;A.symbologyType=n;n!==v.WGLSymbologyType.HEATMAP&&A.setVV(B,q);return A.data};d.prototype.getVariation=function(){return{...l.prototype.getVariation.call(this),vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,
vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return d}(p(t(m(g(k)))));c.shared=new c(0);let a=function(l){function d(){return l.apply(this,arguments)||this}u._inheritsLoose(d,l);d.load=function(q){const n=this.shared;n.data=q;return n};d.from=function(q){const n=this.load(0);n.geometryType=v.WGLGeometryType.LINE;n.symbologyType=q.symbologyType;n.setVV(q.vvFlags,q);return n.data};d.prototype.getVariation=
function(){return{...l.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return d}(p(t(g(k))));a.shared=new a(0);let b=function(l){function d(){return l.apply(this,arguments)||this}u._inheritsLoose(d,l);d.load=function(q){const n=this.shared;n.data=q;return n};d.from=function(q){const n=this.load(0);n.geometryType=
v.WGLGeometryType.TEXT;n.symbologyType=q.symbologyType;n.setVV(q.vvFlags,q);return n.data};d.prototype.getVariation=function(){return{...l.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return d}(p(t(m(g(k)))));b.shared=new b(0);let h=function(l){function d(){return l.apply(this,arguments)||
this}u._inheritsLoose(d,l);d.load=function(q){const n=this.shared;n.data=q;return n};d.from=function(q){const n=this.load(0);n.geometryType=v.WGLGeometryType.LABEL;n.symbologyType=q.symbologyType;n.setVV(q.vvFlags,q);n.mapAligned=C.isMapAligned(q.placement);return n.data};d.prototype.getVariation=function(){return{...l.prototype.getVariation.call(this),vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};
return d}(g(k));h.shared=new h(0);r.FillMaterialKey=e;r.LabelMaterialKey=h;r.LineMaterialKey=a;r.MarkerMaterialKey=c;r.MaterialKeyBase=k;r.TextMaterialKey=b;r.createMaterialKey=function(l,d){switch(l){case v.WGLGeometryType.FILL:return e.from(d);case v.WGLGeometryType.LINE:return a.from(d);case v.WGLGeometryType.MARKER:return c.from(d);case v.WGLGeometryType.TEXT:return b.from(d);case v.WGLGeometryType.LABEL:return h.from(d);default:throw Error(`Unable to createMaterialKey for unknown geometryType ${l}`);
}};r.hasOutlineFillSymbology=function(l){return x(l.symbologyType)};r.hasSimpleSymbology=function(l){return z(l.symbologyType)};r.hydrateMaterialKey=function(l){switch(k.load(l).geometryType){case v.WGLGeometryType.MARKER:return new c(l);case v.WGLGeometryType.FILL:return new e(l);case v.WGLGeometryType.LINE:return new a(l);case v.WGLGeometryType.TEXT:return new b(l);case v.WGLGeometryType.LABEL:return new h(l)}};r.isOutlineFillSymbology=x;r.isSimpleSymbology=z;Object.defineProperties(r,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/segmentUtils":function(){define(["exports","../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/maybe","./util"],function(r,u,E,C){function v(g){return g.length-1}function z(g){let m=0;for(let p=0;p<v(g);p++)m+=x(g,p);return m}function x(g,m,p=1){const [t,e]=g[m+1];return Math.sqrt(t*t+e*e)*p}function f(g,m,p,t,e){if(!(p<m)){var c=t.clone().seek(p/2);E.isNone(c)||(g(c.clone(),p,e),p=(p-m)/
2,c=E.unwrap(c.seek(m/2)),f(g,m,p,t,e+1),f(g,m,p,c,e+1))}}let k=function(){function g(p,t,e,c,a){this._segments=p;this._index=t;this._distance=e;this._xStart=c;this._yStart=a;this._done=!1}g.create=function(p){return new g(p,0,0,p[0][0],p[0][1])};var m=g.prototype;m.clone=function(){return new g(this._segments,this._index,this._distance,this.xStart,this.yStart)};m.equals=function(p){return this._index===p._index||p._index===this._index-1&&(0===this._distance||1===p._distance)||p._index===this._index+
1&&(1===this._distance||0===p._distance)};m.leq=function(p){return this._index<p._index||this._index===p._index&&this._distance<=p._distance};m.geq=function(p){return this._index>p._index||this._index===p._index&&this._distance>=p._distance};m.hasPrev=function(){return 0<=this._index-1};m.hasNext=function(){return this._index+1<v(this._segments)};m.next=function(){if(!this.hasNext())return null;this._xStart+=this.dx;this._yStart+=this.dy;this._distance=0;this._index+=1;return this};m.prev=function(){if(!this.hasPrev())return this._done=
!0,null;--this._index;this._xStart-=this.dx;this._yStart-=this.dy;this._distance=1;return this};m._seekBackwards=function(p,t){var e=this.backwardLength;if(p<=e)return this._distance=(e-p)/this.length,this;for(e=this.backwardLength;this.prev();){if(e+this.length>p)return this._seekBackwards(p-e);e+=this.length}this._distance=0;return t?this:null};m.seek=function(p,t=!1){if(0>p)return this._seekBackwards(Math.abs(p),t);if(p<=this.remainingLength)return this._distance=(this.backwardLength+p)/this.length,
this;let e=this.remainingLength;for(;this.next();){if(e+this.length>p)return this.seek(p-e,t);e+=this.length}this._distance=1;return t?this:null};u._createClass(g,[{key:"_segment",get:function(){return this._segments[this._index+1]}},{key:"angle",get:function(){const p=this.dy;let t=Math.acos((0*p+-1*-this.dx)/(1*this.length));0<p&&(t=2*Math.PI-t);return t}},{key:"xStart",get:function(){return this._xStart}},{key:"yStart",get:function(){return this._yStart}},{key:"x",get:function(){return this.xStart+
this.distance*this.dx}},{key:"y",get:function(){return this.yStart+this.distance*this.dy}},{key:"dx",get:function(){return this._segment[0]}},{key:"dy",get:function(){return this._segment[1]}},{key:"xMidpoint",get:function(){return this.xStart+.5*this.dx}},{key:"yMidpoint",get:function(){return this.yStart+.5*this.dy}},{key:"xEnd",get:function(){return this.xStart+this.dx}},{key:"yEnd",get:function(){return this.yStart+this.dy}},{key:"length",get:function(){const {dx:p,dy:t}=this;return Math.sqrt(p*
p+t*t)}},{key:"remainingLength",get:function(){return this.length*(1-this._distance)}},{key:"backwardLength",get:function(){return this.length*this._distance}},{key:"distance",get:function(){return this._distance}},{key:"done",get:function(){return this._done}}]);return g}();r.SegmentCursor=k;r.pathDivide=function(g,m,p,t=!0){const e=z(g);g=k.create(g);const c=e/2;if(t){t=Math.floor(Math.max((e-m)/2,0)/m);g.seek(c-t*m);for(let a=-t;a<=t;a++)512>g.x&&0<=g.x&&512>g.y&&0<=g.y&&p(g.clone(),a,c+a*m,e),
g.seek(m)}else g.seek(c),p(g.clone(),0,c+0*m,e)};r.pathLength=z;r.pathSubdivide=function(g,m,p){f(p,m,z(g),k.create(g),0)};r.segmentAt=function(g,m){return g[m+1]};r.segmentCount=v;r.segmentLength=x;r.smoothPaths=function(g,m){for(let D=0;D<g.length;D++){var p=g[D];const F=[];F.push(p[0]);for(var t=1;t<p.length;t++){let [G,K]=F[t-1];G+=p[t][0];K+=p[t][1];F.push([G,K])}a:{p=F;t=m;if(0>=t)break a;const G=p.length;if(3>G)break a;const K=[];var e=0;K.push(0);for(var c=1;c<G;c++)e+=C.dist(p[c],p[c-1]),
K.push(e);t=Math.min(t,.2*e);e=[];e.push(p[0][0]);e.push(p[0][1]);c=p[G-1][0];const J=p[G-1][1];var a=C.sub([0,0],p[0],p[1]);C.normalize(a);p[0][0]+=t*a[0];p[0][1]+=t*a[1];C.sub(a,p[G-1],p[G-2]);C.normalize(a);p[G-1][0]+=t*a[0];p[G-1][1]+=t*a[1];for(a=1;a<G;a++)K[a]+=t;K[G-1]+=t;a=.5*t;for(let I=1;I<G-1;I++){let H=0,M=0,N=0;for(var b=I-1;0<=b&&!(K[b+1]<K[I]-a);b--){var h=a+K[b+1]-K[I],l=K[b+1]-K[b],d=K[I]-K[b]<a?1:h/l;if(1E-6>Math.abs(d))break;var q=d*d,n=d*h-.5*q*l,B=d*l/t,A=p[b+1],w=p[b][0]-A[0],
y=p[b][1]-A[1];H+=B/n*(A[0]*d*h+.5*q*(h*w-l*A[0])-q*d*l*w/3);M+=B/n*(A[1]*d*h+.5*q*(h*y-l*A[1])-q*d*l*y/3);N+=B}for(b=I+1;b<G&&!(K[b-1]>K[I]+a);b++){h=a-K[b-1]+K[I];l=K[b]-K[b-1];d=K[b]-K[I]<a?1:h/l;if(1E-6>Math.abs(d))break;q=d*d;n=d*h-.5*q*l;B=d*l/t;A=p[b-1];w=p[b][0]-A[0];y=p[b][1]-A[1];H+=B/n*(A[0]*d*h+.5*q*(h*w-l*A[0])-q*d*l*w/3);M+=B/n*(A[1]*d*h+.5*q*(h*y-l*A[1])-q*d*l*y/3);N+=B}e.push(H/N);e.push(M/N)}e.push(c);e.push(J);for(let I=0,H=0;I<G;I++)p[I][0]=e[H++],p[I][1]=e[H++]}p=[];p.push(F[0]);
for(t=1;t<F.length;t++){const [G,K]=F[t-1],[J,I]=F[t];p.push([Math.round(J-G),Math.round(I-K)])}g[D]=p}return g};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/util":function(){define(["exports"],function(r){function u(E,C){return Math.sqrt(E*E+C*C)}r.DEFAULT_MAX_ZOOM=100;r.DEFAULT_MIN_ZOOM=0;r.dist=function(E,C){return u(E[0]-C[0],E[1]-C[1])};r.getLimitCosine=function(E=2){return 1/Math.max(E,1)};r.getMinMaxZoom=
function(E,C){const v=!!E.minScale&&C.scaleToZoom(E.minScale)||0;E=!!E.maxScale&&C.scaleToZoom(E.maxScale)||100;return[v,E]};r.isExtent=function(E){return void 0!==E.xmin&&void 0!==E.ymin&&void 0!==E.xmax&&void 0!==E.ymax};r.isFunction=function(E){return"function"===typeof E};r.isMultipoint=function(E){return void 0!==E.points};r.isPoint=function(E){return void 0!==E.x&&void 0!==E.y};r.isPolygon=function(E){return void 0!==E.rings};r.isPolyline=function(E){return void 0!==E.paths};r.len=u;r.normalize=
function(E){const C=u(E[0],E[1]);E[0]/=C;E[1]/=C};r.sub=function(E,C,v){E[0]=C[0]-v[0];E[1]=C[1]-v[1];return E};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/BidiText ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLMeshTemplate".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p){return function(t){function e(c,a,b,h,l,d,q,n,B,A,w,y,D,F,G,K,J,I,H=!1,M,N){var P=t.call(this)||this;P._xOffset=E.pt2px(D);P._yOffset=E.pt2px(F);P._decoration=A||"none";P._color=l;P._haloColor=d;P._haloSize=Math.min(Math.floor(5*E.pt2px(E.toPt(b))),127);P._size=Math.min(Math.round(E.pt2px(a)),127);a=Math.min(Math.round(E.pt2px(h||a)),127);P._referenceSize=Math.round(Math.sqrt(256*a));P._scale=P._size/x.GLYPH_SIZE;P._angle=y;P._justify=v.getJustification(q||"center");
P._xAlignD=v.getXAnchorDirection(q||"center");P._yAlignD=v.getYAnchorDirection(n||"baseline");P._baseline="baseline"===(n||"baseline");P._bitset=(B===C.Alignment.MAP?1:0)|(w?1:0)<<1;c=k.MaterialKeyBase.load(c);c.sdf=!0;P._materialKey=c.data;P._lineWidth=E.pt2px(G)||512;P._lineHeight=K||1;P._textPlacement=J;P._effects=I;P._isCIM=H;P._minMaxZoom=f.i1616to32(Math.round(M*x.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(N*x.MIN_MAX_ZOOM_PRECISION_FACTOR));return P}r._inheritsLoose(e,t);e.fromText=function(c,
a){const b=new e(c.materialKey,c.font.size,c.haloSize||0,c.font.size,c.color&&z.premultiplyAlphaRGBAArray(c.color)||0,c.haloColor&&z.premultiplyAlphaRGBAArray(c.haloColor)||0,c.horizontalAlignment,c.verticalAlignment,C.Alignment.SCREEN,c.font.decoration,!1,c.angle||0,c.xoffset,c.yoffset,c.lineWidth,c.lineHeight,null,null,!1,g.DEFAULT_MIN_ZOOM,g.DEFAULT_MAX_ZOOM),[,h]=u.bidiText(c.text);b.bindTextInfo(a,h);b._vertexBoundsScale=c.maxVVSize?c.maxVVSize/c.font.size:1;return b};e.fromCIMText=function(c,
a,b){var h=c.scaleFactor||1;const l=c.size*c.sizeRatio*h,[d,q]=g.getMinMaxZoom(c.scaleInfo,b);b=new e(c.materialKey,l,c.outlineSize*c.sizeRatio,c.referenceSize,z.premultiplyAlphaRGBA(c.color),z.premultiplyAlphaRGBA(c.outlineColor),c.horizontalAlignment,c.verticalAlignment,c.alignment,c.decoration,c.colorLocked,c.angle,c.offsetX*c.sizeRatio*h,c.offsetY*c.sizeRatio*h,512,1,c.markerPlacement,c.effects,!0,d,q);[,h]=u.bidiText(c.text);b.bindTextInfo(a,h);b._vertexBoundsScale=c.maxVVSize?c.maxVVSize/l:
1;return b};return e}(m(p))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./shapingUtils".split(" "),function(r,u,E,C,v,z,x,f,k,g){return m=>function(p){function t(...c){c=
p.call(this,...c)||this;c._isCIM=!1;c._vertexBoundsScale=1;c.geometryType=x.WGLGeometryType.TEXT;c._aux=f.i8888to32(0,0,c._referenceSize,c._bitset);return c}r._inheritsLoose(t,p);var e=t.prototype;e.bindTextInfo=function(c,a){this._shapingInfo=c&&c.length?u.applySome(c,b=>g.shapeGlyphs(b,a,{scale:this._scale,angle:this._angle,xOffset:this._xOffset,yOffset:this._yOffset,hAlign:this._xAlignD,vAlign:this._yAlignD,maxLineWidth:Math.max(32,Math.min(this._lineWidth,512)),lineHeight:z.MAGIC_LABEL_LINE_HEIGHT*
Math.max(.25,Math.min(this._lineHeight,4)),decoration:this._decoration,isCIM:this._isCIM})):null};e._write=function(c,a,b,h){const l=a.getDisplayId();this._writeGeometry(c,a,l,b,h)};e._writeGeometry=function(c,a,b,h,l){const d=this._shapingInfo;if(!u.isNone(d)){if(u.isSome(this._textPlacement))return a=null!=l?l:a.readLegacyGeometryForDisplay(),this._writePlacedText(c,b,a,d,h);h=l?C.deltaDecodeGeometry(C.convertFromGeometry(l),2):"esriGeometryPolygon"===a.geometryType?a.readCentroid():a.readGeometryForDisplay();
if(!u.isNone(h)){if(h.isPoint){const [q,n]=h.coords;return!c.hasAggregates&&c.hasPixelBufferEnabled&&(0>q||512<=q||0>n||512<=n)?void 0:this._writeGlyphs(c,b,{x:q,y:n},d)}h.forEachVertex((q,n)=>this._writeGlyphs(c,b,{x:q,y:n},d))}}};e._writePlacedText=function(c,a,b,h,l){var d=u.unwrap(this._textPlacement);if(b=v.CIMMarkerPlacementHelper.getPlacement(b,d,E.pt2px(1),l.geometryEngine))for(var q=b.next();null!=q;)l=-q.getAngle(),h.setRotation(l),d=q.tx,q=-q.ty,0>d||512<=d||0>q||512<=q||(this._writeGlyphs(c,
a,{x:d,y:q},h),h.setRotation(-l)),q=b.next()};e._writeGlyphs=function(c,a,b,h){const l=k.MaterialKeyBase.load(this._materialKey),d=f.i1616to32(Math.round(8*b.x),Math.round(8*b.y)),q=this._vertexBoundsScale,n=h.bounds,B=2*Math.max(n.width,n.height);for(const A of h.glyphs)l.textureBinding=A.textureBinding,c.recordStart(a,l.data,this.geometryType,!0),c.vertexBounds(b.x+n.x+this._xOffset,b.y+n.y-this._yOffset,B*q,B*q),this._writeVertices(c,a,d,A),c.recordEnd()};e._writeGlyph=function(c,a,b,h,l){var d=
k.MaterialKeyBase.load(this._materialKey);const q=f.i1616to32(Math.round(8*b),Math.round(8*h));d.textureBinding=l.textureBinding;c.recordStart(a,d.data,this.geometryType,!0);d=l.bounds;const n=this._vertexBoundsScale;c.vertexBounds(b+d.x*n,h+d.y*n,d.width*n,d.height*n);this._writeVertices(c,a,q,l);c.recordEnd()};e._writeVertices=function(c,a,b,h){const l=c.vertexCount();this._writeVertexCommon(c,a,b,h);c.vertexWrite(h.offsets.upperLeft);c.vertexWrite(h.texcoords.upperLeft);c.vertexEnd();this._writeVertexCommon(c,
a,b,h);c.vertexWrite(h.offsets.upperRight);c.vertexWrite(h.texcoords.upperRight);c.vertexEnd();this._writeVertexCommon(c,a,b,h);c.vertexWrite(h.offsets.lowerLeft);c.vertexWrite(h.texcoords.lowerLeft);c.vertexEnd();this._writeVertexCommon(c,a,b,h);c.vertexWrite(h.offsets.lowerRight);c.vertexWrite(h.texcoords.lowerRight);c.vertexEnd();c.indexWrite(l+0);c.indexWrite(l+1);c.indexWrite(l+2);c.indexWrite(l+1);c.indexWrite(l+3);c.indexWrite(l+2)};e._writeVertexCommon=function(c,a,b,h){h=this._color;const l=
this._haloColor,d=f.i8888to32(0,0,this._referenceSize,this._bitset),q=f.i8888to32(0,0,this._size,this._haloSize);c.vertexWrite(b);c.vertexWrite(a);c.vertexWrite(h);c.vertexWrite(l);c.vertexWrite(q);c.vertexWrite(d);c.vertexWrite(this._minMaxZoom)};return t}(m)})},"esri/symbols/cim/placements/CIMMarkerPlacementHelper":function(){define(["exports","../CIMCursor","../CIMOperators"],function(r,u,E){let C=function(){function v(){}v.getPlacement=function(z,x,f,k){const g=E.getPlacementOperator(x);if(!g)return null;
z=u.cloneAndDecodeGeometry(z);return g.execute(z,x,f,k)};return v}();r.CIMMarkerPlacementHelper=C;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMCursor":function(){define(["exports","../../core/lang","../../geometry/support/jsonUtils","./CIMPlacements"],function(r,u,E,C){function v(b){if(!b)return null;E.isPoint(b)?b.y=-b.y:E.isPolygon(b)?x(b.rings):E.isPolyline(b)?x(b.paths):E.isMultipoint(b)&&z(b.points)}function z(b){if(b){const h=
b.length;for(let l=0;l<h;l++)b[l][1]=-b[l][1]}}function x(b){if(b)for(const h of b)z(h)}function f(b){if(b){var h=b.length;for(--h;0<h;--h)b[h][0]-=b[h-1][0],b[h][1]-=b[h-1][1]}}function k(b){if(b)for(const h of b)f(h)}function g(b){if(b){const h=b.length;for(let l=1;l<h;++l)b[l][0]+=b[l-1][0],b[l][1]+=b[l-1][1]}}function m(b){if(b)for(const h of b)g(h)}function p(b){b&&(E.isPolygon(b)?m(b.rings):E.isPolyline(b)?m(b.paths):E.isMultipoint(b)&&g(b.points),v(b))}function t(b){b&&b.reverse()}function e(b){return{rings:[[[b.xmin,
b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]]}}let c=function(){function b(h,l,d,q){this.acceptPolygon=l;this.acceptPolyline=d;this.geomUnitsPerPoint=q;this.pathIndex=this.pathCount=-1;this.iteratePath=!1;h&&(E.isPolygon(h)?l&&(this.multiPath=h.rings,this.isClosed=!0):E.isPolyline(h)?d&&(this.multiPath=h.paths,this.isClosed=!1):E.isExtent(h)&&l&&(this.multiPath=e(h).rings,this.isClosed=!0),this.multiPath&&(this.pathCount=this.multiPath.length));this.internalPlacement=new C.Placement}
b.prototype.next=function(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;const h=this.processPath(this.multiPath[this.pathIndex]);if(h)return h}this.pathIndex=this.pathCount=-1;return this.multiPath=null};return b}(),a=function(){function b(h,l,d,q){this.inputGeometries=h;this.acceptPolygon=l;this.acceptPolyline=d;this.geomUnitsPerPoint=q;this.pathIndex=this.pathCount=-1;this.iteratePath=!1}b.prototype.next=function(){for(;;){if(!this.multiPath){for(var h=
this.inputGeometries.next();h;)if(E.isPolygon(h)?this.acceptPolygon&&(this.multiPath=h.rings,this.isClosed=!0):E.isPolyline(h)?this.acceptPolyline&&(this.multiPath=h.paths,this.isClosed=!1):E.isExtent(h)&&this.acceptPolygon&&(this.multiPath=e(h).rings,this.isClosed=!0),this.multiPath){this.pathCount=this.multiPath.length;this.pathIndex=-1;break}else h=this.inputGeometries.next();if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;)if(this.iteratePath||this.pathIndex++,
h=this.processPath(this.multiPath[this.pathIndex]))return h;this.pathIndex=this.pathCount=-1;this.multiPath=null}};return b}();r.PathGeometryCursor=a;r.PathTransformationCursor=c;r.cloneAndDecodeGeometry=function(b){b=u.clone(b);p(b);return b};r.deltaDecodeGeometry=p;r.deltaEncodeGeometry=function(b){b&&(v(b),E.isPolygon(b)?k(b.rings):E.isPolyline(b)?k(b.paths):E.isMultipoint(b)&&f(b.points))};r.getCoord2D=function(b,h,l){return[b[0]+(h[0]-b[0])*l,b[1]+(h[1]-b[1])*l]};r.getId=function(b){return b[4]};
r.isClosedPath=function(b){return b&&0!==b.length?b[0][0]===b[b.length-1][0]&&b[0][1]===b[b.length-1][1]:!1};r.reverseMultipath=function(b){if(b)for(const h of b)t(h)};r.reversePath=t;r.setId=function(b,h){b[4]=h};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMPlacements":function(){define(["exports"],function(r){let u=function(){function C(){this.setIdentity()}var v=C.prototype;v.getAngle=function(){if(null==this.rz||0===this.rz&&
1!==this.rz_c&&0!==this.rz_s)this.rz=Math.atan2(this.rz_s,this.rz_c);return this.rz};v.setIdentity=function(){this.tz=this.ty=this.tx=0;this.s=1;this.rz=this.ry=this.rx=0;this.rz_c=1;this.rz_s=0};v.setTranslate=function(z,x){this.tx=z;this.ty=x};v.setTranslateZ=function(z){this.tz=z};v.setRotateCS=function(z,x){this.rz=void 0;this.rz_c=z;this.rz_s=x};v.setRotate=function(z){this.rz=z;this.rz_s=this.rz_c=void 0};v.setRotateY=function(z){this.ry=z};v.setScale=function(z){this.s=z};v.setMeasure=function(z){this.m=
z};return C}(),E=function(){function C(){}C.prototype.next=function(){return null};return C}();r.EmptyPlacementCursor=E;r.Placement=u;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMOperators":function(){define("exports ./effects/EffectAddControlPoints ./effects/EffectArrow ./effects/EffectBuffer ./effects/EffectControlMeasureLine ./effects/EffectCut ./effects/EffectDashes ./effects/EffectDonut ./effects/EffectJog ./effects/EffectMove ./effects/EffectOffset ./effects/EffectReverse ./effects/EffectRotate ./effects/EffectScale ./effects/EffectWave ./placements/PlacementAlongLineSameSize ./placements/PlacementAtExtremities ./placements/PlacementAtRatioPositions ./placements/PlacementInsidePolygon ./placements/PlacementOnLine ./placements/PlacementOnVertices ./placements/PlacementPolygonCenter".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t,e,c,a,b,h,l,d,q,n){r.getEffectOperator=function(B){if(!B)return null;switch(B.type){case "CIMGeometricEffectAddControlPoints":return u.EffectAddControlPoints.local();case "CIMGeometricEffectArrow":return E.EffectArrow.local();case "CIMGeometricEffectBuffer":return C.EffectBuffer.local();case "CIMGeometricEffectControlMeasureLine":return v.EffectControlMeasureLine.local();case "CIMGeometricEffectCut":return z.EffectCut.local();case "CIMGeometricEffectDashes":return x.EffectDashes.local();
case "CIMGeometricEffectDonut":return f.EffectDonut.local();case "CIMGeometricEffectJog":return k.EffectJog.local();case "CIMGeometricEffectMove":return g.EffectMove.local();case "CIMGeometricEffectOffset":return m.EffectOffset.local();case "CIMGeometricEffectReverse":return p.EffectReverse.local();case "CIMGeometricEffectRotate":return t.EffectRotate.local();case "CIMGeometricEffectScale":return e.EffectScale.local();case "CIMGeometricEffectWave":return c.EffectWave.local()}return null};r.getPlacementOperator=
function(B){if(!B)return null;switch(B.type){case "CIMMarkerPlacementAlongLineSameSize":return a.PlacementAlongLineSameSize.local();case "CIMMarkerPlacementAtExtremities":return b.PlacementAtExtremities.local();case "CIMMarkerPlacementAtRatioPositions":return h.PlacementAtRatioPositions.local();case "CIMMarkerPlacementInsidePolygon":return l.PlacementInsidePolygon.local();case "CIMMarkerPlacementOnLine":return d.PlacementOnLine.local();case "CIMMarkerPlacementOnVertices":return q.PlacementOnVertices.local();
case "CIMMarkerPlacementPolygonCenter":return n.PlacementPolygonCenter.local()}return null};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectAddControlPoints":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(r,u,E,C){let v=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(f,k,g,m){return new z(f,
k,g)};return x}();v.instance=null;let z=function(){function x(k,g,m){this._inputGeometries=k;this._angleTolerance=void 0!==g.angleTolerance?g.angleTolerance:120;this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}var f=x.prototype;f.next=function(){for(var k=this._inputGeometries.next();k;){if(E.isPolygon(k))return this._isClosed=!0,k=u.clone(k),this._processMultipath(k.rings),k;if(E.isPolyline(k))return this._isClosed=!1,k=u.clone(k),this._processMultipath(k.paths),k;if(E.isExtent(k)){if(this._maxCosAngle)return k;
this._isClosed=!0;k=[[k.xmin,k.ymin],[k.xmin,k.ymax],[k.xmax,k.ymax],[k.xmax,k.ymin],[k.xmin,k.ymin]];this._processPath(k);return{rings:[k]}}k=this._inputGeometries.next()}return null};f._processMultipath=function(k){if(k)for(const g of k)this._processPath(g)};f._processPath=function(k){if(k){let g=k.length,m=k[0],p,t,e,c,a,b;this._isClosed&&++g;for(let h=1;h<g;++h){let l;l=this._isClosed&&h===g-1?k[0]:k[h];const d=l[0]-m[0],q=l[1]-m[1],n=Math.sqrt(d*d+q*q);1<h&&0<n&&0<e&&(p*d+t*q)/n/e<=this._maxCosAngle&&
C.setId(m,1);1===h&&(c=d,a=q,b=n);0<n&&(m=l,p=d,t=q,e=n)}this._isClosed&&0<e&&0<b&&(p*c+t*a)/b/e<=this._maxCosAngle&&C.setId(k[0],1)}};return x}();r.EffectAddControlPoints=v;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectArrow":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../enums"],function(r,u,E,C,v){const z=v.GeometricEffectArrowType.OpenEnded;let x=function(){function k(){}
k.local=function(){null===k.instance&&(k.instance=new k);return k.instance};k.prototype.execute=function(g,m,p,t){return new f(g,m,p)};return k}();x.instance=null;let f=function(k){function g(p,t,e){p=k.call(this,p,!1,!0)||this;p._curveHelper=new C.CurveHelper;p._width=(void 0!==t.width?t.width:5)*e;p._arrowType=void 0!==t.geometricEffectArrowType?t.geometricEffectArrowType:void 0!==t.arrowType?t.arrowType:z;p._offsetFlattenError=C.PIXEL_TOLERANCE*e;return p}u._inheritsLoose(g,k);var m=g.prototype;
m.processPath=function(p){switch(this._arrowType){default:return this._constructSimpleArrow(p,!0);case v.GeometricEffectArrowType.Block:return this._constructSimpleArrow(p,!1);case v.GeometricEffectArrowType.Crossed:return this._constructCrossedArrow(p)}};m._constructSimpleArrow=function(p,t){var e=this._curveHelper.calculatePathLength(p),c=this._width;e<2*c&&(c=e/2);e=this._curveHelper.getSubCurve(p,0,e-c);if(!e)return null;var a=c/2;if(this._curveHelper.isEmpty(e,!1))return null;c=this._constructOffset(e,
-a);if(!c)return null;e=this._constructOffset(e,a);if(!e)return null;const b=this._constructArrowBasePoint(c,-a/2);if(!b)return null;a=this._constructArrowBasePoint(e,a/2);if(!a)return null;p=p[p.length-1];t||(this._makeControlPoint(e,!0),this._makeControlPoint(c,!0));const h=new C.PathHelper;h.addPath(e,!0);h.lineTo(a);this._makeControlPoint(h.path());h.lineTo(p);this._makeControlPoint(h.path());h.lineTo(b);this._makeControlPoint(h.path());h.addPath(c,!1);return t?{paths:[h.path()]}:(h.close(),{rings:[h.path()]})};
m._constructCrossedArrow=function(p){var t=this._curveHelper.calculatePathLength(p),e=this._width;t<3.732050807568877*e&&(e=t/3.732050807568877);var c=this._curveHelper.getSubCurve(p,0,t-2.732050807568877*e);if(!c)return null;var a=e/2;if(this._curveHelper.isEmpty(c,!1))return null;const b=this._constructOffset(c,a);if(!b)return null;c=this._constructOffset(c,-a);if(!c)return null;t=this._curveHelper.getSubCurve(p,0,t-e);if(!t||this._curveHelper.isEmpty(t,!1))return null;e=this._constructOffset(t,
a);if(!e)return null;var h=this._constructOffset(t,-a);if(!h)return null;t=e[e.length-1];e=this._constructArrowBasePoint(e,a/2);if(!e)return null;const l=h[h.length-1];a=this._constructArrowBasePoint(h,-a/2);if(!a)return null;p=p[p.length-1];this._makeControlPoint(b,!1);this._makeControlPoint(c,!1);h=new C.PathHelper;h.addPath(b,!0);this._makeControlPoint(h.path());h.lineTo(l);h.lineTo(a);this._makeControlPoint(h.path());h.lineTo(p);this._makeControlPoint(h.path());h.lineTo(e);this._makeControlPoint(h.path());
h.lineTo(t);this._makeControlPoint(h.path());h.addPath(c,!1);return{paths:[h.path()]}};m._constructOffset=function(p,t){return this._curveHelper.offset(p,t,v.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError)};m._constructArrowBasePoint=function(p,t){if(!p||2>p.length)return null;var e=p[p.length-2];p=p[p.length-1];e=[p[0]-e[0],p[1]-e[1]];this._curveHelper.normalize(e);return[p[0]+e[1]*t,p[1]-e[0]*t]};m._makeControlPoint=function(p,t=!1){t?E.setId(p[0],1):E.setId(p[p.length-1],1)};return g}(E.PathGeometryCursor);
r.EffectArrow=x;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CurveHelper":function(){define(["exports","./enums"],function(r,u){let E=function(){function v(){this._path=[]}var z=v.prototype;z.path=function(){return this._path};z.addPath=function(x,f){f||x.reverse();Array.prototype.push.apply(this._path,x);f||x.reverse()};v.mergePath=function(x,f){f&&Array.prototype.push.apply(x,f)};z.startPath=function(x){this._path.push(x)};z.lineTo=
function(x){this._path.push(x)};z.close=function(){const x=this._path;1<x.length&&(x[0][0]!==x[x.length-1][0]||x[0][1]!==x[x.length-1][1])&&x.push([x[0][0],x[0][1]])};return v}(),C=function(){function v(x,f){}var z=v.prototype;z.normalize=function(x){const f=Math.sqrt(x[0]*x[0]+x[1]*x[1]);0!==f&&(x[0]/=f,x[1]/=f)};z.calculateLength=function(x,f){const k=f[0]-x[0];x=f[1]-x[1];return Math.sqrt(k*k+x*x)};z.calculateSegLength=function(x,f){return this.calculateLength(x[f],x[f+1])};z.calculatePathLength=
function(x){let f=0;const k=x?x.length:0;for(let g=0;g<k-1;++g)f+=this.calculateSegLength(x,g);return f};z.calculatePathArea=function(x){let f=0;const k=x?x.length:0;for(let g=0;g<k-1;++g)f+=(x[g+1][0]-x[g][0])*(x[g+1][1]+x[g][1]);return f/2};z.getCoord2D=function(x,f,k){return[x[0]+(f[0]-x[0])*k,x[1]+(f[1]-x[1])*k]};z.getSegCoord2D=function(x,f,k){return this.getCoord2D(x[f],x[f+1],k)};z.getAngle=function(x,f,k){return Math.atan2(f[1]-x[1],f[0]-x[0])};z.getSegAngle=function(x,f,k){return this.getAngle(x[f],
x[f+1],k)};z.getAngleCS=function(x,f,k){k=f[0]-x[0];x=f[1]-x[1];f=Math.sqrt(k*k+x*x);return 0<f?[k/f,x/f]:[1,0]};z.getSegAngleCS=function(x,f,k){return this.getAngleCS(x[f],x[f+1],k)};z.cut=function(x,f,k,g){k=0>=k?x[f]:this.getSegCoord2D(x,f,k);x=1<=g?x[f+1]:this.getSegCoord2D(x,f,g);return[k,x]};z.addSegment=function(x,f,k){k&&x.push(f[0]);x.push(f[1])};z.getSubCurve=function(x,f,k){const g=[];return this.appendSubCurve(g,x,f,k)?g:null};z.appendSubCurve=function(x,f,k,g){const m=f?f.length-1:0;
let p=0,t=!0,e=0;for(;e<m;){const a=this.calculateSegLength(f,e);if(0!==a){if(t){if(p+a>k){var c=(k-p)/a;let b=1,h=!1;p+a>=g&&(b=(g-p)/a,h=!0);(c=this.cut(f,e,c,b))&&this.addSegment(x,c,t);if(h)break;t=!1}}else{if(p+a>g){(f=this.cut(f,e,0,(g-p)/a))&&this.addSegment(x,f,t);break}this.addSegment(x,[f[e],f[e+1]],t)}p+=a}++e}return!0};z.getCIMPointAlong=function(x,f){const k=x?x.length-1:0;let g=0,m=-1;for(;m<k;){++m;const p=this.calculateSegLength(x,m);if(0!==p){if(g+p>f)return this.getCoord2D(x[m],
x[m+1],(f-g)/p);g+=p}}return null};z.isEmpty=function(x,f){if(!x||1>=x.length)return!0;const k=x?x.length-1:0;let g=-1;for(;g<k;)if(++g,x[g+1][0]!==x[g][0]||x[g+1][1]!==x[g][1]||f&&x[g+1][2]!==x[g][2])return!1;return!0};z.offset=function(x,f,k,g,m){if(!x||2>x.length)return null;var p=0,t=x[p++];for(m=p;p<x.length;){var e=x[p];if(e[0]!==t[0]||e[1]!==t[1])p!==m&&(x[m]=x[p]),t=x[m++];p++}(p=x[0][0]===x[m-1][0]&&x[0][1]===x[m-1][1])&&--m;if(m<(p?3:2))return null;e=[];t=p?x[m-1]:null;let c=x[0];for(let d=
0;d<m;d++){const q=d===m-1?p?x[0]:null:x[d+1];if(t)if(q){var a=[q[0]-c[0],q[1]-c[1]];this.normalize(a);var b=[c[0]-t[0],c[1]-t[1]];this.normalize(b);var h=b[0]*a[1]-b[1]*a[0],l=b[0]*a[0]+b[1]*a[1];if(0===h&&1===l){c=q;continue}if(0<=h===0>=f)1>l&&(a=[a[0]-b[0],a[1]-b[1]],this.normalize(a),b=Math.sqrt((1+l)/2),b>1/g&&(b=-Math.abs(f)/b,e.push([c[0]-a[0]*b,c[1]-a[1]*b])));else switch(k){case u.GeometricEffectOffsetMethod.Mitered:if(t=Math.sqrt((1+l)/2),0<t&&1/t<g){a=[a[0]-b[0],a[1]-b[1]];this.normalize(a);
b=Math.abs(f)/t;e.push([c[0]-a[0]*b,c[1]-a[1]*b]);break}case u.GeometricEffectOffsetMethod.Bevelled:e.push([c[0]+b[1]*f,c[1]-b[0]*f]);e.push([c[0]+a[1]*f,c[1]-a[0]*f]);break;case u.GeometricEffectOffsetMethod.Rounded:if(1>l){e.push([c[0]+b[1]*f,c[1]-b[0]*f]);t=Math.floor(2.5*(1-l));if(0<t){h=l=1/t;for(let n=1;n<t;n++,h+=l){const B=[b[1]*(1-h)+a[1]*h,-b[0]*(1-h)-a[0]*h];this.normalize(B);e.push([c[0]+B[0]*f,c[1]+B[1]*f])}}e.push([c[0]+a[1]*f,c[1]-a[0]*f])}break;default:0>h?(e.push([c[0]+(b[1]+b[0])*
f,c[1]+(b[1]-b[0])*f]),e.push([c[0]+(a[1]-a[0])*f,c[1]-(a[0]+a[1])*f])):(t=Math.sqrt((1+Math.abs(l))/2),a=[a[0]-b[0],a[1]-b[1]],this.normalize(a),b=f/t,e.push([c[0]-a[0]*b,c[1]-a[1]*b]))}}else a=[c[0]-t[0],c[1]-t[1]],this.normalize(a),e.push([c[0]+a[1]*f,c[1]-a[0]*f]);else a=[q[0]-c[0],q[1]-c[1]],this.normalize(a),e.push([c[0]+a[1]*f,c[1]-a[0]*f]);t=c;c=q}if(e.length<(p?3:2))return null;p&&e.push([e[0][0],e[0][1]]);return e};return v}();r.CurveHelper=C;r.PIXEL_TOLERANCE=.03;r.PathHelper=E;Object.defineProperties(r,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectBuffer":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums"],function(r,u,E,C){let v=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(f,k,g,m){return new z(f,k,g,m)};return x}();v.instance=null;let z=function(){function x(f,k,g,m){this._inputGeometries=f;this._curveHelper=new E.CurveHelper;
this._size=(void 0!==k.size?k.size:1)*g;this._offsetFlattenError=E.PIXEL_TOLERANCE*g}x.prototype.next=function(){let f=this._inputGeometries.next();for(;f;){if(u.isExtent(f))if(0<this._size){var k=this._curveHelper.offset([[f.xmin,f.ymin],[f.xmin,f.ymax],[f.xmax,f.ymax],[f.xmax,f.ymin],[f.xmin,f.ymin]],this._size,C.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);if(k)return{rings:[k]}}else if(0>this._size){if(0<Math.min(f.xmax-f.xmin,f.ymax-f.ymin)+2*this._size)return{xmin:f.xmin-
this._size,xmax:f.xmax+this._size,ymin:f.ymin-this._size,ymax:f.ymax+this._size}}else return f;if(u.isPolygon(f)){if(0===this._size)return f;k=[];for(const m of f.rings){var g=this._curveHelper.offset(m,this._size,C.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);g&&k.push(g)}if(k.length)return{rings:k}}if(u.isPolyline(f)&&0<this._size){k=[];for(const m of f.paths)if(m&&1<m.length){g=this._curveHelper.offset(m,this._size,C.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);
const p=this._curveHelper.offset(m,-this._size,C.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);if(g&&p){for(let t=p.length-1;0<=t;t--)g.push(p[t]);g.push([g[0][0],g[0][1]]);k.push(g)}}if(k.length)return{rings:k}}u.isPoint(f);f=this._inputGeometries.next()}return null};return x}();r.EffectBuffer=v;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectControlMeasureLine":function(){define(["exports","../../../geometry/support/jsonUtils",
"../CIMCursor","../enums"],function(r,u,E,C){let v=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(f,k,g,m){return new z(f,k,g)};return x}();v.instance=null;let z=function(){function x(k,g,m){var p;this._default_point_size=20;this._inputGeometries=k;this._geomUnitsPerPoint=m;this._rule=null!=(p=g.rule)?p:C.GeometricEffectControlMeasureLineRule.FullGeometry;this._default_size=this._default_point_size*m}var f=x.prototype;
f.next=function(){let k;for(;k=this._inputGeometries.next();){let g;u.isPoint(k)?g=this._processGeom([[[k.x,k.y]]]):u.isMultipoint(k)?g=this._processGeom([k.points]):u.isPolyline(k)?g=this._processGeom(k.paths):u.isPolygon(k)&&(g=this._processGeom(k.rings));if(g&&g.length)return{paths:g}}return null};f._clone=function(k){return[k[0],k[1]]};f._mid=function(k,g){return[(k[0]+g[0])/2,(k[1]+g[1])/2]};f._mix=function(k,g,m,p){return[k[0]*g+m[0]*p,k[1]*g+m[1]*p]};f._add=function(k,g){return[k[0]+g[0],k[1]+
g[1]]};f._add2=function(k,g,m){return[k[0]+g,k[1]+m]};f._sub=function(k,g){return[k[0]-g[0],k[1]-g[1]]};f._dist=function(k,g){return Math.sqrt((k[0]-g[0])*(k[0]-g[0])+(k[1]-g[1])*(k[1]-g[1]))};f._norm=function(k){return Math.sqrt(k[0]*k[0]+k[1]*k[1])};f._normalize=function(k,g=1){g/=this._norm(k);k[0]*=g;k[1]*=g};f._leftPerpendicular=function(k){const g=k[0];k[0]=-k[1];k[1]=g};f._leftPerp=function(k){return[-k[1],k[0]]};f._rightPerpendicular=function(k){const g=-k[0];k[0]=k[1];k[1]=g};f._rightPerp=
function(k){return[k[1],-k[0]]};f._dotProduct=function(k,g){return k[0]*g[0]+k[1]*g[1]};f._crossProduct=function(k,g){return k[0]*g[1]-k[1]*g[0]};f._rotateDirect=function(k,g,m){const p=k[0]*m+k[1]*g;k[0]=k[0]*g-k[1]*m;k[1]=p};f._makeCtrlPt=function(k){k=[k[0],k[1]];E.setId(k,1);return k};f._addAngledTicks=function(k,g,m,p){const t=this._sub(m,g);this._normalize(t);var e=this._crossProduct(t,this._sub(p,g));p=0<e?this._rightPerp(t):this._leftPerp(t);e=Math.abs(e)/2;const c=[];c.push([g[0]+(p[0]-t[0])*
e,g[1]+(p[1]-t[1])*e]);c.push(g);c.push(m);c.push([m[0]+(p[0]+t[0])*e,m[1]+(p[1]+t[1])*e]);k.push(c)};f._addBezier2=function(k,g,m,p,t){if(0===t--)k.push(p);else{var e=this._mid(g,m);m=this._mid(m,p);var c=this._mid(e,m);this._addBezier2(k,g,e,c,t);this._addBezier2(k,c,m,p,t)}};f._addBezier3=function(k,g,m,p,t,e){if(0===e--)k.push(t);else{var c=this._mid(g,m),a=this._mid(m,p);p=this._mid(p,t);m=this._mid(c,a);a=this._mid(a,p);var b=this._mid(m,a);this._addBezier3(k,g,c,m,b,e);this._addBezier3(k,b,
a,p,t,e)}};f._add90DegArc=function(k,g,m,p,t){p=null!=t?t:0<this._crossProduct(this._sub(m,g),this._sub(p,g));t=this._mid(g,m);const e=this._sub(t,g);p?this._leftPerpendicular(e):this._rightPerpendicular(e);t[0]+=e[0];t[1]+=e[1];this._addBezier3(k,g,this._mix(g,.33333,t,.66667),this._mix(m,.33333,t,.66667),m,4)};f._addArrow=function(k,g,m){var p=g[0],t=g[1],e=g[g.length-1],c=this._sub(p,t);this._normalize(c);const a=this._crossProduct(c,this._sub(e,t));t=.5*a;var b=this._leftPerp(c);const h=[e[0]-
b[0]*a,e[1]-b[1]*a];var l=g.length-1;e=[];e.push(m?[-b[0],-b[1]]:b);var d=[-c[0],-c[1]];for(m=1;m<l-1;m++){c=this._sub(g[m+1],g[m]);this._normalize(c);var q=this._dotProduct(c,d);b=this._crossProduct(c,d);q=Math.sqrt((1+q)/2);d=this._sub(c,d);this._normalize(d);d[0]/=q;d[1]/=q;e.push(0>b?[-d[0],-d[1]]:d);d=c}e.push(this._rightPerp(d));for(l=e.length-1;0<l;l--)k.push([g[l][0]+e[l][0]*t,g[l][1]+e[l][1]*t]);k.push([h[0]+e[0][0]*t,h[1]+e[0][1]*t]);k.push([h[0]+e[0][0]*a,h[1]+e[0][1]*a]);k.push(p);k.push([h[0]-
e[0][0]*a,h[1]-e[0][1]*a]);k.push([h[0]-e[0][0]*t,h[1]-e[0][1]*t]);for(p=1;p<e.length;p++)k.push([g[p][0]-e[p][0]*t,g[p][1]-e[p][1]*t])};f._cp2=function(k,g,m){return 2<=k.length?k[1]:this._add2(k[0],g*this._default_size,m*this._default_size)};f._cp3=function(k,g,m,p){if(3<=k.length)return k[2];m=this._mix(k[0],1-m,g,m);k=this._sub(g,k[0]);this._normalize(k);this._rightPerpendicular(k);return[m[0]+k[0]*p*this._default_size,m[1]+k[1]*p*this._default_size]};f._arrowPath=function(k){if(2<k.length)return k;
const g=k[0];k=this._cp2(k,-4,0);const m=this._sub(g,k);this._normalize(m);const p=this._rightPerp(m);return[g,k,[g[0]+(p[0]-m[0])*this._default_size,g[1]+(p[1]-m[1])*this._default_size]]};f._arrowLastSeg=function(k){var g=k[0];const m=this._cp2(k,-4,0);if(3<=k.length)g=k[k.length-1];else{k=this._sub(g,m);this._normalize(k);const p=this._rightPerp(k);g=[g[0]+(p[0]-k[0])*this._default_size,g[1]+(p[1]-k[1])*this._default_size]}return[m,g]};f._processGeom=function(k){if(!k)return null;const g=[];for(const m of k){if(!m||
0===m.length)continue;const p=m.length;let t=m[0];switch(this._rule){case C.GeometricEffectControlMeasureLineRule.PerpendicularFromFirstSegment:{const e=this._cp2(m,0,-1),c=this._cp3(m,e,.5,4),a=[];a.push(c);a.push(this._mid(t,e));g.push(a);break}case C.GeometricEffectControlMeasureLineRule.ReversedFirstSegment:{const e=this._cp2(m,0,-1);g.push([e,t]);break}case C.GeometricEffectControlMeasureLineRule.PerpendicularToSecondSegment:{const e=this._cp2(m,-4,1),c=this._cp3(m,e,.882353,-1.94),a=[];a.push(this._mid(e,
c));a.push(t);g.push(a);break}case C.GeometricEffectControlMeasureLineRule.SecondSegmentWithTicks:{const e=this._cp2(m,-4,1),c=this._cp3(m,e,.882353,-1.94),a=this._sub(c,e);let b;b=0<this._crossProduct(a,this._sub(t,e))?this._rightPerp(b):this._leftPerp(a);const h=[];h.push([e[0]+(b[0]-a[0])/3,e[1]+(b[1]-a[1])/3]);h.push(e);h.push(c);h.push([c[0]+(b[0]+a[0])/3,c[1]+(b[1]+a[1])/3]);g.push(h);break}case C.GeometricEffectControlMeasureLineRule.DoublePerpendicular:{const e=this._cp2(m,0,-1),c=this._cp3(m,
e,.5,3),a=this._mid(t,e),b=this._sub(a,c);this._normalize(b);const h=this._crossProduct(b,this._sub(t,c));this._leftPerpendicular(b);const l=[];l.push(t);l.push([c[0]+b[0]*h,c[1]+b[1]*h]);g.push(l);const d=[];d.push([c[0]-b[0]*h,c[1]-b[1]*h]);d.push(e);g.push(d);break}case C.GeometricEffectControlMeasureLineRule.OppositeToFirstSegment:{const e=this._cp2(m,0,-1),c=this._cp3(m,e,.5,3),a=this._mid(t,e),b=this._sub(a,c);this._normalize(b);const h=this._crossProduct(b,this._sub(t,c));this._leftPerpendicular(b);
const l=[];l.push([c[0]+b[0]*h,c[1]+b[1]*h]);l.push([c[0]-b[0]*h,c[1]-b[1]*h]);g.push(l);break}case C.GeometricEffectControlMeasureLineRule.TriplePerpendicular:{const e=this._cp2(m,0,-1),c=this._cp3(m,e,.5,4),a=this._mid(t,e),b=this._sub(a,c);this._normalize(b);const h=this._crossProduct(b,this._sub(t,c));this._leftPerpendicular(b);const l=[];l.push([c[0]+b[0]*h*.8,c[1]+b[1]*h*.8]);l.push([a[0]+.8*(t[0]-a[0]),a[1]+.8*(t[1]-a[1])]);g.push(l);g.push([c,a]);const d=[];d.push([c[0]-b[0]*h*.8,c[1]-b[1]*
h*.8]);d.push([a[0]+.8*(e[0]-a[0]),a[1]+.8*(e[1]-a[1])]);g.push(d);break}case C.GeometricEffectControlMeasureLineRule.HalfCircleFirstSegment:{const e=this._cp2(m,0,-1),c=this._cp3(m,e,.5,4),a=this._mid(t,e);let b=this._sub(e,t);const h=Math.cos(Math.PI/18),l=Math.sin(Math.PI/18),d=Math.sqrt((1+h)/2),q=Math.sqrt((1-h)/2),n=[];let B;0<this._crossProduct(b,this._sub(c,t))?(n.push(t),b=this._sub(t,a),B=e):(n.push(e),b=this._sub(e,a),B=t);this._rotateDirect(b,d,q);b[0]/=d;b[1]/=d;for(let A=1;18>=A;A++)n.push(this._add(a,
b)),this._rotateDirect(b,h,l);n.push(B);g.push(n);break}case C.GeometricEffectControlMeasureLineRule.HalfCircleSecondSegment:{const e=this._cp2(m,0,-1),c=this._cp3(m,e,1,-1);let a=this._sub(t,e);this._normalize(a);const b=this._crossProduct(a,this._sub(c,e))/2;this._leftPerpendicular(a);const h=[e[0]+a[0]*b,e[1]+a[1]*b];a=this._sub(e,h);const l=Math.cos(Math.PI/18);let d=Math.sin(Math.PI/18);0<b&&(d=-d);const q=[e];for(let n=1;18>=n;n++)this._rotateDirect(a,l,d),q.push(this._add(h,a));g.push(q);break}case C.GeometricEffectControlMeasureLineRule.HalfCircleExtended:{const e=
this._cp2(m,0,-2),c=this._cp3(m,e,1,-1);let a;if(4<=p)a=m[3];else{const q=this._sub(t,e);a=this._add(c,q)}const b=this._dist(e,c)/2/.75,h=this._sub(e,t);this._normalize(h,b);const l=this._sub(c,a);this._normalize(l,b);g.push([a,c]);const d=[this._clone(c)];this._addBezier3(d,c,this._add(c,l),this._add(e,h),e,4);d.push(t);g.push(d);break}case C.GeometricEffectControlMeasureLineRule.OpenCircle:{const e=this._cp2(m,-2,0),c=this._sub(e,t),a=Math.cos(Math.PI/18),b=-Math.sin(Math.PI/18),h=[e];for(let l=
1;33>=l;l++)this._rotateDirect(c,a,b),h.push(this._add(t,c));g.push(h);break}case C.GeometricEffectControlMeasureLineRule.CoverageEdgesWithTicks:{const e=this._cp2(m,0,-1);let c;if(3<=p)c=m[2];else{const d=this._sub(e,t),q=this._leftPerp(d);c=[t[0]+q[0]-.25*d[0],t[1]+q[1]-.25*d[1]]}let a;if(4<=p)a=m[3];else{const d=this._mid(t,e),q=this._sub(t,e);this._normalize(q);this._leftPerpendicular(q);const n=this._crossProduct(q,this._sub(c,d));this._rightPerpendicular(q);a=[c[0]+q[0]*n*2,c[1]+q[1]*n*2]}const b=
this._sub(e,t);let h,l;h=0<this._crossProduct(b,this._sub(c,t))?this._rightPerp(b):this._leftPerp(b);l=[];l.push(c);l.push(t);l.push([t[0]+(h[0]-b[0])/3,t[1]+(h[1]-b[1])/3]);g.push(l);h=0<this._crossProduct(b,this._sub(a,e))?this._rightPerp(h):this._leftPerp(b);l=[];l.push([e[0]+(h[0]+b[0])/3,e[1]+(h[1]+b[1])/3]);l.push(e);l.push(a);g.push(l);break}case C.GeometricEffectControlMeasureLineRule.GapExtentWithDoubleTicks:{const e=this._cp2(m,0,2),c=this._cp3(m,e,0,1);let a;if(4<=p)a=m[3];else{const b=
this._sub(e,t);a=this._add(c,b)}this._addAngledTicks(g,t,e,this._mid(c,a));this._addAngledTicks(g,c,a,this._mid(t,e));break}case C.GeometricEffectControlMeasureLineRule.GapExtentMidline:{const e=this._cp2(m,2,0),c=this._cp3(m,e,0,1);let a;if(4<=p)a=m[3];else{const h=this._sub(e,t);a=this._add(c,h)}const b=[];b.push(this._mid(t,c));b.push(this._mid(e,a));g.push(b);break}case C.GeometricEffectControlMeasureLineRule.Chevron:{const e=this._cp2(m,-1,-1);let c;if(3<=p)c=m[2];else{const a=this._sub(e,t);
this._leftPerpendicular(a);c=this._add(t,a)}g.push([e,this._makeCtrlPt(t),c]);break}case C.GeometricEffectControlMeasureLineRule.PerpendicularWithArc:{const e=this._cp2(m,0,-2),c=this._cp3(m,e,.5,-1);let a=this._sub(e,t);const b=this._norm(a);a[0]/=b;a[1]/=b;const h=this._crossProduct(a,this._sub(c,t));let l=this._dotProduct(a,this._sub(c,t));l<.05*b?l=.05*b:l>.95*b&&(l=.95*b);const d=[t[0]+a[0]*l,t[1]+a[1]*l];this._leftPerpendicular(a);let q=[];q.push([d[0]-a[0]*h,d[1]-a[1]*h]);q.push([d[0]+a[0]*
h,d[1]+a[1]*h]);g.push(q);const n=[e[0]+a[0]*h,e[1]+a[1]*h];a=this._sub(e,n);const B=Math.cos(Math.PI/18);let A=Math.sin(Math.PI/18);0>h&&(A=-A);q=[t,e];for(let w=1;9>=w;w++)this._rotateDirect(a,B,A),q.push(this._add(n,a));g.push(q);break}case C.GeometricEffectControlMeasureLineRule.ClosedHalfCircle:{const e=this._cp2(m,2,0),c=this._mid(t,e),a=this._sub(e,c),b=Math.cos(Math.PI/18),h=Math.sin(Math.PI/18),l=[t,e];for(let d=1;18>=d;d++)this._rotateDirect(a,b,h),l.push(this._add(c,a));g.push(l);break}case C.GeometricEffectControlMeasureLineRule.TripleParallelExtended:{const e=
this._cp2(m,0,-2),c=this._cp3(m,e,1,-2),a=this._mid(t,e),b=this._sub(c,e);this._normalize(b);const h=Math.abs(this._crossProduct(b,this._sub(a,e)))/2,l=this._dist(e,c),d=[e,t];d.push([t[0]+b[0]*l*.5,t[1]+b[1]*l*.5]);g.push(d);const q=[];q.push([a[0]-b[0]*h,a[1]-b[1]*h]);q.push([a[0]+b[0]*l*.375,a[1]+b[1]*l*.375]);E.setId(q[q.length-1],1);q.push([a[0]+b[0]*l*.75,a[1]+b[1]*l*.75]);g.push(q);g.push([e,c]);break}case C.GeometricEffectControlMeasureLineRule.ParallelWithTicks:{const e=this._cp2(m,3,0),
c=this._cp3(m,e,.5,-1),a=this._sub(c,e);this._normalize(a);const b=this._crossProduct(a,this._sub(c,t));this._leftPerpendicular(a);this._addAngledTicks(g,t,e,c);this._addAngledTicks(g,this._mix(t,1,a,b),this._mix(e,1,a,b),this._mid(t,e));break}case C.GeometricEffectControlMeasureLineRule.Parallel:{const e=this._cp2(m,3,0),c=this._cp3(m,e,.5,-1),a=this._sub(e,t);this._normalize(a);const b=this._leftPerp(a),h=this._crossProduct(a,this._sub(c,t));let l=[t,e];g.push(l);l=[];l.push([t[0]+b[0]*h,t[1]+b[1]*
h]);l.push([e[0]+b[0]*h,e[1]+b[1]*h]);g.push(l);break}case C.GeometricEffectControlMeasureLineRule.PerpendicularToFirstSegment:{const e=this._cp2(m,3,0),c=this._cp3(m,e,.5,-1),a=this._mid(t,e),b=this._sub(e,t);this._normalize(b);const h=this._crossProduct(b,this._sub(c,t));this._leftPerpendicular(b);const l=[];l.push([a[0]-b[0]*h*.25,a[1]-b[1]*h*.25]);l.push([a[0]+b[0]*h*1.25,a[1]+b[1]*h*1.25]);g.push(l);break}case C.GeometricEffectControlMeasureLineRule.ParallelOffset:{const e=this._cp2(m,3,0),c=
this._cp3(m,e,.5,-1),a=this._sub(e,t);this._normalize(a);const b=this._crossProduct(a,this._sub(c,t));this._leftPerpendicular(a);const h=[];h.push([t[0]-a[0]*b,t[1]-a[1]*b]);h.push([e[0]-a[0]*b,e[1]-a[1]*b]);g.push(h);const l=[];l.push([t[0]+a[0]*b,t[1]+a[1]*b]);l.push([e[0]+a[0]*b,e[1]+a[1]*b]);g.push(l);break}case C.GeometricEffectControlMeasureLineRule.OffsetOpposite:{const e=this._cp2(m,3,0),c=this._cp3(m,e,.5,-1),a=this._sub(e,t);this._normalize(a);const b=this._crossProduct(a,this._sub(c,t));
this._leftPerpendicular(a);const h=[];h.push([t[0]-a[0]*b,t[1]-a[1]*b]);h.push([e[0]-a[0]*b,e[1]-a[1]*b]);g.push(h);break}case C.GeometricEffectControlMeasureLineRule.OffsetSame:{const e=this._cp2(m,3,0),c=this._cp3(m,e,.5,-1),a=this._sub(e,t);this._normalize(a);const b=this._crossProduct(a,this._sub(c,t));this._leftPerpendicular(a);const h=[];h.push([t[0]+a[0]*b,t[1]+a[1]*b]);h.push([e[0]+a[0]*b,e[1]+a[1]*b]);g.push(h);break}case C.GeometricEffectControlMeasureLineRule.CircleWithArc:{let e=this._cp2(m,
3,0);const c=this._cp3(m,e,.5,-1);let a,b;if(4<=p)a=m[3],b=0<this._crossProduct(this._sub(a,e),this._sub(c,e));else{a=e;b=0<this._crossProduct(this._sub(a,t),this._sub(c,t));const n=24*this._geomUnitsPerPoint,B=this._sub(a,t);this._normalize(B,n);const A=Math.sqrt(2)/2;this._rotateDirect(B,A,b?A:-A);e=this._add(t,B)}const h=this._sub(e,t),l=Math.cos(Math.PI/18),d=Math.sin(Math.PI/18),q=[e];for(let n=1;36>=n;n++)this._rotateDirect(h,l,d),q.push(this._add(t,h));this._add90DegArc(q,e,a,c,b);E.setId(q[q.length-
8],1);g.push(q);break}case C.GeometricEffectControlMeasureLineRule.DoubleJog:{let e=this._cp2(m,-3,1),c;c=3<=p?m[2]:this._add(t,this._sub(t,e));let a;if(4<=p)a=m[3];else{const w=t;t=e;a=c;const y=this._dist(t,w),D=this._dist(a,w);let F=30*this._geomUnitsPerPoint;.5*y<F&&(F=.5*y);.5*D<F&&(F=.5*D);e=this._mix(t,F/y,w,(y-F)/y);c=this._mix(a,F/D,w,(D-F)/D)}const b=this._mid(t,e),h=this._mid(a,c),l=this._dist(t,e),d=this._dist(c,a);let q=Math.min(l,d)/8;q=Math.min(q,24*this._geomUnitsPerPoint);const n=
Math.cos(Math.PI/4);let B=this._sub(t,e);this._normalize(B,q);0<this._crossProduct(B,this._sub(a,e))?this._rotateDirect(B,n,-n):this._rotateDirect(B,n,n);let A=[];A.push(e);A.push(this._add(b,B));A.push(this._sub(b,B));A.push(t);g.push(A);B=this._sub(a,c);this._normalize(B,q);0>this._crossProduct(B,this._sub(t,c))?this._rotateDirect(B,n,n):this._rotateDirect(B,n,-n);A=[];A.push(c);A.push(this._add(h,B));A.push(this._sub(h,B));A.push(a);g.push(A);break}case C.GeometricEffectControlMeasureLineRule.PerpendicularOffset:{const e=
this._cp2(m,-4,1),c=this._cp3(m,e,.882353,-1.94),a=this._sub(c,e);0<this._crossProduct(a,this._sub(t,e))?this._rightPerpendicular(a):this._leftPerpendicular(a);const b=[a[0]/8,a[1]/8],h=this._sub(this._mid(e,c),b);g.push([h,t]);break}case C.GeometricEffectControlMeasureLineRule.LineExcludingLastSegment:{const e=this._arrowPath(m),c=[];let a=e.length-2;for(;a--;)c.push(e[a]);g.push(c);break}case C.GeometricEffectControlMeasureLineRule.MultivertexArrow:{const e=this._arrowPath(m),c=[];this._addArrow(c,
e,!1);g.push(c);break}case C.GeometricEffectControlMeasureLineRule.CrossedArrow:{const e=this._arrowPath(m),c=[];this._addArrow(c,e,!0);g.push(c);break}case C.GeometricEffectControlMeasureLineRule.ChevronArrow:{const [e,c]=this._arrowLastSeg(m),a=10*this._geomUnitsPerPoint,b=this._sub(t,e);this._normalize(b);const h=this._crossProduct(b,this._sub(c,e)),l=this._leftPerp(b),d=[c[0]-l[0]*h*2,c[1]-l[1]*h*2],q=[];q.push([c[0]+b[0]*a,c[1]+b[1]*a]);q.push(t);q.push([d[0]+b[0]*a,d[1]+b[1]*a]);g.push(q);break}case C.GeometricEffectControlMeasureLineRule.ChevronArrowOffset:{const [e,
c]=this._arrowLastSeg(m),a=this._sub(t,e);this._normalize(a);const b=this._crossProduct(a,this._sub(c,e));this._leftPerpendicular(a);const h=[c[0]-a[0]*b,c[1]-a[1]*b],l=[];l.push([h[0]+a[0]*b*.5,h[1]+a[1]*b*.5]);l.push(this._mid(h,t));l.push([h[0]-a[0]*b*.5,h[1]-a[1]*b*.5]);g.push(l);break}case C.GeometricEffectControlMeasureLineRule.PartialFirstSegment:{const [e,c]=this._arrowLastSeg(m),a=this._sub(t,e);this._normalize(a);const b=this._crossProduct(a,this._sub(c,e));this._leftPerpendicular(a);g.push([e,
[c[0]-a[0]*b,c[1]-a[1]*b]]);break}case C.GeometricEffectControlMeasureLineRule.Arch:{const e=this._cp2(m,0,-1),c=this._cp3(m,e,.5,1),a=this._sub(t,e),b=this._mix(c,1,a,.55),h=this._mix(c,1,a,-.55),l=[t];this._addBezier2(l,t,b,c,4);this._addBezier2(l,c,h,e,4);g.push(l);break}case C.GeometricEffectControlMeasureLineRule.CurvedParallelTicks:{const e=this._cp2(m,-4,1),c=this._cp3(m,e,.882353,-1.94),a=this._sub(c,e);0<this._crossProduct(a,this._sub(t,e))?this._rightPerpendicular(a):this._leftPerpendicular(a);
const b=[a[0]/8,a[1]/8],h=this._sub(this._mid(e,c),b),l=this._sub(this._mix(e,.75,c,.25),b),d=this._sub(this._mix(e,.25,c,.75),b),q=[e];this._addBezier2(q,e,l,h,3);this._addBezier2(q,h,d,c,3);g.push(q);for(let n=0;8>n;n++){const B=q[2*n+1],A=[this._clone(B)];A.push(this._add(B,[a[0]/4,a[1]/4]));g.push(A)}break}case C.GeometricEffectControlMeasureLineRule.Arc90Degrees:{const e=this._cp2(m,0,-1),c=this._cp3(m,e,.5,1),a=[e];this._add90DegArc(a,e,t,c);g.push(a);break}default:g.push(m)}}return g};return x}();
r.EffectControlMeasureLine=v;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectCut":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(r,u,E,C){let v=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(f,k,g,m){return new z(f,k,g)};return x}();v.instance=null;let z=function(x){function f(k,
g,m){k=x.call(this,k,!0,!0)||this;k._curveHelper=new C.CurveHelper;k._beginCut=(void 0!==g.beginCut?g.beginCut:1)*m;k._endCut=(void 0!==g.endCut?g.endCut:1)*m;k._middleCut=(void 0!==g.middleCut?g.middleCut:0)*m;k._invert=void 0!==g.invert?g.invert:!1;0>k._beginCut&&(k._beginCut=0);0>k._endCut&&(k._endCut=0);0>k._middleCut&&(k._middleCut=0);return k}u._inheritsLoose(f,x);f.prototype.processPath=function(k){var g=this._beginCut;const m=this._endCut,p=this._middleCut,t=this._curveHelper.calculatePathLength(k),
e=[];if(!this._invert)0===g&&0===m&&0===p?e.push(k):g+m+p>=t||(0===p?(k=this._curveHelper.getSubCurve(k,g,t-m))&&e.push(k):((g=this._curveHelper.getSubCurve(k,g,.5*(t-p)))&&e.push(g),(g=this._curveHelper.getSubCurve(k,.5*(t+p),t-m))&&e.push(g)));else if(0!==g||0!==m||0!==p)g+m+p>=t?e.push(k):((g=this._curveHelper.getSubCurve(k,0,g))&&e.push(g),(g=this._curveHelper.getSubCurve(k,.5*(t-p),.5*(t+p)))&&e.push(g),(g=this._curveHelper.getSubCurve(k,t-m,m))&&e.push(g));return 0===e.length?null:{paths:e}};
return f}(E.PathGeometryCursor);r.EffectCut=v;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectDashes":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../CIMCursor ../CurveHelper ../enums ../GeometryWalker".split(" "),function(r,u,E,C,v,z){let x=function(){function k(){}k.local=function(){null===k.instance&&(k.instance=new k);return k.instance};k.prototype.execute=function(g,m,p,t){return new f(g,m,p)};
return k}();x.instance=null;let f=function(k){function g(m,p,t){var e,c;m=k.call(this,m,!0,!0)||this;m._walker=new z.GeometryWalker;m._walker.updateTolerance(t);m._endings=p.lineDashEnding;m._customDashPos=-(null!=(e=p.offsetAlongLine)?e:0)*t;m._offsetAtEnd=(null!=(c=p.customEndingOffset)?c:0)*t;m._pattern=new z.DashPattern;m._pattern.init(p.dashTemplate,!0);m._pattern.scale(t);return m}u._inheritsLoose(g,k);g.prototype.processPath=function(m){if(0===this._pattern.length())return this.iteratePath=
!1,{paths:[m]};if(!this.iteratePath){var p=!0;switch(this._endings){default:this._pattern.extPtGap=0;break;case v.LineDashEnding.FullPattern:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case v.LineDashEnding.FullGap:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case v.LineDashEnding.NoConstraint:this.isClosed||(p=!1);break;case v.LineDashEnding.Custom:this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}var t=this._walker.calculatePathLength(m);
if(this._pattern.isEmpty()||t<.1*this._pattern.length()||!this._walker.init(m,this._pattern,p))return{paths:[m]}}if(this.iteratePath)m=this._pattern.nextValue();else{switch(this._endings){default:p=.5*this._pattern.firstValue();break;case v.LineDashEnding.HalfGap:p=.5*-this._pattern.lastValue();break;case v.LineDashEnding.FullGap:p=-this._pattern.lastValue();break;case v.LineDashEnding.FullPattern:p=0;break;case v.LineDashEnding.NoConstraint:case v.LineDashEnding.Custom:p=-this._customDashPos}m=p/
this._pattern.length();m-=Math.floor(m);p=m*this._pattern.length();this._pattern.reset();m=this._pattern.nextValue();for(t=!1;p>=m;)p-=m,m=this._pattern.nextValue(),t=!t;m-=p;t?(this._walker.nextPosition(m),m=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(m),m=this._pattern.nextValue(),this._walker.nextPosition(m),m=this._pattern.nextValue())}(p=this._walker.nextCurve(m))?this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(this._firstCurve.splice(0,
1),C.PathHelper.mergePath(p,this._firstCurve),this._firstCurve=null)):(m=this._pattern.nextValue(),!this._walker.nextPosition(m)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(p=this._firstCurve,this._firstCurve=null)):this.iteratePath=!0):(this.iteratePath=!1,p=this._firstCurve,this._firstCurve=null);return{paths:[p]}};return g}(E.PathGeometryCursor);r.EffectDashes=x;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/GeometryWalker":function(){define(["exports",
"../../chunks/_rollupPluginBabelHelpers","./CIMCursor","./CurveHelper"],function(r,u,E,C){let v=function(){function f(){this._values=[];this._currentValue=this._length=this.ctrlPtGap=this.extPtGap=0}var k=f.prototype;k.isEmpty=function(){return 0===this._values.length};k.size=function(){return this._values.length};k.init=function(g,m,p=!0){this._setEmpty();if(!g||0===g.length)return!1;for(let t=0;t<g.length;t++){let e=Math.abs(g[t]);p&&1E-7>e&&(e=1E-7);this._values.push(e);this._length+=e}m&&g.length&
1&&(this._length*=2);if(0===this._length)return!1;this.ctrlPtGap=this.extPtGap=0;this._currentValue=-1;return!0};k.scale=function(g){const m=this._values?this._values.length:0;for(let p=0;p<m;++p)this._values[p]*=g;this._length*=g;this.extPtGap*=g;this.ctrlPtGap*=g};k.addValue=function(g){this._length+=g;this._values.push(g)};k.firstValue=function(){return this._values[0]};k.lastValue=function(){return this._values[this._values.length-1]};k.nextValue=function(){this._currentValue++;this._currentValue===
this._values.length&&(this._currentValue=0);return this._values[this._currentValue]};k.reset=function(){this._currentValue=-1};k.length=function(){return this._length};k._setEmpty=function(){this.extPtGap=this.ctrlPtGap=this._length=0;this._currentValue=-1;this._values.length=0};return f}();r.EndType=void 0;(function(f){f[f.FAIL=0]="FAIL";f[f.END=1]="END";f[f.CONTINUE=2]="CONTINUE"})(r.EndType||(r.EndType={}));let z=function(){function f(){this.reset()}var k=f.prototype;k.reset=function(){this.segment=
-1;this.abscissa=this.segmentLength=0;this.isPartEnd=this.isPathEnd=!1};k.isValid=function(){return-1!==this.segment};k.copyTo=function(g){g.segment=this.segment;g.segmentLength=this.segmentLength;g.abscissa=this.abscissa;g.isPathEnd=this.isPathEnd;g.isPartEnd=this.isPartEnd};return f}(),x=function(f){function k(m=0,p=!1){m=f.call(this,m,p)||this;m._tolerance=C.PIXEL_TOLERANCE;m._currentPosition=new z;return m}u._inheritsLoose(k,f);var g=k.prototype;g.updateTolerance=function(m){this._tolerance=C.PIXEL_TOLERANCE*
m};g.init=function(m,p,t=!0){t?(this._patternLength=p.length(),this._partExtPtGap=p.extPtGap,this._partCtrlPtGap=p.ctrlPtGap):this._partCtrlPtGap=this._partExtPtGap=this._patternLength=0;this._currentPosition.reset();this._partSegCount=0;this._path=m;this._seg=-1;return this._setPosAtNextPart()};g.curPositionIsValid=function(){return this._currentPosition.isValid()};g.nextPosition=function(m,p=r.EndType.FAIL){const t=new z;if(!this._nextPosition(m,t,null,p))return!1;t.copyTo(this._currentPosition);
return!0};g.curPointAndAngle=function(m){m.pt=this._getPoint(this._currentPosition);const [p,t]=this._getAngle(this._currentPosition);m.ca=p;m.sa=t};g.nextPointAndAngle=function(m,p,t=r.EndType.FAIL){const e=new z;if(!this._nextPosition(m,e,null,t))return!1;e.copyTo(this._currentPosition);p.pt=this._getPoint(e);const [c,a]=this._getAngle(e);p.ca=c;p.sa=a;return!0};g.nextCurve=function(m){if(0===m)return null;const p=[],t=new z;if(!this._nextPosition(m,t,p,r.EndType.END))return null;t.copyTo(this._currentPosition);
return p};g.isPathEnd=function(){return this._currentPosition.isPathEnd};g.getPathEnd=function(){if(-1===this._currentPosition.segment)throw Error("missing segment");return this._path[this._currentPosition.segment+1]};g._nextPosition=function(m,p,t,e){if(this._currentPosition.isPathEnd)return!1;var c=this._currentPosition.abscissa;0<this._currentPosition.segmentLength&&(c/=this._currentPosition.segmentLength);for(this._currentPosition.copyTo(p);p.abscissa+m*this._partLengthRatio>p.segmentLength+this._tolerance;)if(t&&
(0===t.length&&(0===c?(c=this._path[p.segment],t.push([c[0],c[1]])):t.push(this.getSegCoord2D(this._path,p.segment,c))),c=this._path[p.segment+1],t.push([c[0],c[1]])),c=0,m-=(p.segmentLength-p.abscissa)/this._partLengthRatio,this._partSegCount)p.segment=this._nextSegment(),p.segmentLength=this.calculateSegLength(this._path,p.segment),p.abscissa=0,this._partSegCount--;else{if(!this._setPosAtNextPart()){if(e===r.EndType.FAIL)return!1;p.segmentLength=this.calculateSegLength(this._path,p.segment);p.isPartEnd=
!0;e===r.EndType.END?(p.abscissa=p.segmentLength,p.isPathEnd=!0):p.abscissa=p.segmentLength+m;return!0}this._currentPosition.copyTo(p)}p.abscissa+=m*this._partLengthRatio;t&&(0===t.length&&(0===c?(m=this._path[p.segment],t.push([m[0],m[1]])):t.push(this.getSegCoord2D(this._path,p.segment,c))),m=p.abscissa/p.segmentLength,1===m?(m=this._path[p.segment+1],t.push([m[0],m[1]])):t.push(this.getSegCoord2D(this._path,p.segment,m)));!this._partSegCount&&Math.abs(p.abscissa-p.segmentLength)<this._tolerance&&
(p.isPathEnd=this._partIsLast,p.isPartEnd=!0);return!0};g._getPoint=function(m){if(-1===m.segment)throw Error("missing segment");return this.getSegCoord2D(this._path,m.segment,0>=m.segmentLength?0:m.abscissa/m.segmentLength)};g._getAngle=function(m){if(-1===m.segment)throw Error("missing segment");return this.getSegAngleCS(this._path,m.segment,0>=m.segmentLength?0:m.abscissa/m.segmentLength)};g._setPosAtNextPart=function(){for(;this._partSegCount;)this._hasNextSegment()&&this._nextSegment(),this._partSegCount--;
if(!this._hasNextSegment())return!1;this._partLength=0;this._partIsLast=!0;for(this._partSegCount=0;this._hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,this._nextSegment()),this._partSegCount++,1===E.getId(this._path[this._getEndPointIndex()])){this._partIsLast=!this._hasNextSegment();break}for(var m=this._partSegCount;m;)this._previousSegment(),--m;this._currentPosition.segment=this._nextSegment();this._currentPosition.segmentLength=this.calculateSegLength(this._path,
this._currentPosition.segment);this._currentPosition.abscissa=0;this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1;--this._partSegCount;m=this._getStartPointIndex();this._ctrlPtBegin=1===E.getId(this._path[m]);m=m+this._partSegCount+1;m>=this._path.length&&(m=0);this._ctrlPtEnd=1===E.getId(this._path[m]);if(0<this._patternLength){m=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap;const p=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let t=Math.round((this._partLength-
(m+p))/this._patternLength);0>=t&&(t=0<m+p?0:1);this._partLengthRatio=this._partLength/(m+p+t*this._patternLength);.01>this._partLengthRatio&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0};g._hasNextSegment=function(){return this._seg<this._path.length-2};g._previousSegment=function(){return--this._seg};g._nextSegment=function(){return++this._seg};g._getStartPointIndex=function(){return this._seg};g._getEndPointIndex=function(){return this._seg+1};return k}(C.CurveHelper);r.DashPattern=
v;r.GeometryWalker=x;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectDonut":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums"],function(r,u,E,C){let v=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(f,k,g,m){return new z(f,k,g)};return x}();v.instance=null;let z=function(){function x(f,k,g){this._inputGeometries=
f;this._curveHelper=new E.CurveHelper;this._width=(void 0!==k.width?k.width:2)*g;switch(k.method){default:this._method=C.GeometricEffectOffsetMethod.Mitered;break;case C.GeometricEffectDonutMethod.Bevelled:this._method=C.GeometricEffectOffsetMethod.Bevelled;break;case C.GeometricEffectDonutMethod.Rounded:case C.GeometricEffectDonutMethod.TrueBuffer:this._method=C.GeometricEffectOffsetMethod.Rounded;break;case C.GeometricEffectDonutMethod.Square:this._method=C.GeometricEffectOffsetMethod.Square}this._option=
k.option;this._offsetFlattenError=E.PIXEL_TOLERANCE*g}x.prototype.next=function(){for(var f=this._inputGeometries.next();f;){if(u.isExtent(f)&&0<this._width){if(0>Math.min(f.xmax-f.xmin,f.ymax-f.ymin)-2*this._width)return f;var k=[];k.push([[f.xmin,f.ymin],[f.xmin,f.ymax],[f.xmax,f.ymax],[f.xmax,f.ymin],[f.xmin,f.ymin]]);k.push([[f.xmin+this._width,f.ymin+this._width],[f.xmax-this._width,f.ymin+this._width],[f.xmax-this._width,f.ymax-this._width],[f.xmin+this._width,f.ymax-this._width],[f.xmin+this._width,
f.ymin+this._width]]);return{rings:k}}if(u.isPolygon(f)&&0<this._width){k=[];for(const g of f.rings){f=this._curveHelper.calculatePathLength(g);const m=this._curveHelper.offset(g,this._width,this._method,4,this._offsetFlattenError);m&&(0>f&&m.reverse(),k.push(m))}if(k.length)return{rings:k}}f=this._inputGeometries.next()}return null};return x}();r.EffectDonut=v;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectJog":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(r,u,E,C){let v=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(f,k,g,m){return new z(f,k,g)};return x}();v.instance=null;let z=function(x){function f(k,g,m){k=x.call(this,k,!1,!0)||this;k._curveHelper=new C.CurveHelper;k._length=(void 0!==g.length?g.length:20)*m;k._angle=void 0!==g.angle?g.angle:225;k._position=void 0!==g.position?
g.position:50;0>k._length&&(k._length=-k._length);20>k._position&&(k._position=20);80<k._position&&(k._position=80);k._mirror=!1;return k}u._inheritsLoose(f,x);f.prototype.processPath=function(k){if(this._curveHelper.isEmpty(k,!1))return null;const g=k[0];k=k[k.length-1];this._curveHelper.normalize([k[0]-g[0],k[1]-g[1]]);const m=[g[0]+(k[0]-g[0])*this._position/100,g[1]+(k[1]-g[1])*this._position/100],p=Math.cos((90-this._angle)/180*Math.PI);let t=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&
(t=-t);this._mirror=!this._mirror;return{paths:[[g,[m[0]-this._length/2*p,m[1]-this._length/2*t],[m[0]+this._length/2*p,m[1]+this._length/2*t],k]]}};return f}(E.PathGeometryCursor);r.EffectJog=v;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectMove":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils"],function(r,u,E){let C=function(){function z(){}z.local=function(){null===z.instance&&(z.instance=
new z);return z.instance};z.prototype.execute=function(x,f,k,g){return new v(x,f,k)};return z}();C.instance=null;let v=function(){function z(f,k,g){this._inputGeometries=f;this._offsetX=void 0!==k.offsetX?k.offsetX*g:0;this._offsetY=void 0!==k.offsetY?-k.offsetY*g:0}var x=z.prototype;x.next=function(){for(var f=this._inputGeometries.next();f;){if(E.isExtent(f))return{xmin:f.xmin+this._offsetX,xmax:f.xmax+this._offsetX,ymin:f.ymin+this._offsetY,ymax:f.ymax+this._offsetY};if(E.isPolygon(f))return f=
u.clone(f),this._moveMultipath(f.rings,this._offsetX,this._offsetY),f;if(E.isPolyline(f))return f=u.clone(f),this._moveMultipath(f.paths,this._offsetX,this._offsetY),f;if(E.isMultipoint(f))return f=u.clone(f),this._movePath(f.points,this._offsetX,this._offsetY),f;if(E.isPoint(f))return{x:f.x+this._offsetX,y:f.y+this._offsetY};f=this._inputGeometries.next()}return null};x._moveMultipath=function(f,k,g){if(f)for(const m of f)this._movePath(m,k,g)};x._movePath=function(f,k,g){if(f)for(const m of f)m[0]+=
k,m[1]+=g};return z}();r.EffectMove=C;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectOffset":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums"],function(r,u,E,C){let v=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(f,k,g,m){return new z(f,k,g)};return x}();v.instance=null;let z=function(){function x(f,
k,g){var m;this._inputGeometries=f;this._curveHelper=new E.CurveHelper;this._offset=(null!=(m=k.offset)?m:1)*g;this._method=k.method;this._option=k.option;this._offsetFlattenError=E.PIXEL_TOLERANCE*g}x.prototype.next=function(){for(var f=this._inputGeometries.next();f;){if(0===this._offset)return f;if(u.isExtent(f)){if(this._method===C.GeometricEffectOffsetMethod.Rounded&&0<this._offset){var k=this._curveHelper.offset([[f.xmin,f.ymin],[f.xmin,f.ymax],[f.xmax,f.ymax],[f.xmax,f.ymin],[f.xmin,f.ymin]],
-this._offset,this._method,4,this._offsetFlattenError);return k?{rings:[k]}:null}if(0<Math.min(f.xmax-f.xmin,f.ymax-f.ymin)+2*this._offset)return{xmin:f.xmin-this._offset,xmax:f.xmax+this._offset,ymin:f.ymin-this._offset,ymax:f.ymax+this._offset}}if(u.isPolygon(f)){var g=[];for(k of f.rings){const m=this._curveHelper.offset(k,-this._offset,this._method,4,this._offsetFlattenError);m&&g.push(m)}if(g.length)return{rings:g}}if(u.isPolyline(f)){g=[];for(const m of f.paths)(f=this._curveHelper.offset(m,
-this._offset,this._method,4,this._offsetFlattenError))&&g.push(f);if(g.length)return{paths:g}}f=this._inputGeometries.next()}return null};return x}();r.EffectOffset=v;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectReverse":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(r,u,E,C){let v=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=
new x);return x.instance};x.prototype.execute=function(f,k,g,m){return new z(f,k,g)};return x}();v.instance=null;let z=function(){function x(f,k,g){this._inputGeometries=f;this._reverse=void 0!==k.reverse?k.reverse:!0}x.prototype.next=function(){for(var f=this._inputGeometries.next();f;){if(!this._reverse)return f;if(E.isPolyline(f))return f=u.clone(f),C.reverseMultipath(f.paths),f;f=this._inputGeometries.next()}return null};return x}();r.EffectReverse=v;Object.defineProperties(r,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectRotate":function(){define(["exports","../../../core/lang","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils"],function(r,u,E,C,v){let z=function(){function f(){}f.local=function(){null===f.instance&&(f.instance=new f);return f.instance};f.prototype.execute=function(k,g,m,p){return new x(k,g,m)};return f}();z.instance=null;let x=function(){function f(g,m,
p){this._inputGeometries=g;this._rotateAngle=void 0!==m.angle?m.angle*Math.PI/180:0}var k=f.prototype;k.next=function(){for(var g=this._inputGeometries.next();g;){if(0===this._rotateAngle)return g;var m=E.create();C.getBoundsXY(m,g);const p=(m[2]+m[0])/2;m=(m[3]+m[1])/2;if(v.isExtent(g))return g={rings:[[[g.xmin,g.ymin],[g.xmin,g.ymax],[g.xmax,g.ymax],[g.xmax,g.ymin],[g.xmin,g.ymin]]]},this._rotateMultipath(g.rings,p,m),g;if(v.isPolygon(g))return g=u.clone(g),this._rotateMultipath(g.rings,p,m),g;
if(v.isPolyline(g))return g=u.clone(g),this._rotateMultipath(g.paths,p,m),g;if(v.isMultipoint(g))return g=u.clone(g),this._rotatePath(g.points,p,m),g;if(v.isPoint(g))return g;g=this._inputGeometries.next()}return null};k._rotateMultipath=function(g,m,p){if(g)for(const t of g)this._rotatePath(t,m,p)};k._rotatePath=function(g,m,p){if(g){const t=Math.cos(this._rotateAngle),e=Math.sin(this._rotateAngle);for(const c of g){g=c[0]-m;const a=c[1]-p;c[0]=m+g*t-a*e;c[1]=p+g*e+a*t}}};return f}();r.EffectRotate=
z;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectScale":function(){define(["exports","../../../core/lang","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils"],function(r,u,E,C,v){let z=function(){function f(){}f.local=function(){null===f.instance&&(f.instance=new f);return f.instance};f.prototype.execute=function(k,g,m,p){return new x(k,g,m)};return f}();
z.instance=null;let x=function(){function f(g,m,p){this._inputGeometries=g;this._xFactor=void 0!==m.xScaleFactor?m.xScaleFactor:1.15;this._yFactor=void 0!==m.yScaleFactor?m.yScaleFactor:1.15}var k=f.prototype;k.next=function(){for(var g=this._inputGeometries.next();g;){if(1===this._xFactor&&1===this._yFactor)return g;var m=E.create();C.getBoundsXY(m,g);const p=(m[2]+m[0])/2;m=(m[3]+m[1])/2;if(v.isExtent(g))return g={rings:[[[g.xmin,g.ymin],[g.xmin,g.ymax],[g.xmax,g.ymax],[g.xmax,g.ymin],[g.xmin,g.ymin]]]},
this._scaleMultipath(g.rings,p,m),g;if(v.isPolygon(g))return g=u.clone(g),this._scaleMultipath(g.rings,p,m),g;if(v.isPolyline(g))return g=u.clone(g),this._scaleMultipath(g.paths,p,m),g;if(v.isMultipoint(g))return g=u.clone(g),this._scalePath(g.points,p,m),g;if(v.isPoint(g))return g;g=this._inputGeometries.next()}return null};k._scaleMultipath=function(g,m,p){if(g)for(const t of g)this._scalePath(t,m,p)};k._scalePath=function(g,m,p){if(g)for(const t of g)g=(t[1]-p)*this._yFactor,t[0]=m+(t[0]-m)*this._xFactor,
t[1]=p+g};return f}();r.EffectScale=z;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectWave":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums","../GeometryWalker"],function(r,u,E,C,v){let z=function(){function f(){}f.local=function(){null===f.instance&&(f.instance=new f);return f.instance};f.prototype.execute=function(k,g,m,p){return new x(k,g,m)};return f}();z.instance=null;let x=
function(){function f(g,m,p){this._inputGeometries=g;this._height=(void 0!==m.amplitude?m.amplitude:2)*p;this._period=(void 0!==m.period?m.period:3)*p;this._style=m.waveform;0>=this._height&&(this._height=Math.abs(this._height));0>=this._period&&(this._period=Math.abs(this._period));this._pattern=new v.DashPattern;this._pattern.addValue(this._period);this._pattern.addValue(this._period);this._walker=new v.GeometryWalker;this._walker.updateTolerance(p)}var k=f.prototype;k.next=function(){for(var g=
this._inputGeometries.next();g;){if(0===this._height||0===this._period)return g;if(u.isPolyline(g)){const m=this._processGeom(g.paths);if(m.length)return{paths:m}}if(u.isPolygon(g)&&(g=this._processGeom(g.rings),g.length))return{rings:g};g=this._inputGeometries.next()}return null};k._processGeom=function(g){const m=[];for(const p of g)if(this._walker.init(p,this._pattern))switch(this._style){default:m.push(this._constructCurve(p,!1));break;case C.GeometricEffectWaveform.Square:m.push(this._constructSquare(p));
break;case C.GeometricEffectWaveform.Triangle:m.push(this._constructTriangle(p));break;case C.GeometricEffectWaveform.Random:m.push(this._constructCurve(p,!0))}else m.push(p);return m};k._constructCurve=function(g,m){const p=new E.PathHelper;var t=this._walker.calculatePathLength(g),e=Math.round(t/this._period);0===e&&(e=1);const c=this._period/16,a=1/(16*e+1);t=2*Math.PI*t/(t/e);e=2*Math.PI*Math.random();const b=2*Math.PI*Math.random(),h=2*Math.PI*Math.random(),l=.75-Math.random()/2,d=.75-Math.random()/
2,q={};this._walker.curPointAndAngle(q);p.startPath(q.pt);let n=0;for(;;)if(this._walker.nextPointAndAngle(c,q)){const B=n;n+=a;let A;if(m){const w=this._height/2*(1+.3*Math.sin(l*t*B+e));A=w*Math.sin(t*B+b);A+=w*Math.sin(d*t*B+h);A/=2}else A=.5*this._height*Math.sin(.5*t*B);p.lineTo([q.pt[0]-A*q.sa,q.pt[1]+A*q.ca])}else{p.lineTo(g[g.length-1]);break}return p.path()};k._constructSquare=function(g){const m=new E.PathHelper;g=this._walker.calculatePathLength(g);Math.round(g/this._period);for(g=!0;;){let p=
!1;if(this._walker.curPositionIsValid()){const t={};this._walker.curPointAndAngle(t);const e={};if(this._walker.nextPointAndAngle(this._period,e)){const c={};this._walker.nextPointAndAngle(this._period,c)&&(g?(m.startPath(t.pt),g=!1):m.lineTo(t.pt),m.lineTo([t.pt[0]-this._height/2*t.sa,t.pt[1]+this._height/2*t.ca]),m.lineTo([e.pt[0]-this._height/2*e.sa,e.pt[1]+this._height/2*e.ca]),m.lineTo([e.pt[0]+this._height/2*e.sa,e.pt[1]-this._height/2*e.ca]),m.lineTo([c.pt[0]+this._height/2*c.sa,c.pt[1]-this._height/
2*c.ca]),p=!0)}}if(!p){m.lineTo(this._walker.getPathEnd());break}}return m.path()};k._constructTriangle=function(g){const m=new E.PathHelper;g=this._walker.calculatePathLength(g);Math.round(g/this._period);for(g=!0;;){let p=!1;if(this._walker.curPositionIsValid()){const t={};this._walker.curPointAndAngle(t);const e={};if(this._walker.nextPointAndAngle(this._period/2,e)){const c={};this._walker.nextPointAndAngle(this._period,c)&&(this._walker.nextPosition(this._period/2)&&(g?(m.startPath(t.pt),g=!1):
m.lineTo(t.pt),m.lineTo([e.pt[0]-this._height/2*e.sa,e.pt[1]+this._height/2*e.ca]),m.lineTo([c.pt[0]+this._height/2*c.sa,c.pt[1]-this._height/2*c.ca])),p=!0)}}if(!p){m.lineTo(this._walker.getPathEnd());break}}return m.path()};return f}();r.EffectWave=z;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementAlongLineSameSize":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../enums",
"../GeometryWalker"],function(r,u,E,C,v){let z=function(){function f(){}f.local=function(){null===f.instance&&(f.instance=new f);return f.instance};f.prototype.execute=function(k,g,m,p){return new x(k,g,m)};return f}();z.instance=null;let x=function(f){function k(m,p,t){var e;m=f.call(this,m,!0,!0)||this;m._geometryWalker=new v.GeometryWalker;m._geometryWalker.updateTolerance(t);m._angleToLine=null!=(e=p.angleToLine)?e:!0;m._offset=(p.offset?p.offset:0)*t;m._originalEndings=p.endings;m._offsetAtEnd=
(p.customEndingOffset?p.customEndingOffset:0)*t;m._position=-(p.offsetAlongLine?p.offsetAlongLine:0)*t;m._pattern=new v.DashPattern;m._pattern.init(p.placementTemplate,!1);m._pattern.scale(t);m._endings=m._originalEndings;return m}u._inheritsLoose(k,f);var g=k.prototype;g.processPath=function(m){if(this._pattern.isEmpty())return null;if(this.iteratePath)var p=this._pattern.nextValue();else{this._endings=this._originalEndings===C.PlacementEndings.WithFullGap&&this.isClosed?C.PlacementEndings.WithMarkers:
this._originalEndings;this._pattern.extPtGap=0;let t=!0;switch(this._endings){case C.PlacementEndings.NoConstraint:p=-this._position;p=this._adjustPosition(p);t=!1;break;default:p=-this._pattern.lastValue()/2;break;case C.PlacementEndings.WithFullGap:p=-this._pattern.lastValue();this._pattern.extPtGap=this._pattern.lastValue();break;case C.PlacementEndings.WithMarkers:p=0;break;case C.PlacementEndings.Custom:p=-this._position,p=this._adjustPosition(p),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._geometryWalker.init(m,
this._pattern,t))return null;this._pattern.reset();for(m=0;p>m;)p-=m,m=this._pattern.nextValue();p=m-=p;this.iteratePath=!0}m={};if(!this._geometryWalker.nextPointAndAngle(p,m)||this._endings===C.PlacementEndings.WithFullGap&&this._geometryWalker.isPathEnd())return this.iteratePath=!1,null;if(this._endings===C.PlacementEndings.WithMarkers&&this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed))return null;this.internalPlacement.setTranslate(m.pt[0]-this._offset*m.sa,m.pt[1]+this._offset*
m.ca);this._angleToLine&&this.internalPlacement.setRotateCS(m.ca,m.sa);return this.internalPlacement};g._adjustPosition=function(m){m/=this._pattern.length();m-=Math.floor(m);return m*this._pattern.length()};return k}(E.PathTransformationCursor);r.PlacementAlongLineSameSize=z;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementAtExtremities":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor",
"../CurveHelper","../enums"],function(r,u,E,C,v){let z=function(){function f(){}f.local=function(){null===f.instance&&(f.instance=new f);return f.instance};f.prototype.execute=function(k,g,m,p){return new x(k,g,m)};return f}();z.instance=null;let x=function(f){function k(m,p,t){m=f.call(this,m,!1,!0)||this;m._curveHelper=new C.CurveHelper;m._angleToLine=void 0!==p.angleToLine?p.angleToLine:!0;m._offset=void 0!==p.offset?p.offset*t:0;m._type=p.extremityPlacement;m._position=void 0!==p.offsetAlongLine?
p.offsetAlongLine*t:0;m._beginProcessed=!1;return m}u._inheritsLoose(k,f);var g=k.prototype;g.processPath=function(m){let p;switch(this._type){default:this._beginProcessed?(p=this._atExtremities(m,this._position,!1),this.iteratePath=this._beginProcessed=!1):(p=this._atExtremities(m,this._position,!0),this.iteratePath=this._beginProcessed=!0);break;case v.ExtremityPlacement.JustBegin:p=this._atExtremities(m,this._position,!0);break;case v.ExtremityPlacement.JustEnd:p=this._atExtremities(m,this._position,
!1);case v.ExtremityPlacement.None:}return p};g._atExtremities=function(m,p,t){var e=m.length;if(2>e)return null;var c=t?1:e-2;const a=t?e:-1,b=t?1:-1;let h=0;t=t?m[0]:m[e-1];for(e=c;e!==a;e+=b){c=t;t=m[e];const l=this._curveHelper.calculateLength(c,t);if(h+l>p){m=(p-h)/l;const [d,q]=this._curveHelper.getAngleCS(c,t,m);m=E.getCoord2D(c,t,m);this.internalPlacement.setTranslate(m[0]-this._offset*q,m[1]+this._offset*d);this._angleToLine&&this.internalPlacement.setRotateCS(-d,-q);return this.internalPlacement}h+=
l}return null};return k}(E.PathTransformationCursor);r.PlacementAtExtremities=z;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementAtRatioPositions":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../GeometryWalker"],function(r,u,E,C){let v=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(f,k,g,m){return new z(f,
k,g)};return x}();v.instance=null;let z=function(x){function f(k,g,m){k=x.call(this,k,!0,!0)||this;k._walker=new C.GeometryWalker;k._walker.updateTolerance(m);k._angleToLine=void 0!==g.angleToLine?g.angleToLine:!0;k._offset=void 0!==g.offset?g.offset*m:0;k._beginGap=void 0!==g.beginPosition?g.beginPosition*m:0;k._endGap=void 0!==g.endPosition?g.endPosition*m:0;k._flipFirst=void 0!==g.flipFirst?g.flipFirst:!0;k._pattern=new C.DashPattern;k._pattern.init(g.positionArray,!1,!1);k._subPathLen=0;k._posCount=
k._pattern.size();k._isFirst=!0;k._prevPos=0;return k}u._inheritsLoose(f,x);f.prototype.processPath=function(k){if(this._pattern.isEmpty())return null;if(this.iteratePath){k=this._pattern.nextValue()*this._subPathLen;var g=this._beginGap+k;k=g-this._prevPos;this._prevPos=g}else{this._posCount=this._pattern.size();this._isFirst=!0;this._prevPos=0;this._subPathLen=this._walker.calculatePathLength(k)-this._beginGap-this._endGap;if(0>this._subPathLen)return this.iteratePath=!1,null;if(!this._walker.init(k,
this._pattern,!1))return null;this._pattern.reset();k=this._pattern.nextValue()*this._subPathLen;g=this._beginGap+k;k=g-this._prevPos;this._prevPos=g;this.iteratePath=!0}g={};if(!this._walker.nextPointAndAngle(k,g,C.EndType.END))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(g.pt[0]-this._offset*g.sa,g.pt[1]+this._offset*g.ca);k=this._isFirst&&this._flipFirst;let m;this._angleToLine?(m=g.ca,g=g.sa):(m=1,g=0);k&&(m=-m,g=-g);this.internalPlacement.setRotateCS(m,g);this._isFirst=
!1;this._posCount--;0===this._posCount&&(this.iteratePath=!1);return this.internalPlacement};return f}(E.PathTransformationCursor);r.PlacementAtRatioPositions=v;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementInsidePolygon":function(){define(["exports","../../../core/RandomLCG","../CIMPlacements","../enums"],function(r,u,E,C){let v=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};
x.prototype.execute=function(f,k,g,m){return new z(f,k,g,m)};return x}();v.instance=null;let z=function(){function x(k,g,m,p){var t,e,c;this._currentY=this._currentX=this._yMax=this._yMin=this._xMax=this._xMin=0;this._stepX=Math.abs(null!=(t=g.stepX)?t:16)*m;this._stepY=Math.abs(null!=(e=g.stepY)?e:16)*m;if(0!==this._stepX&&0!==this._stepY&&k&&void 0!==k.rings&&k.rings){this._gridType=null!=(c=g.gridType)?c:C.PlacementGridType.Fixed;if(this._gridType===C.PlacementGridType.Random){var a,b;m=null!=
(a=g.seed)?a:13;this._randomLCG=new u(1*m);this._randomness=(null!=(b=g.randomness)?b:100)/100;this._gridAngle=0;this._shiftOddRows=!1;this._cosAngle=1;this._offsetY=this._offsetX=this._sinAngle=0}else{var h,l,d,q;this._randomness=0;this._gridAngle=null!=(h=g.gridAngle)?h:0;this._shiftOddRows=null!=(l=g.shiftOddRows)?l:!1;this._offsetX=(null!=(d=g.offsetX)?d:0)*m;this._offsetY=(null!=(q=g.offsetY)?q:0)*m;this._cosAngle=Math.cos(this._gridAngle/180*Math.PI);this._sinAngle=-Math.sin(this._gridAngle/
180*Math.PI);if(this._stepX)if(0>this._offsetX)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(0>this._offsetY)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}this._graphicOriginY=this._graphicOriginX=0;this._internalPlacement=new E.Placement;this._calculateMinMax(k);this._geometry=k}}var f=x.prototype;f.next=function(){return this._geometry?
this._nextInside():null};f._calculateMinMax=function(k){this._yMax=this._yMin=this._xMax=this._xMin=0;let g,m,p,t,e;m=p=Number.MAX_VALUE;t=e=-Number.MAX_VALUE;for(const a of k.rings){const b=a?a.length:0;for(let h=0;h<b;++h){var c=a[h][0]-this._graphicOriginX-this._offsetX;g=a[h][1]-this._graphicOriginY-this._offsetY;k=this._cosAngle*c-this._sinAngle*g;c=this._sinAngle*c+this._cosAngle*g;m=Math.min(m,k);t=Math.max(t,k);p=Math.min(p,c);e=Math.max(e,c)}}m+=this._graphicOriginX;t+=this._graphicOriginX;
p+=this._graphicOriginY;e+=this._graphicOriginY;this._xMin=Math.round(m/this._stepX);this._xMax=Math.round(t/this._stepX);this._yMin=Math.round(p/this._stepY);this._yMax=Math.round(e/this._stepY);this._currentX=this._xMax+1;this._currentY=this._yMin-1};f._nextInside=function(){for(;;){if(this._currentX>this._xMax){this._currentY++;if(this._currentY>this._yMax)return null;this._currentX=this._xMin;this._shiftOddRows&&this._currentY%2&&this._currentX--}var k=this._currentX*this._stepX+this._offsetX;
this._shiftOddRows&&this._currentY%2&&(k+=.5*this._stepX);const g=this._currentY*this._stepY+this._offsetY;this._currentX++;let m;this._gridType===C.PlacementGridType.Random?(m=this._graphicOriginX+k+this._stepX*this._randomness*(.5-this._randomLCG.getFloat())*2/3,k=this._graphicOriginY+g+this._stepY*this._randomness*(.5-this._randomLCG.getFloat())*2/3):(m=this._graphicOriginX+this._cosAngle*k+this._sinAngle*g,k=this._graphicOriginY-this._sinAngle*k+this._cosAngle*g);this._internalPlacement.setTranslate(m,
k);return this._internalPlacement}};return x}();r.PlacementInsidePolygon=v;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementOnLine":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../enums"],function(r,u,E,C,v){let z=function(){function f(){}f.local=function(){null===f.instance&&(f.instance=new f);return f.instance};f.prototype.execute=function(k,g,m,p){return new x(k,
g,m)};return f}();z.instance=null;let x=function(f){function k(m,p,t){m=f.call(this,m,!0,!0)||this;m._curveHelper=new C.CurveHelper;m._angleToLine=void 0!==p.angleToLine?p.angleToLine:!0;m._offset=void 0!==p.offset?p.offset*t:0;m._relativeTo=p.relativeTo;m._position=void 0!==p.startPointOffset?p.startPointOffset*t:0;m._epsilon=.001*t;return m}u._inheritsLoose(k,f);var g=k.prototype;g.processPath=function(m){var p=this._position;if(this._relativeTo===v.PlacementOnLineRelativeTo.SegmentMidpoint){this.iteratePath||
(this._segmentCount=m.length,this._curSegment=1,this.iteratePath=!0);for(;this._curSegment<this._segmentCount;){var t=this._curSegment;this._curSegment++;p=m[t-1];t=m[t];const e=this._curveHelper.calculateLength(p,t);if(e<this._epsilon)continue;m=.5+this._position/e;const [c,a]=this._curveHelper.getAngleCS(p,t,m);m=E.getCoord2D(p,t,m);this.internalPlacement.setTranslate(m[0]-this._offset*a,m[1]+this._offset*c);this._angleToLine&&this.internalPlacement.setRotateCS(c,a);return this.internalPlacement}this.iteratePath=
!1;return null}this._relativeTo===v.PlacementOnLineRelativeTo.LineEnd&&E.reversePath(m);p=this.onLine(m,p);this._relativeTo===v.PlacementOnLineRelativeTo.LineEnd&&E.reversePath(m);return p};g.onLine=function(m,p){let t,e=!1;switch(this._relativeTo){default:t=this._curveHelper.calculatePathLength(m)/2+p;break;case v.PlacementOnLineRelativeTo.LineBeginning:t=p;break;case v.PlacementOnLineRelativeTo.LineEnd:t=p,e=!0}const c=m.length;let a=0,b=m[0];for(let h=1;h<c;++h){p=b;b=m[h];const l=this._curveHelper.calculateLength(p,
b);if(a+l>t){m=(t-a)/l;const [d,q]=this._curveHelper.getAngleCS(p,b,m);m=E.getCoord2D(p,b,m);p=e?-this._offset:this._offset;this.internalPlacement.setTranslate(m[0]-p*q,m[1]+p*d);this._angleToLine&&(e?this.internalPlacement.setRotateCS(-d,-q):this.internalPlacement.setRotateCS(d,q));return this.internalPlacement}a+=l}return null};return k}(E.PathTransformationCursor);r.PlacementOnLine=z;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementOnVertices":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(r,u,E,C){function v(f,k){const g=Math.PI;for(;Math.abs(k-f)>g+2E-15;)k=k-f>g?k-2*g:k+2*g;return(f+k)/2}let z=function(){function f(){}f.local=function(){null===f.instance&&(f.instance=new f);return f.instance};f.prototype.execute=function(k,g,m,p){return new x(k,g,m)};return f}();z.instance=null;let x=function(f){function k(m,p,t){m=f.call(this,m,!0,!0)||this;m._curveHelper=new C.CurveHelper;m._angleToLine=void 0!==
p.angleToLine?p.angleToLine:!0;m._offset=void 0!==p.offset?p.offset*t:0;m._endPoints=void 0!==p.placeOnEndPoints?p.placeOnEndPoints:!0;m._controlPoints=void 0!==p.placeOnControlPoints?p.placeOnControlPoints:!0;m._regularVertices=void 0!==p.placeOnRegularVertices?p.placeOnRegularVertices:!0;m._tags=[];m._tagIterator=0;return m}u._inheritsLoose(k,f);var g=k.prototype;g.processPath=function(m){this.iteratePath||(this._preparePath(m),this.iteratePath=!0);if(this._tagIterator>=this._tags.length)return this._tagIterator=
this._tags.length=0,this.iteratePath=!1,null;m=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(m[2]);let p=m[0],t=m[1];if(0!==this._offset){const e=Math.cos(m[2]);p-=this._offset*Math.sin(m[2]);t+=this._offset*e}this.internalPlacement.setTranslate(p,t);this._tagIterator++;return this.internalPlacement};g._preparePath=function(m){this._tagIterator=this._tags.length=0;const p=E.isClosedPath(m),t=m.length-1;let e=0,c=0,a=0,b=0,h=0,l,d;for(;e<t;){e++;l=m[e-1];d=m[e];
const q=E.getId(l),n=E.getId(d);if(this._angleToLine||0!==this._offset)b=this._curveHelper.getAngle(l,d,0);1===e?p?(c=b,a=q):(this._endPoints||this._controlPoints&&1===q)&&this._tags.push([l[0],l[1],b]):1===q?this._controlPoints&&this._tags.push([l[0],l[1],v(h,b)]):this._regularVertices&&this._tags.push([l[0],l[1],v(h,b)]);if(this._angleToLine||0!==this._offset)h=this._curveHelper.getAngle(l,d,1);e===t&&(p?1===n||1===a?this._controlPoints&&this._tags.push([d[0],d[1],v(h,c)]):this._regularVertices&&
this._tags.push([d[0],d[1],v(h,c)]):(this._endPoints||this._controlPoints&&1===n)&&this._tags.push([d[0],d[1],h]))}this._tagIterator=0};return k}(E.PathTransformationCursor);r.PlacementOnVertices=z;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementPolygonCenter":function(){define(["exports","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../CIMPlacements","../enums"],function(r,u,E,
C,v){let z=function(){function f(){}f.local=function(){null===f.instance&&(f.instance=new f);return f.instance};f.prototype.execute=function(k,g,m,p){return new x(k,g,m)};return f}();z.instance=null;let x=function(){function f(g,m,p){this._geometry=g;this._offsetX=void 0!==m.offsetX?m.offsetX*p:0;this._offsetY=void 0!==m.offsetY?m.offsetY*p:0;this._method=void 0!==m.method?m.method:v.PlacementPolygonCenterMethod.OnPolygon;this._internalPlacement=new C.Placement}var k=f.prototype;k.next=function(){const g=
this._geometry;this._geometry=null;return g&&void 0!==g.rings?this._polygonCenter(g):null};k._polygonCenter=function(g){switch(this._method){default:case v.PlacementPolygonCenterMethod.CenterOfMass:case v.PlacementPolygonCenterMethod.BoundingBoxCenter:{const m=u.create();E.getBoundsXY(m,g);this._internalPlacement.setTranslate((m[2]+m[0])/2+this._offsetX,(m[3]+m[1])/2+this._offsetY)}}return this._internalPlacement};return f}();r.PlacementPolygonCenter=z;Object.defineProperties(r,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/shapingUtils":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../alignmentUtils ../../number ../../Rect ../../collisions/BoundingBox".split(" "),function(r,u,E,C,v,z,x,f,k,g){const m=Math.PI/180;let p=function(){function a(h,l,d,q){this._rotationT=C.create();
this.minZoom=this._yBounds=this._xBounds=0;this.maxZoom=255;this._bounds=null;const n=d.rect,B=new Float32Array(8);h*=q;l*=q;const A=d.code?n.width*q:d.metrics.width,w=d.code?n.height*q:d.metrics.height;B[0]=h;B[1]=l;B[2]=h+A;B[3]=l;B[4]=h;B[5]=l+w;B[6]=h+A;B[7]=l+w;this._data=B;this._setTextureCoords(n);this._scale=q;this._mosaic=d;this.x=h;this.y=l;this.maxOffset=Math.max(h+A,l+w)}var b=a.prototype;b.setTransform=function(h){this._T=h;this._offsets=null};b._setOffsets=function(h){this._offsets||
(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});const l=this._offsets,d=new Float32Array(8),q=E.multiply(C.create(),this._rotationT,this._T);C.transformMany(d,h,q);l.upperLeft=f.i1616to32(8*d[0],8*d[1]);l.upperRight=f.i1616to32(8*d[2],8*d[3]);l.lowerLeft=f.i1616to32(8*d[4],8*d[5]);l.lowerRight=f.i1616to32(8*d[6],8*d[7])};b._setTextureCoords=function({x:h,y:l,width:d,height:q}){this._texcoords={upperLeft:f.i1616to32(h,l),upperRight:f.i1616to32(h+d,l),lowerLeft:f.i1616to32(h,l+q),
lowerRight:f.i1616to32(h+d,l+q)}};u._createClass(a,[{key:"width",get:function(){return this._mosaic.metrics.width*this._scale}},{key:"mosaic",get:function(){return this._mosaic}},{key:"angle",get:function(){return this._angle},set:function(h){this._angle=h;E.fromRotation(this._rotationT,-h);this._setOffsets(this._data)}},{key:"xTopLeft",get:function(){return this._data[0]}},{key:"yTopLeft",get:function(){return this._data[1]}},{key:"xBottomRight",get:function(){return this._data[6]}},{key:"yBottomRight",
get:function(){return this._data[7]}},{key:"texcoords",get:function(){return this._texcoords}},{key:"textureBinding",get:function(){return this._mosaic.textureBinding}},{key:"offsets",get:function(){this._offsets||this._setOffsets(this._data);return this._offsets}},{key:"char",get:function(){return String.fromCharCode(this._mosaic.code)}},{key:"code",get:function(){return this._mosaic.code}},{key:"bounds",get:function(){if(!this._bounds){const {height:n,width:B}=this._mosaic.metrics;var h=B*this._scale,
l=Math.abs(n)*this._scale,d=new Float32Array(8);d[0]=this.x;d[1]=this.y;d[2]=this.x+h;d[3]=this.y;d[4]=this.x;d[5]=this.y+l;d[6]=this.x+h;d[7]=this.y+l;h=E.multiply(C.create(),this._rotationT,this._T);C.transformMany(d,d,h);l=h=Infinity;let A=0;var q=0;for(let w=0;4>w;w++){const y=d[2*w],D=d[2*w+1];h=Math.min(h,y);l=Math.min(l,D);A=Math.max(A,y);q=Math.max(q,D)}d=A-h;q-=l;this._bounds=new g(h+d/2,l+q/2,d,q)}return this._bounds}}]);return a}();const t=(a,b)=>({code:0,page:0,sdf:!0,rect:new k(0,0,11,
8),textureBinding:b,metrics:{advance:0,height:4,width:a,left:0,top:0}});let e=function(){function a(h,l,d){this._rotation=0;this._decorate(h,l,d);this.glyphs=h;this.bounds=this._createBounds(h);this.isMultiline=1<l.length;this._hasRotation=0!==d.angle;this._T=this._createGlyphTransform(this.bounds,d);for(const q of h)q.setTransform(this._T)}var b=a.prototype;b.setRotation=function(h){if(0!==h||0!==this._rotation){this._rotation=h;var l=this._T;h=E.fromRotation(C.create(),h);E.multiply(l,h,l);for(const d of this.glyphs)d.setTransform(this._T)}};
b._decorate=function(h,l,d){if(d.decoration&&"none"!==d.decoration&&h.length){var q=d.scale;d="underline"===d.decoration?30:20;var n=h[0].textureBinding;for(const B of l)h.push(new p(B.startX*q,B.startY*q+d*q,t((B.width+B.glyphWidthEnd)*q,n),1))}};b._createBounds=function(h){let l=Infinity,d=Infinity,q=0;var n=0;for(const B of h)l=Math.min(l,B.xTopLeft),d=Math.min(d,B.yTopLeft),q=Math.max(q,B.xTopLeft+B.width),n=Math.max(n,B.yBottomRight);h=q-l;n-=d;return new g(l+h/2,d+n/2,h,n)};b._createGlyphTransform=
function(h,l){const d=m*l.angle,q=C.create(),n=z.create();E.translate(q,q,v.set(n,l.xOffset,-l.yOffset));l.isCIM?E.rotate(q,q,d):(E.translate(q,q,v.set(n,h.x,h.y)),E.rotate(q,q,d),E.translate(q,q,v.set(n,-h.x,-h.y)));return q};u._createClass(a,[{key:"boundsT",get:function(){var h=this.bounds;const l=v.set(z.create(),h.x,h.y);v.transformMat2d(l,l,this._T);return this._hasRotation?(h=Math.max(h.width,h.height),new g(l[0],l[1],h,h)):new g(l[0],l[1],h.width,h.height)}}]);return a}(),c=function(a,b,h,
l,d,q){this.startY=this.startX=this.glyphWidthEnd=0;this.start=Math.max(0,Math.min(b,h));this.end=Math.max(0,Math.max(b,h));this.end<a.length&&(this.glyphWidthEnd=a[this.end].metrics.width);this.width=l;this.yMin=d;this.yMax=q};r.ShapedGlyph=p;r.ShapingInfo=e;r.shapeGlyphs=function(a,b,h){const l=h.scale,d=[];{var q=[];var n=1/h.scale*h.maxLineWidth;var B=b?a.length-1:0;var A=b?-1:a.length;b=b?-1:1;var w=B,y=0,D=0;let J=w,I=J,H=0,M=Infinity,N=0;for(;w!==A;){const {code:P,metrics:ba}=a[w];var F=Math.abs(ba.top);
10!==P&&32!==P&&(M=Math.min(M,F),N=Math.max(N,F+ba.height));10===P?(w!==B&&(q.push(new c(a,J,w-b,y,M,N)),M=Infinity,N=0),y=0,J=w+b,I=w+b,D=0):32===P?(I=w+b,D=0,H=ba.advance,y+=ba.advance):(y>n&&(I!==J?(F=I-2*b,y-=H,q.push(new c(a,J,F,y-D,M,N)),M=Infinity,N=0,J=I,y=D):(q.push(new c(a,J,w-b,y,M,N)),M=Infinity,N=0,I=J=w,y=0)),y+=ba.advance,D+=ba.advance);w+=b}n=new c(a,J,w-b,y,M,N);0<=n.start&&n.end<a.length&&q.push(n)}for(n=0;n<q.length;n++);n=B=q[0].yMin;B=q[q.length-1].yMax+h.lineHeight*(q.length-
1)+("underline"===h.decoration?4:0)-B;const {vAlign:G,hAlign:K}=h;A=G===x.VAlign.Baseline?1:0;n=(1-A)*-n+B/2*(A?0:G-1)+-26*(A?1:0);for(B=0;B<q.length;B++){const {start:J,end:I,width:H}=q[B];A=H/2*(K+1)*-1-3;b=B*h.lineHeight+n-3;q[B].startX=A;q[B].startY=b;for(w=J;w<=I;w++)y=a[w],10!==y.code&&(D=new p(A+y.metrics.left,b-y.metrics.top,y,l),A+=y.metrics.advance,d.push(D))}return new e(d,q,h)};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/chunks/mat2d":function(){define(["exports",
"./common"],function(r,u){function E(A,w){A[0]=w[0];A[1]=w[1];A[2]=w[2];A[3]=w[3];A[4]=w[4];A[5]=w[5];return A}function C(A){A[0]=1;A[1]=0;A[2]=0;A[3]=1;A[4]=0;A[5]=0;return A}function v(A,w,y,D,F,G,K){A[0]=w;A[1]=y;A[2]=D;A[3]=F;A[4]=G;A[5]=K;return A}function z(A,w){const y=w[0],D=w[1],F=w[2],G=w[3],K=w[4];w=w[5];let J=y*G-D*F;if(!J)return null;J=1/J;A[0]=G*J;A[1]=-D*J;A[2]=-F*J;A[3]=y*J;A[4]=(F*w-G*K)*J;A[5]=(D*K-y*w)*J;return A}function x(A){return A[0]*A[3]-A[1]*A[2]}function f(A,w,y){const D=
w[0],F=w[1],G=w[2],K=w[3],J=w[4];w=w[5];const I=y[0],H=y[1],M=y[2],N=y[3],P=y[4];y=y[5];A[0]=D*I+G*H;A[1]=F*I+K*H;A[2]=D*M+G*N;A[3]=F*M+K*N;A[4]=D*P+G*y+J;A[5]=F*P+K*y+w;return A}function k(A,w,y){const D=w[0],F=w[1],G=w[2],K=w[3],J=w[4];w=w[5];const I=Math.sin(y);y=Math.cos(y);A[0]=D*y+G*I;A[1]=F*y+K*I;A[2]=D*-I+G*y;A[3]=F*-I+K*y;A[4]=J;A[5]=w;return A}function g(A,w,y){const D=w[1],F=w[2],G=w[3],K=w[4],J=w[5],I=y[0];y=y[1];A[0]=w[0]*I;A[1]=D*I;A[2]=F*y;A[3]=G*y;A[4]=K;A[5]=J;return A}function m(A,
w,y){const D=w[0],F=w[1],G=w[2],K=w[3],J=w[4];w=w[5];const I=y[0];y=y[1];A[0]=D;A[1]=F;A[2]=G;A[3]=K;A[4]=D*I+G*y+J;A[5]=F*I+K*y+w;return A}function p(A,w){const y=Math.sin(w);w=Math.cos(w);A[0]=w;A[1]=y;A[2]=-y;A[3]=w;A[4]=0;A[5]=0;return A}function t(A,w){A[0]=w[0];A[1]=0;A[2]=0;A[3]=w[1];A[4]=0;A[5]=0;return A}function e(A,w){A[0]=1;A[1]=0;A[2]=0;A[3]=1;A[4]=w[0];A[5]=w[1];return A}function c(A){return"mat2d("+A[0]+", "+A[1]+", "+A[2]+", "+A[3]+", "+A[4]+", "+A[5]+")"}function a(A){return Math.sqrt(A[0]**
2+A[1]**2+A[2]**2+A[3]**2+A[4]**2+A[5]**2+1)}function b(A,w,y){A[0]=w[0]+y[0];A[1]=w[1]+y[1];A[2]=w[2]+y[2];A[3]=w[3]+y[3];A[4]=w[4]+y[4];A[5]=w[5]+y[5];return A}function h(A,w,y){A[0]=w[0]-y[0];A[1]=w[1]-y[1];A[2]=w[2]-y[2];A[3]=w[3]-y[3];A[4]=w[4]-y[4];A[5]=w[5]-y[5];return A}function l(A,w,y){A[0]=w[0]*y;A[1]=w[1]*y;A[2]=w[2]*y;A[3]=w[3]*y;A[4]=w[4]*y;A[5]=w[5]*y;return A}function d(A,w,y,D){A[0]=w[0]+y[0]*D;A[1]=w[1]+y[1]*D;A[2]=w[2]+y[2]*D;A[3]=w[3]+y[3]*D;A[4]=w[4]+y[4]*D;A[5]=w[5]+y[5]*D;return A}
function q(A,w){return A[0]===w[0]&&A[1]===w[1]&&A[2]===w[2]&&A[3]===w[3]&&A[4]===w[4]&&A[5]===w[5]}function n(A,w){const y=A[0],D=A[1],F=A[2],G=A[3],K=A[4];A=A[5];const J=w[0],I=w[1],H=w[2],M=w[3],N=w[4];w=w[5];return Math.abs(y-J)<=u.EPSILON*Math.max(1,Math.abs(y),Math.abs(J))&&Math.abs(D-I)<=u.EPSILON*Math.max(1,Math.abs(D),Math.abs(I))&&Math.abs(F-H)<=u.EPSILON*Math.max(1,Math.abs(F),Math.abs(H))&&Math.abs(G-M)<=u.EPSILON*Math.max(1,Math.abs(G),Math.abs(M))&&Math.abs(K-N)<=u.EPSILON*Math.max(1,
Math.abs(K),Math.abs(N))&&Math.abs(A-w)<=u.EPSILON*Math.max(1,Math.abs(A),Math.abs(w))}const B=Object.freeze(Object.defineProperty({__proto__:null,copy:E,identity:C,set:v,invert:z,determinant:x,multiply:f,rotate:k,scale:g,translate:m,fromRotation:p,fromScaling:t,fromTranslation:e,str:c,frob:a,add:b,subtract:h,multiplyScalar:l,multiplyScalarAndAdd:d,exactEquals:q,equals:n,mul:f,sub:h},Symbol.toStringTag,{value:"Module"}));r.add=b;r.copy=E;r.determinant=x;r.equals=n;r.exactEquals=q;r.frob=a;r.fromRotation=
p;r.fromScaling=t;r.fromTranslation=e;r.identity=C;r.invert=z;r.mat2d=B;r.mul=f;r.multiply=f;r.multiplyScalar=l;r.multiplyScalarAndAdd=d;r.rotate=k;r.scale=g;r.set=v;r.str=c;r.sub=h;r.subtract=h;r.translate=m})},"esri/chunks/mat2df32":function(){define(["exports"],function(r){function u(){const k=new Float32Array(6);k[0]=1;k[3]=1;return k}function E(k){const g=new Float32Array(6);g[0]=k[0];g[1]=k[1];g[2]=k[2];g[3]=k[3];g[4]=k[4];g[5]=k[5];return g}function C(k,g,m,p,t,e){const c=new Float32Array(6);
c[0]=k;c[1]=g;c[2]=m;c[3]=p;c[4]=t;c[5]=e;return c}function v(k,g){return new Float32Array(k,g,6)}function z(k,g,m,p){const t=g[p];g=g[p+1];k[p]=m[0]*t+m[2]*g+m[4];k[p+1]=m[1]*t+m[3]*g+m[5]}function x(k,g,m,p=0,t=0,e=2){for(t=t||g.length/e;p<t;p++)z(k,g,m,p*e)}const f=Object.freeze(Object.defineProperty({__proto__:null,create:u,clone:E,fromValues:C,createView:v,transform:z,transformMany:x},Symbol.toStringTag,{value:"Module"}));r.clone=E;r.create=u;r.createView=v;r.fromValues=C;r.mat2df32=f;r.transform=
z;r.transformMany=x})},"esri/chunks/vec2f32":function(){define(["exports"],function(r){function u(){return new Float32Array(2)}function E(c){const a=new Float32Array(2);a[0]=c[0];a[1]=c[1];return a}function C(c,a){const b=new Float32Array(2);b[0]=c;b[1]=a;return b}function v(c,a){return new Float32Array(c,a,2)}function z(){return u()}function x(){return C(1,1)}function f(){return C(1,0)}function k(){return C(0,1)}const g=u(),m=x(),p=f(),t=k(),e=Object.freeze(Object.defineProperty({__proto__:null,
create:u,clone:E,fromValues:C,createView:v,zeros:z,ones:x,unitX:f,unitY:k,ZEROS:g,ONES:m,UNIT_X:p,UNIT_Y:t},Symbol.toStringTag,{value:"Module"}));r.ONES=m;r.UNIT_X=p;r.UNIT_Y=t;r.ZEROS=g;r.clone=E;r.create=u;r.createView=v;r.fromValues=C;r.ones=x;r.unitX=f;r.unitY=k;r.vec2f32=e;r.zeros=z})},"esri/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/vec2f32"],function(r,u){return function(){function E(v,z,x,f){this.center=
u.fromValues(v,z);this.centerT=u.create();this.halfWidth=x/2;this.halfHeight=f/2;this.width=x;this.height=f}var C=E.prototype;C.clone=function(){return new E(this.x,this.y,this.width,this.height)};C.serialize=function(v){v.writeF32(this.center[0]);v.writeF32(this.center[1]);v.push(this.width);v.push(this.height);return v};C.findCollisionDelta=function(v,z=4){return Math.log2(Math.min((v.halfWidth+this.halfWidth+z)/Math.abs(v.centerT[0]-this.centerT[0]),(v.halfHeight+this.halfHeight+z)/Math.abs(v.centerT[1]-
this.centerT[1])))};C.extend=function(v){const z=Math.min(this.xmin,v.xmin),x=Math.min(this.ymin,v.ymin),f=Math.max(this.xmax,v.xmax)-z;v=Math.max(this.ymax,v.ymax)-x;this.width=f;this.height=v;this.halfWidth=f/2;this.halfHeight=v/2;this.x=z+f/2;this.y=x+v/2};E.deserialize=function(v){const z=v.readF32(),x=v.readF32(),f=v.readInt32();v=v.readInt32();return new E(z,x,f,v)};r._createClass(E,[{key:"x",get:function(){return this.center[0]},set:function(v){this.center[0]=v}},{key:"y",get:function(){return this.center[1]},
set:function(v){this.center[1]=v}},{key:"blX",get:function(){return this.center[0]+this.halfWidth}},{key:"blY",get:function(){return this.center[1]+this.halfHeight}},{key:"trX",get:function(){return this.center[0]-this.halfWidth}},{key:"trY",get:function(){return this.center[1]-this.halfHeight}},{key:"xmin",get:function(){return this.x-this.halfWidth}},{key:"xmax",get:function(){return this.x+this.halfWidth}},{key:"ymin",get:function(){return this.y-this.halfHeight}},{key:"ymax",get:function(){return this.y+
this.halfHeight}}]);return E}()})},"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define(["../../../../../../core/maybe","../../../../../../symbols/cim/effects/CIMEffectHelper"],function(r,u){return function(){function E(){}var C=E.prototype;C.bindFeature=function(v,z,x){};C.write=function(v,z,x,f){var k;if(r.isNone(this._effects)||0===(null==(k=this._effects)?void 0:k.length))return this._write(v,z,f);x=u.CIMEffectHelper.executeEffects(this._effects,z.readLegacyGeometryForDisplay(),
f.geometryEngine);for(k=u.CIMEffectHelper.next(x);k;)this._write(v,z,f,k),k=u.CIMEffectHelper.next(x)};C._write=function(v,z,x,f){};return E}()})},"esri/symbols/cim/effects/CIMEffectHelper":function(){define(["exports","../../../geometry/support/jsonUtils","../CIMCursor","../CIMEffects","../CIMOperators"],function(r,u,E,C,v){const z=96/72;let x=function(){function f(){}f.executeEffects=function(k,g,m){g=E.cloneAndDecodeGeometry(g);g=new C.SimpleGeometryCursor(g);for(const p of k)(k=v.getEffectOperator(p))&&
(g=k.execute(g,p,z,m));return g};f.next=function(k){k=k.next();E.deltaEncodeGeometry(k);return k};f.applyEffects=function(k,g,m){if(!k)return g;g=new C.SimpleGeometryCursor(g);for(var p of k)(k=v.getEffectOperator(p))&&(g=k.execute(g,p,1,m));for(m=null;p=g.next();)m?u.isPolyline(m)?u.isPolyline(p)&&m.paths.push(...p.paths):u.isPolygon(m)&&u.isPolygon(p)&&m.rings.push(...p.rings):m=p;return m};return f}();r.CIMEffectHelper=x;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/symbols/cim/CIMEffects":function(){define(["exports","../../core/lang"],function(r,u){let E=function(){function C(v){this._geometry=v}C.prototype.next=function(){const v=this._geometry;this._geometry=null;return v};return C}();r.SimpleGeometryCursor=E;r.clone=function(C){return u.clone(C)};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t,e){return function(c){function a(b,h,l,d,q,n,B,A,w,y,D,F,G,K,J,I,H,M,N,P,ba,X,S){var W=c.call(this)||this;W.angle=d;W.height=B;W.width=n;W.xOffset=h*N;W.yOffset=l*N;W._markerPlacement=P;W._effects=ba;W._anchorX=.5-(.5+I)*J.width/J.width;W._anchorY=.5-(.5+H)*J.height/J.height;W._minMaxZoom=g.i1616to32(Math.round(X*f.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(S*f.MIN_MAX_ZOOM_PRECISION_FACTOR));h=(K===z.Alignment.MAP?f.BITSET_MARKER_ALIGNMENT_MAP:f.BITSET_MARKER_ALIGNMENT_SCREEN)|
(D?f.BITSET_GENERIC_LOCK_COLOR:0)|(G?f.BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE:0)|(F?f.BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY:0);l=J&&J.sdf;b=m.MarkerMaterialKey.load(b);b.sdf=l;b.pattern=!0;b.textureBinding=J.textureBinding;W._materialKey=b.data;W._fillColor=q;W._outlineColor=w;W._sizeOutlineWidth=g.i8888to32(Math.round(Math.min(Math.sqrt(128*n),255)),Math.round(Math.min(Math.sqrt(128*B),255)),Math.round(Math.min(Math.sqrt(128*y),255)),Math.round(Math.min(Math.sqrt(128*A),255)));q=J.rect.x+
f.SPRITE_PADDING;A=J.rect.y+f.SPRITE_PADDING;w=q+J.width;J=A+J.height;W._offsets.xUpperLeft=q;W._offsets.yUpperLeft=A;W._offsets.xUpperRight=w;W._offsets.yUpperRight=A;W._offsets.xBottomLeft=q;W._offsets.yBottomLeft=J;W._offsets.xBottomRight=w;W._offsets.yBottomRight=J;b.symbologyType===k.WGLSymbologyType.PIE_CHART?(W._texUpperLeft=g.i1616to32(0,1),W._texUpperRight=g.i1616to32(1,1),W._texBottomLeft=g.i1616to32(0,0),W._texBottomRight=g.i1616to32(1,0)):(W._texUpperLeft=g.i1616to32(q,A),W._texUpperRight=
g.i1616to32(w,A),W._texBottomLeft=g.i1616to32(q,J),W._texBottomRight=g.i1616to32(w,J));n=n*M*N;B=B*M*N;W._bitestAndDistRatio=g.i1616to32(h,Math.round(64*M));W._computedWidth=n;W._computedHeight=B;n=v.create();B=C.create();W._applyTransformation(B,n);return W}r._inheritsLoose(a,c);a.fromCIMMarker=function(b,h,l){const d=b.size,q=(h&&h.width||1)/(h&&h.height||1)*b.scaleX;var n=b.scaleSymbolsProportionally&&b.frameHeight?d/b.frameHeight:1;let B=x.premultiplyAlphaRGBA(b.color);const A=x.premultiplyAlphaRGBA(b.outlineColor),
w=E.pt2px(d),y=w*q,D=E.pt2px(b.offsetX||0),F=E.pt2px(b.offsetY||0);n*=E.pt2px(b.outlineWidth||0);const G=b.alignment||z.Alignment.SCREEN,K=E.pt2px(b.referenceSize),[J,I]=p.getMinMaxZoom(b.scaleInfo,l);h.sdf||0!==B||(B=-1);l=b.rotation||0;b.rotateClockwise||(l=-l);let H=0,M=0;const N=b.anchorPoint;N&&(b.isAbsoluteAnchorPoint?d&&(H=-N.x/(d*q),M=N.y/d):(H=N.x,M=N.y));h=new a(b.materialKey,D,F,l,B,y,w,K,A,n,b.colorLocked,b.scaleSymbolsProportionally,!1,G,h,H,M,b.sizeRatio,u.unwrapOr(b.scaleFactor,1),
b.markerPlacement,b.effects,J,I);h._vertexBoundsScaleX=b.maxVVSize?b.maxVVSize/y:1;h._vertexBoundsScaleY=b.maxVVSize?b.maxVVSize/w:1;return h};a.fromPictureMarker=function(b,h){const l=Math.round(E.pt2px(b.width)),d=Math.round(E.pt2px(b.height)),q=f.PICTURE_FILL_COLOR,n=Math.round(E.pt2px(b.xoffset||0)),B=Math.round(E.pt2px(b.yoffset||0));h=new a(b.materialKey,n,B,b.angle,q,l,d,d,0,0,!1,!1,!1,z.Alignment.SCREEN,h,0,0,1,1,null,null,p.DEFAULT_MIN_ZOOM,p.DEFAULT_MAX_ZOOM);h._vertexBoundsScaleX=b.maxVVSize?
b.maxVVSize/b.width:1;h._vertexBoundsScaleY=b.maxVVSize?b.maxVVSize/b.height:1;return h};a.fromSimpleMarker=function(b,h){const l=x.premultiplyAlphaRGBAArray(b.color),d=Math.round(E.pt2px(b.size)),q=Math.round(E.pt2px(b.xoffset||0)),n=Math.round(E.pt2px(b.yoffset||0)),B=b.style;var A=b.outline;const w=(A&&A.color&&x.premultiplyAlphaRGBAArray(A.color))|0;A=(A&&A.width&&Math.round(E.pt2px(A.width)))|0;h=new a(b.materialKey,q,n,b.angle,l,d,d,d,w,A,!1,!1,"esriSMSCross"===B||"esriSMSX"===B,z.Alignment.SCREEN,
h,0,0,1.96875,1,null,null,p.DEFAULT_MIN_ZOOM,p.DEFAULT_MAX_ZOOM);h.boundsType="esriSMSCircle"===B?"circle":"square";h._vertexBoundsScaleX=b.maxVVSize?b.maxVVSize/b.size:1;h._vertexBoundsScaleY=b.maxVVSize?b.maxVVSize/b.size:1;return h};a.fromLineSymbolMarker=function(b,h){const l=x.premultiplyAlphaRGBAArray(b.color),d=Math.round(E.pt2px(6*b.lineWidth)),q="cross"===b.style||"x"===b.style;switch(b.placement){case "begin-end":var n=z.ExtremityPlacement.Both;break;case "begin":n=z.ExtremityPlacement.JustBegin;
break;case "end":n=z.ExtremityPlacement.JustEnd;break;default:n=z.ExtremityPlacement.None}n={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:n,offsetAlongLine:0};h=new a(b.materialKey,0,0,0,l,d,d,d/6,l,q?Math.round(E.pt2px(b.lineWidth)):0,!1,!1,q,z.Alignment.MAP,h,0,0,1.96875,1,n,null,p.DEFAULT_MIN_ZOOM,p.DEFAULT_MAX_ZOOM);h.boundsType="circle"===b.style?"circle":"square";return h};return a}(t(e))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../definitions ../../enums ../../number ../../materialKey/MaterialKey".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t){const e=3.14159265359/180;return c=>function(a){function b(...l){l=a.call(this,...l)||this;l.angle=0;l.xOffset=0;l.yOffset=0;l.width=0;l.height=0;l.boundsType="square";l._anchorX=0;l._anchorY=0;l._computedWidth=0;l._computedHeight=0;l._vertexBoundsScaleX=1;l._vertexBoundsScaleY=1;l._offsets={xUpperLeft:0,yUpperLeft:0,xUpperRight:0,yUpperRight:0,xBottomLeft:0,yBottomLeft:0,xBottomRight:0,yBottomRight:0};l.geometryType=m.WGLGeometryType.MARKER;return l}r._inheritsLoose(b,
a);var h=b.prototype;h._write=function(l,d,q,n){const B=d.getDisplayId();l.recordStart(B,this._materialKey,this.geometryType,!0);this._writeGeometry(l,d,B,q,n);l.recordEnd()};h._writeGeometry=function(l,d,q,n,B){if(u.isSome(this._markerPlacement))return this._writePlacedMarkers(l,d,n,B);if(!B&&"esriGeometryPoint"===d.geometryType)return n=d.getX(),d=d.getY(),!l.hasAggregates&&l.hasPixelBufferEnabled&&(0>n||513<=n||0>d||513<=d)?void 0:this._writeVertices(l,q,this._getPos(n,d),n,d);d=B?f.deltaDecodeGeometry(f.convertFromGeometry(B),
2):"esriGeometryPolygon"===d.geometryType?d.readCentroid():d.readGeometryForDisplay();if(!u.isNone(d)){if(d.isPoint){const [A,w]=d.coords;return!l.hasAggregates&&l.hasPixelBufferEnabled&&(0>A||512<=A||0>w||512<=w)?void 0:this._writeVertices(l,q,this._getPos(A,w),A,w)}d.forEachVertex((A,w)=>{const y=2*g.TILE_SIZE;A<-y||A>=y||w<-y||w>=y||this._writeVertices(l,q,this._getPos(A,w),A,w)})}};h._writePlacedMarkers=function(l,d,q,n){n=null!=n?n:d.readLegacyGeometryForDisplay();if(q=k.CIMMarkerPlacementHelper.getPlacement(n,
u.unwrap(this._markerPlacement),E.pt2px(1),q.geometryEngine)){d=d.getDisplayId();n=x.create();for(var B=v.create(),A=q.next();null!=A;){const w=A.tx,y=-A.ty;-128<=w&&640>=w&&-128<=y&&640>=y&&(this._applyTransformation(B,n,-A.getAngle()/e),this._writeVertices(l,d,this._getPos(w,y),w,y));A=q.next()}}};h._writeVertices=function(l,d,q,n,B){const A=t.MarkerMaterialKey.load(this._materialKey);switch(A.symbologyType){case m.WGLSymbologyType.HEATMAP:return this._writeHeatmapVertices(l,d,q,n,B);default:return this._writeMarkerVertices(l,
d,A,q,n,B)}};h._writeMarkerVertices=function(l,d,q,n,B,A){var w=q.vvRotation;q=l.vertexCount();let y=this._computedWidth*this._vertexBoundsScaleX;var D=this._computedHeight*this._vertexBoundsScaleY;this.angle&&(y=D=Math.max(y,D));w&&(w=Math.max(this.xOffset,this.yOffset),y+=w,D+=w);l.vertexBounds(B+this.xOffset,A-this.yOffset,y,D);l.vertexWrite(n);l.vertexWrite(this._offsetUpperLeft);l.vertexWrite(this._texUpperLeft);l.vertexWrite(this._bitestAndDistRatio);l.vertexWrite(d);l.vertexWrite(this._fillColor);
l.vertexWrite(this._outlineColor);l.vertexWrite(this._sizeOutlineWidth);l.vertexWrite(this._minMaxZoom);l.vertexEnd();l.vertexWrite(n);l.vertexWrite(this._offsetUpperRight);l.vertexWrite(this._texUpperRight);l.vertexWrite(this._bitestAndDistRatio);l.vertexWrite(d);l.vertexWrite(this._fillColor);l.vertexWrite(this._outlineColor);l.vertexWrite(this._sizeOutlineWidth);l.vertexWrite(this._minMaxZoom);l.vertexEnd();l.vertexWrite(n);l.vertexWrite(this._offsetBottomLeft);l.vertexWrite(this._texBottomLeft);
l.vertexWrite(this._bitestAndDistRatio);l.vertexWrite(d);l.vertexWrite(this._fillColor);l.vertexWrite(this._outlineColor);l.vertexWrite(this._sizeOutlineWidth);l.vertexWrite(this._minMaxZoom);l.vertexEnd();l.vertexWrite(n);l.vertexWrite(this._offsetBottomRight);l.vertexWrite(this._texBottomRight);l.vertexWrite(this._bitestAndDistRatio);l.vertexWrite(d);l.vertexWrite(this._fillColor);l.vertexWrite(this._outlineColor);l.vertexWrite(this._sizeOutlineWidth);l.vertexWrite(this._minMaxZoom);l.vertexEnd();
this._writeIndices(l,q)};h._writeHeatmapVertices=function(l,d,q,n,B){const A=l.vertexCount();l.vertexBounds(n+this.xOffset,B-this.yOffset,this.width,this.height);l.vertexWrite(q);l.vertexWrite(this._offsetUpperLeft);l.vertexWrite(d);l.vertexEnd();l.vertexWrite(q);l.vertexWrite(this._offsetUpperRight);l.vertexWrite(d);l.vertexEnd();l.vertexWrite(q);l.vertexWrite(this._offsetBottomLeft);l.vertexWrite(d);l.vertexEnd();l.vertexWrite(q);l.vertexWrite(this._offsetBottomRight);l.vertexWrite(d);l.vertexEnd();
this._writeIndices(l,A)};h._writeIndices=function(l,d){l.indexWrite(d+0);l.indexWrite(d+1);l.indexWrite(d+2);l.indexWrite(d+1);l.indexWrite(d+3);l.indexWrite(d+2)};h._applyTransformation=function(l,d,q=0){C.fromTranslation(l,x.fromValues(this.xOffset,-this.yOffset));0!==this.angle+q&&C.rotate(l,l,e*(this.angle+q));q=this._computedWidth;const n=this._computedHeight,B=(this._anchorX-.5)*q,A=(this._anchorY-.5)*n;z.set(d,B,A);z.transformMat2d(d,d,l);this._offsetUpperLeft=p.i1616to32(16*d[0],16*d[1]);
this._offsets.xUpperLeft=d[0];this._offsets.yUpperLeft=d[1];z.set(d,B+q,A);z.transformMat2d(d,d,l);this._offsetUpperRight=p.i1616to32(16*d[0],16*d[1]);this._offsets.xUpperRight=d[0];this._offsets.yUpperRight=d[1];z.set(d,B,A+n);z.transformMat2d(d,d,l);this._offsetBottomLeft=p.i1616to32(16*d[0],16*d[1]);this._offsets.xBottomLeft=d[0];this._offsets.yBottomLeft=d[1];z.set(d,B+q,A+n);z.transformMat2d(d,d,l);this._offsetBottomRight=p.i1616to32(16*d[0],16*d[1]);this._offsets.xBottomRight=d[0];this._offsets.yBottomRight=
d[1]};h._getPos=function(l,d){return p.i1616to32(Math.round(8*l),Math.round(8*d))};return b}(c)})},"esri/views/2d/engine/webgl/mesh/templates/WGLTemplateStore":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/support/defaultsJSON ../../enums ../../materialKey/MaterialKey ./WGLDynamicFillTemplate ./WGLDynamicLineTemplate ./WGLDynamicMarkerTemplate ./WGLDynamicTextTemplate ./WGLFillTemplate ./WGLLineTemplate ./WGLMarkerTemplate ./WGLTextTemplate ../../util/Lock ../../util/Result ../../../../layers/features/textUtils ../../../../layers/support/cimSymbolUtils".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t,e,c,a,b,h,l,d){function q(G,K){const J=G.length;G.push(null);K.then(I=>G[J]=I);return G}function n(G){return!!(G&1)}const B=C.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),A=[];C={isOutline:!1,placement:null,symbologyType:x.WGLSymbologyType.DEFAULT,vvFlags:0};const w={...z.errorPointSymbolJSON,hash:JSON.stringify(z.errorPointSymbolJSON),materialKey:f.createMaterialKey(x.WGLGeometryType.MARKER,C)},y={...z.errorPolylineSymbolJSON,hash:JSON.stringify(z.errorPolylineSymbolJSON),
materialKey:f.createMaterialKey(x.WGLGeometryType.LINE,C)},D={...z.errorPolygonSymbolJSON,hash:JSON.stringify(z.errorPolygonSymbolJSON),materialKey:f.createMaterialKey(x.WGLGeometryType.FILL,C)};z=function(){function G(J,I){this._templateIdCounter=this._idCounter=1;this._idToTemplateGroup=new Map;this._symbolToTemplate=new Map;this._fetchQueue=[];this._idToResolver=new Map;this._cimTemplateCache=new Map;this._cimAnalyses=[];this._lock=new b.Lock;this._fetchResource=J;this._tileInfo=I}var K=G.prototype;
K.createTemplateGroup=function(J,I){this._initErrorTemplates();const H=J.hash;if(this._symbolToTemplate.has(H))return this._symbolToTemplate.get(H);const M=[];I&&this._createMeshTemplates(M,I,!0);this._createMeshTemplates(M,J,!1);J=this._createGroupId("expanded-cim"===J.type&&F(J));this._idToTemplateGroup.set(J,M);this._symbolToTemplate.set(H,J);return J};K.getTemplateGroup=function(J){return this._idToTemplateGroup.has(J)?this._idToTemplateGroup.get(J):A};K.getDynamicTemplateGroup=function(J){if(!this._idToTemplateGroup.has(J))return A;
n(J)||B.error("mapview-template-store",`Id ${J} does not refer to a dynamic template`);return this._idToTemplateGroup.get(J)};K.getMosaicItem=function(J,I){const H=this._createTemplateId(),M=new Promise(N=>this._idToResolver.set(H,N));this._fetchQueue.push({symbol:J,id:H,glyphIds:I});return M};K.finalize=function(J){return this._fetchQueue.length||this._lock.isHeld()?b.withLock(this._lock,this._fetchAllQueuedResources.bind(this),J):Promise.resolve()};K._initErrorTemplates=function(){this._errorTemplates||
(this._errorTemplates={fill:this._createMeshTemplates([],D,!1),marker:this._createMeshTemplates([],w,!1),line:this._createMeshTemplates([],y,!1)})};K._fetchAllQueuedResources=function(J){if(!this._fetchQueue.length)return Promise.resolve();const I=this._fetchQueue,H=this._cimAnalyses;this._fetchQueue=[];this._cimAnalyses=[];return Promise.all(H).then(()=>this._fetchResource(I,J).then(M=>{for(const {id:N,mosaicItem:P}of M)this._idToResolver.get(N)(P),this._idToResolver.delete(N)})).catch(M=>{v.isAbortError(M)?
this._fetchQueue=this._fetchQueue.concat(I):"worker:port-closed"!==M.name&&B.error(new E("mapview-template-store","Unable to fetch requested texture resources",M))})};K._createGroupId=function(J){return this._idCounter++<<1|(J?1:0)};K._createTemplateId=function(){return this._templateIdCounter++};K._createSMS=function(){var J=u._asyncToGenerator(function*(I){const {spriteMosaicItem:H}=yield this.getMosaicItem(I);return h.ok(H,B)?c.fromSimpleMarker(I,H):this._markerError});return function(I){return J.apply(this,
arguments)}}();K._createPMS=function(){var J=u._asyncToGenerator(function*(I){const {spriteMosaicItem:H}=yield this.getMosaicItem(I);return h.ok(H,B)?c.fromPictureMarker(I,H):this._markerError});return function(I){return J.apply(this,arguments)}}();K._createSFS=function(){var J=u._asyncToGenerator(function*(I,H){const {spriteMosaicItem:M}=yield this.getMosaicItem(I);return h.ok(M,B)?t.fromSimpleFill(I,M,H):this._fillError});return function(I,H){return J.apply(this,arguments)}}();K._createPFS=function(){var J=
u._asyncToGenerator(function*(I,H){const {spriteMosaicItem:M}=yield this.getMosaicItem(I);return h.ok(M,B)?t.fromPictureFill(I,M,H):this._fillError});return function(I,H){return J.apply(this,arguments)}}();K._createSLS=function(){var J=u._asyncToGenerator(function*(I,H){({spriteMosaicItem:H}=yield this.getMosaicItem(I));return h.ok(H,B)?e.fromSimpleLine(I,H):this._lineError});return function(I,H){return J.apply(this,arguments)}}();K._createLMS=function(){var J=u._asyncToGenerator(function*(I){const {spriteMosaicItem:H}=
yield this.getMosaicItem(I);return h.ok(H,B)?c.fromLineSymbolMarker(I,H):this._markerError});return function(I){return J.apply(this,arguments)}}();K._createTS=function(){var J=u._asyncToGenerator(function*(I){const {glyphMosaicItems:H}=yield this.getMosaicItem(I);return a.fromText(I,H)});return function(I){return J.apply(this,arguments)}}();K._createCIMText=function(){var J=u._asyncToGenerator(function*(I){const {glyphMosaicItems:H}=yield this.getMosaicItem(d.cimLayerToRasterizationInfo(I),l.codepoints(I.text));
return h.ok(H,B)?a.fromCIMText(I,H,this._tileInfo):this._textError});return function(I){return J.apply(this,arguments)}}();K._createCIMFill=function(){var J=u._asyncToGenerator(function*(I){const {spriteMosaicItem:H}=yield this.getMosaicItem(d.cimLayerToRasterizationInfo(I));return h.ok(H,B)?t.fromCIMFill(I,H,this._tileInfo):this._fillError});return function(I){return J.apply(this,arguments)}}();K._createCIMLine=function(){var J=u._asyncToGenerator(function*(I){const {spriteMosaicItem:H}=yield this.getMosaicItem(d.cimLayerToRasterizationInfo(I));
return h.ok(H,B)?e.fromCIMLine(I,H,this._tileInfo):this._lineError});return function(I){return J.apply(this,arguments)}}();K._createCIMMarker=function(){var J=u._asyncToGenerator(function*(I){const {spriteMosaicItem:H}=yield this.getMosaicItem(d.cimLayerToRasterizationInfo(I));return h.ok(H,B)?c.fromCIMMarker(I,H,this._tileInfo):this._markerError});return function(I){return J.apply(this,arguments)}}();K._createCIM=function(){var J=u._asyncToGenerator(function*(I){const H=I.templateHash;if(this._cimTemplateCache.has(H))return this._cimTemplateCache.get(H);
let M;switch(I.type){case "marker":M=yield this._createCIMMarker(I);break;case "line":M=yield this._createCIMLine(I);break;case "fill":M=yield this._createCIMFill(I);break;case "text":M=yield this._createCIMText(I)}this._cimTemplateCache.set(H,M);return M});return function(I){return J.apply(this,arguments)}}();K._createDynamicCIM=function(){var J=u._asyncToGenerator(function*(I){const H=I.templateHash;if(this._cimTemplateCache.has(H))return this._cimTemplateCache.get(H);let M;switch(I.type){case "marker":M=
m.fromCIMMarker(I,this._tileInfo);break;case "line":M=g.fromCIMLine(I,this._tileInfo);break;case "fill":M=k.fromCIMFill(I,this._tileInfo);break;case "text":M=p.fromCIMText(I,this._tileInfo)}this._cimTemplateCache.set(H,M);return M});return function(I){return J.apply(this,arguments)}}();K._createPrimitiveMeshTemplates=function(J,I,H){switch(I.type){case "esriSMS":return q(J,this._createSMS(I));case "esriPMS":return q(J,this._createPMS(I));case "esriSFS":return q(J,this._createSFS(I,H));case "line-marker":return q(J,
this._createLMS(I));case "esriPFS":return q(J,this._createPFS(I,H));case "esriSLS":return q(J,this._createSLS(I,!1));case "esriTS":return q(J,this._createTS(I));default:return B.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),J}};K._createMeshTemplates=function(J,I,H){if(I.type.includes("3d"))return B.error("3D symbols are not supported with MapView"),J;if("expanded-cim"===I.type){for(const M of I.layers)"function"===typeof M.materialHash?q(J,this._createDynamicCIM(M)):
q(J,this._createCIM(M));return J}if("composite-symbol"===I.type){for(const M of I.layers)this._createPrimitiveMeshTemplates(J,M,H);return J}return"cim"===I.type||"label"===I.type||"web-style"===I.type?J:this._createPrimitiveMeshTemplates(J,I,H)};u._createClass(G,[{key:"_markerError",get:function(){return this._errorTemplates.marker[0]}},{key:"_fillError",get:function(){return this._errorTemplates.fill[0]}},{key:"_lineError",get:function(){return this._errorTemplates.line[0]}},{key:"_textError",get:function(){return this._errorTemplates.line[0]}}]);
return G}();const F=G=>{if(!G.layers)return!1;for(const K of G.layers)if("function"===typeof K.materialHash)return!0;return!1};r.WGLTemplateStore=z;r.errorPointSchema2D=w;r.errorPolygonSchema2D=D;r.errorPolylineSchema2D=y;r.isDynamicId=n;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p){return function(t){function e(c,a,b){var h;var l=t.call(this,c)||this;l._minMaxZoom=x.i1616to32(Math.round(a*v.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(b*v.MIN_MAX_ZOOM_PRECISION_FACTOR));k.isFunction(c.color)?l._dynamicPropertyMap.set("fillColor",(w,y,D)=>(w=c.color(w,y,D))&&C.premultiplyAlphaRGBA(w)||0):(a=c.color,l.fillColor=a&&C.premultiplyAlphaRGBA(a)||0);const d="CIMMarkerPlacementInsidePolygon"===(null==(h=c.cim.placement)?void 0:h.type)&&c.cim.placement.shiftOddRows?
2:1,q=c.height;k.isFunction(q)?l._dynamicPropertyMap.set("_height",(w,y,D)=>q(w,y,D)*d):l._height=(q||0)*d;const n=c.offsetX;k.isFunction(n)?l._dynamicPropertyMap.set("_offsetX",(w,y,D)=>E.pt2px(n(w,y,D))):l._offsetX=E.pt2px(n||0);const B=c.offsetY;k.isFunction(B)?l._dynamicPropertyMap.set("_offsetY",(w,y,D)=>E.pt2px(-B(w,y,D))):l._offsetY=E.pt2px(-B||0);h=c.scaleX;k.isFunction(h)?l._dynamicPropertyMap.set("_scaleX",h):l._scaleX=h||1;const A=c.angle;k.isFunction(A)?l._dynamicPropertyMap.set("_angle",
(w,y,D)=>z.radToByte(A(w,y,D))):l._angle=z.radToByte(A)||0;u.isSome(c.effects)&&(h=c.effects,k.isFunction(h)?l._dynamicPropertyMap.set("_effects",h):l._effects=h);l._cimFillLayer=c;l._bitset=(c.colorLocked?v.BITSET_GENERIC_LOCK_COLOR:0)|(c.applyRandomOffset?v.BITSET_FILL_RANDOM_PATTERN_OFFSET:0)|(c.sampleAlphaOnly?v.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);l._fillMaterialKey=f.FillMaterialKey.load(c.materialKey);return l}r._inheritsLoose(e,t);e.fromCIMFill=function(c,a){const [b,h]=k.getMinMaxZoom(c.scaleInfo,
a);return new e(c,b,h)};e.prototype.bindFeature=function(c,a,b){const h=c.readLegacyFeature();this._dynamicPropertyMap.forEach((q,n)=>{this[n]=q(h,a,b)});c=this._fillMaterialKey;var l=this._materialCache,d=this._cimFillLayer.materialHash;d=d(h,a,b);d=l.get(d);l=null;d&&p.ok(d.spriteMosaicItem)&&(l=d.spriteMosaicItem);if(l){const {rect:q,width:n,height:B}=l;d=q.x+v.SPRITE_PADDING;const A=q.y+v.SPRITE_PADDING,w=d+n,y=A+B;let D=Math.round(E.pt2px(this._height));0>=D&&(D=y-A);let F=Math.round(E.pt2px(this._height/
B*n||0));0>=F&&(F=w-d);const G=this._scaleX;this.tl=x.i1616to32(d,A);this.br=x.i1616to32(w,y);this.aux2_1=x.i1616to32(F,D);this.aux2_2=x.i1616to32(this._offsetX,this._offsetY);this.aux3=x.i8888to32(G,1,this._angle,0);c.sdf=l.sdf;c.pattern=!0;c.textureBinding=l.textureBinding}else this.aux3=this.aux2_2=this.aux2_1=this.br=this.tl=0,c.sdf=!1,c.pattern=!1,c.textureBinding=0;this._materialKey=c.data};return e}(g(m))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../layers/graphics/featureConversionUtils ../../enums ../../number ../../Utils ../../materialKey/MaterialKey ./templateUtils ./WGLLineTemplate".split(" "),
function(r,u,E,C,v,z,x,f,k){return g=>function(m){function p(...e){e=m.call(this,...e)||this;e.forceLibtess=!1;e._bitset=0;e._lineTemplate=null;e.geometryType=C.WGLGeometryType.FILL;return e}r._inheritsLoose(p,m);var t=p.prototype;t._maybeAddLineTemplate=function(e){this._lineTemplate=k.fromFillOutline(e)};t._write=function(e,c,a,b){a="esriGeometryPoint"===c.geometryType;const h=x.FillMaterialKey.load(this._materialKey);e.recordStart(c.getDisplayId(),this._materialKey,this.geometryType,a);this._writeGeometry(e,
c,h,b,a);x.hasOutlineFillSymbology(h)&&u.isSome(this._lineTemplate)&&this._lineTemplate.writeGeometry(e,c,b,a);e.recordEnd()};t._writeGeometry=function(e,c,a,b,h){b=this._getGeometry(c,b,h);u.isNone(b)||(h=[],100<b.maxLength||this.forceLibtess||!f.triangulate(h,b)?(b=f.triangulateLibtess(b),this._writeVertices(e,c,b,[b.length/2],a)):h.length&&this._writeVertices(e,c,b.coords,b.lengths,a,h))};t._writeVertex=function(e,c,a,b,h,l){const d=v.i1616to32(1*b,1*h);e.vertexBounds(b,h,0,0);e.vertexWrite(d);
e.vertexWrite(c);a.symbologyType===C.WGLSymbologyType.DOT_DENSITY?e.vertexWriteF32(1/Math.abs(l.readGeometryArea())):(e.vertexWrite(this.fillColor),c=x.hasSimpleSymbology(a),c||(e.vertexWrite(this.tl),e.vertexWrite(this.br)),e.vertexWrite(this.aux2_1),e.vertexWrite(this.aux2_2),e.vertexWrite(this.aux3),c||e.vertexWrite(this._minMaxZoom))};t._writeVertices=function(e,c,a,b,h,l){var d=c.getDisplayId();d|=this._bitset<<24;var q=b.reduce((B,A)=>B+A);const n=z.getStrides(h.geometryType,h.symbologyType).geometry/
4;b=e.vertexCount();e.vertexEnsureSize(n*q);q=0;if(l)for(const B of l)this._writeVertex(e,d,h,a[2*B],a[2*B+1],c),q++;else for(l=0;l<a.length;l+=2)this._writeVertex(e,d,h,Math.round(a[l]),Math.round(a[l+1]),c),q++;e.indexEnsureSize(q);for(c=0;c<q;c++)e.indexWrite(c+b)};t._getGeometry=function(e,c,a){return(e=c?E.deltaDecodeGeometry(E.convertFromGeometry(c),2):e.readGeometryForDisplay())?f.clipMarshall(e,a?256:8):null};return p}(g)})},"esri/views/2d/engine/webgl/mesh/templates/templateUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../chunks/earcut ../../../../../../geometry/libtess ../../../../../../layers/graphics/OptimizedGeometry ../../definitions ../../Geometry ../../TileClipper ../bufcut".split(" "),
function(r,u,E,C,v,z,x,f,k){function g(e,c,a){let b=0;for(let h=1;h<a;h++)b+=(e[2*(c+h)]-e[2*(c+h-1)])*(e[2*(c+h)+1]+e[2*(c+h-1)+1]);return b}function m(e,c,a,b,h){let l=0;for(;a<b;a+=3){const d=2*(e[a]-h),q=2*(e[a+1]-h),n=2*(e[a+2]-h);l+=Math.abs((c[d]-c[n])*(c[q+1]-c[d+1])-(c[d]-c[q])*(c[n+1]-c[d+1]))}return l}const p=new f.TileClipper(0,0,0,1,0),t=new f.TileClipper(0,0,0,1,0);p.setExtent(z.TILE_SIZE);t.setExtent(z.TILE_SIZE);r.area=g;r.clipLinesMarshall=function(e,c){t.setPixelMargin(c);const a=
-c;c=z.TILE_SIZE+c;let b=[];var h=!1;let l=0;for(;l<e.length;){const d=[],q=e[l];if(!q)return null;t.reset(x.GeometryType.LineString);let [n,B]=q[0];if(h)t.moveTo(n,B);else{if(n<a||n>c||B<a||B>c){h=!0;continue}d.push({x:n,y:B})}let A=!1;const w=q.length;for(let y=1;y<w;++y)if(n+=q[y][0],B+=q[y][1],h)t.lineTo(n,B);else{if(n<a||n>c||B<a||B>c){A=!0;break}d.push({x:n,y:B})}if(A)h=!0;else{if(h){if(h=t.resultWithStarts())for(const y of h)b.push(y)}else b.push({line:d,start:0});l++;h=!1}}b=b.filter(d=>1<
d.line.length);return 0===b.length?null:b};r.clipMarshall=function(e,c){if(u.isNone(e))return null;a:{var a=z.TILE_SIZE+128;var b=0;for(var h=0;h<e.lengths.length;h++){var l=e.lengths[h];for(var d=0;d<l;d++){const q=e.coords[2*(d+b)],n=e.coords[2*(d+b)+1];if(-128>q||q>a||-128>n||n>a){a=!0;break a}}b+=l}a=!1}if(!a)return e;p.setPixelMargin(c);p.reset(x.GeometryType.Polygon);c=0;for(a=0;a<e.lengths.length;a++){b=e.lengths[a];h=e.coords[2*(0+c)];l=e.coords[2*(0+c)+1];p.moveTo(h,l);for(d=1;d<b;d++)h=
e.coords[2*(d+c)],l=e.coords[2*(d+c)+1],p.lineTo(h,l);p.close();c+=b}a=p.result(!1);if(!a)return null;e=[];c=[];for(const q of a){a=0;for(const n of q)c.push(n.x),c.push(n.y),a++;e.push(a)}return new v(e,c)};r.triangleArea=function(e,c,a,b,h){let l=0;for(;a<b;a+=3){const d=2*(e.getValue(a)-h),q=2*(e.getValue(a+1)-h),n=2*(e.getValue(a+2)-h);l+=Math.abs((c[d]-c[n])*(c[q+1]-c[d+1])-(c[d]-c[q])*(c[n+1]-c[d+1]))}return l};r.triangleAreaArray=m;r.triangulate=function(e,c){const {coords:a,lengths:b,hasIndeterminateRingOrder:h}=
c;if(h)return!1;c=0;for(var l=0;l<b.length;){let n=l,B=b[l];l=g(a,c,B);for(var d=[];++n<b.length;){var q=b[n];const A=g(a,c+B,q);if(!(0<A))break;l+=A;d.push(c+B);B+=q}q=e.length;k.bufcut(e,a,c,c+B,d,2,0);d=m(e,a,q,e.length,0);l=Math.abs(l);if(1E-5<Math.abs((d-l)/Math.max(1E-7,l)))return e.length=0,!1;l=n;c+=B}return!0};r.triangulateEarcut=function(e,c,a){const {coords:b,lengths:h,hasIndeterminateRingOrder:l}=c;if(l)return!1;let d=0;for(var q=0;q<h.length;){let B=q,A=h[q];for(q=[];++B<h.length;){var n=
h[B];if(!(0<g(b,d+A,n)))break;q.push(d+A-d);A+=n}n=c.coords.slice(2*d,2*(d+A));q=E.earcut(n,q,2);for(const w of q)e.push(w+a+d);q=B;d+=A}return!0};r.triangulateLibtess=function(e){const {coords:c,lengths:a}=e;({buffer:e}=C.triangulate(c,a));return e};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/bufcut":function(){define(["exports"],function(r){function u(n,B,A,w,y,D,F){let G;A=0;for(let K=w,J=y-D;K<y;K+=D)A+=(n[J+B*D]-
n[K+B*D])*(n[K+1+B*D]+n[J+1+B*D]),J=K;if(F===0<A)for(;w<y;w+=D)G=z(w+B*D,n[w+B*D],n[w+1+B*D],G);else for(y-=D;y>=w;y-=D)G=z(y+B*D,n[y+B*D],n[y+1+B*D],G);G&&a(G,G.next)&&(x(G),G=G.next);return G}function E(n,B=n){if(!n)return n;let A;do if(A=!1,n.steiner||!a(n,n.next)&&0!==m(n.prev,n,n.next))n=n.next;else{x(n);n=B=n.prev;if(n===n.next)break;A=!0}while(A||n!==B);return B}function C(n,B,A,w,y,D,F,G){if(n){!G&&D&&(n=g(n,w,y,D));for(var K=n;n.prev!==n.next;){var J=n.prev,I=n.next;if(D)var H=v(n,w,y,D);
else a:{H=n;var M=H.prev,N=H;const P=H.next;if(0<=m(M,N,P)){H=!1;break a}let ba=H.next.next;const X=ba;let S=0;for(;ba!==H.prev&&(0===S||ba!==X);){S++;if(t(M.x,M.y,N.x,N.y,P.x,P.y,ba.x,ba.y)&&0<=m(ba.prev,ba,ba.next)){H=!1;break a}ba=ba.next}H=!0}if(H)B.push(J.index/A+F),B.push(n.index/A+F),B.push(I.index/A+F),x(n),K=n=I.next;else if(n=I,n===K){if(!G)C(E(n),B,A,w,y,D,F,1);else if(1===G){G=B;K=A;J=F;I=n;do H=I.prev,M=I.next.next,!a(H,M)&&p(H,I,I.next,M)&&e(H,M)&&e(M,H)&&(G.push(H.index/K+J),G.push(I.index/
K+J),G.push(M.index/K+J),x(I),x(I.next),I=n=M),I=I.next;while(I!==n);n=I;C(n,B,A,w,y,D,F,2)}else if(2===G)a:{G=n;do{for(K=G.next.next;K!==G.prev;){if(J=G.index!==K.index){H=H=H=void 0;J=G;I=K;if(H=J.next.index!==I.index&&J.prev.index!==I.index){b:{H=J;do{if(H.index!==J.index&&H.next.index!==J.index&&H.index!==I.index&&H.next.index!==I.index&&p(H,H.next,J,I)){H=!0;break b}H=H.next}while(H!==J);H=!1}H=!H}if(H=H&&e(J,I)&&e(I,J)){H=J;M=!1;N=(J.x+I.x)/2;I=(J.y+I.y)/2;do H.y>I!==H.next.y>I&&H.next.y!==
H.y&&N<(H.next.x-H.x)*(I-H.y)/(H.next.y-H.y)+H.x&&(M=!M),H=H.next;while(H!==J);H=M}J=H}if(J){n=h(G,K);G=E(G,G.next);n=E(n,n.next);C(G,B,A,w,y,D,F,0);C(n,B,A,w,y,D,F,0);break a}K=K.next}G=G.next}while(G!==n)}break}}}}function v(n,B,A,w){const y=n.prev,D=n.next;if(0<=m(y,n,D))return!1;const F=y.x>n.x?y.x>D.x?y.x:D.x:n.x>D.x?n.x:D.x,G=y.y>n.y?y.y>D.y?y.y:D.y:n.y>D.y?n.y:D.y,K=c(y.x<n.x?y.x<D.x?y.x:D.x:n.x<D.x?n.x:D.x,y.y<n.y?y.y<D.y?y.y:D.y:n.y<D.y?n.y:D.y,B,A,w);B=c(F,G,B,A,w);A=n.prevZ;for(w=n.nextZ;A&&
A.z>=K&&w&&w.z<=B;){if(A!==n.prev&&A!==n.next&&t(y.x,y.y,n.x,n.y,D.x,D.y,A.x,A.y)&&0<=m(A.prev,A,A.next))return!1;A=A.prevZ;if(w!==n.prev&&w!==n.next&&t(y.x,y.y,n.x,n.y,D.x,D.y,w.x,w.y)&&0<=m(w.prev,w,w.next))return!1;w=w.nextZ}for(;A&&A.z>=K;){if(A!==n.prev&&A!==n.next&&t(y.x,y.y,n.x,n.y,D.x,D.y,A.x,A.y)&&0<=m(A.prev,A,A.next))return!1;A=A.prevZ}for(;w&&w.z<=B;){if(w!==n.prev&&w!==n.next&&t(y.x,y.y,n.x,n.y,D.x,D.y,w.x,w.y)&&0<=m(w.prev,w,w.next))return!1;w=w.nextZ}return!0}function z(n,B,A,w){n=
l.create(n,B,A);w?(n.next=w.next,n.prev=w,w.next.prev=n,w.next=n):(n.prev=n,n.next=n);return n}function x(n){n.next.prev=n.prev;n.prev.next=n.next;n.prevZ&&(n.prevZ.nextZ=n.nextZ);n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function f(n){let B=n,A=n;do{if(B.x<A.x||B.x===A.x&&B.y<A.y)A=B;B=B.next}while(B!==n);return A}function k(n,B){let A=B;const w=n.x,y=n.y;let D=-Infinity,F;do{if(y<=A.y&&y>=A.next.y&&A.next.y!==A.y){var G=A.x+(y-A.y)*(A.next.x-A.x)/(A.next.y-A.y);if(G<=w&&G>D){D=G;if(G===w){if(y===A.y)return A;
if(y===A.next.y)return A.next}F=A.x<A.next.x?A:A.next}}A=A.next}while(A!==B);if(!F)return null;if(w===D)return F.prev;B=F;G=F.x;const K=F.y;let J=Infinity,I;for(A=F.next;A!==B;)w>=A.x&&A.x>=G&&w!==A.x&&t(y<K?w:D,y,G,K,y<K?D:w,y,A.x,A.y)&&(I=Math.abs(y-A.y)/(w-A.x),(I<J||I===J&&A.x>F.x)&&e(A,n)&&(F=A,J=I)),A=A.next;return F}function g(n,B,A,w){for(var y;y!==n;y=y.next){y=y||n;null===y.z&&(y.z=c(y.x,y.y,B,A,w));if(y.prev.next!==y||y.next.prev!==y)return y.prev.next=y,y.next.prev=y,g(n,B,A,w);y.prevZ=
y.prev;y.nextZ=y.next}n.prevZ.nextZ=null;n.prevZ=null;a:for(A=1;;){w=n;B=n=null;let D=0;for(;w;){D++;y=w;let F=0;for(;F<A&&y;F++)y=y.nextZ;let G=A;for(;0<F||0<G&&y;){let K;0===F?(K=y,y=y.nextZ,G--):0!==G&&y?w.z<=y.z?(K=w,w=w.nextZ,F--):(K=y,y=y.nextZ,G--):(K=w,w=w.nextZ,F--);B?B.nextZ=K:n=K;K.prevZ=B;B=K}w=y}B.nextZ=null;A*=2;if(2>D)break a}return n}function m(n,B,A){return(B.y-n.y)*(A.x-B.x)-(B.x-n.x)*(A.y-B.y)}function p(n,B,A,w){return a(n,B)&&a(A,w)||a(n,w)&&a(A,B)?!0:0<m(n,B,A)!==0<m(n,B,w)&&
0<m(A,w,n)!==0<m(A,w,B)}function t(n,B,A,w,y,D,F,G){return 0<=(y-F)*(B-G)-(n-F)*(D-G)&&0<=(n-F)*(w-G)-(A-F)*(B-G)&&0<=(A-F)*(D-G)-(y-F)*(w-G)}function e(n,B){return 0>m(n.prev,n,n.next)?0<=m(n,B,n.next)&&0<=m(n,n.prev,B):0>m(n,B,n.prev)||0>m(n,n.next,B)}function c(n,B,A,w,y){n=32767*(n-A)*y;B=32767*(B-w)*y;n=(n|n<<8)&16711935;n=(n|n<<4)&252645135;n=(n|n<<2)&858993459;B=(B|B<<8)&16711935;B=(B|B<<4)&252645135;B=(B|B<<2)&858993459;return(n|n<<1)&1431655765|((B|B<<1)&1431655765)<<1}function a(n,B){return n.x===
B.x&&n.y===B.y}function b(n,B){return n.x-B.x}function h(n,B){const A=l.create(n.index,n.x,n.y),w=l.create(B.index,B.x,B.y),y=n.next,D=B.prev;n.next=B;B.prev=n;A.next=y;y.prev=A;w.next=A;A.prev=w;D.next=w;w.prev=D;return w}let l=function(){function n(){this.y=this.x=this.index=0;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}n.create=function(B,A,w){const y=q<d.length?d[q++]:new n;y.index=B;y.x=A;y.y=w;y.prev=null;y.next=null;y.z=null;y.prevZ=null;y.nextZ=null;y.steiner=!1;
return y};return n}();const d=[];let q=0;for(let n=0;8096>n;n++)d.push(new l);r.bufcut=function(n,B,A,w,y,D,F){q=0;var G=(w-A)*D,K=y&&y.length;const J=K?(y[0]-A)*D:G;var I=u(B,A,w,0,J,D,!0);if(I&&I.next!==I.prev){var H;if(K){K=[];for(let ba=0,X=y.length;ba<X;ba++){const S=u(B,A,w,y[ba]*D,ba<X-1?y[ba+1]*D:w*D,D,!1);S===S.next&&(S.steiner=!0);K.push(f(S))}K.sort(b);for(var M of K){w=M;y=I;if(y=k(w,y))w=h(y,w),E(w,w.next);I=E(I,I.next)}}if(G>80*D){var N=G=B[A*D];var P=H=B[1+A*D];for(M=D;M<J;M+=D)w=B[M+
A*D],y=B[M+1+A*D],N=Math.min(N,w),P=Math.min(P,y),G=Math.max(G,w),H=Math.max(H,y);H=Math.max(G-N,H-P);H=0!==H?1/H:0}C(I,n,D,N,P,H,F,0)}};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Logger ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../Utils ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLMeshTemplate".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p){const t=u.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate");return function(e){function c(a,b,h,l,d,q,n,B,A,w,y,D,F,G,K,J,I,H,M,N){var P=e.call(this)||this;a=k.LineMaterialKey.load(a);b&&(a.sdf=b.sdf,a.pattern=!0,a.textureBinding=b.textureBinding);P._capType=l;P._joinType=d;P._miterLimitCosine=g.getLimitCosine(q);P.tessellationProperties._fillColor=n;P.tessellationProperties._tl=B;P.tessellationProperties._br=A;P._hasPattern=w;P._isDashed=y;P._zOrder=I;P._effects=
H;P._minMaxZoom=x.i1616to32(Math.round(M*z.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(N*z.MIN_MAX_ZOOM_PRECISION_FACTOR));P._materialKey=a.data;P.tessellationProperties._bitset=(F?z.BITSET_GENERIC_LOCK_COLOR:0)|(G?z.BITSET_TYPE_FILL_OUTLINE:0)|(D?z.BITSET_LINE_SCALE_DASH:0)|(K?z.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);P.tessellationProperties._halfWidth=.5*h;P.tessellationProperties._halfReferenceWidth=.5*J;P.tessellationProperties.offset=0;P._initializeTessellator(!1);return P}r._inheritsLoose(c,e);
c.fromCIMLine=function(a,b,h){var l=a.color,d=a.scaleFactor||1;const q=!!a.dashTemplate;let n=a.cap;q&&n===C.CapType.ROUND&&(n=C.CapType.SQUARE);const B=a.join;d*=E.pt2px(a.width);const A=E.pt2px(a.referenceWidth),w=E.pt2px(a.miterLimit);l=l&&v.premultiplyAlphaRGBA(l)||0;const [y,D]=g.getMinMaxZoom(a.scaleInfo,h);if(!b)return new c(a.materialKey,b,d,n,B,w,l,0,0,!1,q,a.scaleDash,a.colorLocked,!1,a.sampleAlphaOnly,A,a.zOrder,a.effects,y,D);const {rect:F,width:G,height:K}=b;var J=F.x+z.SPRITE_PADDING;
const I=F.y+z.SPRITE_PADDING;h=J+G;const H=I+K;J=x.i1616to32(J,I);h=x.i1616to32(h,H);return new c(a.materialKey,b,d,n,B,w,l,J,h,!0,q,a.scaleDash,a.colorLocked,!1,a.sampleAlphaOnly,A,a.zOrder,a.effects,y,D)};c.fromFillOutline=function(a){var b;const h=k.FillMaterialKey.load(a.materialKey);return k.hasOutlineFillSymbology(h)&&a.outline&&"esriSLSSolid"===(null==(b=a.outline)?void 0:b.style)?c.fromSimpleLine({hash:"",materialKey:a.materialKey,...a.outline},null,!0):null};c.fromSimpleLine=function(a,b,
h=!1){var {color:l}=a;const d="esriSLSSolid"!==a.style&&"esriSLSNull"!==a.style,q=f.getCapType(a.cap||"round"),n=f.getJoinType(a.join||"round");l=l&&"esriSLSNull"!==a.style&&v.premultiplyAlphaRGBAArray(l)||0;"esriSLSNull"===a.style&&(l=0);const B=E.pt2px(a.width),A=a.miterLimit;if(!b)return new c(a.materialKey,b,B,q,n,A,l,0,0,!1,d,!0,!1,h,!1,B,0,null,g.DEFAULT_MIN_ZOOM,g.DEFAULT_MAX_ZOOM);const {rect:w,width:y,height:D}=b;var F=w.x+z.SPRITE_PADDING;const G=w.y+z.SPRITE_PADDING;var K=F+y;const J=G+
D;F=x.i1616to32(F,G);K=x.i1616to32(K,J);return new c(a.materialKey,b,B,q,n,A,l,F,K,!0,d,!0,!1,h,!1,B,0,null,g.DEFAULT_MIN_ZOOM,g.DEFAULT_MAX_ZOOM)};c.fromPictureLineSymbol=function(a,b,h,l){t.error("PictureLineSymbol support does not exist!");return null};return c}(m(p))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../definitions ../../enums ../../number ../../TurboLine ../../materialKey/MaterialKey ./templateUtils".split(" "),
function(r,u,E,C,v,z,x,f){const k=(p,t,e)=>(c,a,b,h,l,d,q,n,B,A,w)=>{b=v.i1616to32(w,Math.ceil(16*p._halfWidth));q=v.i8888to32(Math.round(16*q),Math.round(16*n),Math.round(16*B),Math.round(16*A));l=v.i8888to32(16*l,16*d,0,p._bitset);d=p.out;d.vertexBounds(c,a,t,e);d.vertexWrite(v.i1616to32(8*c,8*a));d.vertexWrite(p.id);d.vertexWrite(p._fillColor);d.vertexWrite(q);d.vertexWrite(b);d.vertexWrite(p._tl);d.vertexWrite(p._br);d.vertexWrite(l);d.vertexWrite(v.i1616to32(Math.ceil(16*p._halfReferenceWidth),
0));d.vertexWrite(p.minMaxZoom);d.vertexEnd();return p.offset+p.vertexCount++},g=(p,t,e)=>(c,a,b,h,l,d,q,n,B,A,w)=>{b=v.i1616to32(16*p._halfWidth,16*p._halfReferenceWidth);q=v.i8888to32(16*q+128,16*n+128,16*B+128,16*A+128);n=p.out;B=p._bitset<<24|p.id;n.vertexBounds(c,a,t,e);n.vertexWrite(v.i1616to32(8*c,8*a));n.vertexWrite(B);n.vertexWrite(p._fillColor);c=x.hasSimpleSymbology(p.key);c||(n.vertexWrite(0),n.vertexWrite(0));n.vertexWrite(0);n.vertexWrite(b);n.vertexWrite(q);c||n.vertexWrite(p.minMaxZoom);
n.vertexEnd();return p.offset+p.vertexCount++},m=p=>(t,e,c)=>{const a=p.out;a.indexWrite(t);a.indexWrite(e);a.indexWrite(c);p.indexCount+=3};return p=>function(t){function e(...a){a=t.call(this,...a)||this;a.tessellationProperties={};a._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0};a.geometryType=C.WGLGeometryType.LINE;return a}r._inheritsLoose(e,t);var c=e.prototype;c.writeGeometry=function(a,b,h,l){this._writeGeometry(a,b,h,l)};c._initializeTessellator=function(a){var b=x.LineMaterialKey.load(this._materialKey),
h=x.FillMaterialKey.load(this._materialKey),l=this._tessellationOptions;b=b.vvSizeFieldStops||b.vvSizeMinMaxValue||b.vvSizeScaleStops||b.vvSizeUnitValue;a=this.tessellationProperties._halfWidth<E.THIN_LINE_HALF_WIDTH_THRESHOLD&&!a&&!b;this.tessellationProperties.minMaxZoom=this._minMaxZoom;l.wrapDistance=65535;l.textured=this._isDashed||this._hasPattern;l.offset=this.tessellationProperties.offset;l.halfWidth=this.tessellationProperties._halfWidth;l=a?0:1;h=x.hasOutlineFillSymbology(h)?g:k;this._lineTessellator=
new z.LineTessellation(h(this.tessellationProperties,l,l),m(this.tessellationProperties),a)};c._write=function(a,b,h,l){h="esriGeometryPoint"===b.geometryType;a.recordStart(b.getDisplayId(),this._materialKey,this.geometryType,h);this._writeGeometry(a,b,l,h);a.recordEnd()};c._writeGeometry=function(a,b,h,l){h=null!=h?h:b.readLegacyGeometryForDisplay();l=this._getLines(h,l);u.isNone(l)||this._writeVertices(a,b,l)};c._getLines=function(a,b){if(u.isNone(a))return null;a=a.paths||a.rings;return u.isNone(a)?
null:f.clipLinesMarshall(a,b?256:16)};c._writeVertices=function(a,b,h){const l=b.getDisplayId(),d=a.vertexCount(),q=this.tessellationProperties;b=this._tessellationOptions;q.out=a;q.id=l;q.indexCount=0;q.vertexCount=0;q.offset=d;b.capType=this._capType;b.joinType=this._joinType;a=x.FillMaterialKey.load(this._materialKey);this.tessellationProperties.key=x.hasOutlineFillSymbology(a)?a:x.LineMaterialKey.load(this._materialKey);for(const {line:n,start:B}of h)b.initialDistance=B%65535,this._lineTessellator.tessellate(n,
b)};return e}(p)})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/Logger","../../../../../../symbols/cim/cimAnalyzer","../../../../../../symbols/cim/utils","./WGLMeshTemplate"],function(r,u,E,C,v){const z=u.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");return function(x){function f(k){var g=x.call(this)||this;g._ongoingMaterialRequestMap=new Map;g._materialCache=new Map;
g._dynamicPropertyMap=new Map;g._cimLayer=k;return g}r._inheritsLoose(f,x);f.prototype.analyze=function(k,g,m,p,t){if(t&&0===t.length)return null;const e=t&&0<t.length,c=g.readLegacyFeature();g=g.getObjectId();const a=this._materialCache;var b=this._cimLayer.materialHash;if(!b)return z.error("A Dynamic mesh template must have a material hash value or function!"),Promise.reject(null);const h="function"===typeof b?b(c,m,p,g):b;if(a.has(h))return k=a.get(h),Promise.resolve(k);if(b=this._ongoingMaterialRequestMap.get(h))return b;
b=this._cimLayer;const l=E.analyzeCIMResource(b.cim,this._cimLayer.materialOverrides);l.mosaicHash=h;const {type:d,url:q}=b;g={cim:l,type:d,mosaicHash:h,url:q,size:null,dashTemplate:null,text:null,fontName:null,objectId:g,animatedSymbolProperties:null};switch(d){case "marker":g.size=C.evaluateValueOrFunction(b.size,c,m,p);g.animatedSymbolProperties=C.evaluateValueOrFunction(b.animatedSymbolProperties,c,m,p);break;case "line":g.dashTemplate=b.dashTemplate;break;case "text":g.text=C.evaluateValueOrFunction(b.text,
c,m,p),g.fontName=C.evaluateValueOrFunction(b.fontName,c,m,p)}k=k.getMosaicItem(g,t).then(n=>{e||(this._ongoingMaterialRequestMap.delete(h),a.set(h,n));return n}).catch(n=>{this._ongoingMaterialRequestMap.delete(h);z.error(".analyze()",n.message);return null});e||this._ongoingMaterialRequestMap.set(h,k);return k};return f}(v)})},"esri/symbols/cim/cimAnalyzer":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../core/lang ../../core/Logger ../../core/maybe ../../core/screenUtils ../../core/string ../../support/arcadeOnDemand ./CIMSymbolHelper ./enums ./SDFHelper ./utils ./effects/CIMEffectHelper ../../views/2d/arcade/callExpressionWithFeature ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/fontUtils ../../views/2d/engine/webgl/grouping".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t,e,c,a,b,h){function l(Q){switch(Q){case "Butt":return m.CapType.BUTT;case "Square":return m.CapType.SQUARE;default:return m.CapType.ROUND}}function d(Q){switch(Q){case "Bevel":return m.JoinType.BEVEL;case "Miter":return m.JoinType.MITER;default:return m.JoinType.ROUND}}function q(Q){switch(Q){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return la.warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),
"center"}}function n(Q){switch(Q){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}}function B(Q){let da="",ea="";Q&&(Q=Q.toLowerCase(),Q.includes("italic")?da="italic":Q.includes("oblique")&&(da="oblique"),Q.includes("bold")?ea="bold":Q.includes("light")&&(ea="lighter"));return{style:da,weight:ea}}function A(Q,da,ea,ja){let ha;Q[da]?ha=Q[da]:(ha={},Q[da]=ha);ha[ea]=ja}function w(Q){return(Q=Q.markerPlacement)&&Q.angleToLine?m.Alignment.MAP:
m.Alignment.SCREEN}function y(){y=u._asyncToGenerator(function*(Q,da,ea,ja,ha){ja=null!=ja?ja:[];if(!Q)return ja;let Y;const ca={};if("CIMSymbolReference"===Q.type){if(Y=Q.symbol,Q=Q.primitiveOverrides){var ia=[];for(const ua of Q){var ra=ua.valueExpressionInfo;ra&&da?(ra=k.createRendererExpression(ra.expression,da.spatialReference,da.fields).then(za=>{za&&A(ca,ua.primitiveName,ua.propertyName,za)}),ia.push(ra)):null!=ua.value&&A(ca,ua.primitiveName,ua.propertyName,ua.value)}0<ia.length&&(yield Promise.all(ia))}}else return la.error("Expect cim type to be 'CIMSymbolReference'"),
ja;ia=[];L(Y,ea,ia);0<ia.length&&(yield Promise.all(ia));switch(Y.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":D(Y,Q,ca,da,ja,ea,ha)}return ja});return y.apply(this,arguments)}function D(Q,da,ea,ja,ha,Y,ca){if(Q){var ia=Q.symbolLayers;if(ia){var ra=Q.effects,ua=g.CIMSymbolHelper.getSize(Q);if("CIMPointSymbol"===Q.type&&"Map"===Q.angleAlignment)var za=m.Alignment.MAP;for(var Da=ia.length;Da--;){var ya=ia[Da];if(!ya||!1===ya.enable)continue;let Na;ra&&ra.length&&(Na=[...ra]);
var Ga=ya.effects;Ga&&Ga.length&&(ra?Na.push(...Ga):Na=[...Ga]);Ga=[];g.OverrideHelper.findEffectOverrides(Na,da,Ga);Ga=0<Ga.length?ka(Na,Ga,ea,ja):Na;var Ha=[];g.OverrideHelper.findApplicableOverrides(ya,da,Ha);switch(ya.type){case "CIMSolidFill":F(ya,Ga,ea,Ha,ja,ha);break;case "CIMPictureFill":G(ya,Ga,ea,Ha,ja,Y,ha);break;case "CIMHatchFill":K(ya,Ga,ea,Ha,ja,ha);break;case "CIMGradientFill":{var Fa=ea,Ea=ja,Ka=ha;const [Xa,db]=Ba(Ha,ya.primitiveName,Ga,null,null);var Ma=f.numericHash(JSON.stringify(ya)+
db).toString();Ka.push({type:"fill",templateHash:Ma,materialHash:Xa?wa(Ma,Fa,Ha,Ea):Ma,cim:ya,materialOverrides:null,colorLocked:ya.colorLocked,effects:Ga,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,applyRandomOffset:!1,sampleAlphaOnly:!1})}break;case "CIMSolidStroke":J(ya,Ga,ea,Ha,ja,ha,"CIMPolygonSymbol"===Q.type,ua);break;case "CIMPictureStroke":I(ya,Ga,ea,Ha,ja,ha,"CIMPolygonSymbol"===Q.type,ua);break;case "CIMGradientStroke":{Fa=ea;Ea=ja;Ka=ha;Ma="CIMPolygonSymbol"===
Q.type;var xa=ua,Qa=ya.primitiveName,Wa=void 0!==ya.width?ya.width:4,Ra=l(ya.capStyle),O=d(ya.joinStyle),Va=ya.miterLimit;const [Xa,db]=Ba(Ha,Qa,Ga,null,null),hb=f.numericHash(JSON.stringify(ya)+db).toString();Ka.push({type:"line",templateHash:hb,materialHash:Xa?wa(hb,Fa,Ha,Ea):hb,cim:ya,materialOverrides:null,isOutline:Ma,colorLocked:ya.colorLocked,effects:Ga,color:{r:128,g:128,b:128,a:1},width:R(Qa,Fa,"Width",Ea,Wa),cap:R(Qa,Fa,"CapStyle",Ea,Ra),join:R(Qa,Fa,"JoinStyle",Ea,O),miterLimit:R(Qa,Fa,
"MiterLimit",Ea,Va),referenceWidth:xa,zOrder:S(ya.name),dashTemplate:null,scaleDash:!1,sampleAlphaOnly:!1})}break;case "CIMCharacterMarker":H(ya,Ga,ea,Ha,ja,ha);break;case "CIMPictureMarker":if(H(ya,Ga,ea,Ha,ja,ha))break;"CIMLineSymbol"===Q.type&&(za=w(ya));M(ya,Ga,ea,Ha,ja,Y,ha,za,ua);break;case "CIMVectorMarker":if(H(ya,Ga,ea,Ha,ja,ha))break;"CIMLineSymbol"===Q.type&&(za=w(ya));Fa=ea;Ea=ja;Ka=ha;Ma=Y;xa=za;Qa=ua;Wa=ca;if(O=ya.markerGraphics){Ra=0;ya.scaleSymbolsProportionally&&(Va=ya.frame)&&(Ra=
Va.ymax-Va.ymin);Va=ta(ya.markerPlacement,Ha,Fa,Ea);for(const Xa of O)if(Xa&&(O=Xa.symbol))switch(O.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":P(ya,Ga,Va,null,Xa,Ha,Fa,Ea,Ka,Ma,xa,Qa,Ra,Wa);break;case "CIMTextSymbol":N(ya,Ga,Va,Xa,Fa,Ha,Ea,Ka,xa,Qa,Ra)}}break;default:la.error("Cannot analyze CIM layer",ya.type)}}}}}function F(Q,da,ea,ja,ha,Y){const ca=Q.primitiveName,ia=t.fromCIMColor(Q.color),[ra,ua]=Ba(ja,ca,da,null,null),za=f.numericHash(JSON.stringify(Q)+ua).toString();
Y.push({type:"fill",templateHash:za,materialHash:ra?()=>za:za,cim:Q,materialOverrides:null,colorLocked:Q.colorLocked,color:R(ca,ea,"Color",ha,ia,W),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:da,applyRandomOffset:!1,sampleAlphaOnly:!0})}function G(Q,da,ea,ja,ha,Y,ca){const ia=Q.primitiveName,ra=Q.tintColor?t.fromCIMColor(Q.tintColor):{r:255,g:255,b:255,a:1},[ua,za]=Ba(ja,ia,da,null,null);ja=f.numericHash(JSON.stringify(Q)+za).toString();const Da=f.numericHash(`${Q.url}${JSON.stringify(Q.colorSubstitutions)}`).toString();
let ya=t.getValue(Q.scaleX);if("width"in Q){const Ga=Q.width;let Ha=1;Y=Y.getResource(Q.url);z.isSome(Y)&&(Ha=Y.width/Y.height);ya/=Q.height/Ga*Ha}ca.push({type:"fill",templateHash:ja,materialHash:ua?()=>Da:Da,cim:Q,materialOverrides:null,colorLocked:Q.colorLocked,effects:da,color:R(ia,ea,"TintColor",ha,ra,W),height:R(ia,ea,"Height",ha,Q.height),scaleX:R(ia,ea,"ScaleX",ha,ya),angle:R(ia,ea,"Rotation",ha,t.getValue(Q.rotation)),offsetX:R(ia,ea,"OffsetX",ha,t.getValue(Q.offsetX)),offsetY:R(ia,ea,"OffsetY",
ha,t.getValue(Q.offsetY)),url:Q.url,applyRandomOffset:!1,sampleAlphaOnly:!1})}function K(Q,da,ea,ja,ha,Y){const ca=["Rotation","OffsetX","OffsetY"],ia=ja.filter(Ha=>Ha.primitiveName!==Q.primitiveName&&!ca.includes(Ha.propertyName)),ra=Q.primitiveName,[ua,za]=Ba(ja,ra,da,null,null);ja=f.numericHash(JSON.stringify(Q)+za).toString();const Da=f.numericHash(`${Q.separation}${JSON.stringify(Q.lineSymbol)}`).toString();let ya={r:255,g:255,b:255,a:1};if(Q.lineSymbol){var Ga;const Ha=null==(Ga=Q.lineSymbol)?
void 0:Ga.symbolLayers.find(Fa=>"CIMSolidStroke"===Fa.type);Ha&&(ya=t.fromCIMColor(Ha.color))}Y.push({type:"fill",templateHash:ja,materialHash:ua?wa(Da,ea,ia,ha):Da,cim:Q,materialOverrides:ia,colorLocked:Q.colorLocked,effects:da,color:ya,height:R(ra,ea,"Separation",ha,Q.separation),scaleX:1,angle:R(ra,ea,"Rotation",ha,t.getValue(Q.rotation)),offsetX:R(ra,ea,"OffsetX",ha,t.getValue(Q.offsetX)),offsetY:R(ra,ea,"OffsetY",ha,t.getValue(Q.offsetY)),applyRandomOffset:!1,sampleAlphaOnly:!0})}function J(Q,
da,ea,ja,ha,Y,ca,ia){const ra=Q.primitiveName,ua=t.fromCIMColor(Q.color),za=void 0!==Q.width?Q.width:4,Da=l(Q.capStyle),ya=d(Q.joinStyle),Ga=Q.miterLimit,[Ha,Fa]=Ba(ja,ra,da,null,null),Ea=f.numericHash(JSON.stringify(Q)+Fa).toString();let Ka;if(da&&da instanceof Array&&0<da.length&&(ja=da[da.length-1],"CIMGeometricEffectDashes"===ja.type&&"NoConstraint"===ja.lineDashEnding&&null===ja.offsetAlongLine)){da=[...da];var Ma=da.pop();Ka=Ma.dashTemplate;Ma=Ma.scaleDash}Y.push({type:"line",templateHash:Ea,
materialHash:Ha?()=>Ea:Ea,cim:Q,materialOverrides:null,isOutline:ca,colorLocked:Q.colorLocked,effects:da,color:R(ra,ea,"Color",ha,ua,W),width:R(ra,ea,"Width",ha,za),cap:R(ra,ea,"CapStyle",ha,Da),join:R(ra,ea,"JoinStyle",ha,ya),miterLimit:R(ra,ea,"MiterLimit",ha,Ga),referenceWidth:ia,zOrder:S(Q.name),dashTemplate:Ka,scaleDash:Ma,sampleAlphaOnly:!0})}function I(Q,da,ea,ja,ha,Y,ca,ia){const ra=f.numericHash(`${Q.url}${JSON.stringify(Q.colorSubstitutions)}`).toString(),ua=Q.primitiveName,za=t.fromCIMColor(Q.tintColor),
Da=void 0!==Q.width?Q.width:4,ya=l(Q.capStyle),Ga=d(Q.joinStyle),Ha=Q.miterLimit,[Fa,Ea]=Ba(ja,ua,da,null,null);ja=f.numericHash(JSON.stringify(Q)+Ea).toString();Y.push({type:"line",templateHash:ja,materialHash:Fa?()=>ra:ra,cim:Q,materialOverrides:null,isOutline:ca,colorLocked:Q.colorLocked,effects:da,color:R(ua,ea,"TintColor",ha,za,W),width:R(ua,ea,"Width",ha,Da),cap:R(ua,ea,"CapStyle",ha,ya),join:R(ua,ea,"JoinStyle",ha,Ga),miterLimit:R(ua,ea,"MiterLimit",ha,Ha),referenceWidth:ia,zOrder:S(Q.name),
dashTemplate:null,scaleDash:!1,url:Q.url,sampleAlphaOnly:!1})}function H(Q,da,ea,ja,ha,Y){const ca=Q.markerPlacement;if(!ca||"CIMMarkerPlacementInsidePolygon"!==ca.type)return!1;var ia=Math.abs(ca.stepX),ra=Math.abs(ca.stepY);if(0===ia||0===ra)return!0;const ua=["Rotation","OffsetX","OffsetY"],za=ja.filter(Ea=>Ea.primitiveName!==Q.primitiveName&&!ua.includes(Ea.propertyName)),Da="url"in Q?Q.url:null,[ya,Ga]=Ba(ja,ca.primitiveName,da,null,null);ja=f.numericHash(JSON.stringify(Q)+Ga).toString();let Ha=
null;if("Random"===ca.gridType){var Fa=x.px2pt(a.RANDOM_INSIDE_POLYGON_TEXTURE_SIZE);const Ea=Math.max(Math.floor(Fa/ia),1),Ka=Math.max(Math.floor(Fa/ra),1);Fa=ra*Ka;Ha=Ma=>Ma?Ma*Ka:0;ia=Ea*ia/Fa}else ca.shiftOddRows?(Fa=2*ra,Ha=Ea=>Ea?2*Ea:0,ia=ia/ra*.5):(Fa=ra,Ha=null,ia/=ra);ra={r:255,g:255,b:255,a:1};"tintColor"in Q&&(ra=t.fromCIMColor(Q.tintColor));Y.push({type:"fill",templateHash:ja,materialHash:ya?wa(ja,ea,za,ha):ja,cim:Q,materialOverrides:za,colorLocked:Q.colorLocked,effects:da,color:R(ca.primitiveName,
ea,"TintColor",ha,ra,W),height:R(ca.primitiveName,ea,"StepY",ha,Fa,Ha),scaleX:ia,angle:R(ca.primitiveName,ea,"GridAngle",ha,ca.gridAngle),offsetX:R(ca.primitiveName,ea,"OffsetX",ha,t.getValue(ca.offsetX)),offsetY:R(ca.primitiveName,ea,"OffsetY",ha,t.getValue(ca.offsetY)),url:Da,applyRandomOffset:"Random"===ca.gridType,sampleAlphaOnly:!Da});return!0}function M(Q,da,ea,ja,ha,Y,ca,ia,ra){var ua;const za=Q.primitiveName,Da=t.getValue(Q.size);let ya=t.getValue(Q.scaleX);const Ga=t.getValue(Q.rotation),
Ha=t.getValue(Q.offsetX),Fa=t.getValue(Q.offsetY),Ea=Q.tintColor?t.fromCIMColor(Q.tintColor):{r:255,g:255,b:255,a:1},Ka=f.numericHash(`${Q.url}${JSON.stringify(Q.colorSubstitutions)}${JSON.stringify(Q.animatedSymbolProperties)}`).toString(),Ma=ta(Q.markerPlacement,ja,ea,ha),xa=pa(Q.animatedSymbolProperties,ja,ea,ha),[Qa,Wa]=Ba(ja,za,da,Ma,xa);ja=f.numericHash(JSON.stringify(Q)+Wa).toString();const Ra=null!=(ua=Q.anchorPoint)?ua:{x:0,y:0};if("width"in Q){ua=Q.width;let O=1;Y=Y.getResource(Q.url);z.isSome(Y)&&
(O=Y.width/Y.height);ya/=Da/ua*O}ca.push({type:"marker",templateHash:ja,materialHash:Q.animatedSymbolProperties&&!0===Q.animatedSymbolProperties.randomizeStartTime?(O,Va,Na,Xa)=>{Na=h.getMaterialGroup(Xa);O=t.evaluateValueOrFunction(xa,O,Va);return Ka+`-MATERIALGROUP(${Na})`+`-ASP(${JSON.stringify(O)})`}:Qa?(O,Va)=>{O=t.evaluateValueOrFunction(xa,O,Va);return Ka+`-ASP(${JSON.stringify(O)})`}:Ka,cim:Q,materialOverrides:null,colorLocked:Q.colorLocked,effects:da,scaleSymbolsProportionally:!1,alignment:ia,
size:R(za,ea,"Size",ha,Da),scaleX:R(za,ea,"ScaleX",ha,ya),rotation:R(za,ea,"Rotation",ha,Ga),offsetX:R(za,ea,"OffsetX",ha,Ha),offsetY:R(za,ea,"OffsetY",ha,Fa),color:R(za,ea,"TintColor",ha,Ea,W),anchorPoint:{x:Ra.x,y:-Ra.y},isAbsoluteAnchorPoint:"Relative"!==Q.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:Q.rotateClockwise,referenceSize:ra,sizeRatio:1,markerPlacement:Ma,url:Q.url,animatedSymbolProperties:xa})}function N(Q,da,ea,ja,ha,Y,ca,ia,ra,ua,za){g.OverrideHelper.findApplicableOverrides(ja,
Y,[]);var Da=ja.geometry;if("x"in Da&&"y"in Da){var ya=ja.symbol;var Ga=ya.underline?"underline":ya.strikethrough?"line-through":"none";var Ha=B(ya.fontStyleName),Fa=b.getFontFamily(ya.fontFamilyName);ya.font={family:Fa,decoration:Ga,...Ha};var Ea=Q.frame,Ka=Da.x-.5*(Ea.xmin+Ea.xmax),Ma=Da.y-.5*(Ea.ymin+Ea.ymax),xa=Q.size/za;za=Q.primitiveName;Da=t.getValue(ya.height)*xa;Ea=t.getValue(ya.angle);Ka=t.getValue(Q.offsetX)+(t.getValue(ya.offsetX)+Ka)*xa;Ma=t.getValue(Q.offsetY)+(t.getValue(ya.offsetY)+
Ma)*xa;var Qa=t.fromCIMColor(g.CIMSymbolHelper.getFillColor(ya)),Wa=t.fromCIMColor(g.CIMSymbolHelper.getStrokeColor(ya)),Ra=g.CIMSymbolHelper.getStrokeWidth(ya);Ra||(Wa=t.fromCIMColor(g.CIMSymbolHelper.getFillColor(ya.haloSymbol)),Ra=ya.haloSize*xa);var [O,Va]=Ba(Y,za,da,ea,null);Y=JSON.stringify(Q.effects)+Number(Q.colorLocked)+JSON.stringify(Q.anchorPoint)+Q.anchorPointUnits+JSON.stringify(Q.markerPlacement);Y=f.numericHash(JSON.stringify(ja)+Y+Va).toString();var Na=R(ja.primitiveName,ha,"TextString",
ca,ja.textString,t._adjustTextCase,ya.textCase);if(null!=Na){({fontStyleName:ja}=ya);var Xa=Fa+(ja?"-"+ja.toLowerCase():"-regular");"string"===typeof Na&&Na.includes("[")&&ya.fieldMap&&(Na=t.createLabelOverrideFunction(ya.fieldMap,Na,ya.textCase));ia.push({type:"text",templateHash:Y,materialHash:O||"function"===typeof Na||Na.match(/\[(.*?)\]/)?(db,hb,mb)=>Xa+"-"+t.evaluateValueOrFunction(Na,db,hb,mb):Xa+"-"+f.numericHash(Na),cim:ya,materialOverrides:null,colorLocked:Q.colorLocked,effects:da,alignment:ra,
anchorPoint:{x:Q.anchorPoint?Q.anchorPoint.x:0,y:Q.anchorPoint?Q.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==Q.anchorPointUnits,fontName:Xa,decoration:Ga,weight:R(za,ha,"Weight",ca,Ha.weight),style:R(za,ha,"Size",ca,Ha.style),size:R(za,ha,"Size",ca,Da),angle:R(za,ha,"Rotation",ca,Ea),offsetX:R(za,ha,"OffsetX",ca,Ka),offsetY:R(za,ha,"OffsetY",ca,Ma),horizontalAlignment:q(ya.horizontalAlignment),verticalAlignment:n(ya.verticalAlignment),text:Na,color:Qa,outlineColor:Wa,outlineSize:Ra,referenceSize:ua,
sizeRatio:1,markerPlacement:ea})}}}function P(Q,da,ea,ja,ha,Y,ca,ia,ra,ua,za,Da,ya,Ga){var Ha=ha.symbol;const Fa=Ha.symbolLayers;if(Fa)if(Ga)X(Q,da,ea,ja,ha,ca,Y,ia,ra,ua,za,Da,ya);else if(Ga=Fa.length,Fa&&2===Fa.length&&Fa[0].enable&&Fa[1].enable&&"CIMSolidStroke"===Fa[0].type&&"CIMSolidFill"===Fa[1].type&&!Fa[0].effects&&!Fa[1].effects)ba(Q,da,ea,ja,ha,Fa,Y,ca,ia,ra,za,Da,ya);else if(Ha=e.CIMEffectHelper.applyEffects(Ha.effects,ha.geometry,ua.geometryEngine))for(;Ga--;){var Ea=Fa[Ga];if(Ea&&!1!==
Ea.enable)switch(Ea.type){case "CIMSolidFill":case "CIMSolidStroke":{var Ka,Ma=e.CIMEffectHelper.applyEffects(Ea.effects,Ha,ua.geometryEngine),xa=p.getExtent(Ma);if(!xa)continue;const [Ra,O,Va]=p.getSDFMetrics(xa,Q.frame,Q.size,Q.anchorPoint,"Relative"!==Q.anchorPointUnits);var Qa="CIMSolidFill"===Ea.type;Ma={type:"sdf",geom:Ma,asFill:Qa};var Wa=Q.primitiveName;xa=null!=(Ka=t.getValue(Q.size))?Ka:10;const Na=t.getValue(Q.rotation),Xa=t.getValue(Q.offsetX),db=t.getValue(Q.offsetY),hb=Ea.path,mb=Ea.primitiveName,
tb=Qa?t.fromCIMColor(g.CIMSymbolHelper.getFillColor(Ea)):t.fromCIMColor(g.CIMSymbolHelper.getStrokeColor(Ea)),sa=Qa?{r:0,g:0,b:0,a:0}:t.fromCIMColor(g.CIMSymbolHelper.getStrokeColor(Ea)),kb=g.CIMSymbolHelper.getStrokeWidth(Ea);if(!Qa&&!kb)break;Qa=!1;let xb="";for(const jb of Y)if(jb.primitiveName===mb||jb.primitiveName===Wa)void 0!==jb.value?xb+=`-${jb.primitiveName}-${jb.propertyName}-${JSON.stringify(jb.value)}`:jb.valueExpressionInfo&&(Qa=!0);z.isSome(da)&&"function"===typeof da&&(Qa=!0);Wa=JSON.stringify({...Q,
markerGraphics:null});const ib=f.numericHash(JSON.stringify(Ma)+hb).toString();Ea={type:"marker",templateHash:f.numericHash(JSON.stringify(ha)+JSON.stringify(Ea)+Wa+xb).toString(),materialHash:Qa?()=>ib:ib,cim:Ma,materialOverrides:null,colorLocked:Q.colorLocked,effects:da,scaleSymbolsProportionally:Q.scaleSymbolsProportionally,alignment:za,anchorPoint:{x:O,y:Va},isAbsoluteAnchorPoint:!1,size:R(Q.primitiveName,ca,"Size",ia,xa),rotation:R(Q.primitiveName,ca,"Rotation",ia,Na),offsetX:R(Q.primitiveName,
ca,"OffsetX",ia,Xa),offsetY:R(Q.primitiveName,ca,"OffsetY",ia,db),scaleX:1,frameHeight:ya,rotateClockwise:Q.rotateClockwise,referenceSize:Da,sizeRatio:Ra,color:R(mb,ca,"Color",ia,tb,W),outlineColor:R(mb,ca,"Color",ia,sa,W),outlineWidth:R(mb,ca,"Width",ia,kb),markerPlacement:ea,animatedSymbolProperties:ja,path:hb};ra.push(Ea);break}default:X(Q,da,ea,ja,ha,ca,Y,ia,ra,ua,za,Da,ya)}}}function ba(Q,da,ea,ja,ha,Y,ca,ia,ra,ua,za,Da,ya){var Ga=ha.geometry;const Ha=Y[0];Y=Y[1];var Fa=p.getExtent(Ga);if(Fa){var [Ea,
Ka,Ma]=p.getSDFMetrics(Fa,Q.frame,Q.size,Q.anchorPoint,"Relative"!==Q.anchorPointUnits);Ga={type:"sdf",geom:Ga,asFill:!0};var xa=Q.primitiveName;Fa=t.getValue(Q.size);var Qa=t.getValue(Q.rotation),Wa=t.getValue(Q.offsetX),Ra=t.getValue(Q.offsetY),O=Y.path,Va=Y.primitiveName,Na=Ha.primitiveName,Xa=t.fromCIMColor(g.CIMSymbolHelper.getFillColor(Y)),db=t.fromCIMColor(g.CIMSymbolHelper.getStrokeColor(Ha)),hb=g.CIMSymbolHelper.getStrokeWidth(Ha),mb=!1,tb="";for(const kb of ca)if(kb.primitiveName===Va||
kb.primitiveName===Na||kb.primitiveName===xa)void 0!==kb.value?tb+=`-${kb.primitiveName}-${kb.propertyName}-${JSON.stringify(kb.value)}`:kb.valueExpressionInfo&&(mb=!0);ca=JSON.stringify({...Q,markerGraphics:null});var sa=f.numericHash(JSON.stringify(Ga)+O).toString();Q={type:"marker",templateHash:f.numericHash(JSON.stringify(ha)+JSON.stringify(Y)+JSON.stringify(Ha)+ca+tb).toString(),materialHash:mb?()=>sa:sa,cim:Ga,materialOverrides:null,colorLocked:Q.colorLocked,effects:da,scaleSymbolsProportionally:Q.scaleSymbolsProportionally,
alignment:za,anchorPoint:{x:Ka,y:Ma},isAbsoluteAnchorPoint:!1,size:R(Q.primitiveName,ia,"Size",ra,Fa),rotation:R(Q.primitiveName,ia,"Rotation",ra,Qa),offsetX:R(Q.primitiveName,ia,"OffsetX",ra,Wa),offsetY:R(Q.primitiveName,ia,"OffsetY",ra,Ra),scaleX:1,frameHeight:ya,rotateClockwise:Q.rotateClockwise,referenceSize:Da,sizeRatio:Ea,color:R(Va,ia,"Color",ra,Xa,W),outlineColor:R(Na,ia,"Color",ra,db,W),outlineWidth:R(Na,ia,"Width",ra,hb),markerPlacement:ea,path:O,animatedSymbolProperties:ja};ua.push(Q)}}
function X(Q,da,ea,ja,ha,Y,ca,ia,ra,ua,za,Da,ya){ha={type:Q.type,enable:!0,name:Q.name,colorLocked:Q.colorLocked,primitiveName:Q.primitiveName,anchorPoint:Q.anchorPoint,anchorPointUnits:Q.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:Q.rotateClockwise,rotation:0,size:Q.size,billboardMode3D:Q.billboardMode3D,depth3D:Q.depth3D,frame:Q.frame,markerGraphics:[ha],scaleSymbolsProportionally:Q.scaleSymbolsProportionally,respectFrame:Q.respectFrame,clippingPath:Q.clippingPath};let Ga=[];const Ha=["Rotation",
"OffsetX","OffsetY"];Ga=ca.filter(Ra=>Ra.primitiveName!==Q.primitiveName||!Ha.includes(Ra.propertyName));var Fa="";for(var Ea of ca)void 0!==Ea.value&&(Fa+=`-${Ea.primitiveName}-${Ea.propertyName}-${JSON.stringify(Ea.value)}`);const [Ka,Ma,xa]=g.CIMSymbolHelper.getTextureAnchor(ha,ua);ca=Q.primitiveName;ua=t.getValue(Q.rotation);Ea=t.getValue(Q.offsetX);const Qa=t.getValue(Q.offsetY);Fa=f.numericHash(JSON.stringify(ha)+Fa).toString();const Wa=0<Ga.length||z.isSome(da)&&"function"===typeof da;da={type:"marker",
templateHash:Fa,materialHash:Wa?wa(Fa,Y,Ga,ia):Fa,cim:ha,materialOverrides:Ga,colorLocked:Q.colorLocked,effects:da,scaleSymbolsProportionally:Q.scaleSymbolsProportionally,alignment:za,anchorPoint:{x:Ka,y:Ma},isAbsoluteAnchorPoint:!1,size:Q.size,rotation:R(ca,Y,"Rotation",ia,ua),offsetX:R(ca,Y,"OffsetX",ia,Ea),offsetY:R(ca,Y,"OffsetY",ia,Qa),color:{r:255,g:255,b:255,a:1},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:ya,rotateClockwise:Q.rotateClockwise,referenceSize:Da,sizeRatio:xa/
x.pt2px(Q.size),markerPlacement:ea,animatedSymbolProperties:ja};ra.push(da)}function S(Q){return Q&&0===Q.indexOf("Level_")&&(Q=parseInt(Q.substr(6),10),!isNaN(Q))?Q:0}function W(Q){if(!Q||0===Q.length)return null;Q=(new E(Q)).toRgba();return{r:Q[0],g:Q[1],b:Q[2],a:Q[3]}}function R(Q,da,ea,ja,ha,Y,ca){if(Q=da[Q]){const ia=Q[ea];if("string"===typeof ia||"number"===typeof ia||ia instanceof Array)return Y?Y.call(null,ia,ca):ia;if(null!=ia&&ia instanceof k.ArcadeExpression)return(ra,ua,za)=>{ra=c(ia,
ra,{$view:za},ja.geometryType,ua);null!==ra&&Y&&(ra=Y.call(null,ra,ca));return null!==ra?ra:ha}}return ha}function Z(Q){return Q?Q.charAt(0).toLowerCase()+Q.substr(1):Q}function ka(Q,da,ea,ja){for(const ha of da)if(ha.valueExpressionInfo){const Y=ea[ha.primitiveName]&&ea[ha.primitiveName][ha.propertyName];Y instanceof k.ArcadeExpression&&(ha.fn=(ca,ia,ra)=>c(Y,ca,{$view:ra},ja.geometryType,ia))}return(ha,Y,ca)=>{for(var ia of da)ia.fn&&(ia.value=ia.fn(ha,Y,ca));ha=[];for(let ua of Q){var ra;if(Y=
null==(ra=ua)?void 0:ra.primitiveName){ca=!1;for(const za of da)za.primitiveName===Y&&(ia=Z(za.propertyName),null!=za.value&&za.value!==ua[ia]&&(ca||(ua=C.clone(ua),ca=!0),ua[ia]=za.value))}ha.push(ua)}return ha}}function ta(Q,da,ea,ja){const ha=[];g.OverrideHelper.findApplicableOverrides(Q,da,ha);if(0===ha.length)return Q;for(const Y of ha)if(Y.valueExpressionInfo){const ca=ea[Y.primitiveName]&&ea[Y.primitiveName][Y.propertyName];ca instanceof k.ArcadeExpression&&(Y.fn=(ia,ra,ua)=>c(ca,ia,{$view:ua},
ja.geometryType,ra))}return(Y,ca,ia)=>{for(const ra of ha)ra.fn&&(ra.value=ra.fn(Y,ca,ia));Y=C.clone(Q);ca=Q.primitiveName;for(const ra of ha)ra.primitiveName===ca&&(ia=Z(ra.propertyName),null!=ra.value&&ra.value!==Y[ia]&&(Y[ia]=ra.value));return Y}}function pa(Q,da,ea,ja){const ha=[];g.OverrideHelper.findApplicableOverrides(Q,da,ha);if(0===ha.length)return Q;for(const Y of ha)if(Y.valueExpressionInfo){const ca=ea[Y.primitiveName]&&ea[Y.primitiveName][Y.propertyName];ca instanceof k.ArcadeExpression&&
(Y.fn=(ia,ra,ua)=>c(ca,ia,{$view:ua},ja.geometryType,ra))}return(Y,ca,ia)=>{for(const ra of ha)ra.fn&&(ra.value=ra.fn(Y,ca,ia));Y=C.clone(Q);ca=Q.primitiveName;for(const ra of ha)ra.primitiveName===ca&&(ia=Z(ra.propertyName),null!=ra.value&&ra.value!==Y[ia]&&(Y[ia]=ra.value));return Y}}function wa(Q,da,ea,ja){for(const ha of ea)if(ha.valueExpressionInfo){const Y=da[ha.primitiveName]&&da[ha.primitiveName][ha.propertyName];Y instanceof k.ArcadeExpression&&(ha.fn=(ca,ia,ra)=>c(Y,ca,{$view:ra},ja.geometryType,
ia))}return(ha,Y,ca)=>{for(const ia of ea)ia.fn&&(ia.value=ia.fn(ha,Y,ca));return f.numericHash(Q+g.OverrideHelper.buildOverrideKey(ea)).toString()}}function Ba(Q,da,ea,ja,ha){let Y=!1,ca="";for(const ia of Q)ia.primitiveName===da&&(void 0!==ia.value?ca+=`-${ia.primitiveName}-${ia.propertyName}-${JSON.stringify(ia.value)}`:ia.valueExpressionInfo&&(Y=!0));z.isSome(ea)&&"function"===typeof ea&&(Y=!0);z.isSome(ja)&&"function"===typeof ja&&(Y=!0);z.isSome(ha)&&"function"===typeof ha&&(Y=!0);return[Y,
ca]}function L(Q,da,ea){if(Q&&da)switch(Q.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(Q=Q.symbolLayers)for(const ja of Q)switch(T(ja,da,ea),ja.type){case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMCharacterMarker":case "CIMPictureMarker":"url"in ja&&ja.url&&ea.push(da.fetchResource(ja.url,null));break;case "CIMVectorMarker":if(Q=ja.markerGraphics)for(const ha of Q)ha&&(Q=ha.symbol)&&L(Q,da,ea)}}}
function T(Q,da,ea){Q.effects&&!z.isSome(da.geometryEngine)&&(U?ea.push(U):t.isGeometryEngineRequired(Q.effects)&&(U=t.importGeometryEngine(),ea.push(U),U.then(ja=>da.geometryEngine=ja)))}const la=v.getLogger("esri.symbols.cim.cimAnalyzer");let U;r.analyzeCIMResource=function(Q,da){if(!da||0===da.length)return Q;Q=JSON.parse(JSON.stringify(Q));g.OverrideHelper.applyOverrides(Q,da);return Q};r.analyzeCIMSymbol=function(Q,da,ea,ja,ha){return y.apply(this,arguments)};Object.defineProperties(r,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMSymbolHelper":function(){define("exports ../../Color ../../core/BidiText ../../core/floatRGBA ../../core/lang ../../core/Logger ../../core/mathUtils ../../core/maybe ../../core/RandomLCG ../../core/screenUtils ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ./CIMPlacements ./CIMSymbolDrawHelper ./enums ./utils ../../views/2d/engine/vectorTiles/GeometryUtils ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/mesh/templates/shapingUtils".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t,e,c,a,b,h,l){function d(W,R){switch(R.type){case "CIMSymbolReference":return d(W,R.symbol);case "CIMPointSymbol":W.drawSymbol(R,{x:0,y:0});break;case "CIMLineSymbol":W.drawSymbol(R,{paths:[[[0,0],[0,1]]]});break;case "CIMPolygonSymbol":W.drawSymbol(R,{rings:[[[0,0],[0,1],[0,0]]]});break;case "CIMTextSymbol":W.drawSymbol(R,{x:0,y:0});break;case "CIMVectorMarker":{const Z=new t.Placement;W.drawMarker(R,Z)}}return W.envelope()}function q(W){if(!W)return 0;switch(W.type){case "CIMMarkerPlacementAlongLineSameSize":return Math.abs(W.offset);
case "CIMMarkerPlacementAlongLineRandomSize":return Math.abs(W.offset);case "CIMMarkerPlacementAtExtremities":return Math.abs(W.offset);case "CIMMarkerPlacementAtMeasuredUnits":return Math.abs(W.offset);case "CIMMarkerPlacementAtRatioPositions":return Math.abs(W.offset);case "CIMMarkerPlacementInsidePolygon":return 0;case "CIMMarkerPlacementOnLine":return Math.abs(W.offset);case "CIMMarkerPlacementOnVertices":return Math.abs(W.offset);case "CIMMarkerPlacementPolygonCenter":return 0;default:return 0}}
function n(W){if(!W)return 0;switch(W.type){case "CIMGeometricEffectArrow":return Math.abs(.5*W.width);case "CIMGeometricEffectBuffer":return Math.abs(W.size);case "CIMGeometricEffectExtension":return Math.abs(W.length);case "CIMGeometricEffectJog":return Math.abs(.5*W.length);case "CIMGeometricEffectMove":return Math.max(Math.abs(a.getValue(W.offsetX)),Math.abs(a.getValue(W.offsetY)));case "CIMGeometricEffectOffset":return Math.abs(W.offset);case "CIMGeometricEffectOffsetTangent":return Math.abs(W.offset);
case "CIMGeometricEffectRadial":return Math.abs(W.length);case "CIMGeometricEffectRegularPolygon":return Math.abs(W.radius);case "CIMGeometricEffectRotate":return 0;case "CIMGeometricEffectScale":return 0;case "CIMGeometricEffectTaperedPolygon":return.5*Math.max(Math.abs(W.fromWidth),Math.abs(W.toWidth));case "CIMGeometricEffectWave":return Math.abs(W.amplitude);default:return 0}}function B(W){if(!W)return 0;let R=0;for(const Z of W)R+=n(Z);return R}const A=Math.PI,w=A/2,y=96/72,D=Math.PI/180,F=z.getLogger("esri.symbols.cim.CIMSymbolHelper");
z=function(){function W(){}var R=W.prototype;R.getSymbolInflateSize=function(Z,ka,ta,pa,wa){Z||(Z=[0,0,0,0]);return ka?this._getInflateSize(Z,ka,ta,pa,wa):Z};W.safeSize=function(Z){const ka=Math.max(Math.abs(Z[0]),Math.abs(Z[2]));Z=Math.max(Math.abs(Z[1]),Math.abs(Z[3]));return Math.sqrt(ka*ka+Z*Z)};R._vectorMarkerBounds=function(Z,ka,ta,pa){let wa=!0;const Ba=m.create();if(ka&&ka.markerGraphics)for(const L of ka.markerGraphics)ka=[0,0,0,0],L.geometry&&(p.getBoundsXY(Ba,L.geometry),ka[0]=0,ka[1]=
0,ka[2]=0,ka[3]=0,this.getSymbolInflateSize(ka,L.symbol,ta,0,pa),Ba[0]+=ka[0],Ba[1]+=ka[1],Ba[2]+=ka[2],Ba[3]+=ka[3],wa?(Z[0]=Ba[0],Z[1]=Ba[1],Z[2]=Ba[2],Z[3]=Ba[3],wa=!1):(Z[0]=Math.min(Z[0],Ba[0]),Z[1]=Math.min(Z[1],Ba[1]),Z[2]=Math.max(Z[2],Ba[2]),Z[3]=Math.max(Z[3],Ba[3])));return Z};R._getInflateSize=function(Z,ka,ta,pa,wa){return void 0!==ka.symbolLayers?(Z=this._getLayersInflateSize(Z,ka.symbolLayers,ta,pa,wa),ka=B(ka.effects),0<ka&&(Z[0]-=ka,Z[1]-=ka,Z[2]+=ka,Z[3]+=ka),Z):this._getTextInflatedSize(Z,
ka,wa)};R._getLayersInflateSize=function(Z,ka,ta,pa,wa){let Ba=!0;if(!ka)return Z;for(const da of ka)if(da){var L=[0,0,0,0];switch(da.type){case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":ka=da;var T=ka.width;T=ka.capStyle===c.LineCapStyle.Square||ka.joinStyle===c.LineJoinStyle.Miter?T/1.4142135623730951:T/2;L[0]=-T;L[1]=-T;L[2]=T;L[3]=T;break;case "CIMCharacterMarker":case "CIMVectorMarker":case "CIMPictureMarker":ka=da;if("CIMVectorMarker"===da.type){if(T=da,L=this._vectorMarkerBounds(L,
T,ta,wa),T.frame){var la=(T.frame.xmin+T.frame.xmax)/2,U=(T.frame.ymin+T.frame.ymax)/2;L[0]-=la;L[1]-=U;L[2]-=la;L[3]-=U;T=T.size/(T.frame.ymax-T.frame.ymin);L[0]*=T;L[1]*=T;L[2]*=T;L[3]*=T}}else"CIMPictureMarker"===da.type?(L=da,la=ta.getResource(L.url),T=1,f.isSome(la)&&la.height&&(T=la.width/la.height),la=ka.size/2,L=ka.size*T*L.scaleX/2,L=[-L,-la,L,la]):(L=ka.size/2,L=[-L,-L,L,L]);ka.anchorPoint&&("Absolute"===ka.anchorPointUnits?(T=ka.anchorPoint.x,la=ka.anchorPoint.y):(T=ka.anchorPoint.x*(L[2]-
L[0]),la=ka.anchorPoint.y*(L[3]-L[1])),L[0]-=T,L[1]-=la,L[2]-=T,L[3]-=la);T=a.getValue(ka.rotation);ka.rotateClockwise&&(T=-T);pa&&(T-=pa);T&&(la=D*T,T=Math.cos(la),la=Math.sin(la),U=m.create([b.C_INFINITY,b.C_INFINITY,-b.C_INFINITY,-b.C_INFINITY]),m.expandPointInPlace(U,[L[0]*T-L[1]*la,L[0]*la+L[1]*T]),m.expandPointInPlace(U,[L[0]*T-L[3]*la,L[0]*la+L[3]*T]),m.expandPointInPlace(U,[L[2]*T-L[1]*la,L[2]*la+L[1]*T]),m.expandPointInPlace(U,[L[2]*T-L[3]*la,L[2]*la+L[3]*T]),L=U);T=a.getValue(ka.offsetX);
la=a.getValue(ka.offsetY);if(pa){var Q=D*pa;U=Math.cos(Q);Q=Math.sin(Q);const ea=T*Q+la*U;T=T*U-la*Q;la=ea}L[0]+=T;L[1]+=la;L[2]+=T;L[3]+=la;ka=q(ka.markerPlacement);0<ka&&(L[0]-=ka,L[1]-=ka,L[2]+=ka,L[3]+=ka)}ka=B(da.effects);0<ka&&(L[0]-=ka,L[1]-=ka,L[2]+=ka,L[3]+=ka);Ba?(Z[0]=L[0],Z[1]=L[1],Z[2]=L[2],Z[3]=L[3],Ba=!1):(Z[0]=Math.min(Z[0],L[0]),Z[1]=Math.min(Z[1],L[1]),Z[2]=Math.max(Z[2],L[2]),Z[3]=Math.max(Z[3],L[3]))}return Z};R._getTextInflatedSize=function(Z,ka,ta){var pa,wa;const Ba=null!=(pa=
ka.height)?pa:10;Z[0]=-Ba/2;Z[1]=-Ba/2;Z[2]=Ba/2;Z[3]=Ba/2;if(!ta)return Z;ta=ta.get(ka);if(!ta)return Z;const {text:L,mosaicItem:T}=ta;if(!T||0===T.glyphMosaicItems.length)return Z;ta=e.lineGapType2LineHeight(ka.lineGapType,null!=(wa=ka.lineGap)?wa:0,Ba);wa=E.bidiText(L)[1];ka=l.shapeGlyphs(T.glyphMosaicItems,wa,{scale:Ba/h.GLYPH_SIZE,angle:a.getValue(ka.angle),xOffset:a.getValue(ka.offsetX),yOffset:a.getValue(ka.offsetY),hAlign:e.horizontalAlignment2HAlign(ka.horizontalAlignment),vAlign:e.verticalAlignment2VAlign(ka.verticalAlignment),
maxLineWidth:512,lineHeight:h.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(ta||1,4)),decoration:ka.font.decoration||"none",isCIM:!0}).boundsT;Z[0]=ka.x-ka.halfWidth;Z[1]=-ka.y-ka.halfHeight;Z[2]=ka.x+ka.halfWidth;Z[3]=-ka.y+ka.halfHeight;return Z};return W}();let G=function(){function W(){}W.getEnvelope=function(R,Z){Z=new e.EnvDrawHelper(Z);if(Array.isArray(R)){let ka;for(const ta of R)ka?ka.union(d(Z,ta)):ka=d(Z,ta);return ka}return d(Z,R)};W.getTextureAnchor=function(R,Z){R=this.getEnvelope(R,
Z);if(!R)return[0,0,0];Z=R.height*y+2;return[(R.x+.5*R.width)*y/(R.width*y+2),-(R.y+.5*R.height)*y/Z,Z]};W.rasterize=function(R,Z,ka,ta,pa=!0){var wa=ka||this.getEnvelope(Z,ta);if(!wa)return[null,0,0,0,0];const Ba=(wa.x+.5*wa.width)*y,L=(wa.y+.5*wa.height)*y;R.width=wa.width*y;R.height=wa.height*y;ka||(R.width+=2,R.height+=2);ka=R.getContext("2d");wa=e.Transformation.createScale(y,-y);wa.translate(.5*R.width-Ba,.5*R.height+L);ta=new e.CanvasDrawHelper(ka,ta,wa);switch(Z.type){case "CIMPointSymbol":ta.drawSymbol(Z,
{type:"point",x:0,y:0});break;case "CIMVectorMarker":wa=new t.Placement,ta.drawMarker(Z,wa)}Z=ka.getImageData(0,0,R.width,R.height);Z=new Uint8Array(Z.data);if(pa)for(ta=0;ta<Z.length;ta+=4)pa=Z[ta+3]/255,Z[ta]*=pa,Z[ta+1]*=pa,Z[ta+2]*=pa;return[Z,R.width,R.height,-Ba/R.width,-L/R.height]};W.fromTextSymbol=function(R){const {angle:Z,color:ka,font:ta,haloColor:pa,haloSize:wa,horizontalAlignment:Ba,kerning:L,text:T,verticalAlignment:la,xoffset:U,yoffset:Q}=R;let da,ea;if(ta){var ja=ta.family;var ha=
ta.style;var Y=ta.weight;da=ta.size;ea=ta.decoration}R=!1;T&&(R=E.bidiText(T)[1]);var ca=c.BlockProgression.BTT,ia=c.FontEffects.Normal,ra=c.FontEncoding.Unicode;ja=ja||"Arial";b:{if(Y)switch(Y.toLowerCase()){case "bold":case "bolder":Y="bold";break b}Y=""}b:{if(ha)switch(ha.toLowerCase()){case "italic":case "oblique":ha="italic";break b}ha=""}Y=Y&&ha?`${Y}-${ha}`:`${Y}${ha}`;return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",
size:10,billboardMode3D:"FaceNearPlane",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMTextSymbol",angle:Z,blockProgression:ca,depth3D:1,extrapolateBaselines:!0,fontEffects:ia,fontEncoding:ra,fontFamilyName:ja,fontStyleName:Y,fontType:c.FontType.Unspecified,haloSize:wa,height:da,hinting:c.GlyphHinting.Default,horizontalAlignment:M(null!=Ba?Ba:"center"),kerning:L,letterWidth:100,ligatures:!0,lineGapType:"Multiple",offsetX:a.getValue(U),
offsetY:a.getValue(Q),strikethrough:"line-through"===ea,underline:"underline"===ea,symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:P(ka)}]},haloSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:P(pa)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:"Normal",textDirection:R?c.TextReadingDirection.RTL:c.TextReadingDirection.LTR,verticalAlignment:N(null!=la?la:"baseline"),verticalGlyphOrientation:c.VerticalGlyphOrientation.Right,
wordSpacing:100,billboardMode3D:c.BillBoardMode.FaceNearPlane},textString:T}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:"Display"}};W.fromPictureFillSymbol=function(R){const {height:Z,outline:ka,width:ta,xoffset:pa,xscale:wa,yoffset:Ba,yscale:L}=R,T=[],la={type:"CIMPolygonSymbol",symbolLayers:T};if(ka){const {cap:Q,join:da,miterLimit:ea,width:ja}=ka;T.push({type:"CIMSolidStroke",color:P(ka.color),capStyle:I(Q),joinStyle:H(da),miterLimit:ea,width:ja})}let U=R.url;"esriPFS"===
R.type&&R.imageData&&(U=R.imageData);R="angle"in R?R.angle:0;T.push({type:"CIMPictureFill",invertBackfaceTexture:!1,scaleX:1,textureFilter:c.TextureFilter.Picture,tintColor:null,url:U,height:Z*(L||1),width:ta*(wa||1),offsetX:a.getValue(pa),offsetY:a.getValue(Ba),rotation:a.getValue(-R),colorSubstitutions:null});return la};W.fromSimpleFillSymbol=function(R){const {color:Z,style:ka,outline:ta}=R;R=[];const pa={type:"CIMPolygonSymbol",symbolLayers:R};var wa=null;if(ta){const {cap:L,join:T,style:la}=
ta;"solid"!==la&&"none"!==la&&"esriSLSSolid"!==la&&"esriSLSNull"!==la&&(wa=[{type:"CIMGeometricEffectDashes",dashTemplate:ba(la,L),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);R.push({type:"CIMSolidStroke",color:P(ta.color),capStyle:I(L),joinStyle:H(T),miterLimit:ta.miterLimit,width:ta.width,effects:wa})}if(ka&&"solid"!==ka&&"none"!==ka&&"esriSFSSolid"!==ka&&"esriSFSNull"!==ka){wa={type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",color:P(Z),capStyle:c.LineCapStyle.Butt,
joinStyle:c.LineJoinStyle.Miter,width:.75}]};let L=0;var Ba=x.nextPowerOfTwo(Math.ceil(window.devicePixelRatio));Ba=S(ka)?8*Ba:10*Ba;switch(ka){case "vertical":case "esriSFSVertical":L=90;break;case "forward-diagonal":case "esriSFSForwardDiagonal":L=-45;break;case "backward-diagonal":case "esriSFSBackwardDiagonal":L=45;break;case "cross":case "esriSFSCross":L=0;break;case "diagonal-cross":case "esriSFSDiagonalCross":L=-45}R.push({type:"CIMHatchFill",lineSymbol:wa,offsetX:0,offsetY:0,rotation:L,separation:Ba});
"cross"===ka||"esriSFSCross"===ka?R.push({type:"CIMHatchFill",lineSymbol:v.clone(wa),offsetX:0,offsetY:0,rotation:90,separation:Ba}):("diagonal-cross"===ka||"esriSFSDiagonalCross"===ka)&&R.push({type:"CIMHatchFill",lineSymbol:v.clone(wa),offsetX:0,offsetY:0,rotation:45,separation:Ba})}else!ka||"solid"!==ka&&"esriSFSSolid"!==ka||R.push({type:"CIMSolidFill",enable:!0,color:P(Z)});return pa};W.fromSimpleLineSymbol=function(R){const {cap:Z,color:ka,join:ta,marker:pa,miterLimit:wa,style:Ba,width:L}=R;
R=null;"solid"!==Ba&&"none"!==Ba&&"esriSLSSolid"!==Ba&&"esriSLSNull"!==Ba&&(R=[{type:"CIMGeometricEffectDashes",dashTemplate:ba(Ba,Z),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);const T=[];if(pa){let la;switch(pa.placement){case "begin-end":la=c.ExtremityPlacement.Both;break;case "begin":la=c.ExtremityPlacement.JustBegin;break;case "end":la=c.ExtremityPlacement.JustEnd;break;default:la=c.ExtremityPlacement.None}const U=W.fromSimpleMarker(pa,L,ka).symbolLayers[0];U.markerPlacement=
{type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:la,offsetAlongLine:0};T.push(U)}"none"!==Ba&&"esriSLSNull"!==Ba&&T.push({type:"CIMSolidStroke",color:P(ka),capStyle:I(Z),joinStyle:H(ta),miterLimit:wa,width:L,effects:R});return{type:"CIMLineSymbol",symbolLayers:T}};W.fromPictureMarker=function(R){const {angle:Z,height:ka,width:ta,xoffset:pa,yoffset:wa}=R;let Ba=R.url;"esriPMS"===R.type&&R.imageData&&(Ba=R.imageData);return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMPictureMarker",
invertBackfaceTexture:!1,scaleX:1,textureFilter:c.TextureFilter.Picture,tintColor:null,url:Ba,size:ka,width:ta,offsetX:a.getValue(pa),offsetY:a.getValue(wa),rotation:a.getValue(-Z)}]}};W.fromSimpleMarker=function(R,Z,ka){var ta,{style:pa}=R;ka=null!=(ta=R.color)?ta:ka;if("path"===pa){Z=[];"outline"in R&&R.outline&&(ta=R.outline,Z.push({type:"CIMSolidStroke",enable:!0,width:g.pt2px(Math.round(g.px2pt(ta.width))),color:P(ta.color)}));Z.push({type:"CIMSolidFill",enable:!0,color:P(ka),path:R.path});const [T,
la]=X("square");return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:a.getValue(-R.angle),size:a.getValue(R.size||6),offsetX:a.getValue(R.xoffset),offsetY:a.getValue(R.yoffset),frame:T,markerGraphics:[{type:"CIMMarkerGraphic",geometry:la,symbol:{type:"CIMPolygonSymbol",symbolLayers:Z}}]}]}}const [wa,Ba]=X(pa);let L;Ba&&wa&&(ta=[],"outline"in R&&R.outline?(pa=R.outline,ta.push({type:"CIMSolidStroke",enable:!0,width:.667<pa.width?g.pt2px(Math.round(g.px2pt(pa.width))):
pa.width,color:P(pa.color)})):!Z||"line-marker"!==R.type||"cross"!==R.style&&"x"!==R.style||ta.push({type:"CIMSolidStroke",enable:!0,width:Z,color:P(ka)}),ta.push({type:"CIMSolidFill",enable:!0,color:P(ka)}),ka={type:"CIMPolygonSymbol",symbolLayers:ta},L={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:a.getValue(-R.angle),size:a.getValue(R.size||6*Z),offsetX:a.getValue(R.xoffset),offsetY:a.getValue(R.yoffset),frame:wa,markerGraphics:[{type:"CIMMarkerGraphic",geometry:Ba,
symbol:ka}]}]});return L};W.fromCIMHatchFill=function(R){var Z;const ka=null!=(Z=R.separation)?Z:4;Z=ka/2;const ta=R.lineSymbol;for(R=this._getLineSymbolPeriod(R.lineSymbol)||4;4>R;)R*=2;R/=2;return{type:"CIMVectorMarker",frame:{xmin:-R,xmax:R,ymin:-Z,ymax:Z},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-R,0],[R,0]]]},symbol:ta}],size:ka}};W._getLineSymbolPeriod=function(R){if(R){const Z=this._getEffectsRepeat(R.effects);if(Z)return Z;if(R.symbolLayers)for(const ka of R.symbolLayers)if(ka){if(R=
this._getEffectsRepeat(ka.effects))return R;switch(ka.type){case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":case "CIMObjectMarker3D":case "CIMglTFMarker3D":if(R=this._getPlacementRepeat(ka.markerPlacement))return R}}}return 0};W._getEffectsRepeat=function(R){if(R)for(var Z of R)if(Z)switch(Z.type){case "CIMGeometricEffectDashes":if((R=Z.dashTemplate)&&R.length){Z=0;for(const ka of R)Z+=ka;R.length&1&&(Z*=2);return Z}break;case "CIMGeometricEffectWave":return Z.period;default:F.error(`unsupported geometric effect type ${Z.type}`)}return 0};
W._getPlacementRepeat=function(R){if(R)switch(R.type){case "CIMMarkerPlacementAlongLineSameSize":case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineVariableSize":if((R=R.placementTemplate)&&R.length){let Z=0;for(const ka of R)Z+=ka;R.length&1&&(Z*=2);return Z}}return 0};W.fromCIMInsidePolygon=function(R){var Z,ka=R.markerPlacement;const ta={type:R.type,...R,markerPlacement:null,anchorPoint:null};R=Math.abs(ka.stepX);const pa=Math.abs(ka.stepY);var wa=(null!=(Z=ka.randomness)?
Z:100)/100;let Ba,L;if("Random"===ka.gridType){Z=g.px2pt(h.RANDOM_INSIDE_POLYGON_TEXTURE_SIZE);const T=Math.max(Math.floor(Z/R),1),la=Math.max(Math.floor(Z/pa),1);Z=T*R/2;Ba=la*pa/2;L=2*Ba;ka=new k(ka.seed);const U=wa*R/1.5,Q=wa*pa/1.5;wa=[];for(let da=0;da<T;da++)for(let ea=0;ea<la;ea++){const ja=da*R-Z+U*(.5-ka.getFloat()),ha=ea*pa-Ba+Q*(.5-ka.getFloat());wa.push({x:ja,y:ha});0===da&&wa.push({x:ja+2*Z,y:ha});0===ea&&wa.push({x:ja,y:ha+2*Ba})}}else!0===ka.shiftOddRows?(Z=R/2,Ba=pa,L=2*pa,wa=[{x:-Z,
y:0},{x:Z,y:0},{x:0,y:Ba},{x:0,y:-Ba}]):(Z=R/2,Ba=pa/2,L=pa,wa=[{x:0,y:0}]);R=wa.map(T=>({type:"CIMMarkerGraphic",geometry:T,symbol:{type:"CIMPointSymbol",symbolLayers:[ta]}}));return{type:"CIMVectorMarker",frame:{xmin:-Z,xmax:Z,ymin:-Ba,ymax:Ba},markerGraphics:R,size:L}};W.getFillColor=function(R){if(!R)return null;switch(R.type){case "CIMPolygonSymbol":if(R.symbolLayers)for(const Z of R.symbolLayers)if(R=W.getFillColor(Z),null!=R)return R;break;case "CIMTextSymbol":return W.getFillColor(R.symbol);
case "CIMSolidFill":return R.color}};W.getStrokeColor=function(R){if(R)switch(R.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(R.symbolLayers)for(const Z of R.symbolLayers)if(R=W.getStrokeColor(Z),void 0!==R)return R;break;case "CIMTextSymbol":return W.getStrokeColor(R.symbol);case "CIMSolidStroke":return R.color}};W.getStrokeWidth=function(R){if(R)switch(R.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(R.symbolLayers)for(const Z of R.symbolLayers)if(R=W.getStrokeWidth(Z),void 0!==R)return R;
break;case "CIMTextSymbol":return W.getStrokeWidth(R.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return R.width}};W.getSize=function(R){if(R)switch(R.type){case "CIMTextSymbol":return R.height;case "CIMPointSymbol":var Z=0;if(R.symbolLayers)for(var ka of R.symbolLayers)if(ka)switch(ka.type){case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":case "CIMObjectMarker3D":case "CIMglTFMarker3D":R=ka.size,R>Z&&(Z=R)}return Z;case "CIMLineSymbol":case "CIMPolygonSymbol":ka=
0;if(R.symbolLayers)for(Z of R.symbolLayers)if(Z)switch(Z.type){case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":R=Z.width;R>ka&&(ka=R);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":case "CIMObjectMarker3D":case "CIMglTFMarker3D":a.isCIMMarkerStrokePlacement(Z.markerPlacement)&&(R=Z.size,R>ka&&(ka=R))}return ka}};W.getMarkerScaleRatio=function(R){if(R)switch(R.type){case "CIMVectorMarker":if(!1!==R.scaleSymbolsProportionally&&R.frame)return R.size/
(R.frame.ymax-R.frame.ymin)}return 1};return W}(),K=function(){function W(){}W.rasterizeSimpleFill=function(R,Z,ka){"solid"!==Z&&"none"!==Z&&"esriSFSSolid"!==Z&&"esriSFSNull"!==Z||console.error("Unexpected: style does not require rasterization");ka=x.nextPowerOfTwo(Math.ceil(ka));var ta=S(Z)?8*ka:16*ka;const pa=2*ka;R.width=ta;R.height=ta;const wa=R.getContext("2d");wa.strokeStyle="#FFFFFF";wa.lineWidth=ka;wa.beginPath();if("vertical"===Z||"cross"===Z||"esriSFSCross"===Z||"esriSFSVertical"===Z)wa.moveTo(ta/
2,-pa),wa.lineTo(ta/2,ta+pa);if("horizontal"===Z||"cross"===Z||"esriSFSCross"===Z||"esriSFSHorizontal"===Z)wa.moveTo(-pa,ta/2),wa.lineTo(ta+pa,ta/2);if("forward-diagonal"===Z||"diagonal-cross"===Z||"esriSFSDiagonalCross"===Z||"esriSFSForwardDiagonal"===Z)wa.moveTo(-pa,-pa),wa.lineTo(ta+pa,ta+pa),wa.moveTo(ta-pa,-pa),wa.lineTo(ta+pa,pa),wa.moveTo(-pa,ta-pa),wa.lineTo(pa,ta+pa);if("backward-diagonal"===Z||"diagonal-cross"===Z||"esriSFSBackwardDiagonal"===Z||"esriSFSDiagonalCross"===Z)wa.moveTo(ta+pa,
-pa),wa.lineTo(-pa,ta+pa),wa.moveTo(pa,-pa),wa.lineTo(-pa,pa),wa.moveTo(ta+pa,ta-pa),wa.lineTo(ta-pa,ta+pa);wa.stroke();Z=wa.getImageData(0,0,R.width,R.height);Z=new Uint8Array(Z.data);for(ta=0;ta<Z.length;ta+=4)ka=Z[ta+3]/255,Z[ta]*=ka,Z[ta+1]*=ka,Z[ta+2]*=ka;return[Z,R.width,R.height]};W.rasterizeSimpleLine=function(R,Z){return this.rasterizeDash(R,Z)};W.rasterizeDash=function(R,Z){var ka="Butt"===Z,ta="Square"===Z;Z=!ka&&!ta;1===R.length%2&&(R=[...R,...R]);var pa=0;for(var wa of R)pa+=wa;wa=Math.round(15.5*
pa);pa=new Float32Array(31*wa);let Ba=0,L=0,T=.5,la=!0;for(var U of R){Ba=L;for(L+=15.5*U;T<=L;){for(R=.5;31>R;){const Q=Z?(R-15.5)*(R-15.5):Math.abs(R-15.5);pa[(R-.5)*wa+T-.5]=la?ka?Math.max(Math.max(Ba+7.75-T,Q),Math.max(T-L+7.75,Q)):Q:Z?Math.min((T-Ba)*(T-Ba)+Q,(T-L)*(T-L)+Q):ta?Math.min(Math.max(T-Ba,Q),Math.max(L-T,Q)):Math.min(Math.max(T-Ba+7.75,Q),Math.max(L+7.75-T,Q));R++}T++}la=!la}ka=pa.length;U=new Uint8Array(4*ka);for(ta=0;ta<ka;++ta)C.packFloatRGBA((Z?Math.sqrt(pa[ta]):pa[ta])/15.5,U,
4*ta);return[U,wa,31]};return W}(),J=function(){function W(){}W.findApplicableOverrides=function(R,Z,ka){if(R&&Z){if(R.primitiveName){let ta=!1;for(const pa of ka)if(pa.primitiveName===R.primitiveName){ta=!0;break}if(!ta)for(const pa of Z)pa.primitiveName===R.primitiveName&&ka.push(pa)}switch(R.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(R.effects)for(const ta of R.effects)W.findApplicableOverrides(ta,Z,ka);if(R.symbolLayers)for(const ta of R.symbolLayers)W.findApplicableOverrides(ta,
Z,ka);break;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMSolidFill":case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":if(R.effects)for(const ta of R.effects)W.findApplicableOverrides(ta,Z,ka);R.markerPlacement&&W.findApplicableOverrides(R.markerPlacement,Z,ka);if("CIMVectorMarker"===R.type){if(R.markerGraphics)for(const ta of R.markerGraphics)W.findApplicableOverrides(ta,Z,ka),
W.findApplicableOverrides(ta.symbol,Z,ka)}else"CIMCharacterMarker"===R.type?W.findApplicableOverrides(R.symbol,Z,ka):"CIMHatchFill"===R.type?W.findApplicableOverrides(R.lineSymbol,Z,ka):"CIMPictureMarker"===R.type&&W.findApplicableOverrides(R.animatedSymbolProperties,Z,ka)}}};W.findEffectOverrides=function(R,Z,ka){if(Z&&R){var ta=R.length;for(let wa=0;wa<ta;wa++){var pa=R[wa];if(pa=null==pa?void 0:pa.primitiveName){let Ba=!1;for(const L of ka)if(L.primitiveName===pa){Ba=!0;break}if(!Ba)for(const L of Z)L.primitiveName===
pa&&ka.push(L)}}}};W.applyOverrides=function(R,Z,ka,ta){if(Z){if(R.primitiveName)for(const wa of Z)if(wa.primitiveName===R.primitiveName){var pa=(pa=wa.propertyName)?pa.charAt(0).toLowerCase()+pa.substr(1):pa;ta&&ta.push({cim:R,nocapPropertyName:pa,value:R[pa]});wa.expression&&(wa.value=W.toValue(wa.propertyName,wa.expression));if(ka){let Ba=!1;for(const L of ka)L.primitiveName===R.primitiveName&&(Ba=!0);Ba||ka.push(wa)}R[pa]=wa.value}switch(R.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(R.effects)for(const wa of R.effects)W.applyOverrides(wa,
Z,ka,ta);if(R.symbolLayers)for(const wa of R.symbolLayers)W.applyOverrides(wa,Z,ka,ta);break;case "CIMSolidStroke":case "CIMSolidFill":case "CIMVectorMarker":if(R.effects)for(const wa of R.effects)W.applyOverrides(wa,Z,ka,ta);if("CIMVectorMarker"===R.type&&R.markerGraphics)for(const wa of R.markerGraphics)W.applyOverrides(wa,Z,ka,ta),W.applyOverrides(wa.symbol,Z,ka,ta)}}};W.restoreOverrides=function(R){for(const Z of R)Z.cim[Z.nocapPropertyName]=Z.value};W.buildOverrideKey=function(R){let Z="";for(const ka of R)void 0!==
ka.value&&(Z+=`${ka.primitiveName}${ka.propertyName}${JSON.stringify(ka.value)}`);return Z};W.toValue=function(R,Z){return"DashTemplate"===R?Z.split(" ").map(ka=>Number(ka)):"Color"===R?(R=(new u(Z)).toRgba(),R[3]*=255,R):Z};return W}();const I=W=>{if(!W)return c.LineCapStyle.Butt;switch(W){case "butt":return c.LineCapStyle.Butt;case "square":return c.LineCapStyle.Square;case "round":return c.LineCapStyle.Round}},H=W=>{if(!W)return c.LineJoinStyle.Miter;switch(W){case "miter":return c.LineJoinStyle.Miter;
case "round":return c.LineJoinStyle.Round;case "bevel":return c.LineJoinStyle.Bevel}},M=W=>{if(f.isNone(W))return"Center";switch(W){case "left":return"Left";case "right":return"Right";case "center":return"Center"}},N=W=>{if(f.isNone(W))return"Center";switch(W){case "baseline":return"Baseline";case "top":return"Top";case "middle":return"Center";case "bottom":return"Bottom"}},P=W=>{if(!W)return[0,0,0,0];const {r:R,g:Z,b:ka,a:ta}=W;return[R,Z,ka,255*ta]},ba=(W,R)=>{R="butt"===R;switch(W){case "dash":case "esriSLSDash":return R?
[4,3]:[3,4];case "dash-dot":case "esriSLSDashDot":return R?[4,3,1,3]:[3,4,0,4];case "dot":case "esriSLSDot":return R?[1,3]:[0,4];case "long-dash":case "esriSLSLongDash":return R?[8,3]:[7,4];case "long-dash-dot":case "esriSLSLongDashDot":return R?[8,3,1,3]:[7,4,0,4];case "long-dash-dot-dot":case "esriSLSDashDotDot":return R?[8,3,1,3,1,3]:[7,4,0,4,0,4];case "short-dash":case "esriSLSShortDash":return R?[4,1]:[3,2];case "short-dash-dot":case "esriSLSShortDashDot":return R?[4,1,1,1]:[3,2,0,2];case "short-dash-dot-dot":case "esriSLSShortDashDotDot":return R?
[4,1,1,1,1,1]:[3,2,0,2,0,2];case "short-dot":case "esriSLSShortDot":return R?[1,1]:[0,2];case "solid":case "esriSLSSolid":case "none":return F.error("Unexpected: style does not require rasterization"),[0,0];default:return F.error(`Tried to rasterize SLS, but found an unexpected style: ${W}!`),[0,0]}},X=W=>{if("circle"===W||"esriSMSCircle"===W){var R=Math.acos(.995);W=Math.ceil(A/R/4);0===W&&(W=1);R=w/W;W*=4;var Z=[];Z.push([50,0]);for(let ka=1;ka<W;ka++)Z.push([50*Math.cos(ka*R),-50*Math.sin(ka*R)]);
Z.push([50,0]);R={rings:[Z]};Z={xmin:-50,ymin:-50,xmax:50,ymax:50}}else"cross"===W||"esriSMSCross"===W?(R={rings:[[[0,50],[0,0],[50,0],[50,-0],[0,-0],[0,-50],[-0,-50],[-0,-0],[-50,-0],[-50,0],[-0,0],[-0,50],[0,50]]]},Z={xmin:-50,ymin:-50,xmax:50,ymax:50}):"diamond"===W||"esriSMSDiamond"===W?(R={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},Z={xmin:-50,ymin:-50,xmax:50,ymax:50}):"square"===W||"esriSMSSquare"===W?(R={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},Z={xmin:-50,ymin:-50,xmax:50,
ymax:50}):"x"===W||"esriSMSX"===W?(R={rings:[[[0,0],[50,50],[50,50],[0,0],[50,-50],[50,-50],[0,-0],[-50,-50],[-50,-50],[-0,0],[-50,50],[-50,50],[0,0]]]},Z={xmin:-50,ymin:-50,xmax:50,ymax:50}):"triangle"===W||"esriSMSTriangle"===W?(W=2/3*100,Z=W-100,R={rings:[[[-57.735026918962575,Z],[0,W],[57.735026918962575,Z],[-57.735026918962575,Z]]]},Z={xmin:-57.735026918962575,ymin:Z,xmax:57.735026918962575,ymax:W}):"arrow"===W&&(R={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},Z={xmin:-50,
ymin:-50,xmax:50,ymax:50});return[Z,R]},S=W=>"vertical"===W||"horizontal"===W||"cross"===W||"esriSFSCross"===W||"esriSFSVertical"===W||"esriSFSHorizontal"===W;r.CIMSimbolInflatedSizeHelper=z;r.CIMSymbolHelper=G;r.OverrideHelper=J;r.SymbolHelper=K;r.slsDashToTemplateArray=ba;r.symbolToCIM=function(W){if(!W||!W.type)return null;let R;switch(W.type){case "cim":return W.data;case "web-style":return W;case "simple-marker":R=G.fromSimpleMarker(W);break;case "picture-marker":R=G.fromPictureMarker(W);break;
case "simple-line":R=G.fromSimpleLineSymbol(W);break;case "simple-fill":R=G.fromSimpleFillSymbol(W);break;case "picture-fill":R=G.fromPictureFillSymbol(W);break;case "text":R=G.fromTextSymbol(W)}return{type:"CIMSymbolReference",symbol:R}};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/floatRGBA":function(){define(["exports","./mathUtils"],function(r,u){function E(f,k=0){let g=0;for(let m=0;4>m;m++)g+=f[k+m]*z[m];return g}function C(f){return f-
Math.floor(f)}const v=[1,256,65536,16777216],z=[1/256,1/65536,1/16777216,1/4294967296],x=E(new Uint8ClampedArray([255,255,255,255]));r.packFloatRGBA=function(f,k,g=0){f=u.clamp(f,0,x);for(let m=0;4>m;m++)k[g+m]=Math.floor(256*C(f*v[m]))};r.unpackFloatRGBA=E;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMSymbolDrawHelper":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/BidiText ../../core/Logger ../../core/maybe ../../core/ObjectPool ../../core/screenUtils ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ../../geometry/support/centroid ../../geometry/support/jsonUtils ./CIMEffects ./CIMOperators ./CIMPlacements ./CIMResourceManager ./enums ./Rect ./TextRasterizer ../../views/2d/engine/webgl/alignmentUtils ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/mesh/templates/shapingUtils".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t,e,c,a,b,h,l,d,q){const n=Math.PI/180,B=C.getLogger("esri.symbols.cim.CIMSymbolDrawHelper");let A=function(){function I(M){this._t=M}I.createIdentity=function(){return new I([1,0,0,0,1,0])};var H=I.prototype;H.clone=function(){return new I(this._t.slice())};H.transform=function(M){const N=this._t;return[N[0]*M[0]+N[1]*M[1]+N[2],N[3]*M[0]+N[4]*M[1]+N[5]]};I.createScale=function(M,N){return new I([M,0,0,0,N,0])};H.scale=function(M,N){const P=this._t;P[0]*=M;P[1]*=M;
P[2]*=M;P[3]*=N;P[4]*=N;P[5]*=N;return this};H.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])};I.createTranslate=function(M,N){return new I([0,0,M,0,0,N])};H.translate=function(M,N){const P=this._t;P[2]+=M;P[5]+=N;return this};I.createRotate=function(M){const N=Math.cos(M);M=Math.sin(M);return new I([N,-M,0,M,N,0])};H.rotate=function(M){return I.multiply(this,I.createRotate(M),this)};I.multiply=function(M,N,P){M=M._t;N=N._t;const ba=M[1]*N[0]+M[4]*N[1],X=M[2]*
N[0]+M[5]*N[1]+N[2],S=M[0]*N[3]+M[3]*N[4],W=M[1]*N[3]+M[4]*N[4],R=M[2]*N[3]+M[5]*N[4]+N[5],Z=P._t;Z[0]=M[0]*N[0]+M[3]*N[1];Z[1]=ba;Z[2]=X;Z[3]=S;Z[4]=W;Z[5]=R;return P};H.invert=function(){const M=this._t;let N=M[0]*M[4]-M[1]*M[3];if(0===N)return new I([0,0,0,0,0,0]);N=1/N;return new I([M[4]*N,-M[1]*N,(M[1]*M[5]-M[2]*M[4])*N,-M[3]*N,M[0]*N,(M[2]*M[3]-M[0]*M[5])*N])};return I}();C=function(){function I(M,N){this._transfos=[];this._sizeTransfos=[];this._geomUnitsPerPoint=1;this._placementPool=new z(e.Placement,
null,null,100);this._earlyReturn=!1;this._mapRotation=0;this._resourceManager=M||new c;this._transfos.push(N||A.createIdentity());this._sizeTransfos.push(N?N.scaleRatio():1)}var H=I.prototype;H.setTransform=function(M,N){this._transfos=[M||A.createIdentity()];this._sizeTransfos=[N?N:M?M.scaleRatio():1]};H.setGeomUnitsPerPoint=function(M){this._geomUnitsPerPoint=M};H.transformPt=function(M){return this._transfos[this._transfos.length-1].transform(M)};H.transformSize=function(M){return M*this._sizeTransfos[this._sizeTransfos.length-
1]};H.reverseTransformPt=function(M){return this._transfos[this._transfos.length-1].invert().transform(M)};H.reverseTransformSize=function(M){return M/this._sizeTransfos[this._sizeTransfos.length-1]};H.geomUnitsPerPoint=function(){return this.isEmbedded()?1:this._geomUnitsPerPoint};H.isEmbedded=function(){return 1<this._transfos.length};H.back=function(){return this._transfos[this._transfos.length-1]};H.push=function(M,N){N=N?M.scaleRatio():1;A.multiply(M,this.back(),M);this._transfos.push(M);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-
1]*N)};H.pop=function(){this._transfos.splice(-1,1);this._sizeTransfos.splice(-1,1)};H.drawSymbol=function(M,N){if(M)switch(M.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(M,N);break;case "CIMTextSymbol":this.drawTextSymbol(M,N)}};H.drawMultiLayerSymbol=function(M,N){if(M){var P=M.symbolLayers;if(P)if((M=M.effects)&&0<M.length){if(N=this.executeEffects(M,N))for(M=N.next();M;)this.drawSymbolLayers(P,M),M=N.next()}else this.drawSymbolLayers(P,N)}};
H.executeEffects=function(M,N){const P=this._resourceManager.geometryEngine;N=new p.SimpleGeometryCursor(N);for(const ba of M)(M=t.getEffectOperator(ba))&&(N=M.execute(N,ba,this.geomUnitsPerPoint(),P));return N};H.drawSymbolLayers=function(M,N){let P=M.length;for(;P--;){const X=M[P];if(X&&!1!==X.enable){var ba=X.effects;if(ba&&0<ba.length){if(ba=this.executeEffects(ba,N)){let S=null;for(;(S=ba.next())&&(this.drawSymbolLayer(X,S),!this._earlyReturn););}}else this.drawSymbolLayer(X,N);if(this._earlyReturn)break}}};
H.drawSymbolLayer=function(M,N){switch(M.type){case "CIMSolidFill":this.drawSolidFill(N,M.color);break;case "CIMHatchFill":this.drawHatchFill(N,M);break;case "CIMPictureFill":this.drawPictureFill(N,M);break;case "CIMGradientFill":this.drawGradientFill(N,M);break;case "CIMSolidStroke":this.drawSolidStroke(N,M.color,M.width,M.capStyle,M.joinStyle,M.miterLimit);break;case "CIMPictureStroke":this.drawPictureStroke(N,M);break;case "CIMGradientStroke":this.drawGradientStroke(N,M);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":this.drawMarkerLayer(M,
N)}};H.drawHatchFill=function(M,N){const P=this._buildHatchPolyline(N,M,this.geomUnitsPerPoint());P&&(this.pushClipPath(M),this.drawMultiLayerSymbol(N.lineSymbol,P),this.popClipPath())};H.drawPictureFill=function(M,N){};H.drawGradientFill=function(M,N){};H.drawPictureStroke=function(M,N){};H.drawGradientStroke=function(M,N){};H.drawMarkerLayer=function(M,N){var P=M.markerPlacement;if(P){const X=t.getPlacementOperator(P);if(X){var ba="CIMMarkerPlacementInsidePolygon"===P.type;ba&&this.pushClipPath(N);
if(N=X.execute(N,P,this.geomUnitsPerPoint(),this._resourceManager.geometryEngine))for(P=null;(P=N.next())&&(this.drawMarker(M,P),!this._earlyReturn););ba&&this.popClipPath()}}else{P=this._placementPool.acquire();if(m.isPoint(N))P.tx=N.x,P.ty=N.y,this.drawMarker(M,P);else if(m.isPolygon(N))[P.tx,P.ty]=g.polygonCentroid(N),this.drawMarker(M,P);else for(ba of N.points)if(P.tx=ba[0],P.ty=ba[1],this.drawMarker(M,P),this._earlyReturn)break;this._placementPool.release(P)}};H.drawMarker=function(M,N){switch(M.type){case "CIMCharacterMarker":case "CIMPictureMarker":this.drawPictureMarker(M,
N);break;case "CIMVectorMarker":this.drawVectorMarker(M,N)}};H.drawPictureMarker=function(M,N){var P,ba,X,S,W;if(M){var R=this._resourceManager.getResource(M.url),Z=null!=(P=M.size)?P:10;if(!(v.isNone(R)||0>=Z)&&(P=R.width,R=R.height,P&&R)){R=P/R;P=null!=(ba=M.scaleX)?ba:1;ba=A.createIdentity();var ka=M.anchorPoint;if(ka){let ta=ka.x;ka=ka.y;"Absolute"!==M.anchorPointUnits&&(ta*=Z*R*P,ka*=Z);ba.translate(-ta,-ka)}R=null!=(X=M.rotation)?X:0;M.rotateClockwise&&(R=-R);this._mapRotation&&(R+=this._mapRotation);
R&&ba.rotate(R*n);X=null!=(S=M.offsetX)?S:0;S=null!=(W=M.offsetY)?W:0;if(X||S)this._mapRotation&&(R=n*this._mapRotation,W=Math.cos(R),R=Math.sin(R),P=X*R+S*W,X=X*W-S*R,S=P),ba.translate(X,S);W=this.geomUnitsPerPoint();1!==W&&ba.scale(W,W);(W=N.getAngle())&&ba.rotate(W);ba.translate(N.tx,N.ty);this.push(ba,!1);this.drawImage(M.url,Z,M.scaleX);this.pop()}}};H.drawVectorMarker=function(M,N){var P,ba,X,S;if(M){var W=M.markerGraphics;if(W){var R=null!=(P=M.size)?P:10,Z=(P=M.frame)?P.ymax-P.ymin:0;Z=R&&
Z?R/Z:1;R=A.createIdentity();P&&R.translate(.5*-(P.xmax+P.xmin),.5*-(P.ymax+P.ymin));var ka=M.anchorPoint;if(ka){let ta=ka.x;ka=ka.y;"Absolute"!==M.anchorPointUnits?P&&(ta*=P.xmax-P.xmin,ka*=P.ymax-P.ymin):(ta/=Z,ka/=Z);R.translate(-ta,-ka)}1!==Z&&R.scale(Z,Z);P=null!=(ba=M.rotation)?ba:0;M.rotateClockwise&&(P=-P);this._mapRotation&&(P+=this._mapRotation);P&&R.rotate(P*n);ba=null!=(X=M.offsetX)?X:0;X=null!=(S=M.offsetY)?S:0;if(ba||X)this._mapRotation&&(P=n*this._mapRotation,S=Math.cos(P),P=Math.sin(P),
Z=ba*P+X*S,ba=ba*S-X*P,X=Z),R.translate(ba,X);S=this.geomUnitsPerPoint();1!==S&&R.scale(S,S);(S=N.getAngle())&&R.rotate(S);R.translate(N.tx,N.ty);this.push(R,M.scaleSymbolsProportionally);for(const ta of W)if(ta&&ta.symbol&&ta.geometry||B.error("Invalid marker graphic",ta),this.drawSymbol(ta.symbol,ta.geometry),this._earlyReturn)break;this.pop()}}};H.drawTextSymbol=function(M,N){var P,ba,X,S;if(M&&m.isPoint(N)&&!(0>=(null!=(P=M.height)?P:10))){P=A.createIdentity();var W=null!=(ba=M.angle)?ba:0;(W=
-W)&&P.rotate(W*n);ba=null!=(X=M.offsetX)?X:0;X=null!=(S=M.offsetY)?S:0;(ba||X)&&P.translate(ba,X);S=this.geomUnitsPerPoint();1!==S&&P.scale(S,S);P.translate(N.x,N.y);this.push(P,!1);this.drawText(M);this.pop()}};H._buildHatchPolyline=function(M,N,P){var ba=(void 0!==M.separation?M.separation:4)*P,X=void 0!==M.rotation?M.rotation:0;if(0===ba)return null;0>ba&&(ba=-ba);for(var S=0,W=.5*ba;S>W;)S-=ba;for(;S<-W;)S+=ba;S=f.create();k.getBoundsXY(S,N);S[0]-=W;S[1]-=W;S[2]+=W;S[3]+=W;for(var R=[[S[0],S[1]],
[S[0],S[3]],[S[2],S[3]],[S[2],S[1]]];180<X;)X-=180;for(;0>X;)X+=180;W=Math.cos(X*n);var Z=Math.sin(X*n);X=-ba*Z;N=ba*W;S=(void 0!==M.offsetX?M.offsetX*P:0)*Z-(void 0!==M.offsetY?M.offsetY*P:0)*W;let ka;var ta=M=Number.MAX_VALUE;ka=P=-Number.MAX_VALUE;for(var pa of R){var wa=pa[0];const Ba=pa[1];R=W*wa+Z*Ba;wa=-Z*wa+W*Ba;ta=Math.min(ta,R);M=Math.min(M,wa);ka=Math.max(ka,R);P=Math.max(P,wa)}M=Math.floor(M/ba)*ba;pa=W*ta-Z*M-X*S/ba;ta=Z*ta+W*M-N*S/ba;R=W*ka-Z*M-X*S/ba;S=Z*ka+W*M-N*S/ba;ba=1+Math.round((P-
M)/ba);W=[];for(Z=0;Z<ba;Z++)pa+=X,ta+=N,R+=X,S+=N,W.push([[pa,ta],[R,S]]);return{paths:W}};return I}();let w=function(I){function H(N,P){N=I.call(this,N,P)||this;N.reset();return N}u._inheritsLoose(H,I);var M=H.prototype;M.reset=function(){this._xmin=this._ymin=Infinity;this._xmax=this._ymax=-Infinity;this._clipCount=0};M.envelope=function(){return new b(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)};M.bounds=function(){return f.fromValues(this._xmin,this._ymin,this._xmax,this._ymax)};
M.drawSolidFill=function(N){!N||0<this._clipCount||(m.isPolygon(N)?this._processPath(N.rings,0):m.isPolyline(N)?this._processPath(N.paths,0):m.isExtent(N)?(N=F(N))&&this._processPath(N.rings,0):console.error("drawSolidFill Unexpected geometry type!"))};M.drawSolidStroke=function(N,P,ba){!N||0<this._clipCount||(P=.5*this.transformSize(ba),m.isPolygon(N)?this._processPath(N.rings,P):m.isPolyline(N)?this._processPath(N.paths,P):m.isExtent(N)?(N=F(N))&&this._processPath(N.rings,P):console.error("drawSolidStroke unexpected geometry type!"))};
M.pushClipPath=function(N){this.drawSolidFill(N);++this._clipCount};M.popClipPath=function(){--this._clipCount};M.drawImage=function(N,P,ba){let X=ba*P,S=P;N=this._resourceManager.getResource(N);!P&&v.isSome(N)&&(X=ba*N.width,S=N.height);this._merge(this.transformPt([-X/2,-S/2]),0);this._merge(this.transformPt([-X/2,S/2]),0);this._merge(this.transformPt([X/2,-S/2]),0);this._merge(this.transformPt([X/2,S/2]),0)};M.drawText=function(N){this._textRasterizer||(this._textRasterizer=new h)};M._processPath=
function(N,P){if(N)for(const ba of N)if(N=ba?ba.length:0,1<N){this._merge(this.transformPt(ba[0]),P);for(let X=1;X<N;++X)this._merge(this.transformPt(ba[X]),P)}};M._merge=function(N,P){N[0]-P<this._xmin&&(this._xmin=N[0]-P);N[0]+P>this._xmax&&(this._xmax=N[0]+P);N[1]-P<this._ymin&&(this._ymin=N[1]-P);N[1]+P>this._ymax&&(this._ymax=N[1]+P)};return H}(C),y=function(I){function H(){var N=I.apply(this,arguments)||this;N._searchPoint=[0,0];N._searchDistPoint=0;return N}u._inheritsLoose(H,I);var M=H.prototype;
M.hitTest=function(N,P,ba,X,S,W){W*=x.pt2px(1);this.setTransform();this.setGeomUnitsPerPoint(W);this._searchPoint=[(N[0]+N[2])/2,(N[1]+N[3])/2];this._searchDistPoint=(N[2]-N[0])/2/W;this._textInfo=X;this._mapRotation=P&&("CIMPointSymbol"===P.type&&"Map"!==P.angleAlignment||"CIMTextSymbol"===P.type)?S:0;this._earlyReturn=!1;this.drawSymbol(P,ba);return this._earlyReturn};M.drawSolidFill=function(N,P){this._hitTestFill(N)};M.drawHatchFill=function(N,P){this._hitTestFill(N)};M.drawPictureFill=function(N,
P){this._hitTestFill(N)};M.drawGradientFill=function(N,P){this._hitTestFill(N)};M.drawSolidStroke=function(N,P,ba,X,S,W){this._hitTestStroke(N,ba)};M.drawPictureStroke=function(N,P){this._hitTestStroke(N,P.width)};M.drawGradientStroke=function(N,P){this._hitTestStroke(N,P.width)};M.drawMarkerLayer=function(N,P){N.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===N.markerPlacement.type?this._hitTestFill(P):I.prototype.drawMarkerLayer.call(this,N,P)};M.pushClipPath=function(N){};M.popClipPath=function(){};
M.drawImage=function(N,P,ba){N=this._resourceManager.getResource(N);if(!v.isNone(N)&&0!==N.height&&0!==P){P*=this.geomUnitsPerPoint();ba=N.width/N.height*ba*P;N=this.reverseTransformPt(this._searchPoint);var X=this._searchDistPoint;Math.abs(N[0])<ba/2+X&&Math.abs(N[1])<P/2+X&&(this._earlyReturn=!0)}};M.drawText=function(N){var P,ba,X=this._textInfo;if(X&&(X=X.get(N))){var {text:S,mosaicItem:W}=X;if(W&&0!==W.glyphMosaicItems.length){X=null!=(P=N.height)?P:10;P=J(N.lineGapType,null!=(ba=N.lineGap)?
ba:0,X);ba=E.bidiText(S)[1];N=q.shapeGlyphs(W.glyphMosaicItems,ba,{scale:X/d.GLYPH_SIZE,angle:0,xOffset:0,yOffset:0,hAlign:G(N.horizontalAlignment),vAlign:K(N.verticalAlignment),maxLineWidth:512,lineHeight:d.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(P||1,4)),decoration:N.font.decoration||"none",isCIM:!0});P=this.reverseTransformPt(this._searchPoint);ba=P[0];P=P[1];for(const R of N.glyphs)if(ba>R.xTopLeft&&ba<R.xBottomRight&&P>-R.yBottomRight&&P<-R.yTopLeft){this._earlyReturn=!0;break}}}};M._hitTestFill=
function(N){let P=null;if(m.isExtent(N))P=[[[N.xmin,N.ymin],[N.xmin,N.ymax],[N.xmax,N.ymax],[N.xmax,N.ymin],[N.xmin,N.ymin]]];else if(m.isPolygon(N))P=N.rings;else if(m.isPolyline(N))P=N.paths;else return;N=this.reverseTransformPt(this._searchPoint);this._pointInPolygon(N,P)&&(this._earlyReturn=!0);if(!this._earlyReturn){const ba=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(N,P,ba)&&(this._earlyReturn=!0)}};M._hitTestStroke=function(N,P){let ba=null;if(m.isExtent(N))ba=
[[[N.xmin,N.ymin],[N.xmin,N.ymax],[N.xmax,N.ymax],[N.xmax,N.ymin],[N.xmin,N.ymin]]];else if(m.isPolygon(N))ba=N.rings;else if(m.isPolyline(N))ba=N.paths;else return;N=this.reverseTransformPt(this._searchPoint);P*=this.geomUnitsPerPoint();const X=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(N,ba,P/2+X)&&(this._earlyReturn=!0)};M._pointInPolygon=function(N,P){let ba=0;for(const X of P){P=X.length;for(let S=1;S<P;++S){const W=X[S-1],R=X[S];W[1]>N[1]!==R[1]>
N[1]&&(0<(R[0]-W[0])*(N[1]-W[1])-(R[1]-W[1])*(N[0]-W[0])?ba++:ba--)}}return 0!==ba};M._nearLine=function(N,P,ba){for(const S of P){P=S.length;for(let W=1;W<P;++W){var X=S[W-1];const R=S[W];let Z=(R[0]-X[0])*(R[0]-X[0])+(R[1]-X[1])*(R[1]-X[1]);if(0!==Z&&(Z=Math.sqrt(Z),Math.abs(((R[0]-X[0])*(N[1]-X[1])-(R[1]-X[1])*(N[0]-X[0]))/Z)<ba&&(X=((R[0]-X[0])*(N[0]-X[0])+(R[1]-X[1])*(N[1]-X[1]))/Z,X>-ba&&X<Z+ba)))return!0}}return!1};return H}(C),D=function(I){function H(N,P,ba){P=I.call(this,P,ba)||this;P._ctx=
N;return P}u._inheritsLoose(H,I);var M=H.prototype;M.drawSolidFill=function(N,P){if(N){if(m.isPolygon(N))this._buildPath(N.rings,!0);else if(m.isPolyline(N))this._buildPath(N.paths,!0);else if(m.isExtent(N))this._buildPath(F(N).rings,!0);else if(m.isMultipoint(N))console.log("CanvasDrawHelper.drawSolidFill - No implementation!");else return;N=this._ctx;N.fillStyle="string"===typeof P?P:"rgba("+Math.round(P[0])+","+Math.round(P[1])+","+Math.round(P[2])+","+P[3]/255+")";N.fill("evenodd")}};M.drawSolidStroke=
function(N,P,ba,X,S,W){if(N&&P&&0!==ba){if(m.isPolygon(N))this._buildPath(N.rings,!0);else if(m.isPolyline(N))this._buildPath(N.paths,!1);else if(m.isExtent(N))this._buildPath(F(N).rings,!0);else{console.log("CanvasDrawHelper.drawSolidStroke isn't implemented!");return}N=this._ctx;N.strokeStyle="string"===typeof P?P:"rgba("+Math.round(P[0])+","+Math.round(P[1])+","+Math.round(P[2])+","+P[3]/255+")";N.lineWidth=this.transformSize(ba)+.5;this._setCapStyle(X);this._setJoinStyle(S);N.miterLimit=W;N.stroke()}};
M.pushClipPath=function(N){this._ctx.save();if(m.isPolygon(N))this._buildPath(N.rings,!0);else if(m.isPolyline(N))this._buildPath(N.paths,!0);else if(m.isExtent(N))this._buildPath(F(N).rings,!0);else return;this._ctx.clip("evenodd")};M.popClipPath=function(){this._ctx.restore()};M.drawImage=function(N,P,ba){N=this._resourceManager.getResource(N);if(!v.isNone(N)){var X=this._ctx,S=X.canvas.width;X=X.canvas.height;var W=N.width/N.height*ba*P,R=ba*P;P||(W=ba*N.width,R=ba*N.height);P=this.transformPt([0,
0]);ba=this.transformSize(W);R=this.transformSize(R);this._ctx.drawImage(N,0,0,N.width,N.height,P[0]-ba/2,P[1]-R/2,Math.min(ba,S),Math.min(R,X))}};M.drawText=function(N){this._textRasterizer||(this._textRasterizer=new h)};M._buildPath=function(N,P){const ba=this._ctx;ba.beginPath();if(N)for(const X of N)if(N=X?X.length:0,1<N){let S=this.transformPt(X[0]);ba.moveTo(S[0],S[1]);for(let W=1;W<N;++W)S=this.transformPt(X[W]),ba.lineTo(S[0],S[1]);P&&ba.closePath()}};M._setCapStyle=function(N){switch(N){case a.LineCapStyle.Butt:this._ctx.lineCap=
"butt";break;case a.LineCapStyle.Round:this._ctx.lineCap="round";break;case a.LineCapStyle.Square:this._ctx.lineCap="square"}};M._setJoinStyle=function(N){switch(N){case a.LineJoinStyle.Bevel:this._ctx.lineJoin="bevel";break;case a.LineJoinStyle.Round:this._ctx.lineJoin="round";break;case a.LineJoinStyle.Miter:this._ctx.lineJoin="miter"}};return H}(C);const F=I=>I?{spatialReference:I.spatialReference,rings:[[[I.xmin,I.ymin],[I.xmin,I.ymax],[I.xmax,I.ymax],[I.xmax,I.ymin],[I.xmin,I.ymin]]]}:null,G=
I=>{switch(I){case "Left":return l.HAlign.Left;case "Right":return l.HAlign.Right;case "Center":return l.HAlign.Center;case "Justify":return B.warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),l.HAlign.Center}},K=I=>{switch(I){case "Top":return l.VAlign.Top;case "Center":return l.VAlign.Center;case "Bottom":return l.VAlign.Bottom;case "Baseline":return l.VAlign.Baseline}},J=(I,H,M)=>{switch(I){case "ExtraLeading":return 1+H/M;case "Multiple":return H;case "Exact":return H/
M}};r.CIMSymbolDrawHelper=C;r.C_DEG_TO_RAD=n;r.CanvasDrawHelper=D;r.EnvDrawHelper=w;r.HittestDrawHelper=y;r.Transformation=A;r.horizontalAlignment2HAlign=G;r.lineGapType2LineHeight=J;r.verticalAlignment2VAlign=K;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMResourceManager":function(){define(["../../chunks/_rollupPluginBabelHelpers","../../request","../../core/Error","../../core/promiseUtils"],function(r,u,E,C){function v(z,x){if(z.includes(";base64,")){const f=
new Image;f.src=z;return f.decode().then(()=>({ok:!0,value:f})).catch(k=>C.isAbortError(k)?{ok:!1,error:k}:{ok:!1,error:new E("invalid-resource",`Could not fetch requested resource at ${z}`)})}return u(z,{responseType:"image",...x}).then(f=>({ok:!0,value:f.data})).catch(f=>C.isAbortError(f)?{ok:!1,error:f}:{ok:!1,error:new E("invalid-resource",`Could not fetch requested resource at ${z}`)})}return function(){function z(){this._resourceMap=new Map;this._inFlightResourceMap=new Map;this.geometryEngine=
null}var x=z.prototype;x.destroy=function(){this._inFlightResourceMap.clear();this._resourceMap.clear()};x.getResource=function(f){var k;return null!=(k=this._resourceMap.get(f))?k:null};x.fetchResource=function(){var f=r._asyncToGenerator(function*(k,g){const m={width:0,height:0},p=this._resourceMap;var t=p.get(k);if(t)return m.width=t.width,m.height=t.height,m;if(t=this._inFlightResourceMap.get(k))return t;t=v(k,g);this._inFlightResourceMap.set(k,t);return t=t.then(e=>{this._inFlightResourceMap.delete(k);
e.ok&&(p.set(k,e.value),e=e.value,m.width=e.width,m.height=e.height);return m})});return function(k,g){return f.apply(this,arguments)}}();x.deleteResource=function(f){this._inFlightResourceMap.delete(f);this._resourceMap.delete(f)};return z}()})},"esri/symbols/cim/Rect":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(r){return function(){function u(E=0,C=0,v=0,z=0){this.x=E;this.y=C;this.width=v;this.height=z}u.prototype.union=function(E){this.x=Math.min(this.x,E.x);this.y=Math.min(this.y,
E.y);this.width=Math.max(this.width,E.width);this.height=Math.max(this.height,E.height)};r._createClass(u,[{key:"isEmpty",get:function(){return 0>=this.width||0>=this.height}}]);return u}()})},"esri/symbols/cim/TextRasterizer":function(){define(["../../core/screenUtils"],function(r){let u=function(){function C(){}var v=C.prototype;v.rasterizeText=function(z,x){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));var f=this._textRasterizationCanvas,k=f.getContext("2d");
this._setFontProperties(k,x);this.parameters=x;this.textLines=z.split(/\r?\n/);this.lineHeight=this._computeLineHeight();z=this._computeTextWidth(k,x);const {decoration:g,weight:m}=x.font;this.lineThroughWidthOffset=g&&"line-through"===g?.1*this.lineHeight:0;var p=this.lineHeight*this.textLines.length;f.width=z+2*this.lineThroughWidthOffset;f.height=p;this.renderedLineHeight=Math.round(this.lineHeight*x.pixelRatio);this.renderedHaloSize=x.halo.size*x.pixelRatio;this.renderedWidth=z*x.pixelRatio;this.renderedHeight=
p*x.pixelRatio;this.lineThroughWidthOffset*=x.pixelRatio;f=x.color;this.fillStyle=`rgba(${f.slice(0,3).toString()},${f[3]})`;this.haloStyle=`rgb(${x.halo.color.slice(0,3).toString()})`;f=this.renderedLineHeight;z=this.renderedHaloSize;this._setFontProperties(k,x);p=k.textAlign;var t=this.renderedWidth;p=("center"===p?.5*t:"right"===p?t:0)+z;t=this.lineThroughWidthOffset;let e=0;0<z&&this._renderHalo(k,p,z,t,e,x);e+=z;t+=p;for(var c of this.textLines)k.globalCompositeOperation="destination-out",k.fillStyle=
"rgb(0, 0, 0)",k.fillText(c,t,e),k.globalCompositeOperation="source-over",k.fillStyle=this.fillStyle,k.fillText(c,t,e),g&&"none"!==g&&this._renderDecoration(k,t,e,g,m),e+=f;c=this.renderedWidth+2*this.lineThroughWidthOffset;f=this.renderedHeight;k=k.getImageData(0,0,c,f);k=new Uint8Array(k.data);if(x.premultiplyColors)for(z=0;z<k.length;z+=4)x=k[z+3]/255,k[z]*=x,k[z+1]*=x,k[z+2]*=x;return{size:[c,f],image:new Uint32Array(k.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};v._renderHalo=function(z,
x,f,k,g,m){const p=this.renderedWidth,t=this.renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas"));this._haloRasterizationCanvas.width=p;this._haloRasterizationCanvas.height=t;const e=this._haloRasterizationCanvas,c=e.getContext("2d");c.clearRect(0,0,p,t);this._setFontProperties(c,m);const {decoration:a,weight:b}=m.font;c.fillStyle=this.haloStyle;c.strokeStyle=this.haloStyle;m=3>this.renderedHaloSize;c.lineJoin=m?"miter":"round";m?this._renderHaloEmulated(c,
x,f,a,b):this._renderHaloNative(c,x,f,a,b);z.globalAlpha=this.parameters.halo.color[3];z.drawImage(e,0,0,p,t,k,g,p,t);z.globalAlpha=1};v._renderHaloEmulated=function(z,x,f,k,g){const m=this.renderedLineHeight,p=this.renderedHaloSize;for(const t of this.textLines){for(const [e,c]of E)z.fillText(t,x+p*e,f+p*c);k&&"none"!==k&&this._renderDecoration(z,x,f,k,g);f+=m}};v._renderHaloNative=function(z,x,f,k,g){const m=this.renderedLineHeight,p=this.renderedHaloSize;for(const t of this.textLines){const e=
2*p;for(let c=0;5>c;c++)z.lineWidth=(.6+.1*c)*e,z.strokeText(t,x,f),k&&"none"!==k&&this._renderDecoration(z,x,f,k,g);f+=m}};v._setFontProperties=function(z,x){var f=x.font;f=`${f.style} ${f.weight} ${r.pt2px(x.size*x.pixelRatio)}px ${f.family}, sans-serif`;z.font=f;z.textBaseline="top";switch(x.horizontalAlignment){case "left":x="left";break;case "right":x="right";break;case "center":x="center";break;default:x="left"}z.textAlign=x};v.computeTextSize=function(z,x){this._textRasterizationCanvas||(this._textRasterizationCanvas=
document.createElement("canvas"));const f=this._textRasterizationCanvas;var k=f.getContext("2d");this._setFontProperties(k,x);this.parameters=x;this.textLines=z.split(/\r?\n/);this.lineHeight=this._computeLineHeight();z=this._computeTextWidth(k,x);k=this.lineHeight*this.textLines.length;f.width=z;f.height=k;return[z*x.pixelRatio,k*x.pixelRatio]};v._computeTextWidth=function(z,x){let f=0;for(const k of this.textLines)f=Math.max(f,z.measureText(k).width);x=x.font;if("italic"===x.style||"oblique"===
x.style||"string"===typeof x.weight&&("bold"===x.weight||"bolder"===x.weight)||"number"===typeof x.weight&&600<x.weight)f+=.3*z.measureText("w").width;f+=2*this.parameters.halo.size;return Math.round(f)};v._computeLineHeight=function(){let z=1.275*this.parameters.size;const x=this.parameters.font.decoration;x&&"underline"===x&&(z*=1.3);return Math.round(z+2*this.parameters.halo.size)};v._renderDecoration=function(z,x,f,k,g){const m=.9*this.lineHeight;g="bold"===g?.06:"bolder"===g?.09:.04;switch(z.textAlign){case "center":x-=
this.renderedWidth/2;break;case "right":x-=this.renderedWidth}const p=z.textBaseline;if("underline"===k)switch(p){case "top":f+=m;break;case "middle":f+=m/2}else if("line-through"===k)switch(p){case "top":f+=m/1.5;break;case "middle":f+=m/3}z.save();z.beginPath();z.strokeStyle=z.fillStyle;z.lineWidth=Math.ceil(m*g);z.moveTo(x-this.lineThroughWidthOffset,f);z.lineTo(x+this.renderedWidth+2*this.lineThroughWidthOffset,f);z.stroke();z.restore()};return C}();const E=[];for(let C=0;360>C;C+=22.5)E.push([Math.cos(Math.PI*
C/180),Math.sin(Math.PI*C/180)]);return u})},"esri/symbols/cim/utils":function(){define(["require","exports"],function(r,u){function E(C,v){"string"!==typeof C&&(C=String(C));switch(v){case "LowerCase":return C.toLowerCase();case "Allcaps":return C.toUpperCase();default:return C}}u._adjustTextCase=E;u.colorToArray=function(C){return[C.r,C.g,C.b,C.a]};u.createLabelOverrideFunction=function(C,v,z){const x=m=>{let p=m.length;for(;p--;)if(!" /-,\n".includes(m.charAt(p)))return!1;return!0},f=[];var k=
0;let g=-1;do g=v.indexOf("[",k),g>=k&&(g>k&&(k=v.substr(k,g-k),f.push([k,null,x(k)])),k=g+1,g=v.indexOf("]",k),g>=k&&(g>k&&(k=v.substr(k,g-k),(k=C[k])&&f.push([null,k,!1])),k=g+1));while(-1!==g);k<v.length-1&&(C=v.substr(k),f.push([C,null,x(C)]));return m=>{let p="",t=null;for(const e of f){const [c,a,b]=e;if(c)b?t=c:(t&&(p+=t,t=null),p+=c);else{const h=m.attributes[a];h&&(t&&(p+=t,t=null),p+=h)}}return E(p,z)}};u.evaluateValueOrFunction=function(C,v,z,x){return"function"===typeof C?C(v,z,x):C};
u.fromCIMColor=function(C){return C?{r:C[0],g:C[1],b:C[2],a:C[3]/255}:{r:0,g:0,b:0,a:0}};u.getValue=C=>isNaN(C)||!C?0:C;u.importGeometryEngine=function(){return new Promise((C,v)=>r(["../../geometry/geometryEngineJSON"],C,v))};u.isCIMFill=function(C){return"CIMGradientFill"===C.type||"CIMHatchFill"===C.type||"CIMPictureFill"===C.type||"CIMSolidFill"===C.type||"CIMWaterFill"===C.type};u.isCIMMarker=function(C){return"CIMVectorMarker"===C.type||"CIMPictureMarker"===C.type||"CIMBarChartMarker"===C.type||
"CIMCharacterMarker"===C.type||"CIMPieChartMarker"===C.type||"CIMStackedBarChartMarker"===C.type};u.isCIMMarkerStrokePlacement=function(C){return"CIMMarkerPlacementAlongLineRandomSize"===C.type||"CIMMarkerPlacementAlongLineSameSize"===C.type||"CIMMarkerPlacementAlongLineVariableSize"===C.type||"CIMMarkerPlacementAtExtremities"===C.type||"CIMMarkerPlacementAtMeasuredUnits"===C.type||"CIMMarkerPlacementAtRatioPositions"===C.type||"CIMMarkerPlacementOnLine"===C.type||"CIMMarkerPlacementOnVertices"===
C.type};u.isCIMStroke=function(C){return"CIMGradientStroke"===C.type||"CIMPictureStroke"===C.type||"CIMSolidStroke"===C.type};u.isGeometryEngineRequired=C=>{if(!C)return!1;for(const v of C)switch(v.type){case "CIMGeometricEffectBuffer":case "CIMGeometricEffectOffset":return!0}return!1};u.resampleHermite=function(C,v,z,x,f,k,g=!0){const m=v/f;z/=k;const p=Math.ceil(m/2),t=Math.ceil(z/2);for(let a=0;a<k;a++)for(let b=0;b<f;b++){const h=4*(b+(g?k-a-1:a)*f);var e=0;let l=0,d=0,q=0,n=0,B=0,A=0;const w=
(a+.5)*z;for(let y=Math.floor(a*z);y<(a+1)*z;y++){var c=Math.abs(w-(y+.5))/t;const D=(b+.5)*m;c*=c;for(let F=Math.floor(b*m);F<(b+1)*m;F++){let G=Math.abs(D-(F+.5))/p;e=Math.sqrt(c+G*G);-1<=e&&1>=e&&(e=2*e*e*e-3*e*e+1,0<e&&(G=4*(F+y*v),A+=e*C[G+3],d+=e,255>C[G+3]&&(e=e*C[G+3]/250),q+=e*C[G],n+=e*C[G+1],B+=e*C[G+2],l+=e))}}x[h]=q/l;x[h+1]=n/l;x[h+2]=B/l;x[h+3]=A/d}};u.toCIMSymbolJSON=function(C){var v;return null==(v=C.data)?void 0:v.symbol};Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/symbols/cim/SDFHelper":function(){define(["exports","../../core/floatRGBA","../../geometry/support/jsonUtils","./Rect"],function(r,u,E,C){function v(x){if(!x)return null;switch(x.type){case "CIMPointSymbol":var f=x.symbolLayers;if(!f||1!==f.length)break;return v(f[0]);case "CIMVectorMarker":x=x.markerGraphics;if(!x||1!==x.length)break;var k=x[0];if(!k)break;x=k.geometry;if(!x)break;k=k.symbol;if(!k||"CIMPolygonSymbol"!==k.type&&"CIMLineSymbol"!==k.type||null!=(f=k.symbolLayers)&&f.some(g=>!!g.effects))break;
return{geom:x,asFill:"CIMPolygonSymbol"===k.type};case "sdf":return{geom:x.geom,asFill:x.asFill}}return null}function z(x){let f=Infinity,k=-Infinity,g=Infinity,m=-Infinity;for(const p of x)for(const t of p)t[0]<f&&(f=t[0]),t[0]>k&&(k=t[0]),t[1]<g&&(g=t[1]),t[1]>m&&(m=t[1]);return[f,g,k,m]}r.buildSDF=function(x){var f=x.geom;var k=f?f.rings?f.rings:f.paths?f.paths:void 0!==f.xmin&&void 0!==f.ymin&&void 0!==f.xmax&&void 0!==f.ymax?[[[f.xmin,f.ymin],[f.xmin,f.ymax],[f.xmax,f.ymax],[f.xmax,f.ymin],[f.xmin,
f.ymin]]]:null:null;f=Infinity;var g=-Infinity;var m=Infinity,p=-Infinity;for(var t of k)for(var e of t)e[0]<f&&(f=e[0]),e[0]>g&&(g=e[0]),e[1]<m&&(m=e[1]),e[1]>p&&(p=e[1]);g=new C(f,m,g-f,p-m);m=64/Math.max(g.width,g.height);t=Math.round(g.width*m)+62;e=Math.round(g.height*m)+62;f=[];for(var c of k)if(c&&1<c.length){k=[];for(var a of c){let [y,D]=a;y-=g.x;D-=g.y;y*=m;D*=m;y+=30.5;D+=30.5;x.asFill?k.push([y,D]):k.push([Math.round(y),Math.round(D)])}x.asFill&&(p=k.length-1,k[0][0]===k[p][0]&&k[0][1]===
k[p][1]||k.push(k[0]));f.push(k)}var b;c=t*e;a=Array(c);for(k=0;k<c;++k)a[k]=962;for(b of f)for(k=b.length,g=1;g<k;++g){m=b[g-1];p=b[g];var h=void 0,l=void 0;m[0]<p[0]?(h=m[0],l=p[0]):(h=p[0],l=m[0]);var d=void 0,q=void 0;m[1]<p[1]?(d=m[1],q=p[1]):(d=p[1],q=m[1]);var n=Math.floor(h)-31;l=Math.floor(l)+31;d=Math.floor(d)-31;q=Math.floor(q)+31;0>n&&(n=0);l>t&&(l=t);0>d&&(d=0);q>e&&(q=e);h=p[0]-m[0];const y=p[1]-m[1],D=h*h+y*y;for(;n<l;n++)for(let F=d;F<q;F++){var B=(n-m[0])*h+(F-m[1])*y,A=void 0;0>
B?(A=m[0],B=m[1]):B>D?(A=p[0],B=p[1]):(B/=D,A=m[0]+B*h,B=m[1]+B*y);A=(n-A)*(n-A)+(F-B)*(F-B);B=(e-F-1)*t+n;A<a[B]&&(a[B]=A)}}for(b=0;b<c;++b)a[b]=Math.sqrt(a[b]);b=a;if(x.asFill)for(var w of f)for(x=w.length,f=1;f<x;++f)for(c=w[f-1],a=w[f],c[0]<a[0]?(k=c[0],g=a[0]):(k=a[0],g=c[0]),c[1]<a[1]?(p=c[1],m=a[1]):(p=a[1],m=c[1]),k=Math.floor(k),g=Math.floor(g)+1,p=Math.floor(p),m=Math.floor(m)+1,31>k&&(k=31),g>t-31&&(g=t-31),31>p&&(p=31),m>e-31&&(m=e-31);p<m;++p)if(c[1]>p!==a[1]>p){l=(e-p-1)*t;for(d=k;d<
g;++d)d<(a[0]-c[0])*(p-c[1])/(a[1]-c[1])+c[0]&&(b[l+d]=-b[l+d]);for(d=31;d<k;++d)b[l+d]=-b[l+d]}w=b.length;x=new Uint8Array(4*w);for(f=0;f<w;++f)u.packFloatRGBA(.5-b[f]/62,x,4*f);w=x;return[w,t,e]};r.getExtent=function(x){return x?x.rings?z(x.rings):x.paths?z(x.paths):E.isExtent(x)?[x.xmin,x.ymin,x.xmax,x.ymax]:null:null};r.getSDFInfo=v;r.getSDFMetrics=function(x,f,k,g,m){const [p,t,e,c]=x;if(e<p||c<t)return[0,0,0];var a=e-p,b=c-t;x=64/Math.max(a,b);a=Math.round(a*x);b=Math.round(b*x)+62;let h=1;
f&&(h=b/x/(f.ymax-f.ymin));let l=0,d=0;g&&(m?f&&k&&0<f.ymax-f.ymin&&(l=g.x/((f.xmax-f.xmin)/(f.ymax-f.ymin)*k),d=g.y/k):(l=g.x,d=g.y));l=.5*(f.xmax+f.xmin)+l*(f.xmax-f.xmin);d=.5*(f.ymax+f.ymin)+d*(f.ymax-f.ymin);l=(l-p)*x+31;d=(d-t)*x+31;return[h,l/(a+62)-.5,-(d/b-.5)]};r.getSDFSymbol=function(x){x=x.markerGraphics;if(!x||1!==x.length)return null;x=x[0];if(!x)return null;x=x.symbol;return!x||"CIMPolygonSymbol"!==x.type&&"CIMLineSymbol"!==x.type?null:x};Object.defineProperties(r,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/arcade/callExpressionWithFeature":function(){define(["../../../core/Error","../../../core/Logger","../../../geometry/support/quantizationUtils"],function(r,u,E){function C(z){const x={};switch(z){case "esriGeometryPoint":return(f,k,g,m)=>E.unquantizePoint(k,x,f,g,m);case "esriGeometryPolygon":return(f,k,g,m)=>E.unquantizePolygon(k,x,f,g,m);case "esriGeometryPolyline":return(f,k,g,m)=>E.unquantizePolyline(k,x,f,g,m);case "esriGeometryMultipoint":return(f,
k,g,m)=>E.unquantizeMultipoint(k,x,f,g,m);default:return u.getLogger("esri.views.2d.support.arcadeOnDemand").error(new r("mapview-arcade",`Unable to handle geometryType: ${z}`)),f=>f}}const v=new Map;return function(z,x,f,k,g){if(z.referencesGeometry()&&g){{const {transform:m,hasZ:p,hasM:t}=g;v.has(k)||v.set(k,C(k));k=v.get(k)(x.geometry,m,p,t);x={...x,geometry:k}}}x=z.repurposeFeature(x);try{return z.evaluate({...f,$feature:x})}catch(m){return u.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",
m),null}}})},"esri/views/2d/engine/webgl/fontUtils":function(){define(["exports"],function(r){function u(E){E=E.toLowerCase().split(" ").join("-");switch(E){case "serif":return"noto-serif";case "sans-serif":return"arial-unicode-ms";case "monospace":return"ubuntu-mono";case "fantasy":return"cabin-sketch";case "cursive":return"redressed";default:return E}}r.getFontDecorationTop=function(E){switch(E){case "underline":return-26;case "line-through":return-18}return NaN};r.getFontFamily=u;r.getFullyQualifiedFontName=
function(E){a:{if(E.weight)switch(E.weight.toLowerCase()){case "bold":case "bolder":var C="-bold";break a}C=""}a:{if(E.style)switch(E.style.toLowerCase()){case "italic":case "oblique":var v="-italic";break a}v=""}C+=v;return u(E.family)+(0<C.length?C:"-regular")};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/grouping":function(){define(["exports","../../../../core/string"],function(r,u){function E(C,v){if("string"===typeof C)C=
u.numericHash(C+`-seed(${v})`);else{let z=12;C^=v;do C=107*(C>>8^C)+z|0;while(0!==--z)}return(1+C/-2147483648)/2}r.getMaterialGroup=function(C){return Math.floor(10*E(C,53290320))};r.getRandomValue=E;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/util/Result":function(){define(["exports","../../../../../core/Error"],function(r,u){r.ok=function(E,C){return E&&"name"in E?(C&&C.error(new u(E.name,E.message,E.details)),!1):!0};Object.defineProperties(r,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),function(r,u,E,C,v,z,x,f,k,g,m){return function(p){function t(e,c,a){var b=p.call(this,
e)||this;b._minMaxZoom=z.i1616to32(Math.round(c*v.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(a*v.MIN_MAX_ZOOM_PRECISION_FACTOR));b._cimLineLayer=e;let h=0;f.isFunction(e.width)||(h=.5*E.pt2px(e.width));b._dynamicPropertyMap.set("_halfWidth",(q,n,B)=>f.isFunction(e.width)?.5*E.pt2px(e.width(q,n,B)):h);f.isFunction(e.cap)?b._dynamicPropertyMap.set("_capType",e.cap):b._capType=e.cap;f.isFunction(e.join)?b._dynamicPropertyMap.set("_joinType",e.join):b._joinType=e.join;const l=e.color;f.isFunction(l)?b._dynamicPropertyMap.set("_fillColor",
(q,n,B)=>C.premultiplyAlphaRGBA(l(q,n,B))):b._fillColor=l&&C.premultiplyAlphaRGBA(l)||0;const d=e.miterLimit;f.isFunction(d)?b._dynamicPropertyMap.set("_miterLimitCosine",(q,n,B)=>f.getLimitCosine(d(q,n,B))):b._miterLimitCosine=f.getLimitCosine(d);u.isSome(e.effects)&&(c=e.effects,f.isFunction(c)?b._dynamicPropertyMap.set("_effects",c):b._effects=c);b._scaleFactor=e.scaleFactor||1;b._isDashed=null!=e.dashTemplate;b.tessellationProperties._bitset=(e.colorLocked?v.BITSET_GENERIC_LOCK_COLOR:0)|(e.scaleDash?
v.BITSET_LINE_SCALE_DASH:0)|(e.sampleAlphaOnly?v.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);b._materialKey=e.materialKey;b._initializeTessellator(!0);return b}r._inheritsLoose(t,p);t.fromCIMLine=function(e,c){const [a,b]=f.getMinMaxZoom(e.scaleInfo,c);return new t(e,a,b)};t.prototype.bindFeature=function(e,c,a){const b=e.readLegacyFeature();this._dynamicPropertyMap.forEach((l,d)=>{this[d]=l(b,c,a)});this._halfWidth*=this._scaleFactor;e=this._materialCache;var h=this._cimLineLayer.materialHash;h=h(b,c,
a);h=e.get(h);e=null;h&&m.ok(h.spriteMosaicItem)&&(e=h.spriteMosaicItem);if(e){this._hasPattern=!0;const {rect:l,width:d,height:q}=e;h=l.x+v.SPRITE_PADDING;const n=l.y+v.SPRITE_PADDING,B=h+d,A=n+q;this.tessellationProperties._tl=z.i1616to32(h,n);this.tessellationProperties._br=z.i1616to32(B,A)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties.offset=
0;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;h=x.LineMaterialKey.load(this._materialKey);e&&(h.sdf=e.sdf,h.pattern=!0,h.textureBinding=e.textureBinding);this._materialKey=h.data};return t}(k(g))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t,e,c,a){const b=x.create(),h=z.create(),l=E.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate");return function(d){function q(n,B,A){var w=d.call(this,n)||this;w._cimMarkerLayer=n;w._minMaxZoom=m.i1616to32(Math.round(B*g.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(A*g.MIN_MAX_ZOOM_PRECISION_FACTOR));const y=n.color;t.isFunction(y)?w._dynamicPropertyMap.set("_fillColor",(I,H,M)=>k.premultiplyAlphaRGBA(y(I,H,M))):w._fillColor=k.premultiplyAlphaRGBA(y);const D=
n.outlineColor;t.isFunction(D)?w._dynamicPropertyMap.set("_outlineColor",(I,H,M)=>k.premultiplyAlphaRGBA(D(I,H,M))):w._outlineColor=k.premultiplyAlphaRGBA(D);const F=n.size;t.isFunction(F)?w._dynamicPropertyMap.set("_size",(I,H,M)=>v.pt2px(F(I,H,M))):w._size=v.pt2px(F)||0;B=n.scaleX;t.isFunction(B)?w._dynamicPropertyMap.set("_scaleX",B):w._scaleX=B||1;const G=n.offsetX;t.isFunction(G)?w._dynamicPropertyMap.set("xOffset",(I,H,M)=>v.pt2px(G(I,H,M))):w.xOffset=v.pt2px(G)||0;const K=n.offsetY;t.isFunction(K)?
w._dynamicPropertyMap.set("yOffset",(I,H,M)=>v.pt2px(K(I,H,M))):w.yOffset=v.pt2px(K)||0;const J=n.outlineWidth;t.isFunction(J)?w._dynamicPropertyMap.set("_outlineWidth",(I,H,M)=>v.pt2px(J(I,H,M))):w._outlineWidth=v.pt2px(J)||0;B=n.rotation;t.isFunction(B)?w._dynamicPropertyMap.set("_angle",B):w._angle=B||0;C.isSome(n.effects)&&(B=n.effects,t.isFunction(B)?w._dynamicPropertyMap.set("_effects",B):w._effects=B);C.isSome(n.markerPlacement)&&(B=n.markerPlacement,t.isFunction(B)?w._dynamicPropertyMap.set("_markerPlacement",
B):w._markerPlacement=B);w._scaleFactor=C.unwrapOr(n.scaleFactor,1);w._bitSet=(n.alignment===f.Alignment.MAP?1:0)|(n.colorLocked?1:0)<<1|(n.scaleSymbolsProportionally?1:0)<<3;w._materialKey=n.materialKey;return w}r._inheritsLoose(q,d);q.fromCIMMarker=function(n,B){const [A,w]=t.getMinMaxZoom(n.scaleInfo,B);return new q(n,A,w)};q.prototype.bindFeature=function(n,B,A){const w=n.readLegacyFeature();n=n.getObjectId();this._dynamicPropertyMap.forEach((X,S)=>{this[S]=X(w,B,A)});var y=this._cimMarkerLayer.materialHash;
n="function"===typeof y?y(w,B,A,n):y;if((n=this._materialCache.get(n))&&a.ok(n.spriteMosaicItem)&&n.spriteMosaicItem){n=n.spriteMosaicItem;y=this._cimMarkerLayer.sizeRatio;var D=n.width/n.height*this._scaleX,F=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,G=this._size,K=G*D,J=this.xOffset,I=this.yOffset;this.xOffset*=this._scaleFactor;this.yOffset*=this._scaleFactor;var H=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/v.pt2px(this._cimMarkerLayer.frameHeight):
1,M=this._outlineWidth*H,N=v.pt2px(this._cimMarkerLayer.referenceSize),P=H=0,ba=this._cimMarkerLayer.anchorPoint;ba&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(H=-ba.x/(this._size*D),P=ba.y/this._size):(H=ba.x,P=ba.y));this._sizeOutlineWidth=m.i8888to32(Math.round(Math.min(Math.sqrt(128*K),255)),Math.round(Math.min(Math.sqrt(128*G),255)),Math.round(Math.min(Math.sqrt(128*M),255)),Math.round(Math.min(Math.sqrt(128*N),255)));this.angle=F;this._bitestAndDistRatio=m.i1616to32(this._bitSet,
Math.round(64*y));D=n.rect.x+g.SPRITE_PADDING;F=n.rect.y+g.SPRITE_PADDING;M=D+n.width;N=F+n.height;this._texUpperLeft=m.i1616to32(D,F);this._texUpperRight=m.i1616to32(M,F);this._texBottomLeft=m.i1616to32(D,N);this._texBottomRight=m.i1616to32(M,N);D=p.MarkerMaterialKey.load(this._materialKey);D.sdf=n.sdf;D.pattern=!0;D.textureBinding=n.textureBinding;this._materialKey=D.data;this._anchorX=.5-(.5+H)*n.width/n.width;this._anchorY=.5-(.5+P)*n.height/n.height;K=K*y*this._scaleFactor;G=G*y*this._scaleFactor;
K*=n.rect.width/n.width;G*=n.rect.height/n.height;this._computedWidth=K;this._computedHeight=G;this._applyTransformation(h,b);this.xOffset=J;this.yOffset=I}else l.error(new u("mapview-cim","Encountered an error when binding feature"))};return q}(e(c))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLDynamicMeshTemplate ../../../../layers/features/textUtils".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t){return function(e){function c(b,h,l){var d=e.call(this,b)||this;d._horizontalAlignment="center";d._verticalAlignment="middle";d._textToGlyphs=new Map;d._minMaxZoom=f.i1616to32(Math.round(h*x.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(l*x.MIN_MAX_ZOOM_PRECISION_FACTOR));h=b.scaleFactor||1;d._cimTextLayer=b;const q=b.color;g.isFunction(q)?d._dynamicPropertyMap.set("_color",(y,D,F)=>z.premultiplyAlphaRGBA(q(y,D,F))):d._color=z.premultiplyAlphaRGBA(q);const n=b.outlineColor;
g.isFunction(n)?d._dynamicPropertyMap.set("_haloColor",(y,D,F)=>z.premultiplyAlphaRGBA(n(y,D,F))):d._haloColor=z.premultiplyAlphaRGBA(n);let B;g.isFunction(b.size)||(B=Math.min(Math.round(E.pt2px(b.size*b.sizeRatio)),127));d._dynamicPropertyMap.set("_size",(y,D,F)=>g.isFunction(b.size)?Math.min(Math.round(E.pt2px(b.size(y,D,F)*b.sizeRatio)),127):B);g.isFunction(b.outlineSize)?d._dynamicPropertyMap.set("_haloSize",(y,D,F)=>Math.min(Math.floor(5*E.pt2px(b.outlineSize(y,D,F)*b.sizeRatio)),127)):d._haloSize=
Math.min(Math.floor(5*E.pt2px(b.outlineSize*b.sizeRatio)),127);let A;g.isFunction(b.offsetX)||(A=Math.round(E.pt2px(b.offsetX*b.sizeRatio)));d._dynamicPropertyMap.set("_xOffset",(y,D,F)=>g.isFunction(b.offsetX)?Math.round(E.pt2px(b.offsetX(y,D,F)*b.sizeRatio)):A);let w;g.isFunction(b.offsetY)||(w=Math.round(E.pt2px(b.offsetY*b.sizeRatio)));d._dynamicPropertyMap.set("_yOffset",(y,D,F)=>g.isFunction(b.offsetY)?Math.round(E.pt2px(b.offsetY(y,D,F)*b.sizeRatio)):w);g.isFunction(b.angle)?d._dynamicPropertyMap.set("_angle",
b.angle):d._angle=b.angle;g.isFunction(b.horizontalAlignment)?d._dynamicPropertyMap.set("_horizontalAlignment",b.horizontalAlignment):d._horizontalAlignment=b.horizontalAlignment;g.isFunction(b.verticalAlignment)?d._dynamicPropertyMap.set("_verticalAlignment",b.verticalAlignment):d._verticalAlignment=b.verticalAlignment;u.isSome(b.effects)&&(l=b.effects,g.isFunction(l)?d._dynamicPropertyMap.set("_effects",l):d._effects=l);u.isSome(b.markerPlacement)&&(l=b.markerPlacement,g.isFunction(l)?d._dynamicPropertyMap.set("_markerPlacement",
l):d._textPlacement=l);g.isFunction(b.text)?d._dynamicPropertyMap.set("_text",b.text):d._text=b.text;d._scaleFactor=h;h=Math.min(Math.round(E.pt2px(b.referenceSize*b.sizeRatio)),127);d._referenceSize=Math.round(Math.sqrt(256*h));d._materialKey=b.materialKey;h=k.TextMaterialKey.load(d._materialKey);h.sdf=!0;d._bitset=(b.alignment===C.Alignment.MAP?1:0)|(b.colorLocked?1:0)<<1;d._materialKey=h.data;d._decoration="none";d._lineHeight=1;d._lineWidth=512;d._isCIM=!0;return d}r._inheritsLoose(c,e);c.fromCIMText=
function(b,h){const [l,d]=g.getMinMaxZoom(b.scaleInfo,h);return new c(b,l,d)};var a=c.prototype;a.analyze=function(){var b=r._asyncToGenerator(function*(h,l,d,q){var n=l.readLegacyFeature();var B=this._cimTextLayer;n="string"===typeof B.text?B.text:"function"===typeof B.text?B.text(n,d,q):"";(h=yield e.prototype.analyze.call(this,h,l,d,q,t.codepoints(n)))&&h.glyphMosaicItems&&this._textToGlyphs.set(n,h.glyphMosaicItems);return h});return function(h,l,d,q){return b.apply(this,arguments)}}();a.bindFeature=
function(b,h,l){const d=b.readLegacyFeature();this._dynamicPropertyMap.forEach((q,n)=>{this[n]=q(d,h,l)});this._text&&0!==this._text.length?(this._size*=this._scaleFactor,this._scale=this._size/x.GLYPH_SIZE,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=v.getXAnchorDirection(u.unwrapOr(this._horizontalAlignment,"center")),this._yAlignD=v.getYAnchorDirection(u.unwrapOr(this._verticalAlignment,"baseline")),b=this._textToGlyphs.get(this._text),this.bindTextInfo(b,!1)):
this._shapingInfo=null};return c}(m(p))})},"esri/views/2d/layers/features/textUtils":function(){define(["exports"],function(r){r.codepoints=function(u){const E=Array(u.length);for(let C=0;C<u.length;C++)E[C]=u.charCodeAt(C);return E};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLMeshTemplate".split(" "),
function(r,u,E,C,v,z,x,f,k,g){return function(m){function p(t,e,c,a,b,h,l,d,q,n,B,A,w,y,D,F){var G=m.call(this)||this;G._effects=y;t=x.FillMaterialKey.load(t);e&&(t.sdf=e.sdf,t.pattern=!0,t.textureBinding=e.textureBinding);G.fillColor=c;G.tl=a;G.br=b;G.aux2_1=z.i1616to32(h,l);G.aux2_2=z.i1616to32(d,q);G.aux3=z.i8888to32(n,B,A,0);G._bitset=w;G._minMaxZoom=z.i1616to32(Math.round(D*C.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(F*C.MIN_MAX_ZOOM_PRECISION_FACTOR));G._materialKey=t.data;return G}r._inheritsLoose(p,
m);p.fromCIMFill=function(t,e,c){var a=t.color;a=a&&E.premultiplyAlphaRGBA(a)||0;const b=t.materialKey,[h,l]=f.getMinMaxZoom(t.scaleInfo,c);c=(t.colorLocked?C.BITSET_GENERIC_LOCK_COLOR:0)|(t.applyRandomOffset?C.BITSET_FILL_RANDOM_PATTERN_OFFSET:0)|(t.sampleAlphaOnly?C.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);if(!e)return new p(b,null,a,0,0,0,0,0,0,0,0,0,c,t.effects,h,l);const {rect:d,width:q,height:n}=e;var B=t.scaleX||1,A=d.x+C.SPRITE_PADDING;const w=d.y+C.SPRITE_PADDING;var y=A+q;const D=w+n;var F=
t.height;let G=Math.round(F);0>=G&&(G=D-w);B=Math.round(B*F);0>=B&&(B=y-A);F=u.pt2px(t.offsetX||0);const K=u.pt2px(-t.offsetY||0);A=z.i1616to32(A,w);y=z.i1616to32(y,D);return new p(b,e,a,A,y,B,G,F,K,128,128,v.degToByte(t.angle),c,t.effects,h,l)};p.fromSimpleFill=function(t,e,c=!1){var {color:a}=t;a=a&&"esriSFSNull"!==t.style&&E.premultiplyAlphaRGBAArray(a)||0;c=c?C.BITSET_GENERIC_LOCK_COLOR:0;const b=t.materialKey;if(e){const {rect:d,width:q,height:n}=e;var h=d.x+C.SPRITE_PADDING;const B=d.y+C.SPRITE_PADDING;
var l=h+q;const A=B+n;h=z.i1616to32(h,B);l=z.i1616to32(l,A);e=new p(b,e,a,h,l,q,n,0,0,128,128,0,c,null,f.DEFAULT_MIN_ZOOM,f.DEFAULT_MAX_ZOOM)}else e=new p(b,null,a,0,0,0,0,0,0,0,0,0,c,null,f.DEFAULT_MIN_ZOOM,f.DEFAULT_MAX_ZOOM);e._maybeAddLineTemplate(t);return e};p.fromPictureFill=function(t,e,c=!1){const a=C.PICTURE_FILL_COLOR,{rect:b,width:h,height:l}=e;var d=b.x+C.SPRITE_PADDING,q=b.y+C.SPRITE_PADDING,n=d+h,B=q+l;d=z.i1616to32(d,q);n=z.i1616to32(n,B);B=Math.round(u.pt2px(t.width));q=Math.round(u.pt2px(t.height));
const A=u.pt2px(t.xoffset),w=u.pt2px(-t.yoffset);e=new p(t.materialKey,e,a,d,n,B,q,A,w,128*t.xscale,128*t.yscale,0,c?C.BITSET_GENERIC_LOCK_COLOR:0,null,f.DEFAULT_MIN_ZOOM,f.DEFAULT_MAX_ZOOM);e._maybeAddLineTemplate(t);return e};return p}(k(g))})},"esri/views/2d/engine/webgl/util/Lock":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/promiseUtils"],function(r,u,E){function C(){C=u._asyncToGenerator(function*(z,x,f){try{yield z.acquire(),yield x(f),
z.release()}catch(k){throw z.release(),k;}});return C.apply(this,arguments)}let v=function(){function z(){this._resolver=null}var x=z.prototype;x.isHeld=function(){return!!this._resolver};x.acquire=function(){var f=u._asyncToGenerator(function*(){this._resolver?(yield this._resolver.promise,yield this.acquire()):this._resolver=E.createResolver()});return function(){return f.apply(this,arguments)}}();x.release=function(){const f=this._resolver;this._resolver=null;f.resolve()};return z}();r.Lock=v;
r.withLock=function(z,x,f){return C.apply(this,arguments)};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/support/cimSymbolUtils":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../symbols/cim/cimAnalyzer","../../../../symbols/cim/ExpandedCIM","./webStyleUtils"],function(r,u,E,C,v){const z=function(){var k=u._asyncToGenerator(function*(g,m,p,t){return Promise.all(g.map(e=>f(e,m,p,t)))});return function(g,
m,p,t){return k.apply(this,arguments)}}(),x=function(){var k=u._asyncToGenerator(function*(g,m,p){return new C.ExpandedCIM(yield E.analyzeCIMSymbol(g.data,m,p),g.data,g.rendererKey,g.maxVVSize)});return function(g,m,p){return k.apply(this,arguments)}}(),f=function(){var k=u._asyncToGenerator(function*(g,m,p,t){return g?"cim"===g.type?x(g,m,p):"web-style"===g.type?(g={type:"cim",data:yield v.fetchCIMSymbolReference(g,null,t),rendererKey:g.rendererKey,maxVVSize:g.maxVVSize},x(g,m,p)):g:null});return function(g,
m,p,t){return k.apply(this,arguments)}}();r.cimLayerToRasterizationInfo=function(k){if(!k)return null;const {type:g,cim:m,url:p,materialHash:t}=k,e={cim:m,type:g,mosaicHash:t,url:p,size:null,dashTemplate:null,path:null,text:null,fontName:null,animatedSymbolProperties:null};switch(g){case "marker":e.size=k.size;e.path=k.path;e.animatedSymbolProperties=k.animatedSymbolProperties;break;case "line":e.dashTemplate=k.dashTemplate;break;case "text":e.text=k.text,e.fontName=k.fontName}return e};r.expandSymbol=
f;r.expandSymbols=z;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/ExpandedCIM":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../views/2d/engine/webgl/enums","../../views/2d/engine/webgl/materialKey/MaterialKey"],function(r,u,E,C){const v={marker:E.WGLGeometryType.MARKER,fill:E.WGLGeometryType.FILL,line:E.WGLGeometryType.LINE,text:E.WGLGeometryType.TEXT};let z=function(){function x(f,k,g,m){const p={minScale:null==
k?void 0:k.minScale,maxScale:null==k?void 0:k.maxScale};var t=p.minScale||p.maxScale?p.minScale+"-"+p.maxScale:"";this.layers=f;this.data=k;this.hash=this._createHash()+t;this.rendererKey=g;k={isOutline:!1,placement:null,symbologyType:E.WGLSymbologyType.DEFAULT,vvFlags:g};for(const e of f)f=v[e.type],k.isOutline="line"===e.type&&e.isOutline,e.materialKey=C.createMaterialKey(f,k),e.maxVVSize=m,e.scaleInfo=p,e.templateHash+=t}x.prototype._createHash=function(){let f="";for(const k of this.layers)f+=
k.templateHash;return f};u._createClass(x,[{key:"type",get:function(){return"expanded-cim"}}]);return x}();r.ExpandedCIM=z;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/support/webStyleUtils":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/devEnvironmentUtils ../../../../core/Error ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../portal/Portal ../../../../chunks/persistableUrlUtils ../../../../symbols/support/styleUtils".split(" "),
function(r,u,E,C,v,z,x,f,k,g){function m(){m=u._asyncToGenerator(function*(a,b,h){if(!a.name)throw new C("style-symbol-reference-name-missing","Missing name in style symbol reference");if(a.styleName&&"Esri2DPointSymbolsStyle"===a.styleName)return p(a,h);try{const l=yield g.fetchStyle(a,b,h);return e(l,a.name,b,h)}catch(l){return z.throwIfAborted(l),null}});return m.apply(this,arguments)}function p(a,b){return t.apply(this,arguments)}function t(){t=u._asyncToGenerator(function*(a,b){a=g.Style2DUrlTemplate.replace(/\{SymbolName\}/gi,
a.name);try{const h=yield g.requestJSON(a,b);return g.makeCIMSymbolRef(h.data)}catch(h){return z.throwIfAborted(h),null}});return t.apply(this,arguments)}function e(a,b,h,l){return c.apply(this,arguments)}function c(){c=u._asyncToGenerator(function*(a,b,h,l){var d=a.data;a={portal:h&&v.isSome(h.portal)?h.portal:f.getDefault(),url:x.urlToObject(a.baseUrl),origin:"portal-item"};d=d.items.find(q=>q.name===b);if(!d)throw new C("symbolstyleutils:symbol-name-not-found",`The symbol name '${b}' could not be found`,
{symbolName:b});d=k.fromJSON(g.symbolUrlFromStyleItem(d,"cimRef"),a);E.isDevEnvironment()&&(d=E.adjustStaticAGOUrl(d));try{const q=yield g.requestJSON(d,l);return g.makeCIMSymbolRef(q.data)}catch(q){return z.throwIfAborted(q),null}});return c.apply(this,arguments)}r.fetchCIMSymbolReference=function(a,b,h){return m.apply(this,arguments)};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(r){const u=
/^devext.arcgis.com$/,E=/^qaext.arcgis.com$/,C=/^[\w-]*\.mapsdevext.arcgis.com$/,v=/^[\w-]*\.mapsqa.arcgis.com$/,z=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,u,E,/^jsapps.esri.com$/,C,v];r.adjustStaticAGOUrl=function(x,f){return x?(f=f||globalThis.location.hostname)?null!=f.match(u)||null!=f.match(C)?x.replace("static.arcgis.com","staticdev.arcgis.com"):null!=f.match(E)||null!=f.match(v)?x.replace("static.arcgis.com","staticqa.arcgis.com"):x:x:x};r.isDevEnvironment=function(x){x=x||globalThis.location.hostname;
return z.some(f=>{var k;return null!=(null==(k=x)?void 0:k.match(f))})};r.isTelemetryDevEnvironment=function(x){x=x||globalThis.location.hostname;return[/^zrh-.+?\.esri\.com$/].concat(z).some(f=>{var k;return null!=(null==(k=x)?void 0:k.match(f))})};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/portal/Portal":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../config ../kernel ../request ../core/Error ../core/JSONSupport ../core/Loadable ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/Extent ../intl/locale ./PortalQueryParams ./PortalQueryResult ./PortalUser ../support/apiKeyUtils".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p,t,e,c,a,b,h,l,d,q,n,B){const A=F=>Object.freeze(Object.defineProperty({__proto__:null,default:F},Symbol.toStringTag,{value:"Module"}));var w;let y;const D={PortalGroup:()=>new Promise((F,G)=>r(["./PortalGroup"],K=>F(A(K)),G)),PortalItem:()=>new Promise((F,G)=>r(["./PortalItem"],K=>F(A(K)),G)),PortalUser:()=>new Promise((F,G)=>r(["./PortalUser"],K=>F(A(K)),G))};f=w=function(F){function G(J){J=F.call(this,J)||this;J.access=null;J.allSSL=!1;J.authMode="auto";J.authorizedCrossOriginDomains=
null;J.basemapGalleryGroupQuery=null;J.bingKey=null;J.canListApps=!1;J.canListData=!1;J.canListPreProvisionedItems=!1;J.canProvisionDirectPurchase=!1;J.canSearchPublic=!0;J.canShareBingPublic=!1;J.canSharePublic=!1;J.canSignInArcGIS=!1;J.canSignInIDP=!1;J.colorSetsGroupQuery=null;J.commentsEnabled=!1;J.created=null;J.culture=null;J.customBaseUrl=null;J.defaultBasemap=null;J.defaultDevBasemap=null;J.defaultExtent=null;J.defaultVectorBasemap=null;J.description=null;J.devBasemapGalleryGroupQuery=null;
J.eueiEnabled=null;J.featuredGroups=null;J.featuredItemsGroupQuery=null;J.galleryTemplatesGroupQuery=null;J.livingAtlasGroupQuery=null;J.hasCategorySchema=!1;J.helperServices=null;J.homePageFeaturedContent=null;J.homePageFeaturedContentCount=null;J.httpPort=null;J.httpsPort=null;J.id=null;J.ipCntryCode=null;J.isPortal=!1;J.isReadOnly=!1;J.layerTemplatesGroupQuery=null;J.maxTokenExpirationMinutes=null;J.modified=null;J.name=null;J.portalHostname=null;J.portalMode=null;J.portalProperties=null;J.region=
null;J.rotatorPanels=null;J.showHomePageDescription=!1;J.sourceJSON=null;J.supportsHostedServices=!1;J.symbolSetsGroupQuery=null;J.templatesGroupQuery=null;J.units=null;J.url=C.portalUrl;J.urlKey=null;J.user=null;J.useStandardizedQuery=!1;J.useVectorBasemaps=!1;J.vectorBasemapGalleryGroupQuery=null;return J}u._inheritsLoose(G,F);var K=G.prototype;K.normalizeCtorArgs=function(J){return"string"===typeof J?{url:J}:J};K.destroy=function(){this._esriId_credentialCreateHandle&&(this._esriId_credentialCreateHandle.remove(),
this._esriId_credentialCreateHandle=null)};K.readAuthorizedCrossOriginDomains=function(J){if(J)for(const I of J)C.request.trustedServers.includes(I)||C.request.trustedServers.push(I);return J};K.readDefaultBasemap=function(J){return this._readBasemap(J)};K.readDefaultDevBasemap=function(J){return this._readBasemap(J)};K.readDefaultVectorBasemap=function(J){return this._readBasemap(J)};K.readUrlKey=function(J){return J?J.toLowerCase():J};K.readUser=function(J){let I=null;J&&(I=n.fromJSON(J),I.portal=
this);return I};K.load=function(J){const I=(new Promise((H,M)=>r(["../Basemap"],N=>H(A(N)),M))).then(({default:H})=>{m.throwIfAborted(J);y=H}).then(()=>this.sourceJSON?this.sourceJSON:this._fetchSelf(this.authMode,!1,J)).then(H=>{if(v.id){const M=v.id;this.credential=M.findCredential(this.restUrl);this.credential||this.authMode!==w.AUTH_MODE_AUTO||(this._esriId_credentialCreateHandle=M.on("credential-create",()=>{M.findCredential(this.restUrl)&&this._signIn()}))}this.sourceJSON=H;this.read(H)});this.addResolvingPromise(I);
return Promise.resolve(this)};K.createElevationLayers=function(){var J=u._asyncToGenerator(function*(){yield this.load();const I=this._getHelperService("defaultElevationLayers"),H=(yield new Promise((M,N)=>r(["../layers/ElevationLayer"],P=>M(A(P)),N))).default;return I?I.map(M=>new H({id:M.id,url:M.url})):[]});return function(){return J.apply(this,arguments)}}();K.fetchBasemaps=function(J,I){const H=new d;H.query=J||(C.apiKey&&B.supportsApiKey(this.url)?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?
this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery);H.disableExtraQuery=!0;return this.queryGroups(H,I).then(M=>{H.num=100;H.query='type:"Web Map" -type:"Web Application"';return M.total?(M=M.results[0],H.sortField=M.sortField||"name",H.sortOrder=M.sortOrder||"desc",M.queryItems(H,I)):null}).then(M=>M&&M.total?M.results.filter(N=>"Web Map"===N.type).map(N=>new y({portalItem:N})):[])};K.fetchCategorySchema=function(J){return this.hasCategorySchema?this._request(this.restUrl+"/portals/self/categorySchema",
J).then(I=>I.categorySchema):m.isAborted(J)?Promise.reject(m.createAbortError()):Promise.resolve([])};K.fetchFeaturedGroups=function(J){const I=this.featuredGroups,H=new d;H.num=100;H.sortField="title";if(I&&I.length){const M=[];for(const N of I)M.push(`(title:"${N.title}" AND owner:${N.owner})`);H.query=M.join(" OR ");return this.queryGroups(H,J).then(N=>N.results)}return m.isAborted(J)?Promise.reject(m.createAbortError()):Promise.resolve([])};K.fetchRegions=function(J){var I;const H=(null==(I=this.user)?
void 0:I.culture)||this.culture||l.getLocale();return this._request(this.restUrl+"/portals/regions",{...J,query:{culture:H}})};K.fetchSettings=function(J){var I;const H=(null==(I=this.user)?void 0:I.culture)||this.culture||l.getLocale();return this._request(this.restUrl+"/portals/self/settings",{...J,query:{culture:H}})};G.getDefault=function(){if(!w._default||w._default.destroyed)w._default=new w;return w._default};K.queryGroups=function(J,I){return this._queryPortal("/community/groups",J,"PortalGroup",
I)};K.queryItems=function(J,I){return this._queryPortal("/search",J,"PortalItem",I)};K.queryUsers=function(J,I){J.sortField||(J.sortField="username");return this._queryPortal("/community/users",J,"PortalUser",I)};K.toJSON=function(){throw new x("internal:not-yet-implemented","Portal.toJSON is not yet implemented");};G.fromJSON=function(J){if(!J)return null;if(J.declaredClass)throw Error("JSON object is already hydrated");return new w({sourceJSON:J})};K._getHelperService=function(J){const I=this.helperServices&&
this.helperServices[J];if(!I)throw new x("portal:service-not-found",`The \`helperServices\` do not include an entry named "${J}"`);return I};K._getHelperServiceUrl=function(J){const I=this._getHelperService(J);if(!I.url)throw new x("portal:service-url-not-found",`The \`helperServices\` entry "${J}" does not include a \`url\` value`);return I.url};K._fetchSelf=function(J=this.authMode,I=!1,H){const M=this.restUrl+"/portals/self";J={authMode:J,query:{culture:l.getLocale().toLowerCase()},...H};"auto"===
J.authMode&&(J.authMode="no-prompt");I&&(J.query.default=!0);return this._request(M,J)};K._queryPortal=function(J,I,H,M){const N=c.ensureType(d,I),P=ba=>this._request(this.restUrl+J,{...N.toRequestOptions(this),...M}).then(X=>{const S=N.clone();S.start=X.nextStart;return new q({nextQueryParams:S,queryParams:N,total:X.total,results:w._resultsToTypedArray(ba,{portal:this},X,M)})}).then(X=>Promise.all(X.results.map(S=>"function"===typeof S.when?S.when():X)).then(()=>X,S=>{m.throwIfAbortError(S);return X}));
return H&&D[H]?D[H]().then(({default:ba})=>{m.throwIfAborted(M);return P(ba)}):P()};K._signIn=function(){if(this.authMode===w.AUTH_MODE_ANONYMOUS)return Promise.reject(new x("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if("failed"===this.loadStatus)return Promise.reject(this.loadError);const J=I=>Promise.resolve().then(()=>{if("not-loaded"===this.loadStatus)return I||(this.authMode="immediate"),this.load().then(()=>null);if("loading"===this.loadStatus)return this.load().then(()=>
{if(this.credential)return null;this.credential=I;return this._fetchSelf("immediate")});if(this.user&&this.credential===I)return null;this.credential=I;return this._fetchSelf("immediate")}).then(H=>{H&&(this.sourceJSON=H,this.read(H))});return v.id?v.id.getCredential(this.restUrl).then(I=>J(I)):J(this.credential)};K._normalizeSSL=function(J){return J.replace(/^http:/i,"https:").replace(":7080",":7443")};K._normalizeUrl=function(J){const I=this.credential&&this.credential.token;return this._normalizeSSL(I?
J+(J.includes("?")?"\x26":"?")+"token\x3d"+I:J)};K._requestToTypedArray=function(J,I,H){return this._request(J,I).then(M=>{const N=w._resultsToTypedArray(H,{portal:this},M);return Promise.all(N.map(P=>"function"===typeof P.when?P.when():M)).then(()=>N,()=>N)})};K._readBasemap=function(J){return J?(J=y.fromJSON(J),J.portalItem={portal:this},J):null};K._request=function(J,I={}){const H={f:"json",...I.query},{authMode:M=this.authMode===w.AUTH_MODE_ANONYMOUS?"anonymous":"auto",body:N=null,cacheBust:P=
!1,method:ba="auto",responseType:X="json",signal:S}=I;I={authMode:M,body:N,cacheBust:P,method:ba,query:H,responseType:X,timeout:0,signal:S};return z(this._normalizeSSL(J),I).then(W=>W.data)};G._resultsToTypedArray=function(J,I,H,M){if(H){const N=g.isSome(M)?M.signal:null;H=H.listings||H.notifications||H.userInvitations||H.tags||H.items||H.groups||H.comments||H.provisions||H.results||H.relatedItems||H;if(J||I)H=H.map(P=>{P=Object.assign(J?J.fromJSON(P):P,I);"function"===typeof P.load&&P.load(N);return P})}else H=
[];return H};u._createClass(G,[{key:"extraQuery",get:function(){const J=!(this.user&&this.user.orgId)||this.canSearchPublic;return this.id&&!J?` AND orgid:${this.id}`:null}},{key:"isOrganization",get:function(){return!!this.access}},{key:"restUrl",get:function(){let J=this.url;if(J){const I=J.indexOf("/sharing");J=0<I?J.substring(0,I):this.url.replace(/\/+$/,"");J+="/sharing/rest"}return J}},{key:"thumbnailUrl",get:function(){const J=this.restUrl,I=this.thumbnail;return J&&I?this._normalizeSSL(J+
"/portals/self/resources/"+I):null}}]);return G}(f.JSONSupportMixin(k));f.AUTH_MODE_ANONYMOUS="anonymous";f.AUTH_MODE_AUTO="auto";f.AUTH_MODE_IMMEDIATE="immediate";E.__decorate([p.property()],f.prototype,"access",void 0);E.__decorate([p.property()],f.prototype,"allSSL",void 0);E.__decorate([p.property()],f.prototype,"authMode",void 0);E.__decorate([p.property()],f.prototype,"authorizedCrossOriginDomains",void 0);E.__decorate([a.reader("authorizedCrossOriginDomains")],f.prototype,"readAuthorizedCrossOriginDomains",
null);E.__decorate([p.property()],f.prototype,"basemapGalleryGroupQuery",void 0);E.__decorate([p.property()],f.prototype,"bingKey",void 0);E.__decorate([p.property()],f.prototype,"canListApps",void 0);E.__decorate([p.property()],f.prototype,"canListData",void 0);E.__decorate([p.property()],f.prototype,"canListPreProvisionedItems",void 0);E.__decorate([p.property()],f.prototype,"canProvisionDirectPurchase",void 0);E.__decorate([p.property()],f.prototype,"canSearchPublic",void 0);E.__decorate([p.property()],
f.prototype,"canShareBingPublic",void 0);E.__decorate([p.property()],f.prototype,"canSharePublic",void 0);E.__decorate([p.property()],f.prototype,"canSignInArcGIS",void 0);E.__decorate([p.property()],f.prototype,"canSignInIDP",void 0);E.__decorate([p.property()],f.prototype,"colorSetsGroupQuery",void 0);E.__decorate([p.property()],f.prototype,"commentsEnabled",void 0);E.__decorate([p.property({type:Date})],f.prototype,"created",void 0);E.__decorate([p.property()],f.prototype,"credential",void 0);
E.__decorate([p.property()],f.prototype,"culture",void 0);E.__decorate([p.property()],f.prototype,"currentVersion",void 0);E.__decorate([p.property()],f.prototype,"customBaseUrl",void 0);E.__decorate([p.property()],f.prototype,"defaultBasemap",void 0);E.__decorate([a.reader("defaultBasemap")],f.prototype,"readDefaultBasemap",null);E.__decorate([p.property()],f.prototype,"defaultDevBasemap",void 0);E.__decorate([a.reader("defaultDevBasemap")],f.prototype,"readDefaultDevBasemap",null);E.__decorate([p.property({type:h})],
f.prototype,"defaultExtent",void 0);E.__decorate([p.property()],f.prototype,"defaultVectorBasemap",void 0);E.__decorate([a.reader("defaultVectorBasemap")],f.prototype,"readDefaultVectorBasemap",null);E.__decorate([p.property()],f.prototype,"description",void 0);E.__decorate([p.property()],f.prototype,"devBasemapGalleryGroupQuery",void 0);E.__decorate([p.property()],f.prototype,"eueiEnabled",void 0);E.__decorate([p.property({readOnly:!0})],f.prototype,"extraQuery",null);E.__decorate([p.property()],
f.prototype,"featuredGroups",void 0);E.__decorate([p.property()],f.prototype,"featuredItemsGroupQuery",void 0);E.__decorate([p.property()],f.prototype,"galleryTemplatesGroupQuery",void 0);E.__decorate([p.property()],f.prototype,"livingAtlasGroupQuery",void 0);E.__decorate([p.property()],f.prototype,"hasCategorySchema",void 0);E.__decorate([p.property()],f.prototype,"helpBase",void 0);E.__decorate([p.property()],f.prototype,"helperServices",void 0);E.__decorate([p.property()],f.prototype,"helpMap",
void 0);E.__decorate([p.property()],f.prototype,"homePageFeaturedContent",void 0);E.__decorate([p.property()],f.prototype,"homePageFeaturedContentCount",void 0);E.__decorate([p.property()],f.prototype,"httpPort",void 0);E.__decorate([p.property()],f.prototype,"httpsPort",void 0);E.__decorate([p.property()],f.prototype,"id",void 0);E.__decorate([p.property()],f.prototype,"ipCntryCode",void 0);E.__decorate([p.property({readOnly:!0})],f.prototype,"isOrganization",null);E.__decorate([p.property()],f.prototype,
"isPortal",void 0);E.__decorate([p.property()],f.prototype,"isReadOnly",void 0);E.__decorate([p.property()],f.prototype,"layerTemplatesGroupQuery",void 0);E.__decorate([p.property()],f.prototype,"maxTokenExpirationMinutes",void 0);E.__decorate([p.property({type:Date})],f.prototype,"modified",void 0);E.__decorate([p.property()],f.prototype,"name",void 0);E.__decorate([p.property()],f.prototype,"portalHostname",void 0);E.__decorate([p.property()],f.prototype,"portalMode",void 0);E.__decorate([p.property()],
f.prototype,"portalProperties",void 0);E.__decorate([p.property()],f.prototype,"region",void 0);E.__decorate([p.property({readOnly:!0})],f.prototype,"restUrl",null);E.__decorate([p.property()],f.prototype,"rotatorPanels",void 0);E.__decorate([p.property()],f.prototype,"showHomePageDescription",void 0);E.__decorate([p.property()],f.prototype,"sourceJSON",void 0);E.__decorate([p.property()],f.prototype,"staticImagesUrl",void 0);E.__decorate([p.property({json:{name:"2DStylesGroupQuery"}})],f.prototype,
"stylesGroupQuery2d",void 0);E.__decorate([p.property({json:{name:"stylesGroupQuery"}})],f.prototype,"stylesGroupQuery3d",void 0);E.__decorate([p.property()],f.prototype,"supportsHostedServices",void 0);E.__decorate([p.property()],f.prototype,"symbolSetsGroupQuery",void 0);E.__decorate([p.property()],f.prototype,"templatesGroupQuery",void 0);E.__decorate([p.property()],f.prototype,"thumbnail",void 0);E.__decorate([p.property({readOnly:!0})],f.prototype,"thumbnailUrl",null);E.__decorate([p.property()],
f.prototype,"units",void 0);E.__decorate([p.property()],f.prototype,"url",void 0);E.__decorate([p.property()],f.prototype,"urlKey",void 0);E.__decorate([a.reader("urlKey")],f.prototype,"readUrlKey",null);E.__decorate([p.property()],f.prototype,"user",void 0);E.__decorate([a.reader("user")],f.prototype,"readUser",null);E.__decorate([p.property()],f.prototype,"useStandardizedQuery",void 0);E.__decorate([p.property()],f.prototype,"useVectorBasemaps",void 0);E.__decorate([p.property()],f.prototype,"vectorBasemapGalleryGroupQuery",
void 0);return f=w=E.__decorate([b.subclass("esri.portal.Portal")],f)})},"esri/core/Loadable":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Error ./Promise ./promiseUtils ./Warning ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass".split(" "),function(r,u,E,C,v,z,x,f){const k=g=>{g=function(m){function p(...e){var c=m.call(this,...e)||this;c._loadController=null;c.loadError=null;c.loadStatus="not-loaded";c._set("loadWarnings",[]);c.addResolvingPromise(new Promise(a=>
{const b=c.load.bind(r._assertThisInitialized(c));c.load=h=>{const l=new Promise((d,q)=>{const n=v.onAbortOrThrow(h,q);c.destroyed&&q(new E("load:instance-destroyed",`Instance of '${c.declaredClass||c.constructor.name}' is already destroyed`,{instance:r._assertThisInitialized(c)}));c._promiseProps.when(d,q).finally(()=>{n&&n.remove()})});if("not-loaded"===c.loadStatus){c._set("loadStatus","loading");const d=c._loadController=new AbortController;b({signal:d.signal});v.onAbort(d.signal,()=>{c._promiseProps.abort()})}a();
return l}}));c.when(()=>{c._set("loadStatus","loaded");c._loadController=null},a=>{c._set("loadStatus","failed");c._set("loadError",a);c._loadController=null});return c}r._inheritsLoose(p,m);var t=p.prototype;t.load=function(){return null};t.cancelLoad=function(){var e;if(this.isFulfilled())return this;this._set("loadError",new E("load:cancelled","Cancelled"));null==(e=this._loadController)?void 0:e.abort();return this};r._createClass(p,[{key:"loaded",get:function(){return"loaded"===this.loadStatus}},
{key:"loadWarnings",get:function(){return this._get("loadWarnings")}}]);return p}(g);u.__decorate([x.property({readOnly:!0})],g.prototype,"loaded",null);u.__decorate([x.property({readOnly:!0})],g.prototype,"loadError",void 0);u.__decorate([x.property({clonable:!1})],g.prototype,"loadStatus",void 0);u.__decorate([x.property({type:[z],readOnly:!0})],g.prototype,"loadWarnings",null);return g=u.__decorate([f.subclass("esri.core.Loadable")],g)};C=function(g){function m(){return g.apply(this,arguments)||
this}r._inheritsLoose(m,g);return m}(k(C.EsriPromise));C=u.__decorate([f.subclass("esri.core.Loadable")],C);(function(g){g.LoadableMixin=k;g.isLoadable=function(m){return!(!m||!m.load)}})(C||(C={}));return C})},"esri/core/Promise":function(){define("exports ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Accessor ./maybe ./promiseUtils ./accessorSupport/decorators/subclass".split(" "),function(r,u,E,C,v,z,x){var f;(function(m){m[m.PENDING=0]="PENDING";m[m.RESOLVED=1]="RESOLVED";m[m.REJECTED=
2]="REJECTED"})(f||(f={}));let k=function(){function m(t){this.instance=t;this._resolver=z.createDeferred();this._status=f.PENDING;this._resolvingPromises=[];this._resolver.promise.then(()=>{this._status=f.RESOLVED;this._cleanUp()},()=>{this._status=f.REJECTED;this._cleanUp()})}var p=m.prototype;p.addResolvingPromise=function(t){this._resolvingPromises.push(t);this._tryResolve()};p.isResolved=function(){return this._status===f.RESOLVED};p.isRejected=function(){return this._status===f.REJECTED};p.isFulfilled=
function(){return this._status!==f.PENDING};p.abort=function(){this._resolver.reject(z.createAbortError())};p.when=function(t,e){return this._resolver.promise.then(t,e)};p._cleanUp=function(){this._allPromise=this._resolvingPromises=this._allPromise=null};p._tryResolve=function(){if(!this.isFulfilled()){var t=z.createDeferred(),e=[...this._resolvingPromises,v.assumeNonNull(t.promise)],c=this._allPromise=Promise.all(e);c.then(()=>{this.isFulfilled()||this._allPromise!==c||this._resolver.resolve(this.instance)},
a=>{this.isFulfilled()||this._allPromise!==c||z.isAbortError(a)||this._resolver.reject(a)});t.resolve()}};return m}();const g=m=>{m=function(p){function t(...c){c=p.call(this,...c)||this;c._promiseProps=new k(u._assertThisInitialized(c));c.addResolvingPromise(Promise.resolve());return c}u._inheritsLoose(t,p);var e=t.prototype;e.isResolved=function(){return this._promiseProps.isResolved()};e.isRejected=function(){return this._promiseProps.isRejected()};e.isFulfilled=function(){return this._promiseProps.isFulfilled()};
e.when=function(c,a){return(new Promise((b,h)=>{this._promiseProps.when(b,h)})).then(c,a)};e.catch=function(c){return this.when(null,c)};e.addResolvingPromise=function(c){c&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in c?c.when():c)};return t}(m);return m=E.__decorate([x.subclass("esri.core.Promise")],m)};r.EsriPromise=function(m){function p(){return m.apply(this,arguments)||this}u._inheritsLoose(p,m);return p}(g(C));r.EsriPromise=E.__decorate([x.subclass("esri.core.Promise")],
r.EsriPromise);r.EsriPromiseMixin=g;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/intl/locale":function(){define(["exports"],function(r){function u(){var c,a;return null!=(c=null!=m?m:null==(a=globalThis.navigator)?void 0:a.language)?c:"en"}function E(){void 0===g&&(g=u());return g}function C(c=E()){c=/^([a-zA-Z]{2,3})(?:[_\-]\w+)*$/.exec(c);return null==c?void 0:c[1].toLowerCase()}function v(){var c;const a=null!=(c=k)?c:u();g!==a&&(g=a,[...e].forEach(b=>
{b.call(null,a)}),[...t].forEach(b=>{b.call(null,a)}))}var z,x,f;let k=void 0,g=void 0;const m=null!=(z=null==(x=globalThis.esriConfig)?void 0:x.locale)?z:null==(f=globalThis.dojoConfig)?void 0:f.locale,p={he:!0,ar:!0},t=[],e=[];null==globalThis.addEventListener?void 0:globalThis.addEventListener("languagechange",v);r.beforeLocaleChange=function(c){e.push(c);return{remove(){t.splice(e.indexOf(c),1)}}};r.getDefaultLocale=u;r.getLanguage=C;r.getLocale=E;r.onLocaleChange=function(c){t.push(c);return{remove(){t.splice(t.indexOf(c),
1)}}};r.prefersRTL=function(c=E()){c=C(c);return void 0!==c&&(p[c]||!1)};r.setLocale=function(c){k=c?c:void 0;v()};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/portal/PortalQueryParams":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Accessor ../core/jsonMap ../core/lang ../core/maybe ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../geometry/Extent ../geometry/SpatialReference ../geometry/support/webMercatorUtils".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p){var t;const e=new C.JSONMap({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});E=t=function(c){function a(h){h=c.call(this,h)||this;h.categories=null;h.disableExtraQuery=!1;h.extent=null;h.filter=null;h.num=10;h.query=null;h.sortField=null;h.start=1;return h}r._inheritsLoose(a,c);var b=a.prototype;b.clone=function(){return new t({categories:this.categories?v.clone(this.categories):null,disableExtraQuery:this.disableExtraQuery,
extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})};b.toRequestOptions=function(h,l){let d;this.categories&&(d=this.categories.map(B=>Array.isArray(B)?JSON.stringify(B):B));let q;if(this.extent){var n=p.project(this.extent,m.WGS84);z.isSome(n)&&(q=`${n.xmin},${n.ymin},${n.xmax},${n.ymax}`)}n=this.query;!this.disableExtraQuery&&h.extraQuery&&(n="("+n+")"+h.extraQuery);h={categories:d,bbox:q,
q:n,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};this.sortField&&(h.sortField=this.sortField.split(",").map(B=>e.toJSON(B.trim())).join(","),h.sortOrder=this.sortOrder);return{query:{...l,...h}}};r._createClass(a,[{key:"sortOrder",get:function(){return this._get("sortOrder")||"asc"},set:function(h){"asc"!==h&&"desc"!==h||this._set("sortOrder",h)}}]);return a}(E);u.__decorate([x.property()],E.prototype,"categories",void 0);u.__decorate([x.property()],E.prototype,
"disableExtraQuery",void 0);u.__decorate([x.property({type:g})],E.prototype,"extent",void 0);u.__decorate([x.property()],E.prototype,"filter",void 0);u.__decorate([x.property()],E.prototype,"num",void 0);u.__decorate([x.property()],E.prototype,"query",void 0);u.__decorate([x.property()],E.prototype,"sortField",void 0);u.__decorate([x.property()],E.prototype,"sortOrder",null);u.__decorate([x.property()],E.prototype,"start",void 0);return E=t=u.__decorate([k.subclass("esri.portal.PortalQueryParams")],
E)})},"esri/portal/PortalQueryResult":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass".split(" "),function(r,u,E,C,v,z,x,f){E=function(k){function g(m){m=k.call(this,m)||this;m.nextQueryParams=null;m.queryParams=null;m.results=null;m.total=null;return m}r._inheritsLoose(g,k);return g}(E);u.__decorate([C.property()],
E.prototype,"nextQueryParams",void 0);u.__decorate([C.property()],E.prototype,"queryParams",void 0);u.__decorate([C.property()],E.prototype,"results",void 0);u.__decorate([C.property()],E.prototype,"total",void 0);return E=u.__decorate([f.subclass("esri.portal.PortalQueryResult")],E)})},"esri/portal/PortalUser":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ./PortalFolder ./PortalGroup".split(" "),
function(r,u,E,C,v,z,x,f,k,g,m,p){var t;v=t=function(e){function c(...b){b=e.call(this,...b)||this;b.access=null;b.created=null;b.culture=null;b.description=null;b.email=null;b.fullName=null;b.modified=null;b.orgId=null;b.portal=null;b.preferredView=null;b.privileges=null;b.region=null;b.role=null;b.roleId=null;b.sourceJSON=null;b.units=null;b.username=null;b.userType=null;return b}u._inheritsLoose(c,e);var a=c.prototype;a.addItem=function(b){const h=b&&b.item;var l=b&&b.data;b=b&&b.folder;const d=
{method:"post"};h&&(d.query=h.createPostQuery(),null!=l&&("string"===typeof l?d.query.text=l:"object"===typeof l&&(d.query.text=JSON.stringify(l))));l=this.userContentUrl;b&&(l+="/"+("string"===typeof b?b:b.id));return this.portal._request(l+"/addItem",d).then(q=>{h.id=q.id;h.portal=this.portal;return h.loaded?h.reload():h.load()})};a.deleteItem=function(b){let h=this.userContentUrl;b.ownerFolder&&(h+="/"+b.ownerFolder);return this.portal._request(h+`/items/${b.id}/delete`,{method:"post"}).then(()=>
{b.id=null;b.portal=null})};a.deleteItems=function(b){const h=this.userContentUrl+"/deleteItems";var l=b.map(d=>d.id);return l.length?(l={method:"post",query:{items:l.join(",")}},this.portal._request(h,l).then(()=>{b.forEach(d=>{d.id=null;d.portal=null})})):Promise.resolve(void 0)};a.fetchFolders=function(){return this.portal._request(this.userContentUrl,{query:{num:1}}).then(b=>b&&b.folders?b.folders.map(h=>{h=m.fromJSON(h);h.portal=this.portal;return h}):[])};a.fetchGroups=function(){return this.portal._request(this.url).then(b=>
b&&b.groups?b.groups.map(h=>{h=p.fromJSON(h);h.portal=this.portal;return h}):[])};a.fetchItems=function(b){b||(b={});let h=this.userContentUrl;b.folder&&(h+="/"+b.folder.id);let l;return(new Promise((d,q)=>r(["./PortalItem"],n=>d(Object.freeze(Object.defineProperty({__proto__:null,default:n},Symbol.toStringTag,{value:"Module"}))),q))).then(({default:d})=>{l=d;return this.portal._request(h,{query:{folders:!1,num:b.num||10,start:b.start||1,sortField:b.sortField||"created",sortOrder:b.sortOrder||"asc"}})}).then(d=>
{let q;return d&&d.items?(q=d.items.map(n=>{n=l.fromJSON(n);n.portal=this.portal;return n}),Promise.all(q.map(n=>n.load())).catch(n=>n).then(()=>({items:q,nextStart:d.nextStart,total:d.total}))):{items:[],nextStart:-1,total:0}})};a.fetchTags=function(){return this.portal._request(this.url+"/tags").then(b=>b.tags)};a.getThumbnailUrl=function(b){let h=this.thumbnailUrl;h&&b&&(h+=`&w=${b}`);return h};a.queryFavorites=function(b){return this.favGroupId?(this._favGroup||(this._favGroup=new p({id:this.favGroupId,
portal:this.portal})),this._favGroup.queryItems(b)):Promise.reject(new C("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))};a.toJSON=function(){throw new C("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");};c.fromJSON=function(b){if(!b)return null;if(b.declaredClass)throw Error("JSON object is already hydrated");const h=new t;h.sourceJSON=b;h.read(b);return h};u._createClass(c,[{key:"thumbnailUrl",get:function(){const b=this.url,h=this.thumbnail;
return b&&h?this.portal._normalizeUrl(`${b}/info/${h}?f=json`):null}},{key:"userContentUrl",get:function(){const b=this.get("portal.restUrl");return b?`${b}/content/users/${this.username}`:null}},{key:"url",get:function(){const b=this.get("portal.restUrl");return b?`${b}/community/users/${this.username}`:null}}]);return c}(v.JSONSupport);E.__decorate([z.property()],v.prototype,"access",void 0);E.__decorate([z.property({type:Date})],v.prototype,"created",void 0);E.__decorate([z.property()],v.prototype,
"culture",void 0);E.__decorate([z.property()],v.prototype,"description",void 0);E.__decorate([z.property()],v.prototype,"email",void 0);E.__decorate([z.property()],v.prototype,"favGroupId",void 0);E.__decorate([z.property()],v.prototype,"fullName",void 0);E.__decorate([z.property({type:Date})],v.prototype,"modified",void 0);E.__decorate([z.property()],v.prototype,"orgId",void 0);E.__decorate([z.property()],v.prototype,"portal",void 0);E.__decorate([z.property()],v.prototype,"preferredView",void 0);
E.__decorate([z.property()],v.prototype,"privileges",void 0);E.__decorate([z.property()],v.prototype,"region",void 0);E.__decorate([z.property()],v.prototype,"role",void 0);E.__decorate([z.property()],v.prototype,"roleId",void 0);E.__decorate([z.property()],v.prototype,"sourceJSON",void 0);E.__decorate([z.property()],v.prototype,"thumbnail",void 0);E.__decorate([z.property({readOnly:!0})],v.prototype,"thumbnailUrl",null);E.__decorate([z.property()],v.prototype,"units",void 0);E.__decorate([z.property({readOnly:!0})],
v.prototype,"userContentUrl",null);E.__decorate([z.property({readOnly:!0})],v.prototype,"url",null);E.__decorate([z.property()],v.prototype,"username",void 0);E.__decorate([z.property()],v.prototype,"userType",void 0);return v=t=E.__decorate([g.subclass("esri.portal.PortalUser")],v)})},"esri/portal/PortalFolder":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass".split(" "),
function(r,u,E,C,v,z,x,f,k){C=function(g){function m(p){p=g.call(this,p)||this;p.created=null;p.id=null;p.portal=null;p.title=null;p.username=null;return p}r._inheritsLoose(m,g);m.prototype.toJSON=function(){throw new E("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented");};r._createClass(m,[{key:"url",get:function(){const p=this.get("portal.restUrl");return p?`${p}/content/users/${this.username}/${this.id}`:null}}]);return m}(C.JSONSupport);u.__decorate([v.property({type:Date})],
C.prototype,"created",void 0);u.__decorate([v.property()],C.prototype,"id",void 0);u.__decorate([v.property()],C.prototype,"portal",void 0);u.__decorate([v.property()],C.prototype,"title",void 0);u.__decorate([v.property({readOnly:!0})],C.prototype,"url",null);u.__decorate([v.property()],C.prototype,"username",void 0);return C=u.__decorate([k.subclass("esri.portal.PortalFolder")],C)})},"esri/portal/PortalGroup":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ./PortalQueryParams".split(" "),
function(r,u,E,C,v,z,x,f,k,g){C=function(m){function p(e){e=m.call(this,e)||this;e.access=null;e.created=null;e.description=null;e.id=null;e.isInvitationOnly=!1;e.modified=null;e.owner=null;e.portal=null;e.snippet=null;e.sortField=null;e.sortOrder=null;e.tags=null;e.title=null;return e}r._inheritsLoose(p,m);var t=p.prototype;t.fetchCategorySchema=function(e){return this.portal._request(this.url+"/categorySchema",e).then(c=>{c=c.categorySchema||[];return c.some(a=>"contentCategorySetsGroupQuery.LivingAtlas"===
a.source)?this._fetchCategorySchemaSet("LivingAtlas",e):c})};t.fetchMembers=function(e){return this.portal._request(this.url+"/users",e)};t.getThumbnailUrl=function(e){let c=this.thumbnailUrl;c&&e&&(c+=`&w=${e}`);return c};t.toJSON=function(){throw new E("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");};t.queryItems=function(e,c){e=f.ensureType(g,e);if(5<parseFloat(this.portal.currentVersion))return e=e||new g,this.portal._queryPortal(`/content/groups/${this.id}/search`,
e,"PortalItem",c);e=e?e.clone():new g;e.query="group:"+this.id+(e.query?" "+e.query:"");return this.portal.queryItems(e,c)};t._fetchCategorySchemaSet=function(e,c){return this.portal._fetchSelf(this.portal.authMode,!0,c).then(a=>{if(a=a.contentCategorySetsGroupQuery){const b=new g;b.disableExtraQuery=!0;b.num=1;b.query=a;return this.portal.queryGroups(b,c)}throw new E("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found");}).then(a=>{if(a.total){a=a.results[0];const b=
new g;b.num=1;b.query=`typekeywords:"${e}"`;return a.queryItems(b,c)}throw new E("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found");}).then(a=>a.total?a.results[0].fetchData("json",c).then(b=>(b=b&&b.categorySchema)&&b.length?b:[]):[])};r._createClass(p,[{key:"thumbnailUrl",get:function(){const e=this.url,c=this.thumbnail;return e&&c?this.portal._normalizeUrl(`${e}/info/${c}?f=json`):null}},{key:"url",get:function(){const e=this.get("portal.restUrl");return e?e+"/community/groups/"+
this.id:null}}]);return p}(C.JSONSupport);u.__decorate([v.property()],C.prototype,"access",void 0);u.__decorate([v.property({type:Date})],C.prototype,"created",void 0);u.__decorate([v.property()],C.prototype,"description",void 0);u.__decorate([v.property()],C.prototype,"id",void 0);u.__decorate([v.property()],C.prototype,"isInvitationOnly",void 0);u.__decorate([v.property({type:Date})],C.prototype,"modified",void 0);u.__decorate([v.property()],C.prototype,"owner",void 0);u.__decorate([v.property()],
C.prototype,"portal",void 0);u.__decorate([v.property()],C.prototype,"snippet",void 0);u.__decorate([v.property()],C.prototype,"sortField",void 0);u.__decorate([v.property()],C.prototype,"sortOrder",void 0);u.__decorate([v.property()],C.prototype,"tags",void 0);u.__decorate([v.property()],C.prototype,"thumbnail",void 0);u.__decorate([v.property({readOnly:!0})],C.prototype,"thumbnailUrl",null);u.__decorate([v.property()],C.prototype,"title",void 0);u.__decorate([v.property({readOnly:!0})],C.prototype,
"url",null);return C=u.__decorate([k.subclass("esri.portal.PortalGroup")],C)})},"esri/symbols/support/styleUtils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../request ../../core/Error ../../core/maybe ../../core/promiseUtils ../../core/urlUtils ../../portal/Portal ../../portal/PortalQueryParams ../../support/featureFlags".split(" "),function(r,u,E,C,v,z,x,f,k,g){function m(b,h){return p.apply(this,arguments)}function p(){p=u._asyncToGenerator(function*(b,h){try{return{data:(yield c(b,
h)).data,baseUrl:x.removeFile(b),styleUrl:b}}catch(l){return z.throwIfAbortError(l),null}});return p.apply(this,arguments)}function t(b,h,l){h=v.isSome(h.portal)?h.portal:f.getDefault();let d;const q=`${h.url} - ${h.user&&h.user.username} - ${b}`;a[q]||(a[q]=e(b,h,l).then(n=>{d=n;return n.fetchData()}).then(n=>({data:n,baseUrl:d.itemUrl,styleName:b})));return a[q]}function e(b,h,l){return h.load(l).then(()=>{const d=new k({disableExtraQuery:!0,query:`owner:${"esri_en"} AND type:${"Style"} AND typekeywords:"${b}"`});
return h.queryItems(d,l)}).then(({results:d})=>{let q=null;const n=b.toLowerCase();if(d&&Array.isArray(d))for(const B of d)if(B.typeKeywords.some(A=>A.toLowerCase()===n)&&"Style"===B.type&&"esri_en"===B.owner){q=B;break}if(!q)throw new C("symbolstyleutils:style-not-found",`The style '${b}' could not be found`,{styleName:b});return q.load(l)})}function c(b,h){h={responseType:"json",query:{f:"json"},...h};return E(x.normalize(b),h)}const a={};r.Style2DUrlTemplate="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f\x3djson";
r.fetchStyle=function(b,h,l){return b.styleUrl?m(b.styleUrl,l):b.styleName?t(b.styleName,h,l):Promise.reject(new C("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))};r.makeCIMSymbolRef=function(b){return null===b||"CIMSymbolReference"===b.type?b:{type:"CIMSymbolReference",symbol:b}};r.requestJSON=c;r.styleNameFromItem=function(b){for(const h of b.typeKeywords)if(/^Esri.*Style$/.test(h)&&"Esri Style"!==h)return h};r.symbolUrlFromStyleItem=
function(b,h){if("cimRef"===h)return b.cimRef;if(b.formatInfos&&!g.enableWebStyleForceWOSR())for(const l of b.formatInfos)if("gltf"===l.type)return l.href;return b.webRef};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/support/featureFlags":function(){define(["exports","../core/has"],function(r,u){r.enableDirect3DObjectFeatureLayerDisplay=()=>!!u("enable-feature:direct-3d-object-feature-layer-display");r.enableWebStyleForceWOSR=()=>!!u("enable-feature:force-wosr");
Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/util/Matcher":function(){define("require exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/LRUCache ../../../../../support/arcadeOnDemand ../../../arcade/callExpressionWithFeature ../../../layers/support/cimSymbolUtils".split(" "),function(r,u,E,C,v,z,x,f,k){function g(B,A,w,y){return m.apply(this,arguments)}
function m(){m=E._asyncToGenerator(function*(B,A,w,y){switch(B.type){case "simple":case "heatmap":return b.fromBasicRenderer(B,A,w,y);case "map":return d.fromUVRenderer(B,A,w,y);case "interval":return l.fromCBRenderer(B,A,w,y);case "dictionary":return n.fromDictionaryRenderer(B,A,w,y);case "pie-chart":return h.fromPieChartRenderer(B,A,w,y);case "subtype":return h.fromSubtypes(B,A,w,y)}});return m.apply(this,arguments)}function p(B,A){return t.apply(this,arguments)}function t(){t=E._asyncToGenerator(function*(B,
A){const w=B||1;if("number"===typeof w)return(D,F,G)=>w;const y=yield x.createRendererExpression(w,A.spatialReference,A.fields);return(D,F,G)=>f(y,D,{$view:G},A.geometryType,F)||1});return t.apply(this,arguments)}function e(){return c.apply(this,arguments)}function c(){c=E._asyncToGenerator(function*(){q||(q=new Promise((B,A)=>r(["../../../layers/features/createSymbolSchema"],B,A)));return q});return c.apply(this,arguments)}const a=v.getLogger("esri/views/2d/engine/webgl/util/Matcher");let b=function(){function B(){this.type=
"feature";this._defaultResult=null}B.fromBasicRenderer=function(){var w=E._asyncToGenerator(function*(y,D,F,G){const K=new B;y.symbol&&(y=yield k.expandSymbol(y.symbol,F,G),D=D.createTemplateGroup(y,null),K.setDefault(D));return K});return function(y,D,F,G){return w.apply(this,arguments)}}();B.fromPieChartRenderer=function(){var w=E._asyncToGenerator(function*(y,D,F,G){const K=new B;if(y.markerSymbol){const J=yield k.expandSymbol(y.markerSymbol,F,G);let I;y.fillSymbol&&(I=yield k.expandSymbol(y.fillSymbol,
F,G));y=D.createTemplateGroup(J,I);K.setDefault(y)}return K});return function(y,D,F,G){return w.apply(this,arguments)}}();var A=B.prototype;A.size=function(){return 1};A.getDefault=function(){return this._defaultResult};A.setDefault=function(w){this._defaultResult=w};A.match=function(w,y,D,F,G){return this.getDefault()};A.analyze=function(){var w=E._asyncToGenerator(function*(y,D,F,G,K,J){return null});return function(y,D,F,G,K,J){return w.apply(this,arguments)}}();return B}(),h=function(B){function A(w,
y){var D=B.call(this)||this;D._subMatchers=w;D._subtypeField=y;return D}E._inheritsLoose(A,B);A.fromSubtypes=function(){var w=E._asyncToGenerator(function*(y,D,F,G){const K=new Map,J=[];for(const I in y.renderers){const H=parseInt(I,10),M=g(y.renderers[I],D,F,G).then(N=>K.set(H,N));J.push(M)}yield Promise.all(J);return new A(K,y.subtypeField)});return function(y,D,F,G){return w.apply(this,arguments)}}();A.prototype.match=function(w,y,D,F,G){var K=y.readAttribute(this._subtypeField);return(K=this._subMatchers.get(K))?
K.match(w,y,D,F,G):null};return A}(b),l=function(B){function A(y,D,F,G){var K=B.call(this)||this;K.type="interval";K._intervals=[];K._isMaxInclusive=D;K._fieldIndex=G;K._field=y;K._normalizationInfo=F;return K}E._inheritsLoose(A,B);A.fromCBRenderer=function(){var y=E._asyncToGenerator(function*(D,F,G,K){const {isMaxInclusive:J,normalizationField:I,normalizationTotal:H,normalizationType:M}=D,N=new A(D.field,J,{normalizationField:I,normalizationTotal:H,normalizationType:M},D.fieldIndex),P=yield k.expandSymbol(D.backgroundFillSymbol,
G,K);yield Promise.all(D.intervals.map(function(){var ba=E._asyncToGenerator(function*(X){var S=yield k.expandSymbol(X.symbol,G,K);S=yield F.createTemplateGroup(S,P);N.add({min:X.min,max:X.max},S)});return function(X){return ba.apply(this,arguments)}}()));if(D=yield k.expandSymbol(D.defaultSymbol,G,K))D=yield F.createTemplateGroup(D,P),N.setDefault(D);return N});return function(D,F,G,K){return y.apply(this,arguments)}}();var w=A.prototype;w.add=function(y,D){this._intervals.push({interval:y,result:D});
this._intervals.sort((F,G)=>F.interval.min-G.interval.min)};w.size=function(){return B.prototype.size.call(this)+this._intervals.length};w.match=function(y,D,F,G,K){if(null==this._fieldIndex&&!this._field)return this.getDefault();y=null!=this._fieldIndex?D.getComputedNumericAtIndex(this._fieldIndex):this._getValueFromField(D);if(!y&&(null===y||void 0===y||isNaN(y)))return this.getDefault();for(D=0;D<this._intervals.length;D++){const {interval:J,result:I}=this._intervals[D];F=this._isMaxInclusive?
y<=J.max:y<J.max;if(y>=J.min&&F)return I}return this.getDefault()};w._needsNormalization=function(){const y=this._normalizationInfo;return y&&(y.normalizationField||y.normalizationTotal||y.normalizationType)};w._getValueFromField=function(y){const D=y.readAttribute(this._field);if(!this._needsNormalization()||null==D)return D;const {normalizationField:F,normalizationTotal:G,normalizationType:K}=this._normalizationInfo;y=!!F&&y.readAttribute(F);if(K)switch(K){case "esriNormalizeByField":return(y||
void 0)&&D/y;case "esriNormalizeByLog":return Math.log(D)*Math.LOG10E;case "esriNormalizeByPercentOfTotal":return D/G*100;default:a.error(`Found unknown normalization type: ${K}`)}else a.error("Normalization is required, but no type was set!")};return A}(b),d=function(B){function A(y,D,F){var G=B.call(this)||this;G.type="map";G._nullResult=null;G._resultsMap=new Map;G._fieldsIndex=F;G._fields=y;G._seperator=D||"";return G}E._inheritsLoose(A,B);A.fromUVRenderer=function(){var y=E._asyncToGenerator(function*(D,
F,G,K){const J=D.fieldDelimiter,I=[D.field];D.field2&&I.push(D.field2);D.field3&&I.push(D.field3);const H=yield k.expandSymbol(D.backgroundFillSymbol,G,K),M=new A(I,J,D.fieldIndex);yield Promise.all(D.map.map(function(){var N=E._asyncToGenerator(function*(P){var ba=yield k.expandSymbol(P.symbol,G,K);ba=yield F.createTemplateGroup(ba,H);"\x3cNull\x3e"===P.value?M.setNullResult(ba):M.add(P.value,ba)});return function(P){return N.apply(this,arguments)}}()));if(D=yield k.expandSymbol(D.defaultSymbol,
G,K))D=yield F.createTemplateGroup(D,H),M.setDefault(D);return M});return function(D,F,G,K){return y.apply(this,arguments)}}();var w=A.prototype;w.setNullResult=function(y){this._nullResult=y};w.add=function(y,D){this._resultsMap.set(y.toString(),D)};w.size=function(){return B.prototype.size.call(this)+this._resultsMap.size};w.match=function(y,D,F,G,K){if(null==this._fieldsIndex&&!this._fields)return this.getDefault();y=null!=this._fieldsIndex?D.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(D);
if(null!==this._nullResult&&(null==y||""===y||"\x3cNull\x3e"===y))return this._nullResult;if(!y&&null==y)return this.getDefault();y=y.toString();return this._resultsMap.has(y)?this._resultsMap.get(y):this.getDefault()};w._getValueFromFields=function(y){const D=[];for(const F of this._fields){const G=y.readAttribute(F);null==G||""===G?D.push("\x3cNull\x3e"):D.push(G)}return D.join(this._seperator)};return A}(b),q,n=function(B){function A(y,D,F,G,K,J){var I=B.call(this)||this;I.type="dictionary";I._groupIdCache=
new z(100);I._loader=y;I._fieldMap=y.fieldMap;I._symbolFields=y.getSymbolFields();I._templates=D;I._info=F;I._scaleFn=G;I._schemaUtilsModule=K;I._symbolOptions=J;return I}E._inheritsLoose(A,B);A.fromDictionaryRenderer=function(){var y=E._asyncToGenerator(function*(D,F,G,K){const [{DictionaryLoader:J},I]=yield Promise.all([new Promise((M,N)=>r(["../../../../../renderers/support/DictionaryLoader"],M,N)),e()]);K=new J(D.url,D.config,D.fieldMap);yield K.fetchResources({spatialReference:G.spatialReference,
fields:G.fields});const H=yield p(D.scaleExpression,G);return new A(K,F,G,H,I,D.symbolOptions)});return function(D,F,G,K){return y.apply(this,arguments)}}();var w=A.prototype;w._analyzeFeature=function(){var y=E._asyncToGenerator(function*(D,F,G,K,J){D=D.readLegacyFeature();const I=this._scaleFn(D,G,K);G=this._attributeHash(D)+"-"+I;const H=this._groupIdCache.get(G);if(H)return H;K=yield this._loader.getSymbolAsync(D,{...K,spatialReference:this._info.spatialReference,abortOptions:J,fields:this._info.fields});
K=this._schemaUtilsModule.createSymbolSchema(K,this._symbolOptions);F=k.expandSymbol(K,this._info,F,J).then(M=>{if("expanded-cim"!==M.type)return a.error(new C("mapview-bad-type",`Found unexpected type ${M.type} in dictionary response`)),null;M.hash+="-"+I;for(const N of M.layers)N.scaleFactor=I,N.templateHash+="-"+I;return this._templates.createTemplateGroup(M,null)});this._groupIdCache.put(G,F,1);return F});return function(D,F,G,K,J){return y.apply(this,arguments)}}();w.analyze=function(){var y=
E._asyncToGenerator(function*(D,F,G,K,J,I){D=F.getCursor();for(F=[];D.next();)F.push(this._analyzeFeature(D,G,K,J,I));return Promise.all(F)});return function(D,F,G,K,J,I){return y.apply(this,arguments)}}();w.match=function(y,D,F,G,K){return null};w._attributeHash=function(y){let D="";for(const F of this._symbolFields){const G=this._fieldMap[F];G&&(D+=y.attributes[G]+"-")}return D};return A}(b);u.DictionaryMatcher=n;u.FeatureMatcher=b;u.IntervalMatcher=l;u.MapMatcher=d;u.SubtypeMatcher=h;u.createMatcher=
g;Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/LRUCache":function(){define(["../chunks/_rollupPluginBabelHelpers","./MemCache"],function(r,u){return function(){function E(v,z){this._storage=new u.MemCacheStorage;this._storage.maxSize=v;z&&this._storage.registerRemoveFunc("",z)}var C=E.prototype;C.put=function(v,z,x){this._storage.put(v,z,x,1)};C.pop=function(v){return this._storage.pop(v)};C.get=function(v){return this._storage.get(v)};C.clear=
function(){this._storage.clearAll()};C.destroy=function(){this._storage.destroy()};r._createClass(E,[{key:"maxSize",get:function(){return this._storage.maxSize},set:function(v){this._storage.maxSize=v}}]);return E}()})},"esri/views/2d/layers/features/processors/BaseProcessor":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/HandleOwner ../../../../../core/accessorSupport/decorators/property ../../../../../core/arrayUtils ../../../../../core/has ../../../../../core/accessorSupport/ensureType ../../../../../core/accessorSupport/decorators/subclass".split(" "),
function(r,u,E,C,v,z,x,f){E=function(k){function g(){return k.apply(this,arguments)||this}r._inheritsLoose(g,k);var m=g.prototype;m.initialize=function(){};m.destroy=function(){};r._createClass(g,[{key:"supportsTileUpdates",get:function(){return!1}},{key:"spatialReference",get:function(){const p=this.get("tileStore.tileScheme.spatialReference");return p&&p.toJSON()||null}}]);return g}(E.HandleOwner);u.__decorate([C.property({readOnly:!0})],E.prototype,"supportsTileUpdates",null);u.__decorate([C.property({constructOnly:!0})],
E.prototype,"remoteClient",void 0);u.__decorate([C.property({constructOnly:!0})],E.prototype,"service",void 0);u.__decorate([C.property()],E.prototype,"spatialReference",null);u.__decorate([C.property({constructOnly:!0})],E.prototype,"tileInfo",void 0);u.__decorate([C.property({constructOnly:!0})],E.prototype,"tileStore",void 0);return E=u.__decorate([f.subclass("esri.views.2d.layers.features.processors.BaseProcessor")],E)})},"esri/views/2d/layers/features/support/ResourceManagerProxy":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../core/promiseUtils"],function(r,u){return function(){function E(v){this._remoteClient=v;this._resourceMap=new Map;this._inFlightResourceMap=new Map;this.geometryEngine=null}var C=E.prototype;C.destroy=function(){};C.fetchResource=function(){var v=r._asyncToGenerator(function*(z,x){const f=this._resourceMap;var k=f.get(z);if(k||(k=this._inFlightResourceMap.get(z)))return k;try{k=this._remoteClient.invoke("tileRenderer.fetchResource",{url:z},{...x}),this._inFlightResourceMap.set(z,k),
k.then(g=>{this._inFlightResourceMap.delete(z);f.set(z,g);return g})}catch(g){return u.isAbortError(g)?null:{width:0,height:0}}return k});return function(z,x){return v.apply(this,arguments)}}();C.getResource=function(v){var z;return null!=(z=this._resourceMap.get(v))?z:null};return E}()})},"*noref":1}});
define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/HandleOwner ../../../../core/has ../../../../core/reactiveUtils ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/support/spatialReferenceUtils ../../../../layers/support/TileInfo ./processors ./controllers/FeatureController2D ./support/TileStore ./support/UpdateToken ../../tiling/TileInfoView".split(" "),function(r,
u,E,C,v,z,x,f,k,g,m,p,t,e,c,a){E=function(b){function h(){var d=b.apply(this,arguments)||this;d.controller=null;d.processor=null;d.remoteClient=null;d.tileStore=null;d.service=null;d.viewState=null;d._paused=!1;d._pendingTileUpdates=[];return d}r._inheritsLoose(h,b);var l=h.prototype;l.initialize=function(){this.handles.add(v.watch(()=>this.updating,d=>{this.remoteClient.invoke("setUpdating",d).catch(q=>{})}))};l.destroy=function(){var d,q;this.stop();null==(d=this.controller)?void 0:d.destroy();
null==(q=this.processor)?void 0:q.destroy();this.controller=this.processor=this.tileStore=this.remoteClient=null};l.stop=function(){var d,q,n;this._paused=!0;Array.isArray(null==(d=this.service)?void 0:d.source)&&(this.service.source.forEach(B=>B.close()),this.service.source.length=0);null==(q=this.tileStore)?void 0:q.updateTiles({added:[],removed:this.tileStore.tiles.map(B=>B.id)});null==(n=this.tileStore)?void 0:n.destroy();this.tileStore=null;this._pendingTileUpdates.length=0};l.startup=function(){var d=
r._asyncToGenerator(function*({service:q,config:n,tileInfo:B,tiles:A}){var w;this._paused=!0;Array.isArray(null==(w=this.service)?void 0:w.source)&&(this.service.source.forEach(F=>F.close()),this.service.source.length=0);this.service=q;if(!this.tileStore||!g.equals(this.tileStore.tileScheme.spatialReference,B.spatialReference)){var y,D;q=new a(m.fromJSON(B));A.added.length=A.removed.length=0;null==(y=this.tileStore)?void 0:y.updateTiles({added:[],removed:this.tileStore.tiles.map(F=>F.id)});null==
(D=this.tileStore)?void 0:D.destroy();this.tileStore=new e(q);this._pendingTileUpdates.length=0}yield this._createProcessorAndController(n);yield this.update({config:n});this.controller.resume();this.tileStore.clear();this.tileStore.updateTiles(A);for(this._paused=!1;this._pendingTileUpdates.length;)this.tileStore.updateTiles(this._pendingTileUpdates.pop())});return function(q){return d.apply(this,arguments)}}();l.updateTiles=function(){var d=r._asyncToGenerator(function*(q){this._paused?this._pendingTileUpdates.push(q):
this.tileStore.updateTiles(q)});return function(q){return d.apply(this,arguments)}}();l.update=function(){var d=r._asyncToGenerator(function*({config:q}){const n=c.UpdateToken.empty();yield Promise.all([this.processor.update(n,q),this.controller.update(n,q)]);return n.toJSON()});return function(q){return d.apply(this,arguments)}}();l.applyUpdate=function(){var d=r._asyncToGenerator(function*(q){return this.controller.applyUpdate(c.UpdateToken.create(q))});return function(q){return d.apply(this,arguments)}}();
l._createProcessorAndController=function(){var d=r._asyncToGenerator(function*(q){yield Promise.all([this._handleControllerConfig(q),this._handleProcessorConfig(q)]);this.controller.processor=this.processor});return function(q){return d.apply(this,arguments)}}();l._handleControllerConfig=function(){var d=r._asyncToGenerator(function*(q){return this._createController(this.service,q)});return function(q){return d.apply(this,arguments)}}();l._handleProcessorConfig=function(){var d=r._asyncToGenerator(function*(q){return this._createProcessor(this.service,
q)});return function(q){return d.apply(this,arguments)}}();l._createController=function(){var d=r._asyncToGenerator(function*(q,n){this.controller&&this.controller.destroy();const {tileStore:B,remoteClient:A}=this;return this.controller=q=new t({service:q,tileStore:B,remoteClient:A})});return function(q,n){return d.apply(this,arguments)}}();l._createProcessor=function(){var d=r._asyncToGenerator(function*(q,n){const B=(yield p.loadProcessorModule(n.schema.processors[0].type)).default,{remoteClient:A,
tileStore:w}=this;q=new B({service:q,config:n,tileStore:w,remoteClient:A});this.processor&&this.processor.destroy();return this.processor=q});return function(q,n){return d.apply(this,arguments)}}();r._createClass(h,[{key:"updating",get:function(){return!this.controller||this.controller.updating}}]);return h}(E.HandleOwner);u.__decorate([z.property()],E.prototype,"controller",void 0);u.__decorate([z.property()],E.prototype,"processor",void 0);u.__decorate([z.property()],E.prototype,"updating",null);
u.__decorate([z.property()],E.prototype,"viewState",void 0);return E=u.__decorate([k.subclass("esri.views.2d.layers.features.Pipeline")],E)});