// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Collection ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../geometry/support/vectorStacks ../../../layers/graphics/data/QueryEngineResult ./FeatureSnappingLayerSource ./snappingUtils ./featureSources/SceneLayerSnappingSource ../support/viewUtils".split(" "),
function(c,k,e,t,u,v,g,H,I,J,w,x,l,y,z,A,B){c.SceneSnappingEngine=function(m){function h(a){a=m.call(this,a)||this;a.options=null;a._snappingSources=new u;return a}k._inheritsLoose(h,m);var f=h.prototype;f.initialize=function(){this.own([this.view.on("layerview-create",({layerView:a})=>this._createSource(a)),this.view.on("layerview-destroy",({layerView:a})=>this._removeSource(a))]);for(const a of this.view.allLayerViews.items)this._createSource(a)};f.destroy=function(){this.options=null;this._snappingSources.drain(a=>
a.destroy())};f.fetchCandidates=function(){var a=k._asyncToGenerator(function*(d,b,n){const {view:p,options:q}=this,{coordinateHelper:r,elevationInfo:C}=b;b=v.isSome(q)?q.distance:1;const D=B.anyMapPointToRender(d,r,C,p,x.sv3d.get()),E=b*p.state.camera.computeScreenPixelSizeAt(D),F=this._types;b=this._snappingSources.items.map(G=>G.fetchCandidates({point:d,coordinateHelper:r,distance:E,types:F},n));b=(yield Promise.all(b)).flat();z.sortCandidatesInPlace(d,b);return b});return function(d,b,n){return a.apply(this,
arguments)}}();f._createSource=function(a){"scene-layer-3d"===a.type&&(a=new A.SceneLayerSnappingSource({layerSource:new y({layer:a.layer}),view:this.view}),this._snappingSources.push(a))};f._removeSource=function(a){const d=this._snappingSources.findIndex(b=>b.layerSource.layer===a.layer);-1!==d&&this._snappingSources.removeAt(d).destroy()};k._createClass(h,[{key:"updating",get:function(){return this._snappingSources.some(a=>a.updating)}},{key:"_types",get:function(){return l.SnappingTypes.EDGE|
l.SnappingTypes.VERTEX}}]);return h}(t);e.__decorate([g.property({constructOnly:!0})],c.SceneSnappingEngine.prototype,"view",void 0);e.__decorate([g.property()],c.SceneSnappingEngine.prototype,"updating",null);e.__decorate([g.property()],c.SceneSnappingEngine.prototype,"options",void 0);e.__decorate([g.property()],c.SceneSnappingEngine.prototype,"_snappingSources",void 0);c.SceneSnappingEngine=e.__decorate([w.subclass("esri.views.interactive.snapping.SceneSnappingEngine")],c.SceneSnappingEngine);
Object.defineProperties(c,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});