// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/HandleOwner ../../../../core/handleUtils ../../../../core/maybe ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../3d/webgl-engine/lib/edgeRendering/EdgeWorkerHandle ./sceneLayerSource/SceneLayerSnappingSourceWorkerHandle".split(" "),function(c,
e,f,r,m,n,h,w,x,y,t,u,v){c.SceneLayerSnappingSource=function(p){function k(a){a=p.call(this,a)||this;a.availability=1;a.abortController=new AbortController;return a}e._inheritsLoose(k,p);var g=k.prototype;g.destroy=function(){this.abortController=n.abortMaybe(this.abortController)};g.initialize=function(){var a=this;const d=this.view.resourceController;this.edgeWorker=new u(b=>d.schedule(b));this.workerHandle=new v.SceneLayerSnappingSourceWorkerHandle({view:this.view,schedule:b=>d.schedule(b),fetchEdgeLocations:function(){var b=
e._asyncToGenerator(function*(l,q){if(n.isNone(a.tracker))throw Error("tracker-not-initialized");return a.tracker.fetchEdgeLocations(l,a.edgeWorker,q)});return function(l,q){return b.apply(this,arguments)}}()});this.updatingHandles.addPromise(this._setupLayerView());this.handles.add([m.destroyHandle(this.workerHandle),m.destroyHandle(this.edgeWorker)])};g.fetchCandidates=function(){var a=e._asyncToGenerator(function*(d,b){return this.workerHandle.fetchCandidates(d,b)});return function(d,b){return a.apply(this,
arguments)}}();g.refresh=function(){};g._setupLayerView=function(){var a=e._asyncToGenerator(function*(){const d=yield this.view.whenLayerView(this.layer);"scene-layer-graphics-3d"!==d.type&&(this.tracker=d.trackSnappingSources({add:(b,l)=>this.updatingHandles.addPromise(this.workerHandle.add({id:b,bounds:l},this.abortController.signal)),remove:b=>this.updatingHandles.addPromise(this.workerHandle.remove({id:b},this.abortController.signal))}),this.handles.add(this.tracker))});return function(){return a.apply(this,
arguments)}}();e._createClass(k,[{key:"updating",get:function(){return this.updatingHandles.updating}},{key:"layer",get:function(){return this.layerSource.layer}}]);return k}(r.HandleOwner);f.__decorate([h.property({constructOnly:!0})],c.SceneLayerSnappingSource.prototype,"layerSource",void 0);f.__decorate([h.property({constructOnly:!0})],c.SceneLayerSnappingSource.prototype,"view",void 0);f.__decorate([h.property({readOnly:!0})],c.SceneLayerSnappingSource.prototype,"updating",null);f.__decorate([h.property({readOnly:!0})],
c.SceneLayerSnappingSource.prototype,"availability",void 0);c.SceneLayerSnappingSource=f.__decorate([t.subclass("esri.views.interactive.snapping.featureSources.SceneLayerSnappingSource")],c.SceneLayerSnappingSource);Object.defineProperties(c,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});