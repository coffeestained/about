// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
require({cache:{"esri/identity/IdentityManagerBase":function(){define("exports ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../config ../kernel ../request ../core/Error ../core/Evented ../core/events ../core/lang ../core/object ../core/promiseUtils ../core/reactiveUtils ../core/urlUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ./IdentityForm ./IdentityModal ./OAuthCredential ./OAuthInfo ./ServerInfo".split(" "),
function(E,B,w,t,x,M,H,ba,Y,R,N,C,Z,G,T,O,aa,la,ia,ea,W,ma){const ja={},oa=U=>{const X=(new G.Url(U.owningSystemUrl)).host;U=(new G.Url(U.server)).host;const u=/.+\.arcgis\.com$/i;return u.test(X)&&u.test(U)},na=(U,X)=>!!(oa(U)&&X&&X.some(u=>u.test(U.server)));let fa=null,pa=null;try{fa=window.localStorage,pa=window.sessionStorage}catch{}O=function(U){function X(){var a=U.call(this)||this;a._portalConfig=globalThis.esriGeowConfig;a.serverInfos=[];a.oAuthInfos=[];a.credentials=[];a._soReqs=[];a._xoReqs=
[];a._portals=[];a.defaultOAuthInfo=null;a.defaultTokenValidity=60;a.dialog=null;a.formConstructor=la;a.tokenValidity=null;a.normalizeWebTierAuth=!1;a._appOrigin="null"!==window.origin?window.origin:window.location.origin;a._appUrlObj=G.urlToObject(window.location.href);a._busy=null;a._rejectOnPersistedPageShow=!1;a._oAuthLocationParams=null;a._gwTokenUrl="/sharing/rest/generateToken";a._agsRest="/rest/services";a._agsPortal=/\/sharing(\/|$)/i;a._agsAdmin=/(https?:\/\/[^\/]+\/[^\/]+)\/admin\/?(\/.*)?$/i;
a._adminSvcs=/\/rest\/admin\/services(\/|$)/i;a._gwDomains=[{regex:/^https?:\/\/www\.arcgis\.com/i,customBaseUrl:"maps.arcgis.com",tokenServiceUrl:"https://www.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/(?:dev|[a-z\d-]+\.mapsdev)\.arcgis\.com/i,customBaseUrl:"mapsdev.arcgis.com",tokenServiceUrl:"https://dev.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/(?:devext|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,customBaseUrl:"mapsdevext.arcgis.com",tokenServiceUrl:"https://devext.arcgis.com/sharing/rest/generateToken"},
{regex:/^https?:\/\/(?:qaext|[a-z\d-]+\.mapsqa)\.arcgis\.com/i,customBaseUrl:"mapsqa.arcgis.com",tokenServiceUrl:"https://qaext.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/[a-z\d-]+\.maps\.arcgis\.com/i,customBaseUrl:"maps.arcgis.com",tokenServiceUrl:"https://www.arcgis.com/sharing/rest/generateToken"}];a._legacyFed=[];a._regexSDirUrl=/http.+\/rest\/services\/?/gi;a._regexServerType=/(\/(FeatureServer|GPServer|GeoDataServer|GeocodeServer|GeoenrichmentServer|GeometryServer|GlobeServer|ImageServer|KnowledgeGraphServer|MapServer|MobileServer|NAServer|NetworkDiagramServer|OGCFeatureServer|ParcelFabricServer|RelationalCatalogServer|SceneServer|StreamServer|UtilityNetworkServer|ValidationServer|VectorTileServer|VersionManagementServer)).*/gi;
a._gwUser=/http.+\/users\/([^\/]+)\/?.*/i;a._gwItem=/http.+\/items\/([^\/]+)\/?.*/i;a._gwGroup=/http.+\/groups\/([^\/]+)\/?.*/i;a._rePortalTokenSvc=/\/sharing(\/rest)?\/generatetoken/i;a._createDefaultOAuthInfo=!0;a._hasTestedIfAppIsOnPortal=!1;a._getOAuthLocationParams();window.addEventListener("pageshow",b=>{a._pageShowHandler(b)});return a}B._inheritsLoose(X,U);var u=X.prototype;u.registerServers=function(a){const b=this.serverInfos;b?(a=a.filter(c=>!this.findServerInfo(c.server)),this.serverInfos=
b.concat(a)):this.serverInfos=a;a.forEach(c=>{c.owningSystemUrl&&this._portals.push(c.owningSystemUrl);c.hasPortal&&this._portals.push(c.server)})};u.registerOAuthInfos=function(a){const b=this.oAuthInfos;if(b){for(const c of a){const d=this.findOAuthInfo(c.portalUrl);d&&b.splice(b.indexOf(d),1)}this.oAuthInfos=b.concat(a)}else this.oAuthInfos=a};u.registerToken=function(a){a={...a};const b=this._sanitizeUrl(a.server),c=this._isServerRsrc(b);let d=this.findServerInfo(b),f=!0,l;d||(d=new ma,d.server=
this._getServerInstanceRoot(b),c?d.hasServer=!0:(d.tokenServiceUrl=this._getTokenSvcUrl(b),d.hasPortal=!0),this.registerServers([d]));(l=this._findCredential(b))?(delete a.server,Object.assign(l,a),f=!1):(l=new E.Credential({userId:a.userId,server:d.server,token:a.token,expires:a.expires,ssl:a.ssl,scope:c?"server":"portal"}),l.resources=[b],this.credentials.push(l));l.emitTokenChange(!1);f||l.refreshServerTokens()};u.toJSON=function(){return R.fixJson({serverInfos:this.serverInfos.map(a=>a.toJSON()),
oAuthInfos:this.oAuthInfos.map(a=>a.toJSON()),credentials:this.credentials.map(a=>a.toJSON())})};u.initialize=function(a){if(a){"string"===typeof a&&(a=JSON.parse(a));var b=a.serverInfos,c=a.oAuthInfos;a=a.credentials;if(b){const d=[];b.forEach(f=>{f.server&&f.tokenServiceUrl&&d.push(f.declaredClass?f:new ma(f))});d.length&&this.registerServers(d)}if(c){const d=[];c.forEach(f=>{f.appId&&d.push(f.declaredClass?f:new W(f))});d.length&&this.registerOAuthInfos(d)}a&&a.forEach(d=>{d.server&&d.token&&d.expires&&
d.expires>Date.now()&&(d=d.declaredClass?d:new E.Credential(d),d.emitTokenChange(),this.credentials.push(d))})}};u.findServerInfo=function(a){let b;a=this._sanitizeUrl(a);for(const c of this.serverInfos)if(this._hasSameServerInstance(c.server,a)){b=c;break}return b};u.findOAuthInfo=function(a){let b;a=this._sanitizeUrl(a);for(const c of this.oAuthInfos)if(this._hasSameServerInstance(c.portalUrl,a)){b=c;break}return b};u.findCredential=function(a,b){let c;a=this._sanitizeUrl(a);const d=this._isServerRsrc(a)?
"server":"portal";if(b)for(const f of this.credentials){if(this._hasSameServerInstance(f.server,a)&&b===f.userId&&f.scope===d){c=f;break}}else for(const f of this.credentials)if(this._hasSameServerInstance(f.server,a)&&-1!==this._getIdenticalSvcIdx(a,f)&&f.scope===d){c=f;break}return c};u.getCredential=function(a,b){let c=!0;if(b){var d=!!b.token;var f=b.error;c=!1!==b.prompt}b={...b};a=this._sanitizeUrl(a);const l=new AbortController,v=C.createResolver();if(b.signal)C.onAbort(b.signal,()=>{l.abort()});
C.onAbort(l,()=>{v.reject(new H("identity-manager:user-aborted","ABORTED"))});if(C.isAborted(l))return v.promise;b.signal=l.signal;const z=this._isAdminResource(a);if((d=d?this.findCredential(a):null)&&f&&f.details&&498===f.details.httpStatus)d.destroy();else if(d)return a=new H("identity-manager:not-authorized","You are currently signed in as: '"+d.userId+"'. You do not have access to this resource: "+a,{error:f}),v.reject(a),v.promise;if(f=this._findCredential(a,b))return v.resolve(f),v.promise;
let h=this.findServerInfo(a);if(h)!h.hasServer&&this._isServerRsrc(a)&&(h._restInfoPms=this._getTokenSvcUrl(a),h.hasServer=!0);else{f=this._getTokenSvcUrl(a);if(!f)return a=new H("identity-manager:unknown-resource","Unknown resource - could not find token service endpoint."),v.reject(a),v.promise;h=new ma;h.server=this._getServerInstanceRoot(a);"string"===typeof f?(h.tokenServiceUrl=f,h.hasPortal=!0):(h._restInfoPms=f,h.hasServer=!0);this.registerServers([h])}h.hasPortal&&void 0===h._selfReq&&(c||
G.hasSameOrigin(h.tokenServiceUrl,this._appOrigin)||this._gwDomains.some(q=>q.tokenServiceUrl===h.tokenServiceUrl))&&(h._selfReq={owningTenant:b&&b.owningTenant,selfDfd:this._getPortalSelf(h.tokenServiceUrl.replace(this._rePortalTokenSvc,"/sharing/rest/portals/self"),a)});return this._enqueue(a,h,b,v,z)};u.getResourceName=function(a){return this._isRESTService(a)?a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"")||"":this._gwUser.test(a)&&a.replace(this._gwUser,"$1")||this._gwItem.test(a)&&
a.replace(this._gwItem,"$1")||this._gwGroup.test(a)&&a.replace(this._gwGroup,"$1")||""};u.generateToken=function(a,b,c){const d=this._rePortalTokenSvc.test(a.tokenServiceUrl),f=new G.Url(this._appOrigin);var l=a.shortLivedTokenValidity;let v,z,h,q,F,r,k;b&&(k=this.tokenValidity||l||this.defaultTokenValidity,k>l&&0<l&&(k=l));c&&(v=c.isAdmin,z=c.serverUrl,h=c.token,F=c.signal,r=c.ssl,a.customParameters=c.customParameters);v?l=a.adminTokenServiceUrl:(l=a.tokenServiceUrl,q=new G.Url(l.toLowerCase()),
a.webTierAuth&&null!=c&&c.serverUrl&&!r&&"http"===f.scheme&&(G.hasSameOrigin(f.uri,l,!0)||"https"===q.scheme&&f.host===q.host&&"7080"===f.port&&"7443"===q.port)&&(l=l.replace(/^https:/i,"http:").replace(/:7443/i,":7080")));c={query:{request:"getToken",username:null==b?void 0:b.username,password:null==b?void 0:b.password,serverUrl:z,token:h,expiration:k,referer:v||d?this._appOrigin:null,client:v?"referer":null,f:"json",...a.customParameters},method:"post",authMode:"anonymous",useProxy:this._useProxy(a,
c),signal:F,...null==c?void 0:c.ioArgs};d||(c.withCredentials=!1);return M(l,c).then(g=>{g=g.data;if(!g||!g.token)return new H("identity-manager:authentication-failed","Unable to generate token");const e=a.server;ja[e]||(ja[e]={});b&&(ja[e][b.username]=b.password);g.validity=k;return g})};u.isBusy=function(){return!!this._busy};u.checkSignInStatus=function(a){return this.checkAppAccess(a,"").then(b=>b.credential)};u.checkAppAccess=function(a,b,c){let d=!1;return this.getCredential(a,{prompt:!1}).then(f=>
{let l;const v={f:"json"};if("portal"===f.scope)if(b&&(this._doPortalSignIn(a)||c&&c.force))l=f.server+"/sharing/rest/oauth2/validateAppAccess",v.client_id=b;else if(f.token)l=f.server+"/sharing/rest";else return{credential:f};else if(f.token)l=f.server+"/rest/services";else return{credential:f};f.token&&(v.token=f.token);return M(l,{query:v,authMode:"anonymous"}).then(z=>{if(!1===z.data.valid)throw new H("identity-manager:not-authorized",`You are currently signed in as: '${f.userId}'.`,z.data);d=
!!z.data.viewOnlyUserTypeApp;return{credential:f}}).catch(z=>{if("identity-manager:not-authorized"===z.name)throw z;z=z.details&&z.details.httpStatus;if(498===z)throw f.destroy(),new H("identity-manager:not-authenticated","User is not signed in.");if(400===z)throw new H("identity-manager:invalid-request");return{credential:f}})}).then(f=>({credential:f.credential,viewOnly:d}))};u.setOAuthResponseHash=function(a){a&&("#"===a.charAt(0)&&(a=a.substring(1)),this._processOAuthPopupParams(G.queryToObject(a)))};
u.setOAuthRedirectionHandler=function(a){this._oAuthRedirectFunc=a};u.setProtocolErrorHandler=function(a){this._protocolFunc=a};u.signIn=function(a,b,c={}){const d=C.createResolver(),f=()=>{var F,r,k,g,e;null==(F=z)?void 0:F.remove();null==(r=h)?void 0:r.remove();null==(k=q)?void 0:k.remove();null==(g=v)?void 0:g.destroy();null==(e=this.dialog)?void 0:e.destroy();this.dialog=v=z=h=q=null},l=()=>{f();this._oAuthDfd=null;d.reject(new H("identity-manager:user-aborted","ABORTED"))};if(c.signal)C.onAbort(c.signal,
()=>{l()});let v=new this.formConstructor;v.resource=this.getResourceName(a);v.server=b.server;this.dialog=new ia;this.dialog.content=v;this.dialog.open=!0;this.emit("dialog-create");let z=v.on("cancel",l),h=Z.watch(()=>this.dialog.open,l),q=v.on("submit",F=>{this.generateToken(b,F,{isAdmin:c.isAdmin,signal:c.signal}).then(r=>{f();r=new E.Credential({userId:F.username,server:b.server,token:r.token,expires:null!=r.expires?Number(r.expires):null,ssl:!!r.ssl,isAdmin:c.isAdmin,validity:r.validity});d.resolve(r)}).catch(r=>
{v.error=r;v.signingIn=!1})});return d.promise};u.oAuthSignIn=function(a,b,c,d){const f=this._oAuthDfd=C.createResolver();if(null!=d&&d.signal)C.onAbort(d.signal,()=>{const g=this._oAuthDfd&&this._oAuthDfd.oAuthWin_;g&&!g.closed?g.close():this.dialog&&r()});f.resUrl_=a;f.sinfo_=b;f.oinfo_=c;let l;const v=c._oAuthCred;if(v.storage&&("authorization-code"===c.flowType||"auto"===c.flowType&&!c.popup&&8.4<=b.currentVersion)){let g=crypto.getRandomValues(new Uint8Array(32));l=G.base64UrlEncode(g);v.codeVerifier=
l;g=crypto.getRandomValues(new Uint8Array(32));v.stateUID=G.base64UrlEncode(g);v.save()||(v.codeVerifier=l=null)}else v.codeVerifier=null;this._getCodeChallenge(l).then(g=>{const e=!d||!1!==d.oAuthPopupConfirmation;c.popup&&e?(z=new this.formConstructor,z.oAuthPrompt=!0,z.server=b.server,this.dialog=new ia,this.dialog.content=z,this.dialog.open=!0,this.emit("dialog-create"),h=z.on("cancel",r),q=Z.watch(()=>this.dialog.open,r),F=z.on("submit",()=>{k();this._doOAuthSignIn(a,b,c,g)})):this._doOAuthSignIn(a,
b,c,g)});let z,h,q,F;const r=()=>{k();this._oAuthDfd=null;f.reject(new H("identity-manager:user-aborted","ABORTED"))},k=()=>{var g,e,n,m,A;null==(g=h)?void 0:g.remove();null==(e=q)?void 0:e.remove();null==(n=F)?void 0:n.remove();null==(m=z)?void 0:m.destroy();null==(A=this.dialog)?void 0:A.destroy();this.dialog=null};return f.promise};u.destroyCredentials=function(){this.credentials&&this.credentials.slice().forEach(a=>{a.destroy()});this.emit("credentials-destroy")};u.enablePostMessageAuth=function(a=
"https://www.arcgis.com/sharing/rest"){this._postMessageAuthHandle&&this._postMessageAuthHandle.remove();this._postMessageAuthHandle=Y.on(window,"message",b=>{var c;if((b.origin===this._appOrigin||b.origin.endsWith(".arcgis.com"))&&"arcgis:auth:requestCredential"===(null==(c=b.data)?void 0:c.type)){const d=b.source;this.getCredential(a).then(f=>{d.postMessage({type:"arcgis:auth:credential",credential:{expires:f.expires,server:f.server,ssl:f.ssl,token:f.token,userId:f.userId}},b.origin)}).catch(f=>
{d.postMessage({type:"arcgis:auth:error",error:{name:f.name,message:f.message}},b.origin)})}})};u.disablePostMessageAuth=function(){this._postMessageAuthHandle&&(this._postMessageAuthHandle.remove(),this._postMessageAuthHandle=null)};u._getOAuthLocationParams=function(){var a=window.location.hash;if(a){"#"===a.charAt(0)&&(a=a.substring(1));a=G.queryToObject(a);let d=!1;if(a.access_token&&a.expires_in&&a.state&&a.hasOwnProperty("username"))try{a.state=JSON.parse(a.state),a.state.portalUrl&&(this._oAuthLocationParams=
a,d=!0)}catch{}else if(a.error&&a.error_description&&(console.log("IdentityManager OAuth Error: ",a.error," - ",a.error_description),"access_denied"===a.error&&(d=!0,a.state)))try{a.state=JSON.parse(a.state)}catch{}if(d){var b;window.location.hash=(null==(b=a.state)?void 0:b.hash)||""}}if(b=window.location.search){"?"===b.charAt(0)&&(b=b.substring(1));b=G.queryToObject(b);a=!1;if(b.code&&b.state)try{b.state=JSON.parse(b.state),b.state.portalUrl&&b.state.uid&&(this._oAuthLocationParams=b,a=!0)}catch{}else if(b.error&&
b.error_description&&(console.log("IdentityManager OAuth Error: ",b.error," - ",b.error_description),"access_denied"===b.error&&(a=!0,b.state)))try{b.state=JSON.parse(b.state)}catch{}if(a){var c;const d={...b};"code error error_description message_code persist state".split(" ").forEach(f=>{delete d[f]});a=G.objectToQuery(d);b=window.location.pathname+(a?`?${a}`:"")+((null==(c=b.state)?void 0:c.hash)||"");window.history.replaceState(window.history.state,"",b)}}};u._getOAuthToken=function(a,b,c,d,f){a=
a.replace(/^http:/i,"https:");return M(`${a}/sharing/rest/oauth2/token`,{authMode:"anonymous",method:"post",query:d&&f?{grant_type:"authorization_code",code:b,redirect_uri:d,client_id:c,code_verifier:f}:{grant_type:"refresh_token",refresh_token:b,client_id:c}}).then(l=>l.data)};u._getCodeChallenge=function(a){return a&&globalThis.isSecureContext?(a=(new TextEncoder).encode(a),crypto.subtle.digest("SHA-256",a).then(b=>G.base64UrlEncode(new Uint8Array(b)))):Promise.resolve(null)};u._pageShowHandler=
function(a){a.persisted&&this.isBusy()&&this._rejectOnPersistedPageShow&&(a=new H("identity-manager:user-aborted","ABORTED"),this._errbackFunc(a))};u._findCredential=function(a,b){let c=-1,d,f,l;const v=b&&b.token;b=b&&b.resource;const z=this._isServerRsrc(a)?"server":"portal",h=this.credentials.filter(q=>this._hasSameServerInstance(q.server,a)&&q.scope===z);a=b||a;if(h.length)if(1===h.length)if(b=h[0],f=(d=(l=this.findServerInfo(b.server))&&l.owningSystemUrl)&&this.findCredential(d,b.userId),c=this._getIdenticalSvcIdx(a,
b),v)-1!==c&&(b.resources.splice(c,1),this._removeResource(a,f));else return-1===c&&b.resources.push(a),this._addResource(a,f),b;else{let q,F;h.some(r=>{F=this._getIdenticalSvcIdx(a,r);return-1!==F?(q=r,f=(d=(l=this.findServerInfo(q.server))&&l.owningSystemUrl)&&this.findCredential(d,q.userId),c=F,!0):!1});if(v)q&&(q.resources.splice(c,1),this._removeResource(a,f));else if(q)return this._addResource(a,f),q}};u._findOAuthInfo=function(a){let b=this.findOAuthInfo(a);if(!b)for(const c of this.oAuthInfos)if(this._isIdProvider(c.portalUrl,
a)){b=c;break}return b};u._addResource=function(a,b){b&&-1===this._getIdenticalSvcIdx(a,b)&&b.resources.push(a)};u._removeResource=function(a,b){let c=-1;b&&(c=this._getIdenticalSvcIdx(a,b),-1<c&&b.resources.splice(c,1))};u._useProxy=function(a,b){return b&&b.isAdmin&&!G.hasSameOrigin(a.adminTokenServiceUrl,this._appOrigin)||!this._isPortalDomain(a.tokenServiceUrl)&&"10.1"===String(a.currentVersion)&&!G.hasSameOrigin(a.tokenServiceUrl,this._appOrigin)};u._getOrigin=function(a){a=new G.Url(a);return a.scheme+
"://"+a.host+(null!=a.port?":"+a.port:"")};u._getServerInstanceRoot=function(a){const b=a.toLowerCase();let c=b.indexOf(this._agsRest);-1===c&&this._isAdminResource(a)&&(c=this._agsAdmin.test(a)?a.replace(this._agsAdmin,"$1").length:a.search(this._adminSvcs));-1===c&&(c=b.indexOf("/sharing"));-1===c&&"/"===b.substr(-1)&&(c=b.length-1);return-1<c?a.substring(0,c):a};u._hasSameServerInstance=function(a,b){"/"===a.substr(-1)&&(a=a.slice(0,-1));a=a.toLowerCase();b=this._getServerInstanceRoot(b).toLowerCase();
a=this._normalizeAGOLorgDomain(a);b=this._normalizeAGOLorgDomain(b);a=a.substr(a.indexOf(":"));b=b.substr(b.indexOf(":"));return a===b};u._normalizeAGOLorgDomain=function(a){const b=/^https?:\/\/(?:cdn|[a-z\d-]+\.maps)\.arcgis\.com/i,c=/^https?:\/\/(?:cdndev|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,d=/^https?:\/\/(?:cdnqa|[a-z\d-]+\.mapsqa)\.arcgis\.com/i;b.test(a)?a=a.replace(b,"https://www.arcgis.com"):c.test(a)?a=a.replace(c,"https://devext.arcgis.com"):d.test(a)&&(a=a.replace(d,"https://qaext.arcgis.com"));
return a};u._sanitizeUrl=function(a){const b=(t.request.proxyUrl||"").toLowerCase(),c=b?a.toLowerCase().indexOf(b+"?"):-1;-1!==c&&(a=a.substring(c+b.length+1));a=G.normalize(a);return G.urlToObject(a).path};u._isRESTService=function(a){return a.includes(this._agsRest)};u._isAdminResource=function(a){return this._agsAdmin.test(a)||this._adminSvcs.test(a)};u._isServerRsrc=function(a){return this._isRESTService(a)||this._isAdminResource(a)};u._isIdenticalService=function(a,b){if(this._isRESTService(a)&&
this._isRESTService(b)){a=this._getSuffix(a).toLowerCase();b=this._getSuffix(b).toLowerCase();var c=a===b;c||(c=/(.*)\/(MapServer|FeatureServer|UtilityNetworkServer).*/gi,c=a.replace(c,"$1")===b.replace(c,"$1"))}else this._isAdminResource(a)&&this._isAdminResource(b)?c=!0:this._isServerRsrc(a)||this._isServerRsrc(b)||!this._isPortalDomain(a)||(c=!0);return c};u._isPortalDomain=function(a){const b=new G.Url(a.toLowerCase());a=this._portalConfig;let c=this._gwDomains.some(d=>d.regex.test(b.uri));!c&&
a&&(c=this._hasSameServerInstance(this._getServerInstanceRoot(a.restBaseUrl),b.uri));c||t.portalUrl&&(c=G.hasSameOrigin(b,t.portalUrl,!0));c||(c=this._portals.some(d=>this._hasSameServerInstance(d,b.uri)));return c=c||this._agsPortal.test(b.path)};u._isIdProvider=function(a,b){let c=-1,d=-1;this._gwDomains.forEach((l,v)=>{-1===c&&l.regex.test(a)&&(c=v);-1===d&&l.regex.test(b)&&(d=v)});let f=!1;if(-1<c&&-1<d)if(0===c||4===c){if(0===d||4===d)f=!0}else if(1===c){if(1===d||2===d)f=!0}else 2===c?2===d&&
(f=!0):3===c&&3===d&&(f=!0);if(!f){const l=this.findServerInfo(b),v=l&&l.owningSystemUrl;v&&oa(l)&&this._isPortalDomain(v)&&this._isIdProvider(a,v)&&(f=!0)}return f};u._getIdenticalSvcIdx=function(a,b){let c=-1;for(let d=0;d<b.resources.length;d++)if(this._isIdenticalService(a,b.resources[d])){c=d;break}return c};u._getSuffix=function(a){return a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"$1")};u._getTokenSvcUrl=function(a){if(this._isRESTService(a)||this._isAdminResource(a)){var b=
this._getServerInstanceRoot(a);var c=b+"/admin/generateToken";a=b+"/rest/info";b=M(a,{query:{f:"json"}}).then(d=>d.data);return{adminUrl:c,promise:b}}if(this._isPortalDomain(a)){let d="";this._gwDomains.some(f=>{f.regex.test(a)&&(d=f.tokenServiceUrl);return!!d});d||this._portals.some(f=>{this._hasSameServerInstance(f,a)&&(d=f+this._gwTokenUrl);return!!d});d||(c=a.toLowerCase().indexOf("/sharing"),-1!==c&&(d=a.substring(0,c)+this._gwTokenUrl));d||(d=this._getOrigin(a)+this._gwTokenUrl);d&&(c=(new G.Url(a)).port,
/^http:\/\//i.test(a)&&"7080"===c&&(d=d.replace(/:7080/i,":7443")),d=d.replace(/http:/i,"https:"));return d}if(a.toLowerCase().includes("premium.arcgisonline.com"))return"https://premium.arcgisonline.com/server/tokens"};u._processOAuthResponseParams=function(a,b,c){const d=b._oAuthCred;if(a.code){var f=d.codeVerifier;d.codeVerifier=null;d.stateUID=null;d.save();return this._getOAuthToken(c.server,a.code,b.appId,this._getRedirectURI(b,!0),f).then(l=>{const v=new E.Credential({userId:l.username,server:c.server,
token:l.access_token,expires:Date.now()+1E3*l.expires_in,ssl:l.ssl,oAuthState:a.state,_oAuthCred:d});b.userId=v.userId;d.storage=l.persist?fa:pa;d.refreshToken=l.refresh_token;d.token=null;d.expires=l.refresh_token_expires_in?Date.now()+1E3*l.refresh_token_expires_in:null;d.userId=v.userId;d.ssl=v.ssl;d.save();return v})}f=new E.Credential({userId:a.username,server:c.server,token:a.access_token,expires:Date.now()+1E3*Number(a.expires_in),ssl:"true"===a.ssl,oAuthState:a.state,_oAuthCred:d});b.userId=
f.userId;d.storage=a.persist?fa:pa;d.refreshToken=null;d.token=f.token;d.expires=f.expires;d.userId=f.userId;d.ssl=f.ssl;d.save();return Promise.resolve(f)};u._processOAuthPopupParams=function(a){var b;const c=this._oAuthDfd;this._oAuthDfd=null;c&&(clearInterval(this._oAuthIntervalId),null==(b=this._oAuthOnPopupHandle)?void 0:b.remove(),a.error?(b="access_denied"===a.error,a=new H(b?"identity-manager:user-aborted":"identity-manager:authentication-failed",b?"ABORTED":"OAuth: "+a.error+" - "+a.error_description),
c.reject(a)):this._processOAuthResponseParams(a,c.oinfo_,c.sinfo_).then(d=>{c.resolve(d)}).catch(d=>{c.reject(d)}))};u._setOAuthResponseQueryString=function(a){a&&("?"===a.charAt(0)&&(a=a.substring(1)),this._processOAuthPopupParams(G.queryToObject(a)))};u._exchangeToken=function(a,b,c){return M(`${a}/sharing/rest/oauth2/exchangeToken`,{authMode:"anonymous",method:"post",query:{f:"json",client_id:b,token:c}}).then(d=>d.data.token)};u._getPlatformSelf=function(a,b){a=a.replace(/^http:/i,"https:");return M(`${a}/sharing/rest/oauth2/platformSelf`,
{authMode:"anonymous",headers:{"X-Esri-Auth-Client-Id":b,"X-Esri-Auth-Redirect-Uri":window.location.href.replace(/#.*$/,"")},method:"post",query:{f:"json",expiration:30},withCredentials:!0}).then(c=>c.data)};u._getPortalSelf=function(a,b){let c;this._gwDomains.some(d=>{d.regex.test(a)&&(c=d.customBaseUrl);return!!c});if(c)return Promise.resolve({allSSL:!0,currentVersion:"8.4",customBaseUrl:c,portalMode:"multitenant",supportsOAuth:!0});this._appOrigin.startsWith("https:")?a=a.replace(/^http:/i,"https:").replace(/:7080/i,
":7443"):/^http:/i.test(b)&&(a=a.replace(/^https:/i,"http:").replace(/:7443/i,":7080"));return M(a,{query:{f:"json"},authMode:"anonymous",withCredentials:!0}).then(d=>d.data)};u._doPortalSignIn=function(a){const b=this._portalConfig,c=window.location.href,d=this.findServerInfo(a);return(b||this._isPortalDomain(c))&&(d?d.hasPortal||d.owningSystemUrl&&this._isPortalDomain(d.owningSystemUrl):this._isPortalDomain(a))&&(this._isIdProvider(c,a)||b&&(this._hasSameServerInstance(this._getServerInstanceRoot(b.restBaseUrl),
a)||this._isIdProvider(b.restBaseUrl,a))||G.hasSameOrigin(c,a,!0))?!0:!1};u._checkProtocol=function(a,b,c,d){let f=!0;d=d?b.adminTokenServiceUrl:b.tokenServiceUrl;d.trim().toLowerCase().startsWith("https:")&&!this._appOrigin.startsWith("https:")&&G.getProxyRule(d)&&(f=this._protocolFunc?!!this._protocolFunc({resourceUrl:a,serverInfo:b}):!1,f||(a=new H("identity-manager:aborted","Aborted the Sign-In process to avoid sending password over insecure connection."),c(a)));return f};u._enqueue=function(a,
b,c,d,f,l){d||(d=C.createResolver());d.resUrl_=a;d.sinfo_=b;d.options_=c;d.admin_=f;d.refresh_=l;this._busy?this._hasSameServerInstance(this._getServerInstanceRoot(a),this._busy.resUrl_)?(this._oAuthDfd&&this._oAuthDfd.oAuthWin_&&this._oAuthDfd.oAuthWin_.focus(),this._soReqs.push(d)):this._xoReqs.push(d):this._doSignIn(d);return d.promise};u._doSignIn=function(a){this._busy=a;this._rejectOnPersistedPageShow=!1;const b=h=>{var q=a.options_&&a.options_.resource;const F=a.resUrl_,r=a.refresh_;let k=
!1;this.credentials.includes(h)||(r&&this.credentials.includes(r)?(r.userId=h.userId,r.token=h.token,r.expires=h.expires,r.validity=h.validity,r.ssl=h.ssl,r.creationTime=h.creationTime,k=!0,h=r):this.credentials.push(h));h.resources||(h.resources=[]);h.resources.includes(q||F)||h.resources.push(q||F);h.scope=this._isServerRsrc(F)?"server":"portal";h.emitTokenChange();q=this._soReqs;const g={};this._soReqs=[];q.forEach(e=>{if(!this._isIdenticalService(F,e.resUrl_)){const n=this._getSuffix(e.resUrl_);
g[n]||(g[n]=!0,h.resources.push(e.resUrl_))}});a.resolve(h);q.forEach(e=>{this._hasSameServerInstance(this._getServerInstanceRoot(F),e.resUrl_)?e.resolve(h):this._soReqs.push(e)});this._busy=a.resUrl_=a.sinfo_=a.refresh_=null;k||this.emit("credential-create",{credential:h});this._soReqs.length?this._doSignIn(this._soReqs.shift()):this._xoReqs.length&&this._doSignIn(this._xoReqs.shift())},c=h=>{a.reject(h);this._busy=a.resUrl_=a.sinfo_=a.refresh_=null;this._soReqs.length?this._doSignIn(this._soReqs.shift()):
this._xoReqs.length&&this._doSignIn(this._xoReqs.shift())},d=(h,q,F,r)=>{var k,g;const e=a.sinfo_,n=!a.options_||!1!==a.options_.prompt,m=e.hasPortal&&this._findOAuthInfo(a.resUrl_);let A,D;if(h)b(new E.Credential({userId:h,server:e.server,token:F||null,expires:null!=r?Number(r):null,ssl:!!q}));else if(window!==window.parent&&null!=(k=this._appUrlObj.query)&&k["arcgis-auth-origin"]&&null!=(g=this._appUrlObj.query)&&g["arcgis-auth-portal"]&&this._hasSameServerInstance(this._getServerInstanceRoot(this._appUrlObj.query["arcgis-auth-portal"]),
a.resUrl_)){var I;window.parent.postMessage({type:"arcgis:auth:requestCredential"},this._appUrlObj.query["arcgis-auth-origin"]);const J=Y.on(window,"message",L=>{L.source===window.parent&&L.data&&("arcgis:auth:credential"===L.data.type?(J.remove(),L.data.credential.expires<Date.now()?c(new H("identity-manager:credential-request-failed","Parent application's token has expired.")):b(new E.Credential(L.data.credential))):"arcgis:auth:error"===L.data.type&&(J.remove(),"tokenExpiredError"===L.data.error.name?
c(new H("identity-manager:credential-request-failed","Parent application's token has expired.")):c(H.fromJSON(L.data.error))))});C.onAbort(null==(I=a.options_)?void 0:I.signal,()=>{J.remove()})}else if(m){let J=m._oAuthCred;J||(h=new ea(m,fa),q=new ea(m,pa),h.isValid()&&q.isValid()?h.expires>q.expires?(J=h,q.destroy()):(J=q,h.destroy()):J=h.isValid()?h:q,m._oAuthCred=J);if(J.isValid()){A=new E.Credential({userId:J.userId,server:e.server,token:J.token,expires:J.expires,ssl:J.ssl,_oAuthCred:J});const L=
m.appId!==J.appId&&this._doPortalSignIn(a.resUrl_);L||J.refreshToken?(a._pendingDfd=J.refreshToken?this._getOAuthToken(e.server,J.refreshToken,J.appId).then(K=>{A.expires=Date.now()+1E3*K.expires_in;A.token=K.access_token;return A}):Promise.resolve(A),a._pendingDfd.then(K=>L?this._exchangeToken(K.server,m.appId,K.token).then(ca=>{K.token=ca;return K}).catch(()=>K):K).then(K=>{b(K)}).catch(()=>{J.destroy();d()})):b(A)}else if(this._oAuthLocationParams&&this._hasSameServerInstance(m.portalUrl,this._oAuthLocationParams.state.portalUrl)&&
(this._oAuthLocationParams.access_token||this._oAuthLocationParams.code&&this._oAuthLocationParams.state.uid===J.stateUID&&J.codeVerifier))h=this._oAuthLocationParams,this._oAuthLocationParams=null,a._pendingDfd=this._processOAuthResponseParams(h,m,e).then(L=>{b(L)}).catch(c);else{const L=()=>{n?a._pendingDfd=this.oAuthSignIn(a.resUrl_,e,m,a.options_).then(b,c):(D=new H("identity-manager:not-authenticated","User is not signed in."),c(D))};this._doPortalSignIn(a.resUrl_)?a._pendingDfd=this._getPlatformSelf(e.server,
m.appId).then(K=>{G.hasSameOrigin(K.portalUrl,this._appOrigin,!0)?(A=new E.Credential({userId:K.username,server:e.server,expires:Date.now()+1E3*K.expires_in,token:K.token}),b(A)):L()}).catch(L):L()}}else n?this._checkProtocol(a.resUrl_,e,c,a.admin_)&&(h=a.options_,a.admin_&&(h=h||{},h.isAdmin=!0),a._pendingDfd=this.signIn(a.resUrl_,e,h).then(b,c)):(D=new H("identity-manager:not-authenticated","User is not signed in."),c(D))},f=()=>{const h=a.sinfo_;var q=h.owningSystemUrl;const F=a.options_;let r,
k,g,e;F&&(r=F.token,k=F.error,g=F.prompt);e=this._findCredential(q,{token:r,resource:a.resUrl_});if(!e)for(const n of this.credentials)if(this._isIdProvider(q,n.server)){e=n;break}e?(q=this.findCredential(a.resUrl_,e.userId))?b(q):na(h,this._legacyFed)?(q=e.toJSON(),q.server=h.server,q.resources=null,b(new E.Credential(q))):(a._pendingDfd=this.generateToken(this.findServerInfo(e.server),null,{serverUrl:a.resUrl_,token:e.token,signal:a.options_.signal,ssl:e.ssl})).then(n=>{b(new E.Credential({userId:e.userId,
server:h.server,token:n.token,expires:null!=n.expires?Number(n.expires):null,ssl:!!n.ssl,isAdmin:a.admin_,validity:n.validity}))},c):(this._busy=null,r&&(a.options_.token=null),(a._pendingDfd=this.getCredential(q.replace(/\/?$/,"/sharing"),{resource:a.resUrl_,owningTenant:h.owningTenant,signal:a.options_.signal,token:r,error:k,prompt:g})).then(()=>{this._enqueue(a.resUrl_,a.sinfo_,a.options_,a,a.admin_)},n=>{a.resUrl_=a.sinfo_=a.refresh_=null;a.reject(n)}))};this._errbackFunc=c;const l=a.sinfo_.owningSystemUrl,
v=this._isServerRsrc(a.resUrl_),z=a.sinfo_._restInfoPms;z?z.promise.then(h=>{const q=a.sinfo_;q._restInfoPms&&(q.adminTokenServiceUrl=q._restInfoPms.adminUrl,q._restInfoPms=null,q.tokenServiceUrl=N.getDeepValue("authInfo.tokenServicesUrl",h)||N.getDeepValue("authInfo.tokenServiceUrl",h)||N.getDeepValue("tokenServiceUrl",h),q.shortLivedTokenValidity=N.getDeepValue("authInfo.shortLivedTokenValidity",h),q.currentVersion=h.currentVersion,q.owningTenant=h.owningTenant,(h=q.owningSystemUrl=h.owningSystemUrl)&&
this._portals.push(h));v&&q.owningSystemUrl?f():d()},()=>{a.sinfo_._restInfoPms=null;const h=new H("identity-manager:server-identification-failed","Unknown resource - could not find token service endpoint.");c(h)}):v&&l?f():a.sinfo_._selfReq?a.sinfo_._selfReq.selfDfd.then(h=>{const q={};let F,r,k,g;h&&(F=h.user&&h.user.username,q.username=F,q.allSSL=h.allSSL,r=h.supportsOAuth,k=parseFloat(h.currentVersion),"multitenant"===h.portalMode&&(g=h.customBaseUrl),a.sinfo_.currentVersion=k);a.sinfo_.webTierAuth=
!!F;return F&&this.normalizeWebTierAuth?this.generateToken(a.sinfo_,null,{ssl:q.allSSL}).catch(()=>null).then(e=>{q.portalToken=e&&e.token;q.tokenExpiration=e&&e.expires;return q}):!F&&r&&4.4<=k&&!this._findOAuthInfo(a.resUrl_)?this._generateOAuthInfo({portalUrl:a.sinfo_.server,customBaseUrl:g,owningTenant:a.sinfo_._selfReq.owningTenant}).catch(()=>null).then(()=>q):q}).catch(()=>null).then(h=>{a.sinfo_._selfReq=null;h?d(h.username,h.allSSL,h.portalToken,h.tokenExpiration):d()}):d()};u._generateOAuthInfo=
function(a){let b,c=a.portalUrl;const d=a.customBaseUrl,f=a.owningTenant;if(a=!this.defaultOAuthInfo&&this._createDefaultOAuthInfo&&!this._hasTestedIfAppIsOnPortal){b=window.location.href;let l=b.indexOf("?");-1<l&&(b=b.slice(0,l));l=b.search(/\/(apps|home)\//);b=-1<l?b.slice(0,l):null}a&&b?(this._hasTestedIfAppIsOnPortal=!0,a=M(b+"/sharing/rest",{query:{f:"json"}}).then(()=>{this.defaultOAuthInfo=new W({appId:"arcgisonline",popupCallbackUrl:b+"/home/oauth-callback.html"})})):a=Promise.resolve();
return a.then(()=>{if(this.defaultOAuthInfo)return c=c.replace(/^http:/i,"https:"),M(c+"/sharing/rest/oauth2/validateRedirectUri",{query:{accountId:f,client_id:this.defaultOAuthInfo.appId,redirect_uri:G.makeAbsolute(this.defaultOAuthInfo.popupCallbackUrl),f:"json"}}).then(l=>{if(l.data.valid){const v=this.defaultOAuthInfo.clone();v.portalUrl=l.data.urlKey&&d?"https://"+l.data.urlKey.toLowerCase()+"."+d:c;v.popup=window!==window.top||!(G.hasSameOrigin(c,this._appOrigin)||this._gwDomains.some(z=>z.regex.test(c)&&
z.regex.test(this._appOrigin)));this.oAuthInfos.push(v)}})})};u._doOAuthSignIn=function(a,b,c,d){var f=c._oAuthCred,l={portalUrl:c.portalUrl};!c.popup&&c.preserveUrlHash&&window.location.hash&&(l.hash=window.location.hash);f.stateUID&&(l.uid=f.stateUID);l={client_id:c.appId,response_type:f.codeVerifier?"code":"token",state:JSON.stringify(l),expiration:c.expiration,locale:c.locale,redirect_uri:this._getRedirectURI(c,!!f.codeVerifier)};c.forceLogin&&(l.force_login=!0);c.forceUserId&&c.userId&&(l.prepopulatedusername=
c.userId);!c.popup&&this._doPortalSignIn(a)&&(l.redirectToUserOrgUrl=!0);f.codeVerifier&&(l.code_challenge=d||f.codeVerifier,l.code_challenge_method=d?"S256":"plain");d=c.portalUrl.replace(/^http:/i,"https:")+"/sharing/oauth2/authorize";f=d+"?"+G.objectToQuery(l);if(c.popup){const v=window.open(f,"esriJSAPIOAuth",c.popupWindowFeatures);v?(v.focus(),this._oAuthDfd.oAuthWin_=v,this._oAuthIntervalId=setInterval(()=>{if(v.closed){clearInterval(this._oAuthIntervalId);this._oAuthOnPopupHandle.remove();
const z=this._oAuthDfd;if(z){const h=new H("identity-manager:user-aborted","ABORTED");z.reject(h)}}},500),this._oAuthOnPopupHandle=Y.on(window,["arcgis:auth:hash","arcgis:auth:location:search"],z=>{"arcgis:auth:hash"===z.type?this.setOAuthResponseHash(z.detail):this._setOAuthResponseQueryString(z.detail)})):(a=new H("identity-manager:popup-blocked","ABORTED"),this._oAuthDfd.reject(a))}else this._rejectOnPersistedPageShow=!0,this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:l,authorizeUrl:d,
resourceUrl:a,serverInfo:b,oAuthInfo:c}):window.location.href=f};u._getRedirectURI=function(a,b){const c=window.location.href.replace(/#.*$/,"");if(a.popup)return G.makeAbsolute(a.popupCallbackUrl);if(b){const d=G.urlToObject(c);d.query&&"code error error_description message_code persist state".split(" ").forEach(f=>{delete d.query[f]});return G.addQueryParameters(d.path,d.query)}return c};return X}(ba);O.prototype.declaredClass="esri.identity.IdentityManagerBase";E.Credential=function(U){function X(a){var b=
U.call(this,a)||this;b._oAuthCred=null;b.tokenRefreshBuffer=2;a&&a._oAuthCred&&(b._oAuthCred=a._oAuthCred);return b}B._inheritsLoose(X,U);var u=X.prototype;u.initialize=function(){this.resources=this.resources||[];null==this.creationTime&&(this.creationTime=Date.now())};u.refreshToken=function(){const a=x.id.findServerInfo(this.server),b=a&&a.owningSystemUrl,c=!!b&&"server"===this.scope,d=c&&na(a,x.id._legacyFed);var f=a.webTierAuth;const l=f&&x.id.normalizeWebTierAuth;var v=ja[this.server];v=v&&
v[this.userId];let z=this.resources&&this.resources[0],h=c&&x.id.findServerInfo(b),q={username:this.userId,password:v},F;if(!f||l)if(c&&!h&&x.id.serverInfos.some(r=>{x.id._isIdProvider(b,r.server)&&(h=r);return!!h}),f=h&&x.id.findCredential(h.server,this.userId),!c||f)if(d)f.refreshToken();else{if(c)F={serverUrl:z,token:f&&f.token,ssl:f&&f.ssl};else if(l)q=null,F={ssl:this.ssl};else if(v)this.isAdmin&&(F={isAdmin:!0});else{let r;z&&(z=x.id._sanitizeUrl(z),this._enqueued=1,r=x.id._enqueue(z,a,null,
null,this.isAdmin,this),r.then(()=>{this._enqueued=0;this.refreshServerTokens()}).catch(()=>{this._enqueued=0}));return r}return x.id.generateToken(c?h:a,c?null:q,F).then(r=>{this.token=r.token;this.expires=null!=r.expires?Number(r.expires):null;this.creationTime=Date.now();this.validity=r.validity;this.emitTokenChange();this.refreshServerTokens()}).catch(()=>{})}};u.refreshServerTokens=function(){"portal"===this.scope&&x.id.credentials.forEach(a=>{const b=x.id.findServerInfo(a.server),c=b&&b.owningSystemUrl;
a!==this&&a.userId===this.userId&&c&&"server"===a.scope&&(x.id._hasSameServerInstance(this.server,c)||x.id._isIdProvider(c,this.server))&&(na(b,x.id._legacyFed)?(a.token=this.token,a.expires=this.expires,a.creationTime=this.creationTime,a.validity=this.validity,a.emitTokenChange()):a.refreshToken())})};u.emitTokenChange=function(a){clearTimeout(this._refreshTimer);var b=this.server&&x.id.findServerInfo(this.server);const c=(b=b&&b.owningSystemUrl)&&x.id.findServerInfo(b);!1===a||b&&"portal"!==this.scope&&
(!c||!c.webTierAuth||x.id.normalizeWebTierAuth)||null==this.expires&&null==this.validity||this._startRefreshTimer();this.emit("token-change")};u.destroy=function(){this.userId=this.server=this.token=this.expires=this.validity=this.resources=this.creationTime=null;this._oAuthCred&&(this._oAuthCred.destroy(),this._oAuthCred=null);const a=x.id.credentials.indexOf(this);-1<a&&x.id.credentials.splice(a,1);this.emitTokenChange();this.emit("destroy")};u.toJSON=function(){const a=R.fixJson({userId:this.userId,
server:this.server,token:this.token,expires:this.expires,validity:this.validity,ssl:this.ssl,isAdmin:this.isAdmin,creationTime:this.creationTime,scope:this.scope}),b=this.resources;b&&0<b.length&&(a.resources=b.slice());return a};u._startRefreshTimer=function(){clearTimeout(this._refreshTimer);const a=6E4*this.tokenRefreshBuffer,b=2**31-1;let c=(this.validity?this.creationTime+6E4*this.validity:this.expires)-Date.now();0>c?c=0:c>b&&(c=b);this._refreshTimer=setTimeout(this.refreshToken.bind(this),
c>a?c-a:c)};return X}(ba.EventedAccessor);w.__decorate([T.property()],E.Credential.prototype,"creationTime",void 0);w.__decorate([T.property()],E.Credential.prototype,"expires",void 0);w.__decorate([T.property()],E.Credential.prototype,"isAdmin",void 0);w.__decorate([T.property()],E.Credential.prototype,"oAuthState",void 0);w.__decorate([T.property()],E.Credential.prototype,"resources",void 0);w.__decorate([T.property()],E.Credential.prototype,"scope",void 0);w.__decorate([T.property()],E.Credential.prototype,
"server",void 0);w.__decorate([T.property()],E.Credential.prototype,"ssl",void 0);w.__decorate([T.property()],E.Credential.prototype,"token",void 0);w.__decorate([T.property()],E.Credential.prototype,"tokenRefreshBuffer",void 0);w.__decorate([T.property()],E.Credential.prototype,"userId",void 0);w.__decorate([T.property()],E.Credential.prototype,"validity",void 0);E.Credential=w.__decorate([aa.subclass("esri.identity.Credential")],E.Credential);E.IdentityManagerBase=O;Object.defineProperties(E,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/identity/IdentityForm":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../intl/substitute ../widgets/Widget ../widgets/support/widgetUtils ../widgets/support/decorators/messageBundle ../widgets/support/jsxFactory".split(" "),function(E,B,w,t,x,M,H,ba,Y,R,N,C){t=function(Z){function G(O,
aa){O=Z.call(this,O,aa)||this;O._usernameInputNode=null;O._passwordInputNode=null;O.messages=null;O.signingIn=!1;O.server=null;O.resource=null;O.error=null;O.oAuthPrompt=!1;return O}E._inheritsLoose(G,Z);var T=G.prototype;T.render=function(){const {error:O,server:aa,resource:la,signingIn:ia,oAuthPrompt:ea,messages:W}=this,ma=C.tsx("div",{class:"esri-identity-form__group"},ba.substitute(ea?W.oAuthInfo:W.info,{server:/\.arcgis\.com/i.test(aa)?"ArcGIS Online":aa,resource:`(${la||W.lblItem})`})),ja=ea?
null:C.tsx("div",{class:"esri-identity-form__group",key:"username"},C.tsx("label",{class:"esri-identity-form__label"},W.lblUser,C.tsx("input",{value:"",required:!0,autocomplete:"off",spellcheck:!1,type:"text",bind:this,afterCreate:R.storeNode,"data-node-ref":"_usernameInputNode",class:"esri-input"}))),oa=ea?null:C.tsx("div",{class:"esri-identity-form__group",key:"password"},C.tsx("label",{class:"esri-identity-form__label"},W.lblPwd,C.tsx("input",{value:"",required:!0,type:"password",bind:this,afterCreate:R.storeNode,
"data-node-ref":"_passwordInputNode",class:"esri-input"}))),na=C.tsx("div",{class:this.classes("esri-identity-form__group","esri-identity-form__footer")},C.tsx("input",{type:"submit",disabled:!!ia,value:ia?W.lblSigning:W.lblOk,class:"esri-button"}),C.tsx("input",{type:"button",value:W.lblCancel,bind:this,onclick:this._cancel,class:this.classes("esri-button","esri-button--secondary")})),fa=O?C.tsx("div",null,O.details&&O.details.httpStatus?W.invalidUser:W.noAuthService):null;return C.tsx("form",{class:"esri-identity-form",
bind:this,onsubmit:this._submit},ma,fa,ja,oa,na)};T._cancel=function(){this._set("signingIn",!1);this._usernameInputNode&&(this._usernameInputNode.value="");this._passwordInputNode&&(this._passwordInputNode.value="");this.emit("cancel")};T._submit=function(O){O.preventDefault();this._set("signingIn",!0);this.emit("submit",this.oAuthPrompt?{}:{username:this._usernameInputNode&&this._usernameInputNode.value,password:this._passwordInputNode&&this._passwordInputNode.value})};return G}(Y);B.__decorate([w.property(),
N.messageBundle("esri/identity/t9n/identity")],t.prototype,"messages",void 0);B.__decorate([w.property()],t.prototype,"signingIn",void 0);B.__decorate([w.property()],t.prototype,"server",void 0);B.__decorate([w.property()],t.prototype,"resource",void 0);B.__decorate([w.property()],t.prototype,"error",void 0);B.__decorate([w.property()],t.prototype,"oAuthPrompt",void 0);return t=B.__decorate([H.subclass("esri.identity.IdentityForm")],t)})},"esri/identity/IdentityModal":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/handleUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../widgets/Widget ../widgets/support/widget ../widgets/support/decorators/messageBundle ../widgets/support/jsxFactory".split(" "),
function(E,B,w,t,x,M,H,ba,Y,R,N,C,Z){function G(r,k){var g=Object.keys(r);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(r);k&&(e=e.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable}));g.push.apply(g,e)}return g}function T(r){for(var k=1;k<arguments.length;k++){var g=null!=arguments[k]?arguments[k]:{};k%2?G(Object(g),!0).forEach(function(e){var n=g[e];e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n}):Object.getOwnPropertyDescriptors?
Object.defineProperties(r,Object.getOwnPropertyDescriptors(g)):G(Object(g)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(g,e))})}return r}M='input select textarea a[href] button [tabindex]:not(slot) audio[controls] video[controls] [contenteditable]:not([contenteditable\x3d"false"]) details\x3esummary:first-of-type details'.split(" ");var O=M.join(","),aa=(H="undefined"===typeof Element)?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,
la=!H&&Element.prototype.getRootNode?function(r){return r.getRootNode()}:function(r){return r.ownerDocument},ia=function(r,k,g){var e=Array.prototype.slice.apply(r.querySelectorAll(O));k&&aa.call(r,O)&&e.unshift(r);return e=e.filter(g)},ea=function n(k,g,e){for(var m=[],A=Array.from(k);A.length;){var D=A.shift();if("SLOT"===D.tagName){var I=D.assignedElements();I=n(I.length?I:D.children,!0,e);e.flatten?m.push.apply(m,I):m.push({scope:D,candidates:I})}else{aa.call(D,O)&&e.filter(D)&&(g||!k.includes(D))&&
m.push(D);I=D.shadowRoot||"function"===typeof e.getShadowRoot&&e.getShadowRoot(D);var J=!e.shadowRootFilter||e.shadowRootFilter(D);I&&J?(I=n(!0===I?D.children:I.children,!0,e),e.flatten?m.push.apply(m,I):m.push({scope:D,candidates:I})):A.unshift.apply(A,D.children)}}return m},W=function(k,g){return 0>k.tabIndex&&(g||/^(AUDIO|VIDEO|DETAILS)$/.test(k.tagName)||k.isContentEditable)&&isNaN(parseInt(k.getAttribute("tabindex"),10))?0:k.tabIndex},ma=function(k,g){return k.tabIndex===g.tabIndex?k.documentOrder-
g.documentOrder:k.tabIndex-g.tabIndex},ja=function(k){return"DETAILS"===k.tagName&&Array.prototype.slice.apply(k.children).some(function(g){return"SUMMARY"===g.tagName})},oa=function(k,g){for(var e=0;e<k.length;e++)if(k[e].checked&&k[e].form===g)return k[e]},na=function(k){if(!k.name)return!0;var g=k.form||la(k),e=function(m){return g.querySelectorAll('input[type\x3d"radio"][name\x3d"'+m+'"]')};if("undefined"!==typeof window&&"undefined"!==typeof window.CSS&&"function"===typeof window.CSS.escape)var n=
e(window.CSS.escape(k.name));else try{n=e(k.name)}catch(m){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",m.message),!1}e=oa(n,k.form);return!e||e===k},fa=function(k){k=k.getBoundingClientRect();var g=k.height;return 0===k.width&&0===g},pa=function(k,g){var e=g.displayCheck;g=g.getShadowRoot;if("hidden"===getComputedStyle(k).visibility)return!0;var n=aa.call(k,"details\x3esummary:first-of-type")?
k.parentElement:k;if(aa.call(n,"details:not([open]) *"))return!0;n=la(k).host;n=(null===n||void 0===n?void 0:n.ownerDocument.contains(n))||k.ownerDocument.contains(k);if(!e||"full"===e){if("function"===typeof g){for(e=k;k;){var m=k.parentElement,A=la(k);if(m&&!m.shadowRoot&&!0===g(m))return fa(k);k=k.assignedSlot?k.assignedSlot:m||A===k.ownerDocument?m:A.host}k=e}if(n)return!k.getClientRects().length}else if("non-zero-area"===e)return fa(k);return!1},U=function(k,g){var e;(e=g.disabled)||(e="INPUT"===
g.tagName&&"hidden"===g.type);if(!(k=e||pa(g,k)||ja(g)))a:{if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(g.tagName))for(k=g.parentElement;k;){if("FIELDSET"===k.tagName&&k.disabled){for(e=0;e<k.children.length;e++){var n=k.children.item(e);if("LEGEND"===n.tagName){k=aa.call(k,"fieldset[disabled] *")?!0:!n.contains(g);break a}}k=!0;break a}k=k.parentElement}k=!1}return k?!1:!0},X=function(k,g){return"INPUT"===g.tagName&&"radio"===g.type&&!na(g)||0>W(g)||!U(k,g)?!1:!0},u=function(k){k=parseInt(k.getAttribute("tabindex"),
10);return isNaN(k)||0<=k?!0:!1},a=function e(g){var n=[],m=[];g.forEach(function(A,D){var I=!!A.scope,J=I?A.scope:A,L=W(J,I),K=I?e(A.candidates):J;0===L?I?n.push.apply(n,K):n.push(J):m.push({documentOrder:D,tabIndex:L,item:A,isScope:I,content:K})});return m.sort(ma).reduce(function(A,D){D.isScope?A.push.apply(A,D.content):A.push(D.content);return A},[]).concat(n)},b=function(g,e){e=e||{};g=e.getShadowRoot?ea([g],e.includeContainer,{filter:X.bind(null,e),flatten:!1,getShadowRoot:e.getShadowRoot,shadowRootFilter:u}):
ia(g,e.includeContainer,X.bind(null,e));return a(g)},c=function(g,e){e=e||{};return e.getShadowRoot?ea([g],e.includeContainer,{filter:U.bind(null,e),flatten:!0,getShadowRoot:e.getShadowRoot}):ia(g,e.includeContainer,U.bind(null,e))},d=function(g,e){e=e||{};if(!g)throw Error("No node provided");return!1===aa.call(g,O)?!1:X(e,g)},f=M.concat("iframe").join(","),l=function(g,e){e=e||{};if(!g)throw Error("No node provided");return!1===aa.call(g,f)?!1:U(e,g)},v=function(){var g=[];return{activateTrap:function(e){if(0<
g.length){var n=g[g.length-1];n!==e&&n.pause()}n=g.indexOf(e);-1!==n&&g.splice(n,1);g.push(e)},deactivateTrap:function(e){e=g.indexOf(e);-1!==e&&g.splice(e,1);0<g.length&&g[g.length-1].unpause()}}}(),z=function(g,e){var n=-1;g.every(function(m,A){return e(m)?(n=A,!1):!0});return n},h=function(g){for(var e=arguments.length,n=Array(1<e?e-1:0),m=1;m<e;m++)n[m-1]=arguments[m];return"function"===typeof g?g.apply(void 0,n):g},q=function(g){return g.target.shadowRoot&&"function"===typeof g.composedPath?
g.composedPath()[0]:g.target},F=function(g,e){var n=(null===e||void 0===e?void 0:e.document)||document,m=T({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0},e),A=[],D=[],I=[],J=null,L=null,K=!1,ca=!1,qa=void 0,ha=function(P,p,y){return P&&void 0!==P[p]?P[p]:m[y||p]},ra=function(P){return D.findIndex(function(p){var y=p.tabbableNodes;return p.container.contains(P)||y.find(function(Q){return Q===P})})},sa=function(P){var p=m[P];if("function"===typeof p){for(var y=arguments.length,
Q=Array(1<y?y-1:0),S=1;S<y;S++)Q[S-1]=arguments[S];p=p.apply(void 0,Q)}!0===p&&(p=void 0);if(!p){if(void 0===p||!1===p)return p;throw Error("`".concat(P,"` was specified but was not a node, or did not return a node"));}y=p;if("string"===typeof p&&(y=n.querySelector(p),!y))throw Error("`".concat(P,"` as selector refers to no known node"));return y},va=function(){var P=sa("initialFocus");if(!1===P)return!1;void 0===P&&(P=0<=ra(n.activeElement)?n.activeElement:(P=I[0])&&P.firstTabbableNode||sa("fallbackFocus"));
if(!P)throw Error("Your focus-trap needs to have at least one focusable element");return P},ta=function(){D=A.map(function(P){var p=b(P,m.tabbableOptions),y=c(P,m.tabbableOptions);return{container:P,tabbableNodes:p,focusableNodes:y,firstTabbableNode:0<p.length?p[0]:null,lastTabbableNode:0<p.length?p[p.length-1]:null,nextTabbableNode:function(Q){var S=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,da=y.findIndex(function(V){return V===Q});if(!(0>da))return S?y.slice(da+1).find(function(V){return d(V,
m.tabbableOptions)}):y.slice(0,da).reverse().find(function(V){return d(V,m.tabbableOptions)})}}});I=D.filter(function(P){return 0<P.tabbableNodes.length});if(0>=I.length&&!sa("fallbackFocus"))throw Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times");},ua=function y(p){!1!==p&&p!==n.activeElement&&(p&&p.focus?(p.focus({preventScroll:!!m.preventScroll}),L=p,p.tagName&&"input"===p.tagName.toLowerCase()&&"function"===typeof p.select&&p.select()):
y(va()))},ya=function(p){var y=sa("setReturnFocus",p);return y?y:!1===y?!1:p},wa=function(p){var y=q(p);0<=ra(y)||(h(m.clickOutsideDeactivates,p)?ka.deactivate({returnFocus:m.returnFocusOnDeactivate&&!l(y,m.tabbableOptions)}):h(m.allowOutsideClick,p)||p.preventDefault())},za=function(p){var y=q(p),Q=0<=ra(y);Q||y instanceof Document?Q&&(L=y):(p.stopImmediatePropagation(),ua(L||va()))},Ea=function(p){var y=q(p);ta();var Q=null;if(0<I.length){var S=ra(y),da=0<=S?D[S]:void 0;if(0>S)Q=p.shiftKey?I[I.length-
1].lastTabbableNode:I[0].firstTabbableNode;else if(p.shiftKey){var V=z(I,function(xa){return y===xa.firstTabbableNode});0>V&&(da.container===y||l(y,m.tabbableOptions)&&!d(y,m.tabbableOptions)&&!da.nextTabbableNode(y,!1))&&(V=S);0<=V&&(Q=I[0===V?I.length-1:V-1].lastTabbableNode)}else V=z(I,function(xa){return y===xa.lastTabbableNode}),0>V&&(da.container===y||l(y,m.tabbableOptions)&&!d(y,m.tabbableOptions)&&!da.nextTabbableNode(y))&&(V=S),0<=V&&(Q=I[V===I.length-1?0:V+1].firstTabbableNode)}else Q=sa("fallbackFocus");
Q&&(p.preventDefault(),ua(Q))},Aa=function(p){"Escape"!==p.key&&"Esc"!==p.key&&27!==p.keyCode||!1===h(m.escapeDeactivates,p)?"Tab"!==p.key&&9!==p.keyCode||Ea(p):(p.preventDefault(),ka.deactivate())},Ba=function(p){var y=q(p);0<=ra(y)||h(m.clickOutsideDeactivates,p)||h(m.allowOutsideClick,p)||(p.preventDefault(),p.stopImmediatePropagation())},Ca=function(){if(K)return v.activateTrap(ka),qa=m.delayInitialFocus?setTimeout(function(){ua(va())},0):ua(va()),n.addEventListener("focusin",za,!0),n.addEventListener("mousedown",
wa,{capture:!0,passive:!1}),n.addEventListener("touchstart",wa,{capture:!0,passive:!1}),n.addEventListener("click",Ba,{capture:!0,passive:!1}),n.addEventListener("keydown",Aa,{capture:!0,passive:!1}),ka},Da=function(){if(K)return n.removeEventListener("focusin",za,!0),n.removeEventListener("mousedown",wa,!0),n.removeEventListener("touchstart",wa,!0),n.removeEventListener("click",Ba,!0),n.removeEventListener("keydown",Aa,!0),ka};var ka={get active(){return K},get paused(){return ca},activate:function(p){if(K)return this;
var y=ha(p,"onActivate"),Q=ha(p,"onPostActivate"),S=ha(p,"checkCanFocusTrap");S||ta();K=!0;ca=!1;J=n.activeElement;y&&y();p=function(){S&&ta();Ca();Q&&Q()};if(S)return S(A.concat()).then(p,p),this;p();return this},deactivate:function(p){if(!K)return this;var y=T({onDeactivate:m.onDeactivate,onPostDeactivate:m.onPostDeactivate,checkCanReturnFocus:m.checkCanReturnFocus},p);clearTimeout(qa);qa=void 0;Da();ca=K=!1;v.deactivateTrap(ka);var Q=ha(y,"onDeactivate"),S=ha(y,"onPostDeactivate");p=ha(y,"checkCanReturnFocus");
var da=ha(y,"returnFocus","returnFocusOnDeactivate");Q&&Q();y=function(){setTimeout(function(){da&&ua(ya(J));S&&S()},0)};if(da&&p)return p(ya(J)).then(y,y),this;y();return this},pause:function(){if(ca||!K)return this;ca=!0;Da();return this},unpause:function(){if(!ca||!K)return this;ca=!1;ta();Ca();return this},updateContainerElements:function(p){A=[].concat(p).filter(Boolean).map(function(y){return"string"===typeof y?n.querySelector(y):y});K&&ta();return this}};ka.updateContainerElements(g);return ka};
R=function(g){function e(m,A){var D=g.call(this,m,A)||this;D.container=document.createElement("div");D.content=null;D.open=!1;D._close=()=>{D.open=!1};document.body.appendChild(D.container);D.own(t.watch(()=>D.open,()=>D._toggleFocusTrap()));return D}E._inheritsLoose(e,g);var n=e.prototype;n.destroy=function(){this._destroyFocusTrap()};n.render=function(){var m=this.id;const {open:A,content:D,title:I,messages:J}=this;var L=A&&!!D;const K={["esri-identity-modal--open"]:L,["esri-identity-modal--closed"]:!L},
ca=Z.tsx("button",{class:"esri-identity-modal__close-button","aria-label":J.close,title:J.close,bind:this,onclick:this._close,type:"button"},Z.tsx("span",{"aria-hidden":"true",class:"esri-icon-close"})),qa=`${m}_title`;m=`${m}_content`;const ha=I?Z.tsx("h1",{id:qa,class:"esri-identity-modal__title"},I):null;L=L?Z.tsx("div",{bind:this,class:"esri-identity-modal__dialog",role:"dialog","aria-labelledby":qa,"aria-describedby":m,afterCreate:this._createFocusTrap},ca,ha,this._renderContent(m)):null;return Z.tsx("div",
{tabIndex:-1,class:this.classes("esri-identity-modal",K)},L)};n._destroyFocusTrap=function(){var m;null==(m=this._focusTrap)?void 0:m.deactivate({onDeactivate:null});this._focusTrap=null};n._toggleFocusTrap=function(){const {_focusTrap:m,open:A}=this;m&&(A?m.activate():m.deactivate())};n._createFocusTrap=function(m){this._destroyFocusTrap();const A=requestAnimationFrame(()=>{this._focusTrap=F(m,{initialFocus:"input",onDeactivate:this._close});this._toggleFocusTrap()});this.own(w.makeHandle(()=>cancelAnimationFrame(A)))};
n._renderContent=function(m){const A=this.content;return"string"===typeof A?Z.tsx("div",{class:"esri-identity-modal__content",id:m,innerHTML:A}):N.isWidget(A)?Z.tsx("div",{class:"esri-identity-modal__content",id:m},A.render()):A instanceof HTMLElement?Z.tsx("div",{class:"esri-identity-modal__content",id:m,bind:A,afterCreate:this._attachToNode}):null};n._attachToNode=function(m){m.appendChild(this)};return e}(R);B.__decorate([x.property({readOnly:!0})],R.prototype,"container",void 0);B.__decorate([x.property()],
R.prototype,"content",void 0);B.__decorate([x.property()],R.prototype,"open",void 0);B.__decorate([x.property(),C.messageBundle("esri/t9n/common")],R.prototype,"messages",void 0);B.__decorate([x.property({aliasOf:"messages.auth.signIn"})],R.prototype,"title",void 0);return R=B.__decorate([Y.subclass("esri.identity.IdentityModal")],R)})},"esri/identity/OAuthCredential":function(){define(function(){let E=function(){function B(t,x){this.userId=this.token=this.stateUID=this.ssl=this.refreshToken=this.expires=
this.codeVerifier=this.appId=this.storage=this.oAuthInfo=null;this.oAuthInfo=t;this.storage=x;this._init()}var w=B.prototype;w.isValid=function(){let t=!1;if(this.oAuthInfo&&this.userId&&(this.refreshToken||this.token))if(null==this.expires&&this.refreshToken)t=!0;else{const x=Date.now();this.expires>x&&(this.expires-x)/1E3>60*this.oAuthInfo.minTimeUntilExpiration&&(t=!0)}return t};w.save=function(){if(!this.storage)return!1;const t=this._load(),x=this.oAuthInfo;if(x&&x.authNamespace&&x.portalUrl){let M=
t[x.authNamespace];M||(M=t[x.authNamespace]={});this.appId||(this.appId=x.appId);M[x.portalUrl]={appId:this.appId,codeVerifier:this.codeVerifier,expires:this.expires,refreshToken:this.refreshToken,ssl:this.ssl,stateUID:this.stateUID,token:this.token,userId:this.userId};try{this.storage.setItem("esriJSAPIOAuth",JSON.stringify(t))}catch(H){return console.warn(H),!1}return!0}return!1};w.destroy=function(){const t=this._load(),x=this.oAuthInfo;if(x&&x.appId&&x.portalUrl&&(null==this.expires||this.expires>
Date.now())&&(this.refreshToken||this.token)){var M=x.portalUrl.replace(/^http:/i,"https:")+"/sharing/rest/oauth2/revokeToken";const H=new FormData;H.append("f","json");H.append("auth_token",this.refreshToken||this.token);H.append("client_id",x.appId);H.append("token_type_hint",this.refreshToken?"refresh_token":"access_token");if("function"===typeof navigator.sendBeacon)navigator.sendBeacon(M,H);else{const ba=new XMLHttpRequest;ba.open("POST",M);ba.send(H)}}if(x&&x.authNamespace&&x.portalUrl&&this.storage&&
(M=t[x.authNamespace])){delete M[x.portalUrl];try{this.storage.setItem("esriJSAPIOAuth",JSON.stringify(t))}catch(H){console.log(H)}}x&&(this.oAuthInfo=x._oAuthCred=null)};w._init=function(){var t=this._load();const x=this.oAuthInfo;x&&x.authNamespace&&x.portalUrl&&(t=t[x.authNamespace])&&(t=t[x.portalUrl])&&(this.appId=t.appId,this.codeVerifier=t.codeVerifier,this.expires=t.expires,this.refreshToken=t.refreshToken,this.ssl=t.ssl,this.stateUID=t.stateUID,this.token=t.token,this.userId=t.userId)};w._load=
function(){let t={};if(this.storage){const x=this.storage.getItem("esriJSAPIOAuth");if(x)try{t=JSON.parse(x)}catch(M){console.warn(M)}}return t};return B}();E.prototype.declaredClass="esri.identity.OAuthCredential";return E})},"esri/identity/OAuthInfo":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass".split(" "),
function(E,B,w,t,x,M,H,ba){var Y;w=Y=function(R){function N(C){C=R.call(this,C)||this;C._oAuthCred=null;C.appId=null;C.authNamespace="/";C.expiration=20160;C.flowType="auto";C.forceLogin=!1;C.forceUserId=!1;C.locale=null;C.minTimeUntilExpiration=30;C.popup=!1;C.popupCallbackUrl="oauth-callback.html";C.popupWindowFeatures="height\x3d490,width\x3d800,resizable,scrollbars,status";C.portalUrl="https://www.arcgis.com";C.preserveUrlHash=!1;C.userId=null;return C}E._inheritsLoose(N,R);N.prototype.clone=
function(){return Y.fromJSON(this.toJSON())};return N}(w.JSONSupport);B.__decorate([t.property({json:{write:!0}})],w.prototype,"appId",void 0);B.__decorate([t.property({json:{write:!0}})],w.prototype,"authNamespace",void 0);B.__decorate([t.property({json:{write:!0}})],w.prototype,"expiration",void 0);B.__decorate([t.property({json:{write:!0}})],w.prototype,"flowType",void 0);B.__decorate([t.property({json:{write:!0}})],w.prototype,"forceLogin",void 0);B.__decorate([t.property({json:{write:!0}})],
w.prototype,"forceUserId",void 0);B.__decorate([t.property({json:{write:!0}})],w.prototype,"locale",void 0);B.__decorate([t.property({json:{write:!0}})],w.prototype,"minTimeUntilExpiration",void 0);B.__decorate([t.property({json:{write:!0}})],w.prototype,"popup",void 0);B.__decorate([t.property({json:{write:!0}})],w.prototype,"popupCallbackUrl",void 0);B.__decorate([t.property({json:{write:!0}})],w.prototype,"popupWindowFeatures",void 0);B.__decorate([t.property({json:{write:!0}})],w.prototype,"portalUrl",
void 0);B.__decorate([t.property({json:{write:!0}})],w.prototype,"preserveUrlHash",void 0);B.__decorate([t.property({json:{write:!0}})],w.prototype,"userId",void 0);return w=Y=B.__decorate([ba.subclass("esri.identity.OAuthInfo")],w)})},"esri/identity/ServerInfo":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass".split(" "),
function(E,B,w,t,x,M,H,ba){w=function(Y){function R(N){N=Y.call(this,N)||this;N.adminTokenServiceUrl=null;N.currentVersion=null;N.hasPortal=null;N.hasServer=null;N.owningSystemUrl=null;N.owningTenant=null;N.server=null;N.shortLivedTokenValidity=null;N.tokenServiceUrl=null;N.webTierAuth=null;return N}E._inheritsLoose(R,Y);return R}(w.JSONSupport);B.__decorate([t.property({json:{write:!0}})],w.prototype,"adminTokenServiceUrl",void 0);B.__decorate([t.property({json:{write:!0}})],w.prototype,"currentVersion",
void 0);B.__decorate([t.property({json:{write:!0}})],w.prototype,"hasPortal",void 0);B.__decorate([t.property({json:{write:!0}})],w.prototype,"hasServer",void 0);B.__decorate([t.property({json:{write:!0}})],w.prototype,"owningSystemUrl",void 0);B.__decorate([t.property({json:{write:!0}})],w.prototype,"owningTenant",void 0);B.__decorate([t.property({json:{write:!0}})],w.prototype,"server",void 0);B.__decorate([t.property({json:{write:!0}})],w.prototype,"shortLivedTokenValidity",void 0);B.__decorate([t.property({json:{write:!0}})],
w.prototype,"tokenServiceUrl",void 0);B.__decorate([t.property({json:{write:!0}})],w.prototype,"webTierAuth",void 0);return w=B.__decorate([ba.subclass("esri.identity.ServerInfo")],w)})},"*noref":1}});define(["../chunks/_rollupPluginBabelHelpers","../kernel","./IdentityManagerBase"],function(E,B,w){w=function(t){function x(){return t.apply(this,arguments)||this}E._inheritsLoose(x,t);return x}(w.IdentityManagerBase);w.prototype.declaredClass="esri.identity.IdentityManager";w=new w;B.setId(w);return w});