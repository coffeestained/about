// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
define("exports ../../chunks/_rollupPluginBabelHelpers ../../request ../../geometry/Extent ../../geometry/Point ../../geometry/SpatialReference ../../layers/support/RasterInfo ../utils ../support/FeatureSet".split(" "),function(q,F,g,y,G,H,I,r,J){function z(c,b,a){return t.apply(this,arguments)}function t(){t=F._asyncToGenerator(function*(c,b,a){var l,e,f,A,B,C,D;c=r.parseUrl(c);const {renderingRule:u,sourceJSON:K}=b||{};b=u?JSON.stringify(u.rasterFunctionDefinition||u):null;b=r.encode({...c.query,
renderingRule:b,f:"json"});b=r.asValidOptions(b,a);c=c.path;a=K||(yield g(c,b).then(h=>h.data));var d=a.hasRasterAttributeTable?g(`${c}/rasterAttributeTable`,b):null,k=a.hasColormap?g(`${c}/colormap`,b):null,m=a.hasHistograms?g(`${c}/histograms`,b):null,v=10.3<=a.currentVersion?g(`${c}/keyProperties`,b):null;c=a.hasMultidimensions?g(`${c}/multidimensionalInfo`,b):null;b=yield Promise.allSettled([d,k,m,v,c]);c=null;if(a.minValues&&a.minValues.length===a.bandCount)for(c=[],d=0;d<a.minValues.length;d++)c.push({min:a.minValues[d],
max:a.maxValues[d],avg:a.meanValues[d],stddev:a.stdvValues[d]});k=y.fromJSON(a.extent);d=Math.ceil(k.width/a.pixelSizeX-.1);k=Math.ceil(k.height/a.pixelSizeY-.1);m=H.fromJSON(a.spatialReference||a.extent.spatialReference);v="fulfilled"===b[0].status?b[0].value?J.fromJSON(b[0].value.data):null:null;const L="fulfilled"===b[1].status?null==(l=b[1].value)?void 0:l.data.colormap:null;l="fulfilled"===b[2].status?null==(e=b[2].value)?void 0:e.data.histograms:null;e="fulfilled"===b[3].status?null!=(f=null==
(A=b[3].value)?void 0:A.data)?f:{}:{};f="fulfilled"===b[4].status?null==(B=b[4].value)?void 0:B.data.multidimensionalInfo:null;null!=f&&null!=(C=f.variables)&&C.length&&f.variables.forEach(h=>{var E;null!=(E=h.statistics)&&E.length&&h.statistics.forEach(n=>{n.avg=n.mean;n.stddev=n.standardDeviation})});const {defaultVariable:w,serviceDataType:p}=a;w&&w!==e.DefaultVariable&&(e.DefaultVariable=w);p&&p.includes("esriImageServiceDataTypeVector")&&!p.includes(e.DataType)&&(e.DataType=p.replace("esriImageServiceDataType",
""));let x=a.noDataValue;null!=(D=a.noDataValues)&&D.length&&a.noDataValues.some(h=>h!==x)&&(x=a.noDataValues);return new I({width:d,height:k,bandCount:a.bandCount,extent:y.fromJSON(a.extent),spatialReference:m,pixelSize:new G({x:a.pixelSizeX,y:a.pixelSizeY,spatialReference:m}),pixelType:a.pixelType.toLowerCase(),statistics:c,attributeTable:v,colormap:L,histograms:l,keyProperties:e,noDataValue:x,multidimensionalInfo:f})});return t.apply(this,arguments)}q.fetchServiceRasterInfo=function(c,b,a){return z(c,
{sourceJSON:b},a)};q.generateRasterInfo=function(c,b,a){return z(c,{renderingRule:b},a)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});