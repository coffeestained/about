// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.24/esri/copyright.txt for details.
//>>built
define("require exports ../../chunks/_rollupPluginBabelHelpers ../../core/has ../../core/maybe ../../support/arcadeOnDemand ./gfxUtils ./previewUtils ./renderUtils ./utils".split(" "),function(u,t,w,L,p,B,E,F,G,r){function H(a,b){if(b&&(a.style.filter=r.getCSSFilterFromEffectList(b),b=b.effects))for(const c of b)if("drop-shadow"===(null==c?void 0:c.type)){0>c.offsetX?a.style.marginLeft=`${Math.abs(c.offsetX)}px`:a.style.marginRight=`${c.offsetX}px`;break}}function C(a,b){return x.apply(this,arguments)}
function x(){x=w._asyncToGenerator(function*(a,b){switch(a.type){case "web-style":var {previewWebStyleSymbol:c}=yield new Promise((f,d)=>u(["./previewWebStyleSymbol"],f,d));return c(a,C,b);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return{previewSymbol3D:c}=yield new Promise((f,d)=>u(["./previewSymbol3D"],f,d)),c(a,b);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return{previewSymbol2D:c}=yield new Promise((f,
d)=>u(["./previewSymbol2D"],f,d)),c(a,b);case "cim":return{previewCIMSymbol:c}=yield new Promise((f,d)=>u(["./previewCIMSymbol"],f,d)),c(a,b)}});return x.apply(this,arguments)}function y(a){return a&&"opacity"in a?a.opacity*y(a.parent):1}function z(){z=w._asyncToGenerator(function*(a,b){var c,f;if(a){var d=a.sourceLayer;d=null!=(c=p.isSome(b)&&null!=(f=b.useSourceLayer)&&f?d:a.layer)?c:d;c=y(d);if(p.isSome(a.symbol)&&(!p.isSome(b)||!0!==b.ignoreGraphicSymbol))return a="web-style"===a.symbol.type?
yield a.symbol.fetchSymbol({...b,cache:p.isSome(b)?b.webStyleCache:null}):a.symbol.clone(),r.applyColorToSymbol(a,null,c),a;var g=p.isSome(b)&&b.renderer||d&&"renderer"in d&&d.renderer;if(f=g&&"getSymbolAsync"in g?yield g.getSymbolAsync(a,b):null){f="web-style"===f.type?yield f.fetchSymbol({...b,cache:p.isSome(b)?b.webStyleCache:null}):f.clone();if(!("visualVariables"in g&&g.visualVariables&&g.visualVariables.length))return r.applyColorToSymbol(f,null,c),f;"arcadeRequiredForVisualVariables"in g&&
g.arcadeRequiredForVisualVariables&&(p.isNone(b)||p.isNone(b.arcade))&&(b={...p.unwrap(b)},b.arcade=yield B.loadArcade());d=yield new Promise((m,q)=>u(["../../renderers/visualVariables/support/visualVariableUtils"],m,q));var k=[],e=[],h=[],l=[];for(var n of g.visualVariables)switch(n.type){case "color":k.push(n);break;case "opacity":e.push(n);break;case "rotation":l.push(n);break;case "size":n.target||h.push(n)}n=(n=!!k.length&&k[k.length-1])?d.getColor(n,a,b):null;e=(e=!!e.length&&e[e.length-1])?
d.getOpacity(e,a,b):null;null!=c&&(e=null!=e?e*c:c);r.applyColorToSymbol(f,n,e);h.length&&(c=d.getAllSizes(h,a,b),yield r.applySizesToSymbol(f,c));for(const m of l)r.applyRotationToSymbol(f,d.getRotationAngle(m,a,b),m.axis);return f}}});return z.apply(this,arguments)}function A(){A=w._asyncToGenerator(function*(a,b){var c;if(a){var f=y(a.layer||a.sourceLayer);if(p.isSome(a.symbol)&&(!p.isSome(b)||!0!==b.ignoreGraphicSymbol))return a="web-style"===a.symbol.type?yield a.symbol.fetchSymbol(b):a.symbol.clone(),
r.getColorFromSymbol(a,f);var d=p.isSome(b)&&b.renderer||a.get("layer.renderer")||a.get("sourceLayer.renderer"),g=yield d.getSymbolAsync(a,b);if(g){g="web-style"===g.type?yield g.fetchSymbol(b):g.clone();g=r.getColorFromSymbol(g,f);if(!("visualVariables"in d)||"visualVariables"in d&&!d.visualVariables||"visualVariables"in d&&(null==(c=d.visualVariables)||!c.length))return g;d.arcadeRequiredForVisualVariables&&(p.isNone(b)||p.isNone(b.arcade))&&(b={...p.unwrap(b)},b.arcade=yield B.loadArcade());c=
yield new Promise((h,l)=>u(["../../renderers/visualVariables/support/visualVariableUtils"],h,l));var k=[],e=[];for(const h of d.visualVariables)switch(h.type){case "color":k.push(h);break;case "opacity":e.push(h)}d=(d=0<k.length?k[k.length-1]:null)?c.getColor(d,a,b):g;a=(g=0<e.length?e[e.length-1]:null)?c.getOpacity(g,a,b):null;null!=f&&(a=null!=a?a*f:f);return d?r.applyOpacityToColor(d,a):null}}});return A.apply(this,arguments)}let v=null;const D=[255,255,255];t.getDisplayedColor=function(a,b){return A.apply(this,
arguments)};t.getDisplayedSymbol=function(a,b){return z.apply(this,arguments)};t.renderColorRampPreviewHTML=function(a,b={}){var c="horizontal"===b.align;const {width:f=c?75:24,height:d=c?24:75,gradient:g=!0}=b;var k=window.devicePixelRatio,e=f*k,h=d*k;k=document.createElement("canvas");k.width=e;k.height=h;k.style.width=`${f}px`;k.style.height=`${d}px`;const l=k.getContext("2d");var n=c?e:0,m=c?0:h;if(g){const q=l.createLinearGradient(0,0,n,m);c=a.length;const I=1===c?0:1/(c-1);a.forEach((J,K)=>
q.addColorStop(K*I,J.toString()));l.fillStyle=q;l.fillRect(0,0,e,h)}else{e=c?e/a.length:e;h=c?h:h/a.length;m=n=0;for(const q of a)l.fillStyle=q.toString(),l.fillRect(n,m,e,h),n=c?n+e:0,m=c?0:m+h}a=document.createElement("div");a.style.width=`${f}px`;a.style.height=`${d}px`;H(a,null==b?void 0:b.effectList);a.appendChild(k);return a};t.renderDotDensityPreviewHTML=function(a,b,c){const {backgroundColor:f,outline:d,dotSize:g}=a;c=c&&c.swatchSize||F.SymbolSizeDefaults.size;const k=Math.round(c*c/g**2*
.8),e=window.devicePixelRatio;a=document.createElement("canvas");const h=c*e;a.width=h;a.height=h;a.style.width=`${a.width/e}px`;a.style.height=`${a.height/e}px`;const l=a.getContext("2d");f&&(l.fillStyle=f.toCss(!0),l.fillRect(0,0,h,h),l.fill());l.fillStyle=b.toCss(!0);if(v&&v.length/2===k)for(b=0;b<2*k;b+=2)l.fillRect(v[b],v[b+1],g*e,g*e),l.fill();else for(v=[],b=0;b<2*k;b+=2){const n=Math.floor(Math.random()*(h-0+1)),m=Math.floor(Math.random()*(h-0+1));v.push(n,m);l.fillRect(n,m,g*e,g*e);l.fill()}d&&
(d.color&&(l.strokeStyle=d.color.toCss(!0)),l.lineWidth=d.width,l.strokeRect(0,0,h,h));c=new Image(c,c);c.src=a.toDataURL();return c};t.renderPieChartPreviewHTML=function(a,b={}){const c=b.radius||40;var f=2*Math.PI*c,d=a.length;const g=f/d,k=[],e=E.getStroke(b.outline);e&&(e.width*=2);(e||b.backgroundColor)&&k.push({shape:{type:"circle",cx:c,cy:c,r:c},fill:b.backgroundColor,stroke:e,offset:[0,0]});const h=b.values,l=h&&h.length===d&&100===h.reduce((m,q)=>m+q,0),n=[0];for(let m=0;m<d;m++){const q=
l?h[m]*f/100:null;l&&n.push(q+n[m]);k.push({shape:{type:"circle",cx:c,cy:c,r:c/2},fill:[0,0,0,0],stroke:{width:c,dashArray:`${q||g} ${f}`,dashoffset:`-${l?n[m]/2:g/2*m}`,color:a[m]},offset:[0,0]})}d=null;a=2*c+((null==e?void 0:e.width)||0);if(f=b.holePercentage)e&&k.push({shape:{type:"circle",cx:c,cy:c,r:c*f},fill:null,stroke:e,offset:[0,0]}),d=a/2,d=[[{shape:{type:"circle",cx:d,cy:d,r:d},fill:D,stroke:e?{...e,color:D}:null,offset:[0,0]},{shape:{type:"circle",cx:d,cy:d,r:c*f},fill:[0,0,0],stroke:null,
offset:[0,0]}]];return G.renderSymbol([k],[a,a],{effectView:b.effectList,ignoreStrokeWidth:!0,masking:d,rotation:-90})};t.renderPreviewHTML=C;Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});