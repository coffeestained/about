/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
import"../core/lang.js";import{s as e}from"./jsonMap.js";import{e as s,i as t,a as r}from"./maybe.js";import{g as i}from"./projectionEllipsoid.js";import n,{b as a,c as u,d as c,o}from"../geometry/SpatialReference.js";import{e as l,m,a as f}from"./Ellipsoid.js";const d=39.37,q=l.radius*Math.PI/200,U=/UNIT\[([^\]]+)\]\]$/i,h=o,B=/UNIT\[([^\]]+)\]/i,b=new Set([4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140]),p=e()({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"}),k=e=>e*e,y=e=>e*e*e,_={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1e3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},"us-feet":{inBaseUnits:1200/3937}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:k(.001)},"square-centimeters":{inBaseUnits:k(.01)},"square-decimeters":{inBaseUnits:k(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:k(1e3)},"square-inches":{inBaseUnits:k(.0254)},"square-feet":{inBaseUnits:k(.3048)},"square-yards":{inBaseUnits:k(.9144)},"square-miles":{inBaseUnits:k(1609.344)},"square-us-feet":{inBaseUnits:k(1200/3937)},acres:{inBaseUnits:.0015625*k(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*y(.001)},"cubic-centimeters":{inBaseUnits:1e3*y(.01)},"cubic-decimeters":{inBaseUnits:1e3*y(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*y(1e3)},"cubic-inches":{inBaseUnits:1e3*y(.0254)},"cubic-feet":{inBaseUnits:1e3*y(.3048)},"cubic-yards":{inBaseUnits:1e3*y(.9144)},"cubic-miles":{inBaseUnits:1e3*y(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},g=(()=>{const e={};for(const s in _)for(const t in _[s].units)e[t]=s;return e})(),M=["metric","imperial","square-inches","square-feet","square-yards","square-miles","square-us-feet","square-meters","square-kilometers","acres","ares","hectares"],w=["metric","imperial","inches","feet","yards","miles","nautical-miles","us-feet","meters","kilometers"],S=new Map([["meters","square-meters"],["feet","square-feet"],["us-feet","square-us-feet"]]);function j(e){return"imperial"===e||"metric"===e}function I(e){const s=g[e];if(!s)throw new Error("unknown type");return s}function P(e,s=null){return s=s||I(e),_[s].baseUnit===e}function x(e,s,t){if(s===t)return e;const r=I(s);if(r!==I(t))throw new Error("incompatible units");const i=P(s,r)?e:function(e,s,t){return e*_[t].units[s].inBaseUnits}(e,s,r);return P(t,r)?i:function(e,s,t){return e/_[t].units[s].inBaseUnits}(i,t,r)}function C(e,s,t){switch(t){case"metric":return E(e,s);case"imperial":return F(e,s);default:return t}}function D(e,s,t){switch(t){case"metric":return v(e,s);case"imperial":return N(e,s);default:return t}}function E(e,s){const t=x(e,s,"meters");return Math.abs(t)<3e3?"meters":"kilometers"}function v(e,s){const t=x(e,s,"meters");return Math.abs(t)<1e5?"meters":"kilometers"}function F(e,s){const t=x(e,s,"feet");return Math.abs(t)<1e3?"feet":"miles"}function N(e,s){const t=x(e,s,"feet");return Math.abs(t)<1e5?"feet":"miles"}function O(e,s){const t=x(e,s,"square-meters");return Math.abs(t)<3e6?"square-meters":"square-kilometers"}function R(e,s){const t=x(e,s,"square-feet");return Math.abs(t)<1e6?"square-feet":"square-miles"}function A(e,s,t){return x(e,s,"meters")/(t*Math.PI/180)}function J(e){return p.fromJSON(e.toLowerCase())||null}function K(e){if(e&&"object"==typeof e&&!a(e))return 1;const s=Y(e);return s>1e5?1:s}function T(e){return Y(e)>=(e instanceof n?i(e).metersPerDegree:1e5)?"meters":H(e)}function Y(e,t=l.metersPerDegree){return s(function(e,s=!1){let t,r,i=null;if(null!=e&&("object"==typeof e?(t=e.wkid,r=e.wkt):"number"==typeof e?t=e:"string"==typeof e&&(r=e)),t){if(u(t))return m.metersPerDegree;if(c(t))return f.metersPerDegree;i=h.values[h[t]],!i&&s&&b.has(t)&&(i=q)}else r&&(W(r)?i=z(U.exec(r),i):V(r)&&(i=z(B.exec(r),i)));return i}(e,!0),t)}function z(e,s){return e&&e[1]?G(e[1]):s}function G(e){return parseFloat(e.split(",")[1])}function H(e){let s,r,i=null;if(null!=e&&("object"==typeof e?(s=e.wkid,r=e.wkt):"number"==typeof e?s=e:"string"==typeof e&&(r=e)),s)i=h.units[h[s]];else if(r){const e=W(r)?U:V(r)?B:null;if(e){const s=e.exec(r);s&&s[1]&&(i=function(e){const s=/[\\"\\']{1}([^\\"\\']+)/.exec(e);let t=s&&s[1];if(!t||!h.units.includes(t)){const s=G(e);t=null;const r=h.values;for(let e=0;e<r.length;++e)if(Math.abs(s-r[e])<1e-7){t=h.units[e];break}}return t}(s[1]))}}return t(i)?J(i):null}function L(e){const s=H(e);return r(s)||!w.includes(s)?null:s}function $(e){const s=T(e);return r(s)||!w.includes(s)?null:s}function Q(e){const s=H(e);return r(s)?null:S.get(s)}function V(e){return/^GEOCCS/i.test(e)}function W(e){return/^PROJCS/i.test(e)}function X(e){const t="metric";if(r(e))return t;const i=e.map,n=i&&"portalItem"in i?i.portalItem?.portal:null;if(n)switch(n?.user?.units??n.units){case t:return t;case"english":return"imperial"}return s(function(e){const s=H(e);if(r(s))return null;switch(s){case"feet":case"us-feet":case"clarke-feet":case"clarke-yards":case"clarke-links":case"sears-yards":case"sears-feet":case"sears-chains":case"benoit-1895-b-chains":case"indian-yards":case"indian-1937-yards":case"gold-coast-feet":case"sears-1922-truncated-chains":return"imperial";case"50-kilometers":case"150-kilometers":case"meters":return"metric"}return null}(e.spatialReference),t)}const Z={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},ee={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},se=e()(Z),te=e()(ee);e()({...Z,...ee});export{K as a,se as b,x as c,A as d,w as e,Y as f,T as g,O as h,d as i,F as j,E as k,te as l,M as m,X as n,I as o,R as p,Q as q,v as r,N as s,L as t,J as u,$ as v,j as w,H as x,C as y,D as z};
