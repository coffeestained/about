/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
import{o as t,d as n,b as r,j as s,a as o,h as c,k as e,c as u,s as a,z as i,n as f}from"./mathUtils.js";import{i as I}from"./maybe.js";import{p as N}from"./sphere.js";import{s as M,c as g}from"./vectorStacks.js";import{t as m}from"./mathUtils2.js";function E(t=K){return[t[0],t[1],t[2],t[3]]}function h(t=K[0],n=K[1],r=K[2],s=K[3]){return A(t,n,r,s,g.get())}function p(t,n){return A(n[0],n[1],n[2],n[3],t)}function A(t,n,r,s,o=E()){return o[0]=t,o[1]=n,o[2]=r,o[3]=s,o}function F(t,n,r){return o(r,t),r[3]=n,r}function T(t,n,r){const s=n[0]*n[0]+n[1]*n[1]+n[2]*n[2],o=Math.abs(s-1)>1e-5&&s>1e-12?1/Math.sqrt(s):1;return r[0]=n[0]*o,r[1]=n[1]*o,r[2]=n[2]*o,r[3]=-(r[0]*t[0]+r[1]*t[1]+r[2]*t[2]),r}function _(t,n,r,s=E()){const o=r[0]-n[0],c=r[1]-n[1],e=r[2]-n[2],u=t[0]-n[0],a=t[1]-n[1],i=t[2]-n[2],f=c*i-e*a,I=e*u-o*i,N=o*a-c*u,M=f*f+I*I+N*N,g=Math.abs(M-1)>1e-5&&M>1e-12?1/Math.sqrt(M):1;return s[0]=f*g,s[1]=I*g,s[2]=N*g,s[3]=-(s[0]*t[0]+s[1]*t[1]+s[2]*t[2]),s}function j(t,r,o,c,e){if(t.count<3)return!1;t.getVec(o,d);let u=c,a=!1;for(;u<t.count-1&&!a;)t.getVec(u,l),u++,a=!i(d,l);if(!a)return!1;for(u=Math.max(u,e),a=!1;u<t.count&&!a;)t.getVec(u,v),u++,n(y,d,l),f(y,y),n(X,l,v),f(X,X),a=!i(d,v)&&!i(l,v)&&Math.abs(s(y,X))<b;return a?(_(d,l,v,r),!0):(0!==o||1!==c||2!==e)&&j(t,r,0,1,2)}const b=.99619469809,d=c(),l=c(),v=c(),y=c(),X=c();function C(t,n,r){return n!==t&&p(t,n),t[3]=-s(t,r),t}function L(t,n){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n[3]=-t[3],n}function P(t,n,r,s){return e(v,n,t),T(r,v,s)}function k(t,r,s,o){return H(t,r,n(M.get(),s,r),R,o)}function q(t,n,r){return!!I(n)&&H(t,n.origin,n.direction,W,r)}function x(t,n,r){return H(t,n.origin,n.vector,Q.NONE,r)}function O(t,n,r){return H(t,n.origin,n.vector,Q.CLAMP,r)}function V(t,n){return G(t,n)>=0}function U(t,n){const r=n[0],s=n[1],o=n[2],c=n[3],e=n[4],u=n[5];return t[0]*(t[0]>0?r:c)+t[1]*(t[1]>0?s:e)+t[2]*(t[2]>0?o:u)+t[3]>=0}function w(t,n){const r=s(t,n.ray.direction),o=-G(t,n.ray.origin);if(o<0&&r>=0)return!1;if(r>-1e-6&&r<1e-6)return o>0;if((o<0||r<0)&&!(o<0&&r<0))return!0;const c=o/r;return r>0?c<n.c1&&(n.c1=c):c>n.c0&&(n.c0=c),n.c0<=n.c1}function z(t,n){const r=s(t,n.ray.direction),o=-G(t,n.ray.origin);if(r>-1e-6&&r<1e-6)return o>0;const c=o/r;return r>0?c<n.c1&&(n.c1=c):c>n.c0&&(n.c0=c),n.c0<=n.c1}function S(s,o,c){const e=t(M.get(),s,-s[3]),u=D(s,n(M.get(),o,e),M.get());return r(c,u,e),c}function B(t,r,s,o){const c=t,e=M.get(),u=M.get();m(c,e,u);const i=n(M.get(),s,r),f=N(e,i),I=N(u,i),g=N(c,i);return a(o,f,I,g)}function D(r,o,c){const e=t(M.get(),r,s(r,o));return n(c,o,e),c}function G(t,n){return s(t,n)+t[3]}function H(n,o,c,e,a){const i=s(n,c);if(0===i)return!1;let f=-(s(n,o)+n[3])/i;return e&Q.CLAMP&&(f=u(f,0,1)),!(!(e&Q.INFINITE_MIN)&&f<0||!(e&Q.INFINITE_MAX)&&f>1||(r(a,o,t(a,c,f)),0))}function J(t){return t}const K=[0,0,1,0];var Q;!function(t){t[t.NONE=0]="NONE",t[t.CLAMP=1]="CLAMP",t[t.INFINITE_MIN=4]="INFINITE_MIN",t[t.INFINITE_MAX=8]="INFINITE_MAX"}(Q||(Q={}));const R=Q.INFINITE_MIN|Q.INFINITE_MAX,W=Q.INFINITE_MAX;export{P as a,V as b,E as c,p as d,A as e,T as f,x as g,O as h,q as i,_ as j,G as k,U as l,w as m,J as n,z as o,S as p,k as q,B as r,C as s,F as t,L as u,D as v,h as w,j as x};
