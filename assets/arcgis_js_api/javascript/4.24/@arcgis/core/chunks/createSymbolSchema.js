/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
import{a as e,b as r}from"./enums4.js";import{d as t,e as a,i as s}from"./MaterialKey.js";import"../core/Error.js";import"../core/lang.js";import"./maybe.js";import"./Logger.js";import"../config.js";import"./object.js";import"./string.js";import"./alignmentUtils.js";function n(e){return"line-marker"===e.type?{type:"line-marker",color:e.color?.toJSON(),placement:e.placement,style:e.style}:e.constructor.fromJSON(e.toJSON()).toJSON()}function o(e){return a(e)}function l(a,l,i){if(!a)return null;switch(a.type){case"simple-fill":case"picture-fill":return function(r,a,l){const i=t(e.FILL,a),m=l?o(i):i,c=r.clone(),h=c.outline,u=s(a.symbologyType);u||(c.outline=null);const y={materialKey:m,hash:c.hash(),...n(c)};if(u)return y;const p=[];if(p.push(y),h){const r=t(e.LINE,{...a,isOutline:!0}),s={materialKey:l?o(r):r,hash:h.hash(),...n(h)};p.push(s)}return{type:"composite-symbol",layers:p,hash:p.reduce(((e,r)=>r.hash+e),"")}}(a,l,i);case"simple-marker":case"picture-marker":return function(r,a,s){const l=t(e.MARKER,a),i=s?o(l):l,m=n(r);return{materialKey:i,hash:r.hash(),...m,angle:r.angle,maxVVSize:a.maxVVSize}}(a,l,i);case"simple-line":return function(a,l,i){const m=s(l.symbologyType)?r.DEFAULT:l.symbologyType,c=t(e.LINE,{...l,symbologyType:m}),h=i?o(c):c,u=a.clone(),y=u.marker;u.marker=null;const p=[];if(p.push({materialKey:h,hash:u.hash(),...n(u)}),y){const r=t(e.MARKER,l),a=i?o(r):r;y.color=y.color??u.color,p.push({materialKey:a,hash:y.hash(),lineWidth:u.width,...n(y)})}return{type:"composite-symbol",layers:p,hash:p.reduce(((e,r)=>r.hash+e),"")}}(a,l,i);case"text":return function(r,a,s){const l=t(e.TEXT,a),i=s?o(l):l,m=n(r);return{materialKey:i,hash:r.hash(),...m,angle:r.angle,maxVVSize:a.maxVVSize}}(a,l,i);case"label":return function(r,a,s){const n=r.toJSON(),l=t(e.LABEL,{...a,placement:n.labelPlacement});return{materialKey:s?o(l):l,hash:r.hash(),...n,labelPlacement:n.labelPlacement}}(a,l,i);case"cim":return{type:"cim",rendererKey:l.vvFlags,data:a.data,maxVVSize:l.maxVVSize};case"CIMSymbolReference":return{type:"cim",rendererKey:l.vvFlags,data:a,maxVVSize:l.maxVVSize};case"web-style":return{...n(a),type:"web-style",hash:a.hash(),rendererKey:l.vvFlags,maxVVSize:l.maxVVSize};default:throw new Error(`symbol not supported ${a.type}`)}}export{l as createSymbolSchema};
