/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
import{_ as e}from"./tslib.es6.js";import r from"../Graphic.js";import{L as o}from"./Logger.js";import{j as s}from"./ensureType.js";import"../core/lang.js";import{property as t}from"../core/accessorSupport/decorators/property.js";import{s as i}from"./shared.js";import{subclass as n}from"../core/accessorSupport/decorators/subclass.js";import a from"../core/Collection.js";import{c as l,r as p}from"./collectionUtils.js";import{HandleOwnerMixin as m}from"../core/HandleOwner.js";import{a as c}from"./maybe.js";o.getLogger("esri.core.support.OwningCollection");let h=class extends(m(a)){constructor(e){super(e),this.handles.add([this.on("before-add",(e=>{c(e.item)&&e.preventDefault()})),this.on("after-add",(e=>this._own(e.item))),this.on("after-remove",(e=>this._release(e.item)))])}get owner(){return this._get("owner")}set owner(e){e!==this._get("owner")&&(this._releaseAll(),this._set("owner",e),this._ownAll())}_ownAll(){for(const e of this.items)this._own(e)}_releaseAll(){for(const e of this.items)this._release(e)}_createNewInstance(e){return this.itemType?new(a.ofType(this.itemType.Type))(e):new a(e)}};function f(e,r){return{type:e,cast:l,set(o){const s=p(o,this._get(r),e);s.owner=this,this._set(r,s)}}}e([t()],h.prototype,"owner",null),h=e([n("esri.core.support.OwningCollection")],h);let w=class extends h{_own(e){e.layer&&"remove"in e.layer&&e.layer!==this.owner&&e.layer.remove(e),e.layer=this.owner}_release(e){e.layer===this.owner&&(e.layer=null)}};e([i({Type:r,ensureType:s(r)})],w.prototype,"itemType",void 0),w=e([n("esri.support.GraphicsCollection")],w);export{w as G,h as O,f as o};
