/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
import"../core/lang.js";import{L as t}from"./Logger.js";import{j as n,e as r,u as s,n as e,k as o,h as a,o as i,m as c,a as u,b as f,v as g,w as m,d as l,p,x as h,s as d,y as j}from"./mathUtils.js";import{a as M}from"./maybe.js";import{h as y}from"./mat4.js";import{c as b,a as S}from"./vec4f64.js";import{a as v}from"./ray.js";import{s as A,a as P}from"./vectorStacks.js";var R;function x(t,r,s){const e=n(t,r)/n(t,t);return i(s,t,e)}function w(t,s){return n(t,s)/r(t)}function Z(t,e){const o=n(t,e)/(r(t)*r(e));return-s(o)}function _(t,r,a){e(k,t),e(q,r);const i=n(k,q),c=s(i),u=o(k,k,q);return n(u,a)<0?2*Math.PI-c:c}!function(t){t[t.X=0]="X",t[t.Y=1]="Y",t[t.Z=2]="Z"}(R||(R={}));const k=a(),q=a(),C=t.getLogger("esri.geometry.support.sphere");function L(){return b()}function O(t,n=L()){return c(n,t)}function T(t,n){return S(t[0],t[1],t[2],n)}function X(t){return t}function Y(t){t[0]=t[1]=t[2]=t[3]=0}function E(t,n){return t[0]=t[1]=t[2]=0,t[3]=n,t}function z(t){return t[3]}function I(t){return t}function U(t,n,r,s){return S(t,n,r,s)}function V(t,n,r){if(M(n))return!1;const{origin:s,direction:e}=n,o=B;o[0]=s[0]-t[0],o[1]=s[1]-t[1],o[2]=s[2]-t[2];const a=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=2*(e[0]*o[0]+e[1]*o[1]+e[2]*o[2]),c=i*i-4*a*(o[0]*o[0]+o[1]*o[1]+o[2]*o[2]-t[3]*t[3]);if(c<0)return!1;const u=Math.sqrt(c);let f=(-i-u)/(2*a);const g=(-i+u)/(2*a);return(f<0||g<f&&g>0)&&(f=g),!(f<0||(r&&(r[0]=s[0]+e[0]*f,r[1]=s[1]+e[1]*f,r[2]=s[2]+e[2]*f),0))}const B=a();function D(t,n){return V(t,n,null)}function F(t,n,s){const e=A.get(),a=P.get();o(e,n.origin,n.direction);const c=z(t);o(s,e,n.origin),i(s,s,1/r(s)*c);const u=J(t,n.origin),f=Z(n.origin,s);return y(a,f+u,e),m(s,s,a),s}function G(t,n,s){const e=l(A.get(),n,t),o=i(A.get(),e,t[3]/r(e));return f(s,o,t)}function H(t,n){const r=l(A.get(),n,t),s=p(r),e=t[3]*t[3];return Math.sqrt(Math.abs(s-e))}function J(t,n){const e=l(A.get(),n,t),o=r(e),a=z(t),i=a+Math.abs(a-o);return s(a/i)}const K=a();function N(t,n,r,s){const o=l(K,n,t);switch(r){case R.X:{const t=h(o,K)[2];return d(s,-Math.sin(t),Math.cos(t),0)}case R.Y:{const t=h(o,K),n=t[1],r=t[2],e=Math.sin(n);return d(s,-e*Math.cos(r),-e*Math.sin(r),Math.cos(n))}case R.Z:return e(s,o);default:return}}function Q(t,n){const s=l($,n,t);return r(s)-t[3]}function W(t,n){const r=j(t,n),s=z(t);return r<=s*s}const $=a(),tt=L(),nt=Object.freeze(Object.defineProperty({__proto__:null,create:L,copy:O,fromCenterAndRadius:T,wrap:X,clear:Y,fromRadius:E,getRadius:z,getCenter:I,fromValues:U,elevate:function(t,n,r){return t!==r&&u(r,t),r[3]=t[3]+n,r},setExtent:function(t,n,r){return C.error("sphere.setExtent is not yet supported"),t===r?r:O(t,r)},intersectRay:V,intersectsRay:D,intersectRayClosestSilhouette:function(t,n,s){if(V(t,n,s))return s;const e=F(t,n,A.get());return f(s,n.origin,i(A.get(),n.direction,g(n.origin,e)/r(n.direction))),s},closestPointOnSilhouette:F,closestPoint:function(t,n,r){return V(t,n,r)?r:(v(n,t,r),G(t,r,r))},projectPoint:G,distanceToSilhouette:H,angleToSilhouette:J,axisAt:N,altitudeAt:Q,setAltitudeAt:function(t,n,r,s){const e=Q(t,n),o=N(t,n,R.Z,$),a=i($,o,r-e);return f(s,n,a)},containsPoint:W,tmpSphere:tt},Symbol.toStringTag,{value:"Module"}));export{R as A,_ as a,Y as b,L as c,O as d,I as e,U as f,z as g,Z as h,D as i,x as j,V as k,T as l,F as m,E as n,H as o,w as p,W as q,nt as s,tt as t,X as w};
