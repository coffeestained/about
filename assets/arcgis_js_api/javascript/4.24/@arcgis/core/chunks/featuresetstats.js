/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
import{p as t,R as r,l as o,b as e,o as i,n}from"./languageUtils.js";import{m as s}from"./arcadeUtils.js";import{WhereClause as a}from"../core/sql/WhereClause.js";import"../geometry/Point.js";import"./tslib.es6.js";import"./Logger.js";import"../config.js";import"../core/lang.js";import"./maybe.js";import"./object.js";import"./string.js";import"../core/accessorSupport/decorators/property.js";import"./ensureType.js";import"./get.js";import"./utils.js";import"./handleUtils.js";import"./metadata.js";import"../core/Error.js";import"../core/accessorSupport/decorators/cast.js";import"./reader.js";import"../core/accessorSupport/decorators/subclass.js";import"./tracking.js";import"./writer.js";import"../geometry/Geometry.js";import"../core/JSONSupport.js";import"../core/Accessor.js";import"./ArrayPool.js";import"./watch.js";import"../core/scheduling.js";import"./nextTick.js";import"../core/promiseUtils.js";import"../geometry/SpatialReference.js";import"../geometry/support/webMercatorUtils.js";import"./Ellipsoid.js";import"../geometry/Extent.js";import"../geometry/Multipoint.js";import"./zmUtils.js";import"../geometry/Polygon.js";import"./extentUtils.js";import"../geometry/Polyline.js";import"./datetime.js";import"./number.js";import"./locale.js";import"../layers/support/Field.js";import"./jsonMap.js";import"./enumeration.js";import"./domains.js";import"../layers/support/CodedValueDomain.js";import"../layers/support/Domain.js";import"../layers/support/InheritedDomain.js";import"../layers/support/RangeDomain.js";import"./fieldType.js";import"../geometry.js";import"./typeUtils.js";import"../geometry/support/jsonUtils.js";import"./parser.js";import"./featureConversionUtils.js";import"./OptimizedGeometry.js";import"./OptimizedFeatureSet.js";import"../kernel.js";import"../core/urlUtils.js";import"./unitUtils.js";import"./projectionEllipsoid.js";import"./sizeVariableUtils.js";import"./_commonjsHelpers.js";async function m(t,e,m,c,u,l){if(1===c.length){if(o(c[0]))return s(t,c[0],n(c[1],-1));if(i(c[0]))return s(t,c[0].toArray(),n(c[1],-1))}else if(2===c.length){if(o(c[0]))return s(t,c[0],n(c[1],-1));if(i(c[0]))return s(t,c[0].toArray(),n(c[1],-1));if(r(c[0])){const r=await c[0].load(),o=await p(a.create(c[1],r.getFieldsIndex()),l,u);return c[0].calculateStatistic(t,o,n(c[2],1e3),e.abortSignal)}}else if(3===c.length&&r(c[0])){const r=await c[0].load(),o=await p(a.create(c[1],r.getFieldsIndex()),l,u);return c[0].calculateStatistic(t,o,n(c[2],1e3),e.abortSignal)}return s(t,c,-1)}async function p(t,r,o){const e=t.getVariables();if(e.length>0){const i=[];for(let t=0;t<e.length;t++){const n={name:e[t]};i.push(await r.evaluateIdentifier(o,n))}const n={};for(let t=0;t<e.length;t++)n[e[t]]=i[t];return t.parameters=n,t}return t}function c(n){"async"===n.mode&&(n.functions.stdev=function(t,r){return n.standardFunctionAsync(t,r,(function(r,o,e){return m("stdev",r,0,e,t,n)}))},n.functions.variance=function(t,r){return n.standardFunctionAsync(t,r,(function(r,o,e){return m("variance",r,0,e,t,n)}))},n.functions.average=function(t,r){return n.standardFunctionAsync(t,r,(function(r,o,e){return m("mean",r,0,e,t,n)}))},n.functions.mean=function(t,r){return n.standardFunctionAsync(t,r,(function(r,o,e){return m("mean",r,0,e,t,n)}))},n.functions.sum=function(t,r){return n.standardFunctionAsync(t,r,(function(r,o,e){return m("sum",r,0,e,t,n)}))},n.functions.min=function(t,r){return n.standardFunctionAsync(t,r,(function(r,o,e){return m("min",r,0,e,t,n)}))},n.functions.max=function(t,r){return n.standardFunctionAsync(t,r,(function(r,o,e){return m("max",r,0,e,t,n)}))},n.functions.count=function(s,a){return n.standardFunctionAsync(s,a,(function(n,s,a){if(t(a,1,1),r(a[0]))return a[0].count(n.abortSignal);if(o(a[0])||e(a[0]))return a[0].length;if(i(a[0]))return a[0].length();throw new Error("Invalid Parameters for Count")}))})}export{c as registerFunctions};
