/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
import{_ as o}from"../chunks/tslib.es6.js";import{L as r}from"../chunks/Logger.js";import{i as t}from"../chunks/maybe.js";import{isDataProtocol as e,isAbsolute as s,normalize as i,makeData as n}from"../core/urlUtils.js";import{property as c}from"../core/accessorSupport/decorators/property.js";import"../core/lang.js";import"../chunks/ensureType.js";import{e as l}from"../chunks/enumeration.js";import{subclass as a}from"../core/accessorSupport/decorators/subclass.js";import p from"./Symbol3DLayer.js";import{w as h,i as m}from"../chunks/colors.js";import{s as u}from"../chunks/jsonMap.js";import{JSONSupport as y}from"../core/JSONSupport.js";import{r as d}from"../chunks/reader.js";import{w as f}from"../chunks/writer.js";import{f as j,t as b}from"../chunks/persistableUrlUtils.js";import{c as k,s as v}from"../chunks/materialUtils.js";import g from"../core/Accessor.js";import w from"../Color.js";import{p as S}from"../chunks/screenUtils.js";import{S as x}from"../chunks/Symbol3DMaterial.js";import"../config.js";import"../chunks/object.js";import"../chunks/string.js";import"../core/Error.js";import"../chunks/get.js";import"../chunks/utils.js";import"../chunks/handleUtils.js";import"../chunks/metadata.js";import"../chunks/tracking.js";import"../chunks/ArrayPool.js";import"../chunks/watch.js";import"../core/scheduling.js";import"../chunks/nextTick.js";import"../core/promiseUtils.js";import"../chunks/opacityUtils.js";import"../chunks/colorUtils.js";import"../chunks/mathUtils.js";import"../chunks/common.js";var z;const U=u()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let P=z=class extends y{constructor(o){super(o)}readHref(o,r,t){return o?j(o,t):r.dataURI}writeHref(o,r,t,n){o&&(e(o)?r.dataURI=o:(r.href=b(o,n),s(r.href)&&(r.href=i(r.href))))}clone(){return new z({href:this.href,primitive:this.primitive})}};o([c({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],P.prototype,"href",void 0),o([d("href")],P.prototype,"readHref",null),o([f("href",{href:{type:String},dataURI:{type:String}})],P.prototype,"writeHref",null),o([l(U)],P.prototype,"primitive",void 0),P=z=o([a("esri.symbols.support.IconSymbol3DLayerResource")],P);const I="circle";var L;let D=L=class extends g{constructor(){super(...arguments),this.x=0,this.y=0}clone(){return new L({x:this.x,y:this.y})}};var R;o([c({type:Number})],D.prototype,"x",void 0),o([c({type:Number})],D.prototype,"y",void 0),D=L=o([a("esri.symbols.support.Symbol3DAnchorPosition2D")],D);let M=R=class extends y{constructor(o){super(o),this.color=new w([0,0,0,1]),this.size=S(1)}clone(){const o={color:t(this.color)?this.color.clone():null,size:this.size};return new R(o)}};var N;o([c(k)],M.prototype,"color",void 0),o([c(v)],M.prototype,"size",void 0),M=R=o([a("esri.symbols.support.Symbol3DIconOutline")],M);const q=r.getLogger("esri.symbols.IconSymbol3DLayer");let H=N=class extends p{constructor(o){super(o),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=void 0,this.outline=void 0}clone(){return new N({anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),enabled:this.enabled,material:t(this.material)?this.material.clone():null,outline:t(this.outline)?this.outline.clone():null,resource:this.resource&&this.resource.clone(),size:this.size})}static fromSimpleMarkerSymbol(o){const r=o.color||h,t=O(o),e=o.outline&&o.outline.width>0?{size:o.outline.width,color:(o.outline.color||h).clone()}:null;return new N({size:o.size,resource:{primitive:(s=o.style,T[s]||(q.warn(`${s} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle"))},material:{color:r},outline:e,anchor:t?"relative":void 0,anchorPosition:t});var s}static fromPictureMarkerSymbol(o){const r=!o.color||m(o.color)?h:o.color,t=O(o);return new N({size:o.width<=o.height?o.height:o.width,resource:{href:o.url},material:{color:r.clone()},anchor:t?"relative":void 0,anchorPosition:t})}static fromCIMSymbol(o){return new N({resource:{href:n({mediaType:"application/json",data:JSON.stringify(o.data)})}})}};function O(o){const r="width"in o?o.width:o.size,t="height"in o?o.height:o.size,e=A(o.xoffset),s=A(o.yoffset);return(e||s)&&r&&t?{x:-e/r,y:s/t}:null}function A(o){return isFinite(o)?o:0}o([c({type:x,json:{write:!0}})],H.prototype,"material",void 0),o([c({type:P,json:{write:!0}})],H.prototype,"resource",void 0),o([l({Icon:"icon"},{readOnly:!0})],H.prototype,"type",void 0),o([c(v)],H.prototype,"size",void 0),o([l({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"}),c({json:{default:"center"}})],H.prototype,"anchor",void 0),o([c({type:D,json:{type:[Number],read:{reader:o=>new D({x:o[0],y:o[1]})},write:{writer:(o,r)=>{r.anchorPosition=[o.x,o.y]},overridePolicy(){return{enabled:"relative"===this.anchor}}}}})],H.prototype,"anchorPosition",void 0),o([c({type:M,json:{write:!0}})],H.prototype,"outline",void 0),H=N=o([a("esri.symbols.IconSymbol3DLayer")],H);const T={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};const C=H;export{D as S,I as d,C as default};
