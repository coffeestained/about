/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
import{_ as t}from"../chunks/tslib.es6.js";import{L as e}from"../chunks/Logger.js";import{a as r}from"../chunks/maybe.js";import{property as s}from"../core/accessorSupport/decorators/property.js";import"../core/lang.js";import{cast as i}from"../core/accessorSupport/decorators/cast.js";import{r as o}from"../chunks/reader.js";import{subclass as n}from"../core/accessorSupport/decorators/subclass.js";import{w as a}from"../chunks/writer.js";import{k as l}from"../chunks/ensureType.js";import c from"./Geometry.js";import u,{g as p}from"./SpatialReference.js";import{lngLatToXY as h,xyToLngLat as m}from"./support/webMercatorUtils.js";import"../config.js";import"../chunks/object.js";import"../chunks/string.js";import"../chunks/get.js";import"../chunks/utils.js";import"../chunks/handleUtils.js";import"../chunks/metadata.js";import"../core/Error.js";import"../chunks/tracking.js";import"../core/JSONSupport.js";import"../core/Accessor.js";import"../chunks/ArrayPool.js";import"../chunks/watch.js";import"../core/scheduling.js";import"../chunks/nextTick.js";import"../core/promiseUtils.js";import"../chunks/Ellipsoid.js";var d;const y=[0,0];function f(t){return t&&("esri.geometry.SpatialReference"===t.declaredClass||null!=t.wkid)}const g=e.getLogger("esri.geometry.Point");let j=d=class extends c{constructor(...t){super(...t),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}static copy(t,e){e._set("x",t._get("x")),e._set("y",t._get("y")),e._set("z",t._get("z")),e._set("m",t._get("m"));const r=t._get("spatialReference");e._set("spatialReference",Object.isFrozen(r)?r:r.clone())}normalizeCtorArgs(t,e,r,s,i){let o;if(Array.isArray(t))o=t,i=e,t=o[0],e=o[1],r=o[2],s=o[3];else if(t&&"object"==typeof t){if(o=t,t=null!=o.x?o.x:o.longitude,e=null!=o.y?o.y:o.latitude,r=o.z,s=o.m,(i=o.spatialReference)&&"esri.geometry.SpatialReference"!==i.declaredClass&&(i=new u(i)),null!=o.longitude||null!=o.latitude)if(null==o.longitude)g.warn(".longitude=","Latitude was defined without longitude");else if(null==o.latitude)g.warn(".latitude=","Longitude was defined without latitude");else if(!o.declaredClass&&i&&i.isWebMercator){const r=h(o.longitude,o.latitude,y);t=r[0],e=r[1]}}else f(r)?(i=r,r=null):f(s)&&(i=s,s=null);const n={x:t,y:e};return null==n.x&&null!=n.y?g.warn(".y=","Y coordinate was defined without an X coordinate"):null==n.y&&null!=n.x&&g.warn(".x=","X coordinate was defined without a Y coordinate"),null!=i&&(n.spatialReference=i),null!=r&&(n.z=r),null!=s&&(n.m=s),n}get cache(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}get hasM(){return void 0!==this.m}set hasM(t){t!==(void 0!==this._get("m"))&&(this._set("m",t?0:void 0),this._set("hasM",t))}get hasZ(){return void 0!==this.z}set hasZ(t){t!==(void 0!==this._get("z"))&&(this._set("z",t?0:void 0),this._set("hasZ",t))}get latitude(){const{spatialReference:t,x:e,y:r}=this;if(t){if(t.isWebMercator)return m(e,r,y)[1];if(t.isGeographic)return r}return null}set latitude(t){const{spatialReference:e,x:r}=this;e&&(e.isWebMercator?this._set("y",h(r,t,y)[1]):e.isGeographic&&this._set("y",t),this._set("latitude",t))}get longitude(){const{x:t,y:e,spatialReference:r}=this;if(r){if(r.isWebMercator)return m(t,e,y)[0];if(r.isGeographic)return t}return null}set longitude(t){const{y:e,spatialReference:r}=this;r&&(r.isWebMercator?this._set("x",h(t,e,y)[0]):r.isGeographic&&this._set("x",t),this._set("longitude",t))}writeX(t,e,r){e[r]=isNaN(t)?"NaN":t}readX(t){return"string"==typeof t?NaN:t}clone(){const t=new d;return t.x=this.x,t.y=this.y,t.z=this.z,t.m=this.m,t.spatialReference=this.spatialReference,t}copy(t){return d.copy(t,this),this}equals(t){if(r(t))return!1;const{x:e,y:s,z:i,m:o,spatialReference:n}=this,{z:a,m:l}=t;let{x:c,y:u,spatialReference:p}=t;if(!n.equals(p))if(n.isWebMercator&&p.isWGS84)[c,u]=h(c,u),p=n;else{if(!n.isWGS84||!p.isWebMercator)return!1;[c,u]=m(c,u),p=n}return e===c&&s===u&&i===a&&o===l&&n.wkid===p.wkid}offset(t,e,r){return function(t,e,r,s){return t.x=t.x+e,t.y=t.y+r,null!=s&&(t.z=(t.z??0)+s),t}(this,t,e,r)}normalize(){if(!this.spatialReference)return this;const t=p(this.spatialReference);if(!t)return this;let e=this.x;const[r,s]=t.valid,i=2*s;let o;return e>s?(o=Math.ceil(Math.abs(e-s)/i),e-=o*i):e<r&&(o=Math.ceil(Math.abs(e-r)/i),e+=o*i),this._set("x",e),this}distance(t){return function(t,e){const r=t.x-e.x,s=t.y-e.y,i=t.hasZ&&e.hasZ?t.z-e.z:0;return Math.sqrt(r*r+s*s+i*i)}(this,t)}toArray(){const t=this.hasZ,e=this.hasM;return t&&e?[this.x,this.y,this.z,this.m]:t?[this.x,this.y,this.z]:e?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(t){return this.write({},t)}};t([s({readOnly:!0})],j.prototype,"cache",null),t([s({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],j.prototype,"hasM",null),t([s({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],j.prototype,"hasZ",null),t([s({type:Number})],j.prototype,"latitude",null),t([s({type:Number})],j.prototype,"longitude",null),t([s({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),i((t=>isNaN(t)?t:l(t)))],j.prototype,"x",void 0),t([a("x")],j.prototype,"writeX",null),t([o("x")],j.prototype,"readX",null),t([s({type:Number,json:{write:!0}})],j.prototype,"y",void 0),t([s({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],j.prototype,"z",void 0),t([s({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],j.prototype,"m",void 0),j=d=t([n("esri.geometry.Point")],j),j.prototype.toJSON.isDefaultToJSON=!0;const x=j;export{x as default};
