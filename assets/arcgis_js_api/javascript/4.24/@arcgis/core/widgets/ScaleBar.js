/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
import{_ as s}from"../chunks/tslib.es6.js";import{watch as e}from"../core/reactiveUtils.js";import{f as t}from"../chunks/screenUtils.js";import{aliasOf as r}from"../core/accessorSupport/decorators/aliasOf.js";import"../core/lang.js";import{cast as i}from"../core/accessorSupport/decorators/cast.js";import{property as o}from"../core/accessorSupport/decorators/property.js";import{subclass as a}from"../core/accessorSupport/decorators/subclass.js";import l from"./Widget.js";import n from"./ScaleBar/ScaleBarViewModel.js";import"../chunks/widgetUtils.js";import{m as c}from"../chunks/messageBundle.js";import{t as p}from"../chunks/jsxFactory.js";import"../core/promiseUtils.js";import"../core/Error.js";import"../chunks/Logger.js";import"../config.js";import"../chunks/object.js";import"../chunks/maybe.js";import"../chunks/string.js";import"../chunks/handleUtils.js";import"../chunks/watch.js";import"../chunks/ArrayPool.js";import"../core/scheduling.js";import"../chunks/nextTick.js";import"../chunks/get.js";import"../chunks/utils.js";import"../chunks/tracking.js";import"../chunks/ensureType.js";import"../chunks/metadata.js";import"../intl.js";import"../chunks/number2.js";import"../chunks/jsonMap.js";import"../chunks/locale.js";import"../chunks/messages.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"../chunks/assets.js";import"../chunks/domUtils.js";import"../core/Evented.js";import"../core/Accessor.js";import"../core/Handles.js";import"../core/Collection.js";import"../chunks/shared.js";import"../chunks/SimpleObservable.js";import"../core/Promise.js";import"../chunks/uuid.js";import"../chunks/projector.js";import"../chunks/jsxWidgetSupport.js";import"../geometry.js";import"../geometry/Extent.js";import"../geometry/Geometry.js";import"../core/JSONSupport.js";import"../chunks/reader.js";import"../geometry/SpatialReference.js";import"../chunks/writer.js";import"../geometry/Point.js";import"../geometry/support/webMercatorUtils.js";import"../chunks/Ellipsoid.js";import"../geometry/Multipoint.js";import"../chunks/zmUtils.js";import"../geometry/Polygon.js";import"../chunks/extentUtils.js";import"../geometry/Polyline.js";import"../chunks/typeUtils.js";import"../geometry/support/jsonUtils.js";import"../geometry/support/geodesicUtils.js";import"../chunks/unitUtils.js";import"../chunks/projectionEllipsoid.js";import"../chunks/geodesicConstants.js";import"../geometry/support/normalizeUtils.js";import"../chunks/normalizeUtilsCommon.js";const m="esri-scale-bar__label",u="esri-scale-bar__ruler-block";function d(s){return 2*s}let h=class extends l{constructor(s,e){super(s,e),this.label=void 0,this.messages=null,this.unit="non-metric",this.view=null,this.viewModel=new n}initialize(){this.own([e((()=>{const{view:s}=this;return[s?.stationary,s?.center,s?.scale,s?.zoom]}),(([s])=>{s&&this.scheduleRender()}))])}set style(s){const e="dual"===this.unit?"line":s;this._set("style",e)}castStyle(s){return"line"===s?s:"ruler"}castUnit(s){return"metric"===s||"dual"===s?s:"non-metric"}render(){const s="disabled"===this.get("viewModel.state"),e={"esri-disabled":s};let t,r;if(!s){const{unit:s,style:e}=this,i="metric"===s||"dual"===s,o=50;if("non-metric"===s||"dual"===s){const s=this.viewModel.getScaleBarProperties(o,"non-metric");s&&(r="ruler"===e?this._renderRuler(s):this._renderLine(s,"bottom"))}if(i){const s=this.viewModel.getScaleBarProperties(o,"metric");s&&(t="ruler"===e?this._renderRuler(s):this._renderLine(s,"top"))}}return p("div",{afterCreate:this._handleRootCreateOrUpdate,afterUpdate:this._handleRootCreateOrUpdate,bind:this,class:this.classes("esri-scale-bar esri-widget",e)},t,r)}_renderRuler(s){const e=d(Math.round(s.length)),{messages:t}=this,r=t[s.unit]||t.unknownUnit,i=`${d(s.value)} ${r}`;return p("div",{class:this.classes("esri-scale-bar__bar-container","esri-scale-bar__bar-container--ruler"),key:"esri-scale-bar__ruler"},p("div",{class:"esri-scale-bar__ruler",styles:{width:`${e}px`}},p("div",{class:u}),p("div",{class:u}),p("div",{class:u}),p("div",{class:u})),p("div",{class:this.classes("esri-scale-bar__label-container","esri-scale-bar__label-container--ruler")},p("div",{class:m},"0"),p("div",{class:m},i)))}_renderLine(s,e){const{messages:t}=this,r=t[s.unit]||t.unknownUnit,i=`${d(s.value)} ${r}`,o={"esri-scale-bar__label-container--top":"top"===e,"esri-scale-bar__label-container--bottom":"bottom"===e},a=p("div",{class:this.classes("esri-scale-bar__label-container","esri-scale-bar__label-container--line",o),key:"esri-scale-bar__label"},p("div",{class:m},i)),l={"esri-scale-bar__line--top":"top"===e,"esri-scale-bar__line--bottom":"bottom"===e},n=d(Math.round(s.length)),c=p("div",{class:this.classes("esri-scale-bar__line",l),key:"esri-scale-bar__line",styles:{width:`${n}px`}});return p("div",{class:this.classes("esri-scale-bar__bar-container","esri-scale-bar__bar-container--line"),key:"esri-scale-bar__line-container"},[c,a])}_handleRootCreateOrUpdate(s){const e=this.viewModel;if(!e)return;const r=s.getBoundingClientRect(),i=r.left+window.pageXOffset,o=r.top+window.pageYOffset,a=t(i,o);(a.x!==e.scaleComputedFrom.x||a.y!==e.scaleComputedFrom.y)&&(e.scaleComputedFrom=a)}};s([o({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],h.prototype,"label",void 0),s([o(),c("esri/widgets/ScaleBar/t9n/ScaleBar")],h.prototype,"messages",void 0),s([o()],h.prototype,"style",null),s([i("style")],h.prototype,"castStyle",null),s([o()],h.prototype,"unit",void 0),s([i("unit")],h.prototype,"castUnit",null),s([r("viewModel.view")],h.prototype,"view",void 0),s([o()],h.prototype,"viewModel",void 0),h=s([a("esri.widgets.ScaleBar")],h);const j=h;export{j as default};
