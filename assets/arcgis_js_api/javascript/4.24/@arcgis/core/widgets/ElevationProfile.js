/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
import{_ as t}from"../chunks/tslib.es6.js";import{f as e,i as s,d as i,r as o,u as r,a as n,e as a,p as l}from"../chunks/maybe.js";import{m as p}from"../chunks/memoize.js";import{o as c,throwIfAborted as m,createTask as u,createAbortError as d}from"../core/promiseUtils.js";import{watch as h,initial as g}from"../core/reactiveUtils.js";import{aliasOf as j}from"../core/accessorSupport/decorators/aliasOf.js";import{C as b}from"../core/lang.js";import"../chunks/ensureType.js";import{property as f}from"../core/accessorSupport/decorators/property.js";import{subclass as y}from"../core/accessorSupport/decorators/subclass.js";import k from"./Widget.js";import v from"./ElevationProfile/ElevationProfileViewModel.js";import _ from"../core/Accessor.js";import C from"../core/Collection.js";import{substitute as x}from"../intl.js";import{t as S}from"../chunks/throttle.js";import{f as w,e as P,u as M}from"../chunks/unitFormatUtils.js";import{F as L,N as U,a as E,M as T,E as I,P as B,b as A,L as F}from"./ElevationProfile/ElevationProfileLine.js";import{e as D,i as z,o as V}from"../chunks/widgetUtils.js";import{m as O}from"../chunks/messageBundle.js";import{t as R}from"../chunks/jsxFactory.js";import{w as $,c as W}from"../chunks/unitUtils.js";import{P as G}from"../chunks/Popover.js";import{m as H,h as N}from"../chunks/handleUtils.js";import{l as Y}from"./Feature.js";import{i as X}from"../chunks/themeUtils.js";import{a as q}from"../chunks/number2.js";import"../core/Error.js";import"../chunks/Logger.js";import"../config.js";import"../chunks/object.js";import"../chunks/string.js";import"../chunks/watch.js";import"../chunks/ArrayPool.js";import"../core/scheduling.js";import"../chunks/nextTick.js";import"../chunks/get.js";import"../chunks/utils.js";import"../chunks/tracking.js";import"../chunks/metadata.js";import"../chunks/domUtils.js";import"../core/Evented.js";import"../core/Handles.js";import"../chunks/shared.js";import"../chunks/SimpleObservable.js";import"../core/Promise.js";import"../chunks/uuid.js";import"../core/accessorSupport/decorators/cast.js";import"../chunks/projector.js";import"../chunks/assets.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"../chunks/jsxWidgetSupport.js";import"../chunks/locale.js";import"../chunks/messages.js";import"../chunks/jsonMap.js";import"../Graphic.js";import"../geometry.js";import"../geometry/Extent.js";import"../geometry/Geometry.js";import"../core/JSONSupport.js";import"../chunks/reader.js";import"../geometry/SpatialReference.js";import"../chunks/writer.js";import"../geometry/Point.js";import"../geometry/support/webMercatorUtils.js";import"../chunks/Ellipsoid.js";import"../geometry/Multipoint.js";import"../chunks/zmUtils.js";import"../geometry/Polygon.js";import"../chunks/extentUtils.js";import"../geometry/Polyline.js";import"../chunks/typeUtils.js";import"../geometry/support/jsonUtils.js";import"../PopupTemplate.js";import"../layers/support/fieldUtils.js";import"../chunks/arcadeOnDemand.js";import"../popup/content.js";import"../popup/content/AttachmentsContent.js";import"../popup/content/Content.js";import"../popup/content/CustomContent.js";import"../popup/content/ExpressionContent.js";import"../popup/ElementExpressionInfo.js";import"../popup/content/FieldsContent.js";import"../popup/FieldInfo.js";import"../chunks/enumeration.js";import"../popup/support/FieldInfoFormat.js";import"../chunks/date.js";import"../popup/content/MediaContent.js";import"../popup/content/BarChartMediaInfo.js";import"../popup/content/mixins/ChartMediaInfo.js";import"../popup/content/mixins/MediaInfo.js";import"../popup/content/support/ChartMediaInfoValue.js";import"../popup/content/support/ChartMediaInfoValueSeries.js";import"../chunks/chartMediaInfoUtils.js";import"../popup/content/ColumnChartMediaInfo.js";import"../popup/content/ImageMediaInfo.js";import"../popup/content/support/ImageMediaInfoValue.js";import"../popup/content/LineChartMediaInfo.js";import"../popup/content/PieChartMediaInfo.js";import"../popup/content/TextContent.js";import"../popup/ExpressionInfo.js";import"../popup/LayerOptions.js";import"../popup/RelatedRecordsInfo.js";import"../popup/support/RelatedRecordsInfoFieldOrder.js";import"../support/actions/ActionBase.js";import"../chunks/Identifiable.js";import"../support/actions/ActionButton.js";import"../support/actions/ActionToggle.js";import"../symbols.js";import"../symbols/CIMSymbol.js";import"../symbols/Symbol.js";import"../Color.js";import"../chunks/colorUtils.js";import"../chunks/mathUtils.js";import"../chunks/common.js";import"../symbols/ExtrudeSymbol3DLayer.js";import"../symbols/Symbol3DLayer.js";import"../chunks/utils2.js";import"../symbols/edges/Edges3D.js";import"../chunks/screenUtils.js";import"../chunks/materialUtils.js";import"../chunks/opacityUtils.js";import"../symbols/edges/SketchEdges3D.js";import"../symbols/edges/SolidEdges3D.js";import"../chunks/Symbol3DMaterial.js";import"../symbols/FillSymbol.js";import"../symbols/SimpleLineSymbol.js";import"../symbols/LineSymbol.js";import"../symbols/LineSymbolMarker.js";import"../chunks/lineMarkers.js";import"../symbols/FillSymbol3DLayer.js";import"../symbols/patterns/LineStylePattern3D.js";import"../symbols/patterns/StylePattern3D.js";import"../chunks/utils3.js";import"../chunks/colors.js";import"../chunks/symbolLayerUtils3D.js";import"../chunks/aaBoundingBox.js";import"../chunks/aaBoundingRect.js";import"../symbols/Font.js";import"../symbols/IconSymbol3DLayer.js";import"../chunks/persistableUrlUtils.js";import"../symbols/LabelSymbol3D.js";import"../symbols/Symbol3D.js";import"../chunks/collectionUtils.js";import"../portal/Portal.js";import"../core/Loadable.js";import"../portal/PortalQueryParams.js";import"../portal/PortalQueryResult.js";import"../portal/PortalUser.js";import"../portal/PortalFolder.js";import"../portal/PortalGroup.js";import"../symbols/LineSymbol3DLayer.js";import"../symbols/LineStyleMarker3D.js";import"../core/Clonable.js";import"../symbols/ObjectSymbol3DLayer.js";import"../symbols/PathSymbol3DLayer.js";import"../symbols/TextSymbol3DLayer.js";import"../symbols/WaterSymbol3DLayer.js";import"../chunks/Thumbnail.js";import"../chunks/Symbol3DVerticalOffset.js";import"../symbols/callouts/Callout3D.js";import"../symbols/callouts/LineCallout3D.js";import"../symbols/LineSymbol3D.js";import"../symbols/MarkerSymbol.js";import"../symbols/MeshSymbol3D.js";import"../symbols/PictureFillSymbol.js";import"../chunks/urlUtils.js";import"../symbols/PictureMarkerSymbol.js";import"../symbols/PointSymbol3D.js";import"../symbols/PolygonSymbol3D.js";import"../symbols/SimpleFillSymbol.js";import"../symbols/SimpleMarkerSymbol.js";import"../symbols/TextSymbol.js";import"../symbols/WebStyleSymbol.js";import"../chunks/byteSizeEstimations.js";import"../chunks/LRUCache.js";import"../chunks/MemCache.js";import"../chunks/ElevationQueryTileCache.js";import"../chunks/defaultUnit.js";import"../chunks/elevationInfoUtils.js";import"../chunks/unitConversionUtils.js";import"../chunks/lengthUtils.js";import"../chunks/vec2.js";import"../geometry/projection.js";import"../chunks/mat4.js";import"../chunks/pe.js";import"../chunks/projectionEllipsoid.js";import"../chunks/geodesicConstants.js";import"../geometry/support/GeographicTransformation.js";import"../geometry/support/GeographicTransformationStep.js";import"../chunks/zscale.js";import"../geometry/support/geodesicUtils.js";import"../chunks/QueueProcessor.js";import"../chunks/Queue.js";import"../chunks/Scheduler.js";import"../chunks/debugFlags.js";import"../chunks/traversalUtils.js";import"./ElevationProfile/ElevationProfileLineGround.js";import"../chunks/elevationQuerySourceUtils.js";import"../Ground.js";import"../chunks/compilerUtils.js";import"../chunks/loadAll.js";import"../chunks/asyncUtils.js";import"./ElevationProfile/ElevationProfileLineInput.js";import"../chunks/ElevationQuery2.js";import"../layers/support/ElevationSampler.js";import"./ElevationProfile/ElevationProfileLineQuery.js";import"./ElevationProfile/ElevationProfileLineView.js";import"../chunks/vec4f64.js";import"../chunks/ray.js";import"../chunks/vectorStacks.js";import"../chunks/quatf64.js";import"../chunks/mat4f64.js";import"../chunks/vec2f64.js";import"../chunks/Intersector.js";import"../chunks/ViewingMode.js";import"../chunks/boundedPlane.js";import"../chunks/sphere.js";import"../chunks/lineSegment.js";import"../chunks/plane.js";import"../chunks/mathUtils2.js";import"../chunks/verticalOffsetUtils.js";import"../chunks/mat3.js";import"../chunks/quat.js";import"../chunks/vec3f32.js";import"../chunks/utils4.js";import"../chunks/Util.js";import"../chunks/doublePrecisionUtils.js";import"../chunks/intersectorUtilsConversions.js";import"../layers/GraphicsLayer.js";import"../chunks/GraphicsCollection.js";import"../core/HandleOwner.js";import"../layers/Layer.js";import"../layers/mixins/BlendLayer.js";import"../chunks/jsonUtils.js";import"../chunks/parser2.js";import"../chunks/mat4f32.js";import"../chunks/_commonjsHelpers.js";import"../layers/mixins/ScaleRangeLayer.js";import"../chunks/ElevationInfo.js";import"../views/DOMContainer.js";import"./Popup.js";import"./Spinner/SpinnerViewModel.js";import"../chunks/AnchorElementViewModel.js";import"./Popup/PopupViewModel.js";import"../symbols/support/symbolUtils.js";import"../chunks/utils6.js";import"../chunks/ItemCache.js";import"../symbols/support/cimSymbolUtils.js";import"../chunks/utils7.js";import"../chunks/colorUtils2.js";import"../chunks/mat2df32.js";import"../chunks/InputManager.js";import"../chunks/layerViewUtils.js";import"./Feature/FeatureViewModel.js";import"./Attachments/AttachmentsViewModel.js";import"../rest/query/support/AttachmentInfo.js";import"../rest/support/AttachmentQuery.js";import"../chunks/languageUtils.js";import"../chunks/datetime.js";import"../chunks/number.js";import"../layers/support/Field.js";import"../chunks/domains.js";import"../layers/support/CodedValueDomain.js";import"../layers/support/Domain.js";import"../layers/support/InheritedDomain.js";import"../layers/support/RangeDomain.js";import"../chunks/fieldType.js";import"../chunks/DataLayerSource.js";import"../chunks/executeQueryJSON.js";import"../chunks/utils5.js";import"../chunks/query.js";import"../geometry/support/normalizeUtils.js";import"../chunks/normalizeUtilsCommon.js";import"../chunks/pbfQueryUtils.js";import"../chunks/pbf.js";import"../chunks/OptimizedGeometry.js";import"../chunks/OptimizedFeatureSet.js";import"../chunks/queryZScale.js";import"../rest/support/FeatureSet.js";import"../rest/support/Query.js";import"../TimeExtent.js";import"../chunks/timeUtils.js";import"../rest/support/StatisticDefinition.js";import"../chunks/featureConversionUtils.js";import"../rest/support/RelationshipQuery.js";import"../rest/support/TopFeaturesQuery.js";import"../rest/support/TopFilter.js";import"../layers/FeatureLayer.js";import"../renderers/ClassBreaksRenderer.js";import"../renderers/Renderer.js";import"../renderers/support/AuthoringInfo.js";import"../renderers/support/AuthoringInfoVisualVariable.js";import"../chunks/colorRamps.js";import"../rest/support/AlgorithmicColorRamp.js";import"../rest/support/ColorRamp.js";import"../rest/support/MultipartColorRamp.js";import"../renderers/mixins/VisualVariablesMixin.js";import"../renderers/visualVariables/ColorVariable.js";import"../renderers/visualVariables/VisualVariable.js";import"../chunks/LegendOptions.js";import"../renderers/visualVariables/support/ColorStop.js";import"../renderers/visualVariables/OpacityVariable.js";import"../renderers/visualVariables/support/OpacityStop.js";import"../renderers/visualVariables/RotationVariable.js";import"../renderers/visualVariables/SizeVariable.js";import"../renderers/visualVariables/support/SizeStop.js";import"../chunks/sizeVariableUtils.js";import"../chunks/visualVariableUtils.js";import"../renderers/support/ClassBreakInfo.js";import"../chunks/commonProperties2.js";import"../symbols/support/jsonUtils.js";import"../chunks/symbolConversion.js";import"../renderers/DictionaryRenderer.js";import"../chunks/DictionaryLoader.js";import"../renderers/DotDensityRenderer.js";import"../renderers/support/AttributeColorInfo.js";import"../renderers/HeatmapRenderer.js";import"../renderers/support/HeatmapColorStop.js";import"../chunks/heatmapUtils.js";import"../renderers/PieChartRenderer.js";import"../renderers/SimpleRenderer.js";import"../renderers/UniqueValueRenderer.js";import"../chunks/diffUtils.js";import"../renderers/support/UniqueValueInfo.js";import"../chunks/styleUtils2.js";import"../renderers/support/jsonUtils.js";import"../chunks/MultiOriginJSONSupport.js";import"../core/sql.js";import"../form/FormTemplate.js";import"../form/ExpressionInfo.js";import"../form/elements/GroupElement.js";import"../form/elements/Element.js";import"../form/support/elements.js";import"../form/elements/FieldElement.js";import"../form/elements/support/inputs.js";import"../form/elements/inputs/BarcodeScannerInput.js";import"../form/elements/inputs/TextInput.js";import"../form/elements/inputs/Input.js";import"../form/elements/inputs/ComboBoxInput.js";import"../form/elements/inputs/DateTimePickerInput.js";import"../form/elements/inputs/RadioButtonsInput.js";import"../form/elements/inputs/SwitchInput.js";import"../form/elements/inputs/TextAreaInput.js";import"../form/elements/inputs/TextBoxInput.js";import"../geometry/HeightModelInfo.js";import"../chunks/FeatureIndex.js";import"../core/workers/workers.js";import"../core/workers/Connection.js";import"../core/workers/RemoteClient.js";import"../layers/mixins/APIKeyMixin.js";import"../chunks/ArcGISService.js";import"../chunks/arcgisLayerUrl.js";import"../layers/mixins/CustomParametersMixin.js";import"../layers/mixins/FeatureEffectLayer.js";import"../layers/support/FeatureEffect.js";import"../layers/support/FeatureFilter.js";import"../chunks/OperationalLayer.js";import"../chunks/commonProperties.js";import"../support/timeUtils.js";import"../layers/mixins/OrderedLayer.js";import"../layers/mixins/PortalLayer.js";import"../portal/PortalItem.js";import"../portal/PortalItemResource.js";import"../portal/PortalRating.js";import"../layers/mixins/RefreshableLayer.js";import"../layers/mixins/TemporalLayer.js";import"../TimeInterval.js";import"../layers/support/TimeInfo.js";import"../layers/support/TimeReference.js";import"../chunks/featureReductionUtils.js";import"../chunks/FeatureReduction.js";import"../layers/support/FeatureReductionBinning.js";import"../layers/support/AggregateField.js";import"../layers/support/OutStatistic.js";import"../layers/support/LabelClass.js";import"../chunks/labelUtils.js";import"../chunks/defaultsJSON.js";import"../layers/support/FeatureReductionCluster.js";import"../layers/support/FeatureReductionSelection.js";import"../layers/support/FeatureTemplate.js";import"../layers/support/FeatureType.js";import"../chunks/fieldProperties.js";import"../layers/support/FieldsIndex.js";import"../layers/support/GeometryFieldsInfo.js";import"../chunks/labelingInfo.js";import"../layers/support/LayerFloorInfo.js";import"../layers/support/Relationship.js";import"../chunks/versionUtils.js";import"../chunks/styleUtils.js";import"../support/popupUtils.js";import"../chunks/actions.js";import"./support/GoTo.js";import"../chunks/Heading.js";import"../chunks/accessibleHandler.js";import"../chunks/vmEvent.js";import"./Attachments.js";import"../chunks/Cyclical.js";import"./support/widget.js";import"../chunks/utils13.js";import"../chunks/numberUtils.js";import"./Sketch/SketchViewModel.js";import"../geometry/Circle.js";import"../chunks/keybindings.js";import"../views/interactive/sketch/SketchLabelOptions.js";import"../views/interactive/sketch/SketchTooltipOptions.js";import"../chunks/SnappingManager.js";import"../chunks/QueryEngineResult.js";import"../chunks/quantizationUtils.js";import"../core/sql/WhereClause.js";import"../chunks/utils11.js";import"../chunks/generateRendererUtils.js";import"../chunks/projectionSupport.js";import"../chunks/json.js";import"../chunks/utils18.js";import"../chunks/Settings2.js";import"../chunks/RightAngleSnappingHint.js";import"../chunks/geometry2dUtils.js";import"../chunks/viewUtils.js";import"../views/interactive/snapping/SnappingOptions.js";import"../views/interactive/snapping/FeatureSnappingLayerSource.js";import"../chunks/hitTestSelectUtils.js";import"../chunks/screenUtils2.js";import"../chunks/Material.js";import"../chunks/VertexAttribute.js";import"../chunks/basicInterfaces.js";const Q="esri-elevation-profile",Z={esriWidget:"esri-widget--panel esri-widget",esriWidgetDisabled:"esri-widget--disabled",buttonDisabled:"esri-button--disabled",widgetIcon:"esri-icon-elevation-profile",base:`${Q}`,portrait:`${Q}--portrait`,refined:`${Q}--refined`,mainContainer:`${Q}__main-container`,promptContainer:`${Q}__prompt-container`,header:`${Q}__header`,zoomOutButton:`${Q}__zoom-out-button esri-icon-zoom-out-magnifying-glass`,clearButton:`${Q}__clear-button esri-icon-trash`,actionButton:`${Q}__action-button esri-button`,sketchButton:`${Q}__sketch-button esri-button--primary`,sketchCancelButton:`${Q}__sketch-cancel-button esri-button--secondary`,sketchDoneButton:`${Q}__sketch-done-button esri-button--primary`,selectButton:`${Q}__select-button esri-button--secondary`,selectCancelButton:`${Q}__select-cancel-button esri-button--secondary`,chartContainer:`${Q}__chart-container`,chartSpinner:`${Q}__chart-spinner esri-icon-loading-indicator esri-rotating`,chartSpinnerVisible:`${Q}__chart-spinner--visible`,chartSpinnerSmall:`${Q}__chart-spinner--small`,footer:`${Q}__footer`},J="esri-elevation-profile-legend-item",K={base:J,disabled:`${J}--disabled`,expanded:`${J}--expanded`,colorIndicator:`${J}__color-indicator`,header:`${J}__header`,content:`${J}__content`,collapseToggle:`${J}__collapse-toggle esri-button esri-button--tertiary`,collapseToggleIcon:`${J}__collapse-toggle__icon esri-icon-down`,label:`${J}__label`,labelDisabled:`${J}__label--disabled`,checkbox:`${J}__checkbox`},tt="esri-elevation-profile-statistics",et={base:tt,statistic:`${tt}__statistic`,statisticLabel:`${tt}__statistic__label`,statisticValue:`${tt}__statistic__value`,slopeValue:`${tt}__slope-value`,slopeUpIcon:"esri-icon-arrow-up",slopeDownIcon:"esri-icon-arrow-down"},st="esri-elevation-profile-settings",it={base:`${st} esri-icon-handle-vertical`,popoverContent:`${st}__popover-content`,select:`${st}__select esri-select`,selectLabel:`${st}__select-label`,checkboxLabel:`${st}__checkbox-label`,checkbox:`${st}__checkbox`,uniformChartScalingCheckbox:`${st}__uniform-chart-scaling-checkbox`};let ot=class extends _{constructor(){super(...arguments),this.legend=!0,this.chart=!0,this.clearButton=!0,this.settingsButton=!0,this.sketchButton=!0,this.selectButton=!0,this.unitSelector=!0,this.uniformChartScalingToggle=!0}};t([f()],ot.prototype,"legend",void 0),t([f()],ot.prototype,"chart",void 0),t([f()],ot.prototype,"clearButton",void 0),t([f()],ot.prototype,"settingsButton",void 0),t([f()],ot.prototype,"sketchButton",void 0),t([f()],ot.prototype,"selectButton",void 0),t([f()],ot.prototype,"unitSelector",void 0),t([f()],ot.prototype,"uniformChartScalingToggle",void 0),ot=t([y("esri.widgets.ElevationProfile.ElevationProfileVisibleElements")],ot);const rt=ot;let nt=class extends k{constructor(t,e){super(t,e),this._messagesUnits=null,this._updateLayout=t=>{const e=t.parentElement,s=t.style.display;e.removeChild(t),document.body.appendChild(t),t.style.display="block";let i=80;for(const e of t.childNodes)e instanceof HTMLElement&&(i=Math.max(i,e.offsetWidth));document.body.removeChild(t),e.appendChild(t),t.style.display=s,t.style.setProperty("--max-width",`${i}px`)},this._updateLayoutThrottled=S(this._updateLayout,100)}initialize(){this.own(this._updateLayoutThrottled)}render(){return R("div",{bind:this,class:et.base,afterCreate:this._updateLayout,afterUpdate:this._updateLayoutThrottled},this._renderStatistics())}_renderStatistics(){const t=this._messages?.statistics;return t?[this._renderDistanceStatistic("maxDistance",t.maxDistance),this._renderElevationStatistic("elevationGain",t.gain),this._renderElevationStatistic("elevationLoss",t.loss),this._renderElevationStatistic("minElevation",t.minElevation),this._renderElevationStatistic("maxElevation",t.maxElevation),this._renderElevationStatistic("avgElevation",t.avgElevation),this._renderSlopeStatistic("maxPositiveSlope","maxNegativeSlope",t.maxSlope),this._renderSlopeStatistic("avgPositiveSlope","avgNegativeSlope",t.avgSlope)]:[]}_renderDistanceStatistic(t,e){const s=this._renderValue(t,(t=>{const e=this.effectiveUnits.distance;return w(this._messagesUnits,t,e,L)}));return this._renderStatistic(e,s)}_renderElevationStatistic(t,e){const s=this._renderValue(t,(t=>{const e=this.effectiveUnits.elevation;return w(this._messagesUnits,t,e,L)}));return this._renderStatistic(e,s)}_renderSlopeStatistic(t,e,s){const i=R("div",{key:"slope-up",class:et.slopeValue},R("div",{class:et.slopeUpIcon}),this._renderValue(t,(t=>P(t,"degrees","geographic","geographic",L))),R("div",{class:et.slopeDownIcon}),this._renderValue(e,(t=>P(t,"degrees","geographic","geographic",L))));return this._renderStatistic(s,i)}_renderStatistic(t,e){return R("div",{class:et.statistic},R("label",{class:et.statisticLabel},t),R("div",{class:et.statisticValue},e))}_renderValue(t,i){const o=this.line,r=1===o.progress?o.statistics:null,n=e(r,(e=>e[t]));return s(n)?i(n):U}};function at(t,{profiles:e}){const i=t.title;if(s(i))return i;switch(t.type){case"ground":return e.ground;case"input":return e.input;case"query":return e.query;case"view":return e.view;default:return""}}t([f()],nt.prototype,"effectiveUnits",void 0),t([f()],nt.prototype,"line",void 0),t([f(),O("esri/widgets/ElevationProfile/t9n/ElevationProfile")],nt.prototype,"_messages",void 0),t([f(),O("esri/core/t9n/Units")],nt.prototype,"_messagesUnits",void 0),nt=t([y("esri.widgets.ElevationProfile.Statistics")],nt);let lt=class extends k{constructor(t,e){super(t,e),this.expanded=!1,this.checkboxVisible=!0,this._messages=null}initialize(){this._statistics=new nt(this._statisticsProps),this.own(h((()=>this._statisticsProps),(t=>this._statistics.set(t))))}destroy(){this._statistics=i(this._statistics)}render(){const t=this.expanded;return R("div",{key:this,class:this.classes(K.base,{[K.disabled]:this.disabled,[K.expanded]:t})},this._renderColorIndicator(),R("div",{key:"header",class:K.header},this._renderLabelWithCheckbox(),this._renderCollapseToggleButton()),t&&R("div",{key:"content",class:K.content},this._statistics.render()))}get disabled(){return!this.line.available}get _statisticsProps(){return{line:this.line,effectiveUnits:this.effectiveUnits}}_renderColorIndicator(){return R("div",{key:"color-indicator",class:K.colorIndicator,styles:{backgroundColor:this.line.color.toCss()}})}_renderCollapseToggleButton(){const t=this._messages,e=this.expanded?t.hideDetails:t.showDetails;return R("button",{key:"collapse-toggle",bind:this,class:K.collapseToggle,onclick:this._onCollapseToggleClick,title:e,"aria-label":e,type:"button"},R("span",{class:K.collapseToggleIcon}))}_onCollapseToggleClick(){this.onExpandedToggle()}_renderLabelWithCheckbox(){const{line:t,checkboxVisible:e,disabled:s}=this,i=`${K.base}__check-${t.id}`;return R("label",{key:"id",for:i,class:this.classes(K.label,{[K.labelDisabled]:s||!e})},e&&this._renderCheckbox(i),R("span",null,at(t,this._messages)))}_renderCheckbox(t){const e=this.line,s=e.visible,i=this.disabled,o=this._messages,r=s?o.hideProfile:o.showProfile,n=at(e,this._messages),a=x(r,{name:n});return R("input",{key:"checkbox",id:t,type:"checkbox",class:K.checkbox,title:a,checked:s,disabled:i,"aria-label":a,bind:this,onchange:t=>this._onCheckboxToggle(t,e)})}_onCheckboxToggle(t,e){t.stopPropagation(),e.toggleVisibility()}};t([f({nonNullable:!0})],lt.prototype,"effectiveUnits",void 0),t([f({nonNullable:!0})],lt.prototype,"line",void 0),t([f()],lt.prototype,"expanded",void 0),t([f()],lt.prototype,"disabled",null),t([f()],lt.prototype,"checkboxVisible",void 0),t([f()],lt.prototype,"onExpandedToggle",void 0),t([f()],lt.prototype,"_statistics",void 0),t([f(),O("esri/widgets/ElevationProfile/t9n/ElevationProfile")],lt.prototype,"_messages",void 0),lt=t([y("esri.widgets.ElevationProfile.LegendItem")],lt);let pt=class extends k{constructor(t,e){super(t,e),this._items=new C,this._expandedLine=null}initialize(){this.own([h((()=>this.profiles),(t=>{this._destroyItems(),this._items.addMany(t.map((t=>this._createItemForLine(t))))}),g),h((()=>this.effectiveUnits),(t=>{this._items.forEach((e=>{e.effectiveUnits=t}))}),g)])}destroy(){this._destroyItems()}render(){return R("div",{class:"esri-elevation-profile-legend"},this._items.toArray().map((t=>t.render())))}_onExpandedToggle(t){this._expandedLine=t===this._expandedLine?null:t,this._items.forEach((t=>t.expanded=t.line===this._expandedLine))}_createItemForLine(t){return new lt({line:t,effectiveUnits:this.effectiveUnits,expanded:t===this._expandedLine,checkboxVisible:this.profiles.length>1,onExpandedToggle:()=>this._onExpandedToggle(t)})}_destroyItems(){this._items.drain((t=>t.destroy()))}};t([f()],pt.prototype,"profiles",void 0),t([f()],pt.prototype,"effectiveUnits",void 0),t([f()],pt.prototype,"_items",void 0),t([f()],pt.prototype,"_expandedLine",void 0),pt=t([y("esri.widgets.ElevationProfile.Legend")],pt);let ct=class extends k{constructor(t,e){super(t,e),this._messagesUnits=null,this._popover=null,this._buttonElement=null,this._focusOutElement=null,this._requestFocusOnCreate=!1}destroy(){this._destroyPopover()}render(){const{unitSelector:t,uniformChartScalingToggle:e}=this.visibleElements;if(!t&&!e)return R("div",{key:`${this.id}-empty`});const i=s(this._popover)&&this._popover.open?this._messages.hideSettings:this._messages.showSettings;return R("button",{class:it.base,title:i,bind:this,afterCreate:this._initializePopover,onclick:this._togglePopover,"aria-label":i,type:"button"})}_initializePopover(t){this._destroyPopover(),this._buttonElement=t,this._popover=new G({owner:this,placement:"bottom-end",offset:[0,0],anchorElement:t,renderContentFunction:()=>this._renderPopoverContent()})}_destroyPopover(){this._focusOutElement=o(this._focusOutElement),this._popover=i(this._popover)}_renderPopoverContent(){const{unitSelector:t,uniformChartScalingToggle:e}=this.visibleElements;return R("div",{class:it.popoverContent,dir:D(r(this._buttonElement)),bind:this,afterCreate:this._onPopoverContentAfterCreate},t&&this._renderUnitSelector(),e&&this._renderUniformChartScalingToggle())}_renderUnitSelector(){const{unit:t,unitOptions:e}=this.viewModel,s=this._messagesUnits;return R("label",{key:"unit-selector-label",class:it.selectLabel},this._messages.unitSelectLabel,R("select",{class:it.select,value:t,bind:this,onchange:this._onUnitChange,afterCreate:this._onUnitSelectAfterCreate},e.map((t=>R("option",{key:t,value:t},$(t)?s.systems[t]:s.units[t].pluralCapitalized)))))}_onUnitChange(t){this.viewModel.unit=t.target.value}_onUnitSelectAfterCreate(t){this._requestFocusOnCreate&&(this._requestFocusOnCreate=!1,t.focus())}_renderUniformChartScalingToggle(){const t=this._messages,e=this.viewModel.uniformChartScaling,s=e?t.uniformChartScalingDisable:t.uniformChartScalingEnable;return R("label",{key:"uniform-chart-scaling-label",class:it.checkboxLabel,onmousedown:mt},R("input",{class:this.classes(it.checkbox,it.uniformChartScalingCheckbox),type:"checkbox",checked:e,title:s,"aria-label":s,bind:this,onchange:this._onUniformChartScalingChange}),t.uniformChartScalingLabel)}_onUniformChartScalingChange(t){this.viewModel.uniformChartScaling=t.target.checked}_togglePopover(t){s(this._popover)&&this._popover.open?this._closePopover():this._openPopover()}_openPopover(){e(this._popover,(t=>t.open=!0)),this._requestFocusOnCreate=!0}_closePopover({focusOnButton:t=!0}={}){e(this._popover,(t=>t.open=!1)),t&&e(this._buttonElement,(t=>t.focus()))}_onPopoverContentAfterCreate(t){o(this._focusOutElement),this._focusOutElement=c(t,"focusout",(({relatedTarget:e})=>{const s=t.contains(e),i=e===this._buttonElement;s||i||this._closePopover({focusOnButton:!1})}))}};function mt(t){t.preventDefault()}function ut(t,e){const s=Math.floor(Math.log10(t)),i=t/10**s;let o;return o=e?i<1.5?1:i<3?2:i<5?2.5:i<7?5:10:i<=1?1:i<=2?2:i<=3?2.5:i<=5?5:10,o*10**s}t([f()],ct.prototype,"viewModel",void 0),t([f()],ct.prototype,"visibleElements",void 0),t([f(),O("esri/widgets/ElevationProfile/t9n/ElevationProfile")],ct.prototype,"_messages",void 0),t([f(),O("esri/core/t9n/Units")],ct.prototype,"_messagesUnits",void 0),ct=t([y("esri.widgets.ElevationProfile.SettingsButton")],ct);const dt={sideSpacing:15,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,axisFontSize:9,axisFontWeight:"400",axisGridStroke:"#f4f4f4",axisLabelsFontSize:9,axisLabelsFontWeight:"400",axisLabelsColor:"#a9a9a9",axisTooltipFontSize:12,axisTooltipBackgroundColor:"#323232",axisTooltipLabelColor:"#f8f8f8",axisTooltipPaddingTop:Math.round(3),axisTooltipPaddingBottom:Math.round(3),axisTooltipPaddingHorizontal:Math.round(3.75),xAxisMinGridDistance:50,xAxisLabelsSpacing:Math.round(6),xAxisMinLabelPosition:.05,xAxisMaxLabelPosition:.9,yAxisMinGridDistance:30,yAxisLabelSpacing:Math.round(3.75),yAxisMinLabelPosition:0,yAxisMaxLabelPosition:.8,seriesTooltipFontSize:12,seriesTooltipBackgroundColor:"#f8f8f8",seriesTooltipLabelColor:"#323232",seriesFillLighten:.9,seriesTooltipSpacing:6,seriesTooltipPaddingVertical:Math.round(3.75),seriesTooltipPaddingHorizontal:Math.round(3.75),tooltipBorderRadius:0},ht={...dt,axisGridStroke:"#323232",axisLabelsColor:"#a9a9a9",axisTooltipBackgroundColor:"#323232",axisTooltipLabelColor:"#f8f8f8",seriesTooltipBackgroundColor:"#323232",seriesTooltipLabelColor:"#f8f8f8",seriesFillLighten:-.75},gt={minX:void 0,maxX:void 0,minY:void 0,maxY:void 0};function jt({data:t,bounds:e,pixelWidth:s,pixelHeight:i,centered:o}){if(n(t))return e;let{minX:r,maxX:a,minY:l,maxY:p}=e;const c=a-r,m=p-l,u=t.effectiveUnits,d=W(m,u.elevation,u.distance)/i/(c/s);return d>=1?[r,a]=bt([r,a],d,o):[l,p]=bt([l,p],1/d,o),{minX:r,maxX:a,minY:l,maxY:p}}function bt([t,e],s,i){const o=(e-t)*s;if(i){const s=(t+e)/2-o/2;return[s,s+o]}return[t,t+o]}function ft(t,{line:s,fill:i},o){const{theme:r}=t,{am4core:n}=t.amCharts4Index,{r:l,g:p,b:c,a:m}=o.color,u=n.color({r:l,g:p,b:c,a:m}),d=a(o.samples,[]),h=d.length>0;s.stroke=u,s.visible=h,e(i,(t=>{t.visible=h,t.fill=u.lighten(r.seriesFillLighten)}));const g=d.length,j=s.data;if(j.length===g){for(let t=0;t<g;++t)b=j[t],f=d[t],b.x=f.x,b.y=f.y,b.z=f.z,b.distance=f.distance,b.elevation=f.elevation;s.invalidateRawData(),e(i,(t=>t.invalidateRawData()))}else s.data=d,e(i,(t=>t.data=d));var b,f}function yt(t,e){const{id:s}=e,i=kt(t,`line-${s}`);i.strokeWidth=e.chartStrokeWidth,i.dy=e.chartStrokeOffsetY;let o=null;return e.chartFillEnabled&&(o=kt(t,`fill-${s}`),o.fillOpacity=1),{id:s,line:i,fill:o}}function kt(t,e){const s=new t.amCharts4Index.am4charts.LineSeries;return s.id=e,s.showOnInit=!1,s.simplifiedProcessing=!0,s.minDistance=.5,s.excludeFromTotal=!0,s.clickable=!1,s.contextMenuDisabled=!0,s.cursorHoverEnabled=!1,s.cursorTooltipEnabled=!1,s.connect=!1,s.fill=null,s.stroke=null,s.dataFields.valueX="distance",s.dataFields.valueY="elevation",s}function vt(t,e){const{amChart:s,xAxis:i,yAxis:o}=t;let r=!1;const a=()=>{const{data:e}=t;if(!r||n(e)||!e.uniformScaling)return;r=!1;const{minX:a,maxX:l,minY:p,maxY:c}=jt({data:t.data,bounds:{minX:i.minZoomed,maxX:i.maxZoomed,minY:o.minZoomed,maxY:o.maxZoomed},pixelWidth:i.pixelWidth,pixelHeight:o.pixelHeight,centered:!0});i.zoomToValues(a,l,!0),o.zoomToValues(p,c,!0),s.validate(),xt(t)},l=()=>{e(t.xAxis.zoomFactor,t.yAxis.zoomFactor)},p=e=>{t.zooming=e,xt(t)},c=[s.events.on("down",(()=>p(!0))),s.events.on("up",(()=>p(!1))),s.cursor.events.on("zoomended",(()=>{r=!0})),i.events.on("startendchanged",a),o.events.on("startendchanged",a),i.events.on("rangechangeended",l),o.events.on("rangechangeended",l)];return H((()=>{c.forEach((t=>t.dispose()))}))}function _t({xAxis:t,yAxis:e}){const s=t=>()=>{t.renderer.grid.each((t=>{t.visible="none"!==t.dataItem.label.dom.getAttribute("display")}))},i=[t.events.on("rangechangeended",s(t)),t.events.on("validated",s(t)),e.events.on("rangechangeended",s(e)),e.events.on("validated",s(e))];return H((()=>{i.forEach((t=>t.dispose()))}))}function Ct(t,e){const{amChart:s,xAxis:i,yAxis:o}=t,{cursor:r,events:n}=s,a=e=>{t.pointerIsOver=e,xt(t)},l=()=>{a(!1),e(null,null)},p=[r.events.on("cursorpositionchanged",(()=>{if(!t.pointerIsOver)return;xt(t);const s=i.toAxisPosition(r.xPosition),n=o.toAxisPosition(r.yPosition);e(s,n)})),n.on("over",(()=>a(!0))),n.on("out",l),n.on("blur",l)];return H((()=>{p.forEach((t=>t.dispose()))}))}function xt(t){const{amChart:i,xAxis:o,data:r,theme:a,zooming:l,pointerIsOver:p}=t;if(t.amChart.tooltip.hide(),t.xAxis.hideTooltip(),!p)return;if(l)return;if(n(r)||!r.refined)return;const c=function(t){const{amChart:i,yAxis:o,data:r}=t;if(n(r))return null;const a=r.lines.map((s=>({line:s,y:e(Pt(t,s),(t=>t.elevation))}))).sort(St),l=a.length?a[0].y:null;if(n(l))return null;const p=i.cursor,c=o.measuredHeight,m=c+i.pixelPaddingTop;return{text:a.map((({y:e,line:i})=>function(t,e,i){const{data:o,messages:r}=t;if(n(o)||n(r))return"";const a=x(r.chartTooltip,{name:at(e,r),elevation:s(i)?w(r,i,o.effectiveUnits.elevation,L):U});return`[${e.color.toHex()}]●[/] ${a}`}(t,i,e))).join("\n"),x:p.point.x+p.parent.pixelX+i.pixelPaddingLeft,y:m-o.valueToPosition(l)*c}}(t);if(s(c)){const{cursor:e,tooltip:r}=i;e.show(0),e.validate(),r.text=c.text,r.show(0),r.validate();const l=c.y-r.contentHeight-a.seriesTooltipSpacing;r.pointerOrientation=l<30?"up":"down",r.pointTo(c,!0),r.validate();const p=o.tooltip;p.text=function(t){const{data:e,messages:i}=t;if(n(e)||n(i))return"";const o=e.lines[0],r=o?Pt(t,o):null;return s(r)?w(i,r.distance,e.effectiveUnits.distance,L):"-"}(t),p.show(0),p.validate()}}function St({y:t},{y:e}){return n(t)?1:n(e)?-1:e-t}function wt(t,e){const s=t.xAxis.numberFormatter.clone();return s.format=(s,i,o)=>{const{messages:r,data:a}=t;return n(r)||n(a)||"string"==typeof s?"":`${q(s,{maximumFractionDigits:o})} ${M(r,a.effectiveUnits[e],"abbr")}`},s}function Pt({amChart:t,xAxis:e},s){const i=a(s.samples,[]);if(0===i.length)return null;const o=e.toAxisPosition(t.cursor.xPosition),r=e.positionToValue(o);return b(i,r,(t=>t.distance))}var Mt;!function(t){t.Sketch="sketch",t.SketchCancel="sketch-cancel",t.SketchDone="sketch-done",t.Select="select",t.SelectCancel="select-cancel"}(Mt||(Mt={}));const Lt=[{type:Mt.Select},{type:Mt.Sketch}],Ut={[I.None]:null,[I.NoValidInput]:"noProfile",[I.NoVisibleProfiles]:"noProfile",[I.RefinedButNoChartData]:"noProfile",[I.TooComplex]:"tooComplex",[I.UnknownError]:"unknown",[I.InvalidGeometry]:"invalidGeometry",[I.InvalidElevationInfo]:"invalidElevationInfo"};let Et=class extends k{constructor(t,e){super(t,e),this.viewModel=null,this.view=null,this.input=null,this.profiles=null,this.unitOptions=[],this.unit="metric",this.geodesicDistanceThreshold=1e5,this.visibleElements=new rt,this.iconClass=Z.widgetIcon,this.label=void 0,this.messages=null,this.messagesCommon=null,this.messagesUnits=null,this._chartContainer=null,this._chart=null,this._chartInitTask=null,this._chartIsRefined=!1,this._width=0,this._zoomOutButtonVisible=!1,this._getChartUpdateParamsMemoized=p(((t,e,s,i)=>({chart:t,data:e,stationary:s,messages:i}))),this._getDetailsPropsMemoized=p(((t,e)=>({effectiveUnits:t,profiles:e}))),t?.viewModel||(this._defaultViewModel=new v({view:t?.view}),this.viewModel=this._defaultViewModel)}initialize(){this._legend=new pt(this._legendProps),this._settingsButton=new ct(this._settingsButtonProps),this.own([h((()=>this._legendProps),(t=>this._legend.set(t))),h((()=>this._settingsButtonProps),(t=>this._settingsButton.set(t)))])}postInitialize(){this.own([h((()=>({container:this._chartContainer,width:this._width})),(({container:t,width:e})=>{this._destroyChart(),s(t)&&e>0&&this._initializeChart(t)}),g),h((()=>this._chartUpdateParams),(()=>this._updateChart(this._chartUpdateParams)),g)])}destroy(){this._destroyChart(),s(this._defaultViewModel)&&this.viewModel!==this._defaultViewModel&&this._defaultViewModel.destroy(),this._legend=i(this._legend),this._settingsButton=i(this._settingsButton)}get _portrait(){return this._width<B}get _chartUpdateParams(){const t=this.view;return this._getChartUpdateParamsMemoized(this._chart,this.viewModel.chartData,!s(t)||t.stationary,this._chartMessages)}get _chartMessages(){return{...this.messagesUnits,...this.messages}}get _legendProps(){return this._getDetailsPropsMemoized(this.viewModel.effectiveUnits,this._profilesArray)}get _profilesArray(){return this.profiles.toArray()}get _settingsButtonProps(){return{viewModel:this.viewModel,visibleElements:this.visibleElements}}render(){const{viewModel:t,visible:e}=this;return R("div",{key:this,class:this.classes({[Z.base]:e,[Z.esriWidget]:e,[Z.esriWidgetDisabled]:e&&"disabled"===t.state,[Z.portrait]:this._portrait,[Z.refined]:1===t.progress}),"aria-label":this.messages.widgetLabel,afterCreate:t=>{this.own(V(t,(t=>{this._width=t.contentRect.width})))}},e&&this._renderContentForState())}_renderContentForState(){switch(this.viewModel.state){case A.Ready:return this._renderContentForReadyState();case A.Selecting:return this._renderContentForSelectingState();case A.Creating:return this._renderContentForCreatingState();case A.Selected:return this._renderContentForSelectedState();case A.Created:return this._renderContentForCreatedState();case A.Disabled:return this._renderContentForReadyState()}}_renderContentForReadyState(){const{sketchButton:t,selectButton:e}=this.visibleElements,s=this.messages;let i;return i=t&&e?s.readyPrompt:t?s.readyPromptCreateOnly:e?s.readyPromptSelectOnly:s.errors?.noProfile,this._renderContent({prompt:i,chart:!1,actions:Lt})}_renderContentForSelectingState(){const t=this.view;if(n(t))return null;const e=this.messages[`selectingPrompt-${t.type}`];return this._renderContent({prompt:e,chart:!1,actions:[{type:Mt.SelectCancel}]})}_renderContentForCreatingState(){const{view:t,viewModel:e}=this;if(n(t))return null;const s=e.hasVertices?[{type:Mt.SketchCancel},{type:Mt.SketchDone,disabled:!e.tool.interaction.canStopCreating}]:[{type:Mt.Select},{type:Mt.Sketch,disabled:!0}];if(e.errorState===I.NoValidInput){const e=this.messages[`creatingPrompt-${t.type}`];return this._renderContent({chart:!1,actions:s,prompt:e})}const i=this._getErrorMessage();return i?this._renderContent({chart:!1,actions:s,prompt:i}):this._renderContent({chart:!0,actions:s})}_renderContentForSelectedState(){const t=this._getErrorMessage();return t?this._renderContent({chart:!1,actions:Lt,prompt:t}):this._renderContent({chart:!0,actions:Lt})}_renderContentForCreatedState(){const t=this._getErrorMessage();return t?this._renderContent({chart:!1,actions:Lt,prompt:t}):this._renderContent({chart:!0,actions:Lt})}_getErrorMessage(){const t=Ut[this.viewModel.errorState];return this.messages?.errors?.[t]}_renderContent(t){const e=s(t.prompt)?this._renderPrompt(t.prompt):t.chart&&this._renderChart(),i=s(this.viewModel.input);return[R("header",{key:"header",class:Z.header},this._zoomOutButtonVisible&&this._renderZoomOutButton(),this.visibleElements.clearButton&&i&&this._renderClearButton(),this.visibleElements.settingsButton&&this._settingsButton.render()),R("div",{class:Z.mainContainer},...e),this.visibleElements.legend&&this._legend.render(),this._renderActions(t)]}_renderZoomOutButton(){return R("button",{key:"zoom-out",class:Z.zoomOutButton,bind:this,onclick:this._onZoomOutButtonClick,title:this.messages.zoomOut,type:"button"})}_onZoomOutButtonClick(){e(this._chart,(t=>t.zoomOut()))}_renderClearButton(){return R("button",{key:"clear-profile",class:Z.clearButton,bind:this,onclick:this._onClearButtonClick,title:this.messages.clearProfile,type:"button"})}_onClearButtonClick(){this.viewModel.clear()}_renderPrompt(t){return[R("div",{key:"prompt-container",bind:this,class:Z.promptContainer},R("p",null,t))]}_renderChart(){if(!this.visibleElements.chart)return[R("div",{key:"empty-chart-container",class:Z.chartContainer})];const t=this._chartIsRefined||this._canRenderChart();if(!t)return[this._renderSpinner({size:"large"}),R("div",{key:"chart-container-empty",class:Z.chartContainer})];const{chartData:e,progress:i}=this.viewModel;return[s(e)&&i>0&&i<1&&this._renderSpinner({size:t?"small":"large"}),R("div",{key:"chart-container",bind:this,class:Z.chartContainer,afterCreate:this._onChartContainerAfterCreate,afterRemoved:this._onChartContainerRemoved})]}_renderSpinner(t){return R("div",{key:"spinner",class:this.classes(Z.chartSpinner,{[Z.chartSpinnerSmall]:"small"===t.size}),afterCreate:this._onSpinnerAfterCreate,exitAnimation:this._onSpinnerExit})}_onSpinnerAfterCreate(t){requestAnimationFrame((()=>t.classList.add(Z.chartSpinnerVisible)))}_onSpinnerExit(t,e){t.classList.remove(Z.chartSpinnerVisible),setTimeout(e,200)}_canRenderChart(){const t=this.viewModel.chartData;if(n(t))return!1;if(!this.viewModel.inputIsSketched)return t.refined;let e=0;for(const{samples:i}of t.lines)e+=s(i)?i.length:0;return t.refined||e<=F}_renderActions({actions:t}){const e=t.map((t=>{switch(t.type){case Mt.Sketch:return this.visibleElements.sketchButton&&this._renderAction({action:t,onClick:this._onSketchButtonClick,className:Z.sketchButton,label:this.messages.sketchButtonLabel});case Mt.SketchCancel:return this.visibleElements.sketchButton&&this._renderAction({action:t,onClick:this._onCancelButtonClick,className:Z.sketchCancelButton,label:this.messagesCommon.cancel});case Mt.SketchDone:return this.visibleElements.sketchButton&&this._renderAction({action:t,onClick:this._onDoneButtonClick,className:Z.sketchDoneButton,label:this.messagesCommon.done});case Mt.Select:return this.visibleElements.selectButton&&this._renderAction({action:t,onClick:this._onSelectButtonClick,className:Z.selectButton,label:this.messages.selectButtonLabel});case Mt.SelectCancel:return this.visibleElements.selectButton&&this._renderAction({action:t,onClick:this._onCancelButtonClick,className:Z.selectCancelButton,label:this.messagesCommon.cancel})}})).filter(Boolean);return e.length?R("footer",{key:"footer",class:Z.footer},...e):null}_renderAction({action:t,onClick:e,className:s,label:i}){return R("button",{key:`action-${t.type}`,class:this.classes(Z.actionButton,s,{[Z.buttonDisabled]:t.disabled}),bind:this,disabled:t.disabled,onclick:e,type:"button"},i)}_onSketchButtonClick(){this.viewModel.start({mode:"sketch"})}_onSelectButtonClick(){this.viewModel.start({mode:"select"})}_onCancelButtonClick(){this.viewModel.cancel()}_onDoneButtonClick(){this.viewModel.stop()}_updateChart(t){const{data:e,chart:i,messages:o,stationary:r}=t;!n(i)&&!n(o)&&r&&this._canRenderChart()&&(i.update(t),this._chartIsRefined=s(e)&&e.refined)}_onChartContainerAfterCreate(t){this._chartContainer=t}_onChartContainerRemoved(){this._chartContainer=null}_initializeChart(t){l(this._chartInitTask),this._chartInitTask=u((async o=>{const r=await async function(t){const i=await Y(),{am4core:o,am4charts:r}=i;m(t.abortOptions);const{options:a}=o;a.minPolylineStep=.5,a.autoSetClassName=!0,a.animationsEnabled=!1;const l=X(),p=l?ht:dt;l&&o.useTheme(i.am4themes_dark);const c=o.create(t.container,r.XYChart);c.arrangeTooltips=!1,c.preloader.disabled=!0,c.zoomOutButton.disabled=!0;const u=z(t.container);c.rtl=u,c.padding(p.paddingTop,u?p.paddingLeft:p.paddingRight,p.paddingBottom,u?p.paddingRight:p.paddingLeft);const d=c.plotContainer.background;d.strokeWidth=0,d.strokeOpacity=0,d.stroke=null;const h=c.xAxes.push(new r.ValueAxis),g=c.yAxes.push(new r.ValueAxis),j={params:t,amCharts4Index:i,amChart:c,xAxis:h,yAxis:g,series:new Map,data:null,messages:null,theme:p,zooming:!1,pointerIsOver:!1};c.cursor=function(t){const e=new t.amCharts4Index.am4charts.XYCursor;return e.trackable=!0,e.lineY.disabled=!0,e.behavior="zoomXY",e}(j),function(t){const e=t.theme,s=t.amChart.tooltip,{am4core:i}=t.amCharts4Index;s.id="series-tooltip",s.fitPointerToBounds=!0,s.pointerOrientation="vertical",s.zIndex=-1,s.getFillFromObject=!1,s.label.fontSize=e.seriesTooltipFontSize,s.label.fill=i.color(e.seriesTooltipLabelColor),s.label.padding(e.seriesTooltipPaddingVertical,e.seriesTooltipPaddingHorizontal,e.seriesTooltipPaddingVertical,e.seriesTooltipPaddingHorizontal),s.background.cornerRadius=e.tooltipBorderRadius,s.background.stroke=null,s.background.fill=i.color(e.seriesTooltipBackgroundColor),s.background.padding(0,0,0,0),s.adapter.add("dy",(()=>e.seriesTooltipSpacing*(s.background.pointerY<=0?1:-1))),z(t.params.container)&&(s.label.textAlign="middle")}(j),function(t){const{xAxis:e,theme:s}=t,{am4core:i}=t.amCharts4Index;e.numberFormatter=wt(t,"distance"),e.strictMinMax=!0,e.cursorTooltipEnabled=!1,e.title.visible=!1;const o=e.renderer;o.line.visible=!1,o.minGridDistance=s.xAxisMinGridDistance,o.minLabelPosition=s.xAxisMinLabelPosition,o.maxLabelPosition=s.xAxisMaxLabelPosition,o.fontWeight=s.axisFontWeight,o.fontSize=s.axisFontSize,o.baseGrid.disabled=!0;const r=o.labels.template;r.fontSize=s.axisLabelsFontSize,r.fontWeight=s.axisLabelsFontWeight,r.fill=i.color(s.axisLabelsColor),r.paddingTop=s.xAxisLabelsSpacing,r.horizontalCenter="left",r.paddingLeft=0;const n=e.tooltip;n.id="axis-tooltip",n.background.fill=i.color(s.axisTooltipBackgroundColor),n.background.stroke=null,n.background.padding(0,0,0,0),n.label.fontSize=s.axisTooltipFontSize,n.label.fill=i.color(s.axisTooltipLabelColor),n.label.padding(s.axisTooltipPaddingTop,s.axisTooltipPaddingHorizontal,s.axisTooltipPaddingBottom,s.axisTooltipPaddingHorizontal);const a=o.grid.template;a.strokeOpacity=1,a.stroke=i.color(s.axisGridStroke)}(j),function(t){const{yAxis:e,theme:s}=t,{am4core:i}=t.amCharts4Index;e.numberFormatter=wt(t,"elevation"),e.title.visible=!1,e.cursorTooltipEnabled=!1,e.strictMinMax=!0,e.baseValue=E;const o=e.renderer;o.inside=!0,o.line.opacity=0,o.line.visible=!1,o.minGridDistance=s.yAxisMinGridDistance,o.minLabelPosition=s.yAxisMinLabelPosition,o.maxLabelPosition=s.yAxisMaxLabelPosition,o.fontWeight=s.axisFontWeight,o.fontSize=s.axisFontSize,o.baseGrid.disabled=!0;const r=o.labels.template;r.fontSize=s.axisLabelsFontSize,r.fontWeight=s.axisLabelsFontWeight,r.fill=i.color(s.axisLabelsColor),r.verticalCenter="bottom",r.paddingLeft=s.yAxisLabelSpacing,r.paddingBottom=0;const n=o.grid.template;n.strokeOpacity=1,n.stroke=i.color(s.axisGridStroke),z(t.params.container)&&(o.opposite=!0,r.textAlign="middle",r.paddingLeft=0,r.paddingRight=s.yAxisLabelSpacing)}(j);const b=[vt(j,t.onRangeChange),Ct(j,t.onCursorPositionChange),_t(j)];let f=null,y=!1;const k=()=>{n(f)||("undefined"!=typeof window&&"cancelIdleCallback"in window?window.cancelIdleCallback(f):clearTimeout(f),f=null)};return{...j,destroy(){y=!0,k(),N(b).remove(),c.dispose()},update(t){if(t.data===j.data&&t.messages===j.messages)return;if(k(),y)return;const i=()=>{y||(f=null,function(t,{data:i,messages:o}){const{htmlContainer:r}=t.amChart;if(!r)return;const a=s(i)&&i.refined;t.amChart.cursor.disabled=!a,r.classList.toggle("amcharts-cursor--enabled",a);const l=t.data!==i,p=e(t.data,(t=>t.effectiveUnits))!==e(i,(t=>t.effectiveUnits));t.data=i,t.messages=o,l&&(function(t){const{xAxis:s,yAxis:i}=t,{minX:o,maxX:r,minY:a,maxY:l}=function({data:t,pixelWidth:s,pixelHeight:i}){if(n(t))return gt;const o=t.statistics,r=e(o,(t=>t.maxDistance));let a=e(o,(t=>t.minElevation)),l=e(o,(t=>t.maxElevation));if(n(r)||n(a)||n(l))return gt;const p=Math.max(r-0,.001);let c=Math.max(l-a,.001);const m=t.effectiveUnits;if(t.dynamicElevationRange){const t=W(p,m.distance,m.elevation);c=Math.max(c,t/T)}return a-=.02*c,l=a+c+.02*c,[a,l]=function(t,e,s=10){const i=ut(e-t,!1);if(0===i)return[t,e];const o=ut(i/(s-1),!0);return[Math.floor(t/o)*o,Math.ceil(e/o)*o]}(a,l,10),c=l-a,t.uniformScaling?jt({data:t,bounds:{minX:0,maxX:r,minY:a,maxY:l},pixelWidth:s,pixelHeight:i,centered:!0}):{minX:0,maxX:0+p,minY:a,maxY:a+c}}({data:t.data,pixelWidth:s.pixelWidth,pixelHeight:i.pixelHeight});s.min=o,s.max=r,i.min=a,i.max=l}(t),function(t){const{amChart:s,data:i}=t;if(n(i)||0===i.lines.length)return void s.series.clear();const o=new Map,r=new Set(s.series.values),a=i.lines.length;for(let n=0;n<a;n++){const l=i.lines[n];let p=t.series.get(l.id);p?(e(p.fill,(t=>r.delete(t))),r.delete(p.line)):(p=yt(t,l),e(p.fill,(t=>s.series.push(t))),s.series.push(p.line)),o.set(p.id,p);const c=a-n-1;e(p.fill,(t=>t.zIndex=c)),p.line.zIndex=a+c,ft(t,p,l)}t.series=o;for(const t of r)s.series.removeValue(t)}(t)),p&&(t.yAxis.invalidateLabels(),t.xAxis.invalidateLabels()),xt(t)}(j,t))};f="undefined"!=typeof window&&"requestIdleCallback"in window?window.requestIdleCallback(i,{timeout:30}):setTimeout(i,30)},zoomOut(){y||(j.yAxis.zoom({start:0,end:1},!1,!0),j.xAxis.zoom({start:0,end:1},!1,!0))}}}({container:t,abortOptions:{signal:o},onRangeChange:(t,e)=>{this._zoomOutButtonVisible=1!==t||1!==e},onCursorPositionChange:t=>{this.viewModel.hoveredChartPosition=t}});if(o.aborted)throw i(r),d();this._chart=r,this._updateChart(this._chartUpdateParams)}))}_destroyChart(){this._chartInitTask=l(this._chartInitTask),this._chart=i(this._chart),this._chartIsRefined=!1}};t([f({type:v})],Et.prototype,"viewModel",void 0),t([j("viewModel.view")],Et.prototype,"view",void 0),t([j("viewModel.input")],Et.prototype,"input",void 0),t([j("viewModel.profiles")],Et.prototype,"profiles",void 0),t([j("viewModel.unitOptions")],Et.prototype,"unitOptions",void 0),t([j("viewModel.unit")],Et.prototype,"unit",void 0),t([j("viewModel.geodesicDistanceThreshold")],Et.prototype,"geodesicDistanceThreshold",void 0),t([f({type:rt,nonNullable:!0})],Et.prototype,"visibleElements",void 0),t([f()],Et.prototype,"iconClass",void 0),t([j("messages.widgetLabel",{overridable:!0})],Et.prototype,"label",void 0),t([j("viewModel.visible")],Et.prototype,"visible",void 0),t([f(),O("esri/widgets/ElevationProfile/t9n/ElevationProfile")],Et.prototype,"messages",void 0),t([f(),O("esri/t9n/common")],Et.prototype,"messagesCommon",void 0),t([f(),O("esri/core/t9n/Units")],Et.prototype,"messagesUnits",void 0),t([f()],Et.prototype,"_chartContainer",void 0),t([f()],Et.prototype,"_chart",void 0),t([f()],Et.prototype,"_chartInitTask",void 0),t([f()],Et.prototype,"_chartIsRefined",void 0),t([f()],Et.prototype,"_settingsButton",void 0),t([f()],Et.prototype,"_legend",void 0),t([f()],Et.prototype,"_width",void 0),t([f()],Et.prototype,"_portrait",null),t([f()],Et.prototype,"_zoomOutButtonVisible",void 0),t([f()],Et.prototype,"_chartUpdateParams",null),t([f()],Et.prototype,"_chartMessages",null),t([f()],Et.prototype,"_legendProps",null),t([f()],Et.prototype,"_profilesArray",null),t([f()],Et.prototype,"_settingsButtonProps",null),Et=t([y("esri.widgets.ElevationProfile")],Et);const Tt=Et;export{Tt as default};
