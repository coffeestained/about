"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[2670,6601],{66601:(e,a,t)=>{t.r(a),t.d(a,{fetchFeatureService:()=>f,fromUrl:()=>u});var r=t(82058),n=t(60991),l=t(71252),s=t(32101),i=t(21132),o=t(67902);async function u(e){const a=e.properties?.customParameters,r=await async function(e,a){let t=(0,i.p)(e);if((0,l.a)(t)&&(t=await async function(e,a){const t=await p(e,{customParameters:a});let r=null,n=null;const o=t.type;if("Feature Layer"===o||"Table"===o?(r="FeatureServer",n=t.id):"indexedVector"===o?r="VectorTileServer":t.hasOwnProperty("mapName")?r="MapServer":t.hasOwnProperty("bandCount")&&t.hasOwnProperty("pixelSizeX")?r="ImageServer":t.hasOwnProperty("maxRecordCount")&&t.hasOwnProperty("allowGeometryUpdates")?r="FeatureServer":t.hasOwnProperty("streamUrls")?r="StreamServer":c(t)?(r="SceneServer",n=t.id):t.hasOwnProperty("layers")&&c(t.layers?.[0])&&(r="SceneServer"),!r)return null;const u=null!=n?(0,i.f)(e):null;return{title:(0,l.i)(u)&&t.name||(0,s.vt)(e),serverType:r,sublayer:n,url:{path:(0,l.i)(u)?u.serviceUrl:(0,s.mN)(e).path}}}(e,a)),(0,l.a)(t))throw new n.Z("arcgis-layers:url-mismatch","The url '${url}' is not a valid arcgis resource",{url:e});const{serverType:r,sublayer:u}=t;let y;const d={FeatureServer:"FeatureLayer",StreamServer:"StreamLayer",VectorTileServer:"VectorTileLayer"};switch(r){case"MapServer":y=null!=u?"FeatureLayer":async function(e,a){return(await p(e,{customParameters:a})).tileInfo}(e,a).then((e=>e?"TileLayer":"MapImageLayer"));break;case"ImageServer":y=p(e,{customParameters:a}).then((e=>{const a=e.tileInfo&&e.tileInfo.format;return e.tileInfo?"LERC"!==a?.toUpperCase()||e.cacheType&&"elevation"!==e.cacheType.toLowerCase()?"ImageryTileLayer":"ElevationLayer":"ImageryLayer"}));break;case"SceneServer":y=p(t.url.path,{customParameters:a}).then((e=>{if(e){if("Voxel"===e?.layerType)return"VoxelLayer";if(e?.layers&&Array.isArray(e.layers)&&e.layers.length>0){const a={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"},t=e.layers[0]?.layerType;if(null!=a[t])return a[t]}}return"SceneLayer"}));break;default:y=d[r]}const m="FeatureServer"===r,w={parsedUrl:t,Constructor:null,layerOrTableId:m?u:null,sublayerIds:null,tableIds:null},h=await y;if({FeatureLayer:!0,SceneLayer:!0}[h]&&null==u){const t=await async function(e,a,t){let r,n=!1;if("FeatureServer"===a){const a=await f(e,{customParameters:t});n=!!a.layersJSON,r=a.layersJSON||a.serviceJSON}else r=await p(e,{customParameters:t});const l=r?.layers,s=r?.tables;return{layerIds:l?.map((e=>e.id)).reverse()||[],tableIds:s?.map((e=>e.id)).reverse()||[],layerInfos:n?l:[],tableInfos:n?s:[]}}(e,r,a);m&&(w.sublayerInfos=t.layerInfos,w.tableInfos=t.tableInfos),1!==t.layerIds.length+t.tableIds.length?(w.sublayerIds=t.layerIds,w.tableIds=t.tableIds):m&&(w.layerOrTableId=t.layerIds[0]??t.tableIds[0],w.sourceJSON=t.layerInfos[0]??t.tableInfos[0])}return w.Constructor=await async function(e){return(0,o.l[e])()}(h),w}(e.url,a),u={...e.properties,url:e.url};if(!r.sublayerIds)return null!=r.layerOrTableId&&(u.layerId=r.layerOrTableId,u.sourceJSON=r.sourceJSON),new r.Constructor(u);const d=new(0,(await Promise.all([t.e(67),t.e(3752)]).then(t.bind(t,60294))).default)({title:r.parsedUrl.title});return function(e,a,t){function r(e,r){const n={...t,layerId:e,sublayerTitleMode:"service-name"};return(0,l.i)(r)&&(n.sourceJSON=r),new a.Constructor(n)}a.sublayerIds.forEach((t=>{const n=r(t,y(a.sublayerInfos,t));e.add(n)})),a.tableIds.forEach((t=>{const n=r(t,y(a.tableInfos,t));e.tables.add(n)}))}(d,r,u),d}function y(e,a){return e?e.find((e=>e.id===a)):null}function c(e){return e?.hasOwnProperty("store")&&e.hasOwnProperty("id")&&"number"==typeof e.id}function d(e){return!e.type||"Feature Layer"===e.type}async function f(e,a){let t=await p(e,a);t=t||{},t.layers=t.layers?.filter(d)||[];const r={serviceJSON:t};if(t.currentVersion<10.5)return r;const n=await p(e+"/layers",a);return r.layersJSON={layers:n?.layers?.filter(d)||[],tables:n?.tables||[]},r}async function p(e,a){return(await(0,r.default)(e,{responseType:"json",query:{f:"json",...a?.customParameters,token:a?.apiKey}})).data}t(31450),t(76506),t(71552),t(88762),t(92143),t(40642),t(50406),t(38742)},62670:(e,a,t)=>{t.r(a),t.d(a,{save:()=>E,saveAll:()=>F,saveAs:()=>J});var r=t(76506),n=t(60991),l=t(92143),s=t(71252),i=t(50406),o=t(87217),u=t(9506),y=t(66601),c=t(21132),d=t(51899),f=t(49900),p=t(56420),m=t(69586),w=t(60111);t(71552),t(31450),t(40642),t(86748),t(15324),t(91055),t(75067),t(21972),t(60474),t(66396),t(17533),t(86656),t(6540),t(91306),t(34250),t(19657),t(6906),t(89914),t(12047),t(86787),t(97714),t(2906),t(14249),t(60217),t(74569),t(21801),t(73796),t(60947),t(91597),t(35132),t(89623),t(84069),t(44567),t(98380),t(92896),t(22781),t(57251),t(32422),t(29107),t(30574),t(2157),t(25977),t(58076),t(98242),t(7471),t(54414),t(59465),t(1648),t(8925),t(33957),t(3482),t(45154),t(16769),t(93603),t(15438),t(593),t(85699),t(55531),t(96055),t(47776),t(18033),t(6331),t(62048),t(4292),t(75626),t(72652),t(29641),t(30493),t(70821),t(82673),t(34229),t(37029),t(55306),t(96467),t(63571),t(30776),t(48027),t(54174),t(82426),t(29794),t(63130),t(25696),t(98402),t(42775),t(95834),t(34394),t(57150),t(76726),t(20444),t(76393),t(78548),t(2497),t(49906),t(46527),t(11799),t(48649),t(59877),t(9960),t(30823),t(53326),t(92482),t(5853),t(39141),t(32101),t(38742),t(48243),t(34635),t(10401),t(70737),t(36834),t(66122),t(8487),t(17817),t(90814),t(15459),t(61847),t(88762),t(82058),t(81184),t(33101),t(67477),t(78533),t(74653),t(91091),t(58943),t(16796),t(16955),t(22401),t(77894),t(55187),t(8586),t(44509),t(69814),t(11305),t(62259),t(44790),t(5909),t(60669),t(48208),t(51589),t(65684),t(12158),t(74864),t(63683),t(94479),t(45702),t(51127),t(26822),t(51723),t(23243),t(51669),t(6090),t(3977),t(36741),t(11253),t(90319),t(38822),t(52228),t(74057),t(23761),t(48190),t(85557),t(53785),t(95587),t(94070),t(43022),t(16218),t(9075),t(71206),t(9352),t(89241),t(91700),t(51979),t(63136),t(32037),t(60698),t(90811),t(60045),t(68681),t(53321),t(86758),t(95310),t(93939),t(238),t(68714),t(20208),t(82933),t(54179),t(10691),t(38949),t(71777),t(19755),t(62554),t(27371),t(78648),t(87558),t(13063),t(17153),t(35962),t(9252),t(67350),t(11471),t(83748),t(28376),t(9801),t(53523),t(42911),t(46826),t(45433),t(29027),t(41617),t(47628),t(95873),t(58085),t(65514),t(46987),t(37453),t(73173),t(66284),t(87239),t(55823),t(92847),t(87258),t(97546),t(54732),t(96994),t(75025),t(80462),t(92200),t(51653),t(22465),t(65775),t(5777),t(21471),t(9641),t(6210),t(36231),t(93314),t(35197),t(31292),t(69218),t(27207),t(89440),t(67541),t(1557),t(47842),t(17298),t(86861),t(39241),t(41864),t(74742),t(28239),t(68219),t(6416),t(82377),t(59765),t(77361),t(61261),t(83290),t(29395),t(94303),t(70846),t(21770),t(77807),t(50203),t(6941),t(14460),t(13322),t(46495),t(78303),t(47346),t(1709),t(17055),t(68653),t(2180),t(14327),t(40944),t(71831),t(34446),t(46646),t(39210),t(90549),t(78893),t(67902),t(1623),t(12381),t(92624);const h=l.L.getLogger("esri.layers.FeatureLayer");function b(e,a){return`Layer (title: ${e.title}, id: ${e.id}) of type '${e.declaredClass}' ${a}`}function S(e,a){if("Feature Service"!==a.type)throw new n.Z("feature-layer:portal-item-wrong-type",b(e,'should have portal item of type "Feature Service"'))}async function I(e){if(await e.load(),(0,d.i)(e))throw new n.Z("feature-layer:save",b(e,"using an in-memory source cannot be saved to a portal item"))}async function v(e,a,t){"beforeSave"in e&&"function"==typeof e.beforeSave&&await e.beforeSave();const r=e.write({},a);return function(e,a){let t=e.messages.filter((({type:e})=>"error"===e)).map((({name:e,message:a,details:t})=>new n.Z(e,a,t)));if(a?.ignoreUnsupported&&(t=t.filter((({name:e})=>"layer:unsupported"!==e&&"symbol:unsupported"!==e&&"symbol-layer:unsupported"!==e&&"property:unsupported"!==e&&"url:unsupported"!==e))),t.length>0)throw new n.Z("feature-layer:save","Failed to save feature layer due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:t})}(a,t),r}function L(e){const{layer:a,layerJSON:t}=e;return a.isTable?{layers:[],tables:[t]}:{layers:[t],tables:[]}}function P(e){(0,w.a)(e,w.T.JSAPI),e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter(((e,a,t)=>t.indexOf(e)===a)))}async function g(e,a){return/\/\d+\/?$/.test(e.url)?L(a[0]):async function(e,a){const{layer:{url:t,customParameters:r,apiKey:n}}=a[0];let l=await e.fetchData("json");l&&null!=l.layers&&null!=l.tables||(l=await async function(e,a,t){var r,n;e||(e={}),(r=e).layers||(r.layers=[]),(n=e).tables||(n.tables=[]);const{url:l,customParameters:o,apiKey:c}=a,{serviceJSON:d,layersJSON:f}=await(0,y.fetchFeatureService)(l,{customParameters:o,apiKey:c}),p=O(e.layers,d.layers,t),m=O(e.tables,d.tables,t);e.layers=p.itemResources,e.tables=m.itemResources;const w=[...p.added,...m.added],h=f?[...f.layers,...f.tables]:[];return await async function(e,a,t,r){const n=a.map((({id:e})=>new u.default({url:t,layerId:e,sourceJSON:r.find((({id:a})=>a===e))})));await(0,i.as)(n.map((e=>e.load()))),n.forEach((a=>{const{layerId:t,loaded:r,defaultPopupTemplate:n}=a;r&&!(0,s.a)(n)&&T(a,{id:t,popupInfo:n.toJSON()},e)}))}(e,w,l,h),e}(l,{url:t,customParameters:r,apiKey:n},a.map((e=>e.layer.layerId))));for(const e of a)T(e.layer,e.layerJSON,l);return l}(e,a)}function O(e,a,t){const n=(0,r.q)(e,a,((e,a)=>e.id===a.id));e=e.filter((e=>!n.removed.some((a=>a.id===e.id))));const l=n.added.map((({id:e})=>({id:e})));return l.forEach((({id:a})=>{e.push({id:a})})),{itemResources:e,added:l.filter((({id:e})=>!t.includes(e)))}}function T(e,a,t){e.isTable?N(t.tables,a):N(t.layers,a)}function N(e,a){const t=e.findIndex((({id:e})=>e===a.id));-1===t?e.push(a):e[t]=a}function A(e){const{portalItem:a}=e;return(0,d.h)(e)&&!e.dynamicDataSource&&!!a?.loaded&&"Feature Service"===a.type}const E=(0,i.Ds)((async function(e,a){await I(e),function(e){const a=e.portalItem;if(!a)throw h.error("save: requires the portalItem property to be set"),new n.Z("feature-layer:portal-item-not-set",b(e,"requires the portalItem property to be set"));if(!a.loaded)throw new n.Z("feature-layer:portal-item-not-loaded",b(e,"cannot be saved to a portal item that does not exist or is inaccessible"));S(e,a)}(e);const t=e.portalItem,r=(0,m.a)(t),l=await v(e,r,a),s=await g(t,[{layer:e,layerJSON:l}]);return P(t),await t.update({data:s}),(0,o.u)(r),t})),F=(0,i.Ds)((async(e,a)=>{await async function(e){if(!e?.length)throw new n.Z("feature-layer-utils-saveall:missing-parameters","'layers' array should contain at least one feature layer");await Promise.all(e.map((e=>e.load())));for(const a of e)if(!A(a))throw new n.Z("feature-layer-utils-saveall:invalid-parameters",`'layers' array should only contain layers or tables in a feature service loaded from 'Feature Service' item. ${b(a,"does not conform")}`,{layer:a});const a=e.map((e=>e.portalItem.id));if(new Set(a).size>1)throw new n.Z("feature-layer-utils-saveall:invalid-parameters","All layers in the 'layers' array should be loaded from the same portal item");const t=e.map((e=>e.layerId));if(new Set(t).size!==t.length)throw new n.Z("feature-layer-utils-saveall:invalid-parameters","'layers' array should contain only one instance each of layer or table in a feature service")}(e);const t=e[0].portalItem,r=(0,m.a)(t),l=await Promise.all(e.map((e=>v(e,r,a)))),s=await g(t,e.map(((e,a)=>({layer:e,layerJSON:l[a]}))));return P(t),await t.update({data:s}),await Promise.all(e.slice(1).map((e=>e.portalItem.reload()))),(0,o.u)(r),t.clone()})),J=(0,i.Ds)((async function(e,a,t){await I(e);const r=function(e,a){var t,r;let n=p.default.from(a);return n.id&&(n=n.clone(),n.id=null),(t=n).type??(t.type="Feature Service"),(r=n).portal??(r.portal=f.Z.getDefault()),S(e,n),n}(e,a),n=(0,m.a)(r),l=L({layer:e,layerJSON:await v(e,n,t)});return await async function(e,a){const{url:t,layerId:r,title:n,fullExtent:l,isTable:i}=e,o=(0,c.p)(t),u=(0,s.i)(o)&&"FeatureServer"===o.serverType;a.url=u?t:`${t}/${r}`,a.title||(a.title=n),a.extent=null,!i&&(0,s.i)(l)&&(a.extent=await(0,w.g)(l)),(0,w.r)(a,w.T.METADATA),(0,w.r)(a,w.T.MULTI_LAYER),(0,w.a)(a,w.T.SINGLE_LAYER),i&&(0,w.a)(a,w.T.TABLE),P(a)}(e,r),await async function(e,a,t){const r=e.portal;await r._signIn(),await r.user.addItem({item:e,data:a,folder:t?.folder})}(r,l,t),e.portalItem=r,(0,o.u)(n),r}))},69586:(e,a,t)=>{t.d(a,{a:()=>s,c:()=>l});var r=t(32101),n=t(49900);function l(e){return{origin:"portal-item",url:(0,r.mN)(e.itemUrl),portal:e.portal||n.Z.getDefault(),portalItem:e,readResourcePaths:[]}}function s(e){return{origin:"portal-item",messages:[],writtenProperties:[],url:e.itemUrl?(0,r.mN)(e.itemUrl):null,portal:e.portal||n.Z.getDefault(),portalItem:e}}},51899:(e,a,t)=>{function r(e){return"feature"===e?.type&&!e.url&&"memory"===e.source?.type}function n(e){return"feature"===e?.type&&"feature-layer"===e.source?.type}t.d(a,{h:()=>n,i:()=>r})},67902:(e,a,t)=>{t.d(a,{l:()=>r});const r={BingMapsLayer:async()=>(await Promise.all([t.e(67),t.e(7963)]).then(t.bind(t,37963))).default,BuildingSceneLayer:async()=>(await Promise.all([t.e(67),t.e(9635),t.e(6748),t.e(6583),t.e(208),t.e(6060),t.e(3064),t.e(1580),t.e(9506),t.e(5967),t.e(5040)]).then(t.bind(t,3439))).default,CSVLayer:async()=>(await Promise.all([t.e(67),t.e(9635),t.e(6748),t.e(6583),t.e(208),t.e(6060),t.e(3064),t.e(1580),t.e(9506),t.e(3525)]).then(t.bind(t,44004))).default,ElevationLayer:async()=>(await Promise.all([t.e(212),t.e(2204)]).then(t.bind(t,72204))).default,FeatureLayer:async()=>(await Promise.all([t.e(67),t.e(9635),t.e(6748),t.e(6583),t.e(208),t.e(6060),t.e(3064),t.e(1580),t.e(9506),t.e(9546)]).then(t.bind(t,9506))).default,GroupLayer:async()=>(await Promise.all([t.e(67),t.e(294)]).then(t.bind(t,60294))).default,GeoRSSLayer:async()=>(await Promise.all([t.e(67),t.e(9635),t.e(2197)]).then(t.bind(t,92197))).default,GeoJSONLayer:async()=>(await Promise.all([t.e(67),t.e(9635),t.e(6748),t.e(6583),t.e(208),t.e(6060),t.e(3064),t.e(9039)]).then(t.bind(t,99039))).default,ImageryLayer:async()=>(await Promise.all([t.e(67),t.e(9635),t.e(6748),t.e(6583),t.e(1580),t.e(4240),t.e(6061),t.e(6497)]).then(t.bind(t,76497))).default,ImageryTileLayer:async()=>(await Promise.all([t.e(67),t.e(1623),t.e(9635),t.e(6748),t.e(6583),t.e(212),t.e(4240),t.e(6061),t.e(4489),t.e(2552)]).then(t.bind(t,32552))).default,IntegratedMeshLayer:async()=>(await Promise.all([t.e(1623),t.e(5967),t.e(156)]).then(t.bind(t,60156))).default,KMLLayer:async()=>(await Promise.all([t.e(67),t.e(9635),t.e(6748),t.e(6583),t.e(208),t.e(1903)]).then(t.bind(t,21903))).default,LineOfSightLayer:async()=>(await Promise.all([t.e(1623),t.e(8191)]).then(t.bind(t,78191))).default,MapImageLayer:async()=>(await Promise.all([t.e(67),t.e(9635),t.e(6748),t.e(6583),t.e(208),t.e(6060),t.e(7050),t.e(605)]).then(t.bind(t,60605))).default,MapNotesLayer:async()=>(await Promise.all([t.e(67),t.e(1623),t.e(9635),t.e(6748),t.e(6583),t.e(208),t.e(6060),t.e(3064),t.e(1580),t.e(9506),t.e(7841)]).then(t.bind(t,41135))).default,OGCFeatureLayer:async()=>(await Promise.all([t.e(67),t.e(9635),t.e(6748),t.e(6583),t.e(208),t.e(6060),t.e(3064),t.e(3958)]).then(t.bind(t,63958))).default,OpenStreetMapLayer:async()=>(await Promise.all([t.e(67),t.e(3799),t.e(6043)]).then(t.bind(t,16043))).default,PointCloudLayer:async()=>(await Promise.all([t.e(6748),t.e(5967),t.e(5032)]).then(t.bind(t,25032))).default,RouteLayer:async()=>(await Promise.all([t.e(67),t.e(1623),t.e(9635),t.e(6748),t.e(6583),t.e(208),t.e(910)]).then(t.bind(t,50910))).default,SceneLayer:async()=>(await Promise.all([t.e(67),t.e(1623),t.e(9635),t.e(6748),t.e(6583),t.e(208),t.e(6060),t.e(3064),t.e(1580),t.e(9506),t.e(5967),t.e(3934)]).then(t.bind(t,84580))).default,StreamLayer:async()=>(await Promise.all([t.e(67),t.e(9635),t.e(6748),t.e(6583),t.e(208),t.e(6060),t.e(3064),t.e(8324)]).then(t.bind(t,58324))).default,TileLayer:async()=>(await Promise.all([t.e(67),t.e(9635),t.e(6748),t.e(6583),t.e(208),t.e(6060),t.e(212),t.e(7050),t.e(611)]).then(t.bind(t,90611))).default,UnknownLayer:async()=>(await t.e(3117).then(t.bind(t,63117))).default,UnsupportedLayer:async()=>(await t.e(8243).then(t.bind(t,88243))).default,VectorTileLayer:async()=>(await Promise.all([t.e(67),t.e(212),t.e(5414),t.e(6611),t.e(6491)]).then(t.bind(t,46491))).default,VoxelLayer:async()=>(await Promise.all([t.e(5967),t.e(49)]).then(t.bind(t,10049))).default,WebTileLayer:async()=>(await Promise.all([t.e(67),t.e(3799)]).then(t.bind(t,3799)).then((e=>e.a))).default,WFSLayer:async()=>(await Promise.all([t.e(67),t.e(1623),t.e(9635),t.e(6748),t.e(6583),t.e(208),t.e(6060),t.e(3064),t.e(4797)]).then(t.bind(t,44797))).default,WMSLayer:async()=>(await Promise.all([t.e(67),t.e(9635),t.e(6748),t.e(3561)]).then(t.bind(t,73561))).default,WMTSLayer:async()=>(await Promise.all([t.e(67),t.e(3799),t.e(2790)]).then(t.bind(t,82790))).default}},25368:(e,a,t)=>{function r(e){return e&&"getAtOrigin"in e&&"originOf"in e}t.d(a,{i:()=>r})},87217:(e,a,t)=>{t.d(a,{u:()=>n});var r=t(25368);function n(e){e&&e.writtenProperties&&e.writtenProperties.forEach((({target:e,propName:a,newOrigin:t})=>{(0,r.i)(e)&&t&&e.originOf(a)!==t&&e.updateOrigin(a,t)}))}},60111:(e,a,t)=>{t.d(a,{T:()=>y,a:()=>s,g:()=>u,h:()=>i,r:()=>o});var r=t(1623),n=t(60947),l=t(35132);function s(e,a){if(!i(e,a)){const t=e.typeKeywords;t?t.push(a):e.typeKeywords=[a]}}function i(e,a){return!!e.typeKeywords?.includes(a)}function o(e,a){const t=e.typeKeywords;if(t){const e=t.indexOf(a);e>-1&&t.splice(e,1)}}async function u(e){const a=e.clone().normalize();let t;if(a.length>1)for(const e of a)t?e.width>t.width&&(t=e):t=e;else t=a[0];return async function(e){const a=e.spatialReference;if(a.isWGS84)return e.clone();if(a.isWebMercator)return(0,l.Sx)(e);const t=n.Z.WGS84;return await(0,r.iQ)(a,t),(0,r.iV)(e,t)}(t)}const y={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table"}}}]);