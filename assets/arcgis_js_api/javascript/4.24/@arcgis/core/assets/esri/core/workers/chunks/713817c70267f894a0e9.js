"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[1893],{71962:(t,e,n)=>{n.r(e),n.d(e,{E:()=>h,R:()=>F,S:()=>v,V:()=>l,a:()=>m,b:()=>U,c:()=>V,d:()=>et,e:()=>tt,g:()=>d,u:()=>O});var r=n(8358),i=n(15215),o=n(40167),s=n(99520),c=n(67095),a=n(76506),u=n(82426);const h=(0,i.n)().vec3f(s.V.POSITION).u16(s.V.COMPONENTINDEX).u16(s.V.U16PADDING),l=(0,i.n)().vec2u8(s.V.SIDENESS),d=(0,c.g)(l),f=(0,i.n)().vec3f(s.V.POSITION0).vec3f(s.V.POSITION1).u16(s.V.COMPONENTINDEX).u8(s.V.VARIANTOFFSET,{glNormalized:!0}).u8(s.V.VARIANTSTROKE).u8(s.V.VARIANTEXTENSION,{glNormalized:!0}).u8(s.V.U8PADDING,{glPadding:!0}).u16(s.V.U16PADDING,{glPadding:!0}),_=f.clone().vec3f(s.V.NORMAL),g=f.clone().vec3f(s.V.NORMALA).vec3f(s.V.NORMALB),m=new Map([[s.V.POSITION0,0],[s.V.POSITION1,1],[s.V.COMPONENTINDEX,2],[s.V.VARIANTOFFSET,3],[s.V.VARIANTSTROKE,4],[s.V.VARIANTEXTENSION,5],[s.V.NORMAL,6],[s.V.NORMALA,6],[s.V.NORMALB,7],[s.V.SIDENESS,8]]);function p(t,e,n){const r=e/3,i=new Uint32Array(n+1),o=new Uint32Array(n+1),s=(t,e)=>{t<e?i[t+1]++:o[e+1]++};for(let e=0;e<r;e++){const n=t[3*e],r=t[3*e+1],i=t[3*e+2];s(n,r),s(r,i),s(i,n)}let c=0,a=0;for(let t=0;t<n;t++){const e=i[t+1],n=o[t+1];i[t+1]=c,o[t+1]=a,c+=e,a+=n}const u=new Uint32Array(6*r),h=i[n],l=(t,e,n)=>{if(t<e){const r=i[t+1]++;u[2*r]=e,u[2*r+1]=n}else{const r=o[e+1]++;u[2*h+2*r]=t,u[2*h+2*r+1]=n}};for(let e=0;e<r;e++){const n=t[3*e],r=t[3*e+1],i=t[3*e+2];l(n,r,e),l(r,i,e),l(i,n,e)}const d=(t,e)=>{const n=2*t,r=e-t;for(let t=1;t<r;t++){const e=u[n+2*t],r=u[n+2*t+1];let i=t-1;for(;i>=0&&u[n+2*i]>e;i--)u[n+2*i+2]=u[n+2*i],u[n+2*i+3]=u[n+2*i+1];u[n+2*i+2]=e,u[n+2*i+3]=r}};for(let t=0;t<n;t++)d(i[t],i[t+1]),d(h+o[t],h+o[t+1]);const f=new Int32Array(3*r),_=(e,n)=>e===t[3*n]?0:e===t[3*n+1]?1:e===t[3*n+2]?2:-1,g=(t,e)=>{const n=_(t,e);f[3*e+n]=-1},m=(t,e,n,r)=>{const i=_(t,e);f[3*e+i]=r;const o=_(n,r);f[3*r+o]=e};for(let t=0;t<n;t++){let e=i[t];const n=i[t+1];let r=o[t];const s=o[t+1];for(;e<n&&r<s;){const n=u[2*e],i=u[2*h+2*r];n===i?(m(t,u[2*e+1],i,u[2*h+2*r+1]),e++,r++):n<i?(g(t,u[2*e+1]),e++):(g(i,u[2*h+2*r+1]),r++)}for(;e<n;)g(t,u[2*e+1]),e++;for(;r<s;)g(u[2*h+2*r],u[2*h+2*r+1]),r++}return f}function T(t,e){return e.push(t.buffer),{buffer:t.buffer,layout:N(t.layout)}}function O(t){const e=function(t){const e=(0,i.n)();return e.stride=t.stride,e.fieldNames=t.fieldNames,t.fields.forEach((t=>{return e.fields.set(t[0],{...t[1],constructor:(n=t[1].constructor,b.get(n))});var n})),e}(t.layout);return e.createView(t.buffer)}function N(t){const e=new Array;return t.fields.forEach(((t,n)=>{const r={...t,constructor:A(t.constructor)};e.push([n,r])})),{stride:t.stride,fields:e,fieldNames:t.fieldNames}}const E=[o.k,o.c,o.B,o.a,o.g,o.i,o.l,o.d,o.e,o.f,o.h,o.j,o.m,o.r,o.u,o.b,o.n,o.x,o.v,o.s,o.t,o.w,o.y,o.z,o.o,o.p,o.A,o.C,o.D,o.q,o.E,o.F,o.G,o.H,o.I,o.J];function A(t){return`${t.ElementType}_${t.ElementCount}`}const b=new Map;E.forEach((t=>b.set(A(t),t)));class I{updateSettings(t){this.settings=t,this.edgeHashFunction=t.reducedPrecision?y:R}write(t,e,n){const r=this.edgeHashFunction(n);B.seed=r;const i=B.getIntRange(0,255),o=B.getIntRange(0,this.settings.variants-1),s=B.getFloat(),c=255*(.5*function(t,e){const n=t<0?-1:1;return Math.abs(t)**1.2*n}(-(1-Math.min(s/.7,1))+Math.max(0,s-.7)/(1-.7))+.5);t.position0.setVec(e,n.position0),t.position1.setVec(e,n.position1),t.componentIndex.set(e,n.componentIndex),t.variantOffset.set(e,i),t.variantStroke.set(e,o),t.variantExtension.set(e,c)}trim(t,e){return t.slice(0,e)}}const S=new Float32Array(6),w=new Uint32Array(S.buffer),M=new Uint32Array(1);function R(t){const e=S;e[0]=t.position0[0],e[1]=t.position0[1],e[2]=t.position0[2],e[3]=t.position1[0],e[4]=t.position1[1],e[5]=t.position1[2],M[0]=5381;for(let t=0;t<w.length;t++)M[0]=31*M[0]+w[t];return M[0]}function y(t){const e=S;e[0]=P(t.position0[0]),e[1]=P(t.position0[1]),e[2]=P(t.position0[2]),e[3]=P(t.position1[0]),e[4]=P(t.position1[1]),e[5]=P(t.position1[2]),M[0]=5381;for(let t=0;t<w.length;t++)M[0]=31*M[0]+w[t];return M[0]}function P(t){return Math.round(1e4*t)/1e4}class F{constructor(){this.commonWriter=new I}updateSettings(t){this.commonWriter.updateSettings(t)}allocate(t){return _.createBuffer(t)}write(t,e,n){this.commonWriter.write(t,e,n),(0,u.b)(L,n.faceNormal0,n.faceNormal1),(0,u.n)(L,L),t.normal.setVec(e,L)}trim(t,e){return this.commonWriter.trim(t,e)}}F.Layout=_,F.glLayout=(0,c.g)(_,1);class v{constructor(){this.commonWriter=new I}updateSettings(t){this.commonWriter.updateSettings(t)}allocate(t){return g.createBuffer(t)}write(t,e,n){this.commonWriter.write(t,e,n),t.normalA.setVec(e,n.faceNormal0),t.normalB.setVec(e,n.faceNormal1)}trim(t,e){return this.commonWriter.trim(t,e)}}v.Layout=g,v.glLayout=(0,c.g)(g,1);const L=(0,u.h)(),B=new a.R;var V,x;function D(t,e,n,r=q){const i=t.vertices.position,o=t.vertices.componentIndex,s=(0,u.g)(r.anglePlanar),c=(0,u.g)(r.angleSignificantEdge),h=Math.cos(c),l=Math.cos(s),d=z.edge,f=d.position0,_=d.position1,g=d.faceNormal0,m=d.faceNormal1,p=function(t){const e=t.faces.length/3,n=t.vertices.position,r=t.faces,i=k.v0,o=k.v1,s=k.v2,c=new Float32Array(3*e);for(let t=0;t<e;t++){const e=r[3*t+0],a=r[3*t+1],h=r[3*t+2];n.getVec(e,i),n.getVec(a,o),n.getVec(h,s),(0,u.d)(o,o,i),(0,u.d)(s,s,i),(0,u.k)(i,o,s),(0,u.n)(i,i),c[3*t+0]=i[0],c[3*t+1]=i[1],c[3*t+2]=i[2]}return c}(t),T=function(t){const e=t.faces.length/3,n=t.faces,r=t.neighbors;let i=0;for(let t=0;t<e;t++){const e=r[3*t+0],o=r[3*t+1],s=r[3*t+2],c=n[3*t+0],a=n[3*t+1],u=n[3*t+2];i+=-1===e||c<a?1:0,i+=-1===o||a<u?1:0,i+=-1===s||u<c?1:0}const o=new Int32Array(4*i);let s=0;for(let t=0;t<e;t++){const e=r[3*t+0],i=r[3*t+1],c=r[3*t+2],a=n[3*t+0],u=n[3*t+1],h=n[3*t+2];(-1===e||a<u)&&(o[s++]=a,o[s++]=u,o[s++]=t,o[s++]=e),(-1===i||u<h)&&(o[s++]=u,o[s++]=h,o[s++]=t,o[s++]=i),(-1===c||h<a)&&(o[s++]=h,o[s++]=a,o[s++]=t,o[s++]=c)}return o}(t),O=T.length/4,N=e.allocate(O);let E=0;const A=O,b=n.allocate(A);let I=0,S=0,w=0;const M=(0,a.A)(0,O),R=new Float32Array(O);(0,a.B)(R,((t,e,n)=>{i.getVec(T[4*e+0],f),i.getVec(T[4*e+1],_),n[e]=(0,u.v)(f,_)})),M.sort(((t,e)=>R[e]-R[t]));const y=new Array,P=new Array;for(let t=0;t<O;t++){const r=M[t],c=R[r],a=T[4*r+0],O=T[4*r+1],A=T[4*r+2],F=T[4*r+3],v=-1===F;if(i.getVec(a,f),i.getVec(O,_),v)(0,u.s)(g,p[3*A+0],p[3*A+1],p[3*A+2]),(0,u.a)(m,g),d.componentIndex=o.get(a),d.cosAngle=(0,u.j)(g,m);else{if((0,u.s)(g,p[3*A+0],p[3*A+1],p[3*A+2]),(0,u.s)(m,p[3*F+0],p[3*F+1],p[3*F+2]),d.componentIndex=o.get(a),d.cosAngle=(0,u.j)(g,m),C(d,l))continue;d.cosAngle<-.9999&&(0,u.a)(m,g)}S+=c,w++,v||j(d,h)?(e.write(N,E++,d),y.push(c)):G(d,s)&&(n.write(b,I++,d),P.push(c))}const F=new Float32Array(y.reverse()),v=new Float32Array(P.reverse());return{regular:{instancesData:e.trim(N,E),lodInfo:{lengths:F}},silhouette:{instancesData:n.trim(b,I),lodInfo:{lengths:v}},averageEdgeLength:S/w}}function j(t,e){return t.cosAngle<e}function C(t,e){return t.cosAngle>e}function G(t,e){const n=(0,u.u)(t.cosAngle),r=z.fwd,i=z.ortho;return(0,u.A)(r,t.position1,t.position0),n*((0,u.j)((0,u.k)(i,t.faceNormal0,t.faceNormal1),r)>0?-1:1)>e}(x=V||(V={}))[x.SOLID=0]="SOLID",x[x.SKETCH=1]="SKETCH";const z={edge:{position0:(0,u.h)(),position1:(0,u.h)(),faceNormal0:(0,u.h)(),faceNormal1:(0,u.h)(),componentIndex:0,cosAngle:0},ortho:(0,u.h)(),fwd:(0,u.h)()},k={v0:(0,u.h)(),v1:(0,u.h)(),v2:(0,u.h)()},q={anglePlanar:4,angleSignificantEdge:35};class H{async extract(t){const e=W(t),n=U(e),r=[e.data.buffer],i=function(t,e){return e.push(t.regular.lodInfo.lengths.buffer),e.push(t.silhouette.lodInfo.lengths.buffer),{regular:{instancesData:T(t.regular.instancesData,e),lodInfo:{lengths:t.regular.lodInfo.lengths.buffer}},silhouette:{instancesData:T(t.silhouette.instancesData,e),lodInfo:{lengths:t.silhouette.lodInfo.lengths.buffer}},averageEdgeLength:t.averageEdgeLength}}(n,r);return{result:i,transferList:r}}async extractComponentsEdgeLocations(t){const e=W(t),n=[];return{result:T(D(X(e.data,e.skipDeduplicate,e.indices,e.indicesLength),$,Q).regular.instancesData,n),transferList:n}}async extractEdgeLocations(t){const e=W(t),n=[];return{result:T(D(X(e.data,e.skipDeduplicate,e.indices,e.indicesLength),Z,Q).regular.instancesData,n),transferList:n}}}function U(t){const e=X(t.data,t.skipDeduplicate,t.indices,t.indicesLength);return K.updateSettings(t.writerSettings),Y.updateSettings(t.writerSettings),D(e,K,Y)}function W(t){return{data:h.createView(t.dataBuffer),indices:"Uint32Array"===t.indicesType?new Uint32Array(t.indicesBuffer):"Uint16Array"===t.indicesType?new Uint16Array(t.indicesBuffer):void 0,indicesLength:t.indicesLength,writerSettings:t.writerSettings,skipDeduplicate:t.skipDeduplicate}}function X(t,e,n,i){if(e)return{faces:n,facesLength:i,neighbors:p(n,i,t.count),vertices:t};const o=(0,r.d)(t.buffer,t.stride/4,{originalIndices:n,originalIndicesLength:i}),s=p(o.indices,i,o.uniqueCount);return{faces:o.indices,facesLength:o.indices.length,neighbors:s,vertices:h.createView(o.buffer)}}const K=new F,Y=new v,Z=new class{allocate(t){return J.createBuffer(t)}trim(t,e){return t.slice(0,e)}write(t,e,n){t.position0.setVec(e,n.position0),t.position1.setVec(e,n.position1)}},$=new class{allocate(t){return tt.createBuffer(t)}trim(t,e){return t.slice(0,e)}write(t,e,n){t.position0.setVec(e,n.position0),t.position1.setVec(e,n.position1),t.componentIndex.set(e,n.componentIndex)}},Q={allocate:()=>null,write:()=>{},trim:()=>null},J=(0,i.n)().vec3f(s.V.POSITION0).vec3f(s.V.POSITION1),tt=(0,i.n)().vec3f(s.V.POSITION0).vec3f(s.V.POSITION1).u16(s.V.COMPONENTINDEX).u16(s.V.U16PADDING,{glPadding:!0}),et=Object.freeze(Object.defineProperty({__proto__:null,EdgeProcessingWorker:H,extract:U,extractEdgeLocationsLayout:J,extractComponentsEdgeLocationsLayout:tt,default:function(){return new H}},Symbol.toStringTag,{value:"Module"}))},81893:(t,e,n)=>{n.r(e),n.d(e,{SceneLayerSnappingSourceWorker:()=>$,default:()=>Q});var r,i,o,s,c,a,u,h=n(29768),l=n(71252),d=n(50406),f=(n(92143),n(91306),n(76506),n(34250),n(17533)),_=n(82426),g=n(94446),m=n(60939),p=n(42318),T=n(91055),O=n(6906),N=n(67592),E=(n(65775),n(68681)),A=n(2420);function b(t,e){for(let n=0;n<a.NUM;n++){const r=t[n];if(r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]>=e[3])return!1}return!0}(0,_.h)(),(0,_.h)(),(0,_.h)(),(0,_.h)(),(0,_.h)(),(0,_.h)(),(0,_.h)(),(0,_.h)(),(0,_.h)(),(0,_.h)(),(i=r||(r={}))[i.NONE=0]="NONE",i[i.CLAMP=1]="CLAMP",i[i.INFINITE_MIN=4]="INFINITE_MIN",i[i.INFINITE_MAX=8]="INFINITE_MAX",r.INFINITE_MIN,r.INFINITE_MAX,r.INFINITE_MAX,new N.O((()=>({c0:0,c1:0,ray:null}))),(c=o||(o={}))[c.LEFT=0]="LEFT",c[c.RIGHT=1]="RIGHT",c[c.BOTTOM=2]="BOTTOM",c[c.TOP=3]="TOP",c[c.NEAR=4]="NEAR",c[c.FAR=5]="FAR",function(t){t[t.NEAR_BOTTOM_LEFT=0]="NEAR_BOTTOM_LEFT",t[t.NEAR_BOTTOM_RIGHT=1]="NEAR_BOTTOM_RIGHT",t[t.NEAR_TOP_RIGHT=2]="NEAR_TOP_RIGHT",t[t.NEAR_TOP_LEFT=3]="NEAR_TOP_LEFT",t[t.FAR_BOTTOM_LEFT=4]="FAR_BOTTOM_LEFT",t[t.FAR_BOTTOM_RIGHT=5]="FAR_BOTTOM_RIGHT",t[t.FAR_TOP_RIGHT=6]="FAR_TOP_RIGHT",t[t.FAR_TOP_LEFT=7]="FAR_TOP_LEFT"}(s||(s={})),s.FAR_BOTTOM_RIGHT,s.NEAR_BOTTOM_RIGHT,s.NEAR_BOTTOM_LEFT,s.FAR_BOTTOM_LEFT,s.NEAR_BOTTOM_LEFT,s.NEAR_BOTTOM_RIGHT,s.NEAR_TOP_RIGHT,s.NEAR_TOP_LEFT,s.FAR_BOTTOM_RIGHT,s.FAR_BOTTOM_LEFT,s.FAR_TOP_LEFT,s.FAR_TOP_RIGHT,s.NEAR_BOTTOM_RIGHT,s.FAR_BOTTOM_RIGHT,s.FAR_TOP_RIGHT,s.NEAR_TOP_RIGHT,s.FAR_BOTTOM_LEFT,s.NEAR_BOTTOM_LEFT,s.NEAR_TOP_LEFT,s.FAR_TOP_LEFT,s.FAR_TOP_LEFT,s.NEAR_TOP_LEFT,s.NEAR_TOP_RIGHT,s.FAR_TOP_RIGHT,function(t){t[t.NUM=6]="NUM"}(a||(a={})),function(t){t[t.NUM=8]="NUM"}(u||(u={})),(0,E.a)(-1,-1,-1,1),(0,E.a)(1,-1,-1,1),(0,E.a)(1,1,-1,1),(0,E.a)(-1,1,-1,1),(0,E.a)(-1,-1,1,1),(0,E.a)(1,-1,1,1),(0,E.a)(1,1,1,1),(0,E.a)(-1,1,1,1),new N.O((function(t){return t?{ray:(0,A.c)(t.ray),c0:t.c0,c1:t.c1}:{ray:(0,A.c)(),c0:0,c1:Number.MAX_VALUE}})),(0,_.h)(),(0,_.h)(),(0,_.h)(),(0,_.h)(),(0,_.h)(),(0,_.h)(),(0,_.h)(),(0,_.h)();var I=n(62348);class S{constructor(t,e){this._objectToBoundingSphere=t,this._maximumObjectsPerNode=10,this._maximumDepth=20,this._degenerateObjects=new Set,this._root=new w,this._objectCount=0,e&&(void 0!==e.maximumObjectsPerNode&&(this._maximumObjectsPerNode=e.maximumObjectsPerNode),void 0!==e.maximumDepth&&(this._maximumDepth=e.maximumDepth))}get bounds(){return this._root.bounds}get halfSize(){return this._root.halfSize}get root(){return this._root.node}get maximumObjectsPerNode(){return this._maximumObjectsPerNode}get maximumDepth(){return this._maximumDepth}get objectCount(){return this._objectCount}destroy(){this._degenerateObjects.clear(),w.clearPool(),x[0]=null,z.prune(),X.prune()}add(t,e=t.length){this._objectCount+=e,this._grow(t,e);const n=w.acquire();for(let r=0;r<e;r++){const e=t[r];this._isDegenerate(e)?this._degenerateObjects.add(e):(n.init(this._root),this._add(e,n))}w.release(n)}remove(t,e=null){this._objectCount-=t.length;const n=w.acquire();for(const r of t){const t=(0,l.i)(e)?e:(0,m.d)(this._objectToBoundingSphere(r),k);v(t[3])?(n.init(this._root),this._remove(r,t,n)):this._degenerateObjects.delete(r)}w.release(n),this._shrink()}update(t,e){if(!v(e[3])&&this._isDegenerate(t))return;const n=function(t){return x[0]=t,x}(t);this.remove(n,e),this.add(n)}forEachAlongRay(t,e,n){const r=(0,A.w)(t,e);this._forEachNode(this._root,(t=>{if(!this._intersectsNode(r,t))return!1;const e=t.node;return e.terminals.forAll((t=>{this._intersectsObject(r,t)&&n(t)})),null!==e.residents&&e.residents.forAll((t=>{this._intersectsObject(r,t)&&n(t)})),!0}))}forEachAlongRayWithVerticalOffset(t,e,n,r){const i=(0,A.w)(t,e);this._forEachNode(this._root,(t=>{if(!this._intersectsNodeWithOffset(i,t,r))return!1;const e=t.node;return e.terminals.forAll((t=>{this._intersectsObjectWithOffset(i,t,r)&&n(t)})),null!==e.residents&&e.residents.forAll((t=>{this._intersectsObjectWithOffset(i,t,r)&&n(t)})),!0}))}forEach(t){this._forEachNode(this._root,(e=>{const n=e.node;return n.terminals.forAll(t),null!==n.residents&&n.residents.forAll(t),!0})),this._degenerateObjects.forEach(t)}forEachDegenerateObject(t){this._degenerateObjects.forEach(t)}findClosest(t,e,n,r=(()=>!0),i=1/0){let o=1/0,s=1/0,c=null;const a=P(t,e),u=a=>{if(--i,!r(a))return;const u=this._objectToBoundingSphere(a);if(!b(n,u))return;const h=F(t,e,(0,m.e)(u)),l=h-u[3],d=h+u[3];l<o&&(o=l,s=d,c=a)};return this._forEachNodeDepthOrdered(this._root,(r=>{if(i<=0||!b(n,r.bounds))return!1;if((0,_.o)(j,a,r.halfSize),(0,_.b)(j,j,r.bounds),F(t,e,j)>s)return!1;const o=r.node;return o.terminals.forAll((t=>u(t))),null!==o.residents&&o.residents.forAll((t=>u(t))),!0}),t,e),c}forEachInDepthRange(t,e,n,r,i,o,s){let c=-1/0,a=1/0;const u={setRange:t=>{n===S.DepthOrder.FRONT_TO_BACK?(c=Math.max(c,t.near),a=Math.min(a,t.far)):(c=Math.max(c,-t.far),a=Math.min(a,-t.near))}};u.setRange(r);const h=F(e,n,t),l=P(e,n),d=P(e,-n),f=t=>{if(!s(t))return;const r=this._objectToBoundingSphere(t),l=(0,m.e)(r),d=F(e,n,l)-h,f=d-r[3],_=d+r[3];f>a||_<c||!b(o,r)||i(t,u)};this._forEachNodeDepthOrdered(this._root,(t=>{if(!b(o,t.bounds))return!1;if((0,_.o)(j,l,t.halfSize),(0,_.b)(j,j,t.bounds),F(e,n,j)-h>a)return!1;if((0,_.o)(j,d,t.halfSize),(0,_.b)(j,j,t.bounds),F(e,n,j)-h<c)return!1;const r=t.node;return r.terminals.forAll((t=>f(t))),null!==r.residents&&r.residents.forAll((t=>f(t))),!0}),e,n)}forEachNode(t){this._forEachNode(this._root,(e=>t(e.node,e.bounds,e.halfSize)))}forEachNeighbor(t,e){const n=(0,m.g)(e),r=(0,m.e)(e),i=e=>{const i=this._objectToBoundingSphere(e),o=(0,m.g)(i),s=n+o;(0,_.y)((0,m.e)(i),r)-s*s<=0&&t(e)};this._forEachNode(this._root,(t=>{const e=(0,m.g)(t.bounds),o=n+e;if((0,_.y)((0,m.e)(t.bounds),r)-o*o>0)return!1;const s=t.node;return s.terminals.forAll((t=>i(t))),null!==s.residents&&s.residents.forAll((t=>i(t))),!0})),this.forEachDegenerateObject(i)}_intersectsNode(t,e){return R(e.bounds,2*-e.halfSize,C),R(e.bounds,2*e.halfSize,G),(0,I.e)(t.origin,t.direction,C,G)}_intersectsNodeWithOffset(t,e,n){return R(e.bounds,2*-e.halfSize,C),R(e.bounds,2*e.halfSize,G),n.applyToMinMax(C,G),(0,I.e)(t.origin,t.direction,C,G)}_intersectsObject(t,e){const n=this._objectToBoundingSphere(e);return!(n[3]>0)||(0,m.i)(n,t)}_intersectsObjectWithOffset(t,e,n){const r=this._objectToBoundingSphere(e);return!(r[3]>0)||(0,m.i)(n.applyToBoundingSphere(r),t)}_forEachNode(t,e){let n=w.acquire().init(t);const r=[n];for(;0!==r.length;){if(n=r.pop(),e(n)&&!n.isLeaf())for(let t=0;t<n.node.children.length;t++)n.node.children[t]&&r.push(w.acquire().init(n).advance(t));w.release(n)}}_forEachNodeDepthOrdered(t,e,n,r=S.DepthOrder.FRONT_TO_BACK){let i=w.acquire().init(t);const o=[i];for(function(t,e,n){if(!X.length)for(let t=0;t<8;++t)X.push({index:0,distance:0});for(let n=0;n<8;++n){const r=L[n];X.data[n].index=n,X.data[n].distance=F(t,e,r)}X.sort(((t,e)=>t.distance-e.distance));for(let t=0;t<8;++t)n[t]=X.data[t].index}(n,r,K);0!==o.length;){if(i=o.pop(),e(i)&&!i.isLeaf())for(let t=7;t>=0;--t){const e=K[t];i.node.children[e]&&o.push(w.acquire().init(i).advance(e))}w.release(i)}}_remove(t,e,n){z.clear();const r=n.advanceTo(e,((t,e)=>{z.push(t.node),z.push(e)}))?n.node.terminals:n.node.residents;if(r.removeUnordered(t),0===r.length)for(let t=z.length-2;t>=0;t-=2){const e=z.data[t],n=z.data[t+1];if(!this._purge(e,n))break}}_nodeIsEmpty(t){if(0!==t.terminals.length)return!1;if(null!==t.residents)return 0===t.residents.length;for(let e=0;e<t.children.length;e++)if(t.children[e])return!1;return!0}_purge(t,e){return e>=0&&(t.children[e]=null),!!this._nodeIsEmpty(t)&&(null===t.residents&&(t.residents=new O.P({shrink:!0})),!0)}_add(t,e){e.advanceTo(this._objectToBoundingSphere(t))?e.node.terminals.push(t):(e.node.residents.push(t),e.node.residents.length>this._maximumObjectsPerNode&&e.depth<this._maximumDepth&&this._split(e))}_split(t){const e=t.node.residents;t.node.residents=null;for(let n=0;n<e.length;n++){const r=w.acquire().init(t);this._add(e.getItemAt(n),r),w.release(r)}}_grow(t,e){if(0!==e&&(y(t,e,(t=>this._objectToBoundingSphere(t)),q),v(q[3])&&!this._fitsInsideTree(q)))if(this._nodeIsEmpty(this._root.node))(0,m.d)(q,this._root.bounds),this._root.halfSize=1.25*q[3];else{const t=this._rootBoundsForRootAsSubNode(q);this._placingRootViolatesMaxDepth(t)?this._rebuildTree(q,t):this._growRootAsSubNode(t),w.release(t)}}_rebuildTree(t,e){(0,_.a)(H,e.bounds),H[3]=e.halfSize,y([t,H],2,(t=>t),U);const n=w.acquire().init(this._root);this._root.initFrom(null,U,1.25*U[3]),this._forEachNode(n,(t=>(this.add(t.node.terminals.data,t.node.terminals.length),null!==t.node.residents&&this.add(t.node.residents.data,t.node.residents.length),!0))),w.release(n)}_placingRootViolatesMaxDepth(t){const e=Math.log(t.halfSize/this._root.halfSize)*Math.LOG2E;let n=0;return this._forEachNode(this._root,(t=>(n=Math.max(n,t.depth),n+e<=this._maximumDepth))),n+e>this._maximumDepth}_rootBoundsForRootAsSubNode(t){const e=t[3],n=t;let r=-1/0;const i=this._root.bounds,o=this._root.halfSize;for(let t=0;t<3;t++){const s=i[t]-o-(n[t]-e),c=n[t]+e-(i[t]+o),a=Math.max(0,Math.ceil(s/(2*o))),u=Math.max(0,Math.ceil(c/(2*o)))+1,h=2**Math.ceil(Math.log(a+u)*Math.LOG2E);r=Math.max(r,h),W[t].min=a,W[t].max=u}for(let t=0;t<3;t++){let e=W[t].min,n=W[t].max;const s=(r-(e+n))/2;e+=Math.ceil(s),n+=Math.floor(s);const c=i[t]-o-e*o*2;D[t]=c+(n+e)*o}return D[3]=r*o*V,w.acquire().initFrom(null,D,r*o,0)}_growRootAsSubNode(t){const e=this._root.node;(0,_.a)(q,this._root.bounds),q[3]=this._root.halfSize,this._root.init(t),t.advanceTo(q,null,!0),t.node.children=e.children,t.node.residents=e.residents,t.node.terminals=e.terminals}_shrink(){for(;;){const t=this._findShrinkIndex();if(-1===t)break;this._root.advance(t),this._root.depth=0}}_findShrinkIndex(){if(0!==this._root.node.terminals.length||this._root.isLeaf())return-1;let t=null;const e=this._root.node.children;let n=0,r=0;for(;r<e.length&&null==t;)n=r++,t=e[n];for(;r<e.length;)if(e[r++])return-1;return n}_isDegenerate(t){return!v(this._objectToBoundingSphere(t)[3])}_fitsInsideTree(t){const e=this._root.bounds,n=this._root.halfSize;return t[3]<=n&&t[0]>=e[0]-n&&t[0]<=e[0]+n&&t[1]>=e[1]-n&&t[1]<=e[1]+n&&t[2]>=e[2]-n&&t[2]<=e[2]+n}}class w{constructor(){this.bounds=(0,m.c)(),this.halfSize=0,this.initFrom(null,null,0,0)}init(t){return this.initFrom(t.node,t.bounds,t.halfSize,t.depth)}initFrom(t,e,n,r=this.depth){return this.node=(0,l.i)(t)?t:w.createEmptyNode(),(0,l.i)(e)&&(0,m.d)(e,this.bounds),this.halfSize=n,this.depth=r,this}advance(t){let e=this.node.children[t];e||(e=w.createEmptyNode(),this.node.children[t]=e),this.node=e,this.halfSize/=2,this.depth++;const n=L[t];return this.bounds[0]+=n[0]*this.halfSize,this.bounds[1]+=n[1]*this.halfSize,this.bounds[2]+=n[2]*this.halfSize,this.bounds[3]=this.halfSize*V,this}advanceTo(t,e,n=!1){for(;;){if(this.isTerminalFor(t))return e&&e(this,-1),!0;if(this.isLeaf()){if(!n)return e&&e(this,-1),!1;this.node.residents=null}const r=this._childIndex(t);e&&e(this,r),this.advance(r)}}isLeaf(){return null!=this.node.residents}isTerminalFor(t){return t[3]>this.halfSize/2}_childIndex(t){const e=this.bounds;return(e[0]<t[0]?1:0)+(e[1]<t[1]?2:0)+(e[2]<t[2]?4:0)}static createEmptyNode(){return{children:[null,null,null,null,null,null,null,null],terminals:new O.P({shrink:!0}),residents:new O.P({shrink:!0})}}static acquire(){return w._pool.acquire()}static release(t){w._pool.release(t)}static clearPool(){w._pool.prune()}}function M(t,e){t[0]=Math.max(t[0],e[0]+e[3]),t[1]=Math.max(t[1],e[1]+e[3]),t[2]=Math.max(t[2],e[2]+e[3])}function R(t,e,n){n[0]=t[0]+e,n[1]=t[1]+e,n[2]=t[2]+e}function y(t,e,n,r){if(1===e){const e=n(t[0]);(0,m.d)(e,r)}else{C[0]=1/0,C[1]=1/0,C[2]=1/0,G[0]=-1/0,G[1]=-1/0,G[2]=-1/0;for(let r=0;r<e;r++){const e=n(t[r]);v(e[3])&&(o=e,(i=C)[0]=Math.min(i[0],o[0]-o[3]),i[1]=Math.min(i[1],o[1]-o[3]),i[2]=Math.min(i[2],o[2]-o[3]),M(G,e))}(0,_.G)(r,C,G,.5),r[3]=Math.max(G[0]-C[0],G[1]-C[1],G[2]-C[2])/2}var i,o}function P(t,e){let n=1/0,r=null;for(let i=0;i<8;++i){const o=F(t,e,B[i]);o<n&&(n=o,r=B[i])}return r}function F(t,e,n){return e*(t[0]*n[0]+t[1]*n[1]+t[2]*n[2])}function v(t){return!isNaN(t)&&t!==-1/0&&t!==1/0&&t>0}w._pool=new T.O(w),function(t){var e;(e=t.DepthOrder||(t.DepthOrder={}))[e.FRONT_TO_BACK=1]="FRONT_TO_BACK",e[e.BACK_TO_FRONT=-1]="BACK_TO_FRONT"}(S||(S={}));const L=[(0,_.f)(-1,-1,-1),(0,_.f)(1,-1,-1),(0,_.f)(-1,1,-1),(0,_.f)(1,1,-1),(0,_.f)(-1,-1,1),(0,_.f)(1,-1,1),(0,_.f)(-1,1,1),(0,_.f)(1,1,1)],B=[(0,_.f)(-1,-1,-1),(0,_.f)(-1,-1,1),(0,_.f)(-1,1,-1),(0,_.f)(-1,1,1),(0,_.f)(1,-1,-1),(0,_.f)(1,-1,1),(0,_.f)(1,1,-1),(0,_.f)(1,1,1)],V=Math.sqrt(3),x=[null],D=(0,m.c)(),j=(0,_.h)(),C=(0,_.h)(),G=(0,_.h)(),z=new O.P,k=(0,m.c)(),q=(0,m.c)(),H=(0,m.c)(),U=(0,m.c)(),W=[{min:0,max:0},{min:0,max:0},{min:0,max:0}],X=new O.P,K=[0,0,0,0,0,0,0,0],Y=S;var Z=n(71962);n(60991),n(71552),n(31450),n(40642),n(60474),n(66396),n(86656),n(6540),n(29794),n(79764),n(32191),n(44567),n(2906),n(21801),n(73796),n(12047),n(21972),n(19657),n(97714),n(60947),n(91597),n(86787),n(35132),n(89623),n(98380),n(71435),n(32422),n(84069),n(92896),n(30831),n(91700),n(72274),n(5777),n(81716),n(66774),n(57251),n(63683),n(94479),n(48027),n(54174),n(59465),n(45702),n(51127),n(30776),n(24251),n(1623),n(53785),n(95587),n(89914),n(12381),n(73173),n(82058),n(88762),n(32101),n(92482),n(92624),n(92847),n(77314),n(70514),n(95533),n(94751),n(74569),n(22781),n(40267),n(14249),n(60217),n(8358),n(15215),n(40167),n(27726),n(99520),n(67095),n(30752);let $=class{constructor(){this._idToComponent=new Map,this._components=new Y((t=>t.bounds)),this._edges=new Y((t=>t.bounds)),this._tmpLineSegment=(0,g.c)(),this._tmpP1=(0,_.h)(),this._tmpP2=(0,_.h)(),this._tmpP3=(0,_.h)(),this.remoteClient=null}async fetchCandidates(t,e){await Promise.resolve(),(0,d.k_)(e),await this._ensureEdgeLocations(t,e);const n=[];return this._edges.forEachNeighbor((e=>this._addCandidates(t,e,n)),t.bounds),{result:{candidates:n}}}async _ensureEdgeLocations(t,e){const n=[];if(this._components.forEachNeighbor((t=>{if((0,l.a)(t.info)){const{id:e,uid:r}=t;n.push({id:e,uid:r})}}),t.bounds),!n.length)return;const r={components:n},i=await this.remoteClient.invoke("fetchAllEdgeLocations",r,(0,l.e)(e,{}));for(const t of i.components)this._setFetchEdgeLocations(t)}async add(t){const e=new J(t.id,t.bounds);return this._idToComponent.set(e.id,e),this._components.add([e]),{result:{}}}async remove(t){const e=this._idToComponent.get(t.id);if(e){const t=[];this._edges.forEachNeighbor((n=>{n.component===e&&t.push(n)}),e.bounds),this._edges.remove(t),this._components.remove([e]),this._idToComponent.delete(e.id)}return{result:{}}}_setFetchEdgeLocations(t){const e=this._idToComponent.get(t.id);if((0,l.a)(e)||t.uid!==e.uid)return;const n=Z.e.createView(t.locations),r=new Array(n.count),i=(0,_.h)(),o=(0,_.h)();for(let s=0;s<n.count;s++){const c=(0,m.c)(),a=(0,m.e)(c);n.position0.getVec(s,i),n.position1.getVec(s,o),(0,_.a8)(a,a,i,.5),(0,_.a8)(a,a,o,.5),(0,_.b)(a,a,t.origin),c[3]=(0,_.v)(a,i);const u=new tt(e,s,c);r[s]=u}this._edges.add(r);const{objectIds:s,origin:c}=t;e.info={locations:n,objectIds:s,origin:c}}_addCandidates(t,e,n){const{locations:r,origin:i,objectIds:o}=e.component.info,s=r.position0.getVec(e.index,this._tmpP1),c=r.position1.getVec(e.index,this._tmpP2);(0,_.b)(s,s,i),(0,_.b)(c,c,i);const a=o[r.componentIndex.get(e.index)];this._addEdgeCandidate(t,a,s,c,n),this._addVertexCandidate(t,a,s,n),this._addVertexCandidate(t,a,c,n)}_addEdgeCandidate(t,e,n,r,i){if(!(t.types&p.S.EDGE))return;const o=(0,m.e)(t.bounds),s=(0,g.f)(n,r,this._tmpLineSegment),c=(0,g.i)(s,o,this._tmpP3);if(!(0,m.q)(t.bounds,c))return null;i.push({type:"edge",objectId:e,target:(0,_.q)(c),distance:(0,_.v)(o,c),start:(0,_.q)(n),end:(0,_.q)(r)})}_addVertexCandidate(t,e,n,r){if(!(t.types&p.S.VERTEX))return;const i=(0,m.e)(t.bounds);if(!(0,m.q)(t.bounds,n))return null;r.push({type:"vertex",objectId:e,target:(0,_.q)(n),distance:(0,_.v)(i,n)})}};function Q(){return new $}$=(0,h._)([(0,f.j)("esri.views.interactive.snapping.featureSources.sceneLayerSource.SceneLayerSnappingSourceWorker")],$);class J{constructor(t,e){this.id=t,this.bounds=e,this.info=null,this.uid=++J.uid}}J.uid=0;class tt{constructor(t,e,n){this.component=t,this.index=e,this.bounds=n}}},62348:(t,e,n)=>{n.d(e,{a:()=>i,e:()=>o}),n(32191),n(82426),(0,n(68681).c)();class r{constructor(t){this.message=t}toString(){return`AssertException: ${this.message}`}}function i(t,e){if(!t)throw e=e||"assert",console.log(new Error(e).stack),new r(e)}function o(t,e,n,r){let i,o=(n[0]-t[0])/e[0],s=(r[0]-t[0])/e[0];o>s&&(i=o,o=s,s=i);let c=(n[1]-t[1])/e[1],a=(r[1]-t[1])/e[1];if(c>a&&(i=c,c=a,a=i),o>a||c>s)return!1;c>o&&(o=c),a<s&&(s=a);let u=(n[2]-t[2])/e[2],h=(r[2]-t[2])/e[2];return u>h&&(i=u,u=h,h=i),!(o>h||u>s||(h<s&&(s=h),s<0))}},79764:(t,e,n)=>{function r(t){return 32+t.length}function i(t){if(!t)return 0;let e=32;for(const n in t)if(t.hasOwnProperty(n)){const i=t[n];switch(typeof i){case"string":e+=r(i);break;case"number":e+=16;break;case"boolean":e+=4}}return e}function o(t,e){return 32+t.length*e}var s;n.d(e,{B:()=>s,a:()=>o,e:()=>i}),function(t){t[t.KILOBYTES=1024]="KILOBYTES",t[t.MEGABYTES=1048576]="MEGABYTES",t[t.GIGABYTES=1073741824]="GIGABYTES"}(s||(s={}))},8358:(t,e,n)=>{n.d(e,{d:()=>i});var r=n(82426);function i(t,e,n){const i=t.byteLength/(4*e),u=new Uint32Array(t,0,i*e);let h=new Uint32Array(i);const l=n?.minReduction??0,d=n?.originalIndices||null,f=d?d.length:0,_=n?.componentOffsets||null;let g=0;if(_)for(let t=0;t<_.length-1;t++){const e=_[t+1]-_[t];e>g&&(g=e)}else g=i;const m=Math.floor(1.1*g)+1;(null==a||a.length<2*m)&&(a=new Uint32Array((0,r.I)(2*m)));for(let t=0;t<2*m;t++)a[t]=0;let p=0;const T=!!_&&!!d,O=T?f:i,N=T?new Uint32Array(f):null,E=1.96;let A=0!==l?Math.ceil(4*E*E/(l*l)*l*(1-l)):O,b=1,I=_?_[1]:O;for(let t=0;t<O;t++){if(t===A){const e=1-p/t;if(e+E*Math.sqrt(e*(1-e)/t)<l)return null;A*=2}if(t===I){for(let t=0;t<2*m;t++)a[t]=0;if(d)for(let t=_[b-1];t<_[b];t++)N[t]=h[d[t]];I=_[++b]}const n=T?d[t]:t,r=n*e,i=c(u,r,e);let s=i%m,f=p;for(;0!==a[2*s+1];){if(a[2*s]===i){const t=a[2*s+1]-1;if(o(u,r,t*e,e)){f=h[t];break}}s++,s>=m&&(s-=m)}f===p&&(a[2*s]=i,a[2*s+1]=n+1,p++),h[n]=f}if(0!==l&&1-p/i<l)return null;if(T){for(let t=_[b-1];t<N.length;t++)N[t]=h[d[t]];h=N}const S=new Uint32Array(e*p);p=0;for(let t=0;t<O;t++)h[t]===p&&(s(u,(T?d[t]:t)*e,S,p*e,e),p++);if(d&&!T){const t=new Uint32Array(f);for(let e=0;e<t.length;e++)t[e]=h[d[e]];h=t}return{buffer:S.buffer,indices:h,uniqueCount:p}}function o(t,e,n,r){for(let i=0;i<r;i++)if(t[e+i]!==t[n+i])return!1;return!0}function s(t,e,n,r,i){for(let o=0;o<i;o++)n[r+o]=t[e+o]}function c(t,e,n){let r=0;for(let i=0;i<n;i++)r=t[e+i]+r|0,r=r+(r<<11)+(r>>>2)|0;return r>>>0}let a=null},67095:(t,e,n)=>{n.d(e,{g:()=>o});var r=n(30752),i=n(59696);function o(t,e=0){const n=t.stride;return t.fieldNames.filter((e=>{const n=t.fields.get(e).optional;return!(n&&n.glPadding)})).map((r=>{const o=t.fields.get(r),c=o.constructor.ElementCount,a=function(t){const e=s[t];if(e)return e;throw new Error("BufferType not supported in WebGL")}(o.constructor.ElementType),u=o.offset,h=!(!o.optional||!o.optional.glNormalized);return new i.V(r,c,a,u,n,h,e)}))}const s={u8:r.D.UNSIGNED_BYTE,u16:r.D.UNSIGNED_SHORT,u32:r.D.UNSIGNED_INT,i8:r.D.BYTE,i16:r.D.SHORT,i32:r.D.INT,f32:r.D.FLOAT}},94446:(t,e,n)=>{n.d(e,{c:()=>o,f:()=>s,i:()=>c});var r=n(82426),i=n(67592);function o(t){return t?{origin:(0,r.q)(t.origin),vector:(0,r.q)(t.vector)}:{origin:(0,r.h)(),vector:(0,r.h)()}}function s(t,e,n=o()){return(0,r.a)(n.origin,t),(0,r.d)(n.vector,e,t),n}function c(t,e,n){return function(t,e,n,o,s){const{vector:c,origin:a}=t,u=(0,r.d)(i.s.get(),e,a),h=(0,r.j)(c,u)/(0,r.p)(c);return(0,r.o)(s,c,(0,r.c)(h,0,1)),(0,r.b)(s,s,t.origin)}(t,e,0,0,n)}(0,r.h)(),(0,r.h)(),new i.O((()=>({origin:null,vector:null})))},57532:(t,e,n)=>{function r(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function i(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]}function o(t,e){return new Float64Array(t,e,16)}n.d(e,{I:()=>s,a:()=>o,b:()=>i,c:()=>r});const s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},45087:(t,e,n)=>{function r(){return[1,0,0,0,1,0,0,0,1]}function i(t,e){return new Float64Array(t,e,9)}function o(){return[0,0,0,1]}function s(t){return[t[0],t[1],t[2],t[3]]}function c(t,e){return new Float64Array(t,e,4)}n.d(e,{I:()=>a,a:()=>c,b:()=>r,c:()=>i,d:()=>o,e:()=>s});const a=[0,0,0,1]},2420:(t,e,n)=>{n.d(e,{a:()=>c,c:()=>o,w:()=>s}),n(76506);var r=n(67592),i=n(82426);function o(t){return t?{origin:(0,i.q)(t.origin),direction:(0,i.q)(t.direction)}:{origin:(0,i.h)(),direction:(0,i.h)()}}function s(t,e){const n=a.get();return n.origin=t,n.direction=e,n}function c(t,e,n){const r=(0,i.j)(t.direction,(0,i.d)(n,e,t.origin));return(0,i.b)(n,t.origin,(0,i.o)(n,t.direction,r)),n}const a=new r.O((function(){return{origin:null,direction:null}}))},60939:(t,e,n)=>{n.d(e,{c:()=>f,d:()=>_,e:()=>m,g:()=>g,i:()=>O,q:()=>w}),n(76506);var r,i,o=n(92143),s=n(82426),c=n(71252),a=n(65775),u=n(68681),h=n(2420),l=n(67592);(i=r||(r={}))[i.X=0]="X",i[i.Y=1]="Y",i[i.Z=2]="Z",(0,s.h)(),(0,s.h)();const d=o.L.getLogger("esri.geometry.support.sphere");function f(){return(0,u.c)()}function _(t,e=f()){return(0,s.m)(e,t)}function g(t){return t[3]}function m(t){return t}function p(t,e,n){if((0,c.a)(e))return!1;const{origin:r,direction:i}=e,o=T;o[0]=r[0]-t[0],o[1]=r[1]-t[1],o[2]=r[2]-t[2];const s=i[0]*i[0]+i[1]*i[1]+i[2]*i[2],a=2*(i[0]*o[0]+i[1]*o[1]+i[2]*o[2]),u=a*a-4*s*(o[0]*o[0]+o[1]*o[1]+o[2]*o[2]-t[3]*t[3]);if(u<0)return!1;const h=Math.sqrt(u);let l=(-a-h)/(2*s);const d=(-a+h)/(2*s);return(l<0||d<l&&d>0)&&(l=d),!(l<0||(n&&(n[0]=r[0]+i[0]*l,n[1]=r[1]+i[1]*l,n[2]=r[2]+i[2]*l),0))}const T=(0,s.h)();function O(t,e){return p(t,e,null)}function N(t,e,n){const r=l.s.get(),i=l.a.get();(0,s.k)(r,e.origin,e.direction);const o=g(t);(0,s.k)(n,r,e.origin),(0,s.o)(n,n,1/(0,s.e)(n)*o);const c=A(t,e.origin),u=function(t,e){const n=(0,s.j)(t,e)/((0,s.e)(t)*(0,s.e)(e));return-(0,s.u)(n)}(e.origin,n);return(0,a.h)(i,u+c,r),(0,s.w)(n,n,i),n}function E(t,e,n){const r=(0,s.d)(l.s.get(),e,t),i=(0,s.o)(l.s.get(),r,t[3]/(0,s.e)(r));return(0,s.b)(n,i,t)}function A(t,e){const n=(0,s.d)(l.s.get(),e,t),r=(0,s.e)(n),i=g(t),o=i+Math.abs(i-r);return(0,s.u)(i/o)}const b=(0,s.h)();function I(t,e,n,i){const o=(0,s.d)(b,e,t);switch(n){case r.X:{const t=(0,s.x)(o,b)[2];return(0,s.s)(i,-Math.sin(t),Math.cos(t),0)}case r.Y:{const t=(0,s.x)(o,b),e=t[1],n=t[2],r=Math.sin(e);return(0,s.s)(i,-r*Math.cos(n),-r*Math.sin(n),Math.cos(e))}case r.Z:return(0,s.n)(i,o);default:return}}function S(t,e){const n=(0,s.d)(M,e,t);return(0,s.e)(n)-t[3]}function w(t,e){const n=(0,s.y)(t,e),r=g(t);return n<=r*r}const M=(0,s.h)(),R=f();Object.freeze(Object.defineProperty({__proto__:null,create:f,copy:_,fromCenterAndRadius:function(t,e){return(0,u.a)(t[0],t[1],t[2],e)},wrap:function(t){return t},clear:function(t){t[0]=t[1]=t[2]=t[3]=0},fromRadius:function(t,e){return t[0]=t[1]=t[2]=0,t[3]=e,t},getRadius:g,getCenter:m,fromValues:function(t,e,n,r){return(0,u.a)(t,e,n,r)},elevate:function(t,e,n){return t!==n&&(0,s.a)(n,t),n[3]=t[3]+e,n},setExtent:function(t,e,n){return d.error("sphere.setExtent is not yet supported"),t===n?n:_(t,n)},intersectRay:p,intersectsRay:O,intersectRayClosestSilhouette:function(t,e,n){if(p(t,e,n))return n;const r=N(t,e,l.s.get());return(0,s.b)(n,e.origin,(0,s.o)(l.s.get(),e.direction,(0,s.v)(e.origin,r)/(0,s.e)(e.direction))),n},closestPointOnSilhouette:N,closestPoint:function(t,e,n){return p(t,e,n)?n:((0,h.a)(e,t,n),E(t,n,n))},projectPoint:E,distanceToSilhouette:function(t,e){const n=(0,s.d)(l.s.get(),e,t),r=(0,s.p)(n),i=t[3]*t[3];return Math.sqrt(Math.abs(r-i))},angleToSilhouette:A,axisAt:I,altitudeAt:S,setAltitudeAt:function(t,e,n,i){const o=S(t,e),c=I(t,e,r.Z,M),a=(0,s.o)(M,c,n-o);return(0,s.b)(i,e,a)},containsPoint:w,tmpSphere:R},Symbol.toStringTag,{value:"Module"}))},32191:(t,e,n)=>{function r(){return[0,0]}function i(t,e){return new Float64Array(t,e,2)}n.d(e,{Z:()=>o,a:()=>r,c:()=>i});const o=[0,0]},68681:(t,e,n)=>{function r(){return[0,0,0,0]}function i(t,e,n,r){return[t,e,n,r]}function o(t,e){return new Float64Array(t,e,4)}n.d(e,{a:()=>i,b:()=>o,c:()=>r}),i(1,1,1,1)},67592:(t,e,n)=>{n.d(e,{O:()=>h,a:()=>g,s:()=>_});var r=n(30773),i=n(79764),o=n(45087),s=n(57532),c=n(32191),a=n(82426),u=n(68681);class h{constructor(t){this.allocator=t,this._items=[],this._itemsPtr=0,this._grow()}get(){return 0===this._itemsPtr&&(0,r.n)((()=>this._reset())),this._itemsPtr===this._items.length&&this._grow(),this._items[this._itemsPtr++]}_reset(){const t=Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3*l);this._items.length=Math.min(t,this._items.length),this._itemsPtr=0}_grow(){for(let t=0;t<Math.max(8,Math.min(this._items.length,l));t++)this._items.push(this.allocator())}}const l=1024;class d{constructor(t,e,n){this.itemByteSize=t,this.itemCreate=e,this._buffers=new Array,this._items=new Array,this._itemsPtr=0,this._itemsPerBuffer=Math.ceil(n/this.itemByteSize)}get(){0===this._itemsPtr&&(0,r.n)((()=>this._reset()));const t=Math.floor(this._itemsPtr/this._itemsPerBuffer);for(;this._buffers.length<=t;){const t=new ArrayBuffer(this._itemsPerBuffer*this.itemByteSize);for(let e=0;e<this._itemsPerBuffer;++e)this._items.push(this.itemCreate(t,e*this.itemByteSize));this._buffers.push(t)}return this._items[this._itemsPtr++]}_reset(){const t=2*(Math.floor(this._itemsPtr/this._itemsPerBuffer)+1);for(;this._buffers.length>t;)this._buffers.pop(),this._items.length=this._buffers.length*this._itemsPerBuffer;this._itemsPtr=0}static createVec2f64(t=f){return new d(16,c.c,t)}static createVec3f64(t=f){return new d(24,a.E,t)}static createVec4f64(t=f){return new d(32,u.b,t)}static createMat3f64(t=f){return new d(72,o.c,t)}static createMat4f64(t=f){return new d(128,s.a,t)}static createQuatf64(t=f){return new d(32,o.a,t)}get test(){return{size:this._buffers.length*this._itemsPerBuffer*this.itemByteSize}}}const f=4*i.B.KILOBYTES,_=(d.createVec2f64(),d.createVec3f64());d.createVec4f64(),d.createMat3f64();const g=d.createMat4f64();d.createQuatf64()}}]);